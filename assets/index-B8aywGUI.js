const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BlogPostDetail-DZ7ZotB1.js","assets/loader-circle-CjdA97Rq.js","assets/AdminDashboard-CDDmRSvP.js","assets/AdminDashboard-DZrYvFpI.css","assets/CreateUserPage-Cp4Zz-Qi.js","assets/LoginPage-BrDH7ymF.js"])))=>i.map(i=>d[i]);
function cde(e,t){for(var i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();var Nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function hde(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var i=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}),i}var iY={exports:{}},UA={},rY={exports:{}},Sr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_=Symbol.for("react.element"),dde=Symbol.for("react.portal"),fde=Symbol.for("react.fragment"),pde=Symbol.for("react.strict_mode"),mde=Symbol.for("react.profiler"),gde=Symbol.for("react.provider"),vde=Symbol.for("react.context"),yde=Symbol.for("react.forward_ref"),xde=Symbol.for("react.suspense"),bde=Symbol.for("react.memo"),_de=Symbol.for("react.lazy"),X5=Symbol.iterator;function wde(e){return e===null||typeof e!="object"?null:(e=X5&&e[X5]||e["@@iterator"],typeof e=="function"?e:null)}var nY={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sY=Object.assign,aY={};function Yy(e,t,i){this.props=e,this.context=t,this.refs=aY,this.updater=i||nY}Yy.prototype.isReactComponent={};Yy.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Yy.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oY(){}oY.prototype=Yy.prototype;function GN(e,t,i){this.props=e,this.context=t,this.refs=aY,this.updater=i||nY}var qN=GN.prototype=new oY;qN.constructor=GN;sY(qN,Yy.prototype);qN.isPureReactComponent=!0;var K5=Array.isArray,lY=Object.prototype.hasOwnProperty,YN={current:null},uY={key:!0,ref:!0,__self:!0,__source:!0};function cY(e,t,i){var r,n={},s=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)lY.call(t,r)&&!uY.hasOwnProperty(r)&&(n[r]=t[r]);var o=arguments.length-2;if(o===1)n.children=i;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];n.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)n[r]===void 0&&(n[r]=o[r]);return{$$typeof:R_,type:e,key:s,ref:a,props:n,_owner:YN.current}}function Ede(e,t){return{$$typeof:R_,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function XN(e){return typeof e=="object"&&e!==null&&e.$$typeof===R_}function Sde(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var $5=/\/+/g;function gP(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Sde(""+e.key):t.toString(36)}function eT(e,t,i,r,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case R_:case dde:a=!0}}if(a)return a=e,n=n(a),e=r===""?"."+gP(a,0):r,K5(n)?(i="",e!=null&&(i=e.replace($5,"$&/")+"/"),eT(n,t,i,"",function(u){return u})):n!=null&&(XN(n)&&(n=Ede(n,i+(!n.key||a&&a.key===n.key?"":(""+n.key).replace($5,"$&/")+"/")+e)),t.push(n)),1;if(a=0,r=r===""?".":r+":",K5(e))for(var o=0;o<e.length;o++){s=e[o];var l=r+gP(s,o);a+=eT(s,t,i,l,n)}else if(l=wde(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=r+gP(s,o++),a+=eT(s,t,i,l,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Xw(e,t,i){if(e==null)return e;var r=[],n=0;return eT(e,r,"","",function(s){return t.call(i,s,n++)}),r}function Tde(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $o={current:null},tT={transition:null},Cde={ReactCurrentDispatcher:$o,ReactCurrentBatchConfig:tT,ReactCurrentOwner:YN};function hY(){throw Error("act(...) is not supported in production builds of React.")}Sr.Children={map:Xw,forEach:function(e,t,i){Xw(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return Xw(e,function(){t++}),t},toArray:function(e){return Xw(e,function(t){return t})||[]},only:function(e){if(!XN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Sr.Component=Yy;Sr.Fragment=fde;Sr.Profiler=mde;Sr.PureComponent=GN;Sr.StrictMode=pde;Sr.Suspense=xde;Sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cde;Sr.act=hY;Sr.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=sY({},e.props),n=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=YN.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)lY.call(t,l)&&!uY.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=i;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:R_,type:e.type,key:n,ref:s,props:r,_owner:a}};Sr.createContext=function(e){return e={$$typeof:vde,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:gde,_context:e},e.Consumer=e};Sr.createElement=cY;Sr.createFactory=function(e){var t=cY.bind(null,e);return t.type=e,t};Sr.createRef=function(){return{current:null}};Sr.forwardRef=function(e){return{$$typeof:yde,render:e}};Sr.isValidElement=XN;Sr.lazy=function(e){return{$$typeof:_de,_payload:{_status:-1,_result:e},_init:Tde}};Sr.memo=function(e,t){return{$$typeof:bde,type:e,compare:t===void 0?null:t}};Sr.startTransition=function(e){var t=tT.transition;tT.transition={};try{e()}finally{tT.transition=t}};Sr.unstable_act=hY;Sr.useCallback=function(e,t){return $o.current.useCallback(e,t)};Sr.useContext=function(e){return $o.current.useContext(e)};Sr.useDebugValue=function(){};Sr.useDeferredValue=function(e){return $o.current.useDeferredValue(e)};Sr.useEffect=function(e,t){return $o.current.useEffect(e,t)};Sr.useId=function(){return $o.current.useId()};Sr.useImperativeHandle=function(e,t,i){return $o.current.useImperativeHandle(e,t,i)};Sr.useInsertionEffect=function(e,t){return $o.current.useInsertionEffect(e,t)};Sr.useLayoutEffect=function(e,t){return $o.current.useLayoutEffect(e,t)};Sr.useMemo=function(e,t){return $o.current.useMemo(e,t)};Sr.useReducer=function(e,t,i){return $o.current.useReducer(e,t,i)};Sr.useRef=function(e){return $o.current.useRef(e)};Sr.useState=function(e){return $o.current.useState(e)};Sr.useSyncExternalStore=function(e,t,i){return $o.current.useSyncExternalStore(e,t,i)};Sr.useTransition=function(){return $o.current.useTransition()};Sr.version="18.3.1";rY.exports=Sr;var de=rY.exports;const ci=O_(de),dY=cde({__proto__:null,default:ci},[de]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ade=de,Mde=Symbol.for("react.element"),Pde=Symbol.for("react.fragment"),Dde=Object.prototype.hasOwnProperty,Ide=Ade.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ode={key:!0,ref:!0,__self:!0,__source:!0};function fY(e,t,i){var r,n={},s=null,a=null;i!==void 0&&(s=""+i),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Dde.call(t,r)&&!Ode.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:Mde,type:e,key:s,ref:a,props:n,_owner:Ide.current}}UA.Fragment=Pde;UA.jsx=fY;UA.jsxs=fY;iY.exports=UA;var j=iY.exports,tR={},pY={exports:{}},au={},mY={exports:{}},gY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,J){var U=V.length;V.push(J);e:for(;0<U;){var ie=U-1>>>1,se=V[ie];if(0<n(se,J))V[ie]=J,V[U]=se,U=ie;else break e}}function i(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var J=V[0],U=V.pop();if(U!==J){V[0]=U;e:for(var ie=0,se=V.length,ee=se>>>1;ie<ee;){var ve=2*(ie+1)-1,_e=V[ve],he=ve+1,De=V[he];if(0>n(_e,U))he<se&&0>n(De,_e)?(V[ie]=De,V[he]=U,ie=he):(V[ie]=_e,V[ve]=U,ie=ve);else if(he<se&&0>n(De,U))V[ie]=De,V[he]=U,ie=he;else break e}}return J}function n(V,J){var U=V.sortIndex-J.sortIndex;return U!==0?U:V.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,f=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(V){for(var J=i(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=V)r(u),J.sortIndex=J.expirationTime,t(l,J);else break;J=i(u)}}function C(V){if(g=!1,b(V),!m)if(i(l)!==null)m=!0,Z(A);else{var J=i(u);J!==null&&G(C,J.startTime-V)}}function A(V,J){m=!1,g&&(g=!1,x(P),P=-1),f=!0;var U=d;try{for(b(J),h=i(l);h!==null&&(!(h.expirationTime>J)||V&&!k());){var ie=h.callback;if(typeof ie=="function"){h.callback=null,d=h.priorityLevel;var se=ie(h.expirationTime<=J);J=e.unstable_now(),typeof se=="function"?h.callback=se:h===i(l)&&r(l),b(J)}else r(l);h=i(l)}if(h!==null)var ee=!0;else{var ve=i(u);ve!==null&&G(C,ve.startTime-J),ee=!1}return ee}finally{h=null,d=U,f=!1}}var E=!1,_=null,P=-1,I=5,D=-1;function k(){return!(e.unstable_now()-D<I)}function B(){if(_!==null){var V=e.unstable_now();D=V;var J=!0;try{J=_(!0,V)}finally{J?z():(E=!1,_=null)}}else E=!1}var z;if(typeof w=="function")z=function(){w(B)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,$=W.port2;W.port1.onmessage=B,z=function(){$.postMessage(null)}}else z=function(){y(B,0)};function Z(V){_=V,E||(E=!0,z())}function G(V,J){P=y(function(){V(e.unstable_now())},J)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,Z(A))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(l)},e.unstable_next=function(V){switch(d){case 1:case 2:case 3:var J=3;break;default:J=d}var U=d;d=J;try{return V()}finally{d=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,J){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var U=d;d=V;try{return J()}finally{d=U}},e.unstable_scheduleCallback=function(V,J,U){var ie=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?ie+U:ie):U=ie,V){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=U+se,V={id:c++,callback:J,priorityLevel:V,startTime:U,expirationTime:se,sortIndex:-1},U>ie?(V.sortIndex=U,t(u,V),i(l)===null&&V===i(u)&&(g?(x(P),P=-1):g=!0,G(C,U-ie))):(V.sortIndex=se,t(l,V),m||f||(m=!0,Z(A))),V},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(V){var J=d;return function(){var U=d;d=J;try{return V.apply(this,arguments)}finally{d=U}}}})(gY);mY.exports=gY;var Rde=mY.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lde=de,iu=Rde;function zt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vY=new Set,Lb={};function tv(e,t){xy(e,t),xy(e+"Capture",t)}function xy(e,t){for(Lb[e]=t,e=0;e<t.length;e++)vY.add(t[e])}var rf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),iR=Object.prototype.hasOwnProperty,Nde=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Z5={},Q5={};function kde(e){return iR.call(Q5,e)?!0:iR.call(Z5,e)?!1:Nde.test(e)?Q5[e]=!0:(Z5[e]=!0,!1)}function Bde(e,t,i,r){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function zde(e,t,i,r){if(t===null||typeof t>"u"||Bde(e,t,i,r))return!0;if(r)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zo(e,t,i,r,n,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Ga={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ga[e]=new Zo(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ga[t]=new Zo(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ga[e]=new Zo(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ga[e]=new Zo(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ga[e]=new Zo(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ga[e]=new Zo(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ga[e]=new Zo(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ga[e]=new Zo(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ga[e]=new Zo(e,5,!1,e.toLowerCase(),null,!1,!1)});var KN=/[\-:]([a-z])/g;function $N(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(KN,$N);Ga[t]=new Zo(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(KN,$N);Ga[t]=new Zo(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(KN,$N);Ga[t]=new Zo(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ga[e]=new Zo(e,1,!1,e.toLowerCase(),null,!1,!1)});Ga.xlinkHref=new Zo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ga[e]=new Zo(e,1,!1,e.toLowerCase(),null,!0,!0)});function ZN(e,t,i,r){var n=Ga.hasOwnProperty(t)?Ga[t]:null;(n!==null?n.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(zde(t,i,n,r)&&(i=null),r||n===null?kde(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):n.mustUseProperty?e[n.propertyName]=i===null?n.type===3?!1:"":i:(t=n.attributeName,r=n.attributeNamespace,i===null?e.removeAttribute(t):(n=n.type,i=n===3||n===4&&i===!0?"":""+i,r?e.setAttributeNS(r,t,i):e.setAttribute(t,i))))}var pf=Lde.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Kw=Symbol.for("react.element"),T0=Symbol.for("react.portal"),C0=Symbol.for("react.fragment"),QN=Symbol.for("react.strict_mode"),rR=Symbol.for("react.profiler"),yY=Symbol.for("react.provider"),xY=Symbol.for("react.context"),JN=Symbol.for("react.forward_ref"),nR=Symbol.for("react.suspense"),sR=Symbol.for("react.suspense_list"),ek=Symbol.for("react.memo"),ip=Symbol.for("react.lazy"),bY=Symbol.for("react.offscreen"),J5=Symbol.iterator;function N1(e){return e===null||typeof e!="object"?null:(e=J5&&e[J5]||e["@@iterator"],typeof e=="function"?e:null)}var Vn=Object.assign,vP;function Mx(e){if(vP===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);vP=t&&t[1]||""}return`
`+vP+e}var yP=!1;function xP(e,t){if(!e||yP)return"";yP=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),s=r.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{yP=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?Mx(e):""}function Fde(e){switch(e.tag){case 5:return Mx(e.type);case 16:return Mx("Lazy");case 13:return Mx("Suspense");case 19:return Mx("SuspenseList");case 0:case 2:case 15:return e=xP(e.type,!1),e;case 11:return e=xP(e.type.render,!1),e;case 1:return e=xP(e.type,!0),e;default:return""}}function aR(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case C0:return"Fragment";case T0:return"Portal";case rR:return"Profiler";case QN:return"StrictMode";case nR:return"Suspense";case sR:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xY:return(e.displayName||"Context")+".Consumer";case yY:return(e._context.displayName||"Context")+".Provider";case JN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ek:return t=e.displayName||null,t!==null?t:aR(e.type)||"Memo";case ip:t=e._payload,e=e._init;try{return aR(e(t))}catch{}}return null}function Ude(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return aR(t);case 8:return t===QN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Wp(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _Y(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jde(e){var t=_Y(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var n=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $w(e){e._valueTracker||(e._valueTracker=jde(e))}function wY(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),r="";return e&&(r=_Y(e)?e.checked?"true":"false":e.value),e=r,e!==i?(t.setValue(e),!0):!1}function FT(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oR(e,t){var i=t.checked;return Vn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function eU(e,t){var i=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;i=Wp(t.value!=null?t.value:i),e._wrapperState={initialChecked:r,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function EY(e,t){t=t.checked,t!=null&&ZN(e,"checked",t,!1)}function lR(e,t){EY(e,t);var i=Wp(t.value),r=t.type;if(i!=null)r==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?uR(e,t.type,i):t.hasOwnProperty("defaultValue")&&uR(e,t.type,Wp(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function tU(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function uR(e,t,i){(t!=="number"||FT(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Px=Array.isArray;function $0(e,t,i,r){if(e=e.options,t){t={};for(var n=0;n<i.length;n++)t["$"+i[n]]=!0;for(i=0;i<e.length;i++)n=t.hasOwnProperty("$"+e[i].value),e[i].selected!==n&&(e[i].selected=n),n&&r&&(e[i].defaultSelected=!0)}else{for(i=""+Wp(i),t=null,n=0;n<e.length;n++){if(e[n].value===i){e[n].selected=!0,r&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function cR(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(zt(91));return Vn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function iU(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(zt(92));if(Px(i)){if(1<i.length)throw Error(zt(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Wp(i)}}function SY(e,t){var i=Wp(t.value),r=Wp(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),r!=null&&(e.defaultValue=""+r)}function rU(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function TY(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hR(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?TY(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zw,CY=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,r,n){MSApp.execUnsafeLocalFunction(function(){return e(t,i,r,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zw=Zw||document.createElement("div"),Zw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Nb(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var Qx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vde=["Webkit","ms","Moz","O"];Object.keys(Qx).forEach(function(e){Vde.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Qx[t]=Qx[e]})});function AY(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||Qx.hasOwnProperty(e)&&Qx[e]?(""+t).trim():t+"px"}function MY(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var r=i.indexOf("--")===0,n=AY(i,t[i],r);i==="float"&&(i="cssFloat"),r?e.setProperty(i,n):e[i]=n}}var Hde=Vn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dR(e,t){if(t){if(Hde[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(zt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(zt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(zt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(zt(62))}}function fR(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pR=null;function tk(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mR=null,Z0=null,Q0=null;function nU(e){if(e=k_(e)){if(typeof mR!="function")throw Error(zt(280));var t=e.stateNode;t&&(t=GA(t),mR(e.stateNode,e.type,t))}}function PY(e){Z0?Q0?Q0.push(e):Q0=[e]:Z0=e}function DY(){if(Z0){var e=Z0,t=Q0;if(Q0=Z0=null,nU(e),t)for(e=0;e<t.length;e++)nU(t[e])}}function IY(e,t){return e(t)}function OY(){}var bP=!1;function RY(e,t,i){if(bP)return e(t,i);bP=!0;try{return IY(e,t,i)}finally{bP=!1,(Z0!==null||Q0!==null)&&(OY(),DY())}}function kb(e,t){var i=e.stateNode;if(i===null)return null;var r=GA(i);if(r===null)return null;i=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(zt(231,t,typeof i));return i}var gR=!1;if(rf)try{var k1={};Object.defineProperty(k1,"passive",{get:function(){gR=!0}}),window.addEventListener("test",k1,k1),window.removeEventListener("test",k1,k1)}catch{gR=!1}function Wde(e,t,i,r,n,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(i,u)}catch(c){this.onError(c)}}var Jx=!1,UT=null,jT=!1,vR=null,Gde={onError:function(e){Jx=!0,UT=e}};function qde(e,t,i,r,n,s,a,o,l){Jx=!1,UT=null,Wde.apply(Gde,arguments)}function Yde(e,t,i,r,n,s,a,o,l){if(qde.apply(this,arguments),Jx){if(Jx){var u=UT;Jx=!1,UT=null}else throw Error(zt(198));jT||(jT=!0,vR=u)}}function iv(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function LY(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function sU(e){if(iv(e)!==e)throw Error(zt(188))}function Xde(e){var t=e.alternate;if(!t){if(t=iv(e),t===null)throw Error(zt(188));return t!==e?null:e}for(var i=e,r=t;;){var n=i.return;if(n===null)break;var s=n.alternate;if(s===null){if(r=n.return,r!==null){i=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===i)return sU(n),e;if(s===r)return sU(n),t;s=s.sibling}throw Error(zt(188))}if(i.return!==r.return)i=n,r=s;else{for(var a=!1,o=n.child;o;){if(o===i){a=!0,i=n,r=s;break}if(o===r){a=!0,r=n,i=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===i){a=!0,i=s,r=n;break}if(o===r){a=!0,r=s,i=n;break}o=o.sibling}if(!a)throw Error(zt(189))}}if(i.alternate!==r)throw Error(zt(190))}if(i.tag!==3)throw Error(zt(188));return i.stateNode.current===i?e:t}function NY(e){return e=Xde(e),e!==null?kY(e):null}function kY(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=kY(e);if(t!==null)return t;e=e.sibling}return null}var BY=iu.unstable_scheduleCallback,aU=iu.unstable_cancelCallback,Kde=iu.unstable_shouldYield,$de=iu.unstable_requestPaint,ps=iu.unstable_now,Zde=iu.unstable_getCurrentPriorityLevel,ik=iu.unstable_ImmediatePriority,zY=iu.unstable_UserBlockingPriority,VT=iu.unstable_NormalPriority,Qde=iu.unstable_LowPriority,FY=iu.unstable_IdlePriority,jA=null,Th=null;function Jde(e){if(Th&&typeof Th.onCommitFiberRoot=="function")try{Th.onCommitFiberRoot(jA,e,void 0,(e.current.flags&128)===128)}catch{}}var bc=Math.clz32?Math.clz32:ife,efe=Math.log,tfe=Math.LN2;function ife(e){return e>>>=0,e===0?32:31-(efe(e)/tfe|0)|0}var Qw=64,Jw=4194304;function Dx(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function HT(e,t){var i=e.pendingLanes;if(i===0)return 0;var r=0,n=e.suspendedLanes,s=e.pingedLanes,a=i&268435455;if(a!==0){var o=a&~n;o!==0?r=Dx(o):(s&=a,s!==0&&(r=Dx(s)))}else a=i&~n,a!==0?r=Dx(a):s!==0&&(r=Dx(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&n)&&(n=r&-r,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if(r&4&&(r|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)i=31-bc(t),n=1<<i,r|=e[i],t&=~n;return r}function rfe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nfe(e,t){for(var i=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-bc(s),o=1<<a,l=n[a];l===-1?(!(o&i)||o&r)&&(n[a]=rfe(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function yR(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function UY(){var e=Qw;return Qw<<=1,!(Qw&4194240)&&(Qw=64),e}function _P(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function L_(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-bc(t),e[t]=i}function sfe(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<i;){var n=31-bc(i),s=1<<n;t[n]=0,r[n]=-1,e[n]=-1,i&=~s}}function rk(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var r=31-bc(i),n=1<<r;n&t|e[r]&t&&(e[r]|=t),i&=~n}}var Jr=0;function jY(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var VY,nk,HY,WY,GY,xR=!1,eE=[],Dp=null,Ip=null,Op=null,Bb=new Map,zb=new Map,op=[],afe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oU(e,t){switch(e){case"focusin":case"focusout":Dp=null;break;case"dragenter":case"dragleave":Ip=null;break;case"mouseover":case"mouseout":Op=null;break;case"pointerover":case"pointerout":Bb.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zb.delete(t.pointerId)}}function B1(e,t,i,r,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:r,nativeEvent:s,targetContainers:[n]},t!==null&&(t=k_(t),t!==null&&nk(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function ofe(e,t,i,r,n){switch(t){case"focusin":return Dp=B1(Dp,e,t,i,r,n),!0;case"dragenter":return Ip=B1(Ip,e,t,i,r,n),!0;case"mouseover":return Op=B1(Op,e,t,i,r,n),!0;case"pointerover":var s=n.pointerId;return Bb.set(s,B1(Bb.get(s)||null,e,t,i,r,n)),!0;case"gotpointercapture":return s=n.pointerId,zb.set(s,B1(zb.get(s)||null,e,t,i,r,n)),!0}return!1}function qY(e){var t=pg(e.target);if(t!==null){var i=iv(t);if(i!==null){if(t=i.tag,t===13){if(t=LY(i),t!==null){e.blockedOn=t,GY(e.priority,function(){HY(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function iT(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=bR(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var r=new i.constructor(i.type,i);pR=r,i.target.dispatchEvent(r),pR=null}else return t=k_(i),t!==null&&nk(t),e.blockedOn=i,!1;t.shift()}return!0}function lU(e,t,i){iT(e)&&i.delete(t)}function lfe(){xR=!1,Dp!==null&&iT(Dp)&&(Dp=null),Ip!==null&&iT(Ip)&&(Ip=null),Op!==null&&iT(Op)&&(Op=null),Bb.forEach(lU),zb.forEach(lU)}function z1(e,t){e.blockedOn===t&&(e.blockedOn=null,xR||(xR=!0,iu.unstable_scheduleCallback(iu.unstable_NormalPriority,lfe)))}function Fb(e){function t(n){return z1(n,e)}if(0<eE.length){z1(eE[0],e);for(var i=1;i<eE.length;i++){var r=eE[i];r.blockedOn===e&&(r.blockedOn=null)}}for(Dp!==null&&z1(Dp,e),Ip!==null&&z1(Ip,e),Op!==null&&z1(Op,e),Bb.forEach(t),zb.forEach(t),i=0;i<op.length;i++)r=op[i],r.blockedOn===e&&(r.blockedOn=null);for(;0<op.length&&(i=op[0],i.blockedOn===null);)qY(i),i.blockedOn===null&&op.shift()}var J0=pf.ReactCurrentBatchConfig,WT=!0;function ufe(e,t,i,r){var n=Jr,s=J0.transition;J0.transition=null;try{Jr=1,sk(e,t,i,r)}finally{Jr=n,J0.transition=s}}function cfe(e,t,i,r){var n=Jr,s=J0.transition;J0.transition=null;try{Jr=4,sk(e,t,i,r)}finally{Jr=n,J0.transition=s}}function sk(e,t,i,r){if(WT){var n=bR(e,t,i,r);if(n===null)IP(e,t,r,GT,i),oU(e,r);else if(ofe(n,e,t,i,r))r.stopPropagation();else if(oU(e,r),t&4&&-1<afe.indexOf(e)){for(;n!==null;){var s=k_(n);if(s!==null&&VY(s),s=bR(e,t,i,r),s===null&&IP(e,t,r,GT,i),s===n)break;n=s}n!==null&&r.stopPropagation()}else IP(e,t,r,null,i)}}var GT=null;function bR(e,t,i,r){if(GT=null,e=tk(r),e=pg(e),e!==null)if(t=iv(e),t===null)e=null;else if(i=t.tag,i===13){if(e=LY(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return GT=e,null}function YY(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zde()){case ik:return 1;case zY:return 4;case VT:case Qde:return 16;case FY:return 536870912;default:return 16}default:return 16}}var gp=null,ak=null,rT=null;function XY(){if(rT)return rT;var e,t=ak,i=t.length,r,n="value"in gp?gp.value:gp.textContent,s=n.length;for(e=0;e<i&&t[e]===n[e];e++);var a=i-e;for(r=1;r<=a&&t[i-r]===n[s-r];r++);return rT=n.slice(e,1<r?1-r:void 0)}function nT(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function tE(){return!0}function uU(){return!1}function ou(e){function t(i,r,n,s,a){this._reactName=i,this._targetInst=n,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(i=e[o],this[o]=i?i(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?tE:uU,this.isPropagationStopped=uU,this}return Vn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=tE)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=tE)},persist:function(){},isPersistent:tE}),t}var Xy={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ok=ou(Xy),N_=Vn({},Xy,{view:0,detail:0}),hfe=ou(N_),wP,EP,F1,VA=Vn({},N_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==F1&&(F1&&e.type==="mousemove"?(wP=e.screenX-F1.screenX,EP=e.screenY-F1.screenY):EP=wP=0,F1=e),wP)},movementY:function(e){return"movementY"in e?e.movementY:EP}}),cU=ou(VA),dfe=Vn({},VA,{dataTransfer:0}),ffe=ou(dfe),pfe=Vn({},N_,{relatedTarget:0}),SP=ou(pfe),mfe=Vn({},Xy,{animationName:0,elapsedTime:0,pseudoElement:0}),gfe=ou(mfe),vfe=Vn({},Xy,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yfe=ou(vfe),xfe=Vn({},Xy,{data:0}),hU=ou(xfe),bfe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_fe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wfe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Efe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=wfe[e])?!!t[e]:!1}function lk(){return Efe}var Sfe=Vn({},N_,{key:function(e){if(e.key){var t=bfe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=nT(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_fe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lk,charCode:function(e){return e.type==="keypress"?nT(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?nT(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Tfe=ou(Sfe),Cfe=Vn({},VA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dU=ou(Cfe),Afe=Vn({},N_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lk}),Mfe=ou(Afe),Pfe=Vn({},Xy,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dfe=ou(Pfe),Ife=Vn({},VA,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ofe=ou(Ife),Rfe=[9,13,27,32],uk=rf&&"CompositionEvent"in window,eb=null;rf&&"documentMode"in document&&(eb=document.documentMode);var Lfe=rf&&"TextEvent"in window&&!eb,KY=rf&&(!uk||eb&&8<eb&&11>=eb),fU=" ",pU=!1;function $Y(e,t){switch(e){case"keyup":return Rfe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZY(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var A0=!1;function Nfe(e,t){switch(e){case"compositionend":return ZY(t);case"keypress":return t.which!==32?null:(pU=!0,fU);case"textInput":return e=t.data,e===fU&&pU?null:e;default:return null}}function kfe(e,t){if(A0)return e==="compositionend"||!uk&&$Y(e,t)?(e=XY(),rT=ak=gp=null,A0=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return KY&&t.locale!=="ko"?null:t.data;default:return null}}var Bfe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mU(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bfe[e.type]:t==="textarea"}function QY(e,t,i,r){PY(r),t=qT(t,"onChange"),0<t.length&&(i=new ok("onChange","change",null,i,r),e.push({event:i,listeners:t}))}var tb=null,Ub=null;function zfe(e){uX(e,0)}function HA(e){var t=D0(e);if(wY(t))return e}function Ffe(e,t){if(e==="change")return t}var JY=!1;if(rf){var TP;if(rf){var CP="oninput"in document;if(!CP){var gU=document.createElement("div");gU.setAttribute("oninput","return;"),CP=typeof gU.oninput=="function"}TP=CP}else TP=!1;JY=TP&&(!document.documentMode||9<document.documentMode)}function vU(){tb&&(tb.detachEvent("onpropertychange",eX),Ub=tb=null)}function eX(e){if(e.propertyName==="value"&&HA(Ub)){var t=[];QY(t,Ub,e,tk(e)),RY(zfe,t)}}function Ufe(e,t,i){e==="focusin"?(vU(),tb=t,Ub=i,tb.attachEvent("onpropertychange",eX)):e==="focusout"&&vU()}function jfe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return HA(Ub)}function Vfe(e,t){if(e==="click")return HA(t)}function Hfe(e,t){if(e==="input"||e==="change")return HA(t)}function Wfe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Sc=typeof Object.is=="function"?Object.is:Wfe;function jb(e,t){if(Sc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var n=i[r];if(!iR.call(t,n)||!Sc(e[n],t[n]))return!1}return!0}function yU(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xU(e,t){var i=yU(e);e=0;for(var r;i;){if(i.nodeType===3){if(r=e+i.textContent.length,e<=t&&r>=t)return{node:i,offset:t-e};e=r}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=yU(i)}}function tX(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?tX(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function iX(){for(var e=window,t=FT();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=FT(e.document)}return t}function ck(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Gfe(e){var t=iX(),i=e.focusedElem,r=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&tX(i.ownerDocument.documentElement,i)){if(r!==null&&ck(i)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=i.textContent.length,s=Math.min(r.start,n);r=r.end===void 0?s:Math.min(r.end,n),!e.extend&&s>r&&(n=r,r=s,s=n),n=xU(i,s);var a=xU(i,r);n&&a&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var qfe=rf&&"documentMode"in document&&11>=document.documentMode,M0=null,_R=null,ib=null,wR=!1;function bU(e,t,i){var r=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;wR||M0==null||M0!==FT(r)||(r=M0,"selectionStart"in r&&ck(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ib&&jb(ib,r)||(ib=r,r=qT(_R,"onSelect"),0<r.length&&(t=new ok("onSelect","select",null,t,i),e.push({event:t,listeners:r}),t.target=M0)))}function iE(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var P0={animationend:iE("Animation","AnimationEnd"),animationiteration:iE("Animation","AnimationIteration"),animationstart:iE("Animation","AnimationStart"),transitionend:iE("Transition","TransitionEnd")},AP={},rX={};rf&&(rX=document.createElement("div").style,"AnimationEvent"in window||(delete P0.animationend.animation,delete P0.animationiteration.animation,delete P0.animationstart.animation),"TransitionEvent"in window||delete P0.transitionend.transition);function WA(e){if(AP[e])return AP[e];if(!P0[e])return e;var t=P0[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in rX)return AP[e]=t[i];return e}var nX=WA("animationend"),sX=WA("animationiteration"),aX=WA("animationstart"),oX=WA("transitionend"),lX=new Map,_U="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qp(e,t){lX.set(e,t),tv(t,[e])}for(var MP=0;MP<_U.length;MP++){var PP=_U[MP],Yfe=PP.toLowerCase(),Xfe=PP[0].toUpperCase()+PP.slice(1);Qp(Yfe,"on"+Xfe)}Qp(nX,"onAnimationEnd");Qp(sX,"onAnimationIteration");Qp(aX,"onAnimationStart");Qp("dblclick","onDoubleClick");Qp("focusin","onFocus");Qp("focusout","onBlur");Qp(oX,"onTransitionEnd");xy("onMouseEnter",["mouseout","mouseover"]);xy("onMouseLeave",["mouseout","mouseover"]);xy("onPointerEnter",["pointerout","pointerover"]);xy("onPointerLeave",["pointerout","pointerover"]);tv("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));tv("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));tv("onBeforeInput",["compositionend","keypress","textInput","paste"]);tv("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));tv("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));tv("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ix="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kfe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ix));function wU(e,t,i){var r=e.type||"unknown-event";e.currentTarget=i,Yde(r,t,void 0,e),e.currentTarget=null}function uX(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var r=e[i],n=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;wU(n,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;wU(n,o,u),s=l}}}if(jT)throw e=vR,jT=!1,vR=null,e}function Cn(e,t){var i=t[AR];i===void 0&&(i=t[AR]=new Set);var r=e+"__bubble";i.has(r)||(cX(t,e,2,!1),i.add(r))}function DP(e,t,i){var r=0;t&&(r|=4),cX(i,e,r,t)}var rE="_reactListening"+Math.random().toString(36).slice(2);function Vb(e){if(!e[rE]){e[rE]=!0,vY.forEach(function(i){i!=="selectionchange"&&(Kfe.has(i)||DP(i,!1,e),DP(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[rE]||(t[rE]=!0,DP("selectionchange",!1,t))}}function cX(e,t,i,r){switch(YY(t)){case 1:var n=ufe;break;case 4:n=cfe;break;default:n=sk}i=n.bind(null,t,i,e),n=void 0,!gR||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),r?n!==void 0?e.addEventListener(t,i,{capture:!0,passive:n}):e.addEventListener(t,i,!0):n!==void 0?e.addEventListener(t,i,{passive:n}):e.addEventListener(t,i,!1)}function IP(e,t,i,r,n){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=pg(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}RY(function(){var u=s,c=tk(i),h=[];e:{var d=lX.get(e);if(d!==void 0){var f=ok,m=e;switch(e){case"keypress":if(nT(i)===0)break e;case"keydown":case"keyup":f=Tfe;break;case"focusin":m="focus",f=SP;break;case"focusout":m="blur",f=SP;break;case"beforeblur":case"afterblur":f=SP;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=cU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=ffe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Mfe;break;case nX:case sX:case aX:f=gfe;break;case oX:f=Dfe;break;case"scroll":f=hfe;break;case"wheel":f=Ofe;break;case"copy":case"cut":case"paste":f=yfe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=dU}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?d!==null?d+"Capture":null:d;g=[];for(var w=u,b;w!==null;){b=w;var C=b.stateNode;if(b.tag===5&&C!==null&&(b=C,x!==null&&(C=kb(w,x),C!=null&&g.push(Hb(w,C,b)))),y)break;w=w.return}0<g.length&&(d=new f(d,m,null,i,c),h.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",d&&i!==pR&&(m=i.relatedTarget||i.fromElement)&&(pg(m)||m[nf]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(m=i.relatedTarget||i.toElement,f=u,m=m?pg(m):null,m!==null&&(y=iv(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(g=cU,C="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=dU,C="onPointerLeave",x="onPointerEnter",w="pointer"),y=f==null?d:D0(f),b=m==null?d:D0(m),d=new g(C,w+"leave",f,i,c),d.target=y,d.relatedTarget=b,C=null,pg(c)===u&&(g=new g(x,w+"enter",m,i,c),g.target=b,g.relatedTarget=y,C=g),y=C,f&&m)t:{for(g=f,x=m,w=0,b=g;b;b=Dv(b))w++;for(b=0,C=x;C;C=Dv(C))b++;for(;0<w-b;)g=Dv(g),w--;for(;0<b-w;)x=Dv(x),b--;for(;w--;){if(g===x||x!==null&&g===x.alternate)break t;g=Dv(g),x=Dv(x)}g=null}else g=null;f!==null&&EU(h,d,f,g,!1),m!==null&&y!==null&&EU(h,y,m,g,!0)}}e:{if(d=u?D0(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var A=Ffe;else if(mU(d))if(JY)A=Hfe;else{A=jfe;var E=Ufe}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(A=Vfe);if(A&&(A=A(e,u))){QY(h,A,i,c);break e}E&&E(e,d,u),e==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&uR(d,"number",d.value)}switch(E=u?D0(u):window,e){case"focusin":(mU(E)||E.contentEditable==="true")&&(M0=E,_R=u,ib=null);break;case"focusout":ib=_R=M0=null;break;case"mousedown":wR=!0;break;case"contextmenu":case"mouseup":case"dragend":wR=!1,bU(h,i,c);break;case"selectionchange":if(qfe)break;case"keydown":case"keyup":bU(h,i,c)}var _;if(uk)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else A0?$Y(e,i)&&(P="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(P="onCompositionStart");P&&(KY&&i.locale!=="ko"&&(A0||P!=="onCompositionStart"?P==="onCompositionEnd"&&A0&&(_=XY()):(gp=c,ak="value"in gp?gp.value:gp.textContent,A0=!0)),E=qT(u,P),0<E.length&&(P=new hU(P,e,null,i,c),h.push({event:P,listeners:E}),_?P.data=_:(_=ZY(i),_!==null&&(P.data=_)))),(_=Lfe?Nfe(e,i):kfe(e,i))&&(u=qT(u,"onBeforeInput"),0<u.length&&(c=new hU("onBeforeInput","beforeinput",null,i,c),h.push({event:c,listeners:u}),c.data=_))}uX(h,t)})}function Hb(e,t,i){return{instance:e,listener:t,currentTarget:i}}function qT(e,t){for(var i=t+"Capture",r=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=kb(e,i),s!=null&&r.unshift(Hb(e,s,n)),s=kb(e,t),s!=null&&r.push(Hb(e,s,n))),e=e.return}return r}function Dv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function EU(e,t,i,r,n){for(var s=t._reactName,a=[];i!==null&&i!==r;){var o=i,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,n?(l=kb(i,s),l!=null&&a.unshift(Hb(i,l,o))):n||(l=kb(i,s),l!=null&&a.push(Hb(i,l,o)))),i=i.return}a.length!==0&&e.push({event:t,listeners:a})}var $fe=/\r\n?/g,Zfe=/\u0000|\uFFFD/g;function SU(e){return(typeof e=="string"?e:""+e).replace($fe,`
`).replace(Zfe,"")}function nE(e,t,i){if(t=SU(t),SU(e)!==t&&i)throw Error(zt(425))}function YT(){}var ER=null,SR=null;function TR(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var CR=typeof setTimeout=="function"?setTimeout:void 0,Qfe=typeof clearTimeout=="function"?clearTimeout:void 0,TU=typeof Promise=="function"?Promise:void 0,Jfe=typeof queueMicrotask=="function"?queueMicrotask:typeof TU<"u"?function(e){return TU.resolve(null).then(e).catch(epe)}:CR;function epe(e){setTimeout(function(){throw e})}function OP(e,t){var i=t,r=0;do{var n=i.nextSibling;if(e.removeChild(i),n&&n.nodeType===8)if(i=n.data,i==="/$"){if(r===0){e.removeChild(n),Fb(t);return}r--}else i!=="$"&&i!=="$?"&&i!=="$!"||r++;i=n}while(i);Fb(t)}function Rp(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function CU(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Ky=Math.random().toString(36).slice(2),dh="__reactFiber$"+Ky,Wb="__reactProps$"+Ky,nf="__reactContainer$"+Ky,AR="__reactEvents$"+Ky,tpe="__reactListeners$"+Ky,ipe="__reactHandles$"+Ky;function pg(e){var t=e[dh];if(t)return t;for(var i=e.parentNode;i;){if(t=i[nf]||i[dh]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=CU(e);e!==null;){if(i=e[dh])return i;e=CU(e)}return t}e=i,i=e.parentNode}return null}function k_(e){return e=e[dh]||e[nf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function D0(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(zt(33))}function GA(e){return e[Wb]||null}var MR=[],I0=-1;function Jp(e){return{current:e}}function Pn(e){0>I0||(e.current=MR[I0],MR[I0]=null,I0--)}function xn(e,t){I0++,MR[I0]=e.current,e.current=t}var Gp={},vo=Jp(Gp),Ml=Jp(!1),zg=Gp;function by(e,t){var i=e.type.contextTypes;if(!i)return Gp;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in i)n[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Pl(e){return e=e.childContextTypes,e!=null}function XT(){Pn(Ml),Pn(vo)}function AU(e,t,i){if(vo.current!==Gp)throw Error(zt(168));xn(vo,t),xn(Ml,i)}function hX(e,t,i){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return i;r=r.getChildContext();for(var n in r)if(!(n in t))throw Error(zt(108,Ude(e)||"Unknown",n));return Vn({},i,r)}function KT(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Gp,zg=vo.current,xn(vo,e),xn(Ml,Ml.current),!0}function MU(e,t,i){var r=e.stateNode;if(!r)throw Error(zt(169));i?(e=hX(e,t,zg),r.__reactInternalMemoizedMergedChildContext=e,Pn(Ml),Pn(vo),xn(vo,e)):Pn(Ml),xn(Ml,i)}var kd=null,qA=!1,RP=!1;function dX(e){kd===null?kd=[e]:kd.push(e)}function rpe(e){qA=!0,dX(e)}function em(){if(!RP&&kd!==null){RP=!0;var e=0,t=Jr;try{var i=kd;for(Jr=1;e<i.length;e++){var r=i[e];do r=r(!0);while(r!==null)}kd=null,qA=!1}catch(n){throw kd!==null&&(kd=kd.slice(e+1)),BY(ik,em),n}finally{Jr=t,RP=!1}}return null}var O0=[],R0=0,$T=null,ZT=0,Pu=[],Du=0,Fg=null,Hd=1,Wd="";function Zm(e,t){O0[R0++]=ZT,O0[R0++]=$T,$T=e,ZT=t}function fX(e,t,i){Pu[Du++]=Hd,Pu[Du++]=Wd,Pu[Du++]=Fg,Fg=e;var r=Hd;e=Wd;var n=32-bc(r)-1;r&=~(1<<n),i+=1;var s=32-bc(t)+n;if(30<s){var a=n-n%5;s=(r&(1<<a)-1).toString(32),r>>=a,n-=a,Hd=1<<32-bc(t)+n|i<<n|r,Wd=s+e}else Hd=1<<s|i<<n|r,Wd=e}function hk(e){e.return!==null&&(Zm(e,1),fX(e,1,0))}function dk(e){for(;e===$T;)$T=O0[--R0],O0[R0]=null,ZT=O0[--R0],O0[R0]=null;for(;e===Fg;)Fg=Pu[--Du],Pu[Du]=null,Wd=Pu[--Du],Pu[Du]=null,Hd=Pu[--Du],Pu[Du]=null}var eu=null,Ql=null,In=!1,fc=null;function pX(e,t){var i=Lu(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function PU(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,eu=e,Ql=Rp(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,eu=e,Ql=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Fg!==null?{id:Hd,overflow:Wd}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=Lu(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,eu=e,Ql=null,!0):!1;default:return!1}}function PR(e){return(e.mode&1)!==0&&(e.flags&128)===0}function DR(e){if(In){var t=Ql;if(t){var i=t;if(!PU(e,t)){if(PR(e))throw Error(zt(418));t=Rp(i.nextSibling);var r=eu;t&&PU(e,t)?pX(r,i):(e.flags=e.flags&-4097|2,In=!1,eu=e)}}else{if(PR(e))throw Error(zt(418));e.flags=e.flags&-4097|2,In=!1,eu=e}}}function DU(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;eu=e}function sE(e){if(e!==eu)return!1;if(!In)return DU(e),In=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!TR(e.type,e.memoizedProps)),t&&(t=Ql)){if(PR(e))throw mX(),Error(zt(418));for(;t;)pX(e,t),t=Rp(t.nextSibling)}if(DU(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(zt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){Ql=Rp(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}Ql=null}}else Ql=eu?Rp(e.stateNode.nextSibling):null;return!0}function mX(){for(var e=Ql;e;)e=Rp(e.nextSibling)}function _y(){Ql=eu=null,In=!1}function fk(e){fc===null?fc=[e]:fc.push(e)}var npe=pf.ReactCurrentBatchConfig;function U1(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(zt(309));var r=i.stateNode}if(!r)throw Error(zt(147,e));var n=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=n.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(zt(284));if(!i._owner)throw Error(zt(290,e))}return e}function aE(e,t){throw e=Object.prototype.toString.call(t),Error(zt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function IU(e){var t=e._init;return t(e._payload)}function gX(e){function t(x,w){if(e){var b=x.deletions;b===null?(x.deletions=[w],x.flags|=16):b.push(w)}}function i(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function n(x,w){return x=Bp(x,w),x.index=0,x.sibling=null,x}function s(x,w,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<w?(x.flags|=2,w):b):(x.flags|=2,w)):(x.flags|=1048576,w)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,w,b,C){return w===null||w.tag!==6?(w=UP(b,x.mode,C),w.return=x,w):(w=n(w,b),w.return=x,w)}function l(x,w,b,C){var A=b.type;return A===C0?c(x,w,b.props.children,C,b.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===ip&&IU(A)===w.type)?(C=n(w,b.props),C.ref=U1(x,w,b),C.return=x,C):(C=hT(b.type,b.key,b.props,null,x.mode,C),C.ref=U1(x,w,b),C.return=x,C)}function u(x,w,b,C){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=jP(b,x.mode,C),w.return=x,w):(w=n(w,b.children||[]),w.return=x,w)}function c(x,w,b,C,A){return w===null||w.tag!==7?(w=Mg(b,x.mode,C,A),w.return=x,w):(w=n(w,b),w.return=x,w)}function h(x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=UP(""+w,x.mode,b),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Kw:return b=hT(w.type,w.key,w.props,null,x.mode,b),b.ref=U1(x,null,w),b.return=x,b;case T0:return w=jP(w,x.mode,b),w.return=x,w;case ip:var C=w._init;return h(x,C(w._payload),b)}if(Px(w)||N1(w))return w=Mg(w,x.mode,b,null),w.return=x,w;aE(x,w)}return null}function d(x,w,b,C){var A=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return A!==null?null:o(x,w,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Kw:return b.key===A?l(x,w,b,C):null;case T0:return b.key===A?u(x,w,b,C):null;case ip:return A=b._init,d(x,w,A(b._payload),C)}if(Px(b)||N1(b))return A!==null?null:c(x,w,b,C,null);aE(x,b)}return null}function f(x,w,b,C,A){if(typeof C=="string"&&C!==""||typeof C=="number")return x=x.get(b)||null,o(w,x,""+C,A);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Kw:return x=x.get(C.key===null?b:C.key)||null,l(w,x,C,A);case T0:return x=x.get(C.key===null?b:C.key)||null,u(w,x,C,A);case ip:var E=C._init;return f(x,w,b,E(C._payload),A)}if(Px(C)||N1(C))return x=x.get(b)||null,c(w,x,C,A,null);aE(w,C)}return null}function m(x,w,b,C){for(var A=null,E=null,_=w,P=w=0,I=null;_!==null&&P<b.length;P++){_.index>P?(I=_,_=null):I=_.sibling;var D=d(x,_,b[P],C);if(D===null){_===null&&(_=I);break}e&&_&&D.alternate===null&&t(x,_),w=s(D,w,P),E===null?A=D:E.sibling=D,E=D,_=I}if(P===b.length)return i(x,_),In&&Zm(x,P),A;if(_===null){for(;P<b.length;P++)_=h(x,b[P],C),_!==null&&(w=s(_,w,P),E===null?A=_:E.sibling=_,E=_);return In&&Zm(x,P),A}for(_=r(x,_);P<b.length;P++)I=f(_,x,P,b[P],C),I!==null&&(e&&I.alternate!==null&&_.delete(I.key===null?P:I.key),w=s(I,w,P),E===null?A=I:E.sibling=I,E=I);return e&&_.forEach(function(k){return t(x,k)}),In&&Zm(x,P),A}function g(x,w,b,C){var A=N1(b);if(typeof A!="function")throw Error(zt(150));if(b=A.call(b),b==null)throw Error(zt(151));for(var E=A=null,_=w,P=w=0,I=null,D=b.next();_!==null&&!D.done;P++,D=b.next()){_.index>P?(I=_,_=null):I=_.sibling;var k=d(x,_,D.value,C);if(k===null){_===null&&(_=I);break}e&&_&&k.alternate===null&&t(x,_),w=s(k,w,P),E===null?A=k:E.sibling=k,E=k,_=I}if(D.done)return i(x,_),In&&Zm(x,P),A;if(_===null){for(;!D.done;P++,D=b.next())D=h(x,D.value,C),D!==null&&(w=s(D,w,P),E===null?A=D:E.sibling=D,E=D);return In&&Zm(x,P),A}for(_=r(x,_);!D.done;P++,D=b.next())D=f(_,x,P,D.value,C),D!==null&&(e&&D.alternate!==null&&_.delete(D.key===null?P:D.key),w=s(D,w,P),E===null?A=D:E.sibling=D,E=D);return e&&_.forEach(function(B){return t(x,B)}),In&&Zm(x,P),A}function y(x,w,b,C){if(typeof b=="object"&&b!==null&&b.type===C0&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Kw:e:{for(var A=b.key,E=w;E!==null;){if(E.key===A){if(A=b.type,A===C0){if(E.tag===7){i(x,E.sibling),w=n(E,b.props.children),w.return=x,x=w;break e}}else if(E.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===ip&&IU(A)===E.type){i(x,E.sibling),w=n(E,b.props),w.ref=U1(x,E,b),w.return=x,x=w;break e}i(x,E);break}else t(x,E);E=E.sibling}b.type===C0?(w=Mg(b.props.children,x.mode,C,b.key),w.return=x,x=w):(C=hT(b.type,b.key,b.props,null,x.mode,C),C.ref=U1(x,w,b),C.return=x,x=C)}return a(x);case T0:e:{for(E=b.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){i(x,w.sibling),w=n(w,b.children||[]),w.return=x,x=w;break e}else{i(x,w);break}else t(x,w);w=w.sibling}w=jP(b,x.mode,C),w.return=x,x=w}return a(x);case ip:return E=b._init,y(x,w,E(b._payload),C)}if(Px(b))return m(x,w,b,C);if(N1(b))return g(x,w,b,C);aE(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(i(x,w.sibling),w=n(w,b),w.return=x,x=w):(i(x,w),w=UP(b,x.mode,C),w.return=x,x=w),a(x)):i(x,w)}return y}var wy=gX(!0),vX=gX(!1),QT=Jp(null),JT=null,L0=null,pk=null;function mk(){pk=L0=JT=null}function gk(e){var t=QT.current;Pn(QT),e._currentValue=t}function IR(e,t,i){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===i)break;e=e.return}}function ey(e,t){JT=e,pk=L0=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Sl=!0),e.firstContext=null)}function Uu(e){var t=e._currentValue;if(pk!==e)if(e={context:e,memoizedValue:t,next:null},L0===null){if(JT===null)throw Error(zt(308));L0=e,JT.dependencies={lanes:0,firstContext:e}}else L0=L0.next=e;return t}var mg=null;function vk(e){mg===null?mg=[e]:mg.push(e)}function yX(e,t,i,r){var n=t.interleaved;return n===null?(i.next=i,vk(t)):(i.next=n.next,n.next=i),t.interleaved=i,sf(e,r)}function sf(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var rp=!1;function yk(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xX(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zd(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Lp(e,t,i){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,kr&2){var n=r.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),r.pending=t,sf(e,i)}return n=r.interleaved,n===null?(t.next=t,vk(r)):(t.next=n.next,n.next=t),r.interleaved=t,sf(e,i)}function sT(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,i|=r,t.lanes=i,rk(e,i)}}function OU(e,t){var i=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,i===r)){var n=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var a={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?n=s=a:s=s.next=a,i=i.next}while(i!==null);s===null?n=s=t:s=s.next=t}else n=s=t;i={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function eC(e,t,i,r){var n=e.updateQueue;rp=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=n.baseState;a=0,c=u=l=null,o=s;do{var d=o.lane,f=o.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(d=t,f=i,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(f,h,d):m,d==null)break e;h=Vn({},h,d);break e;case 2:rp=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=n.effects,d===null?n.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,a|=d;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;d=o,o=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(!0);if(c===null&&(l=h),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,t=n.shared.interleaved,t!==null){n=t;do a|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);jg|=a,e.lanes=a,e.memoizedState=h}}function RU(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],n=r.callback;if(n!==null){if(r.callback=null,r=i,typeof n!="function")throw Error(zt(191,n));n.call(r)}}}var B_={},Ch=Jp(B_),Gb=Jp(B_),qb=Jp(B_);function gg(e){if(e===B_)throw Error(zt(174));return e}function xk(e,t){switch(xn(qb,t),xn(Gb,e),xn(Ch,B_),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:hR(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=hR(t,e)}Pn(Ch),xn(Ch,t)}function Ey(){Pn(Ch),Pn(Gb),Pn(qb)}function bX(e){gg(qb.current);var t=gg(Ch.current),i=hR(t,e.type);t!==i&&(xn(Gb,e),xn(Ch,i))}function bk(e){Gb.current===e&&(Pn(Ch),Pn(Gb))}var Bn=Jp(0);function tC(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var LP=[];function _k(){for(var e=0;e<LP.length;e++)LP[e]._workInProgressVersionPrimary=null;LP.length=0}var aT=pf.ReactCurrentDispatcher,NP=pf.ReactCurrentBatchConfig,Ug=0,Un=null,Ys=null,ga=null,iC=!1,rb=!1,Yb=0,spe=0;function eo(){throw Error(zt(321))}function wk(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Sc(e[i],t[i]))return!1;return!0}function Ek(e,t,i,r,n,s){if(Ug=s,Un=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,aT.current=e===null||e.memoizedState===null?upe:cpe,e=i(r,n),rb){s=0;do{if(rb=!1,Yb=0,25<=s)throw Error(zt(301));s+=1,ga=Ys=null,t.updateQueue=null,aT.current=hpe,e=i(r,n)}while(rb)}if(aT.current=rC,t=Ys!==null&&Ys.next!==null,Ug=0,ga=Ys=Un=null,iC=!1,t)throw Error(zt(300));return e}function Sk(){var e=Yb!==0;return Yb=0,e}function ah(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ga===null?Un.memoizedState=ga=e:ga=ga.next=e,ga}function ju(){if(Ys===null){var e=Un.alternate;e=e!==null?e.memoizedState:null}else e=Ys.next;var t=ga===null?Un.memoizedState:ga.next;if(t!==null)ga=t,Ys=e;else{if(e===null)throw Error(zt(310));Ys=e,e={memoizedState:Ys.memoizedState,baseState:Ys.baseState,baseQueue:Ys.baseQueue,queue:Ys.queue,next:null},ga===null?Un.memoizedState=ga=e:ga=ga.next=e}return ga}function Xb(e,t){return typeof t=="function"?t(e):t}function kP(e){var t=ju(),i=t.queue;if(i===null)throw Error(zt(311));i.lastRenderedReducer=e;var r=Ys,n=r.baseQueue,s=i.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}r.baseQueue=n=s,i.pending=null}if(n!==null){s=n.next,r=r.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((Ug&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=r):l=l.next=h,Un.lanes|=c,jg|=c}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,Sc(r,t.memoizedState)||(Sl=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,i.lastRenderedState=r}if(e=i.interleaved,e!==null){n=e;do s=n.lane,Un.lanes|=s,jg|=s,n=n.next;while(n!==e)}else n===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function BP(e){var t=ju(),i=t.queue;if(i===null)throw Error(zt(311));i.lastRenderedReducer=e;var r=i.dispatch,n=i.pending,s=t.memoizedState;if(n!==null){i.pending=null;var a=n=n.next;do s=e(s,a.action),a=a.next;while(a!==n);Sc(s,t.memoizedState)||(Sl=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,r]}function _X(){}function wX(e,t){var i=Un,r=ju(),n=t(),s=!Sc(r.memoizedState,n);if(s&&(r.memoizedState=n,Sl=!0),r=r.queue,Tk(TX.bind(null,i,r,e),[e]),r.getSnapshot!==t||s||ga!==null&&ga.memoizedState.tag&1){if(i.flags|=2048,Kb(9,SX.bind(null,i,r,n,t),void 0,null),Sa===null)throw Error(zt(349));Ug&30||EX(i,t,n)}return n}function EX(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=Un.updateQueue,t===null?(t={lastEffect:null,stores:null},Un.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function SX(e,t,i,r){t.value=i,t.getSnapshot=r,CX(t)&&AX(e)}function TX(e,t,i){return i(function(){CX(t)&&AX(e)})}function CX(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Sc(e,i)}catch{return!0}}function AX(e){var t=sf(e,1);t!==null&&_c(t,e,1,-1)}function LU(e){var t=ah();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xb,lastRenderedState:e},t.queue=e,e=e.dispatch=lpe.bind(null,Un,e),[t.memoizedState,e]}function Kb(e,t,i,r){return e={tag:e,create:t,destroy:i,deps:r,next:null},t=Un.updateQueue,t===null?(t={lastEffect:null,stores:null},Un.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(r=i.next,i.next=e,e.next=r,t.lastEffect=e)),e}function MX(){return ju().memoizedState}function oT(e,t,i,r){var n=ah();Un.flags|=e,n.memoizedState=Kb(1|t,i,void 0,r===void 0?null:r)}function YA(e,t,i,r){var n=ju();r=r===void 0?null:r;var s=void 0;if(Ys!==null){var a=Ys.memoizedState;if(s=a.destroy,r!==null&&wk(r,a.deps)){n.memoizedState=Kb(t,i,s,r);return}}Un.flags|=e,n.memoizedState=Kb(1|t,i,s,r)}function NU(e,t){return oT(8390656,8,e,t)}function Tk(e,t){return YA(2048,8,e,t)}function PX(e,t){return YA(4,2,e,t)}function DX(e,t){return YA(4,4,e,t)}function IX(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function OX(e,t,i){return i=i!=null?i.concat([e]):null,YA(4,4,IX.bind(null,t,e),i)}function Ck(){}function RX(e,t){var i=ju();t=t===void 0?null:t;var r=i.memoizedState;return r!==null&&t!==null&&wk(t,r[1])?r[0]:(i.memoizedState=[e,t],e)}function LX(e,t){var i=ju();t=t===void 0?null:t;var r=i.memoizedState;return r!==null&&t!==null&&wk(t,r[1])?r[0]:(e=e(),i.memoizedState=[e,t],e)}function NX(e,t,i){return Ug&21?(Sc(i,t)||(i=UY(),Un.lanes|=i,jg|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Sl=!0),e.memoizedState=i)}function ape(e,t){var i=Jr;Jr=i!==0&&4>i?i:4,e(!0);var r=NP.transition;NP.transition={};try{e(!1),t()}finally{Jr=i,NP.transition=r}}function kX(){return ju().memoizedState}function ope(e,t,i){var r=kp(e);if(i={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null},BX(e))zX(t,i);else if(i=yX(e,t,i,r),i!==null){var n=qo();_c(i,e,r,n),FX(i,t,r)}}function lpe(e,t,i){var r=kp(e),n={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null};if(BX(e))zX(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,i);if(n.hasEagerState=!0,n.eagerState=o,Sc(o,a)){var l=t.interleaved;l===null?(n.next=n,vk(t)):(n.next=l.next,l.next=n),t.interleaved=n;return}}catch{}finally{}i=yX(e,t,n,r),i!==null&&(n=qo(),_c(i,e,r,n),FX(i,t,r))}}function BX(e){var t=e.alternate;return e===Un||t!==null&&t===Un}function zX(e,t){rb=iC=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function FX(e,t,i){if(i&4194240){var r=t.lanes;r&=e.pendingLanes,i|=r,t.lanes=i,rk(e,i)}}var rC={readContext:Uu,useCallback:eo,useContext:eo,useEffect:eo,useImperativeHandle:eo,useInsertionEffect:eo,useLayoutEffect:eo,useMemo:eo,useReducer:eo,useRef:eo,useState:eo,useDebugValue:eo,useDeferredValue:eo,useTransition:eo,useMutableSource:eo,useSyncExternalStore:eo,useId:eo,unstable_isNewReconciler:!1},upe={readContext:Uu,useCallback:function(e,t){return ah().memoizedState=[e,t===void 0?null:t],e},useContext:Uu,useEffect:NU,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,oT(4194308,4,IX.bind(null,t,e),i)},useLayoutEffect:function(e,t){return oT(4194308,4,e,t)},useInsertionEffect:function(e,t){return oT(4,2,e,t)},useMemo:function(e,t){var i=ah();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var r=ah();return t=i!==void 0?i(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ope.bind(null,Un,e),[r.memoizedState,e]},useRef:function(e){var t=ah();return e={current:e},t.memoizedState=e},useState:LU,useDebugValue:Ck,useDeferredValue:function(e){return ah().memoizedState=e},useTransition:function(){var e=LU(!1),t=e[0];return e=ape.bind(null,e[1]),ah().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var r=Un,n=ah();if(In){if(i===void 0)throw Error(zt(407));i=i()}else{if(i=t(),Sa===null)throw Error(zt(349));Ug&30||EX(r,t,i)}n.memoizedState=i;var s={value:i,getSnapshot:t};return n.queue=s,NU(TX.bind(null,r,s,e),[e]),r.flags|=2048,Kb(9,SX.bind(null,r,s,i,t),void 0,null),i},useId:function(){var e=ah(),t=Sa.identifierPrefix;if(In){var i=Wd,r=Hd;i=(r&~(1<<32-bc(r)-1)).toString(32)+i,t=":"+t+"R"+i,i=Yb++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=spe++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cpe={readContext:Uu,useCallback:RX,useContext:Uu,useEffect:Tk,useImperativeHandle:OX,useInsertionEffect:PX,useLayoutEffect:DX,useMemo:LX,useReducer:kP,useRef:MX,useState:function(){return kP(Xb)},useDebugValue:Ck,useDeferredValue:function(e){var t=ju();return NX(t,Ys.memoizedState,e)},useTransition:function(){var e=kP(Xb)[0],t=ju().memoizedState;return[e,t]},useMutableSource:_X,useSyncExternalStore:wX,useId:kX,unstable_isNewReconciler:!1},hpe={readContext:Uu,useCallback:RX,useContext:Uu,useEffect:Tk,useImperativeHandle:OX,useInsertionEffect:PX,useLayoutEffect:DX,useMemo:LX,useReducer:BP,useRef:MX,useState:function(){return BP(Xb)},useDebugValue:Ck,useDeferredValue:function(e){var t=ju();return Ys===null?t.memoizedState=e:NX(t,Ys.memoizedState,e)},useTransition:function(){var e=BP(Xb)[0],t=ju().memoizedState;return[e,t]},useMutableSource:_X,useSyncExternalStore:wX,useId:kX,unstable_isNewReconciler:!1};function hc(e,t){if(e&&e.defaultProps){t=Vn({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function OR(e,t,i,r){t=e.memoizedState,i=i(r,t),i=i==null?t:Vn({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var XA={isMounted:function(e){return(e=e._reactInternals)?iv(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var r=qo(),n=kp(e),s=Zd(r,n);s.payload=t,i!=null&&(s.callback=i),t=Lp(e,s,n),t!==null&&(_c(t,e,n,r),sT(t,e,n))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var r=qo(),n=kp(e),s=Zd(r,n);s.tag=1,s.payload=t,i!=null&&(s.callback=i),t=Lp(e,s,n),t!==null&&(_c(t,e,n,r),sT(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=qo(),r=kp(e),n=Zd(i,r);n.tag=2,t!=null&&(n.callback=t),t=Lp(e,n,r),t!==null&&(_c(t,e,r,i),sT(t,e,r))}};function kU(e,t,i,r,n,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,a):t.prototype&&t.prototype.isPureReactComponent?!jb(i,r)||!jb(n,s):!0}function UX(e,t,i){var r=!1,n=Gp,s=t.contextType;return typeof s=="object"&&s!==null?s=Uu(s):(n=Pl(t)?zg:vo.current,r=t.contextTypes,s=(r=r!=null)?by(e,n):Gp),t=new t(i,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=XA,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function BU(e,t,i,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,r),t.state!==e&&XA.enqueueReplaceState(t,t.state,null)}function RR(e,t,i,r){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs={},yk(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=Uu(s):(s=Pl(t)?zg:vo.current,n.context=by(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(OR(e,t,s,i),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&XA.enqueueReplaceState(n,n.state,null),eC(e,i,n,r),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function Sy(e,t){try{var i="",r=t;do i+=Fde(r),r=r.return;while(r);var n=i}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n,digest:null}}function zP(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function LR(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var dpe=typeof WeakMap=="function"?WeakMap:Map;function jX(e,t,i){i=Zd(-1,i),i.tag=3,i.payload={element:null};var r=t.value;return i.callback=function(){sC||(sC=!0,WR=r),LR(e,t)},i}function VX(e,t,i){i=Zd(-1,i),i.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var n=t.value;i.payload=function(){return r(n)},i.callback=function(){LR(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){LR(e,t),typeof r!="function"&&(Np===null?Np=new Set([this]):Np.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),i}function zU(e,t,i){var r=e.pingCache;if(r===null){r=e.pingCache=new dpe;var n=new Set;r.set(t,n)}else n=r.get(t),n===void 0&&(n=new Set,r.set(t,n));n.has(i)||(n.add(i),e=Cpe.bind(null,e,t,i),t.then(e,e))}function FU(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function UU(e,t,i,r,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=Zd(-1,1),t.tag=2,Lp(i,t,1))),i.lanes|=1),e)}var fpe=pf.ReactCurrentOwner,Sl=!1;function ko(e,t,i,r){t.child=e===null?vX(t,null,i,r):wy(t,e.child,i,r)}function jU(e,t,i,r,n){i=i.render;var s=t.ref;return ey(t,n),r=Ek(e,t,i,r,s,n),i=Sk(),e!==null&&!Sl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,af(e,t,n)):(In&&i&&hk(t),t.flags|=1,ko(e,t,r,n),t.child)}function VU(e,t,i,r,n){if(e===null){var s=i.type;return typeof s=="function"&&!Lk(s)&&s.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=s,HX(e,t,s,r,n)):(e=hT(i.type,null,r,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&n)){var a=s.memoizedProps;if(i=i.compare,i=i!==null?i:jb,i(a,r)&&e.ref===t.ref)return af(e,t,n)}return t.flags|=1,e=Bp(s,r),e.ref=t.ref,e.return=t,t.child=e}function HX(e,t,i,r,n){if(e!==null){var s=e.memoizedProps;if(jb(s,r)&&e.ref===t.ref)if(Sl=!1,t.pendingProps=r=s,(e.lanes&n)!==0)e.flags&131072&&(Sl=!0);else return t.lanes=e.lanes,af(e,t,n)}return NR(e,t,i,r,n)}function WX(e,t,i){var r=t.pendingProps,n=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xn(k0,$l),$l|=i;else{if(!(i&1073741824))return e=s!==null?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xn(k0,$l),$l|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:i,xn(k0,$l),$l|=r}else s!==null?(r=s.baseLanes|i,t.memoizedState=null):r=i,xn(k0,$l),$l|=r;return ko(e,t,n,i),t.child}function GX(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function NR(e,t,i,r,n){var s=Pl(i)?zg:vo.current;return s=by(t,s),ey(t,n),i=Ek(e,t,i,r,s,n),r=Sk(),e!==null&&!Sl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,af(e,t,n)):(In&&r&&hk(t),t.flags|=1,ko(e,t,i,n),t.child)}function HU(e,t,i,r,n){if(Pl(i)){var s=!0;KT(t)}else s=!1;if(ey(t,n),t.stateNode===null)lT(e,t),UX(t,i,r),RR(t,i,r,n),r=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=i.contextType;typeof u=="object"&&u!==null?u=Uu(u):(u=Pl(i)?zg:vo.current,u=by(t,u));var c=i.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&BU(t,a,r,u),rp=!1;var d=t.memoizedState;a.state=d,eC(t,r,a,n),l=t.memoizedState,o!==r||d!==l||Ml.current||rp?(typeof c=="function"&&(OR(t,i,c,r),l=t.memoizedState),(o=rp||kU(t,i,o,r,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,xX(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:hc(t.type,o),a.props=u,h=t.pendingProps,d=a.context,l=i.contextType,typeof l=="object"&&l!==null?l=Uu(l):(l=Pl(i)?zg:vo.current,l=by(t,l));var f=i.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&BU(t,a,r,l),rp=!1,d=t.memoizedState,a.state=d,eC(t,r,a,n);var m=t.memoizedState;o!==h||d!==m||Ml.current||rp?(typeof f=="function"&&(OR(t,i,f,r),m=t.memoizedState),(u=rp||kU(t,i,u,r,d,m,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),a.props=r,a.state=m,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return kR(e,t,i,r,s,n)}function kR(e,t,i,r,n,s){GX(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return n&&MU(t,i,!1),af(e,t,s);r=t.stateNode,fpe.current=t;var o=a&&typeof i.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=wy(t,e.child,null,s),t.child=wy(t,null,o,s)):ko(e,t,o,s),t.memoizedState=r.state,n&&MU(t,i,!0),t.child}function qX(e){var t=e.stateNode;t.pendingContext?AU(e,t.pendingContext,t.pendingContext!==t.context):t.context&&AU(e,t.context,!1),xk(e,t.containerInfo)}function WU(e,t,i,r,n){return _y(),fk(n),t.flags|=256,ko(e,t,i,r),t.child}var BR={dehydrated:null,treeContext:null,retryLane:0};function zR(e){return{baseLanes:e,cachePool:null,transitions:null}}function YX(e,t,i){var r=t.pendingProps,n=Bn.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),xn(Bn,n&1),e===null)return DR(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,s?(r=t.mode,s=t.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=ZA(a,r,0,null),e=Mg(e,r,i,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zR(i),t.memoizedState=BR,e):Ak(t,a));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return ppe(e,t,a,r,o,n,i);if(s){s=r.fallback,a=t.mode,n=e.child,o=n.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&t.child!==n?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Bp(n,l),r.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=Bp(o,s):(s=Mg(s,a,i,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,a=e.child.memoizedState,a=a===null?zR(i):{baseLanes:a.baseLanes|i,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~i,t.memoizedState=BR,r}return s=e.child,e=s.sibling,r=Bp(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=i),r.return=t,r.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function Ak(e,t){return t=ZA({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function oE(e,t,i,r){return r!==null&&fk(r),wy(t,e.child,null,i),e=Ak(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ppe(e,t,i,r,n,s,a){if(i)return t.flags&256?(t.flags&=-257,r=zP(Error(zt(422))),oE(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,n=t.mode,r=ZA({mode:"visible",children:r.children},n,0,null),s=Mg(s,n,a,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&wy(t,e.child,null,a),t.child.memoizedState=zR(a),t.memoizedState=BR,s);if(!(t.mode&1))return oE(e,t,a,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(zt(419)),r=zP(s,r,void 0),oE(e,t,a,r)}if(o=(a&e.childLanes)!==0,Sl||o){if(r=Sa,r!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,sf(e,n),_c(r,e,n,-1))}return Rk(),r=zP(Error(zt(421))),oE(e,t,a,r)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=Ape.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,Ql=Rp(n.nextSibling),eu=t,In=!0,fc=null,e!==null&&(Pu[Du++]=Hd,Pu[Du++]=Wd,Pu[Du++]=Fg,Hd=e.id,Wd=e.overflow,Fg=t),t=Ak(t,r.children),t.flags|=4096,t)}function GU(e,t,i){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),IR(e.return,t,i)}function FP(e,t,i,r,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=i,s.tailMode=n)}function XX(e,t,i){var r=t.pendingProps,n=r.revealOrder,s=r.tail;if(ko(e,t,r.children,i),r=Bn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&GU(e,i,t);else if(e.tag===19)GU(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(xn(Bn,r),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(i=t.child,n=null;i!==null;)e=i.alternate,e!==null&&tC(e)===null&&(n=i),i=i.sibling;i=n,i===null?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),FP(t,!1,n,i,s);break;case"backwards":for(i=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&tC(e)===null){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}FP(t,!0,i,null,s);break;case"together":FP(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function lT(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function af(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),jg|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(zt(153));if(t.child!==null){for(e=t.child,i=Bp(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Bp(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function mpe(e,t,i){switch(t.tag){case 3:qX(t),_y();break;case 5:bX(t);break;case 1:Pl(t.type)&&KT(t);break;case 4:xk(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,n=t.memoizedProps.value;xn(QT,r._currentValue),r._currentValue=n;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(xn(Bn,Bn.current&1),t.flags|=128,null):i&t.child.childLanes?YX(e,t,i):(xn(Bn,Bn.current&1),e=af(e,t,i),e!==null?e.sibling:null);xn(Bn,Bn.current&1);break;case 19:if(r=(i&t.childLanes)!==0,e.flags&128){if(r)return XX(e,t,i);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),xn(Bn,Bn.current),r)break;return null;case 22:case 23:return t.lanes=0,WX(e,t,i)}return af(e,t,i)}var KX,FR,$X,ZX;KX=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};FR=function(){};$X=function(e,t,i,r){var n=e.memoizedProps;if(n!==r){e=t.stateNode,gg(Ch.current);var s=null;switch(i){case"input":n=oR(e,n),r=oR(e,r),s=[];break;case"select":n=Vn({},n,{value:void 0}),r=Vn({},r,{value:void 0}),s=[];break;case"textarea":n=cR(e,n),r=cR(e,r),s=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=YT)}dR(i,r);var a;i=null;for(u in n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var o=n[u];for(a in o)o.hasOwnProperty(a)&&(i||(i={}),i[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Lb.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=n!=null?n[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(i||(i={}),i[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(i||(i={}),i[a]=l[a])}else i||(s||(s=[]),s.push(u,i)),i=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Lb.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Cn("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}i&&(s=s||[]).push("style",i);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};ZX=function(e,t,i,r){i!==r&&(t.flags|=4)};function j1(e,t){if(!In)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function to(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,r=0;if(t)for(var n=e.child;n!==null;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=i,t}function gpe(e,t,i){var r=t.pendingProps;switch(dk(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return to(t),null;case 1:return Pl(t.type)&&XT(),to(t),null;case 3:return r=t.stateNode,Ey(),Pn(Ml),Pn(vo),_k(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(sE(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fc!==null&&(YR(fc),fc=null))),FR(e,t),to(t),null;case 5:bk(t);var n=gg(qb.current);if(i=t.type,e!==null&&t.stateNode!=null)$X(e,t,i,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(zt(166));return to(t),null}if(e=gg(Ch.current),sE(t)){r=t.stateNode,i=t.type;var s=t.memoizedProps;switch(r[dh]=t,r[Wb]=s,e=(t.mode&1)!==0,i){case"dialog":Cn("cancel",r),Cn("close",r);break;case"iframe":case"object":case"embed":Cn("load",r);break;case"video":case"audio":for(n=0;n<Ix.length;n++)Cn(Ix[n],r);break;case"source":Cn("error",r);break;case"img":case"image":case"link":Cn("error",r),Cn("load",r);break;case"details":Cn("toggle",r);break;case"input":eU(r,s),Cn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Cn("invalid",r);break;case"textarea":iU(r,s),Cn("invalid",r)}dR(i,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&nE(r.textContent,o,e),n=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&nE(r.textContent,o,e),n=["children",""+o]):Lb.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Cn("scroll",r)}switch(i){case"input":$w(r),tU(r,s,!0);break;case"textarea":$w(r),rU(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=YT)}r=n,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=TY(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(i,{is:r.is}):(e=a.createElement(i),i==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,i),e[dh]=t,e[Wb]=r,KX(e,t,!1,!1),t.stateNode=e;e:{switch(a=fR(i,r),i){case"dialog":Cn("cancel",e),Cn("close",e),n=r;break;case"iframe":case"object":case"embed":Cn("load",e),n=r;break;case"video":case"audio":for(n=0;n<Ix.length;n++)Cn(Ix[n],e);n=r;break;case"source":Cn("error",e),n=r;break;case"img":case"image":case"link":Cn("error",e),Cn("load",e),n=r;break;case"details":Cn("toggle",e),n=r;break;case"input":eU(e,r),n=oR(e,r),Cn("invalid",e);break;case"option":n=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},n=Vn({},r,{value:void 0}),Cn("invalid",e);break;case"textarea":iU(e,r),n=cR(e,r),Cn("invalid",e);break;default:n=r}dR(i,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?MY(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&CY(e,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&Nb(e,l):typeof l=="number"&&Nb(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Lb.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Cn("scroll",e):l!=null&&ZN(e,s,l,a))}switch(i){case"input":$w(e),tU(e,r,!1);break;case"textarea":$w(e),rU(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Wp(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?$0(e,!!r.multiple,s,!1):r.defaultValue!=null&&$0(e,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=YT)}switch(i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return to(t),null;case 6:if(e&&t.stateNode!=null)ZX(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(zt(166));if(i=gg(qb.current),gg(Ch.current),sE(t)){if(r=t.stateNode,i=t.memoizedProps,r[dh]=t,(s=r.nodeValue!==i)&&(e=eu,e!==null))switch(e.tag){case 3:nE(r.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&nE(r.nodeValue,i,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(i.nodeType===9?i:i.ownerDocument).createTextNode(r),r[dh]=t,t.stateNode=r}return to(t),null;case 13:if(Pn(Bn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(In&&Ql!==null&&t.mode&1&&!(t.flags&128))mX(),_y(),t.flags|=98560,s=!1;else if(s=sE(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(zt(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(zt(317));s[dh]=t}else _y(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;to(t),s=!1}else fc!==null&&(YR(fc),fc=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Bn.current&1?Qs===0&&(Qs=3):Rk())),t.updateQueue!==null&&(t.flags|=4),to(t),null);case 4:return Ey(),FR(e,t),e===null&&Vb(t.stateNode.containerInfo),to(t),null;case 10:return gk(t.type._context),to(t),null;case 17:return Pl(t.type)&&XT(),to(t),null;case 19:if(Pn(Bn),s=t.memoizedState,s===null)return to(t),null;if(r=(t.flags&128)!==0,a=s.rendering,a===null)if(r)j1(s,!1);else{if(Qs!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=tC(e),a!==null){for(t.flags|=128,j1(s,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=i,i=t.child;i!==null;)s=i,e=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return xn(Bn,Bn.current&1|2),t.child}e=e.sibling}s.tail!==null&&ps()>Ty&&(t.flags|=128,r=!0,j1(s,!1),t.lanes=4194304)}else{if(!r)if(e=tC(a),e!==null){if(t.flags|=128,r=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),j1(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!In)return to(t),null}else 2*ps()-s.renderingStartTime>Ty&&i!==1073741824&&(t.flags|=128,r=!0,j1(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(i=s.last,i!==null?i.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ps(),t.sibling=null,i=Bn.current,xn(Bn,r?i&1|2:i&1),t):(to(t),null);case 22:case 23:return Ok(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$l&1073741824&&(to(t),t.subtreeFlags&6&&(t.flags|=8192)):to(t),null;case 24:return null;case 25:return null}throw Error(zt(156,t.tag))}function vpe(e,t){switch(dk(t),t.tag){case 1:return Pl(t.type)&&XT(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ey(),Pn(Ml),Pn(vo),_k(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bk(t),null;case 13:if(Pn(Bn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(zt(340));_y()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Pn(Bn),null;case 4:return Ey(),null;case 10:return gk(t.type._context),null;case 22:case 23:return Ok(),null;case 24:return null;default:return null}}var lE=!1,co=!1,ype=typeof WeakSet=="function"?WeakSet:Set,ni=null;function N0(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(r){$n(e,t,r)}else i.current=null}function UR(e,t,i){try{i()}catch(r){$n(e,t,r)}}var qU=!1;function xpe(e,t){if(ER=WT,e=iX(),ck(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var r=i.getSelection&&i.getSelection();if(r&&r.rangeCount!==0){i=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=e,d=null;t:for(;;){for(var f;h!==i||n!==0&&h.nodeType!==3||(o=a+n),h!==s||r!==0&&h.nodeType!==3||(l=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===e)break t;if(d===i&&++u===n&&(o=a),d===s&&++c===r&&(l=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}i=o===-1||l===-1?null:{start:o,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(SR={focusedElem:e,selectionRange:i},WT=!1,ni=t;ni!==null;)if(t=ni,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ni=e;else for(;ni!==null;){t=ni;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:hc(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(zt(163))}}catch(C){$n(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,ni=e;break}ni=t.return}return m=qU,qU=!1,m}function nb(e,t,i){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&UR(t,i,s)}n=n.next}while(n!==r)}}function KA(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var r=i.create;i.destroy=r()}i=i.next}while(i!==t)}}function jR(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function QX(e){var t=e.alternate;t!==null&&(e.alternate=null,QX(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[dh],delete t[Wb],delete t[AR],delete t[tpe],delete t[ipe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function JX(e){return e.tag===5||e.tag===3||e.tag===4}function YU(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||JX(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function VR(e,t,i){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=YT));else if(r!==4&&(e=e.child,e!==null))for(VR(e,t,i),e=e.sibling;e!==null;)VR(e,t,i),e=e.sibling}function HR(e,t,i){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(HR(e,t,i),e=e.sibling;e!==null;)HR(e,t,i),e=e.sibling}var Na=null,dc=!1;function If(e,t,i){for(i=i.child;i!==null;)eK(e,t,i),i=i.sibling}function eK(e,t,i){if(Th&&typeof Th.onCommitFiberUnmount=="function")try{Th.onCommitFiberUnmount(jA,i)}catch{}switch(i.tag){case 5:co||N0(i,t);case 6:var r=Na,n=dc;Na=null,If(e,t,i),Na=r,dc=n,Na!==null&&(dc?(e=Na,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Na.removeChild(i.stateNode));break;case 18:Na!==null&&(dc?(e=Na,i=i.stateNode,e.nodeType===8?OP(e.parentNode,i):e.nodeType===1&&OP(e,i),Fb(e)):OP(Na,i.stateNode));break;case 4:r=Na,n=dc,Na=i.stateNode.containerInfo,dc=!0,If(e,t,i),Na=r,dc=n;break;case 0:case 11:case 14:case 15:if(!co&&(r=i.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&UR(i,t,a),n=n.next}while(n!==r)}If(e,t,i);break;case 1:if(!co&&(N0(i,t),r=i.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=i.memoizedProps,r.state=i.memoizedState,r.componentWillUnmount()}catch(o){$n(i,t,o)}If(e,t,i);break;case 21:If(e,t,i);break;case 22:i.mode&1?(co=(r=co)||i.memoizedState!==null,If(e,t,i),co=r):If(e,t,i);break;default:If(e,t,i)}}function XU(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new ype),t.forEach(function(r){var n=Mpe.bind(null,e,r);i.has(r)||(i.add(r),r.then(n,n))})}}function Qu(e,t){var i=t.deletions;if(i!==null)for(var r=0;r<i.length;r++){var n=i[r];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Na=o.stateNode,dc=!1;break e;case 3:Na=o.stateNode.containerInfo,dc=!0;break e;case 4:Na=o.stateNode.containerInfo,dc=!0;break e}o=o.return}if(Na===null)throw Error(zt(160));eK(s,a,n),Na=null,dc=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(u){$n(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tK(t,e),t=t.sibling}function tK(e,t){var i=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Qu(t,e),Wc(e),r&4){try{nb(3,e,e.return),KA(3,e)}catch(g){$n(e,e.return,g)}try{nb(5,e,e.return)}catch(g){$n(e,e.return,g)}}break;case 1:Qu(t,e),Wc(e),r&512&&i!==null&&N0(i,i.return);break;case 5:if(Qu(t,e),Wc(e),r&512&&i!==null&&N0(i,i.return),e.flags&32){var n=e.stateNode;try{Nb(n,"")}catch(g){$n(e,e.return,g)}}if(r&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,a=i!==null?i.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&EY(n,s),fR(o,a);var u=fR(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?MY(n,h):c==="dangerouslySetInnerHTML"?CY(n,h):c==="children"?Nb(n,h):ZN(n,c,h,u)}switch(o){case"input":lR(n,s);break;case"textarea":SY(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?$0(n,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?$0(n,!!s.multiple,s.defaultValue,!0):$0(n,!!s.multiple,s.multiple?[]:"",!1))}n[Wb]=s}catch(g){$n(e,e.return,g)}}break;case 6:if(Qu(t,e),Wc(e),r&4){if(e.stateNode===null)throw Error(zt(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(g){$n(e,e.return,g)}}break;case 3:if(Qu(t,e),Wc(e),r&4&&i!==null&&i.memoizedState.isDehydrated)try{Fb(t.containerInfo)}catch(g){$n(e,e.return,g)}break;case 4:Qu(t,e),Wc(e);break;case 13:Qu(t,e),Wc(e),n=e.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(Dk=ps())),r&4&&XU(e);break;case 22:if(c=i!==null&&i.memoizedState!==null,e.mode&1?(co=(u=co)||c,Qu(t,e),co=u):Qu(t,e),Wc(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(ni=e,c=e.child;c!==null;){for(h=ni=c;ni!==null;){switch(d=ni,f=d.child,d.tag){case 0:case 11:case 14:case 15:nb(4,d,d.return);break;case 1:N0(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,i=d.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){$n(r,i,g)}}break;case 5:N0(d,d.return);break;case 22:if(d.memoizedState!==null){$U(h);continue}}f!==null?(f.return=d,ni=f):$U(h)}c=c.sibling}e:for(c=null,h=e;;){if(h.tag===5){if(c===null){c=h;try{n=h.stateNode,u?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=AY("display",a))}catch(g){$n(e,e.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){$n(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Qu(t,e),Wc(e),r&4&&XU(e);break;case 21:break;default:Qu(t,e),Wc(e)}}function Wc(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(JX(i)){var r=i;break e}i=i.return}throw Error(zt(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(Nb(n,""),r.flags&=-33);var s=YU(e);HR(e,s,n);break;case 3:case 4:var a=r.stateNode.containerInfo,o=YU(e);VR(e,o,a);break;default:throw Error(zt(161))}}catch(l){$n(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bpe(e,t,i){ni=e,iK(e)}function iK(e,t,i){for(var r=(e.mode&1)!==0;ni!==null;){var n=ni,s=n.child;if(n.tag===22&&r){var a=n.memoizedState!==null||lE;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||co;o=lE;var u=co;if(lE=a,(co=l)&&!u)for(ni=n;ni!==null;)a=ni,l=a.child,a.tag===22&&a.memoizedState!==null?ZU(n):l!==null?(l.return=a,ni=l):ZU(n);for(;s!==null;)ni=s,iK(s),s=s.sibling;ni=n,lE=o,co=u}KU(e)}else n.subtreeFlags&8772&&s!==null?(s.return=n,ni=s):KU(e)}}function KU(e){for(;ni!==null;){var t=ni;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:co||KA(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!co)if(i===null)r.componentDidMount();else{var n=t.elementType===t.type?i.memoizedProps:hc(t.type,i.memoizedProps);r.componentDidUpdate(n,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&RU(t,s,r);break;case 3:var a=t.updateQueue;if(a!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}RU(t,a,i)}break;case 5:var o=t.stateNode;if(i===null&&t.flags&4){i=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Fb(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(zt(163))}co||t.flags&512&&jR(t)}catch(d){$n(t,t.return,d)}}if(t===e){ni=null;break}if(i=t.sibling,i!==null){i.return=t.return,ni=i;break}ni=t.return}}function $U(e){for(;ni!==null;){var t=ni;if(t===e){ni=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ni=i;break}ni=t.return}}function ZU(e){for(;ni!==null;){var t=ni;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{KA(4,t)}catch(l){$n(t,i,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var n=t.return;try{r.componentDidMount()}catch(l){$n(t,n,l)}}var s=t.return;try{jR(t)}catch(l){$n(t,s,l)}break;case 5:var a=t.return;try{jR(t)}catch(l){$n(t,a,l)}}}catch(l){$n(t,t.return,l)}if(t===e){ni=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ni=o;break}ni=t.return}}var _pe=Math.ceil,nC=pf.ReactCurrentDispatcher,Mk=pf.ReactCurrentOwner,ku=pf.ReactCurrentBatchConfig,kr=0,Sa=null,Ps=null,Ha=0,$l=0,k0=Jp(0),Qs=0,$b=null,jg=0,$A=0,Pk=0,sb=null,xl=null,Dk=0,Ty=1/0,Rd=null,sC=!1,WR=null,Np=null,uE=!1,vp=null,aC=0,ab=0,GR=null,uT=-1,cT=0;function qo(){return kr&6?ps():uT!==-1?uT:uT=ps()}function kp(e){return e.mode&1?kr&2&&Ha!==0?Ha&-Ha:npe.transition!==null?(cT===0&&(cT=UY()),cT):(e=Jr,e!==0||(e=window.event,e=e===void 0?16:YY(e.type)),e):1}function _c(e,t,i,r){if(50<ab)throw ab=0,GR=null,Error(zt(185));L_(e,i,r),(!(kr&2)||e!==Sa)&&(e===Sa&&(!(kr&2)&&($A|=i),Qs===4&&lp(e,Ha)),Dl(e,r),i===1&&kr===0&&!(t.mode&1)&&(Ty=ps()+500,qA&&em()))}function Dl(e,t){var i=e.callbackNode;nfe(e,t);var r=HT(e,e===Sa?Ha:0);if(r===0)i!==null&&aU(i),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(i!=null&&aU(i),t===1)e.tag===0?rpe(QU.bind(null,e)):dX(QU.bind(null,e)),Jfe(function(){!(kr&6)&&em()}),i=null;else{switch(jY(r)){case 1:i=ik;break;case 4:i=zY;break;case 16:i=VT;break;case 536870912:i=FY;break;default:i=VT}i=cK(i,rK.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function rK(e,t){if(uT=-1,cT=0,kr&6)throw Error(zt(327));var i=e.callbackNode;if(ty()&&e.callbackNode!==i)return null;var r=HT(e,e===Sa?Ha:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=oC(e,r);else{t=r;var n=kr;kr|=2;var s=sK();(Sa!==e||Ha!==t)&&(Rd=null,Ty=ps()+500,Ag(e,t));do try{Spe();break}catch(o){nK(e,o)}while(!0);mk(),nC.current=s,kr=n,Ps!==null?t=0:(Sa=null,Ha=0,t=Qs)}if(t!==0){if(t===2&&(n=yR(e),n!==0&&(r=n,t=qR(e,n))),t===1)throw i=$b,Ag(e,0),lp(e,r),Dl(e,ps()),i;if(t===6)lp(e,r);else{if(n=e.current.alternate,!(r&30)&&!wpe(n)&&(t=oC(e,r),t===2&&(s=yR(e),s!==0&&(r=s,t=qR(e,s))),t===1))throw i=$b,Ag(e,0),lp(e,r),Dl(e,ps()),i;switch(e.finishedWork=n,e.finishedLanes=r,t){case 0:case 1:throw Error(zt(345));case 2:Qm(e,xl,Rd);break;case 3:if(lp(e,r),(r&130023424)===r&&(t=Dk+500-ps(),10<t)){if(HT(e,0)!==0)break;if(n=e.suspendedLanes,(n&r)!==r){qo(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=CR(Qm.bind(null,e,xl,Rd),t);break}Qm(e,xl,Rd);break;case 4:if(lp(e,r),(r&4194240)===r)break;for(t=e.eventTimes,n=-1;0<r;){var a=31-bc(r);s=1<<a,a=t[a],a>n&&(n=a),r&=~s}if(r=n,r=ps()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_pe(r/1960))-r,10<r){e.timeoutHandle=CR(Qm.bind(null,e,xl,Rd),r);break}Qm(e,xl,Rd);break;case 5:Qm(e,xl,Rd);break;default:throw Error(zt(329))}}}return Dl(e,ps()),e.callbackNode===i?rK.bind(null,e):null}function qR(e,t){var i=sb;return e.current.memoizedState.isDehydrated&&(Ag(e,t).flags|=256),e=oC(e,t),e!==2&&(t=xl,xl=i,t!==null&&YR(t)),e}function YR(e){xl===null?xl=e:xl.push.apply(xl,e)}function wpe(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var r=0;r<i.length;r++){var n=i[r],s=n.getSnapshot;n=n.value;try{if(!Sc(s(),n))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function lp(e,t){for(t&=~Pk,t&=~$A,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-bc(t),r=1<<i;e[i]=-1,t&=~r}}function QU(e){if(kr&6)throw Error(zt(327));ty();var t=HT(e,0);if(!(t&1))return Dl(e,ps()),null;var i=oC(e,t);if(e.tag!==0&&i===2){var r=yR(e);r!==0&&(t=r,i=qR(e,r))}if(i===1)throw i=$b,Ag(e,0),lp(e,t),Dl(e,ps()),i;if(i===6)throw Error(zt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qm(e,xl,Rd),Dl(e,ps()),null}function Ik(e,t){var i=kr;kr|=1;try{return e(t)}finally{kr=i,kr===0&&(Ty=ps()+500,qA&&em())}}function Vg(e){vp!==null&&vp.tag===0&&!(kr&6)&&ty();var t=kr;kr|=1;var i=ku.transition,r=Jr;try{if(ku.transition=null,Jr=1,e)return e()}finally{Jr=r,ku.transition=i,kr=t,!(kr&6)&&em()}}function Ok(){$l=k0.current,Pn(k0)}function Ag(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,Qfe(i)),Ps!==null)for(i=Ps.return;i!==null;){var r=i;switch(dk(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&XT();break;case 3:Ey(),Pn(Ml),Pn(vo),_k();break;case 5:bk(r);break;case 4:Ey();break;case 13:Pn(Bn);break;case 19:Pn(Bn);break;case 10:gk(r.type._context);break;case 22:case 23:Ok()}i=i.return}if(Sa=e,Ps=e=Bp(e.current,null),Ha=$l=t,Qs=0,$b=null,Pk=$A=jg=0,xl=sb=null,mg!==null){for(t=0;t<mg.length;t++)if(i=mg[t],r=i.interleaved,r!==null){i.interleaved=null;var n=r.next,s=i.pending;if(s!==null){var a=s.next;s.next=n,r.next=a}i.pending=r}mg=null}return e}function nK(e,t){do{var i=Ps;try{if(mk(),aT.current=rC,iC){for(var r=Un.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}iC=!1}if(Ug=0,ga=Ys=Un=null,rb=!1,Yb=0,Mk.current=null,i===null||i.return===null){Qs=1,$b=t,Ps=null;break}e:{var s=e,a=i.return,o=i,l=t;if(t=Ha,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=FU(a);if(f!==null){f.flags&=-257,UU(f,a,o,s,t),f.mode&1&&zU(s,u,t),t=f,l=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}else{if(!(t&1)){zU(s,u,t),Rk();break e}l=Error(zt(426))}}else if(In&&o.mode&1){var y=FU(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),UU(y,a,o,s,t),fk(Sy(l,o));break e}}s=l=Sy(l,o),Qs!==4&&(Qs=2),sb===null?sb=[s]:sb.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=jX(s,l,t);OU(s,x);break e;case 1:o=l;var w=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Np===null||!Np.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var C=VX(s,o,t);OU(s,C);break e}}s=s.return}while(s!==null)}oK(i)}catch(A){t=A,Ps===i&&i!==null&&(Ps=i=i.return);continue}break}while(!0)}function sK(){var e=nC.current;return nC.current=rC,e===null?rC:e}function Rk(){(Qs===0||Qs===3||Qs===2)&&(Qs=4),Sa===null||!(jg&268435455)&&!($A&268435455)||lp(Sa,Ha)}function oC(e,t){var i=kr;kr|=2;var r=sK();(Sa!==e||Ha!==t)&&(Rd=null,Ag(e,t));do try{Epe();break}catch(n){nK(e,n)}while(!0);if(mk(),kr=i,nC.current=r,Ps!==null)throw Error(zt(261));return Sa=null,Ha=0,Qs}function Epe(){for(;Ps!==null;)aK(Ps)}function Spe(){for(;Ps!==null&&!Kde();)aK(Ps)}function aK(e){var t=uK(e.alternate,e,$l);e.memoizedProps=e.pendingProps,t===null?oK(e):Ps=t,Mk.current=null}function oK(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=vpe(i,t),i!==null){i.flags&=32767,Ps=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qs=6,Ps=null;return}}else if(i=gpe(i,t,$l),i!==null){Ps=i;return}if(t=t.sibling,t!==null){Ps=t;return}Ps=t=e}while(t!==null);Qs===0&&(Qs=5)}function Qm(e,t,i){var r=Jr,n=ku.transition;try{ku.transition=null,Jr=1,Tpe(e,t,i,r)}finally{ku.transition=n,Jr=r}return null}function Tpe(e,t,i,r){do ty();while(vp!==null);if(kr&6)throw Error(zt(327));i=e.finishedWork;var n=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(zt(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(sfe(e,s),e===Sa&&(Ps=Sa=null,Ha=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||uE||(uE=!0,cK(VT,function(){return ty(),null})),s=(i.flags&15990)!==0,i.subtreeFlags&15990||s){s=ku.transition,ku.transition=null;var a=Jr;Jr=1;var o=kr;kr|=4,Mk.current=null,xpe(e,i),tK(i,e),Gfe(SR),WT=!!ER,SR=ER=null,e.current=i,bpe(i),$de(),kr=o,Jr=a,ku.transition=s}else e.current=i;if(uE&&(uE=!1,vp=e,aC=n),s=e.pendingLanes,s===0&&(Np=null),Jde(i.stateNode),Dl(e,ps()),t!==null)for(r=e.onRecoverableError,i=0;i<t.length;i++)n=t[i],r(n.value,{componentStack:n.stack,digest:n.digest});if(sC)throw sC=!1,e=WR,WR=null,e;return aC&1&&e.tag!==0&&ty(),s=e.pendingLanes,s&1?e===GR?ab++:(ab=0,GR=e):ab=0,em(),null}function ty(){if(vp!==null){var e=jY(aC),t=ku.transition,i=Jr;try{if(ku.transition=null,Jr=16>e?16:e,vp===null)var r=!1;else{if(e=vp,vp=null,aC=0,kr&6)throw Error(zt(331));var n=kr;for(kr|=4,ni=e.current;ni!==null;){var s=ni,a=s.child;if(ni.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ni=u;ni!==null;){var c=ni;switch(c.tag){case 0:case 11:case 15:nb(8,c,s)}var h=c.child;if(h!==null)h.return=c,ni=h;else for(;ni!==null;){c=ni;var d=c.sibling,f=c.return;if(QX(c),c===u){ni=null;break}if(d!==null){d.return=f,ni=d;break}ni=f}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ni=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ni=a;else e:for(;ni!==null;){if(s=ni,s.flags&2048)switch(s.tag){case 0:case 11:case 15:nb(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ni=x;break e}ni=s.return}}var w=e.current;for(ni=w;ni!==null;){a=ni;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,ni=b;else e:for(a=w;ni!==null;){if(o=ni,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:KA(9,o)}}catch(A){$n(o,o.return,A)}if(o===a){ni=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,ni=C;break e}ni=o.return}}if(kr=n,em(),Th&&typeof Th.onPostCommitFiberRoot=="function")try{Th.onPostCommitFiberRoot(jA,e)}catch{}r=!0}return r}finally{Jr=i,ku.transition=t}}return!1}function JU(e,t,i){t=Sy(i,t),t=jX(e,t,1),e=Lp(e,t,1),t=qo(),e!==null&&(L_(e,1,t),Dl(e,t))}function $n(e,t,i){if(e.tag===3)JU(e,e,i);else for(;t!==null;){if(t.tag===3){JU(t,e,i);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Np===null||!Np.has(r))){e=Sy(i,e),e=VX(t,e,1),t=Lp(t,e,1),e=qo(),t!==null&&(L_(t,1,e),Dl(t,e));break}}t=t.return}}function Cpe(e,t,i){var r=e.pingCache;r!==null&&r.delete(t),t=qo(),e.pingedLanes|=e.suspendedLanes&i,Sa===e&&(Ha&i)===i&&(Qs===4||Qs===3&&(Ha&130023424)===Ha&&500>ps()-Dk?Ag(e,0):Pk|=i),Dl(e,t)}function lK(e,t){t===0&&(e.mode&1?(t=Jw,Jw<<=1,!(Jw&130023424)&&(Jw=4194304)):t=1);var i=qo();e=sf(e,t),e!==null&&(L_(e,t,i),Dl(e,i))}function Ape(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),lK(e,i)}function Mpe(e,t){var i=0;switch(e.tag){case 13:var r=e.stateNode,n=e.memoizedState;n!==null&&(i=n.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(zt(314))}r!==null&&r.delete(t),lK(e,i)}var uK;uK=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ml.current)Sl=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return Sl=!1,mpe(e,t,i);Sl=!!(e.flags&131072)}else Sl=!1,In&&t.flags&1048576&&fX(t,ZT,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;lT(e,t),e=t.pendingProps;var n=by(t,vo.current);ey(t,i),n=Ek(null,t,r,e,n,i);var s=Sk();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pl(r)?(s=!0,KT(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,yk(t),n.updater=XA,t.stateNode=n,n._reactInternals=t,RR(t,r,e,i),t=kR(null,t,r,!0,s,i)):(t.tag=0,In&&s&&hk(t),ko(null,t,n,i),t=t.child),t;case 16:r=t.elementType;e:{switch(lT(e,t),e=t.pendingProps,n=r._init,r=n(r._payload),t.type=r,n=t.tag=Dpe(r),e=hc(r,e),n){case 0:t=NR(null,t,r,e,i);break e;case 1:t=HU(null,t,r,e,i);break e;case 11:t=jU(null,t,r,e,i);break e;case 14:t=VU(null,t,r,hc(r.type,e),i);break e}throw Error(zt(306,r,""))}return t;case 0:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:hc(r,n),NR(e,t,r,n,i);case 1:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:hc(r,n),HU(e,t,r,n,i);case 3:e:{if(qX(t),e===null)throw Error(zt(387));r=t.pendingProps,s=t.memoizedState,n=s.element,xX(e,t),eC(t,r,null,i);var a=t.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=Sy(Error(zt(423)),t),t=WU(e,t,r,i,n);break e}else if(r!==n){n=Sy(Error(zt(424)),t),t=WU(e,t,r,i,n);break e}else for(Ql=Rp(t.stateNode.containerInfo.firstChild),eu=t,In=!0,fc=null,i=vX(t,null,r,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(_y(),r===n){t=af(e,t,i);break e}ko(e,t,r,i)}t=t.child}return t;case 5:return bX(t),e===null&&DR(t),r=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,a=n.children,TR(r,n)?a=null:s!==null&&TR(r,s)&&(t.flags|=32),GX(e,t),ko(e,t,a,i),t.child;case 6:return e===null&&DR(t),null;case 13:return YX(e,t,i);case 4:return xk(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=wy(t,null,r,i):ko(e,t,r,i),t.child;case 11:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:hc(r,n),jU(e,t,r,n,i);case 7:return ko(e,t,t.pendingProps,i),t.child;case 8:return ko(e,t,t.pendingProps.children,i),t.child;case 12:return ko(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(r=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,xn(QT,r._currentValue),r._currentValue=a,s!==null)if(Sc(s.value,a)){if(s.children===n.children&&!Ml.current){t=af(e,t,i);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Zd(-1,i&-i),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=i,l=s.alternate,l!==null&&(l.lanes|=i),IR(s.return,i,t),o.lanes|=i;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(zt(341));a.lanes|=i,o=a.alternate,o!==null&&(o.lanes|=i),IR(a,i,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ko(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,r=t.pendingProps.children,ey(t,i),n=Uu(n),r=r(n),t.flags|=1,ko(e,t,r,i),t.child;case 14:return r=t.type,n=hc(r,t.pendingProps),n=hc(r.type,n),VU(e,t,r,n,i);case 15:return HX(e,t,t.type,t.pendingProps,i);case 17:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:hc(r,n),lT(e,t),t.tag=1,Pl(r)?(e=!0,KT(t)):e=!1,ey(t,i),UX(t,r,n),RR(t,r,n,i),kR(null,t,r,!0,e,i);case 19:return XX(e,t,i);case 22:return WX(e,t,i)}throw Error(zt(156,t.tag))};function cK(e,t){return BY(e,t)}function Ppe(e,t,i,r){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lu(e,t,i,r){return new Ppe(e,t,i,r)}function Lk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Dpe(e){if(typeof e=="function")return Lk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===JN)return 11;if(e===ek)return 14}return 2}function Bp(e,t){var i=e.alternate;return i===null?(i=Lu(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function hT(e,t,i,r,n,s){var a=2;if(r=e,typeof e=="function")Lk(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case C0:return Mg(i.children,n,s,t);case QN:a=8,n|=8;break;case rR:return e=Lu(12,i,t,n|2),e.elementType=rR,e.lanes=s,e;case nR:return e=Lu(13,i,t,n),e.elementType=nR,e.lanes=s,e;case sR:return e=Lu(19,i,t,n),e.elementType=sR,e.lanes=s,e;case bY:return ZA(i,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yY:a=10;break e;case xY:a=9;break e;case JN:a=11;break e;case ek:a=14;break e;case ip:a=16,r=null;break e}throw Error(zt(130,e==null?e:typeof e,""))}return t=Lu(a,i,t,n),t.elementType=e,t.type=r,t.lanes=s,t}function Mg(e,t,i,r){return e=Lu(7,e,r,t),e.lanes=i,e}function ZA(e,t,i,r){return e=Lu(22,e,r,t),e.elementType=bY,e.lanes=i,e.stateNode={isHidden:!1},e}function UP(e,t,i){return e=Lu(6,e,null,t),e.lanes=i,e}function jP(e,t,i){return t=Lu(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ipe(e,t,i,r,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_P(0),this.expirationTimes=_P(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_P(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Nk(e,t,i,r,n,s,a,o,l){return e=new Ipe(e,t,i,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Lu(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},yk(s),e}function Ope(e,t,i){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T0,key:r==null?null:""+r,children:e,containerInfo:t,implementation:i}}function hK(e){if(!e)return Gp;e=e._reactInternals;e:{if(iv(e)!==e||e.tag!==1)throw Error(zt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(zt(171))}if(e.tag===1){var i=e.type;if(Pl(i))return hX(e,i,t)}return t}function dK(e,t,i,r,n,s,a,o,l){return e=Nk(i,r,!0,e,n,s,a,o,l),e.context=hK(null),i=e.current,r=qo(),n=kp(i),s=Zd(r,n),s.callback=t??null,Lp(i,s,n),e.current.lanes=n,L_(e,n,r),Dl(e,r),e}function QA(e,t,i,r){var n=t.current,s=qo(),a=kp(n);return i=hK(i),t.context===null?t.context=i:t.pendingContext=i,t=Zd(s,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Lp(n,t,a),e!==null&&(_c(e,n,a,s),sT(e,n,a)),a}function lC(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function e6(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function kk(e,t){e6(e,t),(e=e.alternate)&&e6(e,t)}function Rpe(){return null}var fK=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bk(e){this._internalRoot=e}JA.prototype.render=Bk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(zt(409));QA(e,t,null,null)};JA.prototype.unmount=Bk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Vg(function(){QA(null,e,null,null)}),t[nf]=null}};function JA(e){this._internalRoot=e}JA.prototype.unstable_scheduleHydration=function(e){if(e){var t=WY();e={blockedOn:null,target:e,priority:t};for(var i=0;i<op.length&&t!==0&&t<op[i].priority;i++);op.splice(i,0,e),i===0&&qY(e)}};function zk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function eM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function t6(){}function Lpe(e,t,i,r,n){if(n){if(typeof r=="function"){var s=r;r=function(){var u=lC(a);s.call(u)}}var a=dK(t,r,e,0,null,!1,!1,"",t6);return e._reactRootContainer=a,e[nf]=a.current,Vb(e.nodeType===8?e.parentNode:e),Vg(),a}for(;n=e.lastChild;)e.removeChild(n);if(typeof r=="function"){var o=r;r=function(){var u=lC(l);o.call(u)}}var l=Nk(e,0,!1,null,null,!1,!1,"",t6);return e._reactRootContainer=l,e[nf]=l.current,Vb(e.nodeType===8?e.parentNode:e),Vg(function(){QA(t,l,i,r)}),l}function tM(e,t,i,r,n){var s=i._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=lC(a);o.call(l)}}QA(t,a,e,n)}else a=Lpe(i,t,e,n,r);return lC(a)}VY=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=Dx(t.pendingLanes);i!==0&&(rk(t,i|1),Dl(t,ps()),!(kr&6)&&(Ty=ps()+500,em()))}break;case 13:Vg(function(){var r=sf(e,1);if(r!==null){var n=qo();_c(r,e,1,n)}}),kk(e,1)}};nk=function(e){if(e.tag===13){var t=sf(e,134217728);if(t!==null){var i=qo();_c(t,e,134217728,i)}kk(e,134217728)}};HY=function(e){if(e.tag===13){var t=kp(e),i=sf(e,t);if(i!==null){var r=qo();_c(i,e,t,r)}kk(e,t)}};WY=function(){return Jr};GY=function(e,t){var i=Jr;try{return Jr=e,t()}finally{Jr=i}};mR=function(e,t,i){switch(t){case"input":if(lR(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var r=i[t];if(r!==e&&r.form===e.form){var n=GA(r);if(!n)throw Error(zt(90));wY(r),lR(r,n)}}}break;case"textarea":SY(e,i);break;case"select":t=i.value,t!=null&&$0(e,!!i.multiple,t,!1)}};IY=Ik;OY=Vg;var Npe={usingClientEntryPoint:!1,Events:[k_,D0,GA,PY,DY,Ik]},V1={findFiberByHostInstance:pg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kpe={bundleType:V1.bundleType,version:V1.version,rendererPackageName:V1.rendererPackageName,rendererConfig:V1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=NY(e),e===null?null:e.stateNode},findFiberByHostInstance:V1.findFiberByHostInstance||Rpe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cE.isDisabled&&cE.supportsFiber)try{jA=cE.inject(kpe),Th=cE}catch{}}au.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Npe;au.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zk(t))throw Error(zt(200));return Ope(e,t,null,i)};au.createRoot=function(e,t){if(!zk(e))throw Error(zt(299));var i=!1,r="",n=fK;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=Nk(e,1,!1,null,null,i,!1,r,n),e[nf]=t.current,Vb(e.nodeType===8?e.parentNode:e),new Bk(t)};au.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(zt(188)):(e=Object.keys(e).join(","),Error(zt(268,e)));return e=NY(t),e=e===null?null:e.stateNode,e};au.flushSync=function(e){return Vg(e)};au.hydrate=function(e,t,i){if(!eM(t))throw Error(zt(200));return tM(null,e,t,!0,i)};au.hydrateRoot=function(e,t,i){if(!zk(e))throw Error(zt(405));var r=i!=null&&i.hydratedSources||null,n=!1,s="",a=fK;if(i!=null&&(i.unstable_strictMode===!0&&(n=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(a=i.onRecoverableError)),t=dK(t,null,e,1,i??null,n,!1,s,a),e[nf]=t.current,Vb(e),r)for(e=0;e<r.length;e++)i=r[e],n=i._getVersion,n=n(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,n]:t.mutableSourceEagerHydrationData.push(i,n);return new JA(t)};au.render=function(e,t,i){if(!eM(t))throw Error(zt(200));return tM(null,e,t,!1,i)};au.unmountComponentAtNode=function(e){if(!eM(e))throw Error(zt(40));return e._reactRootContainer?(Vg(function(){tM(null,null,e,!1,function(){e._reactRootContainer=null,e[nf]=null})}),!0):!1};au.unstable_batchedUpdates=Ik;au.unstable_renderSubtreeIntoContainer=function(e,t,i,r){if(!eM(i))throw Error(zt(200));if(e==null||e._reactInternals===void 0)throw Error(zt(38));return tM(e,t,i,!1,r)};au.version="18.3.1-next-f1338f8080-20240426";function pK(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pK)}catch(e){console.error(e)}}pK(),pY.exports=au;var mK=pY.exports,i6=mK;tR.createRoot=i6.createRoot,tR.hydrateRoot=i6.hydrateRoot;const Bpe="modulepreload",zpe=function(e){return"/portfolio-2025-pages/"+e},r6={},Ll=function(t,i,r){let n=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.allSettled(i.map(l=>{if(l=zpe(l),l in r6)return;r6[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Bpe,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zb(){return Zb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Zb.apply(this,arguments)}var yp;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(yp||(yp={}));const n6="popstate";function Fpe(e){e===void 0&&(e={});function t(r,n){let{pathname:s,search:a,hash:o}=r.location;return XR("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function i(r,n){return typeof n=="string"?n:uC(n)}return jpe(t,i,null,e)}function ms(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function gK(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Upe(){return Math.random().toString(36).substr(2,8)}function s6(e,t){return{usr:e.state,key:e.key,idx:t}}function XR(e,t,i,r){return i===void 0&&(i=null),Zb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?$y(t):t,{state:i,key:t&&t.key||r||Upe()})}function uC(e){let{pathname:t="/",search:i="",hash:r=""}=e;return i&&i!=="?"&&(t+=i.charAt(0)==="?"?i:"?"+i),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function $y(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substr(i),e=e.substr(0,i));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function jpe(e,t,i,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:s=!1}=r,a=n.history,o=yp.Pop,l=null,u=c();u==null&&(u=0,a.replaceState(Zb({},a.state,{idx:u}),""));function c(){return(a.state||{idx:null}).idx}function h(){o=yp.Pop;let y=c(),x=y==null?null:y-u;u=y,l&&l({action:o,location:g.location,delta:x})}function d(y,x){o=yp.Push;let w=XR(g.location,y,x);u=c()+1;let b=s6(w,u),C=g.createHref(w);try{a.pushState(b,"",C)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;n.location.assign(C)}s&&l&&l({action:o,location:g.location,delta:1})}function f(y,x){o=yp.Replace;let w=XR(g.location,y,x);u=c();let b=s6(w,u),C=g.createHref(w);a.replaceState(b,"",C),s&&l&&l({action:o,location:g.location,delta:0})}function m(y){let x=n.location.origin!=="null"?n.location.origin:n.location.href,w=typeof y=="string"?y:uC(y);return w=w.replace(/ $/,"%20"),ms(x,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,x)}let g={get action(){return o},get location(){return e(n,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(n6,h),l=y,()=>{n.removeEventListener(n6,h),l=null}},createHref(y){return t(n,y)},createURL:m,encodeLocation(y){let x=m(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:f,go(y){return a.go(y)}};return g}var a6;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(a6||(a6={}));function Vpe(e,t,i){return i===void 0&&(i="/"),Hpe(e,t,i)}function Hpe(e,t,i,r){let n=typeof t=="string"?$y(t):t,s=Fk(n.pathname||"/",i);if(s==null)return null;let a=vK(e);Wpe(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=ime(s);o=Jpe(a[l],u)}return o}function vK(e,t,i,r){t===void 0&&(t=[]),i===void 0&&(i=[]),r===void 0&&(r="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(ms(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=zp([r,l.relativePath]),c=i.concat(l);s.children&&s.children.length>0&&(ms(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),vK(s.children,t,c,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:Zpe(u,s.index),routesMeta:c})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of yK(s.path))n(s,a,l)}),t}function yK(e){let t=e.split("/");if(t.length===0)return[];let[i,...r]=t,n=i.endsWith("?"),s=i.replace(/\?$/,"");if(r.length===0)return n?[s,""]:[s];let a=yK(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Wpe(e){e.sort((t,i)=>t.score!==i.score?i.score-t.score:Qpe(t.routesMeta.map(r=>r.childrenIndex),i.routesMeta.map(r=>r.childrenIndex)))}const Gpe=/^:[\w-]+$/,qpe=3,Ype=2,Xpe=1,Kpe=10,$pe=-2,o6=e=>e==="*";function Zpe(e,t){let i=e.split("/"),r=i.length;return i.some(o6)&&(r+=$pe),t&&(r+=Ype),i.filter(n=>!o6(n)).reduce((n,s)=>n+(Gpe.test(s)?qpe:s===""?Xpe:Kpe),r)}function Qpe(e,t){return e.length===t.length&&e.slice(0,-1).every((r,n)=>r===t[n])?e[e.length-1]-t[t.length-1]:0}function Jpe(e,t,i){let{routesMeta:r}=e,n={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],u=o===r.length-1,c=s==="/"?t:t.slice(s.length)||"/",h=eme({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(n,h.params),a.push({params:n,pathname:zp([s,h.pathname]),pathnameBase:ame(zp([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=zp([s,h.pathnameBase]))}return a}function eme(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[i,r]=tme(e.path,e.caseSensitive,e.end),n=t.match(i);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let g=o[h]||"";a=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=o[h];return f&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:e}}function tme(e,t,i){t===void 0&&(t=!1),i===void 0&&(i=!0),gK(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),r]}function ime(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return gK(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Fk(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,r=e.charAt(i);return r&&r!=="/"?null:e.slice(i)||"/"}function rme(e,t){t===void 0&&(t="/");let{pathname:i,search:r="",hash:n=""}=typeof e=="string"?$y(e):e;return{pathname:i?i.startsWith("/")?i:nme(i,t):t,search:ome(r),hash:lme(n)}}function nme(e,t){let i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?i.length>1&&i.pop():n!=="."&&i.push(n)}),i.length>1?i.join("/"):"/"}function VP(e,t,i,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sme(e){return e.filter((t,i)=>i===0||t.route.path&&t.route.path.length>0)}function Uk(e,t){let i=sme(e);return t?i.map((r,n)=>n===i.length-1?r.pathname:r.pathnameBase):i.map(r=>r.pathnameBase)}function jk(e,t,i,r){r===void 0&&(r=!1);let n;typeof e=="string"?n=$y(e):(n=Zb({},e),ms(!n.pathname||!n.pathname.includes("?"),VP("?","pathname","search",n)),ms(!n.pathname||!n.pathname.includes("#"),VP("#","pathname","hash",n)),ms(!n.search||!n.search.includes("#"),VP("#","search","hash",n)));let s=e===""||n.pathname==="",a=s?"/":n.pathname,o;if(a==null)o=i;else{let h=t.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}o=h>=0?t[h]:"/"}let l=rme(n,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&i.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const zp=e=>e.join("/").replace(/\/\/+/g,"/"),ame=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ome=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,lme=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ume(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const xK=["post","put","patch","delete"];new Set(xK);const cme=["get",...xK];new Set(cme);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qb(){return Qb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Qb.apply(this,arguments)}const Vk=de.createContext(null),hme=de.createContext(null),tm=de.createContext(null),iM=de.createContext(null),Fh=de.createContext({outlet:null,matches:[],isDataRoute:!1}),bK=de.createContext(null);function dme(e,t){let{relative:i}=t===void 0?{}:t;Zy()||ms(!1);let{basename:r,navigator:n}=de.useContext(tm),{hash:s,pathname:a,search:o}=wK(e,{relative:i}),l=a;return r!=="/"&&(l=a==="/"?r:zp([r,a])),n.createHref({pathname:l,search:o,hash:s})}function Zy(){return de.useContext(iM)!=null}function rv(){return Zy()||ms(!1),de.useContext(iM).location}function _K(e){de.useContext(tm).static||de.useLayoutEffect(e)}function rM(){let{isDataRoute:e}=de.useContext(Fh);return e?Cme():fme()}function fme(){Zy()||ms(!1);let e=de.useContext(Vk),{basename:t,future:i,navigator:r}=de.useContext(tm),{matches:n}=de.useContext(Fh),{pathname:s}=rv(),a=JSON.stringify(Uk(n,i.v7_relativeSplatPath)),o=de.useRef(!1);return _K(()=>{o.current=!0}),de.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=jk(u,JSON.parse(a),s,c.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:zp([t,h.pathname])),(c.replace?r.replace:r.push)(h,c.state,c)},[t,r,a,s,e])}const pme=de.createContext(null);function mme(e){let t=de.useContext(Fh).outlet;return t&&de.createElement(pme.Provider,{value:e},t)}function gst(){let{matches:e}=de.useContext(Fh),t=e[e.length-1];return t?t.params:{}}function wK(e,t){let{relative:i}=t===void 0?{}:t,{future:r}=de.useContext(tm),{matches:n}=de.useContext(Fh),{pathname:s}=rv(),a=JSON.stringify(Uk(n,r.v7_relativeSplatPath));return de.useMemo(()=>jk(e,JSON.parse(a),s,i==="path"),[e,a,s,i])}function gme(e,t){return vme(e,t)}function vme(e,t,i,r){Zy()||ms(!1);let{navigator:n,static:s}=de.useContext(tm),{matches:a}=de.useContext(Fh),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let c=rv(),h;if(t){var d;let x=typeof t=="string"?$y(t):t;u==="/"||(d=x.pathname)!=null&&d.startsWith(u)||ms(!1),h=x}else h=c;let f=h.pathname||"/",m=f;if(u!=="/"){let x=u.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=Vpe(e,{pathname:m}),y=wme(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:zp([u,n.encodeLocation?n.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:zp([u,n.encodeLocation?n.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,i,r);return t&&y?de.createElement(iM.Provider,{value:{location:Qb({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:yp.Pop}},y):y}function yme(){let e=CK(),t=ume(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return de.createElement(de.Fragment,null,de.createElement("h2",null,"Unexpected Application Error!"),de.createElement("h3",{style:{fontStyle:"italic"}},t),i?de.createElement("pre",{style:n},i):null,null)}const xme=de.createElement(yme,null);class bme extends de.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,i){return i.location!==t.location||i.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:i.error,location:i.location,revalidation:t.revalidation||i.revalidation}}componentDidCatch(t,i){console.error("React Router caught the following error during render",t,i)}render(){return this.state.error!==void 0?de.createElement(Fh.Provider,{value:this.props.routeContext},de.createElement(bK.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _me(e){let{routeContext:t,match:i,children:r}=e,n=de.useContext(Vk);return n&&n.static&&n.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=i.route.id),de.createElement(Fh.Provider,{value:t},r)}function wme(e,t,i,r){var n;if(t===void 0&&(t=[]),i===void 0&&(i=null),r===void 0&&(r=null),e==null){var s;if(!i)return null;if(i.errors)e=i.matches;else if((s=r)!=null&&s.v7_partialHydration&&t.length===0&&!i.initialized&&i.matches.length>0)e=i.matches;else return null}let a=e,o=(n=i)==null?void 0:n.errors;if(o!=null){let c=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);c>=0||ms(!1),a=a.slice(0,Math.min(a.length,c+1))}let l=!1,u=-1;if(i&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let h=a[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=i,m=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||m){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((c,h,d)=>{let f,m=!1,g=null,y=null;i&&(f=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||xme,l&&(u<0&&d===0?(Ame("route-fallback"),m=!0,y=null):u===d&&(m=!0,y=h.route.hydrateFallbackElement||null)));let x=t.concat(a.slice(0,d+1)),w=()=>{let b;return f?b=g:m?b=y:h.route.Component?b=de.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=c,de.createElement(_me,{match:h,routeContext:{outlet:c,matches:x,isDataRoute:i!=null},children:b})};return i&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?de.createElement(bme,{location:i.location,revalidation:i.revalidation,component:g,error:f,children:w(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):w()},null)}var EK=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(EK||{}),SK=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(SK||{});function Eme(e){let t=de.useContext(Vk);return t||ms(!1),t}function Sme(e){let t=de.useContext(hme);return t||ms(!1),t}function Tme(e){let t=de.useContext(Fh);return t||ms(!1),t}function TK(e){let t=Tme(),i=t.matches[t.matches.length-1];return i.route.id||ms(!1),i.route.id}function CK(){var e;let t=de.useContext(bK),i=Sme(SK.UseRouteError),r=TK();return t!==void 0?t:(e=i.errors)==null?void 0:e[r]}function Cme(){let{router:e}=Eme(EK.UseNavigateStable),t=TK(),i=de.useRef(!1);return _K(()=>{i.current=!0}),de.useCallback(function(n,s){s===void 0&&(s={}),i.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,Qb({fromRouteId:t},s)))},[e,t])}const l6={};function Ame(e,t,i){l6[e]||(l6[e]=!0)}function Mme(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function HP(e){let{to:t,replace:i,state:r,relative:n}=e;Zy()||ms(!1);let{future:s,static:a}=de.useContext(tm),{matches:o}=de.useContext(Fh),{pathname:l}=rv(),u=rM(),c=jk(t,Uk(o,s.v7_relativeSplatPath),l,n==="path"),h=JSON.stringify(c);return de.useEffect(()=>u(JSON.parse(h),{replace:i,state:r,relative:n}),[u,h,n,i,r]),null}function Pme(e){return mme(e.context)}function Jf(e){ms(!1)}function Dme(e){let{basename:t="/",children:i=null,location:r,navigationType:n=yp.Pop,navigator:s,static:a=!1,future:o}=e;Zy()&&ms(!1);let l=t.replace(/^\/*/,"/"),u=de.useMemo(()=>({basename:l,navigator:s,static:a,future:Qb({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof r=="string"&&(r=$y(r));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:m="default"}=r,g=de.useMemo(()=>{let y=Fk(c,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:f,key:m},navigationType:n}},[l,c,h,d,f,m,n]);return g==null?null:de.createElement(tm.Provider,{value:u},de.createElement(iM.Provider,{children:i,value:g}))}function Ime(e){let{children:t,location:i}=e;return gme(KR(t),i)}new Promise(()=>{});function KR(e,t){t===void 0&&(t=[]);let i=[];return de.Children.forEach(e,(r,n)=>{if(!de.isValidElement(r))return;let s=[...t,n];if(r.type===de.Fragment){i.push.apply(i,KR(r.props.children,s));return}r.type!==Jf&&ms(!1),!r.props.index||!r.props.children||ms(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=KR(r.props.children,s)),i.push(a)}),i}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $R(){return $R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},$R.apply(this,arguments)}function Ome(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,s;for(s=0;s<r.length;s++)n=r[s],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function Rme(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Lme(e,t){return e.button===0&&(!t||t==="_self")&&!Rme(e)}const Nme=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kme="6";try{window.__reactRouterVersion=kme}catch{}const Bme="startTransition",u6=dY[Bme];function zme(e){let{basename:t,children:i,future:r,window:n}=e,s=de.useRef();s.current==null&&(s.current=Fpe({window:n,v5Compat:!0}));let a=s.current,[o,l]=de.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},c=de.useCallback(h=>{u&&u6?u6(()=>l(h)):l(h)},[l,u]);return de.useLayoutEffect(()=>a.listen(c),[a,c]),de.useEffect(()=>Mme(r),[r]),de.createElement(Dme,{basename:t,children:i,location:o.location,navigationType:o.action,navigator:a,future:r})}const Fme=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ume=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ox=de.forwardRef(function(t,i){let{onClick:r,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,viewTransition:h}=t,d=Ome(t,Nme),{basename:f}=de.useContext(tm),m,g=!1;if(typeof u=="string"&&Ume.test(u)&&(m=u,Fme))try{let b=new URL(window.location.href),C=u.startsWith("//")?new URL(b.protocol+u):new URL(u),A=Fk(C.pathname,f);C.origin===b.origin&&A!=null?u=A+C.search+C.hash:g=!0}catch{}let y=dme(u,{relative:n}),x=jme(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:n,viewTransition:h});function w(b){r&&r(b),b.defaultPrevented||x(b)}return de.createElement("a",$R({},d,{href:m||y,onClick:g||s?r:w,ref:i,target:l}))});var c6;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(c6||(c6={}));var h6;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(h6||(h6={}));function jme(e,t){let{target:i,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}=t===void 0?{}:t,l=rM(),u=rv(),c=wK(e,{relative:a});return de.useCallback(h=>{if(Lme(h,i)){h.preventDefault();let d=r!==void 0?r:uC(u)===uC(c);l(e,{replace:d,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,c,r,n,i,e,s,a,o])}const Hk=de.createContext({});function nv(e){const t=de.useRef(null);return t.current===null&&(t.current=e()),t.current}const nM=de.createContext(null),z_=de.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Vme extends de.Component{getSnapshotBeforeUpdate(t){const i=this.props.childRef.current;if(i&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=i.offsetHeight||0,r.width=i.offsetWidth||0,r.top=i.offsetTop,r.left=i.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Hme({children:e,isPresent:t}){const i=de.useId(),r=de.useRef(null),n=de.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=de.useContext(z_);return de.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=n.current;if(t||!r.current||!a||!o)return;r.current.dataset.motionPopId=i;const c=document.createElement("style");return s&&(c.nonce=s),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),j.jsx(Vme,{isPresent:t,childRef:r,sizeRef:n,children:de.cloneElement(e,{ref:r})})}const Wme=({children:e,initial:t,isPresent:i,onExitComplete:r,custom:n,presenceAffectsLayout:s,mode:a})=>{const o=nv(Gme),l=de.useId(),u=de.useCallback(h=>{o.set(h,!0);for(const d of o.values())if(!d)return;r&&r()},[o,r]),c=de.useMemo(()=>({id:l,initial:t,isPresent:i,custom:n,onExitComplete:u,register:h=>(o.set(h,!1),()=>o.delete(h))}),s?[Math.random(),u]:[i,u]);return de.useMemo(()=>{o.forEach((h,d)=>o.set(d,!1))},[i]),de.useEffect(()=>{!i&&!o.size&&r&&r()},[i]),a==="popLayout"&&(e=j.jsx(Hme,{isPresent:i,children:e})),j.jsx(nM.Provider,{value:c,children:e})};function Gme(){return new Map}function AK(e=!0){const t=de.useContext(nM);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:r,register:n}=t,s=de.useId();de.useEffect(()=>{e&&n(s)},[e]);const a=de.useCallback(()=>e&&r&&r(s),[s,r,e]);return!i&&r?[!1,a]:[!0]}const hE=e=>e.key||"";function d6(e){const t=[];return de.Children.forEach(e,i=>{de.isValidElement(i)&&t.push(i)}),t}const Wk=typeof window<"u",Qy=Wk?de.useLayoutEffect:de.useEffect,Jb=({children:e,custom:t,initial:i=!0,onExitComplete:r,presenceAffectsLayout:n=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=AK(a),u=de.useMemo(()=>d6(e),[e]),c=a&&!o?[]:u.map(hE),h=de.useRef(!0),d=de.useRef(u),f=nv(()=>new Map),[m,g]=de.useState(u),[y,x]=de.useState(u);Qy(()=>{h.current=!1,d.current=u;for(let C=0;C<y.length;C++){const A=hE(y[C]);c.includes(A)?f.delete(A):f.get(A)!==!0&&f.set(A,!1)}},[y,c.length,c.join("-")]);const w=[];if(u!==m){let C=[...u];for(let A=0;A<y.length;A++){const E=y[A],_=hE(E);c.includes(_)||(C.splice(A,0,E),w.push(E))}s==="wait"&&w.length&&(C=w),x(d6(C)),g(u);return}const{forceRender:b}=de.useContext(Hk);return j.jsx(j.Fragment,{children:y.map(C=>{const A=hE(C),E=a&&!o?!1:u===y||c.includes(A),_=()=>{if(f.has(A))f.set(A,!0);else return;let P=!0;f.forEach(I=>{I||(P=!1)}),P&&(b==null||b(),x(d.current),a&&(l==null||l()),r&&r())};return j.jsx(Wme,{isPresent:E,initial:!h.current||i?void 0:!1,custom:E?void 0:t,presenceAffectsLayout:n,mode:s,onExitComplete:E?void 0:_,children:C},A)})})},Yo=e=>e;let qme=Yo,MK=Yo;function Gk(e){let t;return()=>(t===void 0&&(t=e()),t)}const Hg=(e,t,i)=>{const r=t-e;return r===0?1:(i-e)/r},Qd=e=>e*1e3,Jd=e=>e/1e3,Yme={useManualTiming:!1};function Xme(e){let t=new Set,i=new Set,r=!1,n=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){s.has(u)&&(l.schedule(u),e()),u(a)}const l={schedule:(u,c=!1,h=!1)=>{const f=h&&r?t:i;return c&&s.add(u),f.has(u)||f.add(u),u},cancel:u=>{i.delete(u),s.delete(u)},process:u=>{if(a=u,r){n=!0;return}r=!0,[t,i]=[i,t],t.forEach(o),t.clear(),r=!1,n&&(n=!1,l.process(u))}};return l}const dE=["read","resolveKeyframes","update","preRender","render","postRender"],Kme=40;function PK(e,t){let i=!1,r=!0;const n={delta:0,timestamp:0,isProcessing:!1},s=()=>i=!0,a=dE.reduce((x,w)=>(x[w]=Xme(s),x),{}),{read:o,resolveKeyframes:l,update:u,preRender:c,render:h,postRender:d}=a,f=()=>{const x=performance.now();i=!1,n.delta=r?1e3/60:Math.max(Math.min(x-n.timestamp,Kme),1),n.timestamp=x,n.isProcessing=!0,o.process(n),l.process(n),u.process(n),c.process(n),h.process(n),d.process(n),n.isProcessing=!1,i&&t&&(r=!1,e(f))},m=()=>{i=!0,r=!0,n.isProcessing||e(f)};return{schedule:dE.reduce((x,w)=>{const b=a[w];return x[w]=(C,A=!1,E=!1)=>(i||m(),b.schedule(C,A,E)),x},{}),cancel:x=>{for(let w=0;w<dE.length;w++)a[dE[w]].cancel(x)},state:n,steps:a}}const{schedule:Ur,cancel:Tc,state:qs,steps:WP}=PK(typeof requestAnimationFrame<"u"?requestAnimationFrame:Yo,!0),DK=de.createContext({strict:!1}),f6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Cy={};for(const e in f6)Cy[e]={isEnabled:t=>f6[e].some(i=>!!t[i])};function $me(e){for(const t in e)Cy[t]={...Cy[t],...e[t]}}const Zme=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function cC(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Zme.has(e)}let IK=e=>!cC(e);function Qme(e){e&&(IK=t=>t.startsWith("on")?!cC(t):e(t))}try{Qme(require("@emotion/is-prop-valid").default)}catch{}function Jme(e,t,i){const r={};for(const n in e)n==="values"&&typeof e.values=="object"||(IK(n)||i===!0&&cC(n)||!t&&!cC(n)||e.draggable&&n.startsWith("onDrag"))&&(r[n]=e[n]);return r}function ege(e){if(typeof Proxy>"u")return e;const t=new Map,i=(...r)=>e(...r);return new Proxy(i,{get:(r,n)=>n==="create"?e:(t.has(n)||t.set(n,e(n)),t.get(n))})}const sM=de.createContext({});function e_(e){return typeof e=="string"||Array.isArray(e)}function aM(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const qk=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Yk=["initial",...qk];function oM(e){return aM(e.animate)||Yk.some(t=>e_(e[t]))}function OK(e){return!!(oM(e)||e.variants)}function tge(e,t){if(oM(e)){const{initial:i,animate:r}=e;return{initial:i===!1||e_(i)?i:void 0,animate:e_(r)?r:void 0}}return e.inherit!==!1?t:{}}function ige(e){const{initial:t,animate:i}=tge(e,de.useContext(sM));return de.useMemo(()=>({initial:t,animate:i}),[p6(t),p6(i)])}function p6(e){return Array.isArray(e)?e.join(" "):e}const rge=Symbol.for("motionComponentSymbol");function B0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function nge(e,t,i){return de.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),i&&(typeof i=="function"?i(r):B0(i)&&(i.current=r))},[t])}const Xk=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),sge="framerAppearId",RK="data-"+Xk(sge),{schedule:Kk}=PK(queueMicrotask,!1),LK=de.createContext({});function age(e,t,i,r,n){var s,a;const{visualElement:o}=de.useContext(sM),l=de.useContext(DK),u=de.useContext(nM),c=de.useContext(z_).reducedMotion,h=de.useRef(null);r=r||l.renderer,!h.current&&r&&(h.current=r(e,{visualState:t,parent:o,props:i,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:c}));const d=h.current,f=de.useContext(LK);d&&!d.projection&&n&&(d.type==="html"||d.type==="svg")&&oge(h.current,i,n,f);const m=de.useRef(!1);de.useInsertionEffect(()=>{d&&m.current&&d.update(i,u)});const g=i[RK],y=de.useRef(!!g&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,g))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,g)));return Qy(()=>{d&&(m.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),Kk.render(d.render),y.current&&d.animationState&&d.animationState.animateChanges())}),de.useEffect(()=>{d&&(!y.current&&d.animationState&&d.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)===null||x===void 0||x.call(window,g)}),y.current=!1))}),d}function oge(e,t,i,r){const{layoutId:n,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:NK(e.parent)),e.projection.setOptions({layoutId:n,layout:s,alwaysMeasureLayout:!!a||o&&B0(o),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function NK(e){if(e)return e.options.allowProjection!==!1?e.projection:NK(e.parent)}function lge({preloadedFeatures:e,createVisualElement:t,useRender:i,useVisualState:r,Component:n}){var s,a;e&&$me(e);function o(u,c){let h;const d={...de.useContext(z_),...u,layoutId:uge(u)},{isStatic:f}=d,m=ige(u),g=r(u,f);if(!f&&Wk){cge();const y=hge(d);h=y.MeasureLayout,m.visualElement=age(n,g,d,t,y.ProjectionNode)}return j.jsxs(sM.Provider,{value:m,children:[h&&m.visualElement?j.jsx(h,{visualElement:m.visualElement,...d}):null,i(n,u,nge(g,m.visualElement,c),g,f,m.visualElement)]})}o.displayName=`motion.${typeof n=="string"?n:`create(${(a=(s=n.displayName)!==null&&s!==void 0?s:n.name)!==null&&a!==void 0?a:""})`}`;const l=de.forwardRef(o);return l[rge]=n,l}function uge({layoutId:e}){const t=de.useContext(Hk).id;return t&&e!==void 0?t+"-"+e:e}function cge(e,t){de.useContext(DK).strict}function hge(e){const{drag:t,layout:i}=Cy;if(!t&&!i)return{};const r={...t,...i};return{MeasureLayout:t!=null&&t.isEnabled(e)||i!=null&&i.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const dge=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function $k(e){return typeof e!="string"||e.includes("-")?!1:!!(dge.indexOf(e)>-1||/[A-Z]/u.test(e))}function m6(e){const t=[{},{}];return e==null||e.values.forEach((i,r)=>{t[0][r]=i.get(),t[1][r]=i.getVelocity()}),t}function Zk(e,t,i,r){if(typeof t=="function"){const[n,s]=m6(r);t=t(i!==void 0?i:e.custom,n,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,s]=m6(r);t=t(i!==void 0?i:e.custom,n,s)}return t}const ZR=e=>Array.isArray(e),fge=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),pge=e=>ZR(e)?e[e.length-1]||0:e,_a=e=>!!(e&&e.getVelocity);function dT(e){const t=_a(e)?e.get():e;return fge(t)?t.toValue():t}function mge({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:i},r,n,s){const a={latestValues:gge(r,n,s,e),renderState:t()};return i&&(a.onMount=o=>i({props:r,current:o,...a}),a.onUpdate=o=>i(o)),a}const kK=e=>(t,i)=>{const r=de.useContext(sM),n=de.useContext(nM),s=()=>mge(e,t,r,n);return i?s():nv(s)};function gge(e,t,i,r){const n={},s=r(e,{});for(const d in s)n[d]=dT(s[d]);let{initial:a,animate:o}=e;const l=oM(e),u=OK(e);t&&u&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let c=i?i.initial===!1:!1;c=c||a===!1;const h=c?o:a;if(h&&typeof h!="boolean"&&!aM(h)){const d=Array.isArray(h)?h:[h];for(let f=0;f<d.length;f++){const m=Zk(e,d[f]);if(m){const{transitionEnd:g,transition:y,...x}=m;for(const w in x){let b=x[w];if(Array.isArray(b)){const C=c?b.length-1:0;b=b[C]}b!==null&&(n[w]=b)}for(const w in g)n[w]=g[w]}}}return n}const Jy=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],sv=new Set(Jy),BK=e=>t=>typeof t=="string"&&t.startsWith(e),zK=BK("--"),vge=BK("var(--"),Qk=e=>vge(e)?yge.test(e.split("/*")[0].trim()):!1,yge=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,FK=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Rh=(e,t,i)=>i>t?t:i<e?e:i,e1={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},t_={...e1,transform:e=>Rh(0,1,e)},fE={...e1,default:1},F_=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ep=F_("deg"),Ah=F_("%"),Ri=F_("px"),xge=F_("vh"),bge=F_("vw"),g6={...Ah,parse:e=>Ah.parse(e)/100,transform:e=>Ah.transform(e*100)},_ge={borderWidth:Ri,borderTopWidth:Ri,borderRightWidth:Ri,borderBottomWidth:Ri,borderLeftWidth:Ri,borderRadius:Ri,radius:Ri,borderTopLeftRadius:Ri,borderTopRightRadius:Ri,borderBottomRightRadius:Ri,borderBottomLeftRadius:Ri,width:Ri,maxWidth:Ri,height:Ri,maxHeight:Ri,top:Ri,right:Ri,bottom:Ri,left:Ri,padding:Ri,paddingTop:Ri,paddingRight:Ri,paddingBottom:Ri,paddingLeft:Ri,margin:Ri,marginTop:Ri,marginRight:Ri,marginBottom:Ri,marginLeft:Ri,backgroundPositionX:Ri,backgroundPositionY:Ri},wge={rotate:ep,rotateX:ep,rotateY:ep,rotateZ:ep,scale:fE,scaleX:fE,scaleY:fE,scaleZ:fE,skew:ep,skewX:ep,skewY:ep,distance:Ri,translateX:Ri,translateY:Ri,translateZ:Ri,x:Ri,y:Ri,z:Ri,perspective:Ri,transformPerspective:Ri,opacity:t_,originX:g6,originY:g6,originZ:Ri},v6={...e1,transform:Math.round},Jk={..._ge,...wge,zIndex:v6,size:Ri,fillOpacity:t_,strokeOpacity:t_,numOctaves:v6},Ege={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Sge=Jy.length;function Tge(e,t,i){let r="",n=!0;for(let s=0;s<Sge;s++){const a=Jy[s],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||i){const u=FK(o,Jk[a]);if(!l){n=!1;const c=Ege[a]||a;r+=`${c}(${u}) `}i&&(t[a]=u)}}return r=r.trim(),i?r=i(t,n?"":r):n&&(r="none"),r}function e4(e,t,i){const{style:r,vars:n,transformOrigin:s}=e;let a=!1,o=!1;for(const l in t){const u=t[l];if(sv.has(l)){a=!0;continue}else if(zK(l)){n[l]=u;continue}else{const c=FK(u,Jk[l]);l.startsWith("origin")?(o=!0,s[l]=c):r[l]=c}}if(t.transform||(a||i?r.transform=Tge(t,e.transform,i):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:c=0}=s;r.transformOrigin=`${l} ${u} ${c}`}}const Cge={offset:"stroke-dashoffset",array:"stroke-dasharray"},Age={offset:"strokeDashoffset",array:"strokeDasharray"};function Mge(e,t,i=1,r=0,n=!0){e.pathLength=1;const s=n?Cge:Age;e[s.offset]=Ri.transform(-r);const a=Ri.transform(t),o=Ri.transform(i);e[s.array]=`${a} ${o}`}function y6(e,t,i){return typeof e=="string"?e:Ri.transform(t+i*e)}function Pge(e,t,i){const r=y6(t,e.x,e.width),n=y6(i,e.y,e.height);return`${r} ${n}`}function t4(e,{attrX:t,attrY:i,attrScale:r,originX:n,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},c,h){if(e4(e,u,h),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f,dimensions:m}=e;d.transform&&(m&&(f.transform=d.transform),delete d.transform),m&&(n!==void 0||s!==void 0||f.transform)&&(f.transformOrigin=Pge(m,n!==void 0?n:.5,s!==void 0?s:.5)),t!==void 0&&(d.x=t),i!==void 0&&(d.y=i),r!==void 0&&(d.scale=r),a!==void 0&&Mge(d,a,o,l,!1)}const i4=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),UK=()=>({...i4(),attrs:{}}),r4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function jK(e,{style:t,vars:i},r,n){Object.assign(e.style,t,n&&n.getProjectionStyles(r));for(const s in i)e.style.setProperty(s,i[s])}const VK=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function HK(e,t,i,r){jK(e,t,void 0,r);for(const n in t.attrs)e.setAttribute(VK.has(n)?n:Xk(n),t.attrs[n])}const hC={};function Dge(e){Object.assign(hC,e)}function WK(e,{layout:t,layoutId:i}){return sv.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!hC[e]||e==="opacity")}function n4(e,t,i){var r;const{style:n}=e,s={};for(const a in n)(_a(n[a])||t.style&&_a(t.style[a])||WK(a,e)||((r=i==null?void 0:i.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=n[a]);return s}function GK(e,t,i){const r=n4(e,t,i);for(const n in e)if(_a(e[n])||_a(t[n])){const s=Jy.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function Ige(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const x6=["x","y","width","height","cx","cy","r"],Oge={useVisualState:kK({scrapeMotionValuesFromProps:GK,createRenderState:UK,onUpdate:({props:e,prevProps:t,current:i,renderState:r,latestValues:n})=>{if(!i)return;let s=!!e.drag;if(!s){for(const o in n)if(sv.has(o)){s=!0;break}}if(!s)return;let a=!t;if(t)for(let o=0;o<x6.length;o++){const l=x6[o];e[l]!==t[l]&&(a=!0)}a&&Ur.read(()=>{Ige(i,r),Ur.render(()=>{t4(r,n,r4(i.tagName),e.transformTemplate),HK(i,r)})})}})},Rge={useVisualState:kK({scrapeMotionValuesFromProps:n4,createRenderState:i4})};function qK(e,t,i){for(const r in t)!_a(t[r])&&!WK(r,i)&&(e[r]=t[r])}function Lge({transformTemplate:e},t){return de.useMemo(()=>{const i=i4();return e4(i,t,e),Object.assign({},i.vars,i.style)},[t])}function Nge(e,t){const i=e.style||{},r={};return qK(r,i,e),Object.assign(r,Lge(e,t)),r}function kge(e,t){const i={},r=Nge(e,t);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=r,i}function Bge(e,t,i,r){const n=de.useMemo(()=>{const s=UK();return t4(s,t,r4(r),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};qK(s,e.style,e),n.style={...s,...n.style}}return n}function zge(e=!1){return(i,r,n,{latestValues:s},a)=>{const l=($k(i)?Bge:kge)(r,s,a,i),u=Jme(r,typeof i=="string",e),c=i!==de.Fragment?{...u,...l,ref:n}:{},{children:h}=r,d=de.useMemo(()=>_a(h)?h.get():h,[h]);return de.createElement(i,{...c,children:d})}}function Fge(e,t){return function(r,{forwardMotionProps:n}={forwardMotionProps:!1}){const a={...$k(r)?Oge:Rge,preloadedFeatures:e,useRender:zge(n),createVisualElement:t,Component:r};return lge(a)}}function YK(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}function lM(e,t,i){const r=e.getProps();return Zk(r,t,i!==void 0?i:r.custom,e)}const XK=Gk(()=>window.ScrollTimeline!==void 0);class Uge{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,i){for(let r=0;r<this.animations.length;r++)this.animations[r][t]=i}attachTimeline(t,i){const r=this.animations.map(n=>{if(XK()&&n.attachTimeline)return n.attachTimeline(t);if(typeof i=="function")return i(n)});return()=>{r.forEach((n,s)=>{n&&n(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let i=0;i<this.animations.length;i++)t=Math.max(t,this.animations[i].duration);return t}runAll(t){this.animations.forEach(i=>i[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class jge extends Uge{then(t,i){return Promise.all(this.animations).then(t).catch(i)}}function s4(e,t){return e?e[t]||e.default||e:void 0}const QR=2e4;function KK(e){let t=0;const i=50;let r=e.next(t);for(;!r.done&&t<QR;)t+=i,r=e.next(t);return t>=QR?1/0:t}function a4(e){return typeof e=="function"}function b6(e,t){e.timeline=t,e.onfinish=null}const o4=e=>Array.isArray(e)&&typeof e[0]=="number",Vge={linearEasing:void 0};function Hge(e,t){const i=Gk(e);return()=>{var r;return(r=Vge[t])!==null&&r!==void 0?r:i()}}const dC=Hge(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),$K=(e,t,i=10)=>{let r="";const n=Math.max(Math.round(t/i),2);for(let s=0;s<n;s++)r+=e(Hg(0,n-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function ZK(e){return!!(typeof e=="function"&&dC()||!e||typeof e=="string"&&(e in JR||dC())||o4(e)||Array.isArray(e)&&e.every(ZK))}const Rx=([e,t,i,r])=>`cubic-bezier(${e}, ${t}, ${i}, ${r})`,JR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Rx([0,.65,.55,1]),circOut:Rx([.55,0,1,.45]),backIn:Rx([.31,.01,.66,-.59]),backOut:Rx([.33,1.53,.69,.99])};function QK(e,t){if(e)return typeof e=="function"&&dC()?$K(e,t):o4(e)?Rx(e):Array.isArray(e)?e.map(i=>QK(i,t)||JR.easeOut):JR[e]}const cc={x:!1,y:!1};function JK(){return cc.x||cc.y}function l4(e,t,i){var r;if(e instanceof Element)return[e];if(typeof e=="string"){let n=document;const s=(r=void 0)!==null&&r!==void 0?r:n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function e$(e,t){const i=l4(e),r=new AbortController,n={passive:!0,...t,signal:r.signal};return[i,n,()=>r.abort()]}function _6(e){return t=>{t.pointerType==="touch"||JK()||e(t)}}function Wge(e,t,i={}){const[r,n,s]=e$(e,i),a=_6(o=>{const{target:l}=o,u=t(o);if(typeof u!="function"||!l)return;const c=_6(h=>{u(h),l.removeEventListener("pointerleave",c)});l.addEventListener("pointerleave",c,n)});return r.forEach(o=>{o.addEventListener("pointerenter",a,n)}),s}const t$=(e,t)=>t?e===t?!0:t$(e,t.parentElement):!1,u4=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Gge=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function qge(e){return Gge.has(e.tagName)||e.tabIndex!==-1}const Lx=new WeakSet;function w6(e){return t=>{t.key==="Enter"&&e(t)}}function GP(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Yge=(e,t)=>{const i=e.currentTarget;if(!i)return;const r=w6(()=>{if(Lx.has(i))return;GP(i,"down");const n=w6(()=>{GP(i,"up")}),s=()=>GP(i,"cancel");i.addEventListener("keyup",n,t),i.addEventListener("blur",s,t)});i.addEventListener("keydown",r,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",r),t)};function E6(e){return u4(e)&&!JK()}function Xge(e,t,i={}){const[r,n,s]=e$(e,i),a=o=>{const l=o.currentTarget;if(!E6(o)||Lx.has(l))return;Lx.add(l);const u=t(o),c=(f,m)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",d),!(!E6(f)||!Lx.has(l))&&(Lx.delete(l),typeof u=="function"&&u(f,{success:m}))},h=f=>{c(f,i.useGlobalTarget||t$(l,f.target))},d=f=>{c(f,!1)};window.addEventListener("pointerup",h,n),window.addEventListener("pointercancel",d,n)};return r.forEach(o=>{!qge(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(i.useGlobalTarget?window:o).addEventListener("pointerdown",a,n),o.addEventListener("focus",u=>Yge(u,n),n)}),s}function Kge(e){return e==="x"||e==="y"?cc[e]?null:(cc[e]=!0,()=>{cc[e]=!1}):cc.x||cc.y?null:(cc.x=cc.y=!0,()=>{cc.x=cc.y=!1})}const i$=new Set(["width","height","top","left","right","bottom",...Jy]);let fT;function $ge(){fT=void 0}const Mh={now:()=>(fT===void 0&&Mh.set(qs.isProcessing||Yme.useManualTiming?qs.timestamp:performance.now()),fT),set:e=>{fT=e,queueMicrotask($ge)}};function c4(e,t){e.indexOf(t)===-1&&e.push(t)}function h4(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class d4{constructor(){this.subscriptions=[]}add(t){return c4(this.subscriptions,t),()=>h4(this.subscriptions,t)}notify(t,i,r){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,i,r);else for(let s=0;s<n;s++){const a=this.subscriptions[s];a&&a(t,i,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function f4(e,t){return t?e*(1e3/t):0}const S6=30,Zge=e=>!isNaN(parseFloat(e)),ob={current:void 0};class Qge{constructor(t,i={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,n=!0)=>{const s=Mh.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=i.owner}setCurrent(t){this.current=t,this.updatedAt=Mh.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Zge(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new d4);const r=this.events[t].add(i);return t==="change"?()=>{r(),Ur.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t,i=!0){!i||!this.passiveEffect?this.updateAndNotify(t,i):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,i,r){this.set(i),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,i=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return ob.current&&ob.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=Mh.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>S6)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,S6);return f4(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xh(e,t){return new Qge(e,t)}function Jge(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,xh(i))}function p4(e,t){const i=lM(e,t);let{transitionEnd:r={},transition:n={},...s}=i||{};s={...s,...r};for(const a in s){const o=pge(s[a]);Jge(e,a,o)}}function eve(e){return!!(_a(e)&&e.add)}function e3(e,t){const i=e.getValue("willChange");if(eve(i))return i.add(t)}function r$(e){return e.props[RK]}const n$=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,tve=1e-7,ive=12;function rve(e,t,i,r,n){let s,a,o=0;do a=t+(i-t)/2,s=n$(a,r,n)-e,s>0?i=a:t=a;while(Math.abs(s)>tve&&++o<ive);return a}function U_(e,t,i,r){if(e===t&&i===r)return Yo;const n=s=>rve(s,0,1,e,i);return s=>s===0||s===1?s:n$(n(s),t,r)}const s$=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,a$=e=>t=>1-e(1-t),o$=U_(.33,1.53,.69,.99),m4=a$(o$),l$=s$(m4),u$=e=>(e*=2)<1?.5*m4(e):.5*(2-Math.pow(2,-10*(e-1))),g4=e=>1-Math.sin(Math.acos(e)),c$=a$(g4),h$=s$(g4),d$=e=>/^0[^.\s]+$/u.test(e);function nve(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||d$(e):!0}const lb=e=>Math.round(e*1e5)/1e5,v4=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function sve(e){return e==null}const ave=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,y4=(e,t)=>i=>!!(typeof i=="string"&&ave.test(i)&&i.startsWith(e)||t&&!sve(i)&&Object.prototype.hasOwnProperty.call(i,t)),f$=(e,t,i)=>r=>{if(typeof r!="string")return r;const[n,s,a,o]=r.match(v4);return{[e]:parseFloat(n),[t]:parseFloat(s),[i]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},ove=e=>Rh(0,255,e),qP={...e1,transform:e=>Math.round(ove(e))},vg={test:y4("rgb","red"),parse:f$("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:r=1})=>"rgba("+qP.transform(e)+", "+qP.transform(t)+", "+qP.transform(i)+", "+lb(t_.transform(r))+")"};function lve(e){let t="",i="",r="",n="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),r=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),r=e.substring(3,4),n=e.substring(4,5),t+=t,i+=i,r+=r,n+=n),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(r,16),alpha:n?parseInt(n,16)/255:1}}const t3={test:y4("#"),parse:lve,transform:vg.transform},z0={test:y4("hsl","hue"),parse:f$("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:r=1})=>"hsla("+Math.round(e)+", "+Ah.transform(lb(t))+", "+Ah.transform(lb(i))+", "+lb(t_.transform(r))+")"},uo={test:e=>vg.test(e)||t3.test(e)||z0.test(e),parse:e=>vg.test(e)?vg.parse(e):z0.test(e)?z0.parse(e):t3.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?vg.transform(e):z0.transform(e)},uve=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function cve(e){var t,i;return isNaN(e)&&typeof e=="string"&&(((t=e.match(v4))===null||t===void 0?void 0:t.length)||0)+(((i=e.match(uve))===null||i===void 0?void 0:i.length)||0)>0}const p$="number",m$="color",hve="var",dve="var(",T6="${}",fve=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function i_(e){const t=e.toString(),i=[],r={color:[],number:[],var:[]},n=[];let s=0;const o=t.replace(fve,l=>(uo.test(l)?(r.color.push(s),n.push(m$),i.push(uo.parse(l))):l.startsWith(dve)?(r.var.push(s),n.push(hve),i.push(l)):(r.number.push(s),n.push(p$),i.push(parseFloat(l))),++s,T6)).split(T6);return{values:i,split:o,indexes:r,types:n}}function g$(e){return i_(e).values}function v$(e){const{split:t,types:i}=i_(e),r=t.length;return n=>{let s="";for(let a=0;a<r;a++)if(s+=t[a],n[a]!==void 0){const o=i[a];o===p$?s+=lb(n[a]):o===m$?s+=uo.transform(n[a]):s+=n[a]}return s}}const pve=e=>typeof e=="number"?0:e;function mve(e){const t=g$(e);return v$(e)(t.map(pve))}const qp={test:cve,parse:g$,createTransformer:v$,getAnimatableNone:mve},gve=new Set(["brightness","contrast","saturate","opacity"]);function vve(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=i.match(v4)||[];if(!r)return e;const n=i.replace(r,"");let s=gve.has(t)?1:0;return r!==i&&(s*=100),t+"("+s+n+")"}const yve=/\b([a-z-]*)\(.*?\)/gu,i3={...qp,getAnimatableNone:e=>{const t=e.match(yve);return t?t.map(vve).join(" "):e}},xve={...Jk,color:uo,backgroundColor:uo,outlineColor:uo,fill:uo,stroke:uo,borderColor:uo,borderTopColor:uo,borderRightColor:uo,borderBottomColor:uo,borderLeftColor:uo,filter:i3,WebkitFilter:i3},x4=e=>xve[e];function y$(e,t){let i=x4(e);return i!==i3&&(i=qp),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const bve=new Set(["auto","none","0"]);function _ve(e,t,i){let r=0,n;for(;r<e.length&&!n;){const s=e[r];typeof s=="string"&&!bve.has(s)&&i_(s).values.length&&(n=e[r]),r++}if(n&&i)for(const s of t)e[s]=y$(i,n)}const C6=e=>e===e1||e===Ri,A6=(e,t)=>parseFloat(e.split(", ")[t]),M6=(e,t)=>(i,{transform:r})=>{if(r==="none"||!r)return 0;const n=r.match(/^matrix3d\((.+)\)$/u);if(n)return A6(n[1],t);{const s=r.match(/^matrix\((.+)\)$/u);return s?A6(s[1],e):0}},wve=new Set(["x","y","z"]),Eve=Jy.filter(e=>!wve.has(e));function Sve(e){const t=[];return Eve.forEach(i=>{const r=e.getValue(i);r!==void 0&&(t.push([i,r.get()]),r.set(i.startsWith("scale")?1:0))}),t}const Ay={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:M6(4,13),y:M6(5,14)};Ay.translateX=Ay.x;Ay.translateY=Ay.y;const Pg=new Set;let r3=!1,n3=!1;function x$(){if(n3){const e=Array.from(Pg).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),i=new Map;t.forEach(r=>{const n=Sve(r);n.length&&(i.set(r,n),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const n=i.get(r);n&&n.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}n3=!1,r3=!1,Pg.forEach(e=>e.complete()),Pg.clear()}function b$(){Pg.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(n3=!0)})}function Tve(){b$(),x$()}class b4{constructor(t,i,r,n,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=i,this.name=r,this.motionValue=n,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Pg.add(this),r3||(r3=!0,Ur.read(b$),Ur.resolveKeyframes(x$))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:i,element:r,motionValue:n}=this;for(let s=0;s<t.length;s++)if(t[s]===null)if(s===0){const a=n==null?void 0:n.get(),o=t[t.length-1];if(a!==void 0)t[0]=a;else if(r&&i){const l=r.readValue(i,o);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=o),n&&a===void 0&&n.set(t[0])}else t[s]=t[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Pg.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Pg.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const _$=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Cve=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Ave(e){const t=Cve.exec(e);if(!t)return[,];const[,i,r,n]=t;return[`--${i??r}`,n]}function w$(e,t,i=1){const[r,n]=Ave(e);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const a=s.trim();return _$(a)?parseFloat(a):a}return Qk(n)?w$(n,t,i+1):n}const E$=e=>t=>t.test(e),Mve={test:e=>e==="auto",parse:e=>e},S$=[e1,Ri,Ah,ep,bge,xge,Mve],P6=e=>S$.find(E$(e));class T$ extends b4{constructor(t,i,r,n,s){super(t,i,r,n,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:i,name:r}=this;if(!i||!i.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let u=t[l];if(typeof u=="string"&&(u=u.trim(),Qk(u))){const c=w$(u,i.current);c!==void 0&&(t[l]=c),l===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!i$.has(r)||t.length!==2)return;const[n,s]=t,a=P6(n),o=P6(s);if(a!==o)if(C6(a)&&C6(o))for(let l=0;l<t.length;l++){const u=t[l];typeof u=="string"&&(t[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:i}=this,r=[];for(let n=0;n<t.length;n++)nve(t[n])&&r.push(n);r.length&&_ve(t,r,i)}measureInitialState(){const{element:t,unresolvedKeyframes:i,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ay[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i[0]=this.measuredOrigin;const n=i[i.length-1];n!==void 0&&t.getValue(r,n).jump(n,!1)}measureEndState(){var t;const{element:i,name:r,unresolvedKeyframes:n}=this;if(!i||!i.current)return;const s=i.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,o=n[a];n[a]=Ay[r](i.measureViewportBox(),window.getComputedStyle(i.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([l,u])=>{i.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const D6=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(qp.test(e)||e==="0")&&!e.startsWith("url("));function Pve(e){const t=e[0];if(e.length===1)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}function Dve(e,t,i,r){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],a=D6(n,t),o=D6(s,t);return!a||!o?!1:Pve(e)||(i==="spring"||a4(i))&&r}const Ive=e=>e!==null;function uM(e,{repeat:t,repeatType:i="loop"},r){const n=e.filter(Ive),s=t&&i!=="loop"&&t%2===1?0:n.length-1;return!s||r===void 0?n[s]:r}const Ove=40;class C${constructor({autoplay:t=!0,delay:i=0,type:r="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Mh.now(),this.options={autoplay:t,delay:i,type:r,repeat:n,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Ove?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Tve(),this._resolved}onKeyframesResolved(t,i){this.resolvedAt=Mh.now(),this.hasAttemptedResolve=!0;const{name:r,type:n,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!Dve(t,r,n,s))if(a)this.options.duration=0;else{l&&l(uM(t,this.options,i)),o&&o(),this.resolveFinishedPromise();return}const c=this.initPlayback(t,i);c!==!1&&(this._resolved={keyframes:t,finalKeyframe:i,...c},this.onPostResolved())}onPostResolved(){}then(t,i){return this.currentFinishedPromise.then(t,i)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const zn=(e,t,i)=>e+(t-e)*i;function YP(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function Rve({hue:e,saturation:t,lightness:i,alpha:r}){e/=360,t/=100,i/=100;let n=0,s=0,a=0;if(!t)n=s=a=i;else{const o=i<.5?i*(1+t):i+t-i*t,l=2*i-o;n=YP(l,o,e+1/3),s=YP(l,o,e),a=YP(l,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function fC(e,t){return i=>i>0?t:e}const XP=(e,t,i)=>{const r=e*e,n=i*(t*t-r)+r;return n<0?0:Math.sqrt(n)},Lve=[t3,vg,z0],Nve=e=>Lve.find(t=>t.test(e));function I6(e){const t=Nve(e);if(!t)return!1;let i=t.parse(e);return t===z0&&(i=Rve(i)),i}const O6=(e,t)=>{const i=I6(e),r=I6(t);if(!i||!r)return fC(e,t);const n={...i};return s=>(n.red=XP(i.red,r.red,s),n.green=XP(i.green,r.green,s),n.blue=XP(i.blue,r.blue,s),n.alpha=zn(i.alpha,r.alpha,s),vg.transform(n))},kve=(e,t)=>i=>t(e(i)),j_=(...e)=>e.reduce(kve),s3=new Set(["none","hidden"]);function Bve(e,t){return s3.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}function zve(e,t){return i=>zn(e,t,i)}function _4(e){return typeof e=="number"?zve:typeof e=="string"?Qk(e)?fC:uo.test(e)?O6:jve:Array.isArray(e)?A$:typeof e=="object"?uo.test(e)?O6:Fve:fC}function A$(e,t){const i=[...e],r=i.length,n=e.map((s,a)=>_4(s)(s,t[a]));return s=>{for(let a=0;a<r;a++)i[a]=n[a](s);return i}}function Fve(e,t){const i={...e,...t},r={};for(const n in i)e[n]!==void 0&&t[n]!==void 0&&(r[n]=_4(e[n])(e[n],t[n]));return n=>{for(const s in r)i[s]=r[s](n);return i}}function Uve(e,t){var i;const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],o=e.indexes[a][n[a]],l=(i=e.values[o])!==null&&i!==void 0?i:0;r[s]=l,n[a]++}return r}const jve=(e,t)=>{const i=qp.createTransformer(t),r=i_(e),n=i_(t);return r.indexes.var.length===n.indexes.var.length&&r.indexes.color.length===n.indexes.color.length&&r.indexes.number.length>=n.indexes.number.length?s3.has(e)&&!n.values.length||s3.has(t)&&!r.values.length?Bve(e,t):j_(A$(Uve(r,n),n.values),i):fC(e,t)};function M$(e,t,i){return typeof e=="number"&&typeof t=="number"&&typeof i=="number"?zn(e,t,i):_4(e)(e,t)}const Vve=5;function P$(e,t,i){const r=Math.max(t-Vve,0);return f4(i-e(r),t-r)}const Kn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},R6=.001;function Hve({duration:e=Kn.duration,bounce:t=Kn.bounce,velocity:i=Kn.velocity,mass:r=Kn.mass}){let n,s,a=1-t;a=Rh(Kn.minDamping,Kn.maxDamping,a),e=Rh(Kn.minDuration,Kn.maxDuration,Jd(e)),a<1?(n=u=>{const c=u*a,h=c*e,d=c-i,f=a3(u,a),m=Math.exp(-h);return R6-d/f*m},s=u=>{const h=u*a*e,d=h*i+i,f=Math.pow(a,2)*Math.pow(u,2)*e,m=Math.exp(-h),g=a3(Math.pow(u,2),a);return(-n(u)+R6>0?-1:1)*((d-f)*m)/g}):(n=u=>{const c=Math.exp(-u*e),h=(u-i)*e+1;return-.001+c*h},s=u=>{const c=Math.exp(-u*e),h=(i-u)*(e*e);return c*h});const o=5/e,l=Gve(n,s,o);if(e=Qd(e),isNaN(l))return{stiffness:Kn.stiffness,damping:Kn.damping,duration:e};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:e}}}const Wve=12;function Gve(e,t,i){let r=i;for(let n=1;n<Wve;n++)r=r-e(r)/t(r);return r}function a3(e,t){return e*Math.sqrt(1-t*t)}const qve=["duration","bounce"],Yve=["stiffness","damping","mass"];function L6(e,t){return t.some(i=>e[i]!==void 0)}function Xve(e){let t={velocity:Kn.velocity,stiffness:Kn.stiffness,damping:Kn.damping,mass:Kn.mass,isResolvedFromDuration:!1,...e};if(!L6(e,Yve)&&L6(e,qve))if(e.visualDuration){const i=e.visualDuration,r=2*Math.PI/(i*1.2),n=r*r,s=2*Rh(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:Kn.mass,stiffness:n,damping:s}}else{const i=Hve(e);t={...t,...i,mass:Kn.mass},t.isResolvedFromDuration=!0}return t}function D$(e=Kn.visualDuration,t=Kn.bounce){const i=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:n}=i;const s=i.keyframes[0],a=i.keyframes[i.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:c,duration:h,velocity:d,isResolvedFromDuration:f}=Xve({...i,velocity:-Jd(i.velocity||0)}),m=d||0,g=u/(2*Math.sqrt(l*c)),y=a-s,x=Jd(Math.sqrt(l/c)),w=Math.abs(y)<5;r||(r=w?Kn.restSpeed.granular:Kn.restSpeed.default),n||(n=w?Kn.restDelta.granular:Kn.restDelta.default);let b;if(g<1){const A=a3(x,g);b=E=>{const _=Math.exp(-g*x*E);return a-_*((m+g*x*y)/A*Math.sin(A*E)+y*Math.cos(A*E))}}else if(g===1)b=A=>a-Math.exp(-x*A)*(y+(m+x*y)*A);else{const A=x*Math.sqrt(g*g-1);b=E=>{const _=Math.exp(-g*x*E),P=Math.min(A*E,300);return a-_*((m+g*x*y)*Math.sinh(P)+A*y*Math.cosh(P))/A}}const C={calculatedDuration:f&&h||null,next:A=>{const E=b(A);if(f)o.done=A>=h;else{let _=0;g<1&&(_=A===0?Qd(m):P$(b,A,E));const P=Math.abs(_)<=r,I=Math.abs(a-E)<=n;o.done=P&&I}return o.value=o.done?a:E,o},toString:()=>{const A=Math.min(KK(C),QR),E=$K(_=>C.next(A*_).value,A,30);return A+"ms "+E}};return C}function N6({keyframes:e,velocity:t=0,power:i=.8,timeConstant:r=325,bounceDamping:n=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:c}){const h=e[0],d={done:!1,value:h},f=P=>o!==void 0&&P<o||l!==void 0&&P>l,m=P=>o===void 0?l:l===void 0||Math.abs(o-P)<Math.abs(l-P)?o:l;let g=i*t;const y=h+g,x=a===void 0?y:a(y);x!==y&&(g=x-h);const w=P=>-g*Math.exp(-P/r),b=P=>x+w(P),C=P=>{const I=w(P),D=b(P);d.done=Math.abs(I)<=u,d.value=d.done?x:D};let A,E;const _=P=>{f(d.value)&&(A=P,E=D$({keyframes:[d.value,m(d.value)],velocity:P$(b,P,d.value),damping:n,stiffness:s,restDelta:u,restSpeed:c}))};return _(0),{calculatedDuration:null,next:P=>{let I=!1;return!E&&A===void 0&&(I=!0,C(P),_(P)),A!==void 0&&P>=A?E.next(P-A):(!I&&C(P),d)}}}const Kve=U_(.42,0,1,1),$ve=U_(0,0,.58,1),I$=U_(.42,0,.58,1),Zve=e=>Array.isArray(e)&&typeof e[0]!="number",Qve={linear:Yo,easeIn:Kve,easeInOut:I$,easeOut:$ve,circIn:g4,circInOut:h$,circOut:c$,backIn:m4,backInOut:l$,backOut:o$,anticipate:u$},k6=e=>{if(o4(e)){MK(e.length===4);const[t,i,r,n]=e;return U_(t,i,r,n)}else if(typeof e=="string")return Qve[e];return e};function Jve(e,t,i){const r=[],n=i||M$,s=e.length-1;for(let a=0;a<s;a++){let o=n(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Yo:t;o=j_(l,o)}r.push(o)}return r}function w4(e,t,{clamp:i=!0,ease:r,mixer:n}={}){const s=e.length;if(MK(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Jve(t,r,n),l=o.length,u=c=>{if(a&&c<e[0])return t[0];let h=0;if(l>1)for(;h<e.length-2&&!(c<e[h+1]);h++);const d=Hg(e[h],e[h+1],c);return o[h](d)};return i?c=>u(Rh(e[0],e[s-1],c)):u}function e0e(e,t){const i=e[e.length-1];for(let r=1;r<=t;r++){const n=Hg(0,t,r);e.push(zn(i,1,n))}}function O$(e){const t=[0];return e0e(t,e.length-1),t}function t0e(e,t){return e.map(i=>i*t)}function i0e(e,t){return e.map(()=>t||I$).splice(0,e.length-1)}function pC({duration:e=300,keyframes:t,times:i,ease:r="easeInOut"}){const n=Zve(r)?r.map(k6):k6(r),s={done:!1,value:t[0]},a=t0e(i&&i.length===t.length?i:O$(t),e),o=w4(a,t,{ease:Array.isArray(n)?n:i0e(t,n)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}const r0e=e=>{const t=({timestamp:i})=>e(i);return{start:()=>Ur.update(t,!0),stop:()=>Tc(t),now:()=>qs.isProcessing?qs.timestamp:Mh.now()}},n0e={decay:N6,inertia:N6,tween:pC,keyframes:pC,spring:D$},s0e=e=>e/100;class cM extends C${constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:i,motionValue:r,element:n,keyframes:s}=this.options,a=(n==null?void 0:n.KeyframeResolver)||b4,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(s,o,i,r,n),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:i="keyframes",repeat:r=0,repeatDelay:n=0,repeatType:s,velocity:a=0}=this.options,o=a4(i)?i:n0e[i]||pC;let l,u;o!==pC&&typeof t[0]!="number"&&(l=j_(s0e,M$(t[0],t[1])),t=[0,100]);const c=o({...this.options,keyframes:t});s==="mirror"&&(u=o({...this.options,keyframes:[...t].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=KK(c));const{calculatedDuration:h}=c,d=h+n,f=d*(r+1)-n;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,i=!1){const{resolved:r}=this;if(!r){const{keyframes:P}=this.options;return{done:!0,value:P[P.length-1]}}const{finalKeyframe:n,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:h}=r;if(this.startTime===null)return s.next(0);const{delay:d,repeat:f,repeatType:m,repeatDelay:g,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-c/this.speed,this.startTime)),i?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const x=this.currentTime-d*(this.speed>=0?1:-1),w=this.speed>=0?x<0:x>c;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let b=this.currentTime,C=s;if(f){const P=Math.min(this.currentTime,c)/h;let I=Math.floor(P),D=P%1;!D&&P>=1&&(D=1),D===1&&I--,I=Math.min(I,f+1),!!(I%2)&&(m==="reverse"?(D=1-D,g&&(D-=g/h)):m==="mirror"&&(C=a)),b=Rh(0,1,D)*h}const A=w?{done:!1,value:l[0]}:C.next(b);o&&(A.value=o(A.value));let{done:E}=A;!w&&u!==null&&(E=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return _&&n!==void 0&&(A.value=uM(l,this.options,n)),y&&y(A.value),_&&this.finish(),A}get duration(){const{resolved:t}=this;return t?Jd(t.calculatedDuration):0}get time(){return Jd(this.currentTime)}set time(t){t=Qd(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const i=this.playbackSpeed!==t;this.playbackSpeed=t,i&&(this.time=Jd(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=r0e,onPlay:i,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),i&&i();const n=this.driver.now();this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=n):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}function a0e(e){return new cM(e)}const o0e=new Set(["opacity","clipPath","filter","transform"]);function l0e(e,t,i,{delay:r=0,duration:n=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[t]:i};l&&(u.offset=l);const c=QK(o,n);return Array.isArray(c)&&(u.easing=c),e.animate(u,{delay:r,duration:n,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const u0e=Gk(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),mC=10,c0e=2e4;function h0e(e){return a4(e.type)||e.type==="spring"||!ZK(e.ease)}function d0e(e,t){const i=new cM({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:e[0]};const n=[];let s=0;for(;!r.done&&s<c0e;)r=i.sample(s),n.push(r.value),s+=mC;return{times:void 0,keyframes:n,duration:s-mC,ease:"linear"}}const R$={anticipate:u$,backInOut:l$,circInOut:h$};function f0e(e){return e in R$}class B6 extends C${constructor(t){super(t);const{name:i,motionValue:r,element:n,keyframes:s}=this.options;this.resolver=new T$(s,(a,o)=>this.onKeyframesResolved(a,o),i,r,n),this.resolver.scheduleResolve()}initPlayback(t,i){let{duration:r=300,times:n,ease:s,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&dC()&&f0e(s)&&(s=R$[s]),h0e(this.options)){const{onComplete:h,onUpdate:d,motionValue:f,element:m,...g}=this.options,y=d0e(t,g);t=y.keyframes,t.length===1&&(t[1]=t[0]),r=y.duration,n=y.times,s=y.ease,a="keyframes"}const c=l0e(o.owner.current,l,t,{...this.options,duration:r,times:n,ease:s});return c.startTime=u??this.calcStartTime(),this.pendingTimeline?(b6(c,this.pendingTimeline),this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:h}=this.options;o.set(uM(t,this.options,i)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:r,times:n,type:a,ease:s,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:i}=t;return Jd(i)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:i}=t;return Jd(i.currentTime||0)}set time(t){const{resolved:i}=this;if(!i)return;const{animation:r}=i;r.currentTime=Qd(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:i}=t;return i.playbackRate}set speed(t){const{resolved:i}=this;if(!i)return;const{animation:r}=i;r.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:i}=t;return i.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:i}=t;return i.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:i}=this;if(!i)return Yo;const{animation:r}=i;b6(r,t)}return Yo}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playState==="finished"&&this.updateFinishedPromise(),i.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:i,keyframes:r,duration:n,type:s,ease:a,times:o}=t;if(i.playState==="idle"||i.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:c,onComplete:h,element:d,...f}=this.options,m=new cM({...f,keyframes:r,duration:n,type:s,ease:a,times:o,isGenerator:!0}),g=Qd(this.time);u.setWithVelocity(m.sample(g-mC).value,m.sample(g).value,mC)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:i,name:r,repeatDelay:n,repeatType:s,damping:a,type:o}=t;if(!i||!i.owner||!(i.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=i.owner.getProps();return u0e()&&r&&o0e.has(r)&&!l&&!u&&!n&&s!=="mirror"&&a!==0&&o!=="inertia"}}const p0e={type:"spring",stiffness:500,damping:25,restSpeed:10},m0e=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),g0e={type:"keyframes",duration:.8},v0e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},y0e=(e,{keyframes:t})=>t.length>2?g0e:sv.has(e)?e.startsWith("scale")?m0e(t[1]):p0e:v0e;function x0e({when:e,delay:t,delayChildren:i,staggerChildren:r,staggerDirection:n,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const E4=(e,t,i,r={},n,s)=>a=>{const o=s4(r,e)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Qd(l);let c={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:d=>{t.set(d),o.onUpdate&&o.onUpdate(d)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:n};x0e(o)||(c={...c,...y0e(e,c)}),c.duration&&(c.duration=Qd(c.duration)),c.repeatDelay&&(c.repeatDelay=Qd(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let h=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(h=!0)),h&&!s&&t.get()!==void 0){const d=uM(c.keyframes,o);if(d!==void 0)return Ur.update(()=>{c.onUpdate(d),c.onComplete()}),new jge([])}return!s&&B6.supports(c)?new B6(c):new cM(c)};function b0e({protectedKeys:e,needsAnimating:t},i){const r=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,r}function L$(e,t,{delay:i=0,transitionOverride:r,type:n}={}){var s;let{transition:a=e.getDefaultTransition(),transitionEnd:o,...l}=t;r&&(a=r);const u=[],c=n&&e.animationState&&e.animationState.getState()[n];for(const h in l){const d=e.getValue(h,(s=e.latestValues[h])!==null&&s!==void 0?s:null),f=l[h];if(f===void 0||c&&b0e(c,h))continue;const m={delay:i,...s4(a||{},h)};let g=!1;if(window.MotionHandoffAnimation){const x=r$(e);if(x){const w=window.MotionHandoffAnimation(x,h,Ur);w!==null&&(m.startTime=w,g=!0)}}e3(e,h),d.start(E4(h,d,f,e.shouldReduceMotion&&i$.has(h)?{type:!1}:m,e,g));const y=d.animation;y&&u.push(y)}return o&&Promise.all(u).then(()=>{Ur.update(()=>{o&&p4(e,o)})}),u}function o3(e,t,i={}){var r;const n=lM(e,t,i.type==="exit"?(r=e.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};i.transitionOverride&&(s=i.transitionOverride);const a=n?()=>Promise.all(L$(e,n,i)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:d}=s;return _0e(e,t,c+u,h,d,i)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,c]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>c())}else return Promise.all([a(),o(i.delay)])}function _0e(e,t,i=0,r=0,n=1,s){const a=[],o=(e.variantChildren.size-1)*r,l=n===1?(u=0)=>u*r:(u=0)=>o-u*r;return Array.from(e.variantChildren).sort(w0e).forEach((u,c)=>{u.notify("AnimationStart",t),a.push(o3(u,t,{...s,delay:i+l(c)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(a)}function w0e(e,t){return e.sortNodePosition(t)}function N$(e,t,i={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const n=t.map(s=>o3(e,s,i));r=Promise.all(n)}else if(typeof t=="string")r=o3(e,t,i);else{const n=typeof t=="function"?lM(e,t,i.custom):t;r=Promise.all(L$(e,n,i))}return r.then(()=>{e.notify("AnimationComplete",t)})}const E0e=Yk.length;function k$(e){if(!e)return;if(!e.isControllingVariants){const i=e.parent?k$(e.parent)||{}:{};return e.props.initial!==void 0&&(i.initial=e.props.initial),i}const t={};for(let i=0;i<E0e;i++){const r=Yk[i],n=e.props[r];(e_(n)||n===!1)&&(t[r]=n)}return t}const S0e=[...qk].reverse(),T0e=qk.length;function C0e(e){return t=>Promise.all(t.map(({animation:i,options:r})=>N$(e,i,r)))}function A0e(e){let t=C0e(e),i=z6(),r=!0;const n=l=>(u,c)=>{var h;const d=lM(e,c,l==="exit"?(h=e.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:m,...g}=d;u={...u,...g,...m}}return u};function s(l){t=l(e)}function a(l){const{props:u}=e,c=k$(e.parent)||{},h=[],d=new Set;let f={},m=1/0;for(let y=0;y<T0e;y++){const x=S0e[y],w=i[x],b=u[x]!==void 0?u[x]:c[x],C=e_(b),A=x===l?w.isActive:null;A===!1&&(m=y);let E=b===c[x]&&b!==u[x]&&C;if(E&&r&&e.manuallyAnimateOnMount&&(E=!1),w.protectedKeys={...f},!w.isActive&&A===null||!b&&!w.prevProp||aM(b)||typeof b=="boolean")continue;const _=M0e(w.prevProp,b);let P=_||x===l&&w.isActive&&!E&&C||y>m&&C,I=!1;const D=Array.isArray(b)?b:[b];let k=D.reduce(n(x),{});A===!1&&(k={});const{prevResolvedValues:B={}}=w,z={...B,...k},W=G=>{P=!0,d.has(G)&&(I=!0,d.delete(G)),w.needsAnimating[G]=!0;const V=e.getValue(G);V&&(V.liveStyle=!1)};for(const G in z){const V=k[G],J=B[G];if(f.hasOwnProperty(G))continue;let U=!1;ZR(V)&&ZR(J)?U=!YK(V,J):U=V!==J,U?V!=null?W(G):d.add(G):V!==void 0&&d.has(G)?W(G):w.protectedKeys[G]=!0}w.prevProp=b,w.prevResolvedValues=k,w.isActive&&(f={...f,...k}),r&&e.blockInitialAnimation&&(P=!1),P&&(!(E&&_)||I)&&h.push(...D.map(G=>({animation:G,options:{type:x}})))}if(d.size){const y={};d.forEach(x=>{const w=e.getBaseTarget(x),b=e.getValue(x);b&&(b.liveStyle=!0),y[x]=w??null}),h.push({animation:y})}let g=!!h.length;return r&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(g=!1),r=!1,g?t(h):Promise.resolve()}function o(l,u){var c;if(i[l].isActive===u)return Promise.resolve();(c=e.variantChildren)===null||c===void 0||c.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,u)}),i[l].isActive=u;const h=a(l);for(const d in i)i[d].protectedKeys={};return h}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>i,reset:()=>{i=z6(),r=!0}}}function M0e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!YK(t,e):!1}function zm(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function z6(){return{animate:zm(!0),whileInView:zm(),whileHover:zm(),whileTap:zm(),whileDrag:zm(),whileFocus:zm(),exit:zm()}}class im{constructor(t){this.isMounted=!1,this.node=t}update(){}}class P0e extends im{constructor(t){super(t),t.animationState||(t.animationState=A0e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();aM(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let D0e=0;class I0e extends im{constructor(){super(...arguments),this.id=D0e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const n=this.node.animationState.setActive("exit",!t);i&&!t&&n.then(()=>i(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const O0e={animation:{Feature:P0e},exit:{Feature:I0e}};function r_(e,t,i,r={passive:!0}){return e.addEventListener(t,i,r),()=>e.removeEventListener(t,i)}function V_(e){return{point:{x:e.pageX,y:e.pageY}}}const R0e=e=>t=>u4(t)&&e(t,V_(t));function ub(e,t,i,r){return r_(e,t,R0e(i),r)}const F6=(e,t)=>Math.abs(e-t);function L0e(e,t){const i=F6(e.x,t.x),r=F6(e.y,t.y);return Math.sqrt(i**2+r**2)}class B${constructor(t,i,{transformPagePoint:r,contextWindow:n,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=$P(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=L0e(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:m}=h,{timestamp:g}=qs;this.history.push({...m,timestamp:g});const{onStart:y,onMove:x}=this.handlers;d||(y&&y(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=KP(d,this.transformPagePoint),Ur.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:m,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=$P(h.type==="pointercancel"?this.lastMoveEventInfo:KP(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,y),m&&m(h,y)},!u4(t))return;this.dragSnapToOrigin=s,this.handlers=i,this.transformPagePoint=r,this.contextWindow=n||window;const a=V_(t),o=KP(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=qs;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=i;c&&c(t,$P(o,this.history)),this.removeListeners=j_(ub(this.contextWindow,"pointermove",this.handlePointerMove),ub(this.contextWindow,"pointerup",this.handlePointerUp),ub(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Tc(this.updatePoint)}}function KP(e,t){return t?{point:t(e.point)}:e}function U6(e,t){return{x:e.x-t.x,y:e.y-t.y}}function $P({point:e},t){return{point:e,delta:U6(e,z$(t)),offset:U6(e,N0e(t)),velocity:k0e(t,.1)}}function N0e(e){return e[0]}function z$(e){return e[e.length-1]}function k0e(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,r=null;const n=z$(e);for(;i>=0&&(r=e[i],!(n.timestamp-r.timestamp>Qd(t)));)i--;if(!r)return{x:0,y:0};const s=Jd(n.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(n.x-r.x)/s,y:(n.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const F$=1e-4,B0e=1-F$,z0e=1+F$,U$=.01,F0e=0-U$,U0e=0+U$;function ru(e){return e.max-e.min}function j0e(e,t,i){return Math.abs(e-t)<=i}function j6(e,t,i,r=.5){e.origin=r,e.originPoint=zn(t.min,t.max,e.origin),e.scale=ru(i)/ru(t),e.translate=zn(i.min,i.max,e.origin)-e.originPoint,(e.scale>=B0e&&e.scale<=z0e||isNaN(e.scale))&&(e.scale=1),(e.translate>=F0e&&e.translate<=U0e||isNaN(e.translate))&&(e.translate=0)}function cb(e,t,i,r){j6(e.x,t.x,i.x,r?r.originX:void 0),j6(e.y,t.y,i.y,r?r.originY:void 0)}function V6(e,t,i){e.min=i.min+t.min,e.max=e.min+ru(t)}function V0e(e,t,i){V6(e.x,t.x,i.x),V6(e.y,t.y,i.y)}function H6(e,t,i){e.min=t.min-i.min,e.max=e.min+ru(t)}function hb(e,t,i){H6(e.x,t.x,i.x),H6(e.y,t.y,i.y)}function H0e(e,{min:t,max:i},r){return t!==void 0&&e<t?e=r?zn(t,e,r.min):Math.max(e,t):i!==void 0&&e>i&&(e=r?zn(i,e,r.max):Math.min(e,i)),e}function W6(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function W0e(e,{top:t,left:i,bottom:r,right:n}){return{x:W6(e.x,i,n),y:W6(e.y,t,r)}}function G6(e,t){let i=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,r]=[r,i]),{min:i,max:r}}function G0e(e,t){return{x:G6(e.x,t.x),y:G6(e.y,t.y)}}function q0e(e,t){let i=.5;const r=ru(e),n=ru(t);return n>r?i=Hg(t.min,t.max-r,e.min):r>n&&(i=Hg(e.min,e.max-n,t.min)),Rh(0,1,i)}function Y0e(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const l3=.35;function X0e(e=l3){return e===!1?e=0:e===!0&&(e=l3),{x:q6(e,"left","right"),y:q6(e,"top","bottom")}}function q6(e,t,i){return{min:Y6(e,t),max:Y6(e,i)}}function Y6(e,t){return typeof e=="number"?e:e[t]||0}const X6=()=>({translate:0,scale:1,origin:0,originPoint:0}),F0=()=>({x:X6(),y:X6()}),K6=()=>({min:0,max:0}),ds=()=>({x:K6(),y:K6()});function Eu(e){return[e("x"),e("y")]}function j$({top:e,left:t,right:i,bottom:r}){return{x:{min:t,max:i},y:{min:e,max:r}}}function K0e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function $0e(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:r.y,right:r.x}}function ZP(e){return e===void 0||e===1}function u3({scale:e,scaleX:t,scaleY:i}){return!ZP(e)||!ZP(t)||!ZP(i)}function Jm(e){return u3(e)||V$(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function V$(e){return $6(e.x)||$6(e.y)}function $6(e){return e&&e!=="0%"}function gC(e,t,i){const r=e-i,n=t*r;return i+n}function Z6(e,t,i,r,n){return n!==void 0&&(e=gC(e,n,r)),gC(e,i,r)+t}function c3(e,t=0,i=1,r,n){e.min=Z6(e.min,t,i,r,n),e.max=Z6(e.max,t,i,r,n)}function H$(e,{x:t,y:i}){c3(e.x,t.translate,t.scale,t.originPoint),c3(e.y,i.translate,i.scale,i.originPoint)}const Q6=.999999999999,J6=1.0000000000001;function Z0e(e,t,i,r=!1){const n=i.length;if(!n)return;t.x=t.y=1;let s,a;for(let o=0;o<n;o++){s=i[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&j0(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,H$(e,a)),r&&Jm(s.latestValues)&&j0(e,s.latestValues))}t.x<J6&&t.x>Q6&&(t.x=1),t.y<J6&&t.y>Q6&&(t.y=1)}function U0(e,t){e.min=e.min+t,e.max=e.max+t}function ej(e,t,i,r,n=.5){const s=zn(e.min,e.max,n);c3(e,t,i,s,r)}function j0(e,t){ej(e.x,t.x,t.scaleX,t.scale,t.originX),ej(e.y,t.y,t.scaleY,t.scale,t.originY)}function W$(e,t){return j$($0e(e.getBoundingClientRect(),t))}function Q0e(e,t,i){const r=W$(e,i),{scroll:n}=t;return n&&(U0(r.x,n.offset.x),U0(r.y,n.offset.y)),r}const G$=({current:e})=>e?e.ownerDocument.defaultView:null,J0e=new WeakMap;class eye{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ds(),this.visualElement=t}start(t,{snapToCursor:i=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const n=c=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(V_(c).point)},s=(c,h)=>{const{drag:d,dragPropagation:f,onDragStart:m}=this.getProps();if(d&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Kge(d),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Eu(y=>{let x=this.getAxisMotionValue(y).get()||0;if(Ah.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const b=w.layout.layoutBox[y];b&&(x=ru(b)*(parseFloat(x)/100))}}this.originPoint[y]=x}),m&&Ur.postRender(()=>m(c,h)),e3(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},a=(c,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:m,onDrag:g}=this.getProps();if(!d&&!this.openDragLock)return;const{offset:y}=h;if(f&&this.currentDirection===null){this.currentDirection=tye(y),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),g&&g(c,h)},o=(c,h)=>this.stop(c,h),l=()=>Eu(c=>{var h;return this.getAnimationState(c)==="paused"&&((h=this.getAxisMotionValue(c).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new B$(t,{onSessionStart:n,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:G$(this.visualElement)})}stop(t,i){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:n}=i;this.startAnimation(n);const{onDragEnd:s}=this.getProps();s&&Ur.postRender(()=>s(t,i))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,r){const{drag:n}=this.getProps();if(!r||!pE(t,n,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=H0e(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){var t;const{dragConstraints:i,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,s=this.constraints;i&&B0(i)?this.constraints||(this.constraints=this.resolveRefConstraints()):i&&n?this.constraints=W0e(n.layoutBox,i):this.constraints=!1,this.elastic=X0e(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Eu(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Y0e(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!B0(t))return!1;const r=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const s=Q0e(r,n.root,this.visualElement.getTransformPagePoint());let a=G0e(n.layout.layoutBox,s);if(i){const o=i(K0e(a));this.hasMutatedConstraints=!!o,o&&(a=j$(o))}return a}startAnimation(t){const{drag:i,dragMomentum:r,dragElastic:n,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=Eu(c=>{if(!pE(c,i,this.currentDirection))return;let h=l&&l[c]||{};a&&(h={min:0,max:0});const d=n?200:1e6,f=n?40:1e7,m={type:"inertia",velocity:r?t[c]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(c,m)});return Promise.all(u).then(o)}startAxisValueAnimation(t,i){const r=this.getAxisMotionValue(t);return e3(this.visualElement,t),r.start(E4(t,r,0,i,this.visualElement,!1))}stopAnimation(){Eu(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Eu(t=>{var i;return(i=this.getAxisMotionValue(t).animation)===null||i===void 0?void 0:i.pause()})}getAnimationState(t){var i;return(i=this.getAxisMotionValue(t).animation)===null||i===void 0?void 0:i.state}getAxisMotionValue(t){const i=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),n=r[i];return n||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Eu(i=>{const{drag:r}=this.getProps();if(!pE(i,r,this.currentDirection))return;const{projection:n}=this.visualElement,s=this.getAxisMotionValue(i);if(n&&n.layout){const{min:a,max:o}=n.layout.layoutBox[i];s.set(t[i]-zn(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:r}=this.visualElement;if(!B0(i)||!r||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Eu(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();n[a]=q0e({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Eu(a=>{if(!pE(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(zn(l,u,n[a]))})}addListeners(){if(!this.visualElement.current)return;J0e.set(this.visualElement,this);const t=this.visualElement.current,i=ub(t,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();B0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,s=n.addEventListener("measure",r);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Ur.read(r);const a=r_(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Eu(c=>{const h=this.getAxisMotionValue(c);h&&(this.originPoint[c]+=l[c].translate,h.set(h.get()+l[c].translate))}),this.visualElement.render())});return()=>{a(),i(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:r=!1,dragPropagation:n=!1,dragConstraints:s=!1,dragElastic:a=l3,dragMomentum:o=!0}=t;return{...t,drag:i,dragDirectionLock:r,dragPropagation:n,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function pE(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function tye(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class iye extends im{constructor(t){super(t),this.removeGroupControls=Yo,this.removeListeners=Yo,this.controls=new eye(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Yo}unmount(){this.removeGroupControls(),this.removeListeners()}}const tj=e=>(t,i)=>{e&&Ur.postRender(()=>e(t,i))};class rye extends im{constructor(){super(...arguments),this.removePointerDownListener=Yo}onPointerDown(t){this.session=new B$(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:G$(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:r,onPanEnd:n}=this.node.getProps();return{onSessionStart:tj(t),onStart:tj(i),onMove:r,onEnd:(s,a)=>{delete this.session,n&&Ur.postRender(()=>n(s,a))}}}mount(){this.removePointerDownListener=ub(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const pT={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ij(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const H1={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ri.test(e))e=parseFloat(e);else return e;const i=ij(e,t.target.x),r=ij(e,t.target.y);return`${i}% ${r}%`}},nye={correct:(e,{treeScale:t,projectionDelta:i})=>{const r=e,n=qp.parse(e);if(n.length>5)return r;const s=qp.createTransformer(e),a=typeof n[0]!="number"?1:0,o=i.x.scale*t.x,l=i.y.scale*t.y;n[0+a]/=o,n[1+a]/=l;const u=zn(o,l,.5);return typeof n[2+a]=="number"&&(n[2+a]/=u),typeof n[3+a]=="number"&&(n[3+a]/=u),s(n)}};class sye extends de.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:r,layoutId:n}=this.props,{projection:s}=t;Dge(aye),s&&(i.group&&i.group.add(s),r&&r.register&&n&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),pT.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:r,drag:n,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,n||t.layoutDependency!==i||i===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||Ur.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Kk.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:r}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(n),r&&r.deregister&&r.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function q$(e){const[t,i]=AK(),r=de.useContext(Hk);return j.jsx(sye,{...e,layoutGroup:r,switchLayoutGroup:de.useContext(LK),isPresent:t,safeToRemove:i})}const aye={borderRadius:{...H1,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:H1,borderTopRightRadius:H1,borderBottomLeftRadius:H1,borderBottomRightRadius:H1,boxShadow:nye};function oye(e,t,i){const r=_a(e)?e:xh(e);return r.start(E4("",r,t,i)),r.animation}function lye(e){return e instanceof SVGElement&&e.tagName!=="svg"}const uye=(e,t)=>e.depth-t.depth;class cye{constructor(){this.children=[],this.isDirty=!1}add(t){c4(this.children,t),this.isDirty=!0}remove(t){h4(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(uye),this.isDirty=!1,this.children.forEach(t)}}function hye(e,t){const i=Mh.now(),r=({timestamp:n})=>{const s=n-i;s>=t&&(Tc(r),e(s-t))};return Ur.read(r,!0),()=>Tc(r)}const Y$=["TopLeft","TopRight","BottomLeft","BottomRight"],dye=Y$.length,rj=e=>typeof e=="string"?parseFloat(e):e,nj=e=>typeof e=="number"||Ri.test(e);function fye(e,t,i,r,n,s){n?(e.opacity=zn(0,i.opacity!==void 0?i.opacity:1,pye(r)),e.opacityExit=zn(t.opacity!==void 0?t.opacity:1,0,mye(r))):s&&(e.opacity=zn(t.opacity!==void 0?t.opacity:1,i.opacity!==void 0?i.opacity:1,r));for(let a=0;a<dye;a++){const o=`border${Y$[a]}Radius`;let l=sj(t,o),u=sj(i,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||nj(l)===nj(u)?(e[o]=Math.max(zn(rj(l),rj(u),r),0),(Ah.test(u)||Ah.test(l))&&(e[o]+="%")):e[o]=u}(t.rotate||i.rotate)&&(e.rotate=zn(t.rotate||0,i.rotate||0,r))}function sj(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const pye=X$(0,.5,c$),mye=X$(.5,.95,Yo);function X$(e,t,i){return r=>r<e?0:r>t?1:i(Hg(e,t,r))}function aj(e,t){e.min=t.min,e.max=t.max}function gu(e,t){aj(e.x,t.x),aj(e.y,t.y)}function oj(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function lj(e,t,i,r,n){return e-=t,e=gC(e,1/i,r),n!==void 0&&(e=gC(e,1/n,r)),e}function gye(e,t=0,i=1,r=.5,n,s=e,a=e){if(Ah.test(t)&&(t=parseFloat(t),t=zn(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=zn(s.min,s.max,r);e===s&&(o-=t),e.min=lj(e.min,t,i,o,n),e.max=lj(e.max,t,i,o,n)}function uj(e,t,[i,r,n],s,a){gye(e,t[i],t[r],t[n],t.scale,s,a)}const vye=["x","scaleX","originX"],yye=["y","scaleY","originY"];function cj(e,t,i,r){uj(e.x,t,vye,i?i.x:void 0,r?r.x:void 0),uj(e.y,t,yye,i?i.y:void 0,r?r.y:void 0)}function hj(e){return e.translate===0&&e.scale===1}function K$(e){return hj(e.x)&&hj(e.y)}function dj(e,t){return e.min===t.min&&e.max===t.max}function xye(e,t){return dj(e.x,t.x)&&dj(e.y,t.y)}function fj(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function $$(e,t){return fj(e.x,t.x)&&fj(e.y,t.y)}function pj(e){return ru(e.x)/ru(e.y)}function mj(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class bye{constructor(){this.members=[]}add(t){c4(this.members,t),t.scheduleRender()}remove(t){if(h4(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(n=>t===n);if(i===0)return!1;let r;for(let n=i;n>=0;n--){const s=this.members[n];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(t,i){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,i&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:r}=t;i.onExitComplete&&i.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function _ye(e,t,i){let r="";const n=e.x.translate/t.x,s=e.y.translate/t.y,a=(i==null?void 0:i.z)||0;if((n||s||a)&&(r=`translate3d(${n}px, ${s}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),i){const{transformPerspective:u,rotate:c,rotateX:h,rotateY:d,skewX:f,skewY:m}=i;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),h&&(r+=`rotateX(${h}deg) `),d&&(r+=`rotateY(${d}deg) `),f&&(r+=`skewX(${f}deg) `),m&&(r+=`skewY(${m}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const eg={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Nx=typeof window<"u"&&window.MotionDebug!==void 0,QP=["","X","Y","Z"],wye={visibility:"hidden"},gj=1e3;let Eye=0;function JP(e,t,i,r){const{latestValues:n}=t;n[e]&&(i[e]=n[e],t.setStaticValue(e,0),r&&(r[e]=0))}function Z$(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const i=r$(t);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:n,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(i,"transform",Ur,!(n||s))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&Z$(r)}function Q$({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:r,resetTransform:n}){return class{constructor(a={},o=t==null?void 0:t()){this.id=Eye++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Nx&&(eg.totalNodes=eg.resolvedTargetDeltas=eg.recalculatedProjection=0),this.nodes.forEach(Cye),this.nodes.forEach(Iye),this.nodes.forEach(Oye),this.nodes.forEach(Aye),Nx&&window.MotionDebug.record(eg)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new cye)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new d4),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=lye(a),this.instance=a;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),e){let h;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=hye(d,250),pT.hasAnimatedSinceResize&&(pT.hasAnimatedSinceResize=!1,this.nodes.forEach(yj))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||c.getDefaultTransition()||Bye,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=c.getProps(),w=!this.targetLayout||!$$(this.targetLayout,m)||f,b=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,b);const C={...s4(g,"layout"),onPlay:y,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else d||yj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Tc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Rye),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Z$(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const h=this.path[c];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(vj);return}this.isUpdating||this.nodes.forEach(Pye),this.isUpdating=!1,this.nodes.forEach(Dye),this.nodes.forEach(Sye),this.nodes.forEach(Tye),this.clearAllSnapshots();const o=Mh.now();qs.delta=Rh(0,1e3/60,o-qs.timestamp),qs.timestamp=o,qs.isProcessing=!0,WP.update.process(qs),WP.preRender.process(qs),WP.render.process(qs),qs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Kk.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Mye),this.sharedNodes.forEach(Lye)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ur.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ur.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ds(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!n)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!K$(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;a&&(o||Jm(this.latestValues)||c)&&(n(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),zye(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return ds();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Fye))){const{scroll:c}=this.root;c&&(U0(l.x,c.offset.x),U0(l.y,c.offset.y))}return l}removeElementScroll(a){var o;const l=ds();if(gu(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:h,options:d}=c;c!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&gu(l,a),U0(l.x,h.offset.x),U0(l.y,h.offset.y))}return l}applyTransform(a,o=!1){const l=ds();gu(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];!o&&c.options.layoutScroll&&c.scroll&&c!==c.root&&j0(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Jm(c.latestValues)&&j0(l,c.latestValues)}return Jm(this.latestValues)&&j0(l,this.latestValues),l}removeTransform(a){const o=ds();gu(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Jm(u.latestValues))continue;u3(u.latestValues)&&u.updateSnapshot();const c=ds(),h=u.measurePageBox();gu(c,h),cj(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return Jm(this.latestValues)&&cj(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=qs.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ds(),this.relativeTargetOrigin=ds(),hb(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),gu(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ds(),this.targetWithTransforms=ds()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),V0e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gu(this.target,this.layout.layoutBox),H$(this.target,this.targetDelta)):gu(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ds(),this.relativeTargetOrigin=ds(),hb(this.relativeTargetOrigin,this.target,f.target),gu(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Nx&&eg.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||u3(this.parent.latestValues)||V$(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===qs.timestamp&&(u=!1),u)return;const{layout:c,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||h))return;gu(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;Z0e(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ds());const{target:m}=o;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(oj(this.prevProjectionDelta.x,this.projectionDelta.x),oj(this.prevProjectionDelta.y,this.projectionDelta.y)),cb(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!mj(this.projectionDelta.x,this.prevProjectionDelta.x)||!mj(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m)),Nx&&eg.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=F0(),this.projectionDelta=F0(),this.projectionDeltaWithTransform=F0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},h=F0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=ds(),f=l?l.source:void 0,m=this.layout?this.layout.source:void 0,g=f!==m,y=this.getStack(),x=!y||y.members.length<=1,w=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(kye));this.animationProgress=0;let b;this.mixTargetDelta=C=>{const A=C/1e3;xj(h.x,a.x,A),xj(h.y,a.y,A),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(hb(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Nye(this.relativeTarget,this.relativeTargetOrigin,d,A),b&&xye(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=ds()),gu(b,this.relativeTarget)),g&&(this.animationValues=c,fye(c,u,this.latestValues,A,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Tc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ur.update(()=>{pT.hasAnimatedSinceResize=!0,this.currentAnimation=oye(0,gj,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gj),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:c}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&J$(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||ds();const h=ru(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const d=ru(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+d}gu(o,l),j0(o,c),cb(this.projectionDeltaWithTransform,this.layoutCorrected,o,c)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new bye),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&JP("z",a,u,this.animationValues);for(let c=0;c<QP.length;c++)JP(`rotate${QP[c]}`,a,u,this.animationValues),JP(`skew${QP[c]}`,a,u,this.animationValues);a.render();for(const c in u)a.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return wye;const u={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=dT(a==null?void 0:a.pointerEvents)||"",u.transform=c?c(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=dT(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Jm(this.latestValues)&&(g.transform=c?c({},""):"none",this.hasProjected=!1),g}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=_ye(this.projectionDeltaWithTransform,this.treeScale,d),c&&(u.transform=c(d,u.transform));const{x:f,y:m}=this.projectionDelta;u.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,h.animationValues?u.opacity=h===this?(l=(o=d.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:u.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in hC){if(d[g]===void 0)continue;const{correct:y,applyTo:x}=hC[g],w=u.transform==="none"?d[g]:y(d[g],h);if(x){const b=x.length;for(let C=0;C<b;C++)u[x[C]]=w}else u[g]=w}return this.options.layoutId&&(u.pointerEvents=h===this?dT(a==null?void 0:a.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(vj),this.root.sharedNodes.clear()}}}function Sye(e){e.updateLayout()}function Tye(e){var t;const i=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=i.source!==e.layout.source;s==="size"?Eu(h=>{const d=a?i.measuredBox[h]:i.layoutBox[h],f=ru(d);d.min=r[h].min,d.max=d.min+f}):J$(s,i.layoutBox,r)&&Eu(h=>{const d=a?i.measuredBox[h]:i.layoutBox[h],f=ru(r[h]);d.max=d.min+f,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+f)});const o=F0();cb(o,r,i.layoutBox);const l=F0();a?cb(l,e.applyTransform(n,!0),i.measuredBox):cb(l,r,i.layoutBox);const u=!K$(o);let c=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const m=ds();hb(m,i.layoutBox,d.layoutBox);const g=ds();hb(g,r,f.layoutBox),$$(m,g)||(c=!0),h.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=m,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:i,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function Cye(e){Nx&&eg.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Aye(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Mye(e){e.clearSnapshot()}function vj(e){e.clearMeasurements()}function Pye(e){e.isLayoutDirty=!1}function Dye(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function yj(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Iye(e){e.resolveTargetDelta()}function Oye(e){e.calcProjection()}function Rye(e){e.resetSkewAndRotation()}function Lye(e){e.removeLeadSnapshot()}function xj(e,t,i){e.translate=zn(t.translate,0,i),e.scale=zn(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function bj(e,t,i,r){e.min=zn(t.min,i.min,r),e.max=zn(t.max,i.max,r)}function Nye(e,t,i,r){bj(e.x,t.x,i.x,r),bj(e.y,t.y,i.y,r)}function kye(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Bye={duration:.45,ease:[.4,0,.1,1]},_j=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),wj=_j("applewebkit/")&&!_j("chrome/")?Math.round:Yo;function Ej(e){e.min=wj(e.min),e.max=wj(e.max)}function zye(e){Ej(e.x),Ej(e.y)}function J$(e,t,i){return e==="position"||e==="preserve-aspect"&&!j0e(pj(t),pj(i),.2)}function Fye(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const Uye=Q$({attachResizeListener:(e,t)=>r_(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),eD={current:void 0},eZ=Q$({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!eD.current){const e=new Uye({});e.mount(window),e.setOptions({layoutScroll:!0}),eD.current=e}return eD.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),jye={pan:{Feature:rye},drag:{Feature:iye,ProjectionNode:eZ,MeasureLayout:q$}};function Sj(e,t,i){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",i==="Start");const n="onHover"+i,s=r[n];s&&Ur.postRender(()=>s(t,V_(t)))}class Vye extends im{mount(){const{current:t}=this.node;t&&(this.unmount=Wge(t,i=>(Sj(this.node,i,"Start"),r=>Sj(this.node,r,"End"))))}unmount(){}}class Hye extends im{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=j_(r_(this.node.current,"focus",()=>this.onFocus()),r_(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Tj(e,t,i){const{props:r}=e;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",i==="Start");const n="onTap"+(i==="End"?"":i),s=r[n];s&&Ur.postRender(()=>s(t,V_(t)))}class Wye extends im{mount(){const{current:t}=this.node;t&&(this.unmount=Xge(t,i=>(Tj(this.node,i,"Start"),(r,{success:n})=>Tj(this.node,r,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const h3=new WeakMap,tD=new WeakMap,Gye=e=>{const t=h3.get(e.target);t&&t(e)},qye=e=>{e.forEach(Gye)};function Yye({root:e,...t}){const i=e||document;tD.has(i)||tD.set(i,{});const r=tD.get(i),n=JSON.stringify(t);return r[n]||(r[n]=new IntersectionObserver(qye,{root:e,...t})),r[n]}function Xye(e,t,i){const r=Yye(t);return h3.set(e,i),r.observe(e),()=>{h3.delete(e),r.unobserve(e)}}const Kye={some:0,all:1};class $ye extends im{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:r,amount:n="some",once:s}=t,a={root:i?i.current:void 0,rootMargin:r,threshold:typeof n=="number"?n:Kye[n]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:h}=this.node.getProps(),d=u?c:h;d&&d(l)};return Xye(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(Zye(t,i))&&this.startObserver()}unmount(){}}function Zye({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const Qye={inView:{Feature:$ye},tap:{Feature:Wye},focus:{Feature:Hye},hover:{Feature:Vye}},Jye={layout:{ProjectionNode:eZ,MeasureLayout:q$}},d3={current:null},tZ={current:!1};function e1e(){if(tZ.current=!0,!!Wk)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>d3.current=e.matches;e.addListener(t),t()}else d3.current=!1}const t1e=[...S$,uo,qp],i1e=e=>t1e.find(E$(e)),Cj=new WeakMap;function r1e(e,t,i){for(const r in t){const n=t[r],s=i[r];if(_a(n))e.addValue(r,n);else if(_a(s))e.addValue(r,xh(n,{owner:e}));else if(s!==n)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(n):a.hasAnimated||a.set(n)}else{const a=e.getStaticValue(r);e.addValue(r,xh(a!==void 0?a:n,{owner:e}))}}for(const r in i)t[r]===void 0&&e.removeValue(r);return t}const Aj=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class n1e{scrapeMotionValuesFromProps(t,i,r){return{}}constructor({parent:t,props:i,presenceContext:r,reducedMotionConfig:n,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=b4,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Mh.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Ur.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:c}=a;this.onUpdate=c,this.latestValues=l,this.baseTarget={...l},this.initialValues=i.initial?{...l}:{},this.renderState=u,this.parent=t,this.props=i,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=oM(i),this.isVariantNode=OK(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:h,...d}=this.scrapeMotionValuesFromProps(i,{},this);for(const f in d){const m=d[f];l[f]!==void 0&&_a(m)&&m.set(l[f],!1)}}mount(t){this.current=t,Cj.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,r)=>this.bindToMotionValue(r,i)),tZ.current||e1e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:d3.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Cj.delete(this.current),this.projection&&this.projection.unmount(),Tc(this.notifyUpdate),Tc(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const i=this.features[t];i&&(i.unmount(),i.isMounted=!1)}this.current=null}bindToMotionValue(t,i){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=sv.has(t),n=i.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Ur.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=i.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,i)),this.valueSubscriptions.set(t,()=>{n(),s(),a&&a(),i.owner&&i.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Cy){const i=Cy[t];if(!i)continue;const{isEnabled:r,Feature:n}=i;if(!this.features[t]&&n&&r(this.props)&&(this.features[t]=new n(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ds()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let r=0;r<Aj.length;r++){const n=Aj[r];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const s="on"+n,a=t[s];a&&(this.propEventSubscriptions[n]=this.on(n,a))}this.prevMotionValues=r1e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){const r=this.values.get(t);i!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,i),this.values.set(t,i),this.latestValues[t]=i.get())}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&i!==void 0&&(r=xh(i===null?void 0:i,{owner:this}),this.addValue(t,r)),r}readValue(t,i){var r;let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(_$(n)||d$(n))?n=parseFloat(n):!i1e(n)&&qp.test(i)&&(n=y$(t,i)),this.setBaseTarget(t,_a(n)?n.get():n)),_a(n)?n.get():n}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){var i;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=Zk(this.props,r,(i=this.presenceContext)===null||i===void 0?void 0:i.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!_a(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new d4),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}}class iZ extends n1e{constructor(){super(...arguments),this.KeyframeResolver=T$}sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:r}){delete i[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;_a(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function s1e(e){return window.getComputedStyle(e)}class a1e extends iZ{constructor(){super(...arguments),this.type="html",this.renderInstance=jK}readValueFromInstance(t,i){if(sv.has(i)){const r=x4(i);return r&&r.default||0}else{const r=s1e(t),n=(zK(i)?r.getPropertyValue(i):r[i])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:i}){return W$(t,i)}build(t,i,r){e4(t,i,r.transformTemplate)}scrapeMotionValuesFromProps(t,i,r){return n4(t,i,r)}}class o1e extends iZ{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ds}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(sv.has(i)){const r=x4(i);return r&&r.default||0}return i=VK.has(i)?i:Xk(i),t.getAttribute(i)}scrapeMotionValuesFromProps(t,i,r){return GK(t,i,r)}build(t,i,r){t4(t,i,this.isSVGTag,r.transformTemplate)}renderInstance(t,i,r,n){HK(t,i,r,n)}mount(t){this.isSVGTag=r4(t.tagName),super.mount(t)}}const l1e=(e,t)=>$k(e)?new o1e(t):new a1e(t,{allowProjection:e!==de.Fragment}),u1e=Fge({...O0e,...Qye,...jye,...Jye},l1e),Ui=ege(u1e);function rZ(e,t){let i;const r=()=>{const{currentTime:n}=t,a=(n===null?0:n.value)/100;i!==a&&e(a),i=a};return Ur.update(r,!0),()=>Tc(r)}const mT=new WeakMap;let tp;function c1e(e,t){if(t){const{inlineSize:i,blockSize:r}=t[0];return{width:i,height:r}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function h1e({target:e,contentRect:t,borderBoxSize:i}){var r;(r=mT.get(e))===null||r===void 0||r.forEach(n=>{n({target:e,contentSize:t,get size(){return c1e(e,i)}})})}function d1e(e){e.forEach(h1e)}function f1e(){typeof ResizeObserver>"u"||(tp=new ResizeObserver(d1e))}function p1e(e,t){tp||f1e();const i=l4(e);return i.forEach(r=>{let n=mT.get(r);n||(n=new Set,mT.set(r,n)),n.add(t),tp==null||tp.observe(r)}),()=>{i.forEach(r=>{const n=mT.get(r);n==null||n.delete(t),n!=null&&n.size||tp==null||tp.unobserve(r)})}}const gT=new Set;let db;function m1e(){db=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};gT.forEach(i=>i(t))},window.addEventListener("resize",db)}function g1e(e){return gT.add(e),db||m1e(),()=>{gT.delete(e),!gT.size&&db&&(db=void 0)}}function v1e(e,t){return typeof e=="function"?g1e(e):p1e(e,t)}const y1e=50,Mj=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),x1e=()=>({time:0,x:Mj(),y:Mj()}),b1e={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Pj(e,t,i,r){const n=i[t],{length:s,position:a}=b1e[t],o=n.current,l=i.time;n.current=e[`scroll${a}`],n.scrollLength=e[`scroll${s}`]-e[`client${s}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=Hg(0,n.scrollLength,n.current);const u=r-l;n.velocity=u>y1e?0:f4(n.current-o,u)}function _1e(e,t,i){Pj(e,"x",t,i),Pj(e,"y",t,i),t.time=i}function w1e(e,t){const i={x:0,y:0};let r=e;for(;r&&r!==t;)if(r instanceof HTMLElement)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const n=r.getBoundingClientRect();r=r.parentElement;const s=r.getBoundingClientRect();i.x+=n.left-s.left,i.y+=n.top-s.top}else if(r instanceof SVGGraphicsElement){const{x:n,y:s}=r.getBBox();i.x+=n,i.y+=s;let a=null,o=r.parentNode;for(;!a;)o.tagName==="svg"&&(a=o),o=r.parentNode;r=a}else break;return i}const f3={start:0,center:.5,end:1};function Dj(e,t,i=0){let r=0;if(e in f3&&(e=f3[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?r=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?r=n/100*document.documentElement.clientWidth:e.endsWith("vh")?r=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(r=t*e),i+r}const E1e=[0,0];function S1e(e,t,i,r){let n=Array.isArray(e)?e:E1e,s=0,a=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,f3[e]?e:"0"]),s=Dj(n[0],i,r),a=Dj(n[1],t),s-a}const T1e={All:[[0,0],[1,1]]},C1e={x:0,y:0};function A1e(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function M1e(e,t,i){const{offset:r=T1e.All}=i,{target:n=e,axis:s="y"}=i,a=s==="y"?"height":"width",o=n!==e?w1e(n,e):C1e,l=n===e?{width:e.scrollWidth,height:e.scrollHeight}:A1e(n),u={width:e.clientWidth,height:e.clientHeight};t[s].offset.length=0;let c=!t[s].interpolate;const h=r.length;for(let d=0;d<h;d++){const f=S1e(r[d],u[a],l[a],o[s]);!c&&f!==t[s].interpolatorOffsets[d]&&(c=!0),t[s].offset[d]=f}c&&(t[s].interpolate=w4(t[s].offset,O$(r),{clamp:!1}),t[s].interpolatorOffsets=[...t[s].offset]),t[s].progress=Rh(0,1,t[s].interpolate(t[s].current))}function P1e(e,t=e,i){if(i.x.targetOffset=0,i.y.targetOffset=0,t!==e){let r=t;for(;r&&r!==e;)i.x.targetOffset+=r.offsetLeft,i.y.targetOffset+=r.offsetTop,r=r.offsetParent}i.x.targetLength=t===e?t.scrollWidth:t.clientWidth,i.y.targetLength=t===e?t.scrollHeight:t.clientHeight,i.x.containerLength=e.clientWidth,i.y.containerLength=e.clientHeight}function D1e(e,t,i,r={}){return{measure:()=>P1e(e,r.target,i),update:n=>{_1e(e,i,n),(r.offset||r.target)&&M1e(e,i,r)},notify:()=>t(i)}}const W1=new WeakMap,Ij=new WeakMap,iD=new WeakMap,Oj=e=>e===document.documentElement?window:e;function S4(e,{container:t=document.documentElement,...i}={}){let r=iD.get(t);r||(r=new Set,iD.set(t,r));const n=x1e(),s=D1e(t,e,n,i);if(r.add(s),!W1.has(t)){const o=()=>{for(const d of r)d.measure()},l=()=>{for(const d of r)d.update(qs.timestamp)},u=()=>{for(const d of r)d.notify()},c=()=>{Ur.read(o,!1,!0),Ur.read(l,!1,!0),Ur.update(u,!1,!0)};W1.set(t,c);const h=Oj(t);window.addEventListener("resize",c,{passive:!0}),t!==document.documentElement&&Ij.set(t,v1e(t,c)),h.addEventListener("scroll",c,{passive:!0})}const a=W1.get(t);return Ur.read(a,!1,!0),()=>{var o;Tc(a);const l=iD.get(t);if(!l||(l.delete(s),l.size))return;const u=W1.get(t);W1.delete(t),u&&(Oj(t).removeEventListener("scroll",u),(o=Ij.get(t))===null||o===void 0||o(),window.removeEventListener("resize",u))}}function I1e({source:e,container:t,axis:i="y"}){e&&(t=e);const r={value:0},n=S4(s=>{r.value=s[i].progress*100},{container:t,axis:i});return{currentTime:r,cancel:n}}const rD=new Map;function nZ({source:e,container:t=document.documentElement,axis:i="y"}={}){e&&(t=e),rD.has(t)||rD.set(t,{});const r=rD.get(t);return r[i]||(r[i]=XK()?new ScrollTimeline({source:t,axis:i}):I1e({source:t,axis:i})),r[i]}function O1e(e){return e.length===2}function sZ(e){return e&&(e.target||e.offset)}function R1e(e,t){return O1e(e)||sZ(t)?S4(i=>{e(i[t.axis].progress,i)},t):rZ(e,nZ(t))}function L1e(e,t){if(e.flatten(),sZ(t))return e.pause(),S4(i=>{e.time=e.duration*i[t.axis].progress},t);{const i=nZ(t);return e.attachTimeline?e.attachTimeline(i,r=>(r.pause(),rZ(n=>{r.time=r.duration*n},i))):Yo}}function N1e(e,{axis:t="y",...i}={}){const r={axis:t,...i};return typeof e=="function"?R1e(e,r):L1e(e,r)}function Rj(e,t){qme(!!(!t||t.current))}const k1e=()=>({scrollX:xh(0),scrollY:xh(0),scrollXProgress:xh(0),scrollYProgress:xh(0)});function B1e({container:e,target:t,layoutEffect:i=!0,...r}={}){const n=nv(k1e);return(i?Qy:de.useEffect)(()=>(Rj("target",t),Rj("container",e),N1e((a,{x:o,y:l})=>{n.scrollX.set(o.current),n.scrollXProgress.set(o.progress),n.scrollY.set(l.current),n.scrollYProgress.set(l.progress)},{...r,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(r.offset)]),n}function aZ(e){const t=nv(()=>xh(e)),{isStatic:i}=de.useContext(z_);if(i){const[,r]=de.useState(e);de.useEffect(()=>t.on("change",r),[])}return t}function oZ(e,t){const i=aZ(t()),r=()=>i.set(t());return r(),Qy(()=>{const n=()=>Ur.preRender(r,!1,!0),s=e.map(a=>a.on("change",n));return()=>{s.forEach(a=>a()),Tc(r)}}),i}function Lj(e){return typeof e=="number"?e:parseFloat(e)}function Nj(e,t={}){const{isStatic:i}=de.useContext(z_),r=de.useRef(null),n=aZ(_a(e)?Lj(e.get()):e),s=de.useRef(n.get()),a=de.useRef(()=>{}),o=()=>{const u=r.current;u&&u.time===0&&u.sample(qs.delta),l(),r.current=a0e({keyframes:[n.get(),s.current],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:a.current})},l=()=>{r.current&&r.current.stop()};return de.useInsertionEffect(()=>n.attach((u,c)=>i?c(u):(s.current=u,a.current=c,Ur.update(o),n.get()),l),[JSON.stringify(t)]),Qy(()=>{if(_a(e))return e.on("change",u=>n.set(Lj(u)))},[n]),n}const z1e=e=>e&&typeof e=="object"&&e.mix,F1e=e=>z1e(e)?e.mix:void 0;function U1e(...e){const t=!Array.isArray(e[0]),i=t?0:-1,r=e[0+i],n=e[1+i],s=e[2+i],a=e[3+i],o=w4(n,s,{mixer:F1e(s[0]),...a});return t?o(r):o}function j1e(e){ob.current=[],e();const t=oZ(ob.current,e);return ob.current=void 0,t}function p3(e,t,i,r){if(typeof e=="function")return j1e(e);const n=typeof t=="function"?t:U1e(t,i,r);return Array.isArray(e)?kj(e,n):kj([e],([s])=>n(s))}function kj(e,t){const i=nv(()=>[]);return oZ(e,()=>{i.length=0;const r=e.length;for(let n=0;n<r;n++)i[n]=e[n].get();return t(i)})}function V1e(e){e.values.forEach(t=>t.stop())}function m3(e,t){[...t].reverse().forEach(r=>{const n=e.getVariant(r);n&&p4(e,n),e.variantChildren&&e.variantChildren.forEach(s=>{m3(s,t)})})}function H1e(e,t){if(Array.isArray(t))return m3(e,t);if(typeof t=="string")return m3(e,[t]);p4(e,t)}function W1e(){const e=new Set,t={subscribe(i){return e.add(i),()=>void e.delete(i)},start(i,r){const n=[];return e.forEach(s=>{n.push(N$(s,i,{transitionOverride:r}))}),Promise.all(n)},set(i){return e.forEach(r=>{H1e(r,i)})},stop(){e.forEach(i=>{V1e(i)})},mount(){return()=>{t.stop()}}};return t}function G1e(){const e=nv(W1e);return Qy(e.mount,[]),e}const q1e=G1e,Y1e={some:0,all:1};function X1e(e,t,{root:i,margin:r,amount:n="some"}={}){const s=l4(e),a=new WeakMap,o=u=>{u.forEach(c=>{const h=a.get(c.target);if(c.isIntersecting!==!!h)if(c.isIntersecting){const d=t(c);typeof d=="function"?a.set(c.target,d):l.unobserve(c.target)}else typeof h=="function"&&(h(c),a.delete(c.target))})},l=new IntersectionObserver(o,{root:i,rootMargin:r,threshold:typeof n=="number"?n:Y1e[n]});return s.forEach(u=>l.observe(u)),()=>l.disconnect()}function Bj(e,{root:t,margin:i,amount:r,once:n=!1}={}){const[s,a]=de.useState(!1);return de.useEffect(()=>{if(!e.current||n&&s)return;const o=()=>(a(!0),n?void 0:()=>a(!1)),l={root:t&&t.current||void 0,margin:i,amount:r};return X1e(e.current,o,l)},[t,e,i,n,r]),s}function lZ(e){var t,i,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(i=lZ(e[t]))&&(r&&(r+=" "),r+=i)}else for(i in e)e[i]&&(r&&(r+=" "),r+=i);return r}function uZ(){for(var e,t,i=0,r="",n=arguments.length;i<n;i++)(e=arguments[i])&&(t=lZ(e))&&(r&&(r+=" "),r+=t);return r}const T4="-",K1e=e=>{const t=Z1e(e),{conflictingClassGroups:i,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(T4);return o[0]===""&&o.length!==1&&o.shift(),cZ(o,t)||$1e(a)},getConflictingClassGroupIds:(a,o)=>{const l=i[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},cZ=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const i=e[0],r=t.nextPart.get(i),n=r?cZ(e.slice(1),r):void 0;if(n)return n;if(t.validators.length===0)return;const s=e.join(T4);return(a=t.validators.find(({validator:o})=>o(s)))==null?void 0:a.classGroupId},zj=/^\[(.+)\]$/,$1e=e=>{if(zj.test(e)){const t=zj.exec(e)[1],i=t==null?void 0:t.substring(0,t.indexOf(":"));if(i)return"arbitrary.."+i}},Z1e=e=>{const{theme:t,prefix:i}=e,r={nextPart:new Map,validators:[]};return J1e(Object.entries(e.classGroups),i).forEach(([s,a])=>{g3(a,r,s,t)}),r},g3=(e,t,i,r)=>{e.forEach(n=>{if(typeof n=="string"){const s=n===""?t:Fj(t,n);s.classGroupId=i;return}if(typeof n=="function"){if(Q1e(n)){g3(n(r),t,i,r);return}t.validators.push({validator:n,classGroupId:i});return}Object.entries(n).forEach(([s,a])=>{g3(a,Fj(t,s),i,r)})})},Fj=(e,t)=>{let i=e;return t.split(T4).forEach(r=>{i.nextPart.has(r)||i.nextPart.set(r,{nextPart:new Map,validators:[]}),i=i.nextPart.get(r)}),i},Q1e=e=>e.isThemeGetter,J1e=(e,t)=>t?e.map(([i,r])=>{const n=r.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,o])=>[t+a,o])):s);return[i,n]}):e,exe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,i=new Map,r=new Map;const n=(s,a)=>{i.set(s,a),t++,t>e&&(t=0,r=i,i=new Map)};return{get(s){let a=i.get(s);if(a!==void 0)return a;if((a=r.get(s))!==void 0)return n(s,a),a},set(s,a){i.has(s)?i.set(s,a):n(s,a)}}},hZ="!",txe=e=>{const{separator:t,experimentalParseClassName:i}=e,r=t.length===1,n=t[0],s=t.length,a=o=>{const l=[];let u=0,c=0,h;for(let y=0;y<o.length;y++){let x=o[y];if(u===0){if(x===n&&(r||o.slice(y,y+s)===t)){l.push(o.slice(c,y)),c=y+s;continue}if(x==="/"){h=y;continue}}x==="["?u++:x==="]"&&u--}const d=l.length===0?o:o.substring(c),f=d.startsWith(hZ),m=f?d.substring(1):d,g=h&&h>c?h-c:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:g}};return i?o=>i({className:o,parseClassName:a}):a},ixe=e=>{if(e.length<=1)return e;const t=[];let i=[];return e.forEach(r=>{r[0]==="["?(t.push(...i.sort(),r),i=[]):i.push(r)}),t.push(...i.sort()),t},rxe=e=>({cache:exe(e.cacheSize),parseClassName:txe(e),...K1e(e)}),nxe=/\s+/,sxe=(e,t)=>{const{parseClassName:i,getClassGroupId:r,getConflictingClassGroupIds:n}=t,s=[],a=e.trim().split(nxe);let o="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{modifiers:c,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}=i(u);let m=!!f,g=r(m?d.substring(0,f):d);if(!g){if(!m){o=u+(o.length>0?" "+o:o);continue}if(g=r(d),!g){o=u+(o.length>0?" "+o:o);continue}m=!1}const y=ixe(c).join(":"),x=h?y+hZ:y,w=x+g;if(s.includes(w))continue;s.push(w);const b=n(g,m);for(let C=0;C<b.length;++C){const A=b[C];s.push(x+A)}o=u+(o.length>0?" "+o:o)}return o};function axe(){let e=0,t,i,r="";for(;e<arguments.length;)(t=arguments[e++])&&(i=dZ(t))&&(r&&(r+=" "),r+=i);return r}const dZ=e=>{if(typeof e=="string")return e;let t,i="";for(let r=0;r<e.length;r++)e[r]&&(t=dZ(e[r]))&&(i&&(i+=" "),i+=t);return i};function oxe(e,...t){let i,r,n,s=a;function a(l){const u=t.reduce((c,h)=>h(c),e());return i=rxe(u),r=i.cache.get,n=i.cache.set,s=o,o(l)}function o(l){const u=r(l);if(u)return u;const c=sxe(l,i);return n(l,c),c}return function(){return s(axe.apply(null,arguments))}}const Tn=e=>{const t=i=>i[e]||[];return t.isThemeGetter=!0,t},fZ=/^\[(?:([a-z-]+):)?(.+)\]$/i,lxe=/^\d+\/\d+$/,uxe=new Set(["px","full","screen"]),cxe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,hxe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dxe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,fxe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,pxe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,pd=e=>iy(e)||uxe.has(e)||lxe.test(e),Of=e=>t1(e,"length",wxe),iy=e=>!!e&&!Number.isNaN(Number(e)),nD=e=>t1(e,"number",iy),G1=e=>!!e&&Number.isInteger(Number(e)),mxe=e=>e.endsWith("%")&&iy(e.slice(0,-1)),lr=e=>fZ.test(e),Rf=e=>cxe.test(e),gxe=new Set(["length","size","percentage"]),vxe=e=>t1(e,gxe,pZ),yxe=e=>t1(e,"position",pZ),xxe=new Set(["image","url"]),bxe=e=>t1(e,xxe,Sxe),_xe=e=>t1(e,"",Exe),q1=()=>!0,t1=(e,t,i)=>{const r=fZ.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):i(r[2]):!1},wxe=e=>hxe.test(e)&&!dxe.test(e),pZ=()=>!1,Exe=e=>fxe.test(e),Sxe=e=>pxe.test(e),Txe=()=>{const e=Tn("colors"),t=Tn("spacing"),i=Tn("blur"),r=Tn("brightness"),n=Tn("borderColor"),s=Tn("borderRadius"),a=Tn("borderSpacing"),o=Tn("borderWidth"),l=Tn("contrast"),u=Tn("grayscale"),c=Tn("hueRotate"),h=Tn("invert"),d=Tn("gap"),f=Tn("gradientColorStops"),m=Tn("gradientColorStopPositions"),g=Tn("inset"),y=Tn("margin"),x=Tn("opacity"),w=Tn("padding"),b=Tn("saturate"),C=Tn("scale"),A=Tn("sepia"),E=Tn("skew"),_=Tn("space"),P=Tn("translate"),I=()=>["auto","contain","none"],D=()=>["auto","hidden","clip","visible","scroll"],k=()=>["auto",lr,t],B=()=>[lr,t],z=()=>["",pd,Of],W=()=>["auto",iy,lr],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],J=()=>["","0",lr],U=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ie=()=>[iy,lr];return{cacheSize:500,separator:":",theme:{colors:[q1],spacing:[pd,Of],blur:["none","",Rf,lr],brightness:ie(),borderColor:[e],borderRadius:["none","","full",Rf,lr],borderSpacing:B(),borderWidth:z(),contrast:ie(),grayscale:J(),hueRotate:ie(),invert:J(),gap:B(),gradientColorStops:[e],gradientColorStopPositions:[mxe,Of],inset:k(),margin:k(),opacity:ie(),padding:B(),saturate:ie(),scale:ie(),sepia:J(),skew:ie(),space:B(),translate:B()},classGroups:{aspect:[{aspect:["auto","square","video",lr]}],container:["container"],columns:[{columns:[Rf]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),lr]}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",G1,lr]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",lr]}],grow:[{grow:J()}],shrink:[{shrink:J()}],order:[{order:["first","last","none",G1,lr]}],"grid-cols":[{"grid-cols":[q1]}],"col-start-end":[{col:["auto",{span:["full",G1,lr]},lr]}],"col-start":[{"col-start":W()}],"col-end":[{"col-end":W()}],"grid-rows":[{"grid-rows":[q1]}],"row-start-end":[{row:["auto",{span:[G1,lr]},lr]}],"row-start":[{"row-start":W()}],"row-end":[{"row-end":W()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",lr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",lr]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",lr,t]}],"min-w":[{"min-w":[lr,t,"min","max","fit"]}],"max-w":[{"max-w":[lr,t,"none","full","min","max","fit","prose",{screen:[Rf]},Rf]}],h:[{h:[lr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[lr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[lr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[lr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Rf,Of]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",nD]}],"font-family":[{font:[q1]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",lr]}],"line-clamp":[{"line-clamp":["none",iy,nD]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",pd,lr]}],"list-image":[{"list-image":["none",lr]}],"list-style-type":[{list:["none","disc","decimal",lr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",pd,Of]}],"underline-offset":[{"underline-offset":["auto",pd,lr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",lr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",lr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),yxe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",vxe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},bxe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:Z()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[pd,lr]}],"outline-w":[{outline:[pd,Of]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[pd,Of]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Rf,_xe]}],"shadow-color":[{shadow:[q1]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[i]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Rf,lr]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[i]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",lr]}],duration:[{duration:ie()}],ease:[{ease:["linear","in","out","in-out",lr]}],delay:[{delay:ie()}],animate:[{animate:["none","spin","ping","pulse","bounce",lr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[G1,lr]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",lr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",lr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",lr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[pd,Of,nD]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Cxe=oxe(Txe);function an(...e){return Cxe(uZ(e))}function Uj(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function mZ(...e){return t=>{let i=!1;const r=e.map(n=>{const s=Uj(n,t);return!i&&typeof s=="function"&&(i=!0),s});if(i)return()=>{for(let n=0;n<r.length;n++){const s=r[n];typeof s=="function"?s():Uj(e[n],null)}}}}function of(...e){return de.useCallback(mZ(...e),e)}var My=de.forwardRef((e,t)=>{const{children:i,...r}=e,n=de.Children.toArray(i),s=n.find(Mxe);if(s){const a=s.props.children,o=n.map(l=>l===s?de.Children.count(a)>1?de.Children.only(null):de.isValidElement(a)?a.props.children:null:l);return j.jsx(v3,{...r,ref:t,children:de.isValidElement(a)?de.cloneElement(a,void 0,o):null})}return j.jsx(v3,{...r,ref:t,children:i})});My.displayName="Slot";var v3=de.forwardRef((e,t)=>{const{children:i,...r}=e;if(de.isValidElement(i)){const n=Dxe(i),s=Pxe(r,i.props);return i.type!==de.Fragment&&(s.ref=t?mZ(t,n):n),de.cloneElement(i,s)}return de.Children.count(i)>1?de.Children.only(null):null});v3.displayName="SlotClone";var Axe=({children:e})=>j.jsx(j.Fragment,{children:e});function Mxe(e){return de.isValidElement(e)&&e.type===Axe}function Pxe(e,t){const i={...t};for(const r in t){const n=e[r],s=t[r];/^on[A-Z]/.test(r)?n&&s?i[r]=(...o)=>{s(...o),n(...o)}:n&&(i[r]=n):r==="style"?i[r]={...n,...s}:r==="className"&&(i[r]=[n,s].filter(Boolean).join(" "))}return{...e,...i}}function Dxe(e){var r,n;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,i=t&&"isReactWarning"in t&&t.isReactWarning;return i?e.ref:(t=(n=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:n.get,i=t&&"isReactWarning"in t&&t.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}const jj=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Vj=uZ,C4=(e,t)=>i=>{var r;if((t==null?void 0:t.variants)==null)return Vj(e,i==null?void 0:i.class,i==null?void 0:i.className);const{variants:n,defaultVariants:s}=t,a=Object.keys(n).map(u=>{const c=i==null?void 0:i[u],h=s==null?void 0:s[u];if(c===null)return null;const d=jj(c)||jj(h);return n[u][d]}),o=i&&Object.entries(i).reduce((u,c)=>{let[h,d]=c;return d===void 0||(u[h]=d),u},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((u,c)=>{let{class:h,className:d,...f}=c;return Object.entries(f).every(m=>{let[g,y]=m;return Array.isArray(y)?y.includes({...s,...o}[g]):{...s,...o}[g]===y})?[...u,h,d]:u},[]);return Vj(e,a,l,i==null?void 0:i.class,i==null?void 0:i.className)},y3=C4("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Zn=de.forwardRef(({className:e,variant:t,size:i,asChild:r=!1,...n},s)=>{const a=r?My:"button";return j.jsx(a,{className:an(y3({variant:t,size:i,className:e})),ref:s,...n})});Zn.displayName="Button";/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ixe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gZ=(...e)=>e.filter((t,i,r)=>!!t&&r.indexOf(t)===i).join(" ");/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oxe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rxe=de.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:r,className:n="",children:s,iconNode:a,...o},l)=>de.createElement("svg",{ref:l,...Oxe,width:t,height:t,stroke:e,strokeWidth:r?Number(i)*24/Number(t):i,className:gZ("lucide",n),...o},[...a.map(([u,c])=>de.createElement(u,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=(e,t)=>{const i=de.forwardRef(({className:r,...n},s)=>de.createElement(Rxe,{ref:s,iconNode:t,className:gZ(`lucide-${Ixe(e)}`,r),...n}));return i.displayName=`${e}`,i};/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lxe=ts("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nxe=ts("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kxe=ts("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bxe=ts("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zxe=ts("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vZ=ts("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fxe=ts("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uxe=ts("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hj=ts("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=ts("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jxe=ts("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yZ=ts("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=ts("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vxe=ts("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hxe=ts("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wj=ts("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wxe=ts("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gxe=ts("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gj=ts("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qxe=ts("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yxe=ts("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xxe=ts("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Kxe=({className:e=""})=>{const[t,i]=de.useState("dark"),[r,n]=de.useState(!1),[s,a]=de.useState(!1),[o,l]=de.useState(null),u=rM(),c=rv();de.useLayoutEffect(()=>{const g=localStorage.getItem("theme")||"dark";document.documentElement.classList.toggle("dark",g==="dark"),i(g)},[]);const h=[{name:"Accueil",href:"#home"},{name:"À propos",href:"#about"},{name:"Compétences",href:"#skills"},{name:"Interactif",href:"#interactive"},{name:"Projets",href:"#projects"},{name:"Blog",href:"/blog",isExternal:!0},{name:"Admin",href:"/admin",isExternal:!0},{name:"Contact",href:"#contact"}];de.useEffect(()=>{const g=()=>{n(window.scrollY>10)};return window.addEventListener("scroll",g),()=>window.removeEventListener("scroll",g)},[]),de.useEffect(()=>{const g=localStorage.getItem("userData");if(g)try{l(JSON.parse(g))}catch(y){console.error("Erreur parsing userData dans Navbar:",y),localStorage.removeItem("userData"),localStorage.removeItem("authToken")}},[c]);const d=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userData"),l(null),a(!1),u("/login")},f=()=>{const g=t==="dark"?"light":"dark";document.documentElement.classList.toggle("dark",g==="dark"),i(g),requestAnimationFrame(()=>{localStorage.setItem("theme",g)})},m=(g,y=!1)=>{if(y)u(g);else if(c.pathname!=="/"&&g.startsWith("#"))u("/"),setTimeout(()=>{const x=document.querySelector(g);x&&x.scrollIntoView({behavior:"smooth"})},100);else{const x=document.querySelector(g);x&&x.scrollIntoView({behavior:"smooth"})}a(!1)};return j.jsxs("header",{className:an("fixed top-0 w-full z-50 transition-all duration-300 bg-background",r?"border-b shadow-sm":"",e),children:[j.jsxs("div",{className:"container mx-auto px-4 h-20 flex items-center justify-between",children:[j.jsx("div",{className:"flex items-center",children:j.jsx("a",{href:"/",className:"text-xl font-bold tracking-tight hover:text-primary transition-colors",onClick:g=>{g.preventDefault(),u("/")},children:"Portfolio"})}),j.jsxs("nav",{className:"hidden md:flex items-center space-x-4",children:[" ",h.filter(g=>!(g.name==="Admin"&&(!o||!["ADMIN","SUPERADMIN"].includes(o.role)))).filter(g=>!(g.name==="Blog"&&c.pathname.startsWith("/blog"))).map(g=>j.jsx("a",{href:g.href,className:"text-sm font-medium hover:text-primary transition-colors",onClick:y=>{y.preventDefault(),m(g.href,g.isExternal)},children:g.name},g.name)),j.jsxs("div",{className:"flex items-center space-x-2 border-l pl-4 ml-2",children:[" ",o?j.jsxs(j.Fragment,{children:[j.jsxs("span",{className:"text-sm font-medium text-muted-foreground hidden lg:inline",children:["Bonjour, ",o.firstName||o.email]}),j.jsx(Zn,{variant:"ghost",size:"sm",onClick:d,children:"Déconnexion"})]}):j.jsxs(j.Fragment,{children:[j.jsx(Zn,{variant:"ghost",size:"sm",asChild:!0,children:j.jsx(Ox,{to:"/login",children:"Connexion"})}),j.jsx(Zn,{variant:"default",size:"sm",asChild:!0,children:j.jsx(Ox,{to:"/create-user",children:"S'inscrire"})})]}),j.jsx(Zn,{variant:"ghost",size:"icon",onClick:f,"aria-label":"Toggle theme",className:"ml-2",children:t==="dark"?j.jsx(Gj,{className:"h-5 w-5"}):j.jsx(Wj,{className:"h-5 w-5"})})]})]}),j.jsxs("div",{className:"flex items-center md:hidden space-x-2",children:[j.jsx(Zn,{variant:"ghost",size:"icon",onClick:f,"aria-label":"Toggle theme",children:t==="dark"?j.jsx(Gj,{className:"h-5 w-5"}):j.jsx(Wj,{className:"h-5 w-5"})}),j.jsx(Zn,{variant:"ghost",size:"icon",onClick:()=>a(!s),"aria-label":"Toggle menu",children:s?j.jsx(Xxe,{className:"h-5 w-5"}):j.jsx(Hxe,{className:"h-5 w-5"})})]})]}),s&&j.jsx("div",{className:"md:hidden bg-background border-t",children:j.jsxs("div",{className:"container mx-auto px-4 py-4 space-y-1",children:[h.filter(g=>!(g.name==="Admin"&&(!o||!["ADMIN","SUPERADMIN"].includes(o.role)))).filter(g=>!(g.name==="Blog"&&c.pathname.startsWith("/blog"))).map(g=>j.jsx("a",{href:g.href,className:"block rounded-md px-3 py-2 text-base font-medium hover:bg-accent hover:text-accent-foreground",onClick:y=>{y.preventDefault(),m(g.href,g.isExternal)},children:g.name},g.name)),j.jsx("div",{className:"border-t pt-4 mt-4 space-y-2",children:o?j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:"px-3 py-2 text-base font-medium text-muted-foreground",children:["Bonjour, ",o.firstName||o.email]}),j.jsx("button",{onClick:d,className:"block w-full text-left rounded-md px-3 py-2 text-base font-medium hover:bg-accent hover:text-accent-foreground",children:"Déconnexion"})]}):j.jsxs(j.Fragment,{children:[j.jsx(Ox,{to:"/login",onClick:()=>a(!1),className:"block rounded-md px-3 py-2 text-base font-medium hover:bg-accent hover:text-accent-foreground",children:"Connexion"}),j.jsx(Ox,{to:"/create-user",onClick:()=>a(!1),className:"block rounded-md px-3 py-2 text-base font-medium hover:bg-accent hover:text-accent-foreground",children:"S'inscrire"})]})})]})})]})},$xe=de.lazy(()=>Ll(()=>Promise.resolve().then(()=>cXe),void 0));function Zxe({scene:e,className:t,allowScroll:i=!0}){const r=de.useRef(null);return de.useEffect(()=>{if(!i||!r.current)return;const n=r.current,s=a=>{window.scrollBy({top:a.deltaY})};return n.addEventListener("wheel",s,{passive:!0}),()=>{n.removeEventListener("wheel",s)}},[i]),j.jsx("div",{ref:r,className:t,style:{touchAction:"pan-y",position:"relative",zIndex:1},children:j.jsx(de.Suspense,{fallback:j.jsx("div",{className:"w-full h-full flex items-center justify-center",children:j.jsx("span",{className:"loader"})}),children:j.jsx($xe,{scene:e,style:{pointerEvents:"auto",width:"100%",height:"100%"}})})})}function Qxe({className:e,size:t=200,springOptions:i={bounce:0}}){const r=de.useRef(null),[n,s]=de.useState(!1),[a,o]=de.useState(null),l=Nj(0,i),u=Nj(0,i),c=p3(l,f=>`${f-t/2}px`),h=p3(u,f=>`${f-t/2}px`);de.useEffect(()=>{if(r.current){const f=r.current.parentElement;f&&(f.style.position="relative",f.style.overflow="hidden",o(f))}},[]);const d=de.useCallback(f=>{if(!a)return;const{left:m,top:g}=a.getBoundingClientRect();l.set(f.clientX-m),u.set(f.clientY-g)},[l,u,a]);return de.useEffect(()=>{if(a)return a.addEventListener("mousemove",d),a.addEventListener("mouseenter",()=>s(!0)),a.addEventListener("mouseleave",()=>s(!1)),()=>{a.removeEventListener("mousemove",d),a.removeEventListener("mouseenter",()=>s(!0)),a.removeEventListener("mouseleave",()=>s(!1))}},[a,d]),j.jsx(Ui.div,{ref:r,className:an("pointer-events-none absolute rounded-full bg-[radial-gradient(circle_at_center,var(--tw-gradient-stops),transparent_80%)] blur-2xl transition-opacity duration-300","from-white/40 via-white/20 to-transparent",n?"opacity-100":"opacity-60",e),style:{width:t,height:t,left:c,top:h,mixBlendMode:"screen"}})}function sD(){const e=de.useRef(null);return de.useEffect(()=>{const t=e.current;if(!t)return;const r=window.getComputedStyle(t).color,n=t.textContent||"";t.innerHTML="";const s=n.split("").map(o=>{const l=document.createElement("span");return l.textContent=o===" "?" ":o,l.style.transition="color 0.1s ease",l.style.color=r,l});s.forEach(o=>t.appendChild(o));const a=o=>{const l=o.clientX,u=o.clientY;s.forEach(c=>{const h=c.getBoundingClientRect(),d=h.left+h.width/2,f=h.top+h.height/2;Math.sqrt(Math.pow(l-d,2)+Math.pow(u-f,2))<50?c.style.color="#000":c.style.color=r})};return window.addEventListener("mousemove",a),()=>{window.removeEventListener("mousemove",a),t.textContent=n,t.style.color=r}},[]),e}const Jxe=({name:e="Nomenahasina Andriantahiry",title:t="Full Stack Developer",description:i="Je crée des applications web modernes et performantes avec une attention particulière aux détails et à l'expérience utilisateur.",ctaText:r="Voir mes projets",onCtaClick:n=()=>console.log("CTA clicked")})=>{const s=sD(),a=sD(),o=sD();return j.jsxs("div",{className:"w-full h-screen bg-black/[0.96] overflow-hidden relative",children:[j.jsx(Qxe,{className:"-top-40 left-0 md:left-60 md:-top-20",size:800,springOptions:{stiffness:400,damping:60}}),j.jsxs("div",{className:"flex h-full relative",children:[j.jsxs("div",{className:"w-full md:flex-1 px-4 py-8 md:p-8 relative z-10 flex flex-col justify-center",children:[j.jsxs("div",{className:"w-full max-w-[90%] sm:max-w-md md:max-w-lg",children:["  ",j.jsx(Ui.h1,{ref:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-2xl xs:text-3xl md:text-4xl lg:text-5xl text-white font-bold leading-tight break-words hyphens-auto",children:e}),j.jsx(Ui.h2,{ref:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"text-base xs:text-lg md:text-xl lg:text-2xl font-medium text-white mb-3 md:mb-6",children:t}),j.jsx(Ui.p,{ref:o,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"text-xs xs:text-sm md:text-base text-neutral-300 break-words",children:i})]}),j.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 mt-3 md:mt-4",children:[j.jsx(Ui.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.6,type:"spring",stiffness:100},onClick:n,className:"mt-2 md:mt-4 px-3 md:px-6 py-1.5 md:py-3 text-xs sm:text-sm md:text-base rounded-lg bg-white text-black font-semibold transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/20",children:r}),j.jsxs(Ui.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.8,type:"spring",stiffness:100},onClick:()=>window.open("https://github.com/andriantahiry2024","_blank"),className:"mt-2 md:mt-4 px-2 md:px-3 py-1 md:py-1.5 text-xs rounded-md bg-white/10 hover:bg-white/20 text-white font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/10 flex items-center gap-1 md:gap-2",children:[j.jsx(vC,{className:"w-3 h-3 md:w-4 md:h-4"}),j.jsx("span",{children:"Github"})]}),j.jsxs(Ui.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:1,type:"spring",stiffness:100},onClick:()=>window.open("https://linkedin.com/in/nomenahasina-andriantahiry","_blank"),className:"mt-2 md:mt-4 px-2 md:px-3 py-1 md:py-1.5 text-xs rounded-md bg-white/10 hover:bg-white/20 text-white font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/10 flex items-center gap-1 md:gap-2",children:[j.jsx(yZ,{className:"w-3 h-3 md:w-4 md:h-4"}),j.jsx("span",{children:"LinkedIn"})]}),j.jsxs(Ui.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:1.2,type:"spring",stiffness:100},onClick:()=>window.location.href="mailto:contact@andriantahiry.dev",className:"mt-2 md:mt-4 px-2 md:px-3 py-1 md:py-1.5 text-xs rounded-md bg-white/10 hover:bg-white/20 text-white font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/10 flex items-center gap-1 md:gap-2",children:[j.jsx(A4,{className:"w-3 h-3 md:w-4 md:h-4"}),j.jsx("span",{children:"Email"})]})]})]}),j.jsx("div",{className:"flex-1 relative hidden md:block",children:j.jsx("div",{className:"absolute inset-0 z-10",children:j.jsx(Zxe,{scene:"https://prod.spline.design/kZDDjO5HuC9GJUM2/scene.splinecode",className:"w-full h-full",allowScroll:!0})})})]}),j.jsxs(Ui.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.5,duration:1},className:"absolute bottom-6 md:bottom-10 left-1/2 -translate-x-1/2 flex flex-col items-center",children:[j.jsx("span",{className:"text-gray-500 text-xs md:text-sm mb-1 md:mb-2",children:"Défiler"}),j.jsx(Ui.div,{animate:{y:[0,10,0]},transition:{repeat:1/0,duration:1.5},children:j.jsx(Lxe,{className:"h-4 w-4 md:h-6 md:w-6 text-gray-500"})})]})]})},av=de.forwardRef(({className:e,...t},i)=>j.jsx("div",{ref:i,className:an("rounded-xl border bg-card text-card-foreground shadow",e),...t}));av.displayName="Card";const H_=de.forwardRef(({className:e,...t},i)=>j.jsx("div",{ref:i,className:an("flex flex-col space-y-1.5 p-6",e),...t}));H_.displayName="CardHeader";const W_=de.forwardRef(({className:e,...t},i)=>j.jsx("h3",{ref:i,className:an("font-semibold leading-none tracking-tight",e),...t}));W_.displayName="CardTitle";const hM=de.forwardRef(({className:e,...t},i)=>j.jsx("p",{ref:i,className:an("text-sm text-muted-foreground",e),...t}));hM.displayName="CardDescription";const ov=de.forwardRef(({className:e,...t},i)=>j.jsx("div",{ref:i,className:an("p-6 pt-0",e),...t}));ov.displayName="CardContent";const dM=de.forwardRef(({className:e,...t},i)=>j.jsx("div",{ref:i,className:an("flex items-center p-6 pt-0",e),...t}));dM.displayName="CardFooter";function xZ(e,t){const i=de.useRef(t);de.useEffect(function(){t!==i.current&&e.attributionControl!=null&&(i.current!=null&&e.attributionControl.removeAttribution(i.current),t!=null&&e.attributionControl.addAttribution(t)),i.current=t},[e,t])}const ebe=1;function tbe(e){return Object.freeze({__version:ebe,map:e})}function ibe(e,t){return Object.freeze({...e,...t})}const bZ=de.createContext(null),_Z=bZ.Provider;function wZ(){const e=de.useContext(bZ);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function rbe(e){function t(i,r){const{instance:n,context:s}=e(i).current;return de.useImperativeHandle(r,()=>n),i.children==null?null:ci.createElement(_Z,{value:s},i.children)}return de.forwardRef(t)}function nbe(e){function t(i,r){const[n,s]=de.useState(!1),{instance:a}=e(i,s).current;de.useImperativeHandle(r,()=>a),de.useEffect(function(){n&&a.update()},[a,n,i.children]);const o=a._contentNode;return o?mK.createPortal(i.children,o):null}return de.forwardRef(t)}function sbe(e){function t(i,r){const{instance:n}=e(i).current;return de.useImperativeHandle(r,()=>n),null}return de.forwardRef(t)}function EZ(e,t){const i=de.useRef();de.useEffect(function(){return t!=null&&e.instance.on(t),i.current=t,function(){i.current!=null&&e.instance.off(i.current),i.current=null}},[e,t])}function M4(e,t){const i=e.pane??t.pane;return i?{...e,pane:i}:e}function abe(e,t){return function(r,n){const s=wZ(),a=e(M4(r,s),s);return xZ(s.map,r.attribution),EZ(a.current,r.eventHandlers),t(a.current,s,r,n),a}}var x3={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(i,r){r(t)})(Nr,function(i){var r="1.9.4";function n(p){var S,O,F,Q;for(O=1,F=arguments.length;O<F;O++){Q=arguments[O];for(S in Q)p[S]=Q[S]}return p}var s=Object.create||function(){function p(){}return function(S){return p.prototype=S,new p}}();function a(p,S){var O=Array.prototype.slice;if(p.bind)return p.bind.apply(p,O.call(arguments,1));var F=O.call(arguments,2);return function(){return p.apply(S,F.length?F.concat(O.call(arguments)):arguments)}}var o=0;function l(p){return"_leaflet_id"in p||(p._leaflet_id=++o),p._leaflet_id}function u(p,S,O){var F,Q,fe,ze;return ze=function(){F=!1,Q&&(fe.apply(O,Q),Q=!1)},fe=function(){F?Q=arguments:(p.apply(O,arguments),setTimeout(ze,S),F=!0)},fe}function c(p,S,O){var F=S[1],Q=S[0],fe=F-Q;return p===F&&O?p:((p-Q)%fe+fe)%fe+Q}function h(){return!1}function d(p,S){if(S===!1)return p;var O=Math.pow(10,S===void 0?6:S);return Math.round(p*O)/O}function f(p){return p.trim?p.trim():p.replace(/^\s+|\s+$/g,"")}function m(p){return f(p).split(/\s+/)}function g(p,S){Object.prototype.hasOwnProperty.call(p,"options")||(p.options=p.options?s(p.options):{});for(var O in S)p.options[O]=S[O];return p.options}function y(p,S,O){var F=[];for(var Q in p)F.push(encodeURIComponent(O?Q.toUpperCase():Q)+"="+encodeURIComponent(p[Q]));return(!S||S.indexOf("?")===-1?"?":"&")+F.join("&")}var x=/\{ *([\w_ -]+) *\}/g;function w(p,S){return p.replace(x,function(O,F){var Q=S[F];if(Q===void 0)throw new Error("No value provided for variable "+O);return typeof Q=="function"&&(Q=Q(S)),Q})}var b=Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"};function C(p,S){for(var O=0;O<p.length;O++)if(p[O]===S)return O;return-1}var A="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(p){return window["webkit"+p]||window["moz"+p]||window["ms"+p]}var _=0;function P(p){var S=+new Date,O=Math.max(0,16-(S-_));return _=S+O,window.setTimeout(p,O)}var I=window.requestAnimationFrame||E("RequestAnimationFrame")||P,D=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(p){window.clearTimeout(p)};function k(p,S,O){if(O&&I===P)p.call(S);else return I.call(window,a(p,S))}function B(p){p&&D.call(window,p)}var z={__proto__:null,extend:n,create:s,bind:a,get lastId(){return o},stamp:l,throttle:u,wrapNum:c,falseFn:h,formatNum:d,trim:f,splitWords:m,setOptions:g,getParamString:y,template:w,isArray:b,indexOf:C,emptyImageUrl:A,requestFn:I,cancelFn:D,requestAnimFrame:k,cancelAnimFrame:B};function W(){}W.extend=function(p){var S=function(){g(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},O=S.__super__=this.prototype,F=s(O);F.constructor=S,S.prototype=F;for(var Q in this)Object.prototype.hasOwnProperty.call(this,Q)&&Q!=="prototype"&&Q!=="__super__"&&(S[Q]=this[Q]);return p.statics&&n(S,p.statics),p.includes&&($(p.includes),n.apply(null,[F].concat(p.includes))),n(F,p),delete F.statics,delete F.includes,F.options&&(F.options=O.options?s(O.options):{},n(F.options,p.options)),F._initHooks=[],F.callInitHooks=function(){if(!this._initHooksCalled){O.callInitHooks&&O.callInitHooks.call(this),this._initHooksCalled=!0;for(var fe=0,ze=F._initHooks.length;fe<ze;fe++)F._initHooks[fe].call(this)}},S},W.include=function(p){var S=this.prototype.options;return n(this.prototype,p),p.options&&(this.prototype.options=S,this.mergeOptions(p.options)),this},W.mergeOptions=function(p){return n(this.prototype.options,p),this},W.addInitHook=function(p){var S=Array.prototype.slice.call(arguments,1),O=typeof p=="function"?p:function(){this[p].apply(this,S)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(O),this};function $(p){if(!(typeof L>"u"||!L||!L.Mixin)){p=b(p)?p:[p];for(var S=0;S<p.length;S++)p[S]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(p,S,O){if(typeof p=="object")for(var F in p)this._on(F,p[F],S);else{p=m(p);for(var Q=0,fe=p.length;Q<fe;Q++)this._on(p[Q],S,O)}return this},off:function(p,S,O){if(!arguments.length)delete this._events;else if(typeof p=="object")for(var F in p)this._off(F,p[F],S);else{p=m(p);for(var Q=arguments.length===1,fe=0,ze=p.length;fe<ze;fe++)Q?this._off(p[fe]):this._off(p[fe],S,O)}return this},_on:function(p,S,O,F){if(typeof S!="function"){console.warn("wrong listener type: "+typeof S);return}if(this._listens(p,S,O)===!1){O===this&&(O=void 0);var Q={fn:S,ctx:O};F&&(Q.once=!0),this._events=this._events||{},this._events[p]=this._events[p]||[],this._events[p].push(Q)}},_off:function(p,S,O){var F,Q,fe;if(this._events&&(F=this._events[p],!!F)){if(arguments.length===1){if(this._firingCount)for(Q=0,fe=F.length;Q<fe;Q++)F[Q].fn=h;delete this._events[p];return}if(typeof S!="function"){console.warn("wrong listener type: "+typeof S);return}var ze=this._listens(p,S,O);if(ze!==!1){var rt=F[ze];this._firingCount&&(rt.fn=h,this._events[p]=F=F.slice()),F.splice(ze,1)}}},fire:function(p,S,O){if(!this.listens(p,O))return this;var F=n({},S,{type:p,target:this,sourceTarget:S&&S.sourceTarget||this});if(this._events){var Q=this._events[p];if(Q){this._firingCount=this._firingCount+1||1;for(var fe=0,ze=Q.length;fe<ze;fe++){var rt=Q[fe],ct=rt.fn;rt.once&&this.off(p,ct,rt.ctx),ct.call(rt.ctx||this,F)}this._firingCount--}}return O&&this._propagateEvent(F),this},listens:function(p,S,O,F){typeof p!="string"&&console.warn('"string" type argument expected');var Q=S;typeof S!="function"&&(F=!!S,Q=void 0,O=void 0);var fe=this._events&&this._events[p];if(fe&&fe.length&&this._listens(p,Q,O)!==!1)return!0;if(F){for(var ze in this._eventParents)if(this._eventParents[ze].listens(p,S,O,F))return!0}return!1},_listens:function(p,S,O){if(!this._events)return!1;var F=this._events[p]||[];if(!S)return!!F.length;O===this&&(O=void 0);for(var Q=0,fe=F.length;Q<fe;Q++)if(F[Q].fn===S&&F[Q].ctx===O)return Q;return!1},once:function(p,S,O){if(typeof p=="object")for(var F in p)this._on(F,p[F],S,!0);else{p=m(p);for(var Q=0,fe=p.length;Q<fe;Q++)this._on(p[Q],S,O,!0)}return this},addEventParent:function(p){return this._eventParents=this._eventParents||{},this._eventParents[l(p)]=p,this},removeEventParent:function(p){return this._eventParents&&delete this._eventParents[l(p)],this},_propagateEvent:function(p){for(var S in this._eventParents)this._eventParents[S].fire(p.type,n({layer:p.target,propagatedFrom:p.target},p),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var G=W.extend(Z);function V(p,S,O){this.x=O?Math.round(p):p,this.y=O?Math.round(S):S}var J=Math.trunc||function(p){return p>0?Math.floor(p):Math.ceil(p)};V.prototype={clone:function(){return new V(this.x,this.y)},add:function(p){return this.clone()._add(U(p))},_add:function(p){return this.x+=p.x,this.y+=p.y,this},subtract:function(p){return this.clone()._subtract(U(p))},_subtract:function(p){return this.x-=p.x,this.y-=p.y,this},divideBy:function(p){return this.clone()._divideBy(p)},_divideBy:function(p){return this.x/=p,this.y/=p,this},multiplyBy:function(p){return this.clone()._multiplyBy(p)},_multiplyBy:function(p){return this.x*=p,this.y*=p,this},scaleBy:function(p){return new V(this.x*p.x,this.y*p.y)},unscaleBy:function(p){return new V(this.x/p.x,this.y/p.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=J(this.x),this.y=J(this.y),this},distanceTo:function(p){p=U(p);var S=p.x-this.x,O=p.y-this.y;return Math.sqrt(S*S+O*O)},equals:function(p){return p=U(p),p.x===this.x&&p.y===this.y},contains:function(p){return p=U(p),Math.abs(p.x)<=Math.abs(this.x)&&Math.abs(p.y)<=Math.abs(this.y)},toString:function(){return"Point("+d(this.x)+", "+d(this.y)+")"}};function U(p,S,O){return p instanceof V?p:b(p)?new V(p[0],p[1]):p==null?p:typeof p=="object"&&"x"in p&&"y"in p?new V(p.x,p.y):new V(p,S,O)}function ie(p,S){if(p)for(var O=S?[p,S]:p,F=0,Q=O.length;F<Q;F++)this.extend(O[F])}ie.prototype={extend:function(p){var S,O;if(!p)return this;if(p instanceof V||typeof p[0]=="number"||"x"in p)S=O=U(p);else if(p=se(p),S=p.min,O=p.max,!S||!O)return this;return!this.min&&!this.max?(this.min=S.clone(),this.max=O.clone()):(this.min.x=Math.min(S.x,this.min.x),this.max.x=Math.max(O.x,this.max.x),this.min.y=Math.min(S.y,this.min.y),this.max.y=Math.max(O.y,this.max.y)),this},getCenter:function(p){return U((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,p)},getBottomLeft:function(){return U(this.min.x,this.max.y)},getTopRight:function(){return U(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(p){var S,O;return typeof p[0]=="number"||p instanceof V?p=U(p):p=se(p),p instanceof ie?(S=p.min,O=p.max):S=O=p,S.x>=this.min.x&&O.x<=this.max.x&&S.y>=this.min.y&&O.y<=this.max.y},intersects:function(p){p=se(p);var S=this.min,O=this.max,F=p.min,Q=p.max,fe=Q.x>=S.x&&F.x<=O.x,ze=Q.y>=S.y&&F.y<=O.y;return fe&&ze},overlaps:function(p){p=se(p);var S=this.min,O=this.max,F=p.min,Q=p.max,fe=Q.x>S.x&&F.x<O.x,ze=Q.y>S.y&&F.y<O.y;return fe&&ze},isValid:function(){return!!(this.min&&this.max)},pad:function(p){var S=this.min,O=this.max,F=Math.abs(S.x-O.x)*p,Q=Math.abs(S.y-O.y)*p;return se(U(S.x-F,S.y-Q),U(O.x+F,O.y+Q))},equals:function(p){return p?(p=se(p),this.min.equals(p.getTopLeft())&&this.max.equals(p.getBottomRight())):!1}};function se(p,S){return!p||p instanceof ie?p:new ie(p,S)}function ee(p,S){if(p)for(var O=S?[p,S]:p,F=0,Q=O.length;F<Q;F++)this.extend(O[F])}ee.prototype={extend:function(p){var S=this._southWest,O=this._northEast,F,Q;if(p instanceof _e)F=p,Q=p;else if(p instanceof ee){if(F=p._southWest,Q=p._northEast,!F||!Q)return this}else return p?this.extend(he(p)||ve(p)):this;return!S&&!O?(this._southWest=new _e(F.lat,F.lng),this._northEast=new _e(Q.lat,Q.lng)):(S.lat=Math.min(F.lat,S.lat),S.lng=Math.min(F.lng,S.lng),O.lat=Math.max(Q.lat,O.lat),O.lng=Math.max(Q.lng,O.lng)),this},pad:function(p){var S=this._southWest,O=this._northEast,F=Math.abs(S.lat-O.lat)*p,Q=Math.abs(S.lng-O.lng)*p;return new ee(new _e(S.lat-F,S.lng-Q),new _e(O.lat+F,O.lng+Q))},getCenter:function(){return new _e((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new _e(this.getNorth(),this.getWest())},getSouthEast:function(){return new _e(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(p){typeof p[0]=="number"||p instanceof _e||"lat"in p?p=he(p):p=ve(p);var S=this._southWest,O=this._northEast,F,Q;return p instanceof ee?(F=p.getSouthWest(),Q=p.getNorthEast()):F=Q=p,F.lat>=S.lat&&Q.lat<=O.lat&&F.lng>=S.lng&&Q.lng<=O.lng},intersects:function(p){p=ve(p);var S=this._southWest,O=this._northEast,F=p.getSouthWest(),Q=p.getNorthEast(),fe=Q.lat>=S.lat&&F.lat<=O.lat,ze=Q.lng>=S.lng&&F.lng<=O.lng;return fe&&ze},overlaps:function(p){p=ve(p);var S=this._southWest,O=this._northEast,F=p.getSouthWest(),Q=p.getNorthEast(),fe=Q.lat>S.lat&&F.lat<O.lat,ze=Q.lng>S.lng&&F.lng<O.lng;return fe&&ze},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(p,S){return p?(p=ve(p),this._southWest.equals(p.getSouthWest(),S)&&this._northEast.equals(p.getNorthEast(),S)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ve(p,S){return p instanceof ee?p:new ee(p,S)}function _e(p,S,O){if(isNaN(p)||isNaN(S))throw new Error("Invalid LatLng object: ("+p+", "+S+")");this.lat=+p,this.lng=+S,O!==void 0&&(this.alt=+O)}_e.prototype={equals:function(p,S){if(!p)return!1;p=he(p);var O=Math.max(Math.abs(this.lat-p.lat),Math.abs(this.lng-p.lng));return O<=(S===void 0?1e-9:S)},toString:function(p){return"LatLng("+d(this.lat,p)+", "+d(this.lng,p)+")"},distanceTo:function(p){return we.distance(this,he(p))},wrap:function(){return we.wrapLatLng(this)},toBounds:function(p){var S=180*p/40075017,O=S/Math.cos(Math.PI/180*this.lat);return ve([this.lat-S,this.lng-O],[this.lat+S,this.lng+O])},clone:function(){return new _e(this.lat,this.lng,this.alt)}};function he(p,S,O){return p instanceof _e?p:b(p)&&typeof p[0]!="object"?p.length===3?new _e(p[0],p[1],p[2]):p.length===2?new _e(p[0],p[1]):null:p==null?p:typeof p=="object"&&"lat"in p?new _e(p.lat,"lng"in p?p.lng:p.lon,p.alt):S===void 0?null:new _e(p,S,O)}var De={latLngToPoint:function(p,S){var O=this.projection.project(p),F=this.scale(S);return this.transformation._transform(O,F)},pointToLatLng:function(p,S){var O=this.scale(S),F=this.transformation.untransform(p,O);return this.projection.unproject(F)},project:function(p){return this.projection.project(p)},unproject:function(p){return this.projection.unproject(p)},scale:function(p){return 256*Math.pow(2,p)},zoom:function(p){return Math.log(p/256)/Math.LN2},getProjectedBounds:function(p){if(this.infinite)return null;var S=this.projection.bounds,O=this.scale(p),F=this.transformation.transform(S.min,O),Q=this.transformation.transform(S.max,O);return new ie(F,Q)},infinite:!1,wrapLatLng:function(p){var S=this.wrapLng?c(p.lng,this.wrapLng,!0):p.lng,O=this.wrapLat?c(p.lat,this.wrapLat,!0):p.lat,F=p.alt;return new _e(O,S,F)},wrapLatLngBounds:function(p){var S=p.getCenter(),O=this.wrapLatLng(S),F=S.lat-O.lat,Q=S.lng-O.lng;if(F===0&&Q===0)return p;var fe=p.getSouthWest(),ze=p.getNorthEast(),rt=new _e(fe.lat-F,fe.lng-Q),ct=new _e(ze.lat-F,ze.lng-Q);return new ee(rt,ct)}},we=n({},De,{wrapLng:[-180,180],R:6371e3,distance:function(p,S){var O=Math.PI/180,F=p.lat*O,Q=S.lat*O,fe=Math.sin((S.lat-p.lat)*O/2),ze=Math.sin((S.lng-p.lng)*O/2),rt=fe*fe+Math.cos(F)*Math.cos(Q)*ze*ze,ct=2*Math.atan2(Math.sqrt(rt),Math.sqrt(1-rt));return this.R*ct}}),Le=6378137,Te={R:Le,MAX_LATITUDE:85.0511287798,project:function(p){var S=Math.PI/180,O=this.MAX_LATITUDE,F=Math.max(Math.min(O,p.lat),-O),Q=Math.sin(F*S);return new V(this.R*p.lng*S,this.R*Math.log((1+Q)/(1-Q))/2)},unproject:function(p){var S=180/Math.PI;return new _e((2*Math.atan(Math.exp(p.y/this.R))-Math.PI/2)*S,p.x*S/this.R)},bounds:function(){var p=Le*Math.PI;return new ie([-p,-p],[p,p])}()};function ke(p,S,O,F){if(b(p)){this._a=p[0],this._b=p[1],this._c=p[2],this._d=p[3];return}this._a=p,this._b=S,this._c=O,this._d=F}ke.prototype={transform:function(p,S){return this._transform(p.clone(),S)},_transform:function(p,S){return S=S||1,p.x=S*(this._a*p.x+this._b),p.y=S*(this._c*p.y+this._d),p},untransform:function(p,S){return S=S||1,new V((p.x/S-this._b)/this._a,(p.y/S-this._d)/this._c)}};function Xe(p,S,O,F){return new ke(p,S,O,F)}var et=n({},we,{code:"EPSG:3857",projection:Te,transformation:function(){var p=.5/(Math.PI*Te.R);return Xe(p,.5,-p,.5)}()}),Ze=n({},et,{code:"EPSG:900913"});function st(p){return document.createElementNS("http://www.w3.org/2000/svg",p)}function _t(p,S){var O="",F,Q,fe,ze,rt,ct;for(F=0,fe=p.length;F<fe;F++){for(rt=p[F],Q=0,ze=rt.length;Q<ze;Q++)ct=rt[Q],O+=(Q?"L":"M")+ct.x+" "+ct.y;O+=S?me.svg?"z":"x":""}return O||"M0 0"}var St=document.documentElement.style,ue="ActiveXObject"in window,Ee=ue&&!document.addEventListener,Ae="msLaunchUri"in navigator&&!("documentMode"in document),Ge=Ln("webkit"),ae=Ln("android"),te=Ln("android 2")||Ln("android 3"),Ne=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Re=ae&&Ln("Google")&&Ne<537&&!("AudioNode"in window),Y=!!window.opera,Me=!Ae&&Ln("chrome"),Ke=Ln("gecko")&&!Ge&&!Y&&!ue,ot=!Me&&Ln("safari"),qe=Ln("phantom"),It="OTransition"in St,Ot=navigator.platform.indexOf("Win")===0,Dt=ue&&"transition"in St,kt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!te,Qe="MozPerspective"in St,mt=!window.L_DISABLE_3D&&(Dt||kt||Qe)&&!It&&!qe,Ht=typeof orientation<"u"||Ln("mobile"),Wt=Ht&&Ge,Ue=Ht&&kt,dt=!window.PointerEvent&&window.MSPointerEvent,gt=!!(window.PointerEvent||dt),Bt="ontouchstart"in window||!!window.TouchEvent,ei=!window.L_NO_TOUCH&&(Bt||gt),zi=Ht&&Y,vi=Ht&&Ke,Yi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,wn=function(){var p=!1;try{var S=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("testPassiveEventSupport",h,S),window.removeEventListener("testPassiveEventSupport",h,S)}catch{}return p}(),yr=function(){return!!document.createElement("canvas").getContext}(),Rn=!!(document.createElementNS&&st("svg").createSVGRect),Yr=!!Rn&&function(){var p=document.createElement("div");return p.innerHTML="<svg/>",(p.firstChild&&p.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Hn=!Rn&&function(){try{var p=document.createElement("div");p.innerHTML='<v:shape adj="1"/>';var S=p.firstChild;return S.style.behavior="url(#default#VML)",S&&typeof S.adj=="object"}catch{return!1}}(),Jo=navigator.platform.indexOf("Mac")===0,Bl=navigator.platform.indexOf("Linux")===0;function Ln(p){return navigator.userAgent.toLowerCase().indexOf(p)>=0}var me={ie:ue,ielt9:Ee,edge:Ae,webkit:Ge,android:ae,android23:te,androidStock:Re,opera:Y,chrome:Me,gecko:Ke,safari:ot,phantom:qe,opera12:It,win:Ot,ie3d:Dt,webkit3d:kt,gecko3d:Qe,any3d:mt,mobile:Ht,mobileWebkit:Wt,mobileWebkit3d:Ue,msPointer:dt,pointer:gt,touch:ei,touchNative:Bt,mobileOpera:zi,mobileGecko:vi,retina:Yi,passiveEvents:wn,canvas:yr,svg:Rn,vml:Hn,inlineSvg:Yr,mac:Jo,linux:Bl},lt=me.msPointer?"MSPointerDown":"pointerdown",pt=me.msPointer?"MSPointerMove":"pointermove",tt=me.msPointer?"MSPointerUp":"pointerup",xt=me.msPointer?"MSPointerCancel":"pointercancel",Qt={touchstart:lt,touchmove:pt,touchend:tt,touchcancel:xt},hi={touchstart:Lr,touchmove:Wn,touchend:Wn,touchcancel:Wn},ui={},ri=!1;function dr(p,S,O){return S==="touchstart"&&is(),hi[S]?(O=hi[S].bind(this,O),p.addEventListener(Qt[S],O,!1),O):(console.warn("wrong event specified:",S),h)}function Li(p,S,O){if(!Qt[S]){console.warn("wrong event specified:",S);return}p.removeEventListener(Qt[S],O,!1)}function Ni(p){ui[p.pointerId]=p}function bi(p){ui[p.pointerId]&&(ui[p.pointerId]=p)}function on(p){delete ui[p.pointerId]}function is(){ri||(document.addEventListener(lt,Ni,!0),document.addEventListener(pt,bi,!0),document.addEventListener(tt,on,!0),document.addEventListener(xt,on,!0),ri=!0)}function Wn(p,S){if(S.pointerType!==(S.MSPOINTER_TYPE_MOUSE||"mouse")){S.touches=[];for(var O in ui)S.touches.push(ui[O]);S.changedTouches=[S],p(S)}}function Lr(p,S){S.MSPOINTER_TYPE_TOUCH&&S.pointerType===S.MSPOINTER_TYPE_TOUCH&&Vi(S),Wn(p,S)}function Xi(p){var S={},O,F;for(F in p)O=p[F],S[F]=O&&O.bind?O.bind(p):O;return p=S,S.type="dblclick",S.detail=2,S.isTrusted=!1,S._simulated=!0,S}var ia=200;function Fi(p,S){p.addEventListener("dblclick",S);var O=0,F;function Q(fe){if(fe.detail!==1){F=fe.detail;return}if(!(fe.pointerType==="mouse"||fe.sourceCapabilities&&!fe.sourceCapabilities.firesTouchEvents)){var ze=gm(fe);if(!(ze.some(function(ct){return ct instanceof HTMLLabelElement&&ct.attributes.for})&&!ze.some(function(ct){return ct instanceof HTMLInputElement||ct instanceof HTMLSelectElement}))){var rt=Date.now();rt-O<=ia?(F++,F===2&&S(Xi(fe))):F=1,O=rt}}}return p.addEventListener("click",Q),{dblclick:S,simDblclick:Q}}function Ya(p,S){p.removeEventListener("dblclick",S.dblclick),p.removeEventListener("click",S.simDblclick)}var ra=Nc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ks=Nc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Aa=ks==="webkitTransition"||ks==="OTransition"?ks+"End":"transitionend";function le(p){return typeof p=="string"?document.getElementById(p):p}function pe(p,S){var O=p.style[S]||p.currentStyle&&p.currentStyle[S];if((!O||O==="auto")&&document.defaultView){var F=document.defaultView.getComputedStyle(p,null);O=F?F[S]:null}return O==="auto"?null:O}function Ce(p,S,O){var F=document.createElement(p);return F.className=S||"",O&&O.appendChild(F),F}function ye(p){var S=p.parentNode;S&&S.removeChild(p)}function We(p){for(;p.firstChild;)p.removeChild(p.firstChild)}function Ct(p){var S=p.parentNode;S&&S.lastChild!==p&&S.appendChild(p)}function En(p){var S=p.parentNode;S&&S.firstChild!==p&&S.insertBefore(p,S.firstChild)}function Wu(p,S){if(p.classList!==void 0)return p.classList.contains(S);var O=_o(p);return O.length>0&&new RegExp("(^|\\s)"+S+"(\\s|$)").test(O)}function Di(p,S){if(p.classList!==void 0)for(var O=m(S),F=0,Q=O.length;F<Q;F++)p.classList.add(O[F]);else if(!Wu(p,S)){var fe=_o(p);el(p,(fe?fe+" ":"")+S)}}function Dr(p,S){p.classList!==void 0?p.classList.remove(S):el(p,f((" "+_o(p)+" ").replace(" "+S+" "," ")))}function el(p,S){p.className.baseVal===void 0?p.className=S:p.className.baseVal=S}function _o(p){return p.correspondingElement&&(p=p.correspondingElement),p.className.baseVal===void 0?p.className:p.className.baseVal}function na(p,S){"opacity"in p.style?p.style.opacity=S:"filter"in p.style&&bv(p,S)}function bv(p,S){var O=!1,F="DXImageTransform.Microsoft.Alpha";try{O=p.filters.item(F)}catch{if(S===1)return}S=Math.round(S*100),O?(O.Enabled=S!==100,O.Opacity=S):p.style.filter+=" progid:"+F+"(opacity="+S+")"}function Nc(p){for(var S=document.documentElement.style,O=0;O<p.length;O++)if(p[O]in S)return p[O];return!1}function rs(p,S,O){var F=S||new V(0,0);p.style[ra]=(me.ie3d?"translate("+F.x+"px,"+F.y+"px)":"translate3d("+F.x+"px,"+F.y+"px,0)")+(O?" scale("+O+")":"")}function pn(p,S){p._leaflet_pos=S,me.any3d?rs(p,S):(p.style.left=S.x+"px",p.style.top=S.y+"px")}function Ma(p){return p._leaflet_pos||new V(0,0)}var Gu,tl,il;if("onselectstart"in document)Gu=function(){ji(window,"selectstart",Vi)},tl=function(){zr(window,"selectstart",Vi)};else{var Xa=Nc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Gu=function(){if(Xa){var p=document.documentElement.style;il=p[Xa],p[Xa]="none"}},tl=function(){Xa&&(document.documentElement.style[Xa]=il,il=void 0)}}function Wh(){ji(window,"dragstart",Vi)}function xf(){zr(window,"dragstart",Vi)}var zl,Gh;function kc(p){for(;p.tabIndex===-1;)p=p.parentNode;p.style&&(qh(),zl=p,Gh=p.style.outlineStyle,p.style.outlineStyle="none",ji(window,"keydown",qh))}function qh(){zl&&(zl.style.outlineStyle=Gh,zl=void 0,Gh=void 0,zr(window,"keydown",qh))}function cm(p){do p=p.parentNode;while((!p.offsetWidth||!p.offsetHeight)&&p!==document.body);return p}function hm(p){var S=p.getBoundingClientRect();return{x:S.width/p.offsetWidth||1,y:S.height/p.offsetHeight||1,boundingClientRect:S}}var dm={__proto__:null,TRANSFORM:ra,TRANSITION:ks,TRANSITION_END:Aa,get:le,getStyle:pe,create:Ce,remove:ye,empty:We,toFront:Ct,toBack:En,hasClass:Wu,addClass:Di,removeClass:Dr,setClass:el,getClass:_o,setOpacity:na,testProp:Nc,setTransform:rs,setPosition:pn,getPosition:Ma,get disableTextSelection(){return Gu},get enableTextSelection(){return tl},disableImageDrag:Wh,enableImageDrag:xf,preventOutline:kc,restoreOutline:qh,getSizedParentNode:cm,getScale:hm};function ji(p,S,O,F){if(S&&typeof S=="object")for(var Q in S)fm(p,Q,S[Q],O);else{S=m(S);for(var fe=0,ze=S.length;fe<ze;fe++)fm(p,S[fe],O,F)}return this}var rl="_leaflet_events";function zr(p,S,O,F){if(arguments.length===1)_v(p),delete p[rl];else if(S&&typeof S=="object")for(var Q in S)pm(p,Q,S[Q],O);else if(S=m(S),arguments.length===2)_v(p,function(rt){return C(S,rt)!==-1});else for(var fe=0,ze=S.length;fe<ze;fe++)pm(p,S[fe],O,F);return this}function _v(p,S){for(var O in p[rl]){var F=O.split(/\d/)[0];(!S||S(F))&&pm(p,F,null,null,O)}}var Yh={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function fm(p,S,O,F){var Q=S+l(O)+(F?"_"+l(F):"");if(p[rl]&&p[rl][Q])return this;var fe=function(rt){return O.call(F||p,rt||window.event)},ze=fe;!me.touchNative&&me.pointer&&S.indexOf("touch")===0?fe=dr(p,S,fe):me.touch&&S==="dblclick"?fe=Fi(p,fe):"addEventListener"in p?S==="touchstart"||S==="touchmove"||S==="wheel"||S==="mousewheel"?p.addEventListener(Yh[S]||S,fe,me.passiveEvents?{passive:!1}:!1):S==="mouseenter"||S==="mouseleave"?(fe=function(rt){rt=rt||window.event,Kh(p,rt)&&ze(rt)},p.addEventListener(Yh[S],fe,!1)):p.addEventListener(S,ze,!1):p.attachEvent("on"+S,fe),p[rl]=p[rl]||{},p[rl][Q]=fe}function pm(p,S,O,F,Q){Q=Q||S+l(O)+(F?"_"+l(F):"");var fe=p[rl]&&p[rl][Q];if(!fe)return this;!me.touchNative&&me.pointer&&S.indexOf("touch")===0?Li(p,S,fe):me.touch&&S==="dblclick"?Ya(p,fe):"removeEventListener"in p?p.removeEventListener(Yh[S]||S,fe,!1):p.detachEvent("on"+S,fe),p[rl][Q]=null}function qu(p){return p.stopPropagation?p.stopPropagation():p.originalEvent?p.originalEvent._stopped=!0:p.cancelBubble=!0,this}function mm(p){return fm(p,"wheel",qu),this}function Xh(p){return ji(p,"mousedown touchstart dblclick contextmenu",qu),p._leaflet_disable_click=!0,this}function Vi(p){return p.preventDefault?p.preventDefault():p.returnValue=!1,this}function mr(p){return Vi(p),qu(p),this}function gm(p){if(p.composedPath)return p.composedPath();for(var S=[],O=p.target;O;)S.push(O),O=O.parentNode;return S}function bf(p,S){if(!S)return new V(p.clientX,p.clientY);var O=hm(S),F=O.boundingClientRect;return new V((p.clientX-F.left)/O.x-S.clientLeft,(p.clientY-F.top)/O.y-S.clientTop)}var wv=me.linux&&me.chrome?window.devicePixelRatio:me.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function vm(p){return me.edge?p.wheelDeltaY/2:p.deltaY&&p.deltaMode===0?-p.deltaY/wv:p.deltaY&&p.deltaMode===1?-p.deltaY*20:p.deltaY&&p.deltaMode===2?-p.deltaY*60:p.deltaX||p.deltaZ?0:p.wheelDelta?(p.wheelDeltaY||p.wheelDelta)/2:p.detail&&Math.abs(p.detail)<32765?-p.detail*20:p.detail?p.detail/-32765*60:0}function Kh(p,S){var O=S.relatedTarget;if(!O)return!0;try{for(;O&&O!==p;)O=O.parentNode}catch{return!1}return O!==p}var E1={__proto__:null,on:ji,off:zr,stopPropagation:qu,disableScrollPropagation:mm,disableClickPropagation:Xh,preventDefault:Vi,stop:mr,getPropagationPath:gm,getMousePosition:bf,getWheelDelta:vm,isExternalTarget:Kh,addListener:ji,removeListener:zr},ym=G.extend({run:function(p,S,O,F){this.stop(),this._el=p,this._inProgress=!0,this._duration=O||.25,this._easeOutPower=1/Math.max(F||.5,.2),this._startPos=Ma(p),this._offset=S.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=k(this._animate,this),this._step()},_step:function(p){var S=+new Date-this._startTime,O=this._duration*1e3;S<O?this._runFrame(this._easeOut(S/O),p):(this._runFrame(1),this._complete())},_runFrame:function(p,S){var O=this._startPos.add(this._offset.multiplyBy(p));S&&O._round(),pn(this._el,O),this.fire("step")},_complete:function(){B(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(p){return 1-Math.pow(1-p,this._easeOutPower)}}),gr=G.extend({options:{crs:et,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(p,S){S=g(this,S),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(p),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),S.maxBounds&&this.setMaxBounds(S.maxBounds),S.zoom!==void 0&&(this._zoom=this._limitZoom(S.zoom)),S.center&&S.zoom!==void 0&&this.setView(he(S.center),S.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ks&&me.any3d&&!me.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ji(this._proxy,Aa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(p,S,O){if(S=S===void 0?this._zoom:this._limitZoom(S),p=this._limitCenter(he(p),S,this.options.maxBounds),O=O||{},this._stop(),this._loaded&&!O.reset&&O!==!0){O.animate!==void 0&&(O.zoom=n({animate:O.animate},O.zoom),O.pan=n({animate:O.animate,duration:O.duration},O.pan));var F=this._zoom!==S?this._tryAnimatedZoom&&this._tryAnimatedZoom(p,S,O.zoom):this._tryAnimatedPan(p,O.pan);if(F)return clearTimeout(this._sizeTimer),this}return this._resetView(p,S,O.pan&&O.pan.noMoveStart),this},setZoom:function(p,S){return this._loaded?this.setView(this.getCenter(),p,{zoom:S}):(this._zoom=p,this)},zoomIn:function(p,S){return p=p||(me.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+p,S)},zoomOut:function(p,S){return p=p||(me.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-p,S)},setZoomAround:function(p,S,O){var F=this.getZoomScale(S),Q=this.getSize().divideBy(2),fe=p instanceof V?p:this.latLngToContainerPoint(p),ze=fe.subtract(Q).multiplyBy(1-1/F),rt=this.containerPointToLatLng(Q.add(ze));return this.setView(rt,S,{zoom:O})},_getBoundsCenterZoom:function(p,S){S=S||{},p=p.getBounds?p.getBounds():ve(p);var O=U(S.paddingTopLeft||S.padding||[0,0]),F=U(S.paddingBottomRight||S.padding||[0,0]),Q=this.getBoundsZoom(p,!1,O.add(F));if(Q=typeof S.maxZoom=="number"?Math.min(S.maxZoom,Q):Q,Q===1/0)return{center:p.getCenter(),zoom:Q};var fe=F.subtract(O).divideBy(2),ze=this.project(p.getSouthWest(),Q),rt=this.project(p.getNorthEast(),Q),ct=this.unproject(ze.add(rt).divideBy(2).add(fe),Q);return{center:ct,zoom:Q}},fitBounds:function(p,S){if(p=ve(p),!p.isValid())throw new Error("Bounds are not valid.");var O=this._getBoundsCenterZoom(p,S);return this.setView(O.center,O.zoom,S)},fitWorld:function(p){return this.fitBounds([[-90,-180],[90,180]],p)},panTo:function(p,S){return this.setView(p,this._zoom,{pan:S})},panBy:function(p,S){if(p=U(p).round(),S=S||{},!p.x&&!p.y)return this.fire("moveend");if(S.animate!==!0&&!this.getSize().contains(p))return this._resetView(this.unproject(this.project(this.getCenter()).add(p)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ym,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),S.noMoveStart||this.fire("movestart"),S.animate!==!1){Di(this._mapPane,"leaflet-pan-anim");var O=this._getMapPanePos().subtract(p).round();this._panAnim.run(this._mapPane,O,S.duration||.25,S.easeLinearity)}else this._rawPanBy(p),this.fire("move").fire("moveend");return this},flyTo:function(p,S,O){if(O=O||{},O.animate===!1||!me.any3d)return this.setView(p,S,O);this._stop();var F=this.project(this.getCenter()),Q=this.project(p),fe=this.getSize(),ze=this._zoom;p=he(p),S=S===void 0?ze:S;var rt=Math.max(fe.x,fe.y),ct=rt*this.getZoomScale(ze,S),Rt=Q.distanceTo(F)||1,$t=1.42,fi=$t*$t;function rr(mn){var Dm=mn?-1:1,ge=mn?ct:rt,Tf=ct*ct-rt*rt+Dm*fi*fi*Rt*Rt,Sv=2*ge*fi*Rt,Qa=Tf/Sv,fr=Math.sqrt(Qa*Qa+1)-Qa,T2=fr<1e-9?-18:Math.log(fr);return T2}function Gn(mn){return(Math.exp(mn)-Math.exp(-mn))/2}function Dn(mn){return(Math.exp(mn)+Math.exp(-mn))/2}function ua(mn){return Gn(mn)/Dn(mn)}var Fs=rr(0);function jl(mn){return rt*(Dn(Fs)/Dn(Fs+$t*mn))}function _2(mn){return rt*(Dn(Fs)*ua(Fs+$t*mn)-Gn(Fs))/fi}function w2(mn){return 1-Math.pow(1-mn,1.5)}var E2=Date.now(),Tw=(rr(1)-Fs)/$t,S2=O.duration?1e3*O.duration:1e3*Tw*.8;function Pm(){var mn=(Date.now()-E2)/S2,Dm=w2(mn)*Tw;mn<=1?(this._flyToFrame=k(Pm,this),this._move(this.unproject(F.add(Q.subtract(F).multiplyBy(_2(Dm)/Rt)),ze),this.getScaleZoom(rt/jl(Dm),ze),{flyTo:!0})):this._move(p,S)._moveEnd(!0)}return this._moveStart(!0,O.noMoveStart),Pm.call(this),this},flyToBounds:function(p,S){var O=this._getBoundsCenterZoom(p,S);return this.flyTo(O.center,O.zoom,S)},setMaxBounds:function(p){return p=ve(p),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),p.isValid()?(this.options.maxBounds=p,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(p){var S=this.options.minZoom;return this.options.minZoom=p,this._loaded&&S!==p&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(p):this},setMaxZoom:function(p){var S=this.options.maxZoom;return this.options.maxZoom=p,this._loaded&&S!==p&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(p):this},panInsideBounds:function(p,S){this._enforcingBounds=!0;var O=this.getCenter(),F=this._limitCenter(O,this._zoom,ve(p));return O.equals(F)||this.panTo(F,S),this._enforcingBounds=!1,this},panInside:function(p,S){S=S||{};var O=U(S.paddingTopLeft||S.padding||[0,0]),F=U(S.paddingBottomRight||S.padding||[0,0]),Q=this.project(this.getCenter()),fe=this.project(p),ze=this.getPixelBounds(),rt=se([ze.min.add(O),ze.max.subtract(F)]),ct=rt.getSize();if(!rt.contains(fe)){this._enforcingBounds=!0;var Rt=fe.subtract(rt.getCenter()),$t=rt.extend(fe).getSize().subtract(ct);Q.x+=Rt.x<0?-$t.x:$t.x,Q.y+=Rt.y<0?-$t.y:$t.y,this.panTo(this.unproject(Q),S),this._enforcingBounds=!1}return this},invalidateSize:function(p){if(!this._loaded)return this;p=n({animate:!1,pan:!0},p===!0?{animate:!0}:p);var S=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var O=this.getSize(),F=S.divideBy(2).round(),Q=O.divideBy(2).round(),fe=F.subtract(Q);return!fe.x&&!fe.y?this:(p.animate&&p.pan?this.panBy(fe):(p.pan&&this._rawPanBy(fe),this.fire("move"),p.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:S,newSize:O}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(p){if(p=this._locateOptions=n({timeout:1e4,watch:!1},p),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var S=a(this._handleGeolocationResponse,this),O=a(this._handleGeolocationError,this);return p.watch?this._locationWatchId=navigator.geolocation.watchPosition(S,O,p):navigator.geolocation.getCurrentPosition(S,O,p),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(p){if(this._container._leaflet_id){var S=p.code,O=p.message||(S===1?"permission denied":S===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:S,message:"Geolocation error: "+O+"."})}},_handleGeolocationResponse:function(p){if(this._container._leaflet_id){var S=p.coords.latitude,O=p.coords.longitude,F=new _e(S,O),Q=F.toBounds(p.coords.accuracy*2),fe=this._locateOptions;if(fe.setView){var ze=this.getBoundsZoom(Q);this.setView(F,fe.maxZoom?Math.min(ze,fe.maxZoom):ze)}var rt={latlng:F,bounds:Q,timestamp:p.timestamp};for(var ct in p.coords)typeof p.coords[ct]=="number"&&(rt[ct]=p.coords[ct]);this.fire("locationfound",rt)}},addHandler:function(p,S){if(!S)return this;var O=this[p]=new S(this);return this._handlers.push(O),this.options[p]&&O.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ye(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(B(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var p;for(p in this._layers)this._layers[p].remove();for(p in this._panes)ye(this._panes[p]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(p,S){var O="leaflet-pane"+(p?" leaflet-"+p.replace("Pane","")+"-pane":""),F=Ce("div",O,S||this._mapPane);return p&&(this._panes[p]=F),F},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var p=this.getPixelBounds(),S=this.unproject(p.getBottomLeft()),O=this.unproject(p.getTopRight());return new ee(S,O)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(p,S,O){p=ve(p),O=U(O||[0,0]);var F=this.getZoom()||0,Q=this.getMinZoom(),fe=this.getMaxZoom(),ze=p.getNorthWest(),rt=p.getSouthEast(),ct=this.getSize().subtract(O),Rt=se(this.project(rt,F),this.project(ze,F)).getSize(),$t=me.any3d?this.options.zoomSnap:1,fi=ct.x/Rt.x,rr=ct.y/Rt.y,Gn=S?Math.max(fi,rr):Math.min(fi,rr);return F=this.getScaleZoom(Gn,F),$t&&(F=Math.round(F/($t/100))*($t/100),F=S?Math.ceil(F/$t)*$t:Math.floor(F/$t)*$t),Math.max(Q,Math.min(fe,F))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new V(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(p,S){var O=this._getTopLeftPoint(p,S);return new ie(O,O.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(p){return this.options.crs.getProjectedBounds(p===void 0?this.getZoom():p)},getPane:function(p){return typeof p=="string"?this._panes[p]:p},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(p,S){var O=this.options.crs;return S=S===void 0?this._zoom:S,O.scale(p)/O.scale(S)},getScaleZoom:function(p,S){var O=this.options.crs;S=S===void 0?this._zoom:S;var F=O.zoom(p*O.scale(S));return isNaN(F)?1/0:F},project:function(p,S){return S=S===void 0?this._zoom:S,this.options.crs.latLngToPoint(he(p),S)},unproject:function(p,S){return S=S===void 0?this._zoom:S,this.options.crs.pointToLatLng(U(p),S)},layerPointToLatLng:function(p){var S=U(p).add(this.getPixelOrigin());return this.unproject(S)},latLngToLayerPoint:function(p){var S=this.project(he(p))._round();return S._subtract(this.getPixelOrigin())},wrapLatLng:function(p){return this.options.crs.wrapLatLng(he(p))},wrapLatLngBounds:function(p){return this.options.crs.wrapLatLngBounds(ve(p))},distance:function(p,S){return this.options.crs.distance(he(p),he(S))},containerPointToLayerPoint:function(p){return U(p).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(p){return U(p).add(this._getMapPanePos())},containerPointToLatLng:function(p){var S=this.containerPointToLayerPoint(U(p));return this.layerPointToLatLng(S)},latLngToContainerPoint:function(p){return this.layerPointToContainerPoint(this.latLngToLayerPoint(he(p)))},mouseEventToContainerPoint:function(p){return bf(p,this._container)},mouseEventToLayerPoint:function(p){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(p))},mouseEventToLatLng:function(p){return this.layerPointToLatLng(this.mouseEventToLayerPoint(p))},_initContainer:function(p){var S=this._container=le(p);if(S){if(S._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ji(S,"scroll",this._onScroll,this),this._containerId=l(S)},_initLayout:function(){var p=this._container;this._fadeAnimated=this.options.fadeAnimation&&me.any3d,Di(p,"leaflet-container"+(me.touch?" leaflet-touch":"")+(me.retina?" leaflet-retina":"")+(me.ielt9?" leaflet-oldie":"")+(me.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var S=pe(p,"position");S!=="absolute"&&S!=="relative"&&S!=="fixed"&&S!=="sticky"&&(p.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var p=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),pn(this._mapPane,new V(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Di(p.markerPane,"leaflet-zoom-hide"),Di(p.shadowPane,"leaflet-zoom-hide"))},_resetView:function(p,S,O){pn(this._mapPane,new V(0,0));var F=!this._loaded;this._loaded=!0,S=this._limitZoom(S),this.fire("viewprereset");var Q=this._zoom!==S;this._moveStart(Q,O)._move(p,S)._moveEnd(Q),this.fire("viewreset"),F&&this.fire("load")},_moveStart:function(p,S){return p&&this.fire("zoomstart"),S||this.fire("movestart"),this},_move:function(p,S,O,F){S===void 0&&(S=this._zoom);var Q=this._zoom!==S;return this._zoom=S,this._lastCenter=p,this._pixelOrigin=this._getNewPixelOrigin(p),F?O&&O.pinch&&this.fire("zoom",O):((Q||O&&O.pinch)&&this.fire("zoom",O),this.fire("move",O)),this},_moveEnd:function(p){return p&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return B(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(p){pn(this._mapPane,this._getMapPanePos().subtract(p))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(p){this._targets={},this._targets[l(this._container)]=this;var S=p?zr:ji;S(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&S(window,"resize",this._onResize,this),me.any3d&&this.options.transform3DLimit&&(p?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){B(this._resizeRequest),this._resizeRequest=k(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var p=this._getMapPanePos();Math.max(Math.abs(p.x),Math.abs(p.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(p,S){for(var O=[],F,Q=S==="mouseout"||S==="mouseover",fe=p.target||p.srcElement,ze=!1;fe;){if(F=this._targets[l(fe)],F&&(S==="click"||S==="preclick")&&this._draggableMoved(F)){ze=!0;break}if(F&&F.listens(S,!0)&&(Q&&!Kh(fe,p)||(O.push(F),Q))||fe===this._container)break;fe=fe.parentNode}return!O.length&&!ze&&!Q&&this.listens(S,!0)&&(O=[this]),O},_isClickDisabled:function(p){for(;p&&p!==this._container;){if(p._leaflet_disable_click)return!0;p=p.parentNode}},_handleDOMEvent:function(p){var S=p.target||p.srcElement;if(!(!this._loaded||S._leaflet_disable_events||p.type==="click"&&this._isClickDisabled(S))){var O=p.type;O==="mousedown"&&kc(S),this._fireDOMEvent(p,O)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(p,S,O){if(p.type==="click"){var F=n({},p);F.type="preclick",this._fireDOMEvent(F,F.type,O)}var Q=this._findEventTargets(p,S);if(O){for(var fe=[],ze=0;ze<O.length;ze++)O[ze].listens(S,!0)&&fe.push(O[ze]);Q=fe.concat(Q)}if(Q.length){S==="contextmenu"&&Vi(p);var rt=Q[0],ct={originalEvent:p};if(p.type!=="keypress"&&p.type!=="keydown"&&p.type!=="keyup"){var Rt=rt.getLatLng&&(!rt._radius||rt._radius<=10);ct.containerPoint=Rt?this.latLngToContainerPoint(rt.getLatLng()):this.mouseEventToContainerPoint(p),ct.layerPoint=this.containerPointToLayerPoint(ct.containerPoint),ct.latlng=Rt?rt.getLatLng():this.layerPointToLatLng(ct.layerPoint)}for(ze=0;ze<Q.length;ze++)if(Q[ze].fire(S,ct,!0),ct.originalEvent._stopped||Q[ze].options.bubblingMouseEvents===!1&&C(this._mouseEvents,S)!==-1)return}},_draggableMoved:function(p){return p=p.dragging&&p.dragging.enabled()?p:this,p.dragging&&p.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var p=0,S=this._handlers.length;p<S;p++)this._handlers[p].disable()},whenReady:function(p,S){return this._loaded?p.call(S||this,{target:this}):this.on("load",p,S),this},_getMapPanePos:function(){return Ma(this._mapPane)||new V(0,0)},_moved:function(){var p=this._getMapPanePos();return p&&!p.equals([0,0])},_getTopLeftPoint:function(p,S){var O=p&&S!==void 0?this._getNewPixelOrigin(p,S):this.getPixelOrigin();return O.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(p,S){var O=this.getSize()._divideBy(2);return this.project(p,S)._subtract(O)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(p,S,O){var F=this._getNewPixelOrigin(O,S);return this.project(p,S)._subtract(F)},_latLngBoundsToNewLayerBounds:function(p,S,O){var F=this._getNewPixelOrigin(O,S);return se([this.project(p.getSouthWest(),S)._subtract(F),this.project(p.getNorthWest(),S)._subtract(F),this.project(p.getSouthEast(),S)._subtract(F),this.project(p.getNorthEast(),S)._subtract(F)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(p){return this.latLngToLayerPoint(p).subtract(this._getCenterLayerPoint())},_limitCenter:function(p,S,O){if(!O)return p;var F=this.project(p,S),Q=this.getSize().divideBy(2),fe=new ie(F.subtract(Q),F.add(Q)),ze=this._getBoundsOffset(fe,O,S);return Math.abs(ze.x)<=1&&Math.abs(ze.y)<=1?p:this.unproject(F.add(ze),S)},_limitOffset:function(p,S){if(!S)return p;var O=this.getPixelBounds(),F=new ie(O.min.add(p),O.max.add(p));return p.add(this._getBoundsOffset(F,S))},_getBoundsOffset:function(p,S,O){var F=se(this.project(S.getNorthEast(),O),this.project(S.getSouthWest(),O)),Q=F.min.subtract(p.min),fe=F.max.subtract(p.max),ze=this._rebound(Q.x,-fe.x),rt=this._rebound(Q.y,-fe.y);return new V(ze,rt)},_rebound:function(p,S){return p+S>0?Math.round(p-S)/2:Math.max(0,Math.ceil(p))-Math.max(0,Math.floor(S))},_limitZoom:function(p){var S=this.getMinZoom(),O=this.getMaxZoom(),F=me.any3d?this.options.zoomSnap:1;return F&&(p=Math.round(p/F)*F),Math.max(S,Math.min(O,p))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Dr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(p,S){var O=this._getCenterOffset(p)._trunc();return(S&&S.animate)!==!0&&!this.getSize().contains(O)?!1:(this.panBy(O,S),!0)},_createAnimProxy:function(){var p=this._proxy=Ce("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(p),this.on("zoomanim",function(S){var O=ra,F=this._proxy.style[O];rs(this._proxy,this.project(S.center,S.zoom),this.getZoomScale(S.zoom,1)),F===this._proxy.style[O]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ye(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var p=this.getCenter(),S=this.getZoom();rs(this._proxy,this.project(p,S),this.getZoomScale(S,1))},_catchTransitionEnd:function(p){this._animatingZoom&&p.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(p,S,O){if(this._animatingZoom)return!0;if(O=O||{},!this._zoomAnimated||O.animate===!1||this._nothingToAnimate()||Math.abs(S-this._zoom)>this.options.zoomAnimationThreshold)return!1;var F=this.getZoomScale(S),Q=this._getCenterOffset(p)._divideBy(1-1/F);return O.animate!==!0&&!this.getSize().contains(Q)?!1:(k(function(){this._moveStart(!0,O.noMoveStart||!1)._animateZoom(p,S,!0)},this),!0)},_animateZoom:function(p,S,O,F){this._mapPane&&(O&&(this._animatingZoom=!0,this._animateToCenter=p,this._animateToZoom=S,Di(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:p,zoom:S,noUpdate:F}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Dr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Sn(p,S){return new gr(p,S)}var sa=W.extend({options:{position:"topright"},initialize:function(p){g(this,p)},getPosition:function(){return this.options.position},setPosition:function(p){var S=this._map;return S&&S.removeControl(this),this.options.position=p,S&&S.addControl(this),this},getContainer:function(){return this._container},addTo:function(p){this.remove(),this._map=p;var S=this._container=this.onAdd(p),O=this.getPosition(),F=p._controlCorners[O];return Di(S,"leaflet-control"),O.indexOf("bottom")!==-1?F.insertBefore(S,F.firstChild):F.appendChild(S),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ye(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(p){this._map&&p&&p.screenX>0&&p.screenY>0&&this._map.getContainer().focus()}}),Pa=function(p){return new sa(p)};gr.include({addControl:function(p){return p.addTo(this),this},removeControl:function(p){return p.remove(),this},_initControlPos:function(){var p=this._controlCorners={},S="leaflet-",O=this._controlContainer=Ce("div",S+"control-container",this._container);function F(Q,fe){var ze=S+Q+" "+S+fe;p[Q+fe]=Ce("div",ze,O)}F("top","left"),F("top","right"),F("bottom","left"),F("bottom","right")},_clearControlPos:function(){for(var p in this._controlCorners)ye(this._controlCorners[p]);ye(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xm=sa.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(p,S,O,F){return O<F?-1:F<O?1:0}},initialize:function(p,S,O){g(this,O),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var F in p)this._addLayer(p[F],F);for(F in S)this._addLayer(S[F],F,!0)},onAdd:function(p){this._initLayout(),this._update(),this._map=p,p.on("zoomend",this._checkDisabledLayers,this);for(var S=0;S<this._layers.length;S++)this._layers[S].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(p){return sa.prototype.addTo.call(this,p),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(p,S){return this._addLayer(p,S),this._map?this._update():this},addOverlay:function(p,S){return this._addLayer(p,S,!0),this._map?this._update():this},removeLayer:function(p){p.off("add remove",this._onLayerChange,this);var S=this._getLayer(l(p));return S&&this._layers.splice(this._layers.indexOf(S),1),this._map?this._update():this},expand:function(){Di(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var p=this._map.getSize().y-(this._container.offsetTop+50);return p<this._section.clientHeight?(Di(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=p+"px"):Dr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Dr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var p="leaflet-control-layers",S=this._container=Ce("div",p),O=this.options.collapsed;S.setAttribute("aria-haspopup",!0),Xh(S),mm(S);var F=this._section=Ce("section",p+"-list");O&&(this._map.on("click",this.collapse,this),ji(S,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Q=this._layersLink=Ce("a",p+"-toggle",S);Q.href="#",Q.title="Layers",Q.setAttribute("role","button"),ji(Q,{keydown:function(fe){fe.keyCode===13&&this._expandSafely()},click:function(fe){Vi(fe),this._expandSafely()}},this),O||this.expand(),this._baseLayersList=Ce("div",p+"-base",F),this._separator=Ce("div",p+"-separator",F),this._overlaysList=Ce("div",p+"-overlays",F),S.appendChild(F)},_getLayer:function(p){for(var S=0;S<this._layers.length;S++)if(this._layers[S]&&l(this._layers[S].layer)===p)return this._layers[S]},_addLayer:function(p,S,O){this._map&&p.on("add remove",this._onLayerChange,this),this._layers.push({layer:p,name:S,overlay:O}),this.options.sortLayers&&this._layers.sort(a(function(F,Q){return this.options.sortFunction(F.layer,Q.layer,F.name,Q.name)},this)),this.options.autoZIndex&&p.setZIndex&&(this._lastZIndex++,p.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;We(this._baseLayersList),We(this._overlaysList),this._layerControlInputs=[];var p,S,O,F,Q=0;for(O=0;O<this._layers.length;O++)F=this._layers[O],this._addItem(F),S=S||F.overlay,p=p||!F.overlay,Q+=F.overlay?0:1;return this.options.hideSingleBase&&(p=p&&Q>1,this._baseLayersList.style.display=p?"":"none"),this._separator.style.display=S&&p?"":"none",this},_onLayerChange:function(p){this._handlingClick||this._update();var S=this._getLayer(l(p.target)),O=S.overlay?p.type==="add"?"overlayadd":"overlayremove":p.type==="add"?"baselayerchange":null;O&&this._map.fire(O,S)},_createRadioElement:function(p,S){var O='<input type="radio" class="leaflet-control-layers-selector" name="'+p+'"'+(S?' checked="checked"':"")+"/>",F=document.createElement("div");return F.innerHTML=O,F.firstChild},_addItem:function(p){var S=document.createElement("label"),O=this._map.hasLayer(p.layer),F;p.overlay?(F=document.createElement("input"),F.type="checkbox",F.className="leaflet-control-layers-selector",F.defaultChecked=O):F=this._createRadioElement("leaflet-base-layers_"+l(this),O),this._layerControlInputs.push(F),F.layerId=l(p.layer),ji(F,"click",this._onInputClick,this);var Q=document.createElement("span");Q.innerHTML=" "+p.name;var fe=document.createElement("span");S.appendChild(fe),fe.appendChild(F),fe.appendChild(Q);var ze=p.overlay?this._overlaysList:this._baseLayersList;return ze.appendChild(S),this._checkDisabledLayers(),S},_onInputClick:function(){if(!this._preventClick){var p=this._layerControlInputs,S,O,F=[],Q=[];this._handlingClick=!0;for(var fe=p.length-1;fe>=0;fe--)S=p[fe],O=this._getLayer(S.layerId).layer,S.checked?F.push(O):S.checked||Q.push(O);for(fe=0;fe<Q.length;fe++)this._map.hasLayer(Q[fe])&&this._map.removeLayer(Q[fe]);for(fe=0;fe<F.length;fe++)this._map.hasLayer(F[fe])||this._map.addLayer(F[fe]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var p=this._layerControlInputs,S,O,F=this._map.getZoom(),Q=p.length-1;Q>=0;Q--)S=p[Q],O=this._getLayer(S.layerId).layer,S.disabled=O.options.minZoom!==void 0&&F<O.options.minZoom||O.options.maxZoom!==void 0&&F>O.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var p=this._section;this._preventClick=!0,ji(p,"click",Vi),this.expand();var S=this;setTimeout(function(){zr(p,"click",Vi),S._preventClick=!1})}}),bm=function(p,S,O){return new xm(p,S,O)},aa=sa.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(p){var S="leaflet-control-zoom",O=Ce("div",S+" leaflet-bar"),F=this.options;return this._zoomInButton=this._createButton(F.zoomInText,F.zoomInTitle,S+"-in",O,this._zoomIn),this._zoomOutButton=this._createButton(F.zoomOutText,F.zoomOutTitle,S+"-out",O,this._zoomOut),this._updateDisabled(),p.on("zoomend zoomlevelschange",this._updateDisabled,this),O},onRemove:function(p){p.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(p){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(p.shiftKey?3:1))},_zoomOut:function(p){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(p.shiftKey?3:1))},_createButton:function(p,S,O,F,Q){var fe=Ce("a",O,F);return fe.innerHTML=p,fe.href="#",fe.title=S,fe.setAttribute("role","button"),fe.setAttribute("aria-label",S),Xh(fe),ji(fe,"click",mr),ji(fe,"click",Q,this),ji(fe,"click",this._refocusOnMap,this),fe},_updateDisabled:function(){var p=this._map,S="leaflet-disabled";Dr(this._zoomInButton,S),Dr(this._zoomOutButton,S),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||p._zoom===p.getMinZoom())&&(Di(this._zoomOutButton,S),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||p._zoom===p.getMaxZoom())&&(Di(this._zoomInButton,S),this._zoomInButton.setAttribute("aria-disabled","true"))}});gr.mergeOptions({zoomControl:!0}),gr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new aa,this.addControl(this.zoomControl))});var M=function(p){return new aa(p)},N=sa.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(p){var S="leaflet-control-scale",O=Ce("div",S),F=this.options;return this._addScales(F,S+"-line",O),p.on(F.updateWhenIdle?"moveend":"move",this._update,this),p.whenReady(this._update,this),O},onRemove:function(p){p.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(p,S,O){p.metric&&(this._mScale=Ce("div",S,O)),p.imperial&&(this._iScale=Ce("div",S,O))},_update:function(){var p=this._map,S=p.getSize().y/2,O=p.distance(p.containerPointToLatLng([0,S]),p.containerPointToLatLng([this.options.maxWidth,S]));this._updateScales(O)},_updateScales:function(p){this.options.metric&&p&&this._updateMetric(p),this.options.imperial&&p&&this._updateImperial(p)},_updateMetric:function(p){var S=this._getRoundNum(p),O=S<1e3?S+" m":S/1e3+" km";this._updateScale(this._mScale,O,S/p)},_updateImperial:function(p){var S=p*3.2808399,O,F,Q;S>5280?(O=S/5280,F=this._getRoundNum(O),this._updateScale(this._iScale,F+" mi",F/O)):(Q=this._getRoundNum(S),this._updateScale(this._iScale,Q+" ft",Q/S))},_updateScale:function(p,S,O){p.style.width=Math.round(this.options.maxWidth*O)+"px",p.innerHTML=S},_getRoundNum:function(p){var S=Math.pow(10,(Math.floor(p)+"").length-1),O=p/S;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:1,S*O}}),H=function(p){return new N(p)},K='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',re=sa.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(me.inlineSvg?K+" ":"")+"Leaflet</a>"},initialize:function(p){g(this,p),this._attributions={}},onAdd:function(p){p.attributionControl=this,this._container=Ce("div","leaflet-control-attribution"),Xh(this._container);for(var S in p._layers)p._layers[S].getAttribution&&this.addAttribution(p._layers[S].getAttribution());return this._update(),p.on("layeradd",this._addAttribution,this),this._container},onRemove:function(p){p.off("layeradd",this._addAttribution,this)},_addAttribution:function(p){p.layer.getAttribution&&(this.addAttribution(p.layer.getAttribution()),p.layer.once("remove",function(){this.removeAttribution(p.layer.getAttribution())},this))},setPrefix:function(p){return this.options.prefix=p,this._update(),this},addAttribution:function(p){return p?(this._attributions[p]||(this._attributions[p]=0),this._attributions[p]++,this._update(),this):this},removeAttribution:function(p){return p?(this._attributions[p]&&(this._attributions[p]--,this._update()),this):this},_update:function(){if(this._map){var p=[];for(var S in this._attributions)this._attributions[S]&&p.push(S);var O=[];this.options.prefix&&O.push(this.options.prefix),p.length&&O.push(p.join(", ")),this._container.innerHTML=O.join(' <span aria-hidden="true">|</span> ')}}});gr.mergeOptions({attributionControl:!0}),gr.addInitHook(function(){this.options.attributionControl&&new re().addTo(this)});var ne=function(p){return new re(p)};sa.Layers=xm,sa.Zoom=aa,sa.Scale=N,sa.Attribution=re,Pa.layers=bm,Pa.zoom=M,Pa.scale=H,Pa.attribution=ne;var ce=W.extend({initialize:function(p){this._map=p},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ce.addTo=function(p,S){return p.addHandler(S,this),this};var Be={Events:Z},Pe=me.touch?"touchstart mousedown":"mousedown",Ye=G.extend({options:{clickTolerance:3},initialize:function(p,S,O,F){g(this,F),this._element=p,this._dragStartTarget=S||p,this._preventOutline=O},enable:function(){this._enabled||(ji(this._dragStartTarget,Pe,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ye._dragging===this&&this.finishDrag(!0),zr(this._dragStartTarget,Pe,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(p){if(this._enabled&&(this._moved=!1,!Wu(this._element,"leaflet-zoom-anim"))){if(p.touches&&p.touches.length!==1){Ye._dragging===this&&this.finishDrag();return}if(!(Ye._dragging||p.shiftKey||p.which!==1&&p.button!==1&&!p.touches)&&(Ye._dragging=this,this._preventOutline&&kc(this._element),Wh(),Gu(),!this._moving)){this.fire("down");var S=p.touches?p.touches[0]:p,O=cm(this._element);this._startPoint=new V(S.clientX,S.clientY),this._startPos=Ma(this._element),this._parentScale=hm(O);var F=p.type==="mousedown";ji(document,F?"mousemove":"touchmove",this._onMove,this),ji(document,F?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(p){if(this._enabled){if(p.touches&&p.touches.length>1){this._moved=!0;return}var S=p.touches&&p.touches.length===1?p.touches[0]:p,O=new V(S.clientX,S.clientY)._subtract(this._startPoint);!O.x&&!O.y||Math.abs(O.x)+Math.abs(O.y)<this.options.clickTolerance||(O.x/=this._parentScale.x,O.y/=this._parentScale.y,Vi(p),this._moved||(this.fire("dragstart"),this._moved=!0,Di(document.body,"leaflet-dragging"),this._lastTarget=p.target||p.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Di(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(O),this._moving=!0,this._lastEvent=p,this._updatePosition())}},_updatePosition:function(){var p={originalEvent:this._lastEvent};this.fire("predrag",p),pn(this._element,this._newPos),this.fire("drag",p)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(p){Dr(document.body,"leaflet-dragging"),this._lastTarget&&(Dr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zr(document,"mousemove touchmove",this._onMove,this),zr(document,"mouseup touchend touchcancel",this._onUp,this),xf(),tl();var S=this._moved&&this._moving;this._moving=!1,Ye._dragging=!1,S&&this.fire("dragend",{noInertia:p,distance:this._newPos.distanceTo(this._startPos)})}});function ft(p,S,O){var F,Q=[1,4,2,8],fe,ze,rt,ct,Rt,$t,fi,rr;for(fe=0,$t=p.length;fe<$t;fe++)p[fe]._code=Gi(p[fe],S);for(rt=0;rt<4;rt++){for(fi=Q[rt],F=[],fe=0,$t=p.length,ze=$t-1;fe<$t;ze=fe++)ct=p[fe],Rt=p[ze],ct._code&fi?Rt._code&fi||(rr=Eo(Rt,ct,fi,S,O),rr._code=Gi(rr,S),F.push(rr)):(Rt._code&fi&&(rr=Eo(Rt,ct,fi,S,O),rr._code=Gi(rr,S),F.push(rr)),F.push(ct));p=F}return p}function bt(p,S){var O,F,Q,fe,ze,rt,ct,Rt,$t;if(!p||p.length===0)throw new Error("latlngs not passed");Bs(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var fi=he([0,0]),rr=ve(p),Gn=rr.getNorthWest().distanceTo(rr.getSouthWest())*rr.getNorthEast().distanceTo(rr.getNorthWest());Gn<1700&&(fi=at(p));var Dn=p.length,ua=[];for(O=0;O<Dn;O++){var Fs=he(p[O]);ua.push(S.project(he([Fs.lat-fi.lat,Fs.lng-fi.lng])))}for(rt=ct=Rt=0,O=0,F=Dn-1;O<Dn;F=O++)Q=ua[O],fe=ua[F],ze=Q.y*fe.x-fe.y*Q.x,ct+=(Q.x+fe.x)*ze,Rt+=(Q.y+fe.y)*ze,rt+=ze*3;rt===0?$t=ua[0]:$t=[ct/rt,Rt/rt];var jl=S.unproject(U($t));return he([jl.lat+fi.lat,jl.lng+fi.lng])}function at(p){for(var S=0,O=0,F=0,Q=0;Q<p.length;Q++){var fe=he(p[Q]);S+=fe.lat,O+=fe.lng,F++}return he([S/F,O/F])}var Nt={__proto__:null,clipPolygon:ft,polygonCenter:bt,centroid:at};function Kt(p,S){if(!S||!p.length)return p.slice();var O=S*S;return p=nl(p,O),p=ns(p,O),p}function Hi(p,S,O){return Math.sqrt(Fl(p,S,O,!0))}function Wi(p,S,O){return Fl(p,S,O)}function ns(p,S){var O=p.length,F=typeof Uint8Array<"u"?Uint8Array:Array,Q=new F(O);Q[0]=Q[O-1]=1,ln(p,Q,S,0,O-1);var fe,ze=[];for(fe=0;fe<O;fe++)Q[fe]&&ze.push(p[fe]);return ze}function ln(p,S,O,F,Q){var fe=0,ze,rt,ct;for(rt=F+1;rt<=Q-1;rt++)ct=Fl(p[rt],p[F],p[Q],!0),ct>fe&&(ze=rt,fe=ct);fe>O&&(S[ze]=1,ln(p,S,O,F,ze),ln(p,S,O,ze,Q))}function nl(p,S){for(var O=[p[0]],F=1,Q=0,fe=p.length;F<fe;F++)jr(p[F],p[Q])>S&&(O.push(p[F]),Q=F);return Q<fe-1&&O.push(p[fe-1]),O}var wo;function ar(p,S,O,F,Q){var fe=F?wo:Gi(p,O),ze=Gi(S,O),rt,ct,Rt;for(wo=ze;;){if(!(fe|ze))return[p,S];if(fe&ze)return!1;rt=fe||ze,ct=Eo(p,S,rt,O,Q),Rt=Gi(ct,O),rt===fe?(p=ct,fe=Rt):(S=ct,ze=Rt)}}function Eo(p,S,O,F,Q){var fe=S.x-p.x,ze=S.y-p.y,rt=F.min,ct=F.max,Rt,$t;return O&8?(Rt=p.x+fe*(ct.y-p.y)/ze,$t=ct.y):O&4?(Rt=p.x+fe*(rt.y-p.y)/ze,$t=rt.y):O&2?(Rt=ct.x,$t=p.y+ze*(ct.x-p.x)/fe):O&1&&(Rt=rt.x,$t=p.y+ze*(rt.x-p.x)/fe),new V(Rt,$t,Q)}function Gi(p,S){var O=0;return p.x<S.min.x?O|=1:p.x>S.max.x&&(O|=2),p.y<S.min.y?O|=4:p.y>S.max.y&&(O|=8),O}function jr(p,S){var O=S.x-p.x,F=S.y-p.y;return O*O+F*F}function Fl(p,S,O,F){var Q=S.x,fe=S.y,ze=O.x-Q,rt=O.y-fe,ct=ze*ze+rt*rt,Rt;return ct>0&&(Rt=((p.x-Q)*ze+(p.y-fe)*rt)/ct,Rt>1?(Q=O.x,fe=O.y):Rt>0&&(Q+=ze*Rt,fe+=rt*Rt)),ze=p.x-Q,rt=p.y-fe,F?ze*ze+rt*rt:new V(Q,fe)}function Bs(p){return!b(p[0])||typeof p[0][0]!="object"&&typeof p[0][0]<"u"}function Ka(p){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Bs(p)}function uu(p,S){var O,F,Q,fe,ze,rt,ct,Rt;if(!p||p.length===0)throw new Error("latlngs not passed");Bs(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var $t=he([0,0]),fi=ve(p),rr=fi.getNorthWest().distanceTo(fi.getSouthWest())*fi.getNorthEast().distanceTo(fi.getNorthWest());rr<1700&&($t=at(p));var Gn=p.length,Dn=[];for(O=0;O<Gn;O++){var ua=he(p[O]);Dn.push(S.project(he([ua.lat-$t.lat,ua.lng-$t.lng])))}for(O=0,F=0;O<Gn-1;O++)F+=Dn[O].distanceTo(Dn[O+1])/2;if(F===0)Rt=Dn[0];else for(O=0,fe=0;O<Gn-1;O++)if(ze=Dn[O],rt=Dn[O+1],Q=ze.distanceTo(rt),fe+=Q,fe>F){ct=(fe-F)/Q,Rt=[rt.x-ct*(rt.x-ze.x),rt.y-ct*(rt.y-ze.y)];break}var Fs=S.unproject(U(Rt));return he([Fs.lat+$t.lat,Fs.lng+$t.lng])}var $a={__proto__:null,simplify:Kt,pointToSegmentDistance:Hi,closestPointOnSegment:Wi,clipSegment:ar,_getEdgeIntersection:Eo,_getBitCode:Gi,_sqClosestPointOnSegment:Fl,isFlat:Bs,_flat:Ka,polylineCenter:uu},So={project:function(p){return new V(p.lng,p.lat)},unproject:function(p){return new _e(p.y,p.x)},bounds:new ie([-180,-90],[180,90])},sl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ie([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(p){var S=Math.PI/180,O=this.R,F=p.lat*S,Q=this.R_MINOR/O,fe=Math.sqrt(1-Q*Q),ze=fe*Math.sin(F),rt=Math.tan(Math.PI/4-F/2)/Math.pow((1-ze)/(1+ze),fe/2);return F=-O*Math.log(Math.max(rt,1e-10)),new V(p.lng*S*O,F)},unproject:function(p){for(var S=180/Math.PI,O=this.R,F=this.R_MINOR/O,Q=Math.sqrt(1-F*F),fe=Math.exp(-p.y/O),ze=Math.PI/2-2*Math.atan(fe),rt=0,ct=.1,Rt;rt<15&&Math.abs(ct)>1e-7;rt++)Rt=Q*Math.sin(ze),Rt=Math.pow((1-Rt)/(1+Rt),Q/2),ct=Math.PI/2-2*Math.atan(fe*Rt)-ze,ze+=ct;return new _e(ze*S,p.x*S/O)}},oa={__proto__:null,LonLat:So,Mercator:sl,SphericalMercator:Te},$h=n({},we,{code:"EPSG:3395",projection:sl,transformation:function(){var p=.5/(Math.PI*sl.R);return Xe(p,.5,-p,.5)}()}),al=n({},we,{code:"EPSG:4326",projection:So,transformation:Xe(1/180,1,-1/180,.5)}),ol=n({},De,{projection:So,transformation:Xe(1,0,-1,0),scale:function(p){return Math.pow(2,p)},zoom:function(p){return Math.log(p)/Math.LN2},distance:function(p,S){var O=S.lng-p.lng,F=S.lat-p.lat;return Math.sqrt(O*O+F*F)},infinite:!0});De.Earth=we,De.EPSG3395=$h,De.EPSG3857=et,De.EPSG900913=Ze,De.EPSG4326=al,De.Simple=ol;var un=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(p){return p.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(p){return p&&p.removeLayer(this),this},getPane:function(p){return this._map.getPane(p?this.options[p]||p:this.options.pane)},addInteractiveTarget:function(p){return this._map._targets[l(p)]=this,this},removeInteractiveTarget:function(p){return delete this._map._targets[l(p)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(p){var S=p.target;if(S.hasLayer(this)){if(this._map=S,this._zoomAnimated=S._zoomAnimated,this.getEvents){var O=this.getEvents();S.on(O,this),this.once("remove",function(){S.off(O,this)},this)}this.onAdd(S),this.fire("add"),S.fire("layeradd",{layer:this})}}});gr.include({addLayer:function(p){if(!p._layerAdd)throw new Error("The provided object is not a Layer.");var S=l(p);return this._layers[S]?this:(this._layers[S]=p,p._mapToAdd=this,p.beforeAdd&&p.beforeAdd(this),this.whenReady(p._layerAdd,p),this)},removeLayer:function(p){var S=l(p);return this._layers[S]?(this._loaded&&p.onRemove(this),delete this._layers[S],this._loaded&&(this.fire("layerremove",{layer:p}),p.fire("remove")),p._map=p._mapToAdd=null,this):this},hasLayer:function(p){return l(p)in this._layers},eachLayer:function(p,S){for(var O in this._layers)p.call(S,this._layers[O]);return this},_addLayers:function(p){p=p?b(p)?p:[p]:[];for(var S=0,O=p.length;S<O;S++)this.addLayer(p[S])},_addZoomLimit:function(p){(!isNaN(p.options.maxZoom)||!isNaN(p.options.minZoom))&&(this._zoomBoundLayers[l(p)]=p,this._updateZoomLevels())},_removeZoomLimit:function(p){var S=l(p);this._zoomBoundLayers[S]&&(delete this._zoomBoundLayers[S],this._updateZoomLevels())},_updateZoomLevels:function(){var p=1/0,S=-1/0,O=this._getZoomSpan();for(var F in this._zoomBoundLayers){var Q=this._zoomBoundLayers[F].options;p=Q.minZoom===void 0?p:Math.min(p,Q.minZoom),S=Q.maxZoom===void 0?S:Math.max(S,Q.maxZoom)}this._layersMaxZoom=S===-1/0?void 0:S,this._layersMinZoom=p===1/0?void 0:p,O!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var cu=un.extend({initialize:function(p,S){g(this,S),this._layers={};var O,F;if(p)for(O=0,F=p.length;O<F;O++)this.addLayer(p[O])},addLayer:function(p){var S=this.getLayerId(p);return this._layers[S]=p,this._map&&this._map.addLayer(p),this},removeLayer:function(p){var S=p in this._layers?p:this.getLayerId(p);return this._map&&this._layers[S]&&this._map.removeLayer(this._layers[S]),delete this._layers[S],this},hasLayer:function(p){var S=typeof p=="number"?p:this.getLayerId(p);return S in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(p){var S=Array.prototype.slice.call(arguments,1),O,F;for(O in this._layers)F=this._layers[O],F[p]&&F[p].apply(F,S);return this},onAdd:function(p){this.eachLayer(p.addLayer,p)},onRemove:function(p){this.eachLayer(p.removeLayer,p)},eachLayer:function(p,S){for(var O in this._layers)p.call(S,this._layers[O]);return this},getLayer:function(p){return this._layers[p]},getLayers:function(){var p=[];return this.eachLayer(p.push,p),p},setZIndex:function(p){return this.invoke("setZIndex",p)},getLayerId:function(p){return l(p)}}),Zh=function(p,S){return new cu(p,S)},ir=cu.extend({addLayer:function(p){return this.hasLayer(p)?this:(p.addEventParent(this),cu.prototype.addLayer.call(this,p),this.fire("layeradd",{layer:p}))},removeLayer:function(p){return this.hasLayer(p)?(p in this._layers&&(p=this._layers[p]),p.removeEventParent(this),cu.prototype.removeLayer.call(this,p),this.fire("layerremove",{layer:p})):this},setStyle:function(p){return this.invoke("setStyle",p)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var p=new ee;for(var S in this._layers){var O=this._layers[S];p.extend(O.getBounds?O.getBounds():O.getLatLng())}return p}}),Qh=function(p,S){return new ir(p,S)},_s=W.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(p){g(this,p)},createIcon:function(p){return this._createIcon("icon",p)},createShadow:function(p){return this._createIcon("shadow",p)},_createIcon:function(p,S){var O=this._getIconUrl(p);if(!O){if(p==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var F=this._createImg(O,S&&S.tagName==="IMG"?S:null);return this._setIconStyles(F,p),(this.options.crossOrigin||this.options.crossOrigin==="")&&(F.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),F},_setIconStyles:function(p,S){var O=this.options,F=O[S+"Size"];typeof F=="number"&&(F=[F,F]);var Q=U(F),fe=U(S==="shadow"&&O.shadowAnchor||O.iconAnchor||Q&&Q.divideBy(2,!0));p.className="leaflet-marker-"+S+" "+(O.className||""),fe&&(p.style.marginLeft=-fe.x+"px",p.style.marginTop=-fe.y+"px"),Q&&(p.style.width=Q.x+"px",p.style.height=Q.y+"px")},_createImg:function(p,S){return S=S||document.createElement("img"),S.src=p,S},_getIconUrl:function(p){return me.retina&&this.options[p+"RetinaUrl"]||this.options[p+"Url"]}});function Bc(p){return new _s(p)}var Jh=_s.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(p){return typeof Jh.imagePath!="string"&&(Jh.imagePath=this._detectIconPath()),(this.options.imagePath||Jh.imagePath)+_s.prototype._getIconUrl.call(this,p)},_stripUrl:function(p){var S=function(O,F,Q){var fe=F.exec(O);return fe&&fe[Q]};return p=S(p,/^url\((['"])?(.+)\1\)$/,2),p&&S(p,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var p=Ce("div","leaflet-default-icon-path",document.body),S=pe(p,"background-image")||pe(p,"backgroundImage");if(document.body.removeChild(p),S=this._stripUrl(S),S)return S;var O=document.querySelector('link[href$="leaflet.css"]');return O?O.href.substring(0,O.href.length-11-1):""}}),Ev=ce.extend({initialize:function(p){this._marker=p},addHooks:function(){var p=this._marker._icon;this._draggable||(this._draggable=new Ye(p,p,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Di(p,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Dr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(p){var S=this._marker,O=S._map,F=this._marker.options.autoPanSpeed,Q=this._marker.options.autoPanPadding,fe=Ma(S._icon),ze=O.getPixelBounds(),rt=O.getPixelOrigin(),ct=se(ze.min._subtract(rt).add(Q),ze.max._subtract(rt).subtract(Q));if(!ct.contains(fe)){var Rt=U((Math.max(ct.max.x,fe.x)-ct.max.x)/(ze.max.x-ct.max.x)-(Math.min(ct.min.x,fe.x)-ct.min.x)/(ze.min.x-ct.min.x),(Math.max(ct.max.y,fe.y)-ct.max.y)/(ze.max.y-ct.max.y)-(Math.min(ct.min.y,fe.y)-ct.min.y)/(ze.min.y-ct.min.y)).multiplyBy(F);O.panBy(Rt,{animate:!1}),this._draggable._newPos._add(Rt),this._draggable._startPos._add(Rt),pn(S._icon,this._draggable._newPos),this._onDrag(p),this._panRequest=k(this._adjustPan.bind(this,p))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(p){this._marker.options.autoPan&&(B(this._panRequest),this._panRequest=k(this._adjustPan.bind(this,p)))},_onDrag:function(p){var S=this._marker,O=S._shadow,F=Ma(S._icon),Q=S._map.layerPointToLatLng(F);O&&pn(O,F),S._latlng=Q,p.latlng=Q,p.oldLatLng=this._oldLatLng,S.fire("move",p).fire("drag",p)},_onDragEnd:function(p){B(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",p)}}),ed=un.extend({options:{icon:new Jh,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(p,S){g(this,S),this._latlng=he(p)},onAdd:function(p){this._zoomAnimated=this._zoomAnimated&&p.options.markerZoomAnimation,this._zoomAnimated&&p.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(p){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&p.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(p){var S=this._latlng;return this._latlng=he(p),this.update(),this.fire("move",{oldLatLng:S,latlng:this._latlng})},setZIndexOffset:function(p){return this.options.zIndexOffset=p,this.update()},getIcon:function(){return this.options.icon},setIcon:function(p){return this.options.icon=p,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var p=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(p)}return this},_initIcon:function(){var p=this.options,S="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),O=p.icon.createIcon(this._icon),F=!1;O!==this._icon&&(this._icon&&this._removeIcon(),F=!0,p.title&&(O.title=p.title),O.tagName==="IMG"&&(O.alt=p.alt||"")),Di(O,S),p.keyboard&&(O.tabIndex="0",O.setAttribute("role","button")),this._icon=O,p.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ji(O,"focus",this._panOnFocus,this);var Q=p.icon.createShadow(this._shadow),fe=!1;Q!==this._shadow&&(this._removeShadow(),fe=!0),Q&&(Di(Q,S),Q.alt=""),this._shadow=Q,p.opacity<1&&this._updateOpacity(),F&&this.getPane().appendChild(this._icon),this._initInteraction(),Q&&fe&&this.getPane(p.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zr(this._icon,"focus",this._panOnFocus,this),ye(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ye(this._shadow),this._shadow=null},_setPos:function(p){this._icon&&pn(this._icon,p),this._shadow&&pn(this._shadow,p),this._zIndex=p.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(p){this._icon&&(this._icon.style.zIndex=this._zIndex+p)},_animateZoom:function(p){var S=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center).round();this._setPos(S)},_initInteraction:function(){if(this.options.interactive&&(Di(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ev)){var p=this.options.draggable;this.dragging&&(p=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ev(this),p&&this.dragging.enable()}},setOpacity:function(p){return this.options.opacity=p,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var p=this.options.opacity;this._icon&&na(this._icon,p),this._shadow&&na(this._shadow,p)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var p=this._map;if(p){var S=this.options.icon.options,O=S.iconSize?U(S.iconSize):U(0,0),F=S.iconAnchor?U(S.iconAnchor):U(0,0);p.panInside(this._latlng,{paddingTopLeft:F,paddingBottomRight:O.subtract(F)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Za(p,S){return new ed(p,S)}var ll=un.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(p){this._renderer=p.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(p){return g(this,p),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&p&&Object.prototype.hasOwnProperty.call(p,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),To=ll.extend({options:{fill:!0,radius:10},initialize:function(p,S){g(this,S),this._latlng=he(p),this._radius=this.options.radius},setLatLng:function(p){var S=this._latlng;return this._latlng=he(p),this.redraw(),this.fire("move",{oldLatLng:S,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(p){return this.options.radius=this._radius=p,this.redraw()},getRadius:function(){return this._radius},setStyle:function(p){var S=p&&p.radius||this._radius;return ll.prototype.setStyle.call(this,p),this.setRadius(S),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var p=this._radius,S=this._radiusY||p,O=this._clickTolerance(),F=[p+O,S+O];this._pxBounds=new ie(this._point.subtract(F),this._point.add(F))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(p){return p.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function _f(p,S){return new To(p,S)}var hu=To.extend({initialize:function(p,S,O){if(typeof S=="number"&&(S=n({},O,{radius:S})),g(this,S),this._latlng=he(p),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(p){return this._mRadius=p,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var p=[this._radius,this._radiusY||this._radius];return new ee(this._map.layerPointToLatLng(this._point.subtract(p)),this._map.layerPointToLatLng(this._point.add(p)))},setStyle:ll.prototype.setStyle,_project:function(){var p=this._latlng.lng,S=this._latlng.lat,O=this._map,F=O.options.crs;if(F.distance===we.distance){var Q=Math.PI/180,fe=this._mRadius/we.R/Q,ze=O.project([S+fe,p]),rt=O.project([S-fe,p]),ct=ze.add(rt).divideBy(2),Rt=O.unproject(ct).lat,$t=Math.acos((Math.cos(fe*Q)-Math.sin(S*Q)*Math.sin(Rt*Q))/(Math.cos(S*Q)*Math.cos(Rt*Q)))/Q;(isNaN($t)||$t===0)&&($t=fe/Math.cos(Math.PI/180*S)),this._point=ct.subtract(O.getPixelOrigin()),this._radius=isNaN($t)?0:ct.x-O.project([Rt,p-$t]).x,this._radiusY=ct.y-ze.y}else{var fi=F.unproject(F.project(this._latlng).subtract([this._mRadius,0]));this._point=O.latLngToLayerPoint(this._latlng),this._radius=this._point.x-O.latLngToLayerPoint(fi).x}this._updateBounds()}});function Co(p,S,O){return new hu(p,S,O)}var zs=ll.extend({options:{smoothFactor:1,noClip:!1},initialize:function(p,S){g(this,S),this._setLatLngs(p)},getLatLngs:function(){return this._latlngs},setLatLngs:function(p){return this._setLatLngs(p),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(p){for(var S=1/0,O=null,F=Fl,Q,fe,ze=0,rt=this._parts.length;ze<rt;ze++)for(var ct=this._parts[ze],Rt=1,$t=ct.length;Rt<$t;Rt++){Q=ct[Rt-1],fe=ct[Rt];var fi=F(p,Q,fe,!0);fi<S&&(S=fi,O=F(p,Q,fe))}return O&&(O.distance=Math.sqrt(S)),O},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return uu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(p,S){return S=S||this._defaultShape(),p=he(p),S.push(p),this._bounds.extend(p),this.redraw()},_setLatLngs:function(p){this._bounds=new ee,this._latlngs=this._convertLatLngs(p)},_defaultShape:function(){return Bs(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(p){for(var S=[],O=Bs(p),F=0,Q=p.length;F<Q;F++)O?(S[F]=he(p[F]),this._bounds.extend(S[F])):S[F]=this._convertLatLngs(p[F]);return S},_project:function(){var p=new ie;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,p),this._bounds.isValid()&&p.isValid()&&(this._rawPxBounds=p,this._updateBounds())},_updateBounds:function(){var p=this._clickTolerance(),S=new V(p,p);this._rawPxBounds&&(this._pxBounds=new ie([this._rawPxBounds.min.subtract(S),this._rawPxBounds.max.add(S)]))},_projectLatlngs:function(p,S,O){var F=p[0]instanceof _e,Q=p.length,fe,ze;if(F){for(ze=[],fe=0;fe<Q;fe++)ze[fe]=this._map.latLngToLayerPoint(p[fe]),O.extend(ze[fe]);S.push(ze)}else for(fe=0;fe<Q;fe++)this._projectLatlngs(p[fe],S,O)},_clipPoints:function(){var p=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}var S=this._parts,O,F,Q,fe,ze,rt,ct;for(O=0,Q=0,fe=this._rings.length;O<fe;O++)for(ct=this._rings[O],F=0,ze=ct.length;F<ze-1;F++)rt=ar(ct[F],ct[F+1],p,F,!0),rt&&(S[Q]=S[Q]||[],S[Q].push(rt[0]),(rt[1]!==ct[F+1]||F===ze-2)&&(S[Q].push(rt[1]),Q++))}},_simplifyPoints:function(){for(var p=this._parts,S=this.options.smoothFactor,O=0,F=p.length;O<F;O++)p[O]=Kt(p[O],S)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(p,S){var O,F,Q,fe,ze,rt,ct=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(O=0,fe=this._parts.length;O<fe;O++)for(rt=this._parts[O],F=0,ze=rt.length,Q=ze-1;F<ze;Q=F++)if(!(!S&&F===0)&&Hi(p,rt[Q],rt[F])<=ct)return!0;return!1}});function _m(p,S){return new zs(p,S)}zs._flat=Ka;var zc=zs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bt(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(p){var S=zs.prototype._convertLatLngs.call(this,p),O=S.length;return O>=2&&S[0]instanceof _e&&S[0].equals(S[O-1])&&S.pop(),S},_setLatLngs:function(p){zs.prototype._setLatLngs.call(this,p),Bs(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Bs(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var p=this._renderer._bounds,S=this.options.weight,O=new V(S,S);if(p=new ie(p.min.subtract(O),p.max.add(O)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}for(var F=0,Q=this._rings.length,fe;F<Q;F++)fe=ft(this._rings[F],p,!0),fe.length&&this._parts.push(fe)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(p){var S=!1,O,F,Q,fe,ze,rt,ct,Rt;if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(fe=0,ct=this._parts.length;fe<ct;fe++)for(O=this._parts[fe],ze=0,Rt=O.length,rt=Rt-1;ze<Rt;rt=ze++)F=O[ze],Q=O[rt],F.y>p.y!=Q.y>p.y&&p.x<(Q.x-F.x)*(p.y-F.y)/(Q.y-F.y)+F.x&&(S=!S);return S||zs.prototype._containsPoint.call(this,p,!0)}});function wf(p,S){return new zc(p,S)}var ws=ir.extend({initialize:function(p,S){g(this,S),this._layers={},p&&this.addData(p)},addData:function(p){var S=b(p)?p:p.features,O,F,Q;if(S){for(O=0,F=S.length;O<F;O++)Q=S[O],(Q.geometries||Q.geometry||Q.features||Q.coordinates)&&this.addData(Q);return this}var fe=this.options;if(fe.filter&&!fe.filter(p))return this;var ze=Es(p,fe);return ze?(ze.feature=ut(p),ze.defaultOptions=ze.options,this.resetStyle(ze),fe.onEachFeature&&fe.onEachFeature(p,ze),this.addLayer(ze)):this},resetStyle:function(p){return p===void 0?this.eachLayer(this.resetStyle,this):(p.options=n({},p.defaultOptions),this._setLayerStyle(p,this.options.style),this)},setStyle:function(p){return this.eachLayer(function(S){this._setLayerStyle(S,p)},this)},_setLayerStyle:function(p,S){p.setStyle&&(typeof S=="function"&&(S=S(p.feature)),p.setStyle(S))}});function Es(p,S){var O=p.type==="Feature"?p.geometry:p,F=O?O.coordinates:null,Q=[],fe=S&&S.pointToLayer,ze=S&&S.coordsToLatLng||td,rt,ct,Rt,$t;if(!F&&!O)return null;switch(O.type){case"Point":return rt=ze(F),wm(fe,p,rt,S);case"MultiPoint":for(Rt=0,$t=F.length;Rt<$t;Rt++)rt=ze(F[Rt]),Q.push(wm(fe,p,rt,S));return new ir(Q);case"LineString":case"MultiLineString":return ct=id(F,O.type==="LineString"?0:1,ze),new zs(ct,S);case"Polygon":case"MultiPolygon":return ct=id(F,O.type==="Polygon"?1:2,ze),new zc(ct,S);case"GeometryCollection":for(Rt=0,$t=O.geometries.length;Rt<$t;Rt++){var fi=Es({geometry:O.geometries[Rt],type:"Feature",properties:p.properties},S);fi&&Q.push(fi)}return new ir(Q);case"FeatureCollection":for(Rt=0,$t=O.features.length;Rt<$t;Rt++){var rr=Es(O.features[Rt],S);rr&&Q.push(rr)}return new ir(Q);default:throw new Error("Invalid GeoJSON object.")}}function wm(p,S,O,F){return p?p(S,O):new ed(O,F&&F.markersInheritOptions&&F)}function td(p){return new _e(p[1],p[0],p[2])}function id(p,S,O){for(var F=[],Q=0,fe=p.length,ze;Q<fe;Q++)ze=S?id(p[Q],S-1,O):(O||td)(p[Q]),F.push(ze);return F}function Se(p,S){return p=he(p),p.alt!==void 0?[d(p.lng,S),d(p.lat,S),d(p.alt,S)]:[d(p.lng,S),d(p.lat,S)]}function Ve(p,S,O,F){for(var Q=[],fe=0,ze=p.length;fe<ze;fe++)Q.push(S?Ve(p[fe],Bs(p[fe])?0:S-1,O,F):Se(p[fe],F));return!S&&O&&Q.length>0&&Q.push(Q[0].slice()),Q}function it(p,S){return p.feature?n({},p.feature,{geometry:S}):ut(S)}function ut(p){return p.type==="Feature"||p.type==="FeatureCollection"?p:{type:"Feature",properties:{},geometry:p}}var be={toGeoJSON:function(p){return it(this,{type:"Point",coordinates:Se(this.getLatLng(),p)})}};ed.include(be),hu.include(be),To.include(be),zs.include({toGeoJSON:function(p){var S=!Bs(this._latlngs),O=Ve(this._latlngs,S?1:0,!1,p);return it(this,{type:(S?"Multi":"")+"LineString",coordinates:O})}}),zc.include({toGeoJSON:function(p){var S=!Bs(this._latlngs),O=S&&!Bs(this._latlngs[0]),F=Ve(this._latlngs,O?2:S?1:0,!0,p);return S||(F=[F]),it(this,{type:(O?"Multi":"")+"Polygon",coordinates:F})}}),cu.include({toMultiPoint:function(p){var S=[];return this.eachLayer(function(O){S.push(O.toGeoJSON(p).geometry.coordinates)}),it(this,{type:"MultiPoint",coordinates:S})},toGeoJSON:function(p){var S=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(S==="MultiPoint")return this.toMultiPoint(p);var O=S==="GeometryCollection",F=[];return this.eachLayer(function(Q){if(Q.toGeoJSON){var fe=Q.toGeoJSON(p);if(O)F.push(fe.geometry);else{var ze=ut(fe);ze.type==="FeatureCollection"?F.push.apply(F,ze.features):F.push(ze)}}}),O?it(this,{geometries:F,type:"GeometryCollection"}):{type:"FeatureCollection",features:F}}});function je(p,S){return new ws(p,S)}var Fe=je,vt=un.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(p,S,O){this._url=p,this._bounds=ve(S),g(this,O)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Di(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ye(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(p){return this.options.opacity=p,this._image&&this._updateOpacity(),this},setStyle:function(p){return p.opacity&&this.setOpacity(p.opacity),this},bringToFront:function(){return this._map&&Ct(this._image),this},bringToBack:function(){return this._map&&En(this._image),this},setUrl:function(p){return this._url=p,this._image&&(this._image.src=p),this},setBounds:function(p){return this._bounds=ve(p),this._map&&this._reset(),this},getEvents:function(){var p={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var p=this._url.tagName==="IMG",S=this._image=p?this._url:Ce("img");if(Di(S,"leaflet-image-layer"),this._zoomAnimated&&Di(S,"leaflet-zoom-animated"),this.options.className&&Di(S,this.options.className),S.onselectstart=h,S.onmousemove=h,S.onload=a(this.fire,this,"load"),S.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),p){this._url=S.src;return}S.src=this._url,S.alt=this.options.alt},_animateZoom:function(p){var S=this._map.getZoomScale(p.zoom),O=this._map._latLngBoundsToNewLayerBounds(this._bounds,p.zoom,p.center).min;rs(this._image,O,S)},_reset:function(){var p=this._image,S=new ie(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),O=S.getSize();pn(p,S.min),p.style.width=O.x+"px",p.style.height=O.y+"px"},_updateOpacity:function(){na(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var p=this.options.errorOverlayUrl;p&&this._url!==p&&(this._url=p,this._image.src=p)},getCenter:function(){return this._bounds.getCenter()}}),Tt=function(p,S,O){return new vt(p,S,O)},Jt=vt.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var p=this._url.tagName==="VIDEO",S=this._image=p?this._url:Ce("video");if(Di(S,"leaflet-image-layer"),this._zoomAnimated&&Di(S,"leaflet-zoom-animated"),this.options.className&&Di(S,this.options.className),S.onselectstart=h,S.onmousemove=h,S.onloadeddata=a(this.fire,this,"load"),p){for(var O=S.getElementsByTagName("source"),F=[],Q=0;Q<O.length;Q++)F.push(O[Q].src);this._url=O.length>0?F:[S.src];return}b(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(S.style,"objectFit")&&(S.style.objectFit="fill"),S.autoplay=!!this.options.autoplay,S.loop=!!this.options.loop,S.muted=!!this.options.muted,S.playsInline=!!this.options.playsInline;for(var fe=0;fe<this._url.length;fe++){var ze=Ce("source");ze.src=this._url[fe],S.appendChild(ze)}}});function ii(p,S,O){return new Jt(p,S,O)}var Gt=vt.extend({_initImage:function(){var p=this._image=this._url;Di(p,"leaflet-image-layer"),this._zoomAnimated&&Di(p,"leaflet-zoom-animated"),this.options.className&&Di(p,this.options.className),p.onselectstart=h,p.onmousemove=h}});function er(p,S,O){return new Gt(p,S,O)}var si=un.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(p,S){p&&(p instanceof _e||b(p))?(this._latlng=he(p),g(this,S)):(g(this,p),this._source=S),this.options.content&&(this._content=this.options.content)},openOn:function(p){return p=arguments.length?p:this._source._map,p.hasLayer(this)||p.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(p){return this._map?this.close():(arguments.length?this._source=p:p=this._source,this._prepareOpen(),this.openOn(p._map)),this},onAdd:function(p){this._zoomAnimated=p._zoomAnimated,this._container||this._initLayout(),p._fadeAnimated&&na(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),p._fadeAnimated&&na(this._container,1),this.bringToFront(),this.options.interactive&&(Di(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(p){p._fadeAnimated?(na(this._container,0),this._removeTimeout=setTimeout(a(ye,void 0,this._container),200)):ye(this._container),this.options.interactive&&(Dr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(p){return this._latlng=he(p),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(p){return this._content=p,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var p={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ct(this._container),this},bringToBack:function(){return this._map&&En(this._container),this},_prepareOpen:function(p){var S=this._source;if(!S._map)return!1;if(S instanceof ir){S=null;var O=this._source._layers;for(var F in O)if(O[F]._map){S=O[F];break}if(!S)return!1;this._source=S}if(!p)if(S.getCenter)p=S.getCenter();else if(S.getLatLng)p=S.getLatLng();else if(S.getBounds)p=S.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(p),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var p=this._contentNode,S=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof S=="string")p.innerHTML=S;else{for(;p.hasChildNodes();)p.removeChild(p.firstChild);p.appendChild(S)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var p=this._map.latLngToLayerPoint(this._latlng),S=U(this.options.offset),O=this._getAnchor();this._zoomAnimated?pn(this._container,p.add(O)):S=S.add(p).add(O);var F=this._containerBottom=-S.y,Q=this._containerLeft=-Math.round(this._containerWidth/2)+S.x;this._container.style.bottom=F+"px",this._container.style.left=Q+"px"}},_getAnchor:function(){return[0,0]}});gr.include({_initOverlay:function(p,S,O,F){var Q=S;return Q instanceof p||(Q=new p(F).setContent(S)),O&&Q.setLatLng(O),Q}}),un.include({_initOverlay:function(p,S,O,F){var Q=O;return Q instanceof p?(g(Q,F),Q._source=this):(Q=S&&!F?S:new p(F,this),Q.setContent(O)),Q}});var Zi=si.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(p){return p=arguments.length?p:this._source._map,!p.hasLayer(this)&&p._popup&&p._popup.options.autoClose&&p.removeLayer(p._popup),p._popup=this,si.prototype.openOn.call(this,p)},onAdd:function(p){si.prototype.onAdd.call(this,p),p.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ll||this._source.on("preclick",qu))},onRemove:function(p){si.prototype.onRemove.call(this,p),p.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ll||this._source.off("preclick",qu))},getEvents:function(){var p=si.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(p.preclick=this.close),this.options.keepInView&&(p.moveend=this._adjustPan),p},_initLayout:function(){var p="leaflet-popup",S=this._container=Ce("div",p+" "+(this.options.className||"")+" leaflet-zoom-animated"),O=this._wrapper=Ce("div",p+"-content-wrapper",S);if(this._contentNode=Ce("div",p+"-content",O),Xh(S),mm(this._contentNode),ji(S,"contextmenu",qu),this._tipContainer=Ce("div",p+"-tip-container",S),this._tip=Ce("div",p+"-tip",this._tipContainer),this.options.closeButton){var F=this._closeButton=Ce("a",p+"-close-button",S);F.setAttribute("role","button"),F.setAttribute("aria-label","Close popup"),F.href="#close",F.innerHTML='<span aria-hidden="true">&#215;</span>',ji(F,"click",function(Q){Vi(Q),this.close()},this)}},_updateLayout:function(){var p=this._contentNode,S=p.style;S.width="",S.whiteSpace="nowrap";var O=p.offsetWidth;O=Math.min(O,this.options.maxWidth),O=Math.max(O,this.options.minWidth),S.width=O+1+"px",S.whiteSpace="",S.height="";var F=p.offsetHeight,Q=this.options.maxHeight,fe="leaflet-popup-scrolled";Q&&F>Q?(S.height=Q+"px",Di(p,fe)):Dr(p,fe),this._containerWidth=this._container.offsetWidth},_animateZoom:function(p){var S=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center),O=this._getAnchor();pn(this._container,S.add(O))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var p=this._map,S=parseInt(pe(this._container,"marginBottom"),10)||0,O=this._container.offsetHeight+S,F=this._containerWidth,Q=new V(this._containerLeft,-O-this._containerBottom);Q._add(Ma(this._container));var fe=p.layerPointToContainerPoint(Q),ze=U(this.options.autoPanPadding),rt=U(this.options.autoPanPaddingTopLeft||ze),ct=U(this.options.autoPanPaddingBottomRight||ze),Rt=p.getSize(),$t=0,fi=0;fe.x+F+ct.x>Rt.x&&($t=fe.x+F-Rt.x+ct.x),fe.x-$t-rt.x<0&&($t=fe.x-rt.x),fe.y+O+ct.y>Rt.y&&(fi=fe.y+O-Rt.y+ct.y),fe.y-fi-rt.y<0&&(fi=fe.y-rt.y),($t||fi)&&(this.options.keepInView&&(this._autopanning=!0),p.fire("autopanstart").panBy([$t,fi]))}},_getAnchor:function(){return U(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ss=function(p,S){return new Zi(p,S)};gr.mergeOptions({closePopupOnClick:!0}),gr.include({openPopup:function(p,S,O){return this._initOverlay(Zi,p,S,O).openOn(this),this},closePopup:function(p){return p=arguments.length?p:this._popup,p&&p.close(),this}}),un.include({bindPopup:function(p,S){return this._popup=this._initOverlay(Zi,this._popup,p,S),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(p){return this._popup&&(this instanceof ir||(this._popup._source=this),this._popup._prepareOpen(p||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(p){return this._popup&&this._popup.setContent(p),this},getPopup:function(){return this._popup},_openPopup:function(p){if(!(!this._popup||!this._map)){mr(p);var S=p.layer||p.target;if(this._popup._source===S&&!(S instanceof ll)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(p.latlng);return}this._popup._source=S,this.openPopup(p.latlng)}},_movePopup:function(p){this._popup.setLatLng(p.latlng)},_onKeyPress:function(p){p.originalEvent.keyCode===13&&this._openPopup(p)}});var Nn=si.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(p){si.prototype.onAdd.call(this,p),this.setOpacity(this.options.opacity),p.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(p){si.prototype.onRemove.call(this,p),p.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var p=si.prototype.getEvents.call(this);return this.options.permanent||(p.preclick=this.close),p},_initLayout:function(){var p="leaflet-tooltip",S=p+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ce("div",S),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(p){var S,O,F=this._map,Q=this._container,fe=F.latLngToContainerPoint(F.getCenter()),ze=F.layerPointToContainerPoint(p),rt=this.options.direction,ct=Q.offsetWidth,Rt=Q.offsetHeight,$t=U(this.options.offset),fi=this._getAnchor();rt==="top"?(S=ct/2,O=Rt):rt==="bottom"?(S=ct/2,O=0):rt==="center"?(S=ct/2,O=Rt/2):rt==="right"?(S=0,O=Rt/2):rt==="left"?(S=ct,O=Rt/2):ze.x<fe.x?(rt="right",S=0,O=Rt/2):(rt="left",S=ct+($t.x+fi.x)*2,O=Rt/2),p=p.subtract(U(S,O,!0)).add($t).add(fi),Dr(Q,"leaflet-tooltip-right"),Dr(Q,"leaflet-tooltip-left"),Dr(Q,"leaflet-tooltip-top"),Dr(Q,"leaflet-tooltip-bottom"),Di(Q,"leaflet-tooltip-"+rt),pn(Q,p)},_updatePosition:function(){var p=this._map.latLngToLayerPoint(this._latlng);this._setPosition(p)},setOpacity:function(p){this.options.opacity=p,this._container&&na(this._container,p)},_animateZoom:function(p){var S=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center);this._setPosition(S)},_getAnchor:function(){return U(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),as=function(p,S){return new Nn(p,S)};gr.include({openTooltip:function(p,S,O){return this._initOverlay(Nn,p,S,O).openOn(this),this},closeTooltip:function(p){return p.close(),this}}),un.include({bindTooltip:function(p,S){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Nn,this._tooltip,p,S),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(p){if(!(!p&&this._tooltipHandlersAdded)){var S=p?"off":"on",O={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?O.add=this._openTooltip:(O.mouseover=this._openTooltip,O.mouseout=this.closeTooltip,O.click=this._openTooltip,this._map?this._addFocusListeners():O.add=this._addFocusListeners),this._tooltip.options.sticky&&(O.mousemove=this._moveTooltip),this[S](O),this._tooltipHandlersAdded=!p}},openTooltip:function(p){return this._tooltip&&(this instanceof ir||(this._tooltip._source=this),this._tooltip._prepareOpen(p)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(p){return this._tooltip&&this._tooltip.setContent(p),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(p){var S=typeof p.getElement=="function"&&p.getElement();S&&(ji(S,"focus",function(){this._tooltip._source=p,this.openTooltip()},this),ji(S,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(p){var S=typeof p.getElement=="function"&&p.getElement();S&&S.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(p){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var S=this;this._map.once("moveend",function(){S._openOnceFlag=!1,S._openTooltip(p)});return}this._tooltip._source=p.layer||p.target,this.openTooltip(this._tooltip.options.sticky?p.latlng:void 0)}},_moveTooltip:function(p){var S=p.latlng,O,F;this._tooltip.options.sticky&&p.originalEvent&&(O=this._map.mouseEventToContainerPoint(p.originalEvent),F=this._map.containerPointToLayerPoint(O),S=this._map.layerPointToLatLng(F)),this._tooltip.setLatLng(S)}});var la=_s.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(p){var S=p&&p.tagName==="DIV"?p:document.createElement("div"),O=this.options;if(O.html instanceof Element?(We(S),S.appendChild(O.html)):S.innerHTML=O.html!==!1?O.html:"",O.bgPos){var F=U(O.bgPos);S.style.backgroundPosition=-F.x+"px "+-F.y+"px"}return this._setIconStyles(S,"icon"),S},createShadow:function(){return null}});function Ul(p){return new la(p)}_s.Default=Jh;var Ai=un.extend({options:{tileSize:256,opacity:1,updateWhenIdle:me.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(p){g(this,p)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(p){p._addZoomLimit(this)},onRemove:function(p){this._removeAllTiles(),ye(this._container),p._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ct(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(En(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(p){return this.options.opacity=p,this._updateOpacity(),this},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var p=this._clampZoom(this._map.getZoom());p!==this._tileZoom&&(this._tileZoom=p,this._updateLevels()),this._update()}return this},getEvents:function(){var p={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),p.move=this._onMove),this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},createTile:function(){return document.createElement("div")},getTileSize:function(){var p=this.options.tileSize;return p instanceof V?p:new V(p,p)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(p){for(var S=this.getPane().children,O=-p(-1/0,1/0),F=0,Q=S.length,fe;F<Q;F++)fe=S[F].style.zIndex,S[F]!==this._container&&fe&&(O=p(O,+fe));isFinite(O)&&(this.options.zIndex=O+p(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!me.ielt9){na(this._container,this.options.opacity);var p=+new Date,S=!1,O=!1;for(var F in this._tiles){var Q=this._tiles[F];if(!(!Q.current||!Q.loaded)){var fe=Math.min(1,(p-Q.loaded)/200);na(Q.el,fe),fe<1?S=!0:(Q.active?O=!0:this._onOpaqueTile(Q),Q.active=!0)}}O&&!this._noPrune&&this._pruneTiles(),S&&(B(this._fadeFrame),this._fadeFrame=k(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=Ce("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var p=this._tileZoom,S=this.options.maxZoom;if(p!==void 0){for(var O in this._levels)O=Number(O),this._levels[O].el.children.length||O===p?(this._levels[O].el.style.zIndex=S-Math.abs(p-O),this._onUpdateLevel(O)):(ye(this._levels[O].el),this._removeTilesAtZoom(O),this._onRemoveLevel(O),delete this._levels[O]);var F=this._levels[p],Q=this._map;return F||(F=this._levels[p]={},F.el=Ce("div","leaflet-tile-container leaflet-zoom-animated",this._container),F.el.style.zIndex=S,F.origin=Q.project(Q.unproject(Q.getPixelOrigin()),p).round(),F.zoom=p,this._setZoomTransform(F,Q.getCenter(),Q.getZoom()),h(F.el.offsetWidth),this._onCreateLevel(F)),this._level=F,F}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var p,S,O=this._map.getZoom();if(O>this.options.maxZoom||O<this.options.minZoom){this._removeAllTiles();return}for(p in this._tiles)S=this._tiles[p],S.retain=S.current;for(p in this._tiles)if(S=this._tiles[p],S.current&&!S.active){var F=S.coords;this._retainParent(F.x,F.y,F.z,F.z-5)||this._retainChildren(F.x,F.y,F.z,F.z+2)}for(p in this._tiles)this._tiles[p].retain||this._removeTile(p)}},_removeTilesAtZoom:function(p){for(var S in this._tiles)this._tiles[S].coords.z===p&&this._removeTile(S)},_removeAllTiles:function(){for(var p in this._tiles)this._removeTile(p)},_invalidateAll:function(){for(var p in this._levels)ye(this._levels[p].el),this._onRemoveLevel(Number(p)),delete this._levels[p];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(p,S,O,F){var Q=Math.floor(p/2),fe=Math.floor(S/2),ze=O-1,rt=new V(+Q,+fe);rt.z=+ze;var ct=this._tileCoordsToKey(rt),Rt=this._tiles[ct];return Rt&&Rt.active?(Rt.retain=!0,!0):(Rt&&Rt.loaded&&(Rt.retain=!0),ze>F?this._retainParent(Q,fe,ze,F):!1)},_retainChildren:function(p,S,O,F){for(var Q=2*p;Q<2*p+2;Q++)for(var fe=2*S;fe<2*S+2;fe++){var ze=new V(Q,fe);ze.z=O+1;var rt=this._tileCoordsToKey(ze),ct=this._tiles[rt];if(ct&&ct.active){ct.retain=!0;continue}else ct&&ct.loaded&&(ct.retain=!0);O+1<F&&this._retainChildren(Q,fe,O+1,F)}},_resetView:function(p){var S=p&&(p.pinch||p.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),S,S)},_animateZoom:function(p){this._setView(p.center,p.zoom,!0,p.noUpdate)},_clampZoom:function(p){var S=this.options;return S.minNativeZoom!==void 0&&p<S.minNativeZoom?S.minNativeZoom:S.maxNativeZoom!==void 0&&S.maxNativeZoom<p?S.maxNativeZoom:p},_setView:function(p,S,O,F){var Q=Math.round(S);this.options.maxZoom!==void 0&&Q>this.options.maxZoom||this.options.minZoom!==void 0&&Q<this.options.minZoom?Q=void 0:Q=this._clampZoom(Q);var fe=this.options.updateWhenZooming&&Q!==this._tileZoom;(!F||fe)&&(this._tileZoom=Q,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Q!==void 0&&this._update(p),O||this._pruneTiles(),this._noPrune=!!O),this._setZoomTransforms(p,S)},_setZoomTransforms:function(p,S){for(var O in this._levels)this._setZoomTransform(this._levels[O],p,S)},_setZoomTransform:function(p,S,O){var F=this._map.getZoomScale(O,p.zoom),Q=p.origin.multiplyBy(F).subtract(this._map._getNewPixelOrigin(S,O)).round();me.any3d?rs(p.el,Q,F):pn(p.el,Q)},_resetGrid:function(){var p=this._map,S=p.options.crs,O=this._tileSize=this.getTileSize(),F=this._tileZoom,Q=this._map.getPixelWorldBounds(this._tileZoom);Q&&(this._globalTileRange=this._pxBoundsToTileRange(Q)),this._wrapX=S.wrapLng&&!this.options.noWrap&&[Math.floor(p.project([0,S.wrapLng[0]],F).x/O.x),Math.ceil(p.project([0,S.wrapLng[1]],F).x/O.y)],this._wrapY=S.wrapLat&&!this.options.noWrap&&[Math.floor(p.project([S.wrapLat[0],0],F).y/O.x),Math.ceil(p.project([S.wrapLat[1],0],F).y/O.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(p){var S=this._map,O=S._animatingZoom?Math.max(S._animateToZoom,S.getZoom()):S.getZoom(),F=S.getZoomScale(O,this._tileZoom),Q=S.project(p,this._tileZoom).floor(),fe=S.getSize().divideBy(F*2);return new ie(Q.subtract(fe),Q.add(fe))},_update:function(p){var S=this._map;if(S){var O=this._clampZoom(S.getZoom());if(p===void 0&&(p=S.getCenter()),this._tileZoom!==void 0){var F=this._getTiledPixelBounds(p),Q=this._pxBoundsToTileRange(F),fe=Q.getCenter(),ze=[],rt=this.options.keepBuffer,ct=new ie(Q.getBottomLeft().subtract([rt,-rt]),Q.getTopRight().add([rt,-rt]));if(!(isFinite(Q.min.x)&&isFinite(Q.min.y)&&isFinite(Q.max.x)&&isFinite(Q.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Rt in this._tiles){var $t=this._tiles[Rt].coords;($t.z!==this._tileZoom||!ct.contains(new V($t.x,$t.y)))&&(this._tiles[Rt].current=!1)}if(Math.abs(O-this._tileZoom)>1){this._setView(p,O);return}for(var fi=Q.min.y;fi<=Q.max.y;fi++)for(var rr=Q.min.x;rr<=Q.max.x;rr++){var Gn=new V(rr,fi);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var Dn=this._tiles[this._tileCoordsToKey(Gn)];Dn?Dn.current=!0:ze.push(Gn)}}if(ze.sort(function(Fs,jl){return Fs.distanceTo(fe)-jl.distanceTo(fe)}),ze.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ua=document.createDocumentFragment();for(rr=0;rr<ze.length;rr++)this._addTile(ze[rr],ua);this._level.el.appendChild(ua)}}}},_isValidTile:function(p){var S=this._map.options.crs;if(!S.infinite){var O=this._globalTileRange;if(!S.wrapLng&&(p.x<O.min.x||p.x>O.max.x)||!S.wrapLat&&(p.y<O.min.y||p.y>O.max.y))return!1}if(!this.options.bounds)return!0;var F=this._tileCoordsToBounds(p);return ve(this.options.bounds).overlaps(F)},_keyToBounds:function(p){return this._tileCoordsToBounds(this._keyToTileCoords(p))},_tileCoordsToNwSe:function(p){var S=this._map,O=this.getTileSize(),F=p.scaleBy(O),Q=F.add(O),fe=S.unproject(F,p.z),ze=S.unproject(Q,p.z);return[fe,ze]},_tileCoordsToBounds:function(p){var S=this._tileCoordsToNwSe(p),O=new ee(S[0],S[1]);return this.options.noWrap||(O=this._map.wrapLatLngBounds(O)),O},_tileCoordsToKey:function(p){return p.x+":"+p.y+":"+p.z},_keyToTileCoords:function(p){var S=p.split(":"),O=new V(+S[0],+S[1]);return O.z=+S[2],O},_removeTile:function(p){var S=this._tiles[p];S&&(ye(S.el),delete this._tiles[p],this.fire("tileunload",{tile:S.el,coords:this._keyToTileCoords(p)}))},_initTile:function(p){Di(p,"leaflet-tile");var S=this.getTileSize();p.style.width=S.x+"px",p.style.height=S.y+"px",p.onselectstart=h,p.onmousemove=h,me.ielt9&&this.options.opacity<1&&na(p,this.options.opacity)},_addTile:function(p,S){var O=this._getTilePos(p),F=this._tileCoordsToKey(p),Q=this.createTile(this._wrapCoords(p),a(this._tileReady,this,p));this._initTile(Q),this.createTile.length<2&&k(a(this._tileReady,this,p,null,Q)),pn(Q,O),this._tiles[F]={el:Q,coords:p,current:!0},S.appendChild(Q),this.fire("tileloadstart",{tile:Q,coords:p})},_tileReady:function(p,S,O){S&&this.fire("tileerror",{error:S,tile:O,coords:p});var F=this._tileCoordsToKey(p);O=this._tiles[F],O&&(O.loaded=+new Date,this._map._fadeAnimated?(na(O.el,0),B(this._fadeFrame),this._fadeFrame=k(this._updateOpacity,this)):(O.active=!0,this._pruneTiles()),S||(Di(O.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:O.el,coords:p})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),me.ielt9||!this._map._fadeAnimated?k(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(p){return p.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(p){var S=new V(this._wrapX?c(p.x,this._wrapX):p.x,this._wrapY?c(p.y,this._wrapY):p.y);return S.z=p.z,S},_pxBoundsToTileRange:function(p){var S=this.getTileSize();return new ie(p.min.unscaleBy(S).floor(),p.max.unscaleBy(S).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var p in this._tiles)if(!this._tiles[p].loaded)return!1;return!0}});function y2(p){return new Ai(p)}var rd=Ai.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(p,S){this._url=p,S=g(this,S),S.detectRetina&&me.retina&&S.maxZoom>0?(S.tileSize=Math.floor(S.tileSize/2),S.zoomReverse?(S.zoomOffset--,S.minZoom=Math.min(S.maxZoom,S.minZoom+1)):(S.zoomOffset++,S.maxZoom=Math.max(S.minZoom,S.maxZoom-1)),S.minZoom=Math.max(0,S.minZoom)):S.zoomReverse?S.minZoom=Math.min(S.maxZoom,S.minZoom):S.maxZoom=Math.max(S.minZoom,S.maxZoom),typeof S.subdomains=="string"&&(S.subdomains=S.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(p,S){return this._url===p&&S===void 0&&(S=!0),this._url=p,S||this.redraw(),this},createTile:function(p,S){var O=document.createElement("img");return ji(O,"load",a(this._tileOnLoad,this,S,O)),ji(O,"error",a(this._tileOnError,this,S,O)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(O.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(O.referrerPolicy=this.options.referrerPolicy),O.alt="",O.src=this.getTileUrl(p),O},getTileUrl:function(p){var S={r:me.retina?"@2x":"",s:this._getSubdomain(p),x:p.x,y:p.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var O=this._globalTileRange.max.y-p.y;this.options.tms&&(S.y=O),S["-y"]=O}return w(this._url,n(S,this.options))},_tileOnLoad:function(p,S){me.ielt9?setTimeout(a(p,this,null,S),0):p(null,S)},_tileOnError:function(p,S,O){var F=this.options.errorTileUrl;F&&S.getAttribute("src")!==F&&(S.src=F),p(O,S)},_onTileRemove:function(p){p.tile.onload=null},_getZoomForUrl:function(){var p=this._tileZoom,S=this.options.maxZoom,O=this.options.zoomReverse,F=this.options.zoomOffset;return O&&(p=S-p),p+F},_getSubdomain:function(p){var S=Math.abs(p.x+p.y)%this.options.subdomains.length;return this.options.subdomains[S]},_abortLoading:function(){var p,S;for(p in this._tiles)if(this._tiles[p].coords.z!==this._tileZoom&&(S=this._tiles[p].el,S.onload=h,S.onerror=h,!S.complete)){S.src=A;var O=this._tiles[p].coords;ye(S),delete this._tiles[p],this.fire("tileabort",{tile:S,coords:O})}},_removeTile:function(p){var S=this._tiles[p];if(S)return S.el.setAttribute("src",A),Ai.prototype._removeTile.call(this,p)},_tileReady:function(p,S,O){if(!(!this._map||O&&O.getAttribute("src")===A))return Ai.prototype._tileReady.call(this,p,S,O)}});function Em(p,S){return new rd(p,S)}var bw=rd.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(p,S){this._url=p;var O=n({},this.defaultWmsParams);for(var F in S)F in this.options||(O[F]=S[F]);S=g(this,S);var Q=S.detectRetina&&me.retina?2:1,fe=this.getTileSize();O.width=fe.x*Q,O.height=fe.y*Q,this.wmsParams=O},onAdd:function(p){this._crs=this.options.crs||p.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var S=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[S]=this._crs.code,rd.prototype.onAdd.call(this,p)},getTileUrl:function(p){var S=this._tileCoordsToNwSe(p),O=this._crs,F=se(O.project(S[0]),O.project(S[1])),Q=F.min,fe=F.max,ze=(this._wmsVersion>=1.3&&this._crs===al?[Q.y,Q.x,fe.y,fe.x]:[Q.x,Q.y,fe.x,fe.y]).join(","),rt=rd.prototype.getTileUrl.call(this,p);return rt+y(this.wmsParams,rt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ze},setParams:function(p,S){return n(this.wmsParams,p),S||this.redraw(),this}});function x2(p,S){return new bw(p,S)}rd.WMS=bw,Em.wms=x2;var Yu=un.extend({options:{padding:.1},initialize:function(p){g(this,p),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Di(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var p={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(p.zoomanim=this._onAnimZoom),p},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(p,S){var O=this._map.getZoomScale(S,this._zoom),F=this._map.getSize().multiplyBy(.5+this.options.padding),Q=this._map.project(this._center,S),fe=F.multiplyBy(-O).add(Q).subtract(this._map._getNewPixelOrigin(p,S));me.any3d?rs(this._container,fe,O):pn(this._container,fe)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var p in this._layers)this._layers[p]._reset()},_onZoomEnd:function(){for(var p in this._layers)this._layers[p]._project()},_updatePaths:function(){for(var p in this._layers)this._layers[p]._update()},_update:function(){var p=this.options.padding,S=this._map.getSize(),O=this._map.containerPointToLayerPoint(S.multiplyBy(-p)).round();this._bounds=new ie(O,O.add(S.multiplyBy(1+p*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Sm=Yu.extend({options:{tolerance:0},getEvents:function(){var p=Yu.prototype.getEvents.call(this);return p.viewprereset=this._onViewPreReset,p},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Yu.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var p=this._container=document.createElement("canvas");ji(p,"mousemove",this._onMouseMove,this),ji(p,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ji(p,"mouseout",this._handleMouseOut,this),p._leaflet_disable_events=!0,this._ctx=p.getContext("2d")},_destroyContainer:function(){B(this._redrawRequest),delete this._ctx,ye(this._container),zr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var p;this._redrawBounds=null;for(var S in this._layers)p=this._layers[S],p._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Yu.prototype._update.call(this);var p=this._bounds,S=this._container,O=p.getSize(),F=me.retina?2:1;pn(S,p.min),S.width=F*O.x,S.height=F*O.y,S.style.width=O.x+"px",S.style.height=O.y+"px",me.retina&&this._ctx.scale(2,2),this._ctx.translate(-p.min.x,-p.min.y),this.fire("update")}},_reset:function(){Yu.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(p){this._updateDashArray(p),this._layers[l(p)]=p;var S=p._order={layer:p,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=S),this._drawLast=S,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(p){this._requestRedraw(p)},_removePath:function(p){var S=p._order,O=S.next,F=S.prev;O?O.prev=F:this._drawLast=F,F?F.next=O:this._drawFirst=O,delete p._order,delete this._layers[l(p)],this._requestRedraw(p)},_updatePath:function(p){this._extendRedrawBounds(p),p._project(),p._update(),this._requestRedraw(p)},_updateStyle:function(p){this._updateDashArray(p),this._requestRedraw(p)},_updateDashArray:function(p){if(typeof p.options.dashArray=="string"){var S=p.options.dashArray.split(/[, ]+/),O=[],F,Q;for(Q=0;Q<S.length;Q++){if(F=Number(S[Q]),isNaN(F))return;O.push(F)}p.options._dashArray=O}else p.options._dashArray=p.options.dashArray},_requestRedraw:function(p){this._map&&(this._extendRedrawBounds(p),this._redrawRequest=this._redrawRequest||k(this._redraw,this))},_extendRedrawBounds:function(p){if(p._pxBounds){var S=(p.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ie,this._redrawBounds.extend(p._pxBounds.min.subtract([S,S])),this._redrawBounds.extend(p._pxBounds.max.add([S,S]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var p=this._redrawBounds;if(p){var S=p.getSize();this._ctx.clearRect(p.min.x,p.min.y,S.x,S.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var p,S=this._redrawBounds;if(this._ctx.save(),S){var O=S.getSize();this._ctx.beginPath(),this._ctx.rect(S.min.x,S.min.y,O.x,O.y),this._ctx.clip()}this._drawing=!0;for(var F=this._drawFirst;F;F=F.next)p=F.layer,(!S||p._pxBounds&&p._pxBounds.intersects(S))&&p._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(p,S){if(this._drawing){var O,F,Q,fe,ze=p._parts,rt=ze.length,ct=this._ctx;if(rt){for(ct.beginPath(),O=0;O<rt;O++){for(F=0,Q=ze[O].length;F<Q;F++)fe=ze[O][F],ct[F?"lineTo":"moveTo"](fe.x,fe.y);S&&ct.closePath()}this._fillStroke(ct,p)}}},_updateCircle:function(p){if(!(!this._drawing||p._empty())){var S=p._point,O=this._ctx,F=Math.max(Math.round(p._radius),1),Q=(Math.max(Math.round(p._radiusY),1)||F)/F;Q!==1&&(O.save(),O.scale(1,Q)),O.beginPath(),O.arc(S.x,S.y/Q,F,0,Math.PI*2,!1),Q!==1&&O.restore(),this._fillStroke(O,p)}},_fillStroke:function(p,S){var O=S.options;O.fill&&(p.globalAlpha=O.fillOpacity,p.fillStyle=O.fillColor||O.color,p.fill(O.fillRule||"evenodd")),O.stroke&&O.weight!==0&&(p.setLineDash&&p.setLineDash(S.options&&S.options._dashArray||[]),p.globalAlpha=O.opacity,p.lineWidth=O.weight,p.strokeStyle=O.color,p.lineCap=O.lineCap,p.lineJoin=O.lineJoin,p.stroke())},_onClick:function(p){for(var S=this._map.mouseEventToLayerPoint(p),O,F,Q=this._drawFirst;Q;Q=Q.next)O=Q.layer,O.options.interactive&&O._containsPoint(S)&&(!(p.type==="click"||p.type==="preclick")||!this._map._draggableMoved(O))&&(F=O);this._fireEvent(F?[F]:!1,p)},_onMouseMove:function(p){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var S=this._map.mouseEventToLayerPoint(p);this._handleMouseHover(p,S)}},_handleMouseOut:function(p){var S=this._hoveredLayer;S&&(Dr(this._container,"leaflet-interactive"),this._fireEvent([S],p,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(p,S){if(!this._mouseHoverThrottled){for(var O,F,Q=this._drawFirst;Q;Q=Q.next)O=Q.layer,O.options.interactive&&O._containsPoint(S)&&(F=O);F!==this._hoveredLayer&&(this._handleMouseOut(p),F&&(Di(this._container,"leaflet-interactive"),this._fireEvent([F],p,"mouseover"),this._hoveredLayer=F)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,p),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(p,S,O){this._map._fireDOMEvent(S,O||S.type,p)},_bringToFront:function(p){var S=p._order;if(S){var O=S.next,F=S.prev;if(O)O.prev=F;else return;F?F.next=O:O&&(this._drawFirst=O),S.prev=this._drawLast,this._drawLast.next=S,S.next=null,this._drawLast=S,this._requestRedraw(p)}},_bringToBack:function(p){var S=p._order;if(S){var O=S.next,F=S.prev;if(F)F.next=O;else return;O?O.prev=F:F&&(this._drawLast=F),S.prev=null,S.next=this._drawFirst,this._drawFirst.prev=S,this._drawFirst=S,this._requestRedraw(p)}}});function Xu(p){return me.canvas?new Sm(p):null}var Fc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(p){return document.createElement("<lvml:"+p+' class="lvml">')}}catch{}return function(p){return document.createElement("<"+p+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),_w={_initContainer:function(){this._container=Ce("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Yu.prototype._update.call(this),this.fire("update"))},_initPath:function(p){var S=p._container=Fc("shape");Di(S,"leaflet-vml-shape "+(this.options.className||"")),S.coordsize="1 1",p._path=Fc("path"),S.appendChild(p._path),this._updateStyle(p),this._layers[l(p)]=p},_addPath:function(p){var S=p._container;this._container.appendChild(S),p.options.interactive&&p.addInteractiveTarget(S)},_removePath:function(p){var S=p._container;ye(S),p.removeInteractiveTarget(S),delete this._layers[l(p)]},_updateStyle:function(p){var S=p._stroke,O=p._fill,F=p.options,Q=p._container;Q.stroked=!!F.stroke,Q.filled=!!F.fill,F.stroke?(S||(S=p._stroke=Fc("stroke")),Q.appendChild(S),S.weight=F.weight+"px",S.color=F.color,S.opacity=F.opacity,F.dashArray?S.dashStyle=b(F.dashArray)?F.dashArray.join(" "):F.dashArray.replace(/( *, *)/g," "):S.dashStyle="",S.endcap=F.lineCap.replace("butt","flat"),S.joinstyle=F.lineJoin):S&&(Q.removeChild(S),p._stroke=null),F.fill?(O||(O=p._fill=Fc("fill")),Q.appendChild(O),O.color=F.fillColor||F.color,O.opacity=F.fillOpacity):O&&(Q.removeChild(O),p._fill=null)},_updateCircle:function(p){var S=p._point.round(),O=Math.round(p._radius),F=Math.round(p._radiusY||O);this._setPath(p,p._empty()?"M0 0":"AL "+S.x+","+S.y+" "+O+","+F+" 0,"+65535*360)},_setPath:function(p,S){p._path.v=S},_bringToFront:function(p){Ct(p._container)},_bringToBack:function(p){En(p._container)}},nd=me.vml?Fc:st,Ef=Yu.extend({_initContainer:function(){this._container=nd("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=nd("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ye(this._container),zr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Yu.prototype._update.call(this);var p=this._bounds,S=p.getSize(),O=this._container;(!this._svgSize||!this._svgSize.equals(S))&&(this._svgSize=S,O.setAttribute("width",S.x),O.setAttribute("height",S.y)),pn(O,p.min),O.setAttribute("viewBox",[p.min.x,p.min.y,S.x,S.y].join(" ")),this.fire("update")}},_initPath:function(p){var S=p._path=nd("path");p.options.className&&Di(S,p.options.className),p.options.interactive&&Di(S,"leaflet-interactive"),this._updateStyle(p),this._layers[l(p)]=p},_addPath:function(p){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(p._path),p.addInteractiveTarget(p._path)},_removePath:function(p){ye(p._path),p.removeInteractiveTarget(p._path),delete this._layers[l(p)]},_updatePath:function(p){p._project(),p._update()},_updateStyle:function(p){var S=p._path,O=p.options;S&&(O.stroke?(S.setAttribute("stroke",O.color),S.setAttribute("stroke-opacity",O.opacity),S.setAttribute("stroke-width",O.weight),S.setAttribute("stroke-linecap",O.lineCap),S.setAttribute("stroke-linejoin",O.lineJoin),O.dashArray?S.setAttribute("stroke-dasharray",O.dashArray):S.removeAttribute("stroke-dasharray"),O.dashOffset?S.setAttribute("stroke-dashoffset",O.dashOffset):S.removeAttribute("stroke-dashoffset")):S.setAttribute("stroke","none"),O.fill?(S.setAttribute("fill",O.fillColor||O.color),S.setAttribute("fill-opacity",O.fillOpacity),S.setAttribute("fill-rule",O.fillRule||"evenodd")):S.setAttribute("fill","none"))},_updatePoly:function(p,S){this._setPath(p,_t(p._parts,S))},_updateCircle:function(p){var S=p._point,O=Math.max(Math.round(p._radius),1),F=Math.max(Math.round(p._radiusY),1)||O,Q="a"+O+","+F+" 0 1,0 ",fe=p._empty()?"M0 0":"M"+(S.x-O)+","+S.y+Q+O*2+",0 "+Q+-O*2+",0 ";this._setPath(p,fe)},_setPath:function(p,S){p._path.setAttribute("d",S)},_bringToFront:function(p){Ct(p._path)},_bringToBack:function(p){En(p._path)}});me.vml&&Ef.include(_w);function S1(p){return me.svg||me.vml?new Ef(p):null}gr.include({getRenderer:function(p){var S=p.options.renderer||this._getPaneRenderer(p.options.pane)||this.options.renderer||this._renderer;return S||(S=this._renderer=this._createRenderer()),this.hasLayer(S)||this.addLayer(S),S},_getPaneRenderer:function(p){if(p==="overlayPane"||p===void 0)return!1;var S=this._paneRenderers[p];return S===void 0&&(S=this._createRenderer({pane:p}),this._paneRenderers[p]=S),S},_createRenderer:function(p){return this.options.preferCanvas&&Xu(p)||S1(p)}});var Tm=zc.extend({initialize:function(p,S){zc.prototype.initialize.call(this,this._boundsToLatLngs(p),S)},setBounds:function(p){return this.setLatLngs(this._boundsToLatLngs(p))},_boundsToLatLngs:function(p){return p=ve(p),[p.getSouthWest(),p.getNorthWest(),p.getNorthEast(),p.getSouthEast()]}});function ww(p,S){return new Tm(p,S)}Ef.create=nd,Ef.pointsToPath=_t,ws.geometryToLayer=Es,ws.coordsToLatLng=td,ws.coordsToLatLngs=id,ws.latLngToCoords=Se,ws.latLngsToCoords=Ve,ws.getFeature=it,ws.asFeature=ut,gr.mergeOptions({boxZoom:!0});var Sf=ce.extend({initialize:function(p){this._map=p,this._container=p._container,this._pane=p._panes.overlayPane,this._resetStateTimeout=0,p.on("unload",this._destroy,this)},addHooks:function(){ji(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ye(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(p){if(!p.shiftKey||p.which!==1&&p.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Gu(),Wh(),this._startPoint=this._map.mouseEventToContainerPoint(p),ji(document,{contextmenu:mr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(p){this._moved||(this._moved=!0,this._box=Ce("div","leaflet-zoom-box",this._container),Di(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(p);var S=new ie(this._point,this._startPoint),O=S.getSize();pn(this._box,S.min),this._box.style.width=O.x+"px",this._box.style.height=O.y+"px"},_finish:function(){this._moved&&(ye(this._box),Dr(this._container,"leaflet-crosshair")),tl(),xf(),zr(document,{contextmenu:mr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(p){if(!(p.which!==1&&p.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var S=new ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(S).fire("boxzoomend",{boxZoomBounds:S})}},_onKeyDown:function(p){p.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});gr.addInitHook("addHandler","boxZoom",Sf),gr.mergeOptions({doubleClickZoom:!0});var Uc=ce.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(p){var S=this._map,O=S.getZoom(),F=S.options.zoomDelta,Q=p.originalEvent.shiftKey?O-F:O+F;S.options.doubleClickZoom==="center"?S.setZoom(Q):S.setZoomAround(p.containerPoint,Q)}});gr.addInitHook("addHandler","doubleClickZoom",Uc),gr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Cm=ce.extend({addHooks:function(){if(!this._draggable){var p=this._map;this._draggable=new Ye(p._mapPane,p._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),p.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),p.on("zoomend",this._onZoomEnd,this),p.whenReady(this._onZoomEnd,this))}Di(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Dr(this._map._container,"leaflet-grab"),Dr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var p=this._map;if(p._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var S=ve(this._map.options.maxBounds);this._offsetLimit=se(this._map.latLngToContainerPoint(S.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(S.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;p.fire("movestart").fire("dragstart"),p.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(p){if(this._map.options.inertia){var S=this._lastTime=+new Date,O=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(O),this._times.push(S),this._prunePositions(S)}this._map.fire("move",p).fire("drag",p)},_prunePositions:function(p){for(;this._positions.length>1&&p-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var p=this._map.getSize().divideBy(2),S=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=S.subtract(p).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(p,S){return p-(p-S)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var p=this._draggable._newPos.subtract(this._draggable._startPos),S=this._offsetLimit;p.x<S.min.x&&(p.x=this._viscousLimit(p.x,S.min.x)),p.y<S.min.y&&(p.y=this._viscousLimit(p.y,S.min.y)),p.x>S.max.x&&(p.x=this._viscousLimit(p.x,S.max.x)),p.y>S.max.y&&(p.y=this._viscousLimit(p.y,S.max.y)),this._draggable._newPos=this._draggable._startPos.add(p)}},_onPreDragWrap:function(){var p=this._worldWidth,S=Math.round(p/2),O=this._initialWorldOffset,F=this._draggable._newPos.x,Q=(F-S+O)%p+S-O,fe=(F+S+O)%p-S-O,ze=Math.abs(Q+O)<Math.abs(fe+O)?Q:fe;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ze},_onDragEnd:function(p){var S=this._map,O=S.options,F=!O.inertia||p.noInertia||this._times.length<2;if(S.fire("dragend",p),F)S.fire("moveend");else{this._prunePositions(+new Date);var Q=this._lastPos.subtract(this._positions[0]),fe=(this._lastTime-this._times[0])/1e3,ze=O.easeLinearity,rt=Q.multiplyBy(ze/fe),ct=rt.distanceTo([0,0]),Rt=Math.min(O.inertiaMaxSpeed,ct),$t=rt.multiplyBy(Rt/ct),fi=Rt/(O.inertiaDeceleration*ze),rr=$t.multiplyBy(-fi/2).round();!rr.x&&!rr.y?S.fire("moveend"):(rr=S._limitOffset(rr,S.options.maxBounds),k(function(){S.panBy(rr,{duration:fi,easeLinearity:ze,noMoveStart:!0,animate:!0})}))}}});gr.addInitHook("addHandler","dragging",Cm),gr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ew=ce.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(p){this._map=p,this._setPanDelta(p.options.keyboardPanDelta),this._setZoomDelta(p.options.zoomDelta)},addHooks:function(){var p=this._map._container;p.tabIndex<=0&&(p.tabIndex="0"),ji(p,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var p=document.body,S=document.documentElement,O=p.scrollTop||S.scrollTop,F=p.scrollLeft||S.scrollLeft;this._map._container.focus(),window.scrollTo(F,O)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(p){var S=this._panKeys={},O=this.keyCodes,F,Q;for(F=0,Q=O.left.length;F<Q;F++)S[O.left[F]]=[-1*p,0];for(F=0,Q=O.right.length;F<Q;F++)S[O.right[F]]=[p,0];for(F=0,Q=O.down.length;F<Q;F++)S[O.down[F]]=[0,p];for(F=0,Q=O.up.length;F<Q;F++)S[O.up[F]]=[0,-1*p]},_setZoomDelta:function(p){var S=this._zoomKeys={},O=this.keyCodes,F,Q;for(F=0,Q=O.zoomIn.length;F<Q;F++)S[O.zoomIn[F]]=p;for(F=0,Q=O.zoomOut.length;F<Q;F++)S[O.zoomOut[F]]=-p},_addHooks:function(){ji(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(p){if(!(p.altKey||p.ctrlKey||p.metaKey)){var S=p.keyCode,O=this._map,F;if(S in this._panKeys){if(!O._panAnim||!O._panAnim._inProgress)if(F=this._panKeys[S],p.shiftKey&&(F=U(F).multiplyBy(3)),O.options.maxBounds&&(F=O._limitOffset(U(F),O.options.maxBounds)),O.options.worldCopyJump){var Q=O.wrapLatLng(O.unproject(O.project(O.getCenter()).add(F)));O.panTo(Q)}else O.panBy(F)}else if(S in this._zoomKeys)O.setZoom(O.getZoom()+(p.shiftKey?3:1)*this._zoomKeys[S]);else if(S===27&&O._popup&&O._popup.options.closeOnEscapeKey)O.closePopup();else return;mr(p)}}});gr.addInitHook("addHandler","keyboard",Ew),gr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Sw=ce.extend({addHooks:function(){ji(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(p){var S=vm(p),O=this._map.options.wheelDebounceTime;this._delta+=S,this._lastMousePos=this._map.mouseEventToContainerPoint(p),this._startTime||(this._startTime=+new Date);var F=Math.max(O-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),F),mr(p)},_performZoom:function(){var p=this._map,S=p.getZoom(),O=this._map.options.zoomSnap||0;p._stop();var F=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Q=4*Math.log(2/(1+Math.exp(-Math.abs(F))))/Math.LN2,fe=O?Math.ceil(Q/O)*O:Q,ze=p._limitZoom(S+(this._delta>0?fe:-fe))-S;this._delta=0,this._startTime=null,ze&&(p.options.scrollWheelZoom==="center"?p.setZoom(S+ze):p.setZoomAround(this._lastMousePos,S+ze))}});gr.addInitHook("addHandler","scrollWheelZoom",Sw);var b2=600;gr.mergeOptions({tapHold:me.touchNative&&me.safari&&me.mobile,tapTolerance:15});var Am=ce.extend({addHooks:function(){ji(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(p){if(clearTimeout(this._holdTimeout),p.touches.length===1){var S=p.touches[0];this._startPos=this._newPos=new V(S.clientX,S.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(ji(document,"touchend",Vi),ji(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",S))},this),b2),ji(document,"touchend touchcancel contextmenu",this._cancel,this),ji(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function p(){zr(document,"touchend",Vi),zr(document,"touchend touchcancel",p)},_cancel:function(){clearTimeout(this._holdTimeout),zr(document,"touchend touchcancel contextmenu",this._cancel,this),zr(document,"touchmove",this._onMove,this)},_onMove:function(p){var S=p.touches[0];this._newPos=new V(S.clientX,S.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(p,S){var O=new MouseEvent(p,{bubbles:!0,cancelable:!0,view:window,screenX:S.screenX,screenY:S.screenY,clientX:S.clientX,clientY:S.clientY});O._simulated=!0,S.target.dispatchEvent(O)}});gr.addInitHook("addHandler","tapHold",Am),gr.mergeOptions({touchZoom:me.touch,bounceAtZoomLimits:!0});var Mm=ce.extend({addHooks:function(){Di(this._map._container,"leaflet-touch-zoom"),ji(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Dr(this._map._container,"leaflet-touch-zoom"),zr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(p){var S=this._map;if(!(!p.touches||p.touches.length!==2||S._animatingZoom||this._zooming)){var O=S.mouseEventToContainerPoint(p.touches[0]),F=S.mouseEventToContainerPoint(p.touches[1]);this._centerPoint=S.getSize()._divideBy(2),this._startLatLng=S.containerPointToLatLng(this._centerPoint),S.options.touchZoom!=="center"&&(this._pinchStartLatLng=S.containerPointToLatLng(O.add(F)._divideBy(2))),this._startDist=O.distanceTo(F),this._startZoom=S.getZoom(),this._moved=!1,this._zooming=!0,S._stop(),ji(document,"touchmove",this._onTouchMove,this),ji(document,"touchend touchcancel",this._onTouchEnd,this),Vi(p)}},_onTouchMove:function(p){if(!(!p.touches||p.touches.length!==2||!this._zooming)){var S=this._map,O=S.mouseEventToContainerPoint(p.touches[0]),F=S.mouseEventToContainerPoint(p.touches[1]),Q=O.distanceTo(F)/this._startDist;if(this._zoom=S.getScaleZoom(Q,this._startZoom),!S.options.bounceAtZoomLimits&&(this._zoom<S.getMinZoom()&&Q<1||this._zoom>S.getMaxZoom()&&Q>1)&&(this._zoom=S._limitZoom(this._zoom)),S.options.touchZoom==="center"){if(this._center=this._startLatLng,Q===1)return}else{var fe=O._add(F)._divideBy(2)._subtract(this._centerPoint);if(Q===1&&fe.x===0&&fe.y===0)return;this._center=S.unproject(S.project(this._pinchStartLatLng,this._zoom).subtract(fe),this._zoom)}this._moved||(S._moveStart(!0,!1),this._moved=!0),B(this._animRequest);var ze=a(S._move,S,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=k(ze,this,!0),Vi(p)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,B(this._animRequest),zr(document,"touchmove",this._onTouchMove,this),zr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});gr.addInitHook("addHandler","touchZoom",Mm),gr.BoxZoom=Sf,gr.DoubleClickZoom=Uc,gr.Drag=Cm,gr.Keyboard=Ew,gr.ScrollWheelZoom=Sw,gr.TapHold=Am,gr.TouchZoom=Mm,i.Bounds=ie,i.Browser=me,i.CRS=De,i.Canvas=Sm,i.Circle=hu,i.CircleMarker=To,i.Class=W,i.Control=sa,i.DivIcon=la,i.DivOverlay=si,i.DomEvent=E1,i.DomUtil=dm,i.Draggable=Ye,i.Evented=G,i.FeatureGroup=ir,i.GeoJSON=ws,i.GridLayer=Ai,i.Handler=ce,i.Icon=_s,i.ImageOverlay=vt,i.LatLng=_e,i.LatLngBounds=ee,i.Layer=un,i.LayerGroup=cu,i.LineUtil=$a,i.Map=gr,i.Marker=ed,i.Mixin=Be,i.Path=ll,i.Point=V,i.PolyUtil=Nt,i.Polygon=zc,i.Polyline=zs,i.Popup=Zi,i.PosAnimation=ym,i.Projection=oa,i.Rectangle=Tm,i.Renderer=Yu,i.SVG=Ef,i.SVGOverlay=Gt,i.TileLayer=rd,i.Tooltip=Nn,i.Transformation=ke,i.Util=z,i.VideoOverlay=Jt,i.bind=a,i.bounds=se,i.canvas=Xu,i.circle=Co,i.circleMarker=_f,i.control=Pa,i.divIcon=Ul,i.extend=n,i.featureGroup=Qh,i.geoJSON=je,i.geoJson=Fe,i.gridLayer=y2,i.icon=Bc,i.imageOverlay=Tt,i.latLng=he,i.latLngBounds=ve,i.layerGroup=Zh,i.map=Sn,i.marker=Za,i.point=U,i.polygon=wf,i.polyline=_m,i.popup=ss,i.rectangle=ww,i.setOptions=g,i.stamp=l,i.svg=S1,i.svgOverlay=er,i.tileLayer=Em,i.tooltip=as,i.transformation=Xe,i.version=r,i.videoOverlay=ii;var T1=window.L;i.noConflict=function(){return window.L=T1,this},window.L=i})})(x3,x3.exports);var G_=x3.exports;const SZ=O_(G_);function P4(e,t,i){return Object.freeze({instance:e,context:t,container:i})}function D4(e,t){return t==null?function(r,n){const s=de.useRef();return s.current||(s.current=e(r,n)),s}:function(r,n){const s=de.useRef();s.current||(s.current=e(r,n));const a=de.useRef(r),{instance:o}=s.current;return de.useEffect(function(){a.current!==r&&(t(o,r,a.current),a.current=r)},[o,r,n]),s}}function obe(e,t){de.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var s;(s=t.layerContainer)==null||s.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function TZ(e){return function(i){const r=wZ(),n=e(M4(i,r),r);return xZ(r.map,i.attribution),EZ(n.current,i.eventHandlers),obe(n.current,r),n}}function lbe(e,t){const i=D4(e,t),r=TZ(i);return rbe(r)}function ube(e,t){const i=D4(e),r=abe(i,t);return nbe(r)}function cbe(e,t){const i=D4(e,t),r=TZ(i);return sbe(r)}function hbe(e,t,i){const{opacity:r,zIndex:n}=t;r!=null&&r!==i.opacity&&e.setOpacity(r),n!=null&&n!==i.zIndex&&e.setZIndex(n)}function b3(){return b3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},b3.apply(this,arguments)}function dbe({bounds:e,boundsOptions:t,center:i,children:r,className:n,id:s,placeholder:a,style:o,whenReady:l,zoom:u,...c},h){const[d]=de.useState({className:n,id:s,style:o}),[f,m]=de.useState(null);de.useImperativeHandle(h,()=>(f==null?void 0:f.map)??null,[f]);const g=de.useCallback(x=>{if(x!==null&&f===null){const w=new G_.Map(x,c);i!=null&&u!=null?w.setView(i,u):e!=null&&w.fitBounds(e,t),l!=null&&w.whenReady(l),m(tbe(w))}},[]);de.useEffect(()=>()=>{f==null||f.map.remove()},[f]);const y=f?ci.createElement(_Z,{value:f},r):a??null;return ci.createElement("div",b3({},d,{ref:g}),y)}const fbe=de.forwardRef(dbe),pbe=lbe(function({position:t,...i},r){const n=new G_.Marker(t,i);return P4(n,ibe(r,{overlayContainer:n}))},function(t,i,r){i.position!==r.position&&t.setLatLng(i.position),i.icon!=null&&i.icon!==r.icon&&t.setIcon(i.icon),i.zIndexOffset!=null&&i.zIndexOffset!==r.zIndexOffset&&t.setZIndexOffset(i.zIndexOffset),i.opacity!=null&&i.opacity!==r.opacity&&t.setOpacity(i.opacity),t.dragging!=null&&i.draggable!==r.draggable&&(i.draggable===!0?t.dragging.enable():t.dragging.disable())}),mbe=ube(function(t,i){const r=new G_.Popup(t,i.overlayContainer);return P4(r,i)},function(t,i,{position:r},n){de.useEffect(function(){const{instance:a}=t;function o(u){u.popup===a&&(a.update(),n(!0))}function l(u){u.popup===a&&n(!1)}return i.map.on({popupopen:o,popupclose:l}),i.overlayContainer==null?(r!=null&&a.setLatLng(r),a.openOn(i.map)):i.overlayContainer.bindPopup(a),function(){var c;i.map.off({popupopen:o,popupclose:l}),(c=i.overlayContainer)==null||c.unbindPopup(),i.map.removeLayer(a)}},[t,i,n,r])}),gbe=cbe(function({url:t,...i},r){const n=new G_.TileLayer(t,M4(i,r));return P4(n,r)},function(t,i,r){hbe(t,i,r);const{url:n}=i;n!=null&&n!==r.url&&t.setUrl(n)});delete SZ.Icon.Default.prototype._getIconUrl;SZ.Icon.Default.mergeOptions({iconRetinaUrl:"/marker-icon-2x.png",iconUrl:"/marker-icon.png",shadowUrl:"/marker-shadow.png"});const vbe=({center:e=[48.8566,2.3522],zoom:t=13})=>j.jsx(Ui.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-[400px] w-full relative z-10 rounded-lg overflow-hidden shadow-lg",children:j.jsxs(fbe,{center:e,zoom:t,scrollWheelZoom:!1,style:{height:"100%",width:"100%"},children:[j.jsx(gbe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),j.jsx(pbe,{position:e,children:j.jsx(mbe,{children:"Mon emplacement"})})]})});var CZ={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},qj=ci.createContext&&ci.createContext(CZ),ybe=["attr","size","title"];function xbe(e,t){if(e==null)return{};var i=bbe(e,t),r,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function bbe(e,t){if(e==null)return{};var i={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;i[r]=e[r]}return i}function yC(){return yC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},yC.apply(this,arguments)}function Yj(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function xC(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Yj(Object(i),!0).forEach(function(r){_be(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yj(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function _be(e,t,i){return t=wbe(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function wbe(e){var t=Ebe(e,"string");return typeof t=="symbol"?t:t+""}function Ebe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AZ(e){return e&&e.map((t,i)=>ci.createElement(t.tag,xC({key:i},t.attr),AZ(t.child)))}function lu(e){return t=>ci.createElement(Sbe,yC({attr:xC({},e.attr)},t),AZ(e.child))}function Sbe(e){var t=i=>{var{attr:r,size:n,title:s}=e,a=xbe(e,ybe),o=n||i.size||"1em",l;return i.className&&(l=i.className),e.className&&(l=(l?l+" ":"")+e.className),ci.createElement("svg",yC({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},i.attr,r,a,{className:l,style:xC(xC({color:e.color||i.color},i.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&ci.createElement("title",null,s),e.children)};return qj!==void 0?ci.createElement(qj.Consumer,null,i=>t(i)):t(CZ)}function Tbe(e){return lu({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"},child:[]}]})(e)}function Cbe(e){return lu({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M14 95.7924C14 42.8877 56.8878 0 109.793 0H274.161C327.066 0 369.954 42.8877 369.954 95.7924C369.954 129.292 352.758 158.776 326.711 175.897C352.758 193.019 369.954 222.502 369.954 256.002C369.954 308.907 327.066 351.795 274.161 351.795H272.081C247.279 351.795 224.678 342.369 207.666 326.904V415.167C207.666 468.777 163.657 512 110.309 512C57.5361 512 14 469.243 14 416.207C14 382.709 31.1945 353.227 57.2392 336.105C31.1945 318.983 14 289.5 14 256.002C14 222.502 31.196 193.019 57.2425 175.897C31.196 158.776 14 129.292 14 95.7924ZM176.288 191.587H109.793C74.2172 191.587 45.3778 220.427 45.3778 256.002C45.3778 291.44 73.9948 320.194 109.381 320.416C109.518 320.415 109.655 320.415 109.793 320.415H176.288V191.587ZM207.666 256.002C207.666 291.577 236.505 320.417 272.081 320.417H274.161C309.737 320.417 338.576 291.577 338.576 256.002C338.576 220.427 309.737 191.587 274.161 191.587H272.081C236.505 191.587 207.666 220.427 207.666 256.002ZM109.793 351.795C109.655 351.795 109.518 351.794 109.381 351.794C73.9948 352.015 45.3778 380.769 45.3778 416.207C45.3778 451.652 74.6025 480.622 110.309 480.622C146.591 480.622 176.288 451.186 176.288 415.167V351.795H109.793ZM109.793 31.3778C74.2172 31.3778 45.3778 60.2173 45.3778 95.7924C45.3778 131.368 74.2172 160.207 109.793 160.207H176.288V31.3778H109.793ZM207.666 160.207H274.161C309.737 160.207 338.576 131.368 338.576 95.7924C338.576 60.2173 309.737 31.3778 274.161 31.3778H207.666V160.207Z"},child:[]}]})(e)}function Abe(e){return lu({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"},child:[]}]})(e)}function MZ(e){return lu({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 508c-6.7 0-13.5-1.8-19.4-5.2l-61.7-36.5c-9.2-5.2-4.7-7-1.7-8 12.3-4.3 14.8-5.2 27.9-12.7 1.4-.8 3.2-.5 4.6.4l47.4 28.1c1.7 1 4.1 1 5.7 0l184.7-106.6c1.7-1 2.8-3 2.8-5V149.3c0-2.1-1.1-4-2.9-5.1L226.8 37.7c-1.7-1-4-1-5.7 0L36.6 144.3c-1.8 1-2.9 3-2.9 5.1v213.1c0 2 1.1 4 2.9 4.9l50.6 29.2c27.5 13.7 44.3-2.4 44.3-18.7V167.5c0-3 2.4-5.3 5.4-5.3h23.4c2.9 0 5.4 2.3 5.4 5.3V378c0 36.6-20 57.6-54.7 57.6-10.7 0-19.1 0-42.5-11.6l-48.4-27.9C8.1 389.2.7 376.3.7 362.4V149.3c0-13.8 7.4-26.8 19.4-33.7L204.6 9c11.7-6.6 27.2-6.6 38.8 0l184.7 106.7c12 6.9 19.4 19.8 19.4 33.7v213.1c0 13.8-7.4 26.7-19.4 33.7L243.4 502.8c-5.9 3.4-12.6 5.2-19.4 5.2zm149.1-210.1c0-39.9-27-50.5-83.7-58-57.4-7.6-63.2-11.5-63.2-24.9 0-11.1 4.9-25.9 47.4-25.9 37.9 0 51.9 8.2 57.7 33.8.5 2.4 2.7 4.2 5.2 4.2h24c1.5 0 2.9-.6 3.9-1.7s1.5-2.6 1.4-4.1c-3.7-44.1-33-64.6-92.2-64.6-52.7 0-84.1 22.2-84.1 59.5 0 40.4 31.3 51.6 81.8 56.6 60.5 5.9 65.2 14.8 65.2 26.7 0 20.6-16.6 29.4-55.5 29.4-48.9 0-59.6-12.3-63.2-36.6-.4-2.6-2.6-4.5-5.3-4.5h-23.9c-3 0-5.3 2.4-5.3 5.3 0 31.1 16.9 68.2 97.8 68.2 58.4-.1 92-23.2 92-63.4z"},child:[]}]})(e)}function PZ(e){return lu({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M418.2 177.2c-5.4-1.8-10.8-3.5-16.2-5.1.9-3.7 1.7-7.4 2.5-11.1 12.3-59.6 4.2-107.5-23.1-123.3-26.3-15.1-69.2.6-112.6 38.4-4.3 3.7-8.5 7.6-12.5 11.5-2.7-2.6-5.5-5.2-8.3-7.7-45.5-40.4-91.1-57.4-118.4-41.5-26.2 15.2-34 60.3-23 116.7 1.1 5.6 2.3 11.1 3.7 16.7-6.4 1.8-12.7 3.8-18.6 5.9C38.3 196.2 0 225.4 0 255.6c0 31.2 40.8 62.5 96.3 81.5 4.5 1.5 9 3 13.6 4.3-1.5 6-2.8 11.9-4 18-10.5 55.5-2.3 99.5 23.9 114.6 27 15.6 72.4-.4 116.6-39.1 3.5-3.1 7-6.3 10.5-9.7 4.4 4.3 9 8.4 13.6 12.4 42.8 36.8 85.1 51.7 111.2 36.6 27-15.6 35.8-62.9 24.4-120.5-.9-4.4-1.9-8.9-3-13.5 3.2-.9 6.3-1.9 9.4-2.9 57.7-19.1 99.5-50 99.5-81.7 0-30.3-39.4-59.7-93.8-78.4zM282.9 92.3c37.2-32.4 71.9-45.1 87.7-36 16.9 9.7 23.4 48.9 12.8 100.4-.7 3.4-1.4 6.7-2.3 10-22.2-5-44.7-8.6-67.3-10.6-13-18.6-27.2-36.4-42.6-53.1 3.9-3.7 7.7-7.2 11.7-10.7zM167.2 307.5c5.1 8.7 10.3 17.4 15.8 25.9-15.6-1.7-31.1-4.2-46.4-7.5 4.4-14.4 9.9-29.3 16.3-44.5 4.6 8.8 9.3 17.5 14.3 26.1zm-30.3-120.3c14.4-3.2 29.7-5.8 45.6-7.8-5.3 8.3-10.5 16.8-15.4 25.4-4.9 8.5-9.7 17.2-14.2 26-6.3-14.9-11.6-29.5-16-43.6zm27.4 68.9c6.6-13.8 13.8-27.3 21.4-40.6s15.8-26.2 24.4-38.9c15-1.1 30.3-1.7 45.9-1.7s31 .6 45.9 1.7c8.5 12.6 16.6 25.5 24.3 38.7s14.9 26.7 21.7 40.4c-6.7 13.8-13.9 27.4-21.6 40.8-7.6 13.3-15.7 26.2-24.2 39-14.9 1.1-30.4 1.6-46.1 1.6s-30.9-.5-45.6-1.4c-8.7-12.7-16.9-25.7-24.6-39s-14.8-26.8-21.5-40.6zm180.6 51.2c5.1-8.8 9.9-17.7 14.6-26.7 6.4 14.5 12 29.2 16.9 44.3-15.5 3.5-31.2 6.2-47 8 5.4-8.4 10.5-17 15.5-25.6zm14.4-76.5c-4.7-8.8-9.5-17.6-14.5-26.2-4.9-8.5-10-16.9-15.3-25.2 16.1 2 31.5 4.7 45.9 8-4.6 14.8-10 29.2-16.1 43.4zM256.2 118.3c10.5 11.4 20.4 23.4 29.6 35.8-19.8-.9-39.7-.9-59.5 0 9.8-12.9 19.9-24.9 29.9-35.8zM140.2 57c16.8-9.8 54.1 4.2 93.4 39 2.5 2.2 5 4.6 7.6 7-15.5 16.7-29.8 34.5-42.9 53.1-22.6 2-45 5.5-67.2 10.4-1.3-5.1-2.4-10.3-3.5-15.5-9.4-48.4-3.2-84.9 12.6-94zm-24.5 263.6c-4.2-1.2-8.3-2.5-12.4-3.9-21.3-6.7-45.5-17.3-63-31.2-10.1-7-16.9-17.8-18.8-29.9 0-18.3 31.6-41.7 77.2-57.6 5.7-2 11.5-3.8 17.3-5.5 6.8 21.7 15 43 24.5 63.6-9.6 20.9-17.9 42.5-24.8 64.5zm116.6 98c-16.5 15.1-35.6 27.1-56.4 35.3-11.1 5.3-23.9 5.8-35.3 1.3-15.9-9.2-22.5-44.5-13.5-92 1.1-5.6 2.3-11.2 3.7-16.7 22.4 4.8 45 8.1 67.9 9.8 13.2 18.7 27.7 36.6 43.2 53.4-3.2 3.1-6.4 6.1-9.6 8.9zm24.5-24.3c-10.2-11-20.4-23.2-30.3-36.3 9.6.4 19.5.6 29.5.6 10.3 0 20.4-.2 30.4-.7-9.2 12.7-19.1 24.8-29.6 36.4zm130.7 30c-.9 12.2-6.9 23.6-16.5 31.3-15.9 9.2-49.8-2.8-86.4-34.2-4.2-3.6-8.4-7.5-12.7-11.5 15.3-16.9 29.4-34.8 42.2-53.6 22.9-1.9 45.7-5.4 68.2-10.5 1 4.1 1.9 8.2 2.7 12.2 4.9 21.6 5.7 44.1 2.5 66.3zm18.2-107.5c-2.8.9-5.6 1.8-8.5 2.6-7-21.8-15.6-43.1-25.5-63.8 9.6-20.4 17.7-41.4 24.5-62.9 5.2 1.5 10.2 3.1 15 4.7 46.6 16 79.3 39.8 79.3 58 0 19.6-34.9 44.9-84.8 61.4zm-149.7-15c25.3 0 45.8-20.5 45.8-45.8s-20.5-45.8-45.8-45.8c-25.3 0-45.8 20.5-45.8 45.8s20.5 45.8 45.8 45.8z"},child:[]}]})(e)}function Mbe(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M24 18.588a1.529 1.529 0 01-1.895-.72l-3.45-4.771-.5-.667-4.003 5.444a1.466 1.466 0 01-1.802.708l5.158-6.92-4.798-6.251a1.595 1.595 0 011.9.666l3.576 4.83 3.596-4.81a1.435 1.435 0 011.788-.668L21.708 7.9l-2.522 3.283a.666.666 0 000 .994l4.804 6.412zM.002 11.576l.42-2.075c1.154-4.103 5.858-5.81 9.094-3.27 1.895 1.489 2.368 3.597 2.275 5.973H1.116C.943 16.447 4.005 19.009 7.92 17.7a4.078 4.078 0 002.582-2.876c.207-.666.548-.78 1.174-.588a5.417 5.417 0 01-2.589 3.957 6.272 6.272 0 01-7.306-.933 6.575 6.575 0 01-1.64-3.858c0-.235-.08-.455-.134-.666A88.33 88.33 0 010 11.577zm1.127-.286h9.654c-.06-3.076-2.001-5.258-4.59-5.278-2.882-.04-4.944 2.094-5.071 5.264z"},child:[]}]})(e)}function DZ(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.002 0a2.138 2.138 0 1 0 0 4.277 2.138 2.138 0 1 0 0-4.277zm8.54 4.931a2.138 2.138 0 1 0 0 4.277 2.138 2.138 0 1 0 0-4.277zm0 9.862a2.138 2.138 0 1 0 0 4.277 2.138 2.138 0 1 0 0-4.277zm-8.54 4.931a2.138 2.138 0 1 0 0 4.276 2.138 2.138 0 1 0 0-4.276zm-8.542-4.93a2.138 2.138 0 1 0 0 4.276 2.138 2.138 0 1 0 0-4.277zm0-9.863a2.138 2.138 0 1 0 0 4.277 2.138 2.138 0 1 0 0-4.277zm8.542-3.378L2.953 6.777v10.448l9.049 5.224 9.047-5.224V6.777zm0 1.601 7.66 13.27H4.34zm-1.387.371L3.97 15.037V7.363zm2.774 0 6.646 3.838v7.674zM5.355 17.44h13.293l-6.646 3.836z"},child:[]}]})(e)}function IZ(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.193 9.555c-1.264-5.58-4.252-7.414-4.573-8.115-.28-.394-.53-.954-.735-1.44-.036.495-.055.685-.523 1.184-.723.566-4.438 3.682-4.74 10.02-.282 5.912 4.27 9.435 4.888 9.884l.07.05A73.49 73.49 0 0111.91 24h.481c.114-1.032.284-2.056.51-3.07.417-.296.604-.463.85-.693a11.342 11.342 0 003.639-8.464c.01-.814-.103-1.662-.197-2.218zm-5.336 8.195s0-8.291.275-8.29c.213 0 .49 10.695.49 10.695-.381-.045-.765-1.76-.765-2.405z"},child:[]}]})(e)}function OZ(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.665 21.978C16.758 23.255 14.465 24 12 24 5.377 24 0 18.623 0 12S5.377 0 12 0s12 5.377 12 12c0 3.583-1.574 6.801-4.067 9.001L9.219 7.2H7.2v9.596h1.615V9.251l9.85 12.727Zm-3.332-8.533 1.6 2.061V7.2h-1.6v6.245Z"},child:[]}]})(e)}function Pbe(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M23.5594 14.7228a.5269.5269 0 0 0-.0563-.1191c-.139-.2632-.4768-.3418-1.0074-.2321-1.6533.3411-2.2935.1312-2.5256-.0191 1.342-2.0482 2.445-4.522 3.0411-6.8297.2714-1.0507.7982-3.5237.1222-4.7316a1.5641 1.5641 0 0 0-.1509-.235C21.6931.9086 19.8007.0248 17.5099.0005c-1.4947-.0158-2.7705.3461-3.1161.4794a9.449 9.449 0 0 0-.5159-.0816 8.044 8.044 0 0 0-1.3114-.1278c-1.1822-.0184-2.2038.2642-3.0498.8406-.8573-.3211-4.7888-1.645-7.2219.0788C.9359 2.1526.3086 3.8733.4302 6.3043c.0409.818.5069 3.334 1.2423 5.7436.4598 1.5065.9387 2.7019 1.4334 3.582.553.9942 1.1259 1.5933 1.7143 1.7895.4474.1491 1.1327.1441 1.8581-.7279.8012-.9635 1.5903-1.8258 1.9446-2.2069.4351.2355.9064.3625 1.39.3772a.0569.0569 0 0 0 .0004.0041 11.0312 11.0312 0 0 0-.2472.3054c-.3389.4302-.4094.5197-1.5002.7443-.3102.064-1.1344.2339-1.1464.8115-.0025.1224.0329.2309.0919.3268.2269.4231.9216.6097 1.015.6331 1.3345.3335 2.5044.092 3.3714-.6787-.017 2.231.0775 4.4174.3454 5.0874.2212.5529.7618 1.9045 2.4692 1.9043.2505 0 .5263-.0291.8296-.0941 1.7819-.3821 2.5557-1.1696 2.855-2.9059.1503-.8707.4016-2.8753.5388-4.1012.0169-.0703.0357-.1207.057-.1362.0007-.0005.0697-.0471.4272.0307a.3673.3673 0 0 0 .0443.0068l.2539.0223.0149.001c.8468.0384 1.9114-.1426 2.5312-.4308.6438-.2988 1.8057-1.0323 1.5951-1.6698zM2.371 11.8765c-.7435-2.4358-1.1779-4.8851-1.2123-5.5719-.1086-2.1714.4171-3.6829 1.5623-4.4927 1.8367-1.2986 4.8398-.5408 6.108-.13-.0032.0032-.0066.0061-.0098.0094-2.0238 2.044-1.9758 5.536-1.9708 5.7495-.0002.0823.0066.1989.0162.3593.0348.5873.0996 1.6804-.0735 2.9184-.1609 1.1504.1937 2.2764.9728 3.0892.0806.0841.1648.1631.2518.2374-.3468.3714-1.1004 1.1926-1.9025 2.1576-.5677.6825-.9597.5517-1.0886.5087-.3919-.1307-.813-.5871-1.2381-1.3223-.4796-.839-.9635-2.0317-1.4155-3.5126zm6.0072 5.0871c-.1711-.0428-.3271-.1132-.4322-.1772.0889-.0394.2374-.0902.4833-.1409 1.2833-.2641 1.4815-.4506 1.9143-1.0002.0992-.126.2116-.2687.3673-.4426a.3549.3549 0 0 0 .0737-.1298c.1708-.1513.2724-.1099.4369-.0417.156.0646.3078.26.3695.4752.0291.1016.0619.2945-.0452.4444-.9043 1.2658-2.2216 1.2494-3.1676 1.0128zm2.094-3.988-.0525.141c-.133.3566-.2567.6881-.3334 1.003-.6674-.0021-1.3168-.2872-1.8105-.8024-.6279-.6551-.9131-1.5664-.7825-2.5004.1828-1.3079.1153-2.4468.079-3.0586-.005-.0857-.0095-.1607-.0122-.2199.2957-.2621 1.6659-.9962 2.6429-.7724.4459.1022.7176.4057.8305.928.5846 2.7038.0774 3.8307-.3302 4.7363-.084.1866-.1633.3629-.2311.5454zm7.3637 4.5725c-.0169.1768-.0358.376-.0618.5959l-.146.4383a.3547.3547 0 0 0-.0182.1077c-.0059.4747-.054.6489-.115.8693-.0634.2292-.1353.4891-.1794 1.0575-.11 1.4143-.8782 2.2267-2.4172 2.5565-1.5155.3251-1.7843-.4968-2.0212-1.2217a6.5824 6.5824 0 0 0-.0769-.2266c-.2154-.5858-.1911-1.4119-.1574-2.5551.0165-.5612-.0249-1.9013-.3302-2.6462.0044-.2932.0106-.5909.019-.8918a.3529.3529 0 0 0-.0153-.1126 1.4927 1.4927 0 0 0-.0439-.208c-.1226-.4283-.4213-.7866-.7797-.9351-.1424-.059-.4038-.1672-.7178-.0869.067-.276.1831-.5875.309-.9249l.0529-.142c.0595-.16.134-.3257.213-.5012.4265-.9476 1.0106-2.2453.3766-5.1772-.2374-1.0981-1.0304-1.6343-2.2324-1.5098-.7207.0746-1.3799.3654-1.7088.5321a5.6716 5.6716 0 0 0-.1958.1041c.0918-1.1064.4386-3.1741 1.7357-4.4823a4.0306 4.0306 0 0 1 .3033-.276.3532.3532 0 0 0 .1447-.0644c.7524-.5706 1.6945-.8506 2.802-.8325.4091.0067.8017.0339 1.1742.081 1.939.3544 3.2439 1.4468 4.0359 2.3827.8143.9623 1.2552 1.9315 1.4312 2.4543-1.3232-.1346-2.2234.1268-2.6797.779-.9926 1.4189.543 4.1729 1.2811 5.4964.1353.2426.2522.4522.2889.5413.2403.5825.5515.9713.7787 1.2552.0696.087.1372.1714.1885.245-.4008.1155-1.1208.3825-1.0552 1.717-.0123.1563-.0423.4469-.0834.8148-.0461.2077-.0702.4603-.0994.7662zm.8905-1.6211c-.0405-.8316.2691-.9185.5967-1.0105a2.8566 2.8566 0 0 0 .135-.0406 1.202 1.202 0 0 0 .1342.103c.5703.3765 1.5823.4213 3.0068.1344-.2016.1769-.5189.3994-.9533.6011-.4098.1903-1.0957.333-1.7473.3636-.7197.0336-1.0859-.0807-1.1721-.151zm.5695-9.2712c-.0059.3508-.0542.6692-.1054 1.0017-.055.3576-.112.7274-.1264 1.1762-.0142.4368.0404.8909.0932 1.3301.1066.887.216 1.8003-.2075 2.7014a3.5272 3.5272 0 0 1-.1876-.3856c-.0527-.1276-.1669-.3326-.3251-.6162-.6156-1.1041-2.0574-3.6896-1.3193-4.7446.3795-.5427 1.3408-.5661 2.1781-.463zm.2284 7.0137a12.3762 12.3762 0 0 0-.0853-.1074l-.0355-.0444c.7262-1.1995.5842-2.3862.4578-3.4385-.0519-.4318-.1009-.8396-.0885-1.2226.0129-.4061.0666-.7543.1185-1.0911.0639-.415.1288-.8443.1109-1.3505.0134-.0531.0188-.1158.0118-.1902-.0457-.4855-.5999-1.938-1.7294-3.253-.6076-.7073-1.4896-1.4972-2.6889-2.0395.5251-.1066 1.2328-.2035 2.0244-.1859 2.0515.0456 3.6746.8135 4.8242 2.2824a.908.908 0 0 1 .0667.1002c.7231 1.3556-.2762 6.2751-2.9867 10.5405zm-8.8166-6.1162c-.025.1794-.3089.4225-.6211.4225a.5821.5821 0 0 1-.0809-.0056c-.1873-.026-.3765-.144-.5059-.3156-.0458-.0605-.1203-.178-.1055-.2844.0055-.0401.0261-.0985.0925-.1488.1182-.0894.3518-.1226.6096-.0867.3163.0441.6426.1938.6113.4186zm7.9305-.4114c.0111.0792-.049.201-.1531.3102-.0683.0717-.212.1961-.4079.2232a.5456.5456 0 0 1-.075.0052c-.2935 0-.5414-.2344-.5607-.3717-.024-.1765.2641-.3106.5611-.352.297-.0414.6111.0088.6356.1851z"},child:[]}]})(e)}function RZ(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.001,4.8c-3.2,0-5.2,1.6-6,4.8c1.2-1.6,2.6-2.2,4.2-1.8c0.913,0.228,1.565,0.89,2.288,1.624 C13.666,10.618,15.027,12,18.001,12c3.2,0,5.2-1.6,6-4.8c-1.2,1.6-2.6,2.2-4.2,1.8c-0.913-0.228-1.565-0.89-2.288-1.624 C16.337,6.182,14.976,4.8,12.001,4.8z M6.001,12c-3.2,0-5.2,1.6-6,4.8c1.2-1.6,2.6-2.2,4.2-1.8c0.913,0.228,1.565,0.89,2.288,1.624 c1.177,1.194,2.538,2.576,5.512,2.576c3.2,0,5.2-1.6,6-4.8c-1.2,1.6-2.6,2.2-4.2,1.8c-0.913-0.228-1.565-0.89-2.288-1.624 C10.337,13.382,8.976,12,6.001,12z"},child:[]}]})(e)}function LZ(e){return lu({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M1.125 0C.502 0 0 .502 0 1.125v21.75C0 23.498.502 24 1.125 24h21.75c.623 0 1.125-.502 1.125-1.125V1.125C24 .502 23.498 0 22.875 0zm17.363 9.75c.612 0 1.154.037 1.627.111a6.38 6.38 0 0 1 1.306.34v2.458a3.95 3.95 0 0 0-.643-.361 5.093 5.093 0 0 0-.717-.26 5.453 5.453 0 0 0-1.426-.2c-.3 0-.573.028-.819.086a2.1 2.1 0 0 0-.623.242c-.17.104-.3.229-.393.374a.888.888 0 0 0-.14.49c0 .196.053.373.156.529.104.156.252.304.443.444s.423.276.696.41c.273.135.582.274.926.416.47.197.892.407 1.266.628.374.222.695.473.963.753.268.279.472.598.614.957.142.359.214.776.214 1.253 0 .657-.125 1.21-.373 1.656a3.033 3.033 0 0 1-1.012 1.085 4.38 4.38 0 0 1-1.487.596c-.566.12-1.163.18-1.79.18a9.916 9.916 0 0 1-1.84-.164 5.544 5.544 0 0 1-1.512-.493v-2.63a5.033 5.033 0 0 0 3.237 1.2c.333 0 .624-.03.872-.09.249-.06.456-.144.623-.25.166-.108.29-.234.373-.38a1.023 1.023 0 0 0-.074-1.089 2.12 2.12 0 0 0-.537-.5 5.597 5.597 0 0 0-.807-.444 27.72 27.72 0 0 0-1.007-.436c-.918-.383-1.602-.852-2.053-1.405-.45-.553-.676-1.222-.676-2.005 0-.614.123-1.141.369-1.582.246-.441.58-.804 1.004-1.089a4.494 4.494 0 0 1 1.47-.629 7.536 7.536 0 0 1 1.77-.201zm-15.113.188h9.563v2.166H9.506v9.646H6.789v-9.646H3.375z"},child:[]}]})(e)}const Dbe=e=>({React:j.jsx(PZ,{className:"w-5 h-5 text-[#61DAFB]"}),TypeScript:j.jsx(LZ,{className:"w-5 h-5 text-[#3178C6]"}),"Node.js":j.jsx(MZ,{className:"w-5 h-5 text-[#339933]"}),"Tailwind CSS":j.jsx(RZ,{className:"w-5 h-5 text-[#06B6D4]"}),"Next.js":j.jsx(OZ,{className:"w-5 h-5 text-[#000000]"}),GraphQL:j.jsx(DZ,{className:"w-5 h-5 text-[#E10098]"}),MongoDB:j.jsx(IZ,{className:"w-5 h-5 text-[#47A248]"}),PostgreSQL:j.jsx(Pbe,{className:"w-5 h-5 text-[#336791]"})})[e]||null,Ibe=({title:e="À propos de moi",subtitle:t="Développeur Web Passionné",description:i=["Je suis un développeur web full-stack avec une passion pour la création d'interfaces utilisateur élégantes et performantes.","Avec plus de 5 ans d'expérience dans le développement web, j'ai travaillé sur divers projets allant des applications SPA aux sites e-commerce complexes.","J'aime résoudre des problèmes complexes et apprendre constamment de nouvelles technologies pour améliorer mes compétences."],skills:r=["React","TypeScript","Node.js","Tailwind CSS","Next.js","GraphQL","MongoDB","PostgreSQL"],experience:n=[{title:"Web Designer & Développeur Fullstack",company:"ADP/TTR | FREELANCE",period:"Septembre 2021 - Août 2023",description:"Refonte de sites e-commerce Shopify, développement d'applications avec React et EC2, intégration d'IA et automatisation avec Zapier."},{title:"Développeur WordPress",company:"GOLFFANG | FREELANCE",period:"Janvier 2023 - Février 2023",description:"Conception avec Elementor, développement de thèmes, intégration d'OpenAI et chatbot IA."},{title:"Web Designer",company:"UWANDZANI | FREELANCE",period:"Février 2019 - Juin 2019",description:"Création de designs et interfaces, intégration HTML/CSS/JavaScript, WordPress et Elementor."},{title:"Agent Verbalisateur",company:"ARM MADAGASCAR",period:"Septembre 2018 - Octobre 2020",description:"Gestion d'équipes, coordination des opérations, reporting et gestion des matériels."},{title:"Agent Marketing",company:"INTELCIA",period:"Septembre 2017 - Août 2018",description:"Responsable SAV et commercial, gestion des tickets clients et géolocalisation des commandes."}],education:s=[{degree:"Master en Informatique",institution:"Université de Technologie",year:"2018"},{degree:"Licence en Développement Web",institution:"Institut Supérieur du Digital",year:"2016"}]})=>j.jsx("section",{id:"about",className:"py-20 bg-background w-full",children:j.jsxs("div",{className:"container mx-auto px-4",children:[j.jsxs(Ui.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"text-center mb-12",children:[j.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-2",children:e}),j.jsx("p",{className:"text-xl text-muted-foreground",children:t})]}),j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[j.jsx(Ui.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},transition:{duration:.5,delay:.1},viewport:{once:!0},children:j.jsxs("div",{className:"space-y-4",children:[i.map((a,o)=>j.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a},o)),j.jsxs("div",{className:"mt-6 space-y-4",children:[j.jsx(Zn,{variant:"outline",children:"Télécharger CV"}),j.jsx("div",{className:"w-full h-[300px] rounded-lg overflow-hidden",children:j.jsx(vbe,{})})]})]})}),j.jsx(Ui.div,{initial:{opacity:0,x:20},whileInView:{opacity:1,x:0},transition:{duration:.5,delay:.2},viewport:{once:!0},children:j.jsx(av,{className:"overflow-hidden border border-border/40 bg-background/60 backdrop-blur-sm",children:j.jsxs(ov,{className:"p-6",children:[j.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Compétences"}),j.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((a,o)=>j.jsxs("span",{className:an("px-3 py-1 rounded-full text-sm flex items-center gap-2","bg-primary/10 text-primary"),children:[Dbe(a),a]},o))}),j.jsxs("div",{className:"mt-8",children:[j.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Expérience"}),j.jsx("div",{className:"space-y-4",children:n.map((a,o)=>j.jsxs(Ui.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0,amount:.3},transition:{duration:.5,delay:.1*o,type:"spring",stiffness:100},className:"border-l-2 border-primary/50 pl-4",children:[j.jsx(Ui.h4,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.3,delay:.1*o+.1},className:"font-medium",children:a.title}),j.jsxs(Ui.p,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.3,delay:.1*o+.2},className:"text-sm text-muted-foreground",children:[a.company," | ",a.period]}),j.jsx(Ui.p,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.3,delay:.1*o+.3},className:"text-sm mt-1",children:a.description})]},o))})]}),j.jsxs("div",{className:"mt-8",children:[j.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Formation"}),j.jsx("div",{className:"space-y-4",children:s.map((a,o)=>j.jsxs(Ui.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0,amount:.3},transition:{duration:.5,delay:.1*o,type:"spring",stiffness:100},children:[j.jsx("h4",{className:"font-medium",children:a.degree}),j.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.institution," | ",a.year]})]},o))})]})]})})})]})]})});function Obe(e){return lu({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m16.24 11.51 1.57-1.57-3.75-3.75-1.57 1.57-4.14-4.13c-.78-.78-2.05-.78-2.83 0l-1.9 1.9c-.78.78-.78 2.05 0 2.83l4.13 4.13L3 17.25V21h3.75l4.76-4.76 4.13 4.13c.95.95 2.23.6 2.83 0l1.9-1.9c.78-.78.78-2.05 0-2.83l-4.13-4.13zm-7.06-.44L5.04 6.94l1.89-1.9L8.2 6.31 7.02 7.5l1.41 1.41 1.19-1.19 1.45 1.45-1.89 1.9zm7.88 7.89-4.13-4.13 1.9-1.9 1.45 1.45-1.19 1.19 1.41 1.41 1.19-1.19 1.27 1.27-1.9 1.9zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34c-.47-.47-1.12-.29-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(e)}const mE={frontend:[{name:"React",level:90},{name:"TypeScript",level:85},{name:"Tailwind CSS",level:95},{name:"Next.js",level:85}],backend:[{name:"Node.js",level:80},{name:"Express",level:75},{name:"MongoDB",level:70},{name:"GraphQL",level:70}],design:[{name:"Figma",level:85},{name:"UI/UX Design",level:80}],tools:[{name:"Git",level:90},{name:"Docker",level:65}]},Rbe={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3,when:"beforeChildren",staggerChildren:.1}}},Lbe={hidden:{opacity:0,x:-5},visible:{opacity:1,x:0,transition:{duration:.2,ease:"easeOut"}}},Nbe=({title:e="Compétences",description:t="Mes compétences techniques et mon niveau d'expertise"})=>{const i=de.useMemo(()=>s=>({React:j.jsx(PZ,{className:"w-5 h-5 text-[#61DAFB]"}),TypeScript:j.jsx(LZ,{className:"w-5 h-5 text-[#3178C6]"}),"Tailwind CSS":j.jsx(RZ,{className:"w-5 h-5 text-[#06B6D4]"}),"Next.js":j.jsx(OZ,{className:"w-5 h-5 text-[#000000] dark:text-white"}),"Node.js":j.jsx(MZ,{className:"w-5 h-5 text-[#339933]"}),Express:j.jsx(Mbe,{className:"w-5 h-5 text-[#000000] dark:text-white"}),MongoDB:j.jsx(IZ,{className:"w-5 h-5 text-[#47A248]"}),GraphQL:j.jsx(DZ,{className:"w-5 h-5 text-[#E10098]"}),Figma:j.jsx(Cbe,{className:"w-5 h-5 text-[#F24E1E]"}),"UI/UX Design":j.jsx(Obe,{className:"w-5 h-5 text-[#FF69B4]"}),Git:j.jsx(Abe,{className:"w-5 h-5 text-[#F05032]"}),Docker:j.jsx(Tbe,{className:"w-5 h-5 text-[#2496ED]"})})[s]||null,[]),r=ci.memo(({skill:s,index:a})=>{const[o,l]=ci.useState(0),u=ci.useRef(null),c=Bj(u,{once:!0,amount:.5,margin:"50px"});ci.useEffect(()=>{if(!c)return;let d;const f=performance.now(),m=1e3,g=y=>{const x=y-f,w=Math.min(x/m,1);l(Math.floor(w*s.level)),w<1&&(d=requestAnimationFrame(g))};return d=requestAnimationFrame(g),()=>cancelAnimationFrame(d)},[c,s.level]);const h={transform:"translate3d(0,0,0)",backfaceVisibility:"hidden",willChange:"transform",contain:"paint layout"};return j.jsxs(Ui.div,{ref:u,className:"space-y-2",variants:Lbe,custom:a,style:h,initial:"hidden",animate:c?"visible":"hidden",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[i(s.name),j.jsx("span",{className:"font-medium",children:s.name})]}),j.jsxs("span",{className:"text-sm text-muted-foreground font-bold",children:[o,"%"]})]}),j.jsx("div",{className:"h-2 w-full bg-secondary/30 rounded-full overflow-hidden",children:j.jsx(Ui.div,{className:"h-full bg-gradient-to-r from-primary/80 to-primary relative",initial:{width:0},animate:{width:c?`${s.level}%`:0},transition:{duration:.8,delay:a*.05,ease:"easeOut"},style:h,children:j.jsx(Ui.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",animate:{x:["0%","100%"]},transition:{repeat:c?1/0:0,repeatDelay:.5,duration:1,ease:"linear",delay:a*.05},style:h})})})]})}),n=ci.memo(({title:s,skills:a})=>{const o=ci.useRef(null),l=Bj(o,{once:!0,amount:.2,margin:"100px"}),u=q1e();return ci.useEffect(()=>{l&&u.start("visible")},[l,u]),j.jsx(Ui.div,{ref:o,variants:Rbe,initial:"hidden",animate:u,children:j.jsxs(av,{className:"border border-border/40 bg-background/60 backdrop-blur-sm h-full",children:[j.jsx(H_,{children:j.jsx(W_,{children:s})}),j.jsx(ov,{className:"space-y-4",children:a.map((c,h)=>j.jsx(r,{skill:c,index:h},c.name))})]})})});return j.jsx("section",{className:"py-20 bg-background",children:j.jsxs("div",{className:"container px-4 md:px-6",children:[j.jsxs(Ui.div,{className:"flex flex-col items-center text-center mb-12",initial:{opacity:0,y:-20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.7},children:[j.jsx("h2",{className:"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl mb-4",children:e}),j.jsx("p",{className:"text-muted-foreground max-w-[700px] mb-8",children:t})]}),j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[j.jsx(n,{title:"Frontend",skills:mE.frontend}),j.jsx(n,{title:"Backend",skills:mE.backend}),j.jsx(n,{title:"Design",skills:mE.design}),j.jsx(n,{title:"Outils",skills:mE.tools})]})]})})};function Ho(e,t,{checkForDefaultPrevented:i=!0}={}){return function(n){if(e==null||e(n),i===!1||!n.defaultPrevented)return t==null?void 0:t(n)}}function fM(e,t=[]){let i=[];function r(s,a){const o=de.createContext(a),l=i.length;i=[...i,a];const u=h=>{var x;const{scope:d,children:f,...m}=h,g=((x=d==null?void 0:d[e])==null?void 0:x[l])||o,y=de.useMemo(()=>m,Object.values(m));return j.jsx(g.Provider,{value:y,children:f})};u.displayName=s+"Provider";function c(h,d){var g;const f=((g=d==null?void 0:d[e])==null?void 0:g[l])||o,m=de.useContext(f);if(m)return m;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${s}\``)}return[u,c]}const n=()=>{const s=i.map(a=>de.createContext(a));return function(o){const l=(o==null?void 0:o[e])||s;return de.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return n.scopeName=e,[r,kbe(n,...t)]}function kbe(...e){const t=e[0];if(e.length===1)return t;const i=()=>{const r=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(s){const a=r.reduce((o,{useScope:l,scopeName:u})=>{const h=l(s)[`__scope${u}`];return{...o,...h}},{});return de.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return i.scopeName=t.scopeName,i}function NZ(e){const t=e+"CollectionProvider",[i,r]=fM(t),[n,s]=i(t,{collectionRef:{current:null},itemMap:new Map}),a=f=>{const{scope:m,children:g}=f,y=ci.useRef(null),x=ci.useRef(new Map).current;return j.jsx(n,{scope:m,itemMap:x,collectionRef:y,children:g})};a.displayName=t;const o=e+"CollectionSlot",l=ci.forwardRef((f,m)=>{const{scope:g,children:y}=f,x=s(o,g),w=of(m,x.collectionRef);return j.jsx(My,{ref:w,children:y})});l.displayName=o;const u=e+"CollectionItemSlot",c="data-radix-collection-item",h=ci.forwardRef((f,m)=>{const{scope:g,children:y,...x}=f,w=ci.useRef(null),b=of(m,w),C=s(u,g);return ci.useEffect(()=>(C.itemMap.set(w,{ref:w,...x}),()=>void C.itemMap.delete(w))),j.jsx(My,{[c]:"",ref:b,children:y})});h.displayName=u;function d(f){const m=s(e+"CollectionConsumer",f);return ci.useCallback(()=>{const y=m.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${c}]`));return Array.from(m.itemMap.values()).sort((C,A)=>x.indexOf(C.ref.current)-x.indexOf(A.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:a,Slot:l,ItemSlot:h},d,r]}var bC=globalThis!=null&&globalThis.document?de.useLayoutEffect:()=>{},Bbe=dY.useId||(()=>{}),zbe=0;function kZ(e){const[t,i]=de.useState(Bbe());return bC(()=>{i(r=>r??String(zbe++))},[e]),t?`radix-${t}`:""}var Fbe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Oc=Fbe.reduce((e,t)=>{const i=de.forwardRef((r,n)=>{const{asChild:s,...a}=r,o=s?My:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),j.jsx(o,{...a,ref:n})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function I4(e){const t=de.useRef(e);return de.useEffect(()=>{t.current=e}),de.useMemo(()=>(...i)=>{var r;return(r=t.current)==null?void 0:r.call(t,...i)},[])}function O4({prop:e,defaultProp:t,onChange:i=()=>{}}){const[r,n]=Ube({defaultProp:t,onChange:i}),s=e!==void 0,a=s?e:r,o=I4(i),l=de.useCallback(u=>{if(s){const h=typeof u=="function"?u(e):u;h!==e&&o(h)}else n(u)},[s,e,n,o]);return[a,l]}function Ube({defaultProp:e,onChange:t}){const i=de.useState(e),[r]=i,n=de.useRef(r),s=I4(t);return de.useEffect(()=>{n.current!==r&&(s(r),n.current=r)},[r,n,s]),i}var jbe=de.createContext(void 0);function R4(e){const t=de.useContext(jbe);return e||t||"ltr"}var aD="rovingFocusGroup.onEntryFocus",Vbe={bubbles:!1,cancelable:!0},pM="RovingFocusGroup",[_3,BZ,Hbe]=NZ(pM),[Wbe,zZ]=fM(pM,[Hbe]),[Gbe,qbe]=Wbe(pM),FZ=de.forwardRef((e,t)=>j.jsx(_3.Provider,{scope:e.__scopeRovingFocusGroup,children:j.jsx(_3.Slot,{scope:e.__scopeRovingFocusGroup,children:j.jsx(Ybe,{...e,ref:t})})}));FZ.displayName=pM;var Ybe=de.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:i,orientation:r,loop:n=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:c=!1,...h}=e,d=de.useRef(null),f=of(t,d),m=R4(s),[g=null,y]=O4({prop:a,defaultProp:o,onChange:l}),[x,w]=de.useState(!1),b=I4(u),C=BZ(i),A=de.useRef(!1),[E,_]=de.useState(0);return de.useEffect(()=>{const P=d.current;if(P)return P.addEventListener(aD,b),()=>P.removeEventListener(aD,b)},[b]),j.jsx(Gbe,{scope:i,orientation:r,dir:m,loop:n,currentTabStopId:g,onItemFocus:de.useCallback(P=>y(P),[y]),onItemShiftTab:de.useCallback(()=>w(!0),[]),onFocusableItemAdd:de.useCallback(()=>_(P=>P+1),[]),onFocusableItemRemove:de.useCallback(()=>_(P=>P-1),[]),children:j.jsx(Oc.div,{tabIndex:x||E===0?-1:0,"data-orientation":r,...h,ref:f,style:{outline:"none",...e.style},onMouseDown:Ho(e.onMouseDown,()=>{A.current=!0}),onFocus:Ho(e.onFocus,P=>{const I=!A.current;if(P.target===P.currentTarget&&I&&!x){const D=new CustomEvent(aD,Vbe);if(P.currentTarget.dispatchEvent(D),!D.defaultPrevented){const k=C().filter(Z=>Z.focusable),B=k.find(Z=>Z.active),z=k.find(Z=>Z.id===g),$=[B,z,...k].filter(Boolean).map(Z=>Z.ref.current);VZ($,c)}}A.current=!1}),onBlur:Ho(e.onBlur,()=>w(!1))})})}),UZ="RovingFocusGroupItem",jZ=de.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:i,focusable:r=!0,active:n=!1,tabStopId:s,...a}=e,o=kZ(),l=s||o,u=qbe(UZ,i),c=u.currentTabStopId===l,h=BZ(i),{onFocusableItemAdd:d,onFocusableItemRemove:f}=u;return de.useEffect(()=>{if(r)return d(),()=>f()},[r,d,f]),j.jsx(_3.ItemSlot,{scope:i,id:l,focusable:r,active:n,children:j.jsx(Oc.span,{tabIndex:c?0:-1,"data-orientation":u.orientation,...a,ref:t,onMouseDown:Ho(e.onMouseDown,m=>{r?u.onItemFocus(l):m.preventDefault()}),onFocus:Ho(e.onFocus,()=>u.onItemFocus(l)),onKeyDown:Ho(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){u.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const g=$be(m,u.orientation,u.dir);if(g!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let x=h().filter(w=>w.focusable).map(w=>w.ref.current);if(g==="last")x.reverse();else if(g==="prev"||g==="next"){g==="prev"&&x.reverse();const w=x.indexOf(m.currentTarget);x=u.loop?Zbe(x,w+1):x.slice(w+1)}setTimeout(()=>VZ(x))}})})})});jZ.displayName=UZ;var Xbe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Kbe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function $be(e,t,i){const r=Kbe(e.key,i);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Xbe[r]}function VZ(e,t=!1){const i=document.activeElement;for(const r of e)if(r===i||(r.focus({preventScroll:t}),document.activeElement!==i))return}function Zbe(e,t){return e.map((i,r)=>e[(t+r)%e.length])}var Qbe=FZ,Jbe=jZ;function e_e(e,t){return de.useReducer((i,r)=>t[i][r]??i,e)}var HZ=e=>{const{present:t,children:i}=e,r=t_e(t),n=typeof i=="function"?i({present:r.isPresent}):de.Children.only(i),s=of(r.ref,i_e(n));return typeof i=="function"||r.isPresent?de.cloneElement(n,{ref:s}):null};HZ.displayName="Presence";function t_e(e){const[t,i]=de.useState(),r=de.useRef({}),n=de.useRef(e),s=de.useRef("none"),a=e?"mounted":"unmounted",[o,l]=e_e(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return de.useEffect(()=>{const u=gE(r.current);s.current=o==="mounted"?u:"none"},[o]),bC(()=>{const u=r.current,c=n.current;if(c!==e){const d=s.current,f=gE(u);e?l("MOUNT"):f==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&d!==f?"ANIMATION_OUT":"UNMOUNT"),n.current=e}},[e,l]),bC(()=>{if(t){let u;const c=t.ownerDocument.defaultView??window,h=f=>{const g=gE(r.current).includes(f.animationName);if(f.target===t&&g&&(l("ANIMATION_END"),!n.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",u=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},d=f=>{f.target===t&&(s.current=gE(r.current))};return t.addEventListener("animationstart",d),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{c.clearTimeout(u),t.removeEventListener("animationstart",d),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:de.useCallback(u=>{u&&(r.current=getComputedStyle(u)),i(u)},[])}}function gE(e){return(e==null?void 0:e.animationName)||"none"}function i_e(e){var r,n;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,i=t&&"isReactWarning"in t&&t.isReactWarning;return i?e.ref:(t=(n=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:n.get,i=t&&"isReactWarning"in t&&t.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var L4="Tabs",[r_e,yst]=fM(L4,[zZ]),WZ=zZ(),[n_e,N4]=r_e(L4),GZ=de.forwardRef((e,t)=>{const{__scopeTabs:i,value:r,onValueChange:n,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...u}=e,c=R4(o),[h,d]=O4({prop:r,onChange:n,defaultProp:s});return j.jsx(n_e,{scope:i,baseId:kZ(),value:h,onValueChange:d,orientation:a,dir:c,activationMode:l,children:j.jsx(Oc.div,{dir:c,"data-orientation":a,...u,ref:t})})});GZ.displayName=L4;var qZ="TabsList",YZ=de.forwardRef((e,t)=>{const{__scopeTabs:i,loop:r=!0,...n}=e,s=N4(qZ,i),a=WZ(i);return j.jsx(Qbe,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:r,children:j.jsx(Oc.div,{role:"tablist","aria-orientation":s.orientation,...n,ref:t})})});YZ.displayName=qZ;var XZ="TabsTrigger",KZ=de.forwardRef((e,t)=>{const{__scopeTabs:i,value:r,disabled:n=!1,...s}=e,a=N4(XZ,i),o=WZ(i),l=QZ(a.baseId,r),u=JZ(a.baseId,r),c=r===a.value;return j.jsx(Jbe,{asChild:!0,...o,focusable:!n,active:c,children:j.jsx(Oc.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:l,...s,ref:t,onMouseDown:Ho(e.onMouseDown,h=>{!n&&h.button===0&&h.ctrlKey===!1?a.onValueChange(r):h.preventDefault()}),onKeyDown:Ho(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&a.onValueChange(r)}),onFocus:Ho(e.onFocus,()=>{const h=a.activationMode!=="manual";!c&&!n&&h&&a.onValueChange(r)})})})});KZ.displayName=XZ;var $Z="TabsContent",ZZ=de.forwardRef((e,t)=>{const{__scopeTabs:i,value:r,forceMount:n,children:s,...a}=e,o=N4($Z,i),l=QZ(o.baseId,r),u=JZ(o.baseId,r),c=r===o.value,h=de.useRef(c);return de.useEffect(()=>{const d=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(d)},[]),j.jsx(HZ,{present:n||c,children:({present:d})=>j.jsx(Oc.div,{"data-state":c?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!d,id:u,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:d&&s})})});ZZ.displayName=$Z;function QZ(e,t){return`${e}-trigger-${t}`}function JZ(e,t){return`${e}-content-${t}`}var s_e=GZ,eQ=YZ,tQ=KZ,iQ=ZZ;const a_e=s_e,rQ=de.forwardRef(({className:e,...t},i)=>j.jsx(eQ,{ref:i,className:an("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...t}));rQ.displayName=eQ.displayName;const nQ=de.forwardRef(({className:e,...t},i)=>j.jsx(tQ,{ref:i,className:an("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...t}));nQ.displayName=tQ.displayName;const sQ=de.forwardRef(({className:e,...t},i)=>j.jsx(iQ,{ref:i,className:an("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));sQ.displayName=iQ.displayName;const o_e=C4("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function aQ({className:e,variant:t,...i}){return j.jsx("div",{className:an(o_e({variant:t}),e),...i})}const l_e=({title:e="Titre du Projet",description:t="Une brève description du projet présentant les principales fonctionnalités et technologies utilisées.",image:i="https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=800&q=80",technologies:r=["React","TypeScript","Tailwind CSS"],githubUrl:n="#",liveUrl:s="#"})=>j.jsx(Ui.div,{whileHover:{y:-10},transition:{type:"spring",stiffness:300},className:"h-full",children:j.jsxs(av,{className:"h-full overflow-hidden flex flex-col bg-card border border-border hover:border-primary/50 transition-all duration-300 hover:shadow-lg",children:[j.jsxs("div",{className:"relative overflow-hidden aspect-video",children:[j.jsx(Ui.img,{src:i,alt:e,className:"w-full h-full object-cover transition-transform duration-500 hover:scale-105",whileHover:{scale:1.05}}),j.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:j.jsxs(Ui.div,{initial:{opacity:0,y:20},whileHover:{opacity:1,y:0},transition:{duration:.3},children:[s&&j.jsx(Zn,{size:"sm",className:"mr-2",asChild:!0,children:j.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:[j.jsx(Hj,{className:"mr-2 h-4 w-4"}),"Démo"]})}),n&&j.jsx(Zn,{variant:"outline",size:"sm",className:"bg-background/80",asChild:!0,children:j.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:[j.jsx(vC,{className:"mr-2 h-4 w-4"}),"Code"]})})]})})]}),j.jsx(H_,{className:"pb-2",children:j.jsx(W_,{className:"text-xl font-bold hover:text-primary transition-colors",children:e})}),j.jsxs(ov,{className:"flex-grow",children:[j.jsx(hM,{className:"text-sm text-muted-foreground mb-4",children:t}),j.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.map((a,o)=>j.jsx(aQ,{variant:"secondary",className:"text-xs hover:bg-secondary/80 transition-colors",children:a},o))})]}),j.jsxs(dM,{className:"flex justify-between pt-2",children:[n&&j.jsx(Zn,{variant:"outline",size:"sm",className:"hover:bg-primary/10 transition-colors",asChild:!0,children:j.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:[j.jsx(vC,{className:"mr-2 h-4 w-4"}),"Code"]})}),s&&j.jsx(Zn,{size:"sm",className:"hover:bg-primary/90 transition-colors",asChild:!0,children:j.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:[j.jsx(Hj,{className:"mr-2 h-4 w-4"}),"Démo"]})})]})]})}),u_e=({title:e="Mes Projets",description:t="Voici quelques-uns de mes projets récents. Chacun a été soigneusement élaboré avec une attention particulière aux détails et aux technologies modernes.",projects:i=[{id:1,title:"Plateforme E-Commerce",description:"Une plateforme e-commerce complète avec gestion des produits, fonctionnalités de panier et processus de paiement sécurisé.",image:"https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=800&q=80",technologies:["React","Node.js","MongoDB","Stripe"],githubUrl:"#",liveUrl:"#",category:"web"},{id:2,title:"Application de Gestion de Tâches",description:"Une application de productivité pour gérer les tâches, les projets et la collaboration d'équipe avec des mises à jour en temps réel.",image:"https://images.unsplash.com/photo-1540350394557-8d14678e7f91?w=800&q=80",technologies:["React","Firebase","Tailwind CSS"],githubUrl:"#",liveUrl:"#",category:"web"},{id:3,title:"Site Portfolio",description:"Un site portfolio moderne présentant des projets et des compétences avec un design épuré et minimaliste.",image:"https://images.unsplash.com/photo-1517180102446-f3ece451e9d8?w=800&q=80",technologies:["React","Tailwind CSS","Framer Motion"],githubUrl:"#",liveUrl:"#",category:"web"},{id:4,title:"Tableau de Bord Météo",description:"Une application météo qui fournit des prévisions en temps réel, des données historiques et des cartes interactives.",image:"https://images.unsplash.com/photo-1592210454359-9043f067919b?w=800&q=80",technologies:["JavaScript","Weather API","Chart.js"],githubUrl:"#",liveUrl:"#",category:"mobile"},{id:5,title:"Tableau de Bord Réseaux Sociaux",description:"Un tableau de bord d'analyse pour suivre les performances des réseaux sociaux sur plusieurs plateformes.",image:"https://images.unsplash.com/photo-1611162617213-7d7a39e9b1d7?w=800&q=80",technologies:["React","D3.js","Social Media APIs"],githubUrl:"#",liveUrl:"#",category:"design"},{id:6,title:"Suivi de Fitness",description:"Une application mobile pour suivre les entraînements, la nutrition et les progrès de fitness avec des recommandations personnalisées.",image:"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800&q=80",technologies:["React Native","Firebase","Health APIs"],githubUrl:"#",liveUrl:"#",category:"mobile"}]})=>{const[r,n]=de.useState("tous"),s=["tous",...new Set(i.map(u=>u.category==="web"?"web":u.category==="mobile"?"mobile":u.category==="design"?"design":u.category))],a=r==="tous"?i:i.filter(u=>u.category===r),o={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},l={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}};return j.jsx("section",{id:"projects",className:"py-20 bg-background",children:j.jsxs("div",{className:"container mx-auto px-4",children:[j.jsxs("div",{className:"text-center mb-16",children:[j.jsx(Ui.h2,{initial:{opacity:0,y:-20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"text-3xl md:text-4xl font-bold mb-4",children:e}),j.jsx(Ui.p,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},viewport:{once:!0},className:"text-muted-foreground max-w-2xl mx-auto",children:t})]}),j.jsxs(a_e,{defaultValue:"tous",className:"mb-12",children:[j.jsx("div",{className:"flex justify-center",children:j.jsx(rQ,{children:s.map(u=>j.jsx(nQ,{value:u,onClick:()=>n(u),className:"capitalize",children:u},u))})}),j.jsx(sQ,{value:r,className:"mt-8",children:j.jsx(Ui.div,{variants:o,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:a.map(u=>j.jsx(Ui.div,{variants:l,children:j.jsx(l_e,{title:u.title,description:u.description,image:u.image,technologies:u.technologies,githubUrl:u.githubUrl,liveUrl:u.liveUrl})},u.id))})})]}),j.jsx("div",{className:"text-center mt-12",children:j.jsx(Zn,{size:"lg",asChild:!0,children:j.jsx("a",{href:"#contact",className:"px-8",children:"Get in Touch"})})})]})})};var q_=e=>e.type==="checkbox",yg=e=>e instanceof Date,Bo=e=>e==null;const oQ=e=>typeof e=="object";var gs=e=>!Bo(e)&&!Array.isArray(e)&&oQ(e)&&!yg(e),lQ=e=>gs(e)&&e.target?q_(e.target)?e.target.checked:e.target.value:e,c_e=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,uQ=(e,t)=>e.has(c_e(t)),h_e=e=>{const t=e.constructor&&e.constructor.prototype;return gs(t)&&t.hasOwnProperty("isPrototypeOf")},k4=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function gl(e){let t;const i=Array.isArray(e),r=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(k4&&(e instanceof Blob||r))&&(i||gs(e)))if(t=i?[]:{},!i&&!h_e(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=gl(e[n]));else return e;return t}var mM=e=>Array.isArray(e)?e.filter(Boolean):[],fs=e=>e===void 0,qt=(e,t,i)=>{if(!t||!gs(e))return i;const r=mM(t.split(/[,[\].]+?/)).reduce((n,s)=>Bo(n)?n:n[s],e);return fs(r)||r===e?fs(e[t])?i:e[t]:r},Au=e=>typeof e=="boolean",B4=e=>/^\w*$/.test(e),cQ=e=>mM(e.replace(/["|']|\]/g,"").split(/\.|\[/)),cn=(e,t,i)=>{let r=-1;const n=B4(t)?[t]:cQ(t),s=n.length,a=s-1;for(;++r<s;){const o=n[r];let l=i;if(r!==a){const u=e[o];l=gs(u)||Array.isArray(u)?u:isNaN(+n[r+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;e[o]=l,e=e[o]}return e};const _C={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},pc={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},md={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},hQ=ci.createContext(null),gM=()=>ci.useContext(hQ),d_e=e=>{const{children:t,...i}=e;return ci.createElement(hQ.Provider,{value:i},t)};var dQ=(e,t,i,r=!0)=>{const n={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(n,s,{get:()=>{const a=s;return t._proxyFormState[a]!==pc.all&&(t._proxyFormState[a]=!r||pc.all),i&&(i[a]=!0),e[a]}});return n},vl=e=>gs(e)&&!Object.keys(e).length,fQ=(e,t,i,r)=>{i(e);const{name:n,...s}=e;return vl(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(a=>t[a]===(!r||pc.all))},fb=e=>Array.isArray(e)?e:[e],pQ=(e,t,i)=>!e||!t||e===t||fb(e).some(r=>r&&(i?r===t:r.startsWith(t)||t.startsWith(r)));function z4(e){const t=ci.useRef(e);t.current=e,ci.useEffect(()=>{const i=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{i&&i.unsubscribe()}},[e.disabled])}function f_e(e){const t=gM(),{control:i=t.control,disabled:r,name:n,exact:s}=e||{},[a,o]=ci.useState(i._formState),l=ci.useRef(!0),u=ci.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),c=ci.useRef(n);return c.current=n,z4({disabled:r,next:h=>l.current&&pQ(c.current,h.name,s)&&fQ(h,u.current,i._updateFormState)&&o({...i._formState,...h}),subject:i._subjects.state}),ci.useEffect(()=>(l.current=!0,u.current.isValid&&i._updateValid(!0),()=>{l.current=!1}),[i]),ci.useMemo(()=>dQ(a,i,u.current,!1),[a,i])}var bh=e=>typeof e=="string",mQ=(e,t,i,r,n)=>bh(e)?(r&&t.watch.add(e),qt(i,e,n)):Array.isArray(e)?e.map(s=>(r&&t.watch.add(s),qt(i,s))):(r&&(t.watchAll=!0),i);function p_e(e){const t=gM(),{control:i=t.control,name:r,defaultValue:n,disabled:s,exact:a}=e||{},o=ci.useRef(r);o.current=r,z4({disabled:s,subject:i._subjects.values,next:c=>{pQ(o.current,c.name,a)&&u(gl(mQ(o.current,i._names,c.values||i._formValues,!1,n)))}});const[l,u]=ci.useState(i._getWatch(r,n));return ci.useEffect(()=>i._removeUnmounted()),l}function m_e(e){const t=gM(),{name:i,disabled:r,control:n=t.control,shouldUnregister:s}=e,a=uQ(n._names.array,i),o=p_e({control:n,name:i,defaultValue:qt(n._formValues,i,qt(n._defaultValues,i,e.defaultValue)),exact:!0}),l=f_e({control:n,name:i,exact:!0}),u=ci.useRef(n.register(i,{...e.rules,value:o,...Au(e.disabled)?{disabled:e.disabled}:{}})),c=ci.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!qt(l.errors,i)},isDirty:{enumerable:!0,get:()=>!!qt(l.dirtyFields,i)},isTouched:{enumerable:!0,get:()=>!!qt(l.touchedFields,i)},isValidating:{enumerable:!0,get:()=>!!qt(l.validatingFields,i)},error:{enumerable:!0,get:()=>qt(l.errors,i)}}),[l,i]),h=ci.useMemo(()=>({name:i,value:o,...Au(r)||l.disabled?{disabled:l.disabled||r}:{},onChange:d=>u.current.onChange({target:{value:lQ(d),name:i},type:_C.CHANGE}),onBlur:()=>u.current.onBlur({target:{value:qt(n._formValues,i),name:i},type:_C.BLUR}),ref:d=>{const f=qt(n._fields,i);f&&d&&(f._f.ref={focus:()=>d.focus(),select:()=>d.select(),setCustomValidity:m=>d.setCustomValidity(m),reportValidity:()=>d.reportValidity()})}}),[i,n._formValues,r,l.disabled,o,n._fields]);return ci.useEffect(()=>{const d=n._options.shouldUnregister||s,f=(m,g)=>{const y=qt(n._fields,m);y&&y._f&&(y._f.mount=g)};if(f(i,!0),d){const m=gl(qt(n._options.defaultValues,i));cn(n._defaultValues,i,m),fs(qt(n._formValues,i))&&cn(n._formValues,i,m)}return!a&&n.register(i),()=>{(a?d&&!n._state.action:d)?n.unregister(i):f(i,!1)}},[i,n,a,s]),ci.useEffect(()=>{n._updateDisabledField({disabled:r,fields:n._fields,name:i})},[r,i,n]),ci.useMemo(()=>({field:h,formState:l,fieldState:c}),[h,l,c])}const g_e=e=>e.render(m_e(e));var v_e=(e,t,i,r,n)=>t?{...i[e],types:{...i[e]&&i[e].types?i[e].types:{},[r]:n||!0}}:{},Xj=e=>({isOnSubmit:!e||e===pc.onSubmit,isOnBlur:e===pc.onBlur,isOnChange:e===pc.onChange,isOnAll:e===pc.all,isOnTouch:e===pc.onTouched}),Kj=(e,t,i)=>!i&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const pb=(e,t,i,r)=>{for(const n of i||Object.keys(e)){const s=qt(e,n);if(s){const{_f:a,...o}=s;if(a){if(a.refs&&a.refs[0]&&t(a.refs[0],n)&&!r)return!0;if(a.ref&&t(a.ref,a.name)&&!r)return!0;if(pb(o,t))break}else if(gs(o)&&pb(o,t))break}}};var y_e=(e,t,i)=>{const r=fb(qt(e,i));return cn(r,"root",t[i]),cn(e,i,r),e},F4=e=>e.type==="file",fh=e=>typeof e=="function",wC=e=>{if(!k4)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},vT=e=>bh(e),U4=e=>e.type==="radio",EC=e=>e instanceof RegExp;const $j={value:!1,isValid:!1},Zj={value:!0,isValid:!0};var gQ=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(i=>i&&i.checked&&!i.disabled).map(i=>i.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!fs(e[0].attributes.value)?fs(e[0].value)||e[0].value===""?Zj:{value:e[0].value,isValid:!0}:Zj:$j}return $j};const Qj={isValid:!1,value:null};var vQ=e=>Array.isArray(e)?e.reduce((t,i)=>i&&i.checked&&!i.disabled?{isValid:!0,value:i.value}:t,Qj):Qj;function Jj(e,t,i="validate"){if(vT(e)||Array.isArray(e)&&e.every(vT)||Au(e)&&!e)return{type:i,message:vT(e)?e:"",ref:t}}var Iv=e=>gs(e)&&!EC(e)?e:{value:e,message:""},eV=async(e,t,i,r,n,s)=>{const{ref:a,refs:o,required:l,maxLength:u,minLength:c,min:h,max:d,pattern:f,validate:m,name:g,valueAsNumber:y,mount:x}=e._f,w=qt(i,g);if(!x||t.has(g))return{};const b=o?o[0]:a,C=B=>{n&&b.reportValidity&&(b.setCustomValidity(Au(B)?"":B||""),b.reportValidity())},A={},E=U4(a),_=q_(a),P=E||_,I=(y||F4(a))&&fs(a.value)&&fs(w)||wC(a)&&a.value===""||w===""||Array.isArray(w)&&!w.length,D=v_e.bind(null,g,r,A),k=(B,z,W,$=md.maxLength,Z=md.minLength)=>{const G=B?z:W;A[g]={type:B?$:Z,message:G,ref:a,...D(B?$:Z,G)}};if(s?!Array.isArray(w)||!w.length:l&&(!P&&(I||Bo(w))||Au(w)&&!w||_&&!gQ(o).isValid||E&&!vQ(o).isValid)){const{value:B,message:z}=vT(l)?{value:!!l,message:l}:Iv(l);if(B&&(A[g]={type:md.required,message:z,ref:b,...D(md.required,z)},!r))return C(z),A}if(!I&&(!Bo(h)||!Bo(d))){let B,z;const W=Iv(d),$=Iv(h);if(!Bo(w)&&!isNaN(w)){const Z=a.valueAsNumber||w&&+w;Bo(W.value)||(B=Z>W.value),Bo($.value)||(z=Z<$.value)}else{const Z=a.valueAsDate||new Date(w),G=U=>new Date(new Date().toDateString()+" "+U),V=a.type=="time",J=a.type=="week";bh(W.value)&&w&&(B=V?G(w)>G(W.value):J?w>W.value:Z>new Date(W.value)),bh($.value)&&w&&(z=V?G(w)<G($.value):J?w<$.value:Z<new Date($.value))}if((B||z)&&(k(!!B,W.message,$.message,md.max,md.min),!r))return C(A[g].message),A}if((u||c)&&!I&&(bh(w)||s&&Array.isArray(w))){const B=Iv(u),z=Iv(c),W=!Bo(B.value)&&w.length>+B.value,$=!Bo(z.value)&&w.length<+z.value;if((W||$)&&(k(W,B.message,z.message),!r))return C(A[g].message),A}if(f&&!I&&bh(w)){const{value:B,message:z}=Iv(f);if(EC(B)&&!w.match(B)&&(A[g]={type:md.pattern,message:z,ref:a,...D(md.pattern,z)},!r))return C(z),A}if(m){if(fh(m)){const B=await m(w,i),z=Jj(B,b);if(z&&(A[g]={...z,...D(md.validate,z.message)},!r))return C(z.message),A}else if(gs(m)){let B={};for(const z in m){if(!vl(B)&&!r)break;const W=Jj(await m[z](w,i),b,z);W&&(B={...W,...D(z,W.message)},C(W.message),r&&(A[g]=B))}if(!vl(B)&&(A[g]={ref:b,...B},!r))return A}}return C(!0),A};function x_e(e,t){const i=t.slice(0,-1).length;let r=0;for(;r<i;)e=fs(e)?r++:e[t[r++]];return e}function b_e(e){for(const t in e)if(e.hasOwnProperty(t)&&!fs(e[t]))return!1;return!0}function Ws(e,t){const i=Array.isArray(t)?t:B4(t)?[t]:cQ(t),r=i.length===1?e:x_e(e,i),n=i.length-1,s=i[n];return r&&delete r[s],n!==0&&(gs(r)&&vl(r)||Array.isArray(r)&&b_e(r))&&Ws(e,i.slice(0,-1)),e}var oD=()=>{let e=[];return{get observers(){return e},next:n=>{for(const s of e)s.next&&s.next(n)},subscribe:n=>(e.push(n),{unsubscribe:()=>{e=e.filter(s=>s!==n)}}),unsubscribe:()=>{e=[]}}},w3=e=>Bo(e)||!oQ(e);function up(e,t){if(w3(e)||w3(t))return e===t;if(yg(e)&&yg(t))return e.getTime()===t.getTime();const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(const n of i){const s=e[n];if(!r.includes(n))return!1;if(n!=="ref"){const a=t[n];if(yg(s)&&yg(a)||gs(s)&&gs(a)||Array.isArray(s)&&Array.isArray(a)?!up(s,a):s!==a)return!1}}return!0}var yQ=e=>e.type==="select-multiple",__e=e=>U4(e)||q_(e),lD=e=>wC(e)&&e.isConnected,xQ=e=>{for(const t in e)if(fh(e[t]))return!0;return!1};function SC(e,t={}){const i=Array.isArray(e);if(gs(e)||i)for(const r in e)Array.isArray(e[r])||gs(e[r])&&!xQ(e[r])?(t[r]=Array.isArray(e[r])?[]:{},SC(e[r],t[r])):Bo(e[r])||(t[r]=!0);return t}function bQ(e,t,i){const r=Array.isArray(e);if(gs(e)||r)for(const n in e)Array.isArray(e[n])||gs(e[n])&&!xQ(e[n])?fs(t)||w3(i[n])?i[n]=Array.isArray(e[n])?SC(e[n],[]):{...SC(e[n])}:bQ(e[n],Bo(t)?{}:t[n],i[n]):i[n]=!up(e[n],t[n]);return i}var Y1=(e,t)=>bQ(e,t,SC(t)),_Q=(e,{valueAsNumber:t,valueAsDate:i,setValueAs:r})=>fs(e)?e:t?e===""?NaN:e&&+e:i&&bh(e)?new Date(e):r?r(e):e;function uD(e){const t=e.ref;return F4(t)?t.files:U4(t)?vQ(e.refs).value:yQ(t)?[...t.selectedOptions].map(({value:i})=>i):q_(t)?gQ(e.refs).value:_Q(fs(t.value)?e.ref.value:t.value,e)}var w_e=(e,t,i,r)=>{const n={};for(const s of e){const a=qt(t,s);a&&cn(n,s,a._f)}return{criteriaMode:i,names:[...e],fields:n,shouldUseNativeValidation:r}},X1=e=>fs(e)?e:EC(e)?e.source:gs(e)?EC(e.value)?e.value.source:e.value:e;const tV="AsyncFunction";var E_e=e=>!!e&&!!e.validate&&!!(fh(e.validate)&&e.validate.constructor.name===tV||gs(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===tV)),S_e=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function iV(e,t,i){const r=qt(e,i);if(r||B4(i))return{error:r,name:i};const n=i.split(".");for(;n.length;){const s=n.join("."),a=qt(t,s),o=qt(e,s);if(a&&!Array.isArray(a)&&i!==s)return{name:i};if(o&&o.type)return{name:s,error:o};n.pop()}return{name:i}}var T_e=(e,t,i,r,n)=>n.isOnAll?!1:!i&&n.isOnTouch?!(t||e):(i?r.isOnBlur:n.isOnBlur)?!e:(i?r.isOnChange:n.isOnChange)?e:!0,C_e=(e,t)=>!mM(qt(e,t)).length&&Ws(e,t);const A_e={mode:pc.onSubmit,reValidateMode:pc.onChange,shouldFocusError:!0};function M_e(e={}){let t={...A_e,...e},i={submitCount:0,isDirty:!1,isLoading:fh(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},n=gs(t.defaultValues)||gs(t.values)?gl(t.defaultValues||t.values)||{}:{},s=t.shouldUnregister?{}:gl(n),a={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const c={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},h={values:oD(),array:oD(),state:oD()},d=Xj(t.mode),f=Xj(t.reValidateMode),m=t.criteriaMode===pc.all,g=ue=>Ee=>{clearTimeout(u),u=setTimeout(ue,Ee)},y=async ue=>{if(!t.disabled&&(c.isValid||ue)){const Ee=t.resolver?vl((await P()).errors):await D(r,!0);Ee!==i.isValid&&h.state.next({isValid:Ee})}},x=(ue,Ee)=>{!t.disabled&&(c.isValidating||c.validatingFields)&&((ue||Array.from(o.mount)).forEach(Ae=>{Ae&&(Ee?cn(i.validatingFields,Ae,Ee):Ws(i.validatingFields,Ae))}),h.state.next({validatingFields:i.validatingFields,isValidating:!vl(i.validatingFields)}))},w=(ue,Ee=[],Ae,Ge,ae=!0,te=!0)=>{if(Ge&&Ae&&!t.disabled){if(a.action=!0,te&&Array.isArray(qt(r,ue))){const Ne=Ae(qt(r,ue),Ge.argA,Ge.argB);ae&&cn(r,ue,Ne)}if(te&&Array.isArray(qt(i.errors,ue))){const Ne=Ae(qt(i.errors,ue),Ge.argA,Ge.argB);ae&&cn(i.errors,ue,Ne),C_e(i.errors,ue)}if(c.touchedFields&&te&&Array.isArray(qt(i.touchedFields,ue))){const Ne=Ae(qt(i.touchedFields,ue),Ge.argA,Ge.argB);ae&&cn(i.touchedFields,ue,Ne)}c.dirtyFields&&(i.dirtyFields=Y1(n,s)),h.state.next({name:ue,isDirty:B(ue,Ee),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else cn(s,ue,Ee)},b=(ue,Ee)=>{cn(i.errors,ue,Ee),h.state.next({errors:i.errors})},C=ue=>{i.errors=ue,h.state.next({errors:i.errors,isValid:!1})},A=(ue,Ee,Ae,Ge)=>{const ae=qt(r,ue);if(ae){const te=qt(s,ue,fs(Ae)?qt(n,ue):Ae);fs(te)||Ge&&Ge.defaultChecked||Ee?cn(s,ue,Ee?te:uD(ae._f)):$(ue,te),a.mount&&y()}},E=(ue,Ee,Ae,Ge,ae)=>{let te=!1,Ne=!1;const Re={name:ue};if(!t.disabled){const Y=!!(qt(r,ue)&&qt(r,ue)._f&&qt(r,ue)._f.disabled);if(!Ae||Ge){c.isDirty&&(Ne=i.isDirty,i.isDirty=Re.isDirty=B(),te=Ne!==Re.isDirty);const Me=Y||up(qt(n,ue),Ee);Ne=!!(!Y&&qt(i.dirtyFields,ue)),Me||Y?Ws(i.dirtyFields,ue):cn(i.dirtyFields,ue,!0),Re.dirtyFields=i.dirtyFields,te=te||c.dirtyFields&&Ne!==!Me}if(Ae){const Me=qt(i.touchedFields,ue);Me||(cn(i.touchedFields,ue,Ae),Re.touchedFields=i.touchedFields,te=te||c.touchedFields&&Me!==Ae)}te&&ae&&h.state.next(Re)}return te?Re:{}},_=(ue,Ee,Ae,Ge)=>{const ae=qt(i.errors,ue),te=c.isValid&&Au(Ee)&&i.isValid!==Ee;if(t.delayError&&Ae?(l=g(()=>b(ue,Ae)),l(t.delayError)):(clearTimeout(u),l=null,Ae?cn(i.errors,ue,Ae):Ws(i.errors,ue)),(Ae?!up(ae,Ae):ae)||!vl(Ge)||te){const Ne={...Ge,...te&&Au(Ee)?{isValid:Ee}:{},errors:i.errors,name:ue};i={...i,...Ne},h.state.next(Ne)}},P=async ue=>{x(ue,!0);const Ee=await t.resolver(s,t.context,w_e(ue||o.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return x(ue),Ee},I=async ue=>{const{errors:Ee}=await P(ue);if(ue)for(const Ae of ue){const Ge=qt(Ee,Ae);Ge?cn(i.errors,Ae,Ge):Ws(i.errors,Ae)}else i.errors=Ee;return Ee},D=async(ue,Ee,Ae={valid:!0})=>{for(const Ge in ue){const ae=ue[Ge];if(ae){const{_f:te,...Ne}=ae;if(te){const Re=o.array.has(te.name),Y=ae._f&&E_e(ae._f);Y&&c.validatingFields&&x([Ge],!0);const Me=await eV(ae,o.disabled,s,m,t.shouldUseNativeValidation&&!Ee,Re);if(Y&&c.validatingFields&&x([Ge]),Me[te.name]&&(Ae.valid=!1,Ee))break;!Ee&&(qt(Me,te.name)?Re?y_e(i.errors,Me,te.name):cn(i.errors,te.name,Me[te.name]):Ws(i.errors,te.name))}!vl(Ne)&&await D(Ne,Ee,Ae)}}return Ae.valid},k=()=>{for(const ue of o.unMount){const Ee=qt(r,ue);Ee&&(Ee._f.refs?Ee._f.refs.every(Ae=>!lD(Ae)):!lD(Ee._f.ref))&&he(ue)}o.unMount=new Set},B=(ue,Ee)=>!t.disabled&&(ue&&Ee&&cn(s,ue,Ee),!up(ie(),n)),z=(ue,Ee,Ae)=>mQ(ue,o,{...a.mount?s:fs(Ee)?n:bh(ue)?{[ue]:Ee}:Ee},Ae,Ee),W=ue=>mM(qt(a.mount?s:n,ue,t.shouldUnregister?qt(n,ue,[]):[])),$=(ue,Ee,Ae={})=>{const Ge=qt(r,ue);let ae=Ee;if(Ge){const te=Ge._f;te&&(!te.disabled&&cn(s,ue,_Q(Ee,te)),ae=wC(te.ref)&&Bo(Ee)?"":Ee,yQ(te.ref)?[...te.ref.options].forEach(Ne=>Ne.selected=ae.includes(Ne.value)):te.refs?q_(te.ref)?te.refs.length>1?te.refs.forEach(Ne=>(!Ne.defaultChecked||!Ne.disabled)&&(Ne.checked=Array.isArray(ae)?!!ae.find(Re=>Re===Ne.value):ae===Ne.value)):te.refs[0]&&(te.refs[0].checked=!!ae):te.refs.forEach(Ne=>Ne.checked=Ne.value===ae):F4(te.ref)?te.ref.value="":(te.ref.value=ae,te.ref.type||h.values.next({name:ue,values:{...s}})))}(Ae.shouldDirty||Ae.shouldTouch)&&E(ue,ae,Ae.shouldTouch,Ae.shouldDirty,!0),Ae.shouldValidate&&U(ue)},Z=(ue,Ee,Ae)=>{for(const Ge in Ee){const ae=Ee[Ge],te=`${ue}.${Ge}`,Ne=qt(r,te);(o.array.has(ue)||gs(ae)||Ne&&!Ne._f)&&!yg(ae)?Z(te,ae,Ae):$(te,ae,Ae)}},G=(ue,Ee,Ae={})=>{const Ge=qt(r,ue),ae=o.array.has(ue),te=gl(Ee);cn(s,ue,te),ae?(h.array.next({name:ue,values:{...s}}),(c.isDirty||c.dirtyFields)&&Ae.shouldDirty&&h.state.next({name:ue,dirtyFields:Y1(n,s),isDirty:B(ue,te)})):Ge&&!Ge._f&&!Bo(te)?Z(ue,te,Ae):$(ue,te,Ae),Kj(ue,o)&&h.state.next({...i}),h.values.next({name:a.mount?ue:void 0,values:{...s}})},V=async ue=>{a.mount=!0;const Ee=ue.target;let Ae=Ee.name,Ge=!0;const ae=qt(r,Ae),te=()=>Ee.type?uD(ae._f):lQ(ue),Ne=Re=>{Ge=Number.isNaN(Re)||yg(Re)&&isNaN(Re.getTime())||up(Re,qt(s,Ae,Re))};if(ae){let Re,Y;const Me=te(),Ke=ue.type===_C.BLUR||ue.type===_C.FOCUS_OUT,ot=!S_e(ae._f)&&!t.resolver&&!qt(i.errors,Ae)&&!ae._f.deps||T_e(Ke,qt(i.touchedFields,Ae),i.isSubmitted,f,d),qe=Kj(Ae,o,Ke);cn(s,Ae,Me),Ke?(ae._f.onBlur&&ae._f.onBlur(ue),l&&l(0)):ae._f.onChange&&ae._f.onChange(ue);const It=E(Ae,Me,Ke,!1),Ot=!vl(It)||qe;if(!Ke&&h.values.next({name:Ae,type:ue.type,values:{...s}}),ot)return c.isValid&&(t.mode==="onBlur"&&Ke?y():Ke||y()),Ot&&h.state.next({name:Ae,...qe?{}:It});if(!Ke&&qe&&h.state.next({...i}),t.resolver){const{errors:Dt}=await P([Ae]);if(Ne(Me),Ge){const kt=iV(i.errors,r,Ae),Qe=iV(Dt,r,kt.name||Ae);Re=Qe.error,Ae=Qe.name,Y=vl(Dt)}}else x([Ae],!0),Re=(await eV(ae,o.disabled,s,m,t.shouldUseNativeValidation))[Ae],x([Ae]),Ne(Me),Ge&&(Re?Y=!1:c.isValid&&(Y=await D(r,!0)));Ge&&(ae._f.deps&&U(ae._f.deps),_(Ae,Y,Re,It))}},J=(ue,Ee)=>{if(qt(i.errors,Ee)&&ue.focus)return ue.focus(),1},U=async(ue,Ee={})=>{let Ae,Ge;const ae=fb(ue);if(t.resolver){const te=await I(fs(ue)?ue:ae);Ae=vl(te),Ge=ue?!ae.some(Ne=>qt(te,Ne)):Ae}else ue?(Ge=(await Promise.all(ae.map(async te=>{const Ne=qt(r,te);return await D(Ne&&Ne._f?{[te]:Ne}:Ne)}))).every(Boolean),!(!Ge&&!i.isValid)&&y()):Ge=Ae=await D(r);return h.state.next({...!bh(ue)||c.isValid&&Ae!==i.isValid?{}:{name:ue},...t.resolver||!ue?{isValid:Ae}:{},errors:i.errors}),Ee.shouldFocus&&!Ge&&pb(r,J,ue?ae:o.mount),Ge},ie=ue=>{const Ee={...a.mount?s:n};return fs(ue)?Ee:bh(ue)?qt(Ee,ue):ue.map(Ae=>qt(Ee,Ae))},se=(ue,Ee)=>({invalid:!!qt((Ee||i).errors,ue),isDirty:!!qt((Ee||i).dirtyFields,ue),error:qt((Ee||i).errors,ue),isValidating:!!qt(i.validatingFields,ue),isTouched:!!qt((Ee||i).touchedFields,ue)}),ee=ue=>{ue&&fb(ue).forEach(Ee=>Ws(i.errors,Ee)),h.state.next({errors:ue?i.errors:{}})},ve=(ue,Ee,Ae)=>{const Ge=(qt(r,ue,{_f:{}})._f||{}).ref,ae=qt(i.errors,ue)||{},{ref:te,message:Ne,type:Re,...Y}=ae;cn(i.errors,ue,{...Y,...Ee,ref:Ge}),h.state.next({name:ue,errors:i.errors,isValid:!1}),Ae&&Ae.shouldFocus&&Ge&&Ge.focus&&Ge.focus()},_e=(ue,Ee)=>fh(ue)?h.values.subscribe({next:Ae=>ue(z(void 0,Ee),Ae)}):z(ue,Ee,!0),he=(ue,Ee={})=>{for(const Ae of ue?fb(ue):o.mount)o.mount.delete(Ae),o.array.delete(Ae),Ee.keepValue||(Ws(r,Ae),Ws(s,Ae)),!Ee.keepError&&Ws(i.errors,Ae),!Ee.keepDirty&&Ws(i.dirtyFields,Ae),!Ee.keepTouched&&Ws(i.touchedFields,Ae),!Ee.keepIsValidating&&Ws(i.validatingFields,Ae),!t.shouldUnregister&&!Ee.keepDefaultValue&&Ws(n,Ae);h.values.next({values:{...s}}),h.state.next({...i,...Ee.keepDirty?{isDirty:B()}:{}}),!Ee.keepIsValid&&y()},De=({disabled:ue,name:Ee,field:Ae,fields:Ge})=>{(Au(ue)&&a.mount||ue||o.disabled.has(Ee))&&(ue?o.disabled.add(Ee):o.disabled.delete(Ee),E(Ee,uD(Ae?Ae._f:qt(Ge,Ee)._f),!1,!1,!0))},we=(ue,Ee={})=>{let Ae=qt(r,ue);const Ge=Au(Ee.disabled)||Au(t.disabled);return cn(r,ue,{...Ae||{},_f:{...Ae&&Ae._f?Ae._f:{ref:{name:ue}},name:ue,mount:!0,...Ee}}),o.mount.add(ue),Ae?De({field:Ae,disabled:Au(Ee.disabled)?Ee.disabled:t.disabled,name:ue}):A(ue,!0,Ee.value),{...Ge?{disabled:Ee.disabled||t.disabled}:{},...t.progressive?{required:!!Ee.required,min:X1(Ee.min),max:X1(Ee.max),minLength:X1(Ee.minLength),maxLength:X1(Ee.maxLength),pattern:X1(Ee.pattern)}:{},name:ue,onChange:V,onBlur:V,ref:ae=>{if(ae){we(ue,Ee),Ae=qt(r,ue);const te=fs(ae.value)&&ae.querySelectorAll&&ae.querySelectorAll("input,select,textarea")[0]||ae,Ne=__e(te),Re=Ae._f.refs||[];if(Ne?Re.find(Y=>Y===te):te===Ae._f.ref)return;cn(r,ue,{_f:{...Ae._f,...Ne?{refs:[...Re.filter(lD),te,...Array.isArray(qt(n,ue))?[{}]:[]],ref:{type:te.type,name:ue}}:{ref:te}}}),A(ue,!1,void 0,te)}else Ae=qt(r,ue,{}),Ae._f&&(Ae._f.mount=!1),(t.shouldUnregister||Ee.shouldUnregister)&&!(uQ(o.array,ue)&&a.action)&&o.unMount.add(ue)}}},Le=()=>t.shouldFocusError&&pb(r,J,o.mount),Te=ue=>{Au(ue)&&(h.state.next({disabled:ue}),pb(r,(Ee,Ae)=>{const Ge=qt(r,Ae);Ge&&(Ee.disabled=Ge._f.disabled||ue,Array.isArray(Ge._f.refs)&&Ge._f.refs.forEach(ae=>{ae.disabled=Ge._f.disabled||ue}))},0,!1))},ke=(ue,Ee)=>async Ae=>{let Ge;Ae&&(Ae.preventDefault&&Ae.preventDefault(),Ae.persist&&Ae.persist());let ae=gl(s);if(o.disabled.size)for(const te of o.disabled)cn(ae,te,void 0);if(h.state.next({isSubmitting:!0}),t.resolver){const{errors:te,values:Ne}=await P();i.errors=te,ae=Ne}else await D(r);if(Ws(i.errors,"root"),vl(i.errors)){h.state.next({errors:{}});try{await ue(ae,Ae)}catch(te){Ge=te}}else Ee&&await Ee({...i.errors},Ae),Le(),setTimeout(Le);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:vl(i.errors)&&!Ge,submitCount:i.submitCount+1,errors:i.errors}),Ge)throw Ge},Xe=(ue,Ee={})=>{qt(r,ue)&&(fs(Ee.defaultValue)?G(ue,gl(qt(n,ue))):(G(ue,Ee.defaultValue),cn(n,ue,gl(Ee.defaultValue))),Ee.keepTouched||Ws(i.touchedFields,ue),Ee.keepDirty||(Ws(i.dirtyFields,ue),i.isDirty=Ee.defaultValue?B(ue,gl(qt(n,ue))):B()),Ee.keepError||(Ws(i.errors,ue),c.isValid&&y()),h.state.next({...i}))},et=(ue,Ee={})=>{const Ae=ue?gl(ue):n,Ge=gl(Ae),ae=vl(ue),te=ae?n:Ge;if(Ee.keepDefaultValues||(n=Ae),!Ee.keepValues){if(Ee.keepDirtyValues){const Ne=new Set([...o.mount,...Object.keys(Y1(n,s))]);for(const Re of Array.from(Ne))qt(i.dirtyFields,Re)?cn(te,Re,qt(s,Re)):G(Re,qt(te,Re))}else{if(k4&&fs(ue))for(const Ne of o.mount){const Re=qt(r,Ne);if(Re&&Re._f){const Y=Array.isArray(Re._f.refs)?Re._f.refs[0]:Re._f.ref;if(wC(Y)){const Me=Y.closest("form");if(Me){Me.reset();break}}}}r={}}s=t.shouldUnregister?Ee.keepDefaultValues?gl(n):{}:gl(te),h.array.next({values:{...te}}),h.values.next({values:{...te}})}o={mount:Ee.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!c.isValid||!!Ee.keepIsValid||!!Ee.keepDirtyValues,a.watch=!!t.shouldUnregister,h.state.next({submitCount:Ee.keepSubmitCount?i.submitCount:0,isDirty:ae?!1:Ee.keepDirty?i.isDirty:!!(Ee.keepDefaultValues&&!up(ue,n)),isSubmitted:Ee.keepIsSubmitted?i.isSubmitted:!1,dirtyFields:ae?{}:Ee.keepDirtyValues?Ee.keepDefaultValues&&s?Y1(n,s):i.dirtyFields:Ee.keepDefaultValues&&ue?Y1(n,ue):Ee.keepDirty?i.dirtyFields:{},touchedFields:Ee.keepTouched?i.touchedFields:{},errors:Ee.keepErrors?i.errors:{},isSubmitSuccessful:Ee.keepIsSubmitSuccessful?i.isSubmitSuccessful:!1,isSubmitting:!1})},Ze=(ue,Ee)=>et(fh(ue)?ue(s):ue,Ee);return{control:{register:we,unregister:he,getFieldState:se,handleSubmit:ke,setError:ve,_executeSchema:P,_getWatch:z,_getDirty:B,_updateValid:y,_removeUnmounted:k,_updateFieldArray:w,_updateDisabledField:De,_getFieldArray:W,_reset:et,_resetDefaultValues:()=>fh(t.defaultValues)&&t.defaultValues().then(ue=>{Ze(ue,t.resetOptions),h.state.next({isLoading:!1})}),_updateFormState:ue=>{i={...i,...ue}},_disableForm:Te,_subjects:h,_proxyFormState:c,_setErrors:C,get _fields(){return r},get _formValues(){return s},get _state(){return a},set _state(ue){a=ue},get _defaultValues(){return n},get _names(){return o},set _names(ue){o=ue},get _formState(){return i},set _formState(ue){i=ue},get _options(){return t},set _options(ue){t={...t,...ue}}},trigger:U,register:we,handleSubmit:ke,watch:_e,setValue:G,getValues:ie,reset:Ze,resetField:Xe,clearErrors:ee,unregister:he,setError:ve,setFocus:(ue,Ee={})=>{const Ae=qt(r,ue),Ge=Ae&&Ae._f;if(Ge){const ae=Ge.refs?Ge.refs[0]:Ge.ref;ae.focus&&(ae.focus(),Ee.shouldSelect&&fh(ae.select)&&ae.select())}},getFieldState:se}}function P_e(e={}){const t=ci.useRef(void 0),i=ci.useRef(void 0),[r,n]=ci.useState({isDirty:!1,isValidating:!1,isLoading:fh(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:fh(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...M_e(e),formState:r});const s=t.current.control;return s._options=e,z4({subject:s._subjects.state,next:a=>{fQ(a,s._proxyFormState,s._updateFormState,!0)&&n({...s._formState})}}),ci.useEffect(()=>s._disableForm(e.disabled),[s,e.disabled]),ci.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==r.isDirty&&s._subjects.state.next({isDirty:a})}},[s,r.isDirty]),ci.useEffect(()=>{e.values&&!up(e.values,i.current)?(s._reset(e.values,s._options.resetOptions),i.current=e.values,n(a=>({...a}))):s._resetDefaultValues()},[e.values,s]),ci.useEffect(()=>{e.errors&&s._setErrors(e.errors)},[e.errors,s]),ci.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),ci.useEffect(()=>{e.shouldUnregister&&s._subjects.values.next({values:s._getWatch()})},[e.shouldUnregister,s]),t.current.formState=dQ(r,s),t.current}const ry=de.forwardRef(({className:e,type:t,...i},r)=>j.jsx("input",{type:t,className:an("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...i}));ry.displayName="Input";const wQ=de.forwardRef(({className:e,...t},i)=>j.jsx("textarea",{className:an("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...t}));wQ.displayName="Textarea";var D_e="Label",EQ=de.forwardRef((e,t)=>j.jsx(Oc.label,{...e,ref:t,onMouseDown:i=>{var n;i.target.closest("button, input, select, textarea")||((n=e.onMouseDown)==null||n.call(e,i),!i.defaultPrevented&&i.detail>1&&i.preventDefault())}}));EQ.displayName=D_e;var SQ=EQ;const I_e=C4("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),V0=de.forwardRef(({className:e,...t},i)=>j.jsx(SQ,{ref:i,className:an(I_e(),e),...t}));V0.displayName=SQ.displayName;const O_e=d_e,TQ=de.createContext({}),vE=({...e})=>j.jsx(TQ.Provider,{value:{name:e.name},children:j.jsx(g_e,{...e})}),vM=()=>{const e=de.useContext(TQ),t=de.useContext(CQ),{getFieldState:i,formState:r}=gM(),n=i(e.name,r);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:s}=t;return{id:s,name:e.name,formItemId:`${s}-form-item`,formDescriptionId:`${s}-form-item-description`,formMessageId:`${s}-form-item-message`,...n}},CQ=de.createContext({}),kx=de.forwardRef(({className:e,...t},i)=>{const r=de.useId();return j.jsx(CQ.Provider,{value:{id:r},children:j.jsx("div",{ref:i,className:an("space-y-2",e),...t})})});kx.displayName="FormItem";const Bx=de.forwardRef(({className:e,...t},i)=>{const{error:r,formItemId:n}=vM();return j.jsx(V0,{ref:i,className:an(r&&"text-destructive",e),htmlFor:n,...t})});Bx.displayName="FormLabel";const zx=de.forwardRef(({...e},t)=>{const{error:i,formItemId:r,formDescriptionId:n,formMessageId:s}=vM();return j.jsx(My,{ref:t,id:r,"aria-describedby":i?`${n} ${s}`:`${n}`,"aria-invalid":!!i,...e})});zx.displayName="FormControl";const R_e=de.forwardRef(({className:e,...t},i)=>{const{formDescriptionId:r}=vM();return j.jsx("p",{ref:i,id:r,className:an("text-[0.8rem] text-muted-foreground",e),...t})});R_e.displayName="FormDescription";const Fx=de.forwardRef(({className:e,children:t,...i},r)=>{const{error:n,formMessageId:s}=vM(),a=n?String(n==null?void 0:n.message):t;return a?j.jsx("p",{ref:r,id:s,className:an("text-[0.8rem] font-medium text-destructive",e),...i,children:a}):null});Fx.displayName="FormMessage";const L_e=({id:e="contact"})=>{const t=P_e({defaultValues:{name:"",email:"",subject:"",message:""}}),[i,r]=de.useState(!1),[n,s]=de.useState("idle"),[a,o]=de.useState(""),l=async u=>{r(!0),s("idle"),o("");try{const c=await fetch("http://localhost:3001/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!c.ok){const h=await c.json();throw new Error(h.error||`HTTP error! status: ${c.status}`)}s("success"),t.reset()}catch(c){console.error("Erreur lors de l'envoi du message:",c),s("error"),o(c.message||"Une erreur est survenue.")}finally{r(!1)}};return j.jsx("section",{id:e,className:"py-20 px-4 md:px-8 lg:px-12 bg-background w-full min-h-screen flex items-center",children:j.jsxs("div",{className:"max-w-6xl mx-auto w-full",children:[j.jsxs("div",{className:"text-center mb-12",children:[j.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Me Contacter"}),j.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"N'hésitez pas à me contacter si vous avez des questions ou si vous souhaitez collaborer. Je vous répondrai dans les plus brefs délais."})]}),j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[j.jsxs("div",{className:"space-y-8",children:[j.jsx("h3",{className:"text-2xl font-semibold",children:"Restons en Contact"}),j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{className:"flex items-start space-x-4",children:[j.jsx("div",{className:"bg-primary/10 p-3 rounded-full",children:j.jsx(A4,{className:"h-6 w-6 text-primary"})}),j.jsxs("div",{children:[j.jsx("h4",{className:"font-medium",children:"Email"}),j.jsx("p",{className:"text-muted-foreground",children:"andriantahirynomena@gmail.com"})]})]}),j.jsxs("div",{className:"flex items-start space-x-4",children:[j.jsx("div",{className:"bg-primary/10 p-3 rounded-full",children:j.jsx(Wxe,{className:"h-6 w-6 text-primary"})}),j.jsxs("div",{children:[j.jsx("h4",{className:"font-medium",children:"Téléphone"}),j.jsx("p",{className:"text-muted-foreground",children:"+261 34 96 712 22"})]})]}),j.jsxs("div",{className:"flex items-start space-x-4",children:[j.jsx("div",{className:"bg-primary/10 p-3 rounded-full",children:j.jsx(Vxe,{className:"h-6 w-6 text-primary"})}),j.jsxs("div",{children:[j.jsx("h4",{className:"font-medium",children:"Localisation"}),j.jsx("p",{className:"text-muted-foreground",children:"Antananarivo, Madagascar"})]})]})]}),j.jsxs("div",{className:"pt-6",children:[j.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Suivez-moi"}),j.jsxs("div",{className:"flex space-x-4",children:[j.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20 transition-colors cursor-pointer",children:j.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[j.jsx("path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"}),j.jsx("rect",{width:"4",height:"12",x:"2",y:"9"}),j.jsx("circle",{cx:"4",cy:"4",r:"2"})]})}),j.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20 transition-colors cursor-pointer",children:j.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:j.jsx("path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"})})}),j.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20 transition-colors cursor-pointer",children:j.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[j.jsx("rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5"}),j.jsx("path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"}),j.jsx("line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5"})]})}),j.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20 transition-colors cursor-pointer",children:j.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:j.jsx("path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"})})})]})]})]}),j.jsxs("div",{className:"bg-card p-6 rounded-lg shadow-sm border border-border",children:[j.jsx("h3",{className:"text-2xl font-semibold mb-6",children:"Envoyez-moi un Message"}),j.jsx(O_e,{...t,children:j.jsxs("form",{onSubmit:t.handleSubmit(l),className:"space-y-6",children:[j.jsx(vE,{control:t.control,name:"name",render:({field:u})=>j.jsxs(kx,{children:[j.jsx(Bx,{children:"Nom"}),j.jsx(zx,{children:j.jsx(ry,{placeholder:"Votre nom",...u})}),j.jsx(Fx,{})]})}),j.jsx(vE,{control:t.control,name:"email",render:({field:u})=>j.jsxs(kx,{children:[j.jsx(Bx,{children:"Email"}),j.jsx(zx,{children:j.jsx(ry,{placeholder:"Votre email",...u})}),j.jsx(Fx,{})]})}),j.jsx(vE,{control:t.control,name:"subject",render:({field:u})=>j.jsxs(kx,{children:[j.jsx(Bx,{children:"Sujet"}),j.jsx(zx,{children:j.jsx(ry,{placeholder:"Sujet de votre message",...u})}),j.jsx(Fx,{})]})}),j.jsx(vE,{control:t.control,name:"message",render:({field:u})=>j.jsxs(kx,{children:[j.jsx(Bx,{children:"Message"}),j.jsx(zx,{children:j.jsx(wQ,{placeholder:"Votre message",className:"min-h-32 resize-none",...u})}),j.jsx(Fx,{})]})}),j.jsx(Zn,{type:"submit",className:"w-full",disabled:i,children:i?j.jsxs(j.Fragment,{children:[j.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[j.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),j.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Envoi en cours..."]}):j.jsxs(j.Fragment,{children:[j.jsx(Gxe,{className:"mr-2 h-4 w-4"}),"Envoyer le Message"]})}),j.jsxs("div",{className:"mt-4 text-center",children:[n==="success"&&j.jsxs("p",{className:"text-green-600 dark:text-green-400 flex items-center justify-center",children:[j.jsx(Fxe,{className:"mr-2 h-5 w-5"})," Message envoyé avec succès !"]}),n==="error"&&j.jsxs("p",{className:"text-red-600 dark:text-red-400 flex items-center justify-center",children:[j.jsx(vZ,{className:"mr-2 h-5 w-5"})," Erreur : ",a]})]})]})})]})]})]})})},N_e=({className:e}={})=>{const t=new Date().getFullYear(),i=[{icon:j.jsx(vC,{className:"h-5 w-5"}),href:"https://github.com",label:"GitHub"},{icon:j.jsx(yZ,{className:"h-5 w-5"}),href:"https://linkedin.com",label:"LinkedIn"},{icon:j.jsx(qxe,{className:"h-5 w-5"}),href:"https://twitter.com",label:"Twitter"},{icon:j.jsx(A4,{className:"h-5 w-5"}),href:"mailto:contact@example.com",label:"Email"}];return j.jsx("footer",{className:an("w-full py-6 px-4 md:px-8 border-t bg-background",e),children:j.jsxs("div",{className:"container mx-auto flex flex-col md:flex-row justify-between items-center gap-4",children:[j.jsxs("div",{className:"text-sm text-muted-foreground",children:["© ",t," Portfolio. All rights reserved."]}),j.jsx("div",{className:"flex items-center space-x-4",children:i.map((r,n)=>j.jsx("a",{href:r.href,target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":r.label,children:r.icon},n))})]})})},k_e=[{id:1,title:"Création de Sites Web Responsifs avec Tailwind CSS",excerpt:"Apprenez à créer rapidement des sites web beaux et responsifs en utilisant les classes utilitaires de Tailwind CSS.",content:"Le contenu complet irait ici...",date:"2023-06-15",author:"John Doe",readTime:"5 min de lecture",category:"Développement",tags:["Tailwind CSS","Design Responsif","Développement Web"],image:"https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=800&q=80"},{id:2,title:"L'Avenir de React : Ce qui Arrive en 2023",excerpt:"Explorez les fonctionnalités et améliorations à venir dans React qui changeront la façon dont nous construisons des applications.",content:"Le contenu complet irait ici...",date:"2023-05-28",author:"Jane Smith",readTime:"8 min de lecture",category:"React",tags:["React","JavaScript","Développement Web"],image:"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=800&q=80"},{id:3,title:"Optimisation des Performances dans les Applications Web Modernes",excerpt:"Découvrez des techniques et bonnes pratiques pour améliorer les performances de vos applications web.",content:"Le contenu complet irait ici...",date:"2023-05-10",author:"Alex Johnson",readTime:"6 min de lecture",category:"Performance",tags:["Performance","Développement Web","Optimisation"],image:"https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&q=80"},{id:4,title:"Introduction à TypeScript pour les Développeurs JavaScript",excerpt:"Découvrez comment TypeScript peut améliorer votre développement JavaScript avec le typage statique et des fonctionnalités avancées.",content:"Le contenu complet irait ici...",date:"2023-04-22",author:"Sarah Williams",readTime:"7 min de lecture",category:"TypeScript",tags:["TypeScript","JavaScript","Développement Web"],image:"https://images.unsplash.com/photo-1516116216624-53e697fedbea?w=800&q=80"},{id:5,title:"Création d'Applications Web Accessibles",excerpt:"Découvrez comment rendre vos applications web accessibles à tous les utilisateurs, y compris ceux ayant des handicaps.",content:"Le contenu complet irait ici...",date:"2023-04-05",author:"Michael Brown",readTime:"9 min de lecture",category:"Accessibilité",tags:["Accessibilité","Développement Web","UX"],image:"https://images.unsplash.com/photo-1586953208448-b95a79798f07?w=800&q=80"},{id:6,title:"Techniques CSS Modernes que Chaque Développeur Devrait Connaître",excerpt:"Explorez des techniques CSS modernes comme Grid, Flexbox et les variables CSS qui peuvent transformer votre développement web.",content:"Le contenu complet irait ici...",date:"2023-03-18",author:"Emily Davis",readTime:"6 min de lecture",category:"CSS",tags:["CSS","Développement Web","Design"],image:"https://images.unsplash.com/photo-1507721999472-8ed4421c4af2?w=800&q=80"}],B_e=({title:e="Articles Récents",description:t="Découvrez des analyses, tutoriels et réflexions sur le développement web, le design et la technologie.",posts:i=k_e.slice(0,3)})=>{const r=rM(),[n,s]=de.useState(null),a=["Tous",...new Set(i.map(h=>h.category))],o=n&&n!=="Tous"?i.filter(h=>h.category===n):i,l={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},u={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}},c=h=>{const d={year:"numeric",month:"long",day:"numeric"};return new Date(h).toLocaleDateString("fr-FR",d)};return j.jsx("section",{id:"blog",className:"py-20 bg-background w-full",children:j.jsxs("div",{className:"container mx-auto px-4",children:[j.jsxs(Ui.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"text-center mb-12",children:[j.jsx("h2",{className:"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl mb-4",children:e}),j.jsx("p",{className:"text-muted-foreground max-w-[700px] mx-auto mb-8",children:t}),j.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-8",children:a.map(h=>j.jsx(Zn,{variant:n===h||h==="Tous"&&!n?"default":"outline",size:"sm",onClick:()=>s(h==="Tous"?null:h),className:"rounded-full",children:h},h))})]}),j.jsx(Ui.div,{variants:l,initial:"hidden",whileInView:"visible",viewport:{once:!0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:o.map(h=>j.jsx(Ui.div,{variants:u,children:j.jsxs(av,{className:"h-full overflow-hidden hover:shadow-lg transition-all duration-300 border border-border/40 bg-card",children:[j.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[j.jsx("img",{src:h.image,alt:h.title,className:"object-cover w-full h-full transition-transform duration-500 hover:scale-105"}),j.jsx("div",{className:"absolute top-4 left-4",children:j.jsx(aQ,{className:"bg-primary text-primary-foreground",children:h.category})})]}),j.jsxs(H_,{className:"p-6",children:[j.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-2 space-x-4",children:[j.jsxs("div",{className:"flex items-center",children:[j.jsx(kxe,{className:"h-4 w-4 mr-1"}),j.jsx("span",{children:c(h.date)})]}),j.jsxs("div",{className:"flex items-center",children:[j.jsx(Uxe,{className:"h-4 w-4 mr-1"}),j.jsx("span",{children:h.readTime})]})]}),j.jsx(W_,{className:"text-xl font-bold hover:text-primary transition-colors",children:j.jsx("a",{href:`/blog/${h.id}`,onClick:d=>{d.preventDefault(),r(`/blog/${h.id}`)},children:h.title})})]}),j.jsx(ov,{className:"p-6 pt-0",children:j.jsx(hM,{className:"text-muted-foreground mb-4",children:h.excerpt})}),j.jsxs(dM,{className:"p-6 pt-0 flex justify-between items-center",children:[j.jsxs("div",{className:"flex items-center",children:[j.jsx(Yxe,{className:"h-4 w-4 mr-2 text-muted-foreground"}),j.jsx("span",{className:"text-sm text-muted-foreground",children:h.author})]}),j.jsxs(Zn,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>r(`/blog/${h.id}`),children:["Lire la suite ",j.jsx(Nxe,{className:"ml-2 h-4 w-4"})]})]})]})},h.id))}),j.jsx("div",{className:"text-center mt-12",children:j.jsx(Zn,{size:"lg",variant:"outline",className:"px-8",onClick:()=>r("/blog"),children:"Voir tous les articles"})})]})})};function AQ(e,[t,i]){return Math.min(i,Math.max(t,e))}function z_e(e){const t=de.useRef({value:e,previous:e});return de.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function F_e(e){const[t,i]=de.useState(void 0);return bC(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const s=n[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;a=u.inlineSize,o=u.blockSize}else a=e.offsetWidth,o=e.offsetHeight;i({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else i(void 0)},[e]),t}var MQ=["PageUp","PageDown"],PQ=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],DQ={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},i1="Slider",[E3,U_e,j_e]=NZ(i1),[IQ,xst]=fM(i1,[j_e]),[V_e,yM]=IQ(i1),OQ=de.forwardRef((e,t)=>{const{name:i,min:r=0,max:n=100,step:s=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:u=[r],value:c,onValueChange:h=()=>{},onValueCommit:d=()=>{},inverted:f=!1,form:m,...g}=e,y=de.useRef(new Set),x=de.useRef(0),b=a==="horizontal"?H_e:W_e,[C=[],A]=O4({prop:c,defaultProp:u,onChange:k=>{var z;(z=[...y.current][x.current])==null||z.focus(),h(k)}}),E=de.useRef(C);function _(k){const B=K_e(C,k);D(k,B)}function P(k){D(k,x.current)}function I(){const k=E.current[x.current];C[x.current]!==k&&d(C)}function D(k,B,{commit:z}={commit:!1}){const W=J_e(s),$=ewe(Math.round((k-r)/s)*s+r,W),Z=AQ($,[r,n]);A((G=[])=>{const V=Y_e(G,Z,B);if(Q_e(V,l*s)){x.current=V.indexOf(Z);const J=String(V)!==String(G);return J&&z&&d(V),J?V:G}else return G})}return j.jsx(V_e,{scope:e.__scopeSlider,name:i,disabled:o,min:r,max:n,valueIndexToChangeRef:x,thumbs:y.current,values:C,orientation:a,form:m,children:j.jsx(E3.Provider,{scope:e.__scopeSlider,children:j.jsx(E3.Slot,{scope:e.__scopeSlider,children:j.jsx(b,{"aria-disabled":o,"data-disabled":o?"":void 0,...g,ref:t,onPointerDown:Ho(g.onPointerDown,()=>{o||(E.current=C)}),min:r,max:n,inverted:f,onSlideStart:o?void 0:_,onSlideMove:o?void 0:P,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&D(r,0,{commit:!0}),onEndKeyDown:()=>!o&&D(n,C.length-1,{commit:!0}),onStepKeyDown:({event:k,direction:B})=>{if(!o){const $=MQ.includes(k.key)||k.shiftKey&&PQ.includes(k.key)?10:1,Z=x.current,G=C[Z],V=s*$*B;D(G+V,Z,{commit:!0})}}})})})})});OQ.displayName=i1;var[RQ,LQ]=IQ(i1,{startEdge:"left",endEdge:"right",size:"width",direction:1}),H_e=de.forwardRef((e,t)=>{const{min:i,max:r,dir:n,inverted:s,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:u,...c}=e,[h,d]=de.useState(null),f=of(t,b=>d(b)),m=de.useRef(void 0),g=R4(n),y=g==="ltr",x=y&&!s||!y&&s;function w(b){const C=m.current||h.getBoundingClientRect(),A=[0,C.width],_=j4(A,x?[i,r]:[r,i]);return m.current=C,_(b-C.left)}return j.jsx(RQ,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:j.jsx(NQ,{dir:g,"data-orientation":"horizontal",...c,ref:f,style:{...c.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const C=w(b.clientX);a==null||a(C)},onSlideMove:b=>{const C=w(b.clientX);o==null||o(C)},onSlideEnd:()=>{m.current=void 0,l==null||l()},onStepKeyDown:b=>{const A=DQ[x?"from-left":"from-right"].includes(b.key);u==null||u({event:b,direction:A?-1:1})}})})}),W_e=de.forwardRef((e,t)=>{const{min:i,max:r,inverted:n,onSlideStart:s,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...u}=e,c=de.useRef(null),h=of(t,c),d=de.useRef(void 0),f=!n;function m(g){const y=d.current||c.current.getBoundingClientRect(),x=[0,y.height],b=j4(x,f?[r,i]:[i,r]);return d.current=y,b(g-y.top)}return j.jsx(RQ,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:j.jsx(NQ,{"data-orientation":"vertical",...u,ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const y=m(g.clientY);s==null||s(y)},onSlideMove:g=>{const y=m(g.clientY);a==null||a(y)},onSlideEnd:()=>{d.current=void 0,o==null||o()},onStepKeyDown:g=>{const x=DQ[f?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:x?-1:1})}})})}),NQ=de.forwardRef((e,t)=>{const{__scopeSlider:i,onSlideStart:r,onSlideMove:n,onSlideEnd:s,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...u}=e,c=yM(i1,i);return j.jsx(Oc.span,{...u,ref:t,onKeyDown:Ho(e.onKeyDown,h=>{h.key==="Home"?(a(h),h.preventDefault()):h.key==="End"?(o(h),h.preventDefault()):MQ.concat(PQ).includes(h.key)&&(l(h),h.preventDefault())}),onPointerDown:Ho(e.onPointerDown,h=>{const d=h.target;d.setPointerCapture(h.pointerId),h.preventDefault(),c.thumbs.has(d)?d.focus():r(h)}),onPointerMove:Ho(e.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&n(h)}),onPointerUp:Ho(e.onPointerUp,h=>{const d=h.target;d.hasPointerCapture(h.pointerId)&&(d.releasePointerCapture(h.pointerId),s(h))})})}),kQ="SliderTrack",BQ=de.forwardRef((e,t)=>{const{__scopeSlider:i,...r}=e,n=yM(kQ,i);return j.jsx(Oc.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:t})});BQ.displayName=kQ;var S3="SliderRange",zQ=de.forwardRef((e,t)=>{const{__scopeSlider:i,...r}=e,n=yM(S3,i),s=LQ(S3,i),a=de.useRef(null),o=of(t,a),l=n.values.length,u=n.values.map(d=>UQ(d,n.min,n.max)),c=l>1?Math.min(...u):0,h=100-Math.max(...u);return j.jsx(Oc.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...r,ref:o,style:{...e.style,[s.startEdge]:c+"%",[s.endEdge]:h+"%"}})});zQ.displayName=S3;var T3="SliderThumb",FQ=de.forwardRef((e,t)=>{const i=U_e(e.__scopeSlider),[r,n]=de.useState(null),s=of(t,o=>n(o)),a=de.useMemo(()=>r?i().findIndex(o=>o.ref.current===r):-1,[i,r]);return j.jsx(G_e,{...e,ref:s,index:a})}),G_e=de.forwardRef((e,t)=>{const{__scopeSlider:i,index:r,name:n,...s}=e,a=yM(T3,i),o=LQ(T3,i),[l,u]=de.useState(null),c=of(t,w=>u(w)),h=l?a.form||!!l.closest("form"):!0,d=F_e(l),f=a.values[r],m=f===void 0?0:UQ(f,a.min,a.max),g=X_e(r,a.values.length),y=d==null?void 0:d[o.size],x=y?$_e(y,m,o.direction):0;return de.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),j.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${m}% + ${x}px)`},children:[j.jsx(E3.ItemSlot,{scope:e.__scopeSlider,children:j.jsx(Oc.span,{role:"slider","aria-label":e["aria-label"]||g,"aria-valuemin":a.min,"aria-valuenow":f,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...s,ref:c,style:f===void 0?{display:"none"}:e.style,onFocus:Ho(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),h&&j.jsx(q_e,{name:n??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:f},r)]})});FQ.displayName=T3;var q_e=e=>{const{value:t,...i}=e,r=de.useRef(null),n=z_e(t);return de.useEffect(()=>{const s=r.current,a=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(a,"value").set;if(n!==t&&l){const u=new Event("input",{bubbles:!0});l.call(s,t),s.dispatchEvent(u)}},[n,t]),j.jsx("input",{style:{display:"none"},...i,ref:r,defaultValue:t})};function Y_e(e=[],t,i){const r=[...e];return r[i]=t,r.sort((n,s)=>n-s)}function UQ(e,t,i){const s=100/(i-t)*(e-t);return AQ(s,[0,100])}function X_e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function K_e(e,t){if(e.length===1)return 0;const i=e.map(n=>Math.abs(n-t)),r=Math.min(...i);return i.indexOf(r)}function $_e(e,t,i){const r=e/2,s=j4([0,50],[0,r]);return(r-s(t)*i)*i}function Z_e(e){return e.slice(0,-1).map((t,i)=>e[i+1]-t)}function Q_e(e,t){if(t>0){const i=Z_e(e);return Math.min(...i)>=t}return!0}function j4(e,t){return i=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(i-e[0])}}function J_e(e){return(String(e).split(".")[1]||"").length}function ewe(e,t){const i=Math.pow(10,t);return Math.round(e*i)/i}var jQ=OQ,twe=BQ,iwe=zQ,rwe=FQ;const Ux=de.forwardRef(({className:e,...t},i)=>j.jsxs(jQ,{ref:i,className:an("relative flex w-full touch-none select-none items-center",e),...t,children:[j.jsx(twe,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:j.jsx(iwe,{className:"absolute h-full bg-primary"})}),j.jsx(rwe,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Ux.displayName=jQ.displayName;const nwe=({title:e="Interactive Experience",description:t="Adjust the sliders below to see how different parameters affect the visual elements.",className:i})=>{const[r,n]=ci.useState(180),[s,a]=ci.useState(50),[o,l]=ci.useState(0),[u,c]=ci.useState(100),h=r,d=s*2+100,f=o*3.6,m=u/100;return j.jsx("section",{className:an("py-20 bg-background w-full",i),children:j.jsxs("div",{className:"container mx-auto px-4",children:[j.jsxs(Ui.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"text-center mb-12",children:[j.jsx("h2",{className:"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl mb-4",children:e}),j.jsx("p",{className:"text-muted-foreground max-w-[700px] mx-auto mb-8",children:t})]}),j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[j.jsx(av,{className:"p-6 border border-border/40 bg-card",children:j.jsxs(ov,{className:"p-0 space-y-8",children:[j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("label",{className:"text-sm font-medium",children:"Color (Hue)"}),j.jsxs("span",{className:"text-sm text-muted-foreground",children:[r,"°"]})]}),j.jsx(Ux,{value:[r],min:0,max:360,step:1,onValueChange:g=>n(g[0]),className:"py-2"})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("label",{className:"text-sm font-medium",children:"Size"}),j.jsxs("span",{className:"text-sm text-muted-foreground",children:[s,"%"]})]}),j.jsx(Ux,{value:[s],min:0,max:100,step:1,onValueChange:g=>a(g[0]),className:"py-2"})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("label",{className:"text-sm font-medium",children:"Rotation"}),j.jsxs("span",{className:"text-sm text-muted-foreground",children:[o,"%"]})]}),j.jsx(Ux,{value:[o],min:0,max:100,step:1,onValueChange:g=>l(g[0]),className:"py-2"})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("label",{className:"text-sm font-medium",children:"Opacity"}),j.jsxs("span",{className:"text-sm text-muted-foreground",children:[u,"%"]})]}),j.jsx(Ux,{value:[u],min:0,max:100,step:1,onValueChange:g=>c(g[0]),className:"py-2"})]}),j.jsxs("div",{className:"pt-4 flex justify-center gap-4",children:[j.jsx(Zn,{variant:"outline",onClick:()=>{n(180),a(50),l(0),c(100)},children:"Reset"}),j.jsx(Zn,{onClick:()=>{n(Math.floor(Math.random()*360)),a(Math.floor(Math.random()*100)),l(Math.floor(Math.random()*100)),c(Math.floor(Math.random()*100))},children:"Randomize"})]})]})}),j.jsx("div",{className:"flex justify-center items-center min-h-[300px] relative",children:j.jsxs(Ui.div,{animate:{rotate:f,scale:s/50},transition:{type:"spring",stiffness:100},className:"relative flex items-center justify-center",children:[j.jsx("div",{className:"w-40 h-40 rounded-3xl flex items-center justify-center text-white font-bold text-xl shadow-lg",style:{backgroundColor:`hsla(${h}, 80%, 50%, ${m})`,boxShadow:`0 10px 25px hsla(${h}, 80%, 40%, ${m*.5})`},children:j.jsx("span",{children:"Interactive"})}),[...Array(3)].map((g,y)=>j.jsx(Ui.div,{className:"absolute rounded-full",animate:{rotate:f*(y+1)*.5,scale:[1,1.2,1]},transition:{scale:{repeat:1/0,duration:2+y*.5,ease:"easeInOut"}},style:{width:`${d*.8*(1+y*.4)}px`,height:`${d*.8*(1+y*.4)}px`,border:`2px solid hsla(${(h+y*30)%360}, 80%, 50%, ${m*.2})`}},y))]})})]})]})})};function Br(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function nu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function zo(e,t){const i=Br(e);return isNaN(t)?nu(e,NaN):(t&&i.setDate(i.getDate()+t),i)}function Cc(e,t){const i=Br(e);if(isNaN(t))return nu(e,NaN);if(!t)return i;const r=i.getDate(),n=nu(e,i.getTime());n.setMonth(i.getMonth()+t+1,0);const s=n.getDate();return r>=s?n:(i.setFullYear(n.getFullYear(),n.getMonth(),r),i)}const V4=6048e5,swe=864e5;let awe={};function Y_(){return awe}function Lh(e,t){var o,l,u,c;const i=Y_(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??i.weekStartsOn??((c=(u=i.locale)==null?void 0:u.options)==null?void 0:c.weekStartsOn)??0,n=Br(e),s=n.getDay(),a=(s<r?7:0)+s-r;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function Wg(e){return Lh(e,{weekStartsOn:1})}function VQ(e){const t=Br(e),i=t.getFullYear(),r=nu(e,0);r.setFullYear(i+1,0,4),r.setHours(0,0,0,0);const n=Wg(r),s=nu(e,0);s.setFullYear(i,0,4),s.setHours(0,0,0,0);const a=Wg(s);return t.getTime()>=n.getTime()?i+1:t.getTime()>=a.getTime()?i:i-1}function Py(e){const t=Br(e);return t.setHours(0,0,0,0),t}function TC(e){const t=Br(e),i=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return i.setUTCFullYear(t.getFullYear()),+e-+i}function _h(e,t){const i=Py(e),r=Py(t),n=+i-TC(i),s=+r-TC(r);return Math.round((n-s)/swe)}function owe(e){const t=VQ(e),i=nu(e,0);return i.setFullYear(t,0,4),i.setHours(0,0,0,0),Wg(i)}function C3(e,t){const i=t*7;return zo(e,i)}function lwe(e,t){return Cc(e,t*12)}function uwe(e){let t;return e.forEach(function(i){const r=Br(i);(t===void 0||t<r||isNaN(Number(r)))&&(t=r)}),t||new Date(NaN)}function cwe(e){let t;return e.forEach(i=>{const r=Br(i);(!t||t>r||isNaN(+r))&&(t=r)}),t||new Date(NaN)}function Tl(e,t){const i=Py(e),r=Py(t);return+i==+r}function H4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function hwe(e){if(!H4(e)&&typeof e!="number")return!1;const t=Br(e);return!isNaN(Number(t))}function n_(e,t){const i=Br(e),r=Br(t),n=i.getFullYear()-r.getFullYear(),s=i.getMonth()-r.getMonth();return n*12+s}function dwe(e,t,i){const r=Lh(e,i),n=Lh(t,i),s=+r-TC(r),a=+n-TC(n);return Math.round((s-a)/V4)}function W4(e){const t=Br(e),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function Il(e){const t=Br(e);return t.setDate(1),t.setHours(0,0,0,0),t}function HQ(e){const t=Br(e),i=nu(e,0);return i.setFullYear(t.getFullYear(),0,1),i.setHours(0,0,0,0),i}function G4(e,t){var o,l,u,c;const i=Y_(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??i.weekStartsOn??((c=(u=i.locale)==null?void 0:u.options)==null?void 0:c.weekStartsOn)??0,n=Br(e),s=n.getDay(),a=(s<r?-7:0)+6-(s-r);return n.setDate(n.getDate()+a),n.setHours(23,59,59,999),n}function WQ(e){return G4(e,{weekStartsOn:1})}const fwe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pwe=(e,t,i)=>{let r;const n=fwe[e];return typeof n=="string"?r=n:t===1?r=n.one:r=n.other.replace("{{count}}",t.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+r:r+" ago":r};function ny(e){return(t={})=>{const i=t.width?String(t.width):e.defaultWidth;return e.formats[i]||e.formats[e.defaultWidth]}}const mwe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},gwe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vwe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ywe={date:ny({formats:mwe,defaultWidth:"full"}),time:ny({formats:gwe,defaultWidth:"full"}),dateTime:ny({formats:vwe,defaultWidth:"full"})},xwe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},bwe=(e,t,i,r)=>xwe[e];function ph(e){return(t,i)=>{const r=i!=null&&i.context?String(i.context):"standalone";let n;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=i!=null&&i.width?String(i.width):a;n=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=i!=null&&i.width?String(i.width):e.defaultWidth;n=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return n[s]}}const _we={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},wwe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ewe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Swe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Twe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Cwe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Awe=(e,t)=>{const i=Number(e),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},Mwe={ordinalNumber:Awe,era:ph({values:_we,defaultWidth:"wide"}),quarter:ph({values:wwe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ph({values:Ewe,defaultWidth:"wide"}),day:ph({values:Swe,defaultWidth:"wide"}),dayPeriod:ph({values:Twe,defaultWidth:"wide",formattingValues:Cwe,defaultFormattingWidth:"wide"})};function mh(e){return(t,i={})=>{const r=i.width,n=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(n);if(!s)return null;const a=s[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?Dwe(o,h=>h.test(a)):Pwe(o,h=>h.test(a));let u;u=e.valueCallback?e.valueCallback(l):l,u=i.valueCallback?i.valueCallback(u):u;const c=t.slice(a.length);return{value:u,rest:c}}}function Pwe(e,t){for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return i}function Dwe(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return i}function GQ(e){return(t,i={})=>{const r=t.match(e.matchPattern);if(!r)return null;const n=r[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=i.valueCallback?i.valueCallback(a):a;const o=t.slice(n.length);return{value:a,rest:o}}}const Iwe=/^(\d+)(th|st|nd|rd)?/i,Owe=/\d+/i,Rwe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Lwe={any:[/^b/i,/^(a|c)/i]},Nwe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},kwe={any:[/1/i,/2/i,/3/i,/4/i]},Bwe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zwe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Fwe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Uwe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},jwe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Vwe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Hwe={ordinalNumber:GQ({matchPattern:Iwe,parsePattern:Owe,valueCallback:e=>parseInt(e,10)}),era:mh({matchPatterns:Rwe,defaultMatchWidth:"wide",parsePatterns:Lwe,defaultParseWidth:"any"}),quarter:mh({matchPatterns:Nwe,defaultMatchWidth:"wide",parsePatterns:kwe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:mh({matchPatterns:Bwe,defaultMatchWidth:"wide",parsePatterns:zwe,defaultParseWidth:"any"}),day:mh({matchPatterns:Fwe,defaultMatchWidth:"wide",parsePatterns:Uwe,defaultParseWidth:"any"}),dayPeriod:mh({matchPatterns:jwe,defaultMatchWidth:"any",parsePatterns:Vwe,defaultParseWidth:"any"})},qQ={code:"en-US",formatDistance:pwe,formatLong:ywe,formatRelative:bwe,localize:Mwe,match:Hwe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Wwe(e){const t=Br(e);return _h(t,HQ(t))+1}function YQ(e){const t=Br(e),i=+Wg(t)-+owe(t);return Math.round(i/V4)+1}function XQ(e,t){var c,h,d,f;const i=Br(e),r=i.getFullYear(),n=Y_(),s=(t==null?void 0:t.firstWeekContainsDate)??((h=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,a=nu(e,0);a.setFullYear(r+1,0,s),a.setHours(0,0,0,0);const o=Lh(a,t),l=nu(e,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);const u=Lh(l,t);return i.getTime()>=o.getTime()?r+1:i.getTime()>=u.getTime()?r:r-1}function Gwe(e,t){var o,l,u,c;const i=Y_(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??i.firstWeekContainsDate??((c=(u=i.locale)==null?void 0:u.options)==null?void 0:c.firstWeekContainsDate)??1,n=XQ(e,t),s=nu(e,0);return s.setFullYear(n,0,r),s.setHours(0,0,0,0),Lh(s,t)}function KQ(e,t){const i=Br(e),r=+Lh(i,t)-+Gwe(i,t);return Math.round(r/V4)+1}function Kr(e,t){const i=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return i+r}const Lf={y(e,t){const i=e.getFullYear(),r=i>0?i:1-i;return Kr(t==="yy"?r%100:r,t.length)},M(e,t){const i=e.getMonth();return t==="M"?String(i+1):Kr(i+1,2)},d(e,t){return Kr(e.getDate(),t.length)},a(e,t){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h(e,t){return Kr(e.getHours()%12||12,t.length)},H(e,t){return Kr(e.getHours(),t.length)},m(e,t){return Kr(e.getMinutes(),t.length)},s(e,t){return Kr(e.getSeconds(),t.length)},S(e,t){const i=t.length,r=e.getMilliseconds(),n=Math.trunc(r*Math.pow(10,i-3));return Kr(n,t.length)}},Ov={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},rV={G:function(e,t,i){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})}},y:function(e,t,i){if(t==="yo"){const r=e.getFullYear(),n=r>0?r:1-r;return i.ordinalNumber(n,{unit:"year"})}return Lf.y(e,t)},Y:function(e,t,i,r){const n=XQ(e,r),s=n>0?n:1-n;if(t==="YY"){const a=s%100;return Kr(a,2)}return t==="Yo"?i.ordinalNumber(s,{unit:"year"}):Kr(s,t.length)},R:function(e,t){const i=VQ(e);return Kr(i,t.length)},u:function(e,t){const i=e.getFullYear();return Kr(i,t.length)},Q:function(e,t,i){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Kr(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,i){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Kr(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,i){const r=e.getMonth();switch(t){case"M":case"MM":return Lf.M(e,t);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,i){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Kr(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,i,r){const n=KQ(e,r);return t==="wo"?i.ordinalNumber(n,{unit:"week"}):Kr(n,t.length)},I:function(e,t,i){const r=YQ(e);return t==="Io"?i.ordinalNumber(r,{unit:"week"}):Kr(r,t.length)},d:function(e,t,i){return t==="do"?i.ordinalNumber(e.getDate(),{unit:"date"}):Lf.d(e,t)},D:function(e,t,i){const r=Wwe(e);return t==="Do"?i.ordinalNumber(r,{unit:"dayOfYear"}):Kr(r,t.length)},E:function(e,t,i){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,i,r){const n=e.getDay(),s=(n-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Kr(s,2);case"eo":return i.ordinalNumber(s,{unit:"day"});case"eee":return i.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(n,{width:"short",context:"formatting"});case"eeee":default:return i.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,i,r){const n=e.getDay(),s=(n-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Kr(s,t.length);case"co":return i.ordinalNumber(s,{unit:"day"});case"ccc":return i.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(n,{width:"narrow",context:"standalone"});case"cccccc":return i.day(n,{width:"short",context:"standalone"});case"cccc":default:return i.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,i){const r=e.getDay(),n=r===0?7:r;switch(t){case"i":return String(n);case"ii":return Kr(n,t.length);case"io":return i.ordinalNumber(n,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});case"iiii":default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,i){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,i){const r=e.getHours();let n;switch(r===12?n=Ov.noon:r===0?n=Ov.midnight:n=r/12>=1?"pm":"am",t){case"b":case"bb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,i){const r=e.getHours();let n;switch(r>=17?n=Ov.evening:r>=12?n=Ov.afternoon:r>=4?n=Ov.morning:n=Ov.night,t){case"B":case"BB":case"BBB":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,i){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),i.ordinalNumber(r,{unit:"hour"})}return Lf.h(e,t)},H:function(e,t,i){return t==="Ho"?i.ordinalNumber(e.getHours(),{unit:"hour"}):Lf.H(e,t)},K:function(e,t,i){const r=e.getHours()%12;return t==="Ko"?i.ordinalNumber(r,{unit:"hour"}):Kr(r,t.length)},k:function(e,t,i){let r=e.getHours();return r===0&&(r=24),t==="ko"?i.ordinalNumber(r,{unit:"hour"}):Kr(r,t.length)},m:function(e,t,i){return t==="mo"?i.ordinalNumber(e.getMinutes(),{unit:"minute"}):Lf.m(e,t)},s:function(e,t,i){return t==="so"?i.ordinalNumber(e.getSeconds(),{unit:"second"}):Lf.s(e,t)},S:function(e,t){return Lf.S(e,t)},X:function(e,t,i){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return sV(r);case"XXXX":case"XX":return tg(r);case"XXXXX":case"XXX":default:return tg(r,":")}},x:function(e,t,i){const r=e.getTimezoneOffset();switch(t){case"x":return sV(r);case"xxxx":case"xx":return tg(r);case"xxxxx":case"xxx":default:return tg(r,":")}},O:function(e,t,i){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+nV(r,":");case"OOOO":default:return"GMT"+tg(r,":")}},z:function(e,t,i){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+nV(r,":");case"zzzz":default:return"GMT"+tg(r,":")}},t:function(e,t,i){const r=Math.trunc(e.getTime()/1e3);return Kr(r,t.length)},T:function(e,t,i){const r=e.getTime();return Kr(r,t.length)}};function nV(e,t=""){const i=e>0?"-":"+",r=Math.abs(e),n=Math.trunc(r/60),s=r%60;return s===0?i+String(n):i+String(n)+t+Kr(s,2)}function sV(e,t){return e%60===0?(e>0?"-":"+")+Kr(Math.abs(e)/60,2):tg(e,t)}function tg(e,t=""){const i=e>0?"-":"+",r=Math.abs(e),n=Kr(Math.trunc(r/60),2),s=Kr(r%60,2);return i+n+t+s}const aV=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},$Q=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},qwe=(e,t)=>{const i=e.match(/(P+)(p+)?/)||[],r=i[1],n=i[2];if(!n)return aV(e,t);let s;switch(r){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",aV(r,t)).replace("{{time}}",$Q(n,t))},Ywe={p:$Q,P:qwe},Xwe=/^D+$/,Kwe=/^Y+$/,$we=["D","DD","YY","YYYY"];function Zwe(e){return Xwe.test(e)}function Qwe(e){return Kwe.test(e)}function Jwe(e,t,i){const r=eEe(e,t,i);if(console.warn(r),$we.includes(e))throw new RangeError(r)}function eEe(e,t,i){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${i}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const tEe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,iEe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rEe=/^'([^]*?)'?$/,nEe=/''/g,sEe=/[a-zA-Z]/;function rm(e,t,i){var c,h,d,f,m,g,y,x;const r=Y_(),n=(i==null?void 0:i.locale)??r.locale??qQ,s=(i==null?void 0:i.firstWeekContainsDate)??((h=(c=i==null?void 0:i.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(d=r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,a=(i==null?void 0:i.weekStartsOn)??((g=(m=i==null?void 0:i.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??r.weekStartsOn??((x=(y=r.locale)==null?void 0:y.options)==null?void 0:x.weekStartsOn)??0,o=Br(e);if(!hwe(o))throw new RangeError("Invalid time value");let l=t.match(iEe).map(w=>{const b=w[0];if(b==="p"||b==="P"){const C=Ywe[b];return C(w,n.formatLong)}return w}).join("").match(tEe).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const b=w[0];if(b==="'")return{isToken:!1,value:aEe(w)};if(rV[b])return{isToken:!0,value:w};if(b.match(sEe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:w}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const u={firstWeekContainsDate:s,weekStartsOn:a,locale:n};return l.map(w=>{if(!w.isToken)return w.value;const b=w.value;(!(i!=null&&i.useAdditionalWeekYearTokens)&&Qwe(b)||!(i!=null&&i.useAdditionalDayOfYearTokens)&&Zwe(b))&&Jwe(b,t,String(e));const C=rV[b[0]];return C(o,b,n.localize,u)}).join("")}function aEe(e){const t=e.match(rEe);return t?t[1].replace(nEe,"'"):e}function oEe(e){const t=Br(e),i=t.getFullYear(),r=t.getMonth(),n=nu(e,0);return n.setFullYear(i,r+1,0),n.setHours(0,0,0,0),n.getDate()}function lEe(e){return Math.trunc(+Br(e)/1e3)}function uEe(e){const t=Br(e),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(0,0,0,0),t}function cEe(e,t){return dwe(uEe(e),Il(e),t)+1}function A3(e,t){const i=Br(e),r=Br(t);return i.getTime()>r.getTime()}function q4(e,t){const i=Br(e),r=Br(t);return+i<+r}function Y4(e,t){const i=Br(e),r=Br(t);return i.getFullYear()===r.getFullYear()&&i.getMonth()===r.getMonth()}function hEe(e,t){const i=Br(e),r=Br(t);return i.getFullYear()===r.getFullYear()}function cD(e,t){return zo(e,-t)}function hD(e,t){const i=Br(e),r=i.getFullYear(),n=i.getDate(),s=nu(e,0);s.setFullYear(r,t,15),s.setHours(0,0,0,0);const a=oEe(s);return i.setMonth(t,Math.min(n,a)),i}function oV(e,t){const i=Br(e);return isNaN(+i)?nu(e,NaN):(i.setFullYear(t),i)}const dEe={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},fEe=(e,t,i)=>{let r;const n=dEe[e];return typeof n=="string"?r=n:t===1?r=n.one:r=n.other.replace("{{count}}",String(t)),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"dans "+r:"il y a "+r:r},pEe={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},mEe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},gEe={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vEe={date:ny({formats:pEe,defaultWidth:"full"}),time:ny({formats:mEe,defaultWidth:"full"}),dateTime:ny({formats:gEe,defaultWidth:"full"})},yEe={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},xEe=(e,t,i,r)=>yEe[e],bEe={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},_Ee={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},wEe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},EEe={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},SEe={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},TEe=(e,t)=>{const i=Number(e),r=t==null?void 0:t.unit;if(i===0)return"0";const n=["year","week","hour","minute","second"];let s;return i===1?s=r&&n.includes(r)?"ère":"er":s="ème",i+s},CEe=["MMM","MMMM"],AEe={preprocessor:(e,t)=>e.getDate()===1||!t.some(r=>r.isToken&&CEe.includes(r.value))?t:t.map(r=>r.isToken&&r.value==="do"?{isToken:!0,value:"d"}:r),ordinalNumber:TEe,era:ph({values:bEe,defaultWidth:"wide"}),quarter:ph({values:_Ee,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ph({values:wEe,defaultWidth:"wide"}),day:ph({values:EEe,defaultWidth:"wide"}),dayPeriod:ph({values:SEe,defaultWidth:"wide"})},MEe=/^(\d+)(ième|ère|ème|er|e)?/i,PEe=/\d+/i,DEe={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},IEe={any:[/^av/i,/^ap/i]},OEe={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},REe={any:[/1/i,/2/i,/3/i,/4/i]},LEe={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},NEe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},kEe={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},BEe={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},zEe={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},FEe={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},UEe={ordinalNumber:GQ({matchPattern:MEe,parsePattern:PEe,valueCallback:e=>parseInt(e)}),era:mh({matchPatterns:DEe,defaultMatchWidth:"wide",parsePatterns:IEe,defaultParseWidth:"any"}),quarter:mh({matchPatterns:OEe,defaultMatchWidth:"wide",parsePatterns:REe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:mh({matchPatterns:LEe,defaultMatchWidth:"wide",parsePatterns:NEe,defaultParseWidth:"any"}),day:mh({matchPatterns:kEe,defaultMatchWidth:"wide",parsePatterns:BEe,defaultParseWidth:"any"}),dayPeriod:mh({matchPatterns:zEe,defaultMatchWidth:"any",parsePatterns:FEe,defaultParseWidth:"any"})},jEe={code:"fr",formatDistance:fEe,formatLong:vEe,formatRelative:xEe,localize:AEe,match:UEe,options:{weekStartsOn:1,firstWeekContainsDate:4}};var Bi=function(){return Bi=Object.assign||function(t){for(var i,r=1,n=arguments.length;r<n;r++){i=arguments[r];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Bi.apply(this,arguments)};function VEe(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i}function ZQ(e,t,i){for(var r=0,n=t.length,s;r<n;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function X_(e){return e.mode==="multiple"}function K_(e){return e.mode==="range"}function xM(e){return e.mode==="single"}var HEe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function WEe(e,t){return rm(e,"LLLL y",t)}function GEe(e,t){return rm(e,"d",t)}function qEe(e,t){return rm(e,"LLLL",t)}function YEe(e){return"".concat(e)}function XEe(e,t){return rm(e,"cccccc",t)}function KEe(e,t){return rm(e,"yyyy",t)}var $Ee=Object.freeze({__proto__:null,formatCaption:WEe,formatDay:GEe,formatMonthCaption:qEe,formatWeekNumber:YEe,formatWeekdayName:XEe,formatYearCaption:KEe}),ZEe=function(e,t,i){return rm(e,"do MMMM (EEEE)",i)},QEe=function(){return"Month: "},JEe=function(){return"Go to next month"},eSe=function(){return"Go to previous month"},tSe=function(e,t){return rm(e,"cccc",t)},iSe=function(e){return"Week n. ".concat(e)},rSe=function(){return"Year: "},nSe=Object.freeze({__proto__:null,labelDay:ZEe,labelMonthDropdown:QEe,labelNext:JEe,labelPrevious:eSe,labelWeekNumber:iSe,labelWeekday:tSe,labelYearDropdown:rSe});function sSe(){var e="buttons",t=HEe,i=qQ,r={},n={},s=1,a={},o=new Date;return{captionLayout:e,classNames:t,formatters:$Ee,labels:nSe,locale:i,modifiersClassNames:r,modifiers:n,numberOfMonths:s,styles:a,today:o,mode:"default"}}function aSe(e){var t=e.fromYear,i=e.toYear,r=e.fromMonth,n=e.toMonth,s=e.fromDate,a=e.toDate;return r?s=Il(r):t&&(s=new Date(t,0,1)),n?a=W4(n):i&&(a=new Date(i,11,31)),{fromDate:s?Py(s):void 0,toDate:a?Py(a):void 0}}var QQ=de.createContext(void 0);function oSe(e){var t,i=e.initialProps,r=sSe(),n=aSe(i),s=n.fromDate,a=n.toDate,o=(t=i.captionLayout)!==null&&t!==void 0?t:r.captionLayout;o!=="buttons"&&(!s||!a)&&(o="buttons");var l;(xM(i)||X_(i)||K_(i))&&(l=i.onSelect);var u=Bi(Bi(Bi({},r),i),{captionLayout:o,classNames:Bi(Bi({},r.classNames),i.classNames),components:Bi({},i.components),formatters:Bi(Bi({},r.formatters),i.formatters),fromDate:s,labels:Bi(Bi({},r.labels),i.labels),mode:i.mode||r.mode,modifiers:Bi(Bi({},r.modifiers),i.modifiers),modifiersClassNames:Bi(Bi({},r.modifiersClassNames),i.modifiersClassNames),onSelect:l,styles:Bi(Bi({},r.styles),i.styles),toDate:a});return j.jsx(QQ.Provider,{value:u,children:e.children})}function _n(){var e=de.useContext(QQ);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function JQ(e){var t=_n(),i=t.locale,r=t.classNames,n=t.styles,s=t.formatters.formatCaption;return j.jsx("div",{className:r.caption_label,style:n.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:i})})}function lSe(e){return j.jsx("svg",Bi({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:j.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function eJ(e){var t,i,r=e.onChange,n=e.value,s=e.children,a=e.caption,o=e.className,l=e.style,u=_n(),c=(i=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&i!==void 0?i:lSe;return j.jsxs("div",{className:o,style:l,children:[j.jsx("span",{className:u.classNames.vhidden,children:e["aria-label"]}),j.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:n,onChange:r,children:s}),j.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[a,j.jsx(c,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function uSe(e){var t,i=_n(),r=i.fromDate,n=i.toDate,s=i.styles,a=i.locale,o=i.formatters.formatMonthCaption,l=i.classNames,u=i.components,c=i.labels.labelMonthDropdown;if(!r)return j.jsx(j.Fragment,{});if(!n)return j.jsx(j.Fragment,{});var h=[];if(hEe(r,n))for(var d=Il(r),f=r.getMonth();f<=n.getMonth();f++)h.push(hD(d,f));else for(var d=Il(new Date),f=0;f<=11;f++)h.push(hD(d,f));var m=function(y){var x=Number(y.target.value),w=hD(Il(e.displayMonth),x);e.onChange(w)},g=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:eJ;return j.jsx(g,{name:"months","aria-label":c(),className:l.dropdown_month,style:s.dropdown_month,onChange:m,value:e.displayMonth.getMonth(),caption:o(e.displayMonth,{locale:a}),children:h.map(function(y){return j.jsx("option",{value:y.getMonth(),children:o(y,{locale:a})},y.getMonth())})})}function cSe(e){var t,i=e.displayMonth,r=_n(),n=r.fromDate,s=r.toDate,a=r.locale,o=r.styles,l=r.classNames,u=r.components,c=r.formatters.formatYearCaption,h=r.labels.labelYearDropdown,d=[];if(!n)return j.jsx(j.Fragment,{});if(!s)return j.jsx(j.Fragment,{});for(var f=n.getFullYear(),m=s.getFullYear(),g=f;g<=m;g++)d.push(oV(HQ(new Date),g));var y=function(w){var b=oV(Il(i),Number(w.target.value));e.onChange(b)},x=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:eJ;return j.jsx(x,{name:"years","aria-label":h(),className:l.dropdown_year,style:o.dropdown_year,onChange:y,value:i.getFullYear(),caption:c(i,{locale:a}),children:d.map(function(w){return j.jsx("option",{value:w.getFullYear(),children:c(w,{locale:a})},w.getFullYear())})})}function hSe(e,t){var i=de.useState(e),r=i[0],n=i[1],s=t===void 0?r:t;return[s,n]}function dSe(e){var t=e.month,i=e.defaultMonth,r=e.today,n=t||i||r||new Date,s=e.toDate,a=e.fromDate,o=e.numberOfMonths,l=o===void 0?1:o;if(s&&n_(s,n)<0){var u=-1*(l-1);n=Cc(s,u)}return a&&n_(n,a)<0&&(n=a),Il(n)}function fSe(){var e=_n(),t=dSe(e),i=hSe(t,e.month),r=i[0],n=i[1],s=function(a){var o;if(!e.disableNavigation){var l=Il(a);n(l),(o=e.onMonthChange)===null||o===void 0||o.call(e,l)}};return[r,s]}function pSe(e,t){for(var i=t.reverseMonths,r=t.numberOfMonths,n=Il(e),s=Il(Cc(n,r)),a=n_(s,n),o=[],l=0;l<a;l++){var u=Cc(n,l);o.push(u)}return i&&(o=o.reverse()),o}function mSe(e,t){if(!t.disableNavigation){var i=t.toDate,r=t.pagedNavigation,n=t.numberOfMonths,s=n===void 0?1:n,a=r?s:1,o=Il(e);if(!i)return Cc(o,a);var l=n_(i,e);if(!(l<s))return Cc(o,a)}}function gSe(e,t){if(!t.disableNavigation){var i=t.fromDate,r=t.pagedNavigation,n=t.numberOfMonths,s=n===void 0?1:n,a=r?s:1,o=Il(e);if(!i)return Cc(o,-a);var l=n_(o,i);if(!(l<=0))return Cc(o,-a)}}var tJ=de.createContext(void 0);function vSe(e){var t=_n(),i=fSe(),r=i[0],n=i[1],s=pSe(r,t),a=mSe(r,t),o=gSe(r,t),l=function(h){return s.some(function(d){return Y4(h,d)})},u=function(h,d){l(h)||(d&&q4(h,d)?n(Cc(h,1+t.numberOfMonths*-1)):n(h))},c={currentMonth:r,displayMonths:s,goToMonth:n,goToDate:u,previousMonth:o,nextMonth:a,isDateDisplayed:l};return j.jsx(tJ.Provider,{value:c,children:e.children})}function $_(){var e=de.useContext(tJ);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function lV(e){var t,i=_n(),r=i.classNames,n=i.styles,s=i.components,a=$_().goToMonth,o=function(c){a(Cc(c,e.displayIndex?-e.displayIndex:0))},l=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:JQ,u=j.jsx(l,{id:e.id,displayMonth:e.displayMonth});return j.jsxs("div",{className:r.caption_dropdowns,style:n.caption_dropdowns,children:[j.jsx("div",{className:r.vhidden,children:u}),j.jsx(uSe,{onChange:o,displayMonth:e.displayMonth}),j.jsx(cSe,{onChange:o,displayMonth:e.displayMonth})]})}function ySe(e){return j.jsx("svg",Bi({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:j.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function xSe(e){return j.jsx("svg",Bi({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:j.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var CC=de.forwardRef(function(e,t){var i=_n(),r=i.classNames,n=i.styles,s=[r.button_reset,r.button];e.className&&s.push(e.className);var a=s.join(" "),o=Bi(Bi({},n.button_reset),n.button);return e.style&&Object.assign(o,e.style),j.jsx("button",Bi({},e,{ref:t,type:"button",className:a,style:o}))});function bSe(e){var t,i,r=_n(),n=r.dir,s=r.locale,a=r.classNames,o=r.styles,l=r.labels,u=l.labelPrevious,c=l.labelNext,h=r.components;if(!e.nextMonth&&!e.previousMonth)return j.jsx(j.Fragment,{});var d=u(e.previousMonth,{locale:s}),f=[a.nav_button,a.nav_button_previous].join(" "),m=c(e.nextMonth,{locale:s}),g=[a.nav_button,a.nav_button_next].join(" "),y=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:xSe,x=(i=h==null?void 0:h.IconLeft)!==null&&i!==void 0?i:ySe;return j.jsxs("div",{className:a.nav,style:o.nav,children:[!e.hidePrevious&&j.jsx(CC,{name:"previous-month","aria-label":d,className:f,style:o.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:n==="rtl"?j.jsx(y,{className:a.nav_icon,style:o.nav_icon}):j.jsx(x,{className:a.nav_icon,style:o.nav_icon})}),!e.hideNext&&j.jsx(CC,{name:"next-month","aria-label":m,className:g,style:o.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:n==="rtl"?j.jsx(x,{className:a.nav_icon,style:o.nav_icon}):j.jsx(y,{className:a.nav_icon,style:o.nav_icon})})]})}function uV(e){var t=_n().numberOfMonths,i=$_(),r=i.previousMonth,n=i.nextMonth,s=i.goToMonth,a=i.displayMonths,o=a.findIndex(function(m){return Y4(e.displayMonth,m)}),l=o===0,u=o===a.length-1,c=t>1&&(l||!u),h=t>1&&(u||!l),d=function(){r&&s(r)},f=function(){n&&s(n)};return j.jsx(bSe,{displayMonth:e.displayMonth,hideNext:c,hidePrevious:h,nextMonth:n,previousMonth:r,onPreviousClick:d,onNextClick:f})}function _Se(e){var t,i=_n(),r=i.classNames,n=i.disableNavigation,s=i.styles,a=i.captionLayout,o=i.components,l=(t=o==null?void 0:o.CaptionLabel)!==null&&t!==void 0?t:JQ,u;return n?u=j.jsx(l,{id:e.id,displayMonth:e.displayMonth}):a==="dropdown"?u=j.jsx(lV,{displayMonth:e.displayMonth,id:e.id}):a==="dropdown-buttons"?u=j.jsxs(j.Fragment,{children:[j.jsx(lV,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),j.jsx(uV,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):u=j.jsxs(j.Fragment,{children:[j.jsx(l,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),j.jsx(uV,{displayMonth:e.displayMonth,id:e.id})]}),j.jsx("div",{className:r.caption,style:s.caption,children:u})}function wSe(e){var t=_n(),i=t.footer,r=t.styles,n=t.classNames.tfoot;return i?j.jsx("tfoot",{className:n,style:r.tfoot,children:j.jsx("tr",{children:j.jsx("td",{colSpan:8,children:i})})}):j.jsx(j.Fragment,{})}function ESe(e,t,i){for(var r=i?Wg(new Date):Lh(new Date,{locale:e,weekStartsOn:t}),n=[],s=0;s<7;s++){var a=zo(r,s);n.push(a)}return n}function SSe(){var e=_n(),t=e.classNames,i=e.styles,r=e.showWeekNumber,n=e.locale,s=e.weekStartsOn,a=e.ISOWeek,o=e.formatters.formatWeekdayName,l=e.labels.labelWeekday,u=ESe(n,s,a);return j.jsxs("tr",{style:i.head_row,className:t.head_row,children:[r&&j.jsx("td",{style:i.head_cell,className:t.head_cell}),u.map(function(c,h){return j.jsx("th",{scope:"col",className:t.head_cell,style:i.head_cell,"aria-label":l(c,{locale:n}),children:o(c,{locale:n})},h)})]})}function TSe(){var e,t=_n(),i=t.classNames,r=t.styles,n=t.components,s=(e=n==null?void 0:n.HeadRow)!==null&&e!==void 0?e:SSe;return j.jsx("thead",{style:r.head,className:i.head,children:j.jsx(s,{})})}function CSe(e){var t=_n(),i=t.locale,r=t.formatters.formatDay;return j.jsx(j.Fragment,{children:r(e.date,{locale:i})})}var X4=de.createContext(void 0);function ASe(e){if(!X_(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return j.jsx(X4.Provider,{value:t,children:e.children})}return j.jsx(MSe,{initialProps:e.initialProps,children:e.children})}function MSe(e){var t=e.initialProps,i=e.children,r=t.selected,n=t.min,s=t.max,a=function(u,c,h){var d,f;(d=t.onDayClick)===null||d===void 0||d.call(t,u,c,h);var m=!!(c.selected&&n&&(r==null?void 0:r.length)===n);if(!m){var g=!!(!c.selected&&s&&(r==null?void 0:r.length)===s);if(!g){var y=r?ZQ([],r):[];if(c.selected){var x=y.findIndex(function(w){return Tl(u,w)});y.splice(x,1)}else y.push(u);(f=t.onSelect)===null||f===void 0||f.call(t,y,u,c,h)}}},o={disabled:[]};r&&o.disabled.push(function(u){var c=s&&r.length>s-1,h=r.some(function(d){return Tl(d,u)});return!!(c&&!h)});var l={selected:r,onDayClick:a,modifiers:o};return j.jsx(X4.Provider,{value:l,children:i})}function K4(){var e=de.useContext(X4);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function PSe(e,t){var i=t||{},r=i.from,n=i.to;return r&&n?Tl(n,e)&&Tl(r,e)?void 0:Tl(n,e)?{from:n,to:void 0}:Tl(r,e)?void 0:A3(r,e)?{from:e,to:n}:{from:r,to:e}:n?A3(e,n)?{from:n,to:e}:{from:e,to:n}:r?q4(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var $4=de.createContext(void 0);function DSe(e){if(!K_(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return j.jsx($4.Provider,{value:t,children:e.children})}return j.jsx(ISe,{initialProps:e.initialProps,children:e.children})}function ISe(e){var t=e.initialProps,i=e.children,r=t.selected,n=r||{},s=n.from,a=n.to,o=t.min,l=t.max,u=function(f,m,g){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,f,m,g);var w=PSe(f,r);(x=t.onSelect)===null||x===void 0||x.call(t,w,f,m,g)},c={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(c.range_start=[s],a?(c.range_end=[a],Tl(s,a)||(c.range_middle=[{after:s,before:a}])):c.range_end=[s]):a&&(c.range_start=[a],c.range_end=[a]),o&&(s&&!a&&c.disabled.push({after:cD(s,o-1),before:zo(s,o-1)}),s&&a&&c.disabled.push({after:s,before:zo(s,o-1)}),!s&&a&&c.disabled.push({after:cD(a,o-1),before:zo(a,o-1)})),l){if(s&&!a&&(c.disabled.push({before:zo(s,-l+1)}),c.disabled.push({after:zo(s,l-1)})),s&&a){var h=_h(a,s)+1,d=l-h;c.disabled.push({before:cD(s,d)}),c.disabled.push({after:zo(a,d)})}!s&&a&&(c.disabled.push({before:zo(a,-l+1)}),c.disabled.push({after:zo(a,l-1)}))}return j.jsx($4.Provider,{value:{selected:r,onDayClick:u,modifiers:c},children:i})}function Z4(){var e=de.useContext($4);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function yT(e){return Array.isArray(e)?ZQ([],e):e!==void 0?[e]:[]}function OSe(e){var t={};return Object.entries(e).forEach(function(i){var r=i[0],n=i[1];t[r]=yT(n)}),t}var Ac;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Ac||(Ac={}));var RSe=Ac.Selected,gd=Ac.Disabled,LSe=Ac.Hidden,NSe=Ac.Today,dD=Ac.RangeEnd,fD=Ac.RangeMiddle,pD=Ac.RangeStart,kSe=Ac.Outside;function BSe(e,t,i){var r,n=(r={},r[RSe]=yT(e.selected),r[gd]=yT(e.disabled),r[LSe]=yT(e.hidden),r[NSe]=[e.today],r[dD]=[],r[fD]=[],r[pD]=[],r[kSe]=[],r);return e.fromDate&&n[gd].push({before:e.fromDate}),e.toDate&&n[gd].push({after:e.toDate}),X_(e)?n[gd]=n[gd].concat(t.modifiers[gd]):K_(e)&&(n[gd]=n[gd].concat(i.modifiers[gd]),n[pD]=i.modifiers[pD],n[fD]=i.modifiers[fD],n[dD]=i.modifiers[dD]),n}var iJ=de.createContext(void 0);function zSe(e){var t=_n(),i=K4(),r=Z4(),n=BSe(t,i,r),s=OSe(t.modifiers),a=Bi(Bi({},n),s);return j.jsx(iJ.Provider,{value:a,children:e.children})}function rJ(){var e=de.useContext(iJ);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function FSe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function USe(e){return!!(e&&typeof e=="object"&&"from"in e)}function jSe(e){return!!(e&&typeof e=="object"&&"after"in e)}function VSe(e){return!!(e&&typeof e=="object"&&"before"in e)}function HSe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function WSe(e,t){var i,r=t.from,n=t.to;if(r&&n){var s=_h(n,r)<0;s&&(i=[n,r],r=i[0],n=i[1]);var a=_h(e,r)>=0&&_h(n,e)>=0;return a}return n?Tl(n,e):r?Tl(r,e):!1}function GSe(e){return H4(e)}function qSe(e){return Array.isArray(e)&&e.every(H4)}function YSe(e,t){return t.some(function(i){if(typeof i=="boolean")return i;if(GSe(i))return Tl(e,i);if(qSe(i))return i.includes(e);if(USe(i))return WSe(e,i);if(HSe(i))return i.dayOfWeek.includes(e.getDay());if(FSe(i)){var r=_h(i.before,e),n=_h(i.after,e),s=r>0,a=n<0,o=A3(i.before,i.after);return o?a&&s:s||a}return jSe(i)?_h(e,i.after)>0:VSe(i)?_h(i.before,e)>0:typeof i=="function"?i(e):!1})}function Q4(e,t,i){var r=Object.keys(t).reduce(function(s,a){var o=t[a];return YSe(e,o)&&s.push(a),s},[]),n={};return r.forEach(function(s){return n[s]=!0}),i&&!Y4(e,i)&&(n.outside=!0),n}function XSe(e,t){for(var i=Il(e[0]),r=W4(e[e.length-1]),n,s,a=i;a<=r;){var o=Q4(a,t),l=!o.disabled&&!o.hidden;if(!l){a=zo(a,1);continue}if(o.selected)return a;o.today&&!s&&(s=a),n||(n=a),a=zo(a,1)}return s||n}var KSe=365;function nJ(e,t){var i=t.moveBy,r=t.direction,n=t.context,s=t.modifiers,a=t.retry,o=a===void 0?{count:0,lastFocused:e}:a,l=n.weekStartsOn,u=n.fromDate,c=n.toDate,h=n.locale,d={day:zo,week:C3,month:Cc,year:lwe,startOfWeek:function(y){return n.ISOWeek?Wg(y):Lh(y,{locale:h,weekStartsOn:l})},endOfWeek:function(y){return n.ISOWeek?WQ(y):G4(y,{locale:h,weekStartsOn:l})}},f=d[i](e,r==="after"?1:-1);r==="before"&&u?f=uwe([u,f]):r==="after"&&c&&(f=cwe([c,f]));var m=!0;if(s){var g=Q4(f,s);m=!g.disabled&&!g.hidden}return m?f:o.count>KSe?o.lastFocused:nJ(f,{moveBy:i,direction:r,context:n,modifiers:s,retry:Bi(Bi({},o),{count:o.count+1})})}var sJ=de.createContext(void 0);function $Se(e){var t=$_(),i=rJ(),r=de.useState(),n=r[0],s=r[1],a=de.useState(),o=a[0],l=a[1],u=XSe(t.displayMonths,i),c=n??(o&&t.isDateDisplayed(o))?o:u,h=function(){l(n),s(void 0)},d=function(y){s(y)},f=_n(),m=function(y,x){if(n){var w=nJ(n,{moveBy:y,direction:x,context:f,modifiers:i});Tl(n,w)||(t.goToDate(w,n),d(w))}},g={focusedDay:n,focusTarget:c,blur:h,focus:d,focusDayAfter:function(){return m("day","after")},focusDayBefore:function(){return m("day","before")},focusWeekAfter:function(){return m("week","after")},focusWeekBefore:function(){return m("week","before")},focusMonthBefore:function(){return m("month","before")},focusMonthAfter:function(){return m("month","after")},focusYearBefore:function(){return m("year","before")},focusYearAfter:function(){return m("year","after")},focusStartOfWeek:function(){return m("startOfWeek","before")},focusEndOfWeek:function(){return m("endOfWeek","after")}};return j.jsx(sJ.Provider,{value:g,children:e.children})}function J4(){var e=de.useContext(sJ);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function ZSe(e,t){var i=rJ(),r=Q4(e,i,t);return r}var eB=de.createContext(void 0);function QSe(e){if(!xM(e.initialProps)){var t={selected:void 0};return j.jsx(eB.Provider,{value:t,children:e.children})}return j.jsx(JSe,{initialProps:e.initialProps,children:e.children})}function JSe(e){var t=e.initialProps,i=e.children,r=function(s,a,o){var l,u,c;if((l=t.onDayClick)===null||l===void 0||l.call(t,s,a,o),a.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,s,a,o);return}(c=t.onSelect)===null||c===void 0||c.call(t,s,s,a,o)},n={selected:t.selected,onDayClick:r};return j.jsx(eB.Provider,{value:n,children:i})}function aJ(){var e=de.useContext(eB);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function eTe(e,t){var i=_n(),r=aJ(),n=K4(),s=Z4(),a=J4(),o=a.focusDayAfter,l=a.focusDayBefore,u=a.focusWeekAfter,c=a.focusWeekBefore,h=a.blur,d=a.focus,f=a.focusMonthBefore,m=a.focusMonthAfter,g=a.focusYearBefore,y=a.focusYearAfter,x=a.focusStartOfWeek,w=a.focusEndOfWeek,b=function(G){var V,J,U,ie;xM(i)?(V=r.onDayClick)===null||V===void 0||V.call(r,e,t,G):X_(i)?(J=n.onDayClick)===null||J===void 0||J.call(n,e,t,G):K_(i)?(U=s.onDayClick)===null||U===void 0||U.call(s,e,t,G):(ie=i.onDayClick)===null||ie===void 0||ie.call(i,e,t,G)},C=function(G){var V;d(e),(V=i.onDayFocus)===null||V===void 0||V.call(i,e,t,G)},A=function(G){var V;h(),(V=i.onDayBlur)===null||V===void 0||V.call(i,e,t,G)},E=function(G){var V;(V=i.onDayMouseEnter)===null||V===void 0||V.call(i,e,t,G)},_=function(G){var V;(V=i.onDayMouseLeave)===null||V===void 0||V.call(i,e,t,G)},P=function(G){var V;(V=i.onDayPointerEnter)===null||V===void 0||V.call(i,e,t,G)},I=function(G){var V;(V=i.onDayPointerLeave)===null||V===void 0||V.call(i,e,t,G)},D=function(G){var V;(V=i.onDayTouchCancel)===null||V===void 0||V.call(i,e,t,G)},k=function(G){var V;(V=i.onDayTouchEnd)===null||V===void 0||V.call(i,e,t,G)},B=function(G){var V;(V=i.onDayTouchMove)===null||V===void 0||V.call(i,e,t,G)},z=function(G){var V;(V=i.onDayTouchStart)===null||V===void 0||V.call(i,e,t,G)},W=function(G){var V;(V=i.onDayKeyUp)===null||V===void 0||V.call(i,e,t,G)},$=function(G){var V;switch(G.key){case"ArrowLeft":G.preventDefault(),G.stopPropagation(),i.dir==="rtl"?o():l();break;case"ArrowRight":G.preventDefault(),G.stopPropagation(),i.dir==="rtl"?l():o();break;case"ArrowDown":G.preventDefault(),G.stopPropagation(),u();break;case"ArrowUp":G.preventDefault(),G.stopPropagation(),c();break;case"PageUp":G.preventDefault(),G.stopPropagation(),G.shiftKey?g():f();break;case"PageDown":G.preventDefault(),G.stopPropagation(),G.shiftKey?y():m();break;case"Home":G.preventDefault(),G.stopPropagation(),x();break;case"End":G.preventDefault(),G.stopPropagation(),w();break}(V=i.onDayKeyDown)===null||V===void 0||V.call(i,e,t,G)},Z={onClick:b,onFocus:C,onBlur:A,onKeyDown:$,onKeyUp:W,onMouseEnter:E,onMouseLeave:_,onPointerEnter:P,onPointerLeave:I,onTouchCancel:D,onTouchEnd:k,onTouchMove:B,onTouchStart:z};return Z}function tTe(){var e=_n(),t=aJ(),i=K4(),r=Z4(),n=xM(e)?t.selected:X_(e)?i.selected:K_(e)?r.selected:void 0;return n}function iTe(e){return Object.values(Ac).includes(e)}function rTe(e,t){var i=[e.classNames.day];return Object.keys(t).forEach(function(r){var n=e.modifiersClassNames[r];if(n)i.push(n);else if(iTe(r)){var s=e.classNames["day_".concat(r)];s&&i.push(s)}}),i}function nTe(e,t){var i=Bi({},e.styles.day);return Object.keys(t).forEach(function(r){var n;i=Bi(Bi({},i),(n=e.modifiersStyles)===null||n===void 0?void 0:n[r])}),i}function sTe(e,t,i){var r,n,s,a=_n(),o=J4(),l=ZSe(e,t),u=eTe(e,l),c=tTe(),h=!!(a.onDayClick||a.mode!=="default");de.useEffect(function(){var E;l.outside||o.focusedDay&&h&&Tl(o.focusedDay,e)&&((E=i.current)===null||E===void 0||E.focus())},[o.focusedDay,e,i,h,l.outside]);var d=rTe(a,l).join(" "),f=nTe(a,l),m=!!(l.outside&&!a.showOutsideDays||l.hidden),g=(s=(n=a.components)===null||n===void 0?void 0:n.DayContent)!==null&&s!==void 0?s:CSe,y=j.jsx(g,{date:e,displayMonth:t,activeModifiers:l}),x={style:f,className:d,children:y,role:"gridcell"},w=o.focusTarget&&Tl(o.focusTarget,e)&&!l.outside,b=o.focusedDay&&Tl(o.focusedDay,e),C=Bi(Bi(Bi({},x),(r={disabled:l.disabled,role:"gridcell"},r["aria-selected"]=l.selected,r.tabIndex=b||w?0:-1,r)),u),A={isButton:h,isHidden:m,activeModifiers:l,selectedDays:c,buttonProps:C,divProps:x};return A}function aTe(e){var t=de.useRef(null),i=sTe(e.date,e.displayMonth,t);return i.isHidden?j.jsx("div",{role:"gridcell"}):i.isButton?j.jsx(CC,Bi({name:"day",ref:t},i.buttonProps)):j.jsx("div",Bi({},i.divProps))}function oTe(e){var t=e.number,i=e.dates,r=_n(),n=r.onWeekNumberClick,s=r.styles,a=r.classNames,o=r.locale,l=r.labels.labelWeekNumber,u=r.formatters.formatWeekNumber,c=u(Number(t),{locale:o});if(!n)return j.jsx("span",{className:a.weeknumber,style:s.weeknumber,children:c});var h=l(Number(t),{locale:o}),d=function(f){n(t,i,f)};return j.jsx(CC,{name:"week-number","aria-label":h,className:a.weeknumber,style:s.weeknumber,onClick:d,children:c})}function lTe(e){var t,i,r=_n(),n=r.styles,s=r.classNames,a=r.showWeekNumber,o=r.components,l=(t=o==null?void 0:o.Day)!==null&&t!==void 0?t:aTe,u=(i=o==null?void 0:o.WeekNumber)!==null&&i!==void 0?i:oTe,c;return a&&(c=j.jsx("td",{className:s.cell,style:n.cell,children:j.jsx(u,{number:e.weekNumber,dates:e.dates})})),j.jsxs("tr",{className:s.row,style:n.row,children:[c,e.dates.map(function(h){return j.jsx("td",{className:s.cell,style:n.cell,role:"presentation",children:j.jsx(l,{displayMonth:e.displayMonth,date:h})},lEe(h))})]})}function cV(e,t,i){for(var r=i!=null&&i.ISOWeek?WQ(t):G4(t,i),n=i!=null&&i.ISOWeek?Wg(e):Lh(e,i),s=_h(r,n),a=[],o=0;o<=s;o++)a.push(zo(n,o));var l=a.reduce(function(u,c){var h=i!=null&&i.ISOWeek?YQ(c):KQ(c,i),d=u.find(function(f){return f.weekNumber===h});return d?(d.dates.push(c),u):(u.push({weekNumber:h,dates:[c]}),u)},[]);return l}function uTe(e,t){var i=cV(Il(e),W4(e),t);if(t!=null&&t.useFixedWeeks){var r=cEe(e,t);if(r<6){var n=i[i.length-1],s=n.dates[n.dates.length-1],a=C3(s,6-r),o=cV(C3(s,1),a,t);i.push.apply(i,o)}}return i}function cTe(e){var t,i,r,n=_n(),s=n.locale,a=n.classNames,o=n.styles,l=n.hideHead,u=n.fixedWeeks,c=n.components,h=n.weekStartsOn,d=n.firstWeekContainsDate,f=n.ISOWeek,m=uTe(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:f,locale:s,weekStartsOn:h,firstWeekContainsDate:d}),g=(t=c==null?void 0:c.Head)!==null&&t!==void 0?t:TSe,y=(i=c==null?void 0:c.Row)!==null&&i!==void 0?i:lTe,x=(r=c==null?void 0:c.Footer)!==null&&r!==void 0?r:wSe;return j.jsxs("table",{id:e.id,className:a.table,style:o.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!l&&j.jsx(g,{}),j.jsx("tbody",{className:a.tbody,style:o.tbody,children:m.map(function(w){return j.jsx(y,{displayMonth:e.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),j.jsx(x,{displayMonth:e.displayMonth})]})}function hTe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var dTe=hTe()?de.useLayoutEffect:de.useEffect,mD=!1,fTe=0;function hV(){return"react-day-picker-".concat(++fTe)}function pTe(e){var t,i=e??(mD?hV():null),r=de.useState(i),n=r[0],s=r[1];return dTe(function(){n===null&&s(hV())},[]),de.useEffect(function(){mD===!1&&(mD=!0)},[]),(t=e??n)!==null&&t!==void 0?t:void 0}function mTe(e){var t,i,r=_n(),n=r.dir,s=r.classNames,a=r.styles,o=r.components,l=$_().displayMonths,u=pTe(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),c=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,h=[s.month],d=a.month,f=e.displayIndex===0,m=e.displayIndex===l.length-1,g=!f&&!m;n==="rtl"&&(t=[f,m],m=t[0],f=t[1]),f&&(h.push(s.caption_start),d=Bi(Bi({},d),a.caption_start)),m&&(h.push(s.caption_end),d=Bi(Bi({},d),a.caption_end)),g&&(h.push(s.caption_between),d=Bi(Bi({},d),a.caption_between));var y=(i=o==null?void 0:o.Caption)!==null&&i!==void 0?i:_Se;return j.jsxs("div",{className:h.join(" "),style:d,children:[j.jsx(y,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),j.jsx(cTe,{id:c,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function gTe(e){var t=_n(),i=t.classNames,r=t.styles;return j.jsx("div",{className:i.months,style:r.months,children:e.children})}function vTe(e){var t,i,r=e.initialProps,n=_n(),s=J4(),a=$_(),o=de.useState(!1),l=o[0],u=o[1];de.useEffect(function(){n.initialFocus&&s.focusTarget&&(l||(s.focus(s.focusTarget),u(!0)))},[n.initialFocus,l,s.focus,s.focusTarget,s]);var c=[n.classNames.root,n.className];n.numberOfMonths>1&&c.push(n.classNames.multiple_months),n.showWeekNumber&&c.push(n.classNames.with_weeknumber);var h=Bi(Bi({},n.styles.root),n.style),d=Object.keys(r).filter(function(m){return m.startsWith("data-")}).reduce(function(m,g){var y;return Bi(Bi({},m),(y={},y[g]=r[g],y))},{}),f=(i=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&i!==void 0?i:gTe;return j.jsx("div",Bi({className:c.join(" "),style:h,dir:n.dir,id:n.id,nonce:r.nonce,title:r.title,lang:r.lang},d,{children:j.jsx(f,{children:a.displayMonths.map(function(m,g){return j.jsx(mTe,{displayIndex:g,displayMonth:m},g)})})}))}function yTe(e){var t=e.children,i=VEe(e,["children"]);return j.jsx(oSe,{initialProps:i,children:j.jsx(vSe,{children:j.jsx(QSe,{initialProps:i,children:j.jsx(ASe,{initialProps:i,children:j.jsx(DSe,{initialProps:i,children:j.jsx(zSe,{children:j.jsx($Se,{children:t})})})})})})})}function xTe(e){return j.jsx(yTe,Bi({},e,{children:j.jsx(vTe,{initialProps:e})}))}function oJ({className:e,classNames:t,showOutsideDays:i=!0,...r}){return j.jsx(xTe,{showOutsideDays:i,className:an("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:an(y3({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:an(y3({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...n})=>j.jsx(Bxe,{className:"h-4 w-4"}),IconRight:({...n})=>j.jsx(zxe,{className:"h-4 w-4"})},...r})}oJ.displayName="Calendar";const bTe=[{time:"09:00",available:!0},{time:"10:00",available:!0},{time:"11:00",available:!0},{time:"14:00",available:!0},{time:"15:00",available:!0},{time:"16:00",available:!0}];function _Te(){const[e,t]=de.useState(),[i,r]=de.useState(),[n,s]=de.useState(""),[a,o]=de.useState(""),[l,u]=de.useState(""),[c,h]=de.useState(!1),[d,f]=de.useState("idle"),[m,g]=de.useState(""),y=de.useCallback(w=>{const b=new Date;b.setHours(0,0,0,0);const C=w.getDay();return q4(w,b)||C===0||C===6},[]),x=async w=>{if(w.preventDefault(),!e||!i||!n||!a)return;h(!0),f("idle"),g("");const b={date:rm(e,"dd/MM/yyyy"),time:i,name:n,email:a,message:l};try{const C=await fetch("http://localhost:3001/api/appointments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!C.ok){const A=await C.json();throw new Error(A.error||`HTTP error! status: ${C.status}`)}f("success"),t(void 0),r(void 0),s(""),o(""),u("")}catch(C){console.error("Erreur lors de la prise de rendez-vous:",C),f("error"),g(C.message||"Une erreur est survenue.")}finally{h(!1)}};return j.jsxs(av,{className:"w-full max-w-2xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white",children:[j.jsx("h1",{className:"text-center mt-10 text-2xl font-bold",children:"Prendre un rendez-vous"}),j.jsxs(H_,{children:[j.jsx(W_,{children:"Prendre un rendez-vous"}),j.jsx(hM,{children:"Choisissez une date et un créneau horaire pour planifier notre rencontre."})]}),j.jsx(ov,{children:j.jsxs("form",{onSubmit:x,className:"space-y-6",children:[j.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[j.jsx("div",{className:"flex-1",children:j.jsx(oJ,{mode:"single",selected:e,onSelect:t,disabled:y,locale:jEe,className:"rounded-md border"})}),j.jsxs("div",{className:"flex-1 space-y-4",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsx(V0,{children:"Créneaux disponibles"}),j.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.jsx(Jb,{children:bTe.map(w=>j.jsx(Ui.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:j.jsx(Zn,{type:"button",variant:i===w.time?"default":"outline",className:an("w-full",!w.available&&"opacity-50 cursor-not-allowed"),onClick:()=>w.available&&r(w.time),disabled:!w.available,children:w.time})},w.time))})})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx(V0,{htmlFor:"name",children:"Nom complet"}),j.jsx(ry,{id:"name",value:n,onChange:w=>s(w.target.value),placeholder:"Votre nom",required:!0})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx(V0,{htmlFor:"email",children:"Email"}),j.jsx(ry,{id:"email",type:"email",value:a,onChange:w=>o(w.target.value),placeholder:"votre@email.com",required:!0})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx(V0,{htmlFor:"message",children:"Message (optionnel)"}),j.jsx("textarea",{id:"message",value:l,onChange:w=>u(w.target.value),placeholder:"Détails supplémentaires...",className:"w-full min-h-[100px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]})]}),j.jsx("div",{className:"flex justify-end",children:j.jsx(Zn,{type:"submit",disabled:!e||!i||!n||!a||c,className:"w-full md:w-auto",children:c?"Envoi en cours...":"Confirmer le rendez-vous"})}),j.jsxs(Jb,{children:[d==="success"&&j.jsx(Ui.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-green-600 dark:text-green-400 text-center",children:"Rendez-vous confirmé avec succès !"}),d==="error"&&j.jsxs(Ui.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-red-600 dark:text-red-400 text-center",children:["Erreur : ",m]})]})]})}),j.jsx(dM,{className:"text-sm text-muted-foreground",children:"Les rendez-vous sont disponibles du lundi au vendredi, de 9h à 17h."})]})}var wTe=Object.create,bM=Object.defineProperty,ETe=Object.getOwnPropertyDescriptor,STe=Object.getOwnPropertyNames,TTe=Object.getPrototypeOf,CTe=Object.prototype.hasOwnProperty,ATe=(e,t,i)=>t in e?bM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lv=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),MTe=(e,t)=>{for(var i in t)bM(e,i,{get:t[i],enumerable:!0})},PTe=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of STe(t))!CTe.call(e,n)&&n!==i&&bM(e,n,{get:()=>t[n],enumerable:!(r=ETe(t,n))||r.enumerable});return e},nm=(e,t,i)=>(i=e!=null?wTe(TTe(e)):{},PTe(t||!e||!e.__esModule?bM(i,"default",{value:e,enumerable:!0}):i,e)),jx=(e,t,i)=>(ATe(e,typeof t!="symbol"?t+"":t,i),i),DTe=lv((e,t)=>{(function(i,r){typeof e=="object"?t.exports=r():typeof define=="function"&&define.amd?define(r):i.Alea=r()})(e,function(){return i.importState=function(n){var s=new i;return s.importState(n),s},i;function i(){return function(n){var s=0,a=0,o=0,l=1;n.length==0&&(n=[+new Date]);var u=r();s=u(" "),a=u(" "),o=u(" ");for(var c=0;c<n.length;c++)s-=u(n[c]),s<0&&(s+=1),a-=u(n[c]),a<0&&(a+=1),o-=u(n[c]),o<0&&(o+=1);u=null;var h=function(){var d=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=d-(l=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=n,h.exportState=function(){return[s,a,o,l]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,l=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function r(){var n=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){n+=a.charCodeAt(o);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),lJ=lv((e,t)=>{(function(i,r){typeof e=="object"&&typeof t<"u"?r(e):typeof define=="function"&&define.amd?define(["exports"],r):r((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(e,function(i){i.SVD=function(r,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!r)throw new TypeError("Matrix a is not defined");var l,u,c,h,d,f,m,g,y,x,w,b,C=r[0].length,A=r.length;if(A<C)throw new TypeError("Invalid matrix: m < n");for(var E=[],_=[],P=[],I=n==="f"?A:C,D=x=m=0;D<A;D++)_[D]=new Array(I).fill(0);for(D=0;D<C;D++)P[D]=new Array(C).fill(0);var k,B=new Array(C).fill(0);for(D=0;D<A;D++)for(l=0;l<C;l++)_[D][l]=r[D][l];for(D=0;D<C;D++){for(E[D]=m,y=0,c=D+1,l=D;l<A;l++)y+=Math.pow(_[l][D],2);if(y<o)m=0;else for(g=(f=_[D][D])*(m=f<0?Math.sqrt(y):-Math.sqrt(y))-y,_[D][D]=f-m,l=c;l<C;l++){for(y=0,u=D;u<A;u++)y+=_[u][D]*_[u][l];for(f=y/g,u=D;u<A;u++)_[u][l]=_[u][l]+f*_[u][D]}for(B[D]=m,y=0,l=c;l<C;l++)y+=Math.pow(_[D][l],2);if(y<o)m=0;else{for(g=(f=_[D][D+1])*(m=f<0?Math.sqrt(y):-Math.sqrt(y))-y,_[D][D+1]=f-m,l=c;l<C;l++)E[l]=_[D][l]/g;for(l=c;l<A;l++){for(y=0,u=c;u<C;u++)y+=_[l][u]*_[D][u];for(u=c;u<C;u++)_[l][u]=_[l][u]+y*E[u]}}x<(w=Math.abs(B[D])+Math.abs(E[D]))&&(x=w)}if(s)for(D=C-1;0<=D;D--){if(m!==0){for(g=_[D][D+1]*m,l=c;l<C;l++)P[l][D]=_[D][l]/g;for(l=c;l<C;l++){for(y=0,u=c;u<C;u++)y+=_[D][u]*P[u][l];for(u=c;u<C;u++)P[u][l]=P[u][l]+y*P[u][D]}}for(l=c;l<C;l++)P[D][l]=0,P[l][D]=0;P[D][D]=1,m=E[D],c=D}if(n){if(n==="f")for(D=C;D<A;D++){for(l=C;l<A;l++)_[D][l]=0;_[D][D]=1}for(D=C-1;0<=D;D--){for(c=D+1,m=B[D],l=c;l<I;l++)_[D][l]=0;if(m!==0){for(g=_[D][D]*m,l=c;l<I;l++){for(y=0,u=c;u<A;u++)y+=_[u][D]*_[u][l];for(f=y/g,u=D;u<A;u++)_[u][l]=_[u][l]+f*_[u][D]}for(l=D;l<A;l++)_[l][D]=_[l][D]/m}else for(l=D;l<A;l++)_[l][D]=0;_[D][D]=_[D][D]+1}}for(a*=x,u=C-1;0<=u;u--)for(var z=0;z<50;z++){for(k=!1,c=u;0<=c;c--){if(Math.abs(E[c])<=a){k=!0;break}if(Math.abs(B[c-1])<=a)break}if(!k){for(d=0,h=c-(y=1),D=c;D<u+1&&(f=y*E[D],E[D]=d*E[D],!(Math.abs(f)<=a));D++)if(m=B[D],B[D]=Math.sqrt(f*f+m*m),d=m/(g=B[D]),y=-f/g,n)for(l=0;l<A;l++)w=_[l][h],b=_[l][D],_[l][h]=w*d+b*y,_[l][D]=-w*y+b*d}if(b=B[u],c===u){if(b<0&&(B[u]=-b,s))for(l=0;l<C;l++)P[l][u]=-P[l][u];break}for(x=B[c],f=(((w=B[u-1])-b)*(w+b)+((m=E[u-1])-(g=E[u]))*(m+g))/(2*g*w),m=Math.sqrt(f*f+1),f=((x-b)*(x+b)+g*(w/(f<0?f-m:f+m)-g))/x,D=c+(y=d=1);D<u+1;D++){if(m=E[D],w=B[D],g=y*m,m*=d,b=Math.sqrt(f*f+g*g),f=x*(d=f/(E[D-1]=b))+m*(y=g/b),m=-x*y+m*d,g=w*y,w*=d,s)for(l=0;l<C;l++)x=P[l][D-1],b=P[l][D],P[l][D-1]=x*d+b*y,P[l][D]=-x*y+b*d;if(b=Math.sqrt(f*f+g*g),f=(d=f/(B[D-1]=b))*m+(y=g/b)*w,x=-y*m+d*w,n)for(l=0;l<A;l++)w=_[l][D-1],b=_[l][D],_[l][D-1]=w*d+b*y,_[l][D]=-w*y+b*d}E[c]=0,E[u]=f,B[u]=x}for(D=0;D<C;D++)B[D]<a&&(B[D]=0);return{u:_,q:B,v:P}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),ITe=lv((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;function i(r){if(r===null||r===!0||r===!1)return NaN;var n=Number(r);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}t.exports=e.default}),OTe=lv((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;function i(r){var n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return n.setUTCFullYear(r.getFullYear()),r.getTime()-n.getTime()}t.exports=e.default}),RTe=lv((e,t)=>{function i(s,a){function o(){this.constructor=s}o.prototype=a.prototype,s.prototype=new o}function r(s,a,o,l){this.message=s,this.expected=a,this.found=o,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,r)}i(r,Error),r.buildMessage=function(s,a){var o={literal:function(m){return'"'+u(m.text)+'"'},class:function(m){var g="",y;for(y=0;y<m.parts.length;y++)g+=m.parts[y]instanceof Array?c(m.parts[y][0])+"-"+c(m.parts[y][1]):c(m.parts[y]);return"["+(m.inverted?"^":"")+g+"]"},any:function(m){return"any character"},end:function(m){return"end of input"},other:function(m){return m.description}};function l(m){return m.charCodeAt(0).toString(16).toUpperCase()}function u(m){return m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+l(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+l(g)})}function c(m){return m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+l(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+l(g)})}function h(m){return o[m.type](m)}function d(m){var g=new Array(m.length),y,x;for(y=0;y<m.length;y++)g[y]=h(m[y]);if(g.sort(),g.length>0){for(y=1,x=1;y<g.length;y++)g[y-1]!==g[y]&&(g[x]=g[y],x++);g.length=x}switch(g.length){case 1:return g[0];case 2:return g[0]+" or "+g[1];default:return g.slice(0,-1).join(", ")+", or "+g[g.length-1]}}function f(m){return m?'"'+u(m)+'"':"end of input"}return"Expected "+d(s)+" but "+f(a)+" found."};function n(s,a){a=a!==void 0?a:{};var o={},l={svg_path:Wt},u=Wt,c=function(le){if(!le)return[];for(var pe=[],Ce=0;Ce<le.length;Ce++)pe=pe.concat.apply(pe,le[Ce]);var ye=pe[0];return ye&&ye.code=="m"&&(delete ye.relative,ye.code="M"),pe},h=function(le,pe){return Ya(le,pe)},d=/^[Mm]/,f=Ot(["M","m"],!1,!1),m=function(le,pe,Ce){var ye=Aa(le,[pe]);return Ce&&(ye=ye.concat(Aa(le=="M"?"L":"l",Ce[1]))),ye},g=/^[Zz]/,y=Ot(["Z","z"],!1,!1),x=function(){return Aa("Z")},w=/^[Ll]/,b=Ot(["L","l"],!1,!1),C=function(le,pe){return Aa(le,pe)},A=/^[Hh]/,E=Ot(["H","h"],!1,!1),_=function(le,pe){return Aa(le,pe.map(function(Ce){return{x:Ce}}))},P=/^[Vv]/,I=Ot(["V","v"],!1,!1),D=function(le,pe){return Aa(le,pe.map(function(Ce){return{y:Ce}}))},k=/^[Cc]/,B=Ot(["C","c"],!1,!1),z=function(le,pe,Ce){return{x1:le.x,y1:le.y,x2:pe.x,y2:pe.y,x:Ce.x,y:Ce.y}},W=/^[Ss]/,$=Ot(["S","s"],!1,!1),Z=function(le,pe){return{x2:le.x,y2:le.y,x:pe.x,y:pe.y}},G=/^[Qq]/,V=Ot(["Q","q"],!1,!1),J=function(le,pe){return{x1:le.x,y1:le.y,x:pe.x,y:pe.y}},U=/^[Tt]/,ie=Ot(["T","t"],!1,!1),se=/^[Aa]/,ee=Ot(["A","a"],!1,!1),ve=function(le,pe,Ce,ye,We,Ct){return{rx:le,ry:pe,xAxisRotation:Ce,largeArc:ye,sweep:We,x:Ct.x,y:Ct.y}},_e=function(le,pe){return{x:le,y:pe}},he=function(le){return le*1},De=function(le){return le.join("")*1},we=/^[01]/,Le=Ot(["0","1"],!1,!1),Te=function(le){return le=="1"},ke=function(){return""},Xe=",",et=It(",",!1),Ze=function(le){return le.join("")},st=".",_t=It(".",!1),St=/^[eE]/,ue=Ot(["e","E"],!1,!1),Ee=/^[+\-]/,Ae=Ot(["+","-"],!1,!1),Ge=/^[0-9]/,ae=Ot([["0","9"]],!1,!1),te=function(le){return le.join("")},Ne=/^[ \t\n\r]/,Re=Ot([" ","	",`
`,"\r"],!1,!1),Y=0,Me=[{line:1,column:1}],Ke=0,ot=[],qe;if("startRule"in a){if(!(a.startRule in l))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');u=l[a.startRule]}function It(le,pe){return{type:"literal",text:le,ignoreCase:pe}}function Ot(le,pe,Ce){return{type:"class",parts:le,inverted:pe,ignoreCase:Ce}}function Dt(){return{type:"end"}}function kt(le){var pe=Me[le],Ce;if(pe)return pe;for(Ce=le-1;!Me[Ce];)Ce--;for(pe=Me[Ce],pe={line:pe.line,column:pe.column};Ce<le;)s.charCodeAt(Ce)===10?(pe.line++,pe.column=1):pe.column++,Ce++;return Me[le]=pe,pe}function Qe(le,pe){var Ce=kt(le),ye=kt(pe);return{start:{offset:le,line:Ce.line,column:Ce.column},end:{offset:pe,line:ye.line,column:ye.column}}}function mt(le){Y<Ke||(Y>Ke&&(Ke=Y,ot=[]),ot.push(le))}function Ht(le,pe,Ce){return new r(r.buildMessage(le,pe),le,pe,Ce)}function Wt(){var le,pe,Ce,ye,We;for(le=Y,pe=[],Ce=Fi();Ce!==o;)pe.push(Ce),Ce=Fi();if(pe!==o)if(Ce=Ue(),Ce===o&&(Ce=null),Ce!==o){for(ye=[],We=Fi();We!==o;)ye.push(We),We=Fi();ye!==o?(pe=c(Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;else Y=le,le=o;return le}function Ue(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=dt(),pe!==o){for(Ce=[],ye=Y,We=[],Ct=Fi();Ct!==o;)We.push(Ct),Ct=Fi();for(We!==o?(Ct=dt(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;){for(Ce.push(ye),ye=Y,We=[],Ct=Fi();Ct!==o;)We.push(Ct),Ct=Fi();We!==o?(Ct=dt(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o)}Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function dt(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=Bt(),pe!==o){for(Ce=[],ye=Y,We=[],Ct=Fi();Ct!==o;)We.push(Ct),Ct=Fi();for(We!==o?(Ct=gt(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;){for(Ce.push(ye),ye=Y,We=[],Ct=Fi();Ct!==o;)We.push(Ct),Ct=Fi();We!==o?(Ct=gt(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o)}Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function gt(){var le;return le=ei(),le===o&&(le=zi(),le===o&&(le=Yi(),le===o&&(le=yr(),le===o&&(le=Rn(),le===o&&(le=Jo(),le===o&&(le=me(),le===o&&(le=tt(),le===o&&(le=Qt())))))))),le}function Bt(){var le,pe,Ce,ye,We,Ct,En;if(le=Y,d.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(f)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=ri(),ye!==o?(We=Y,Ct=bi(),Ct===o&&(Ct=null),Ct!==o?(En=vi(),En!==o?(Ct=[Ct,En],We=Ct):(Y=We,We=o)):(Y=We,We=o),We===o&&(We=null),We!==o?(pe=m(pe,ye,We),le=pe):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function ei(){var le,pe;return le=Y,g.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(y)),pe!==o&&(pe=x()),le=pe,le}function zi(){var le,pe,Ce,ye;if(le=Y,w.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(b)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=vi(),ye!==o?(pe=C(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function vi(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=ri(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=ri(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=ri(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function Yi(){var le,pe,Ce,ye;if(le=Y,A.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(E)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=wn(),ye!==o?(pe=_(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function wn(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=Li(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=Li(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=Li(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function yr(){var le,pe,Ce,ye;if(le=Y,P.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(I)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=wn(),ye!==o?(pe=D(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function Rn(){var le,pe,Ce,ye;if(le=Y,k.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(B)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=Yr(),ye!==o?(pe=C(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function Yr(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=Hn(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=Hn(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=Hn(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function Hn(){var le,pe,Ce,ye,We,Ct;return le=Y,pe=ri(),pe!==o?(Ce=bi(),Ce===o&&(Ce=null),Ce!==o?(ye=ri(),ye!==o?(We=bi(),We===o&&(We=null),We!==o?(Ct=ri(),Ct!==o?(pe=z(pe,ye,Ct),le=pe):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o),le}function Jo(){var le,pe,Ce,ye;if(le=Y,W.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt($)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=Bl(),ye!==o?(pe=C(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function Bl(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=Ln(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=Ln(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=Ln(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function Ln(){var le,pe,Ce,ye;return le=Y,pe=ri(),pe!==o?(Ce=bi(),Ce===o&&(Ce=null),Ce!==o?(ye=ri(),ye!==o?(pe=Z(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o),le}function me(){var le,pe,Ce,ye;if(le=Y,G.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(V)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=lt(),ye!==o?(pe=C(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function lt(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=pt(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=pt(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=pt(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function pt(){var le,pe,Ce,ye;return le=Y,pe=ri(),pe!==o?(Ce=bi(),Ce===o&&(Ce=null),Ce!==o?(ye=ri(),ye!==o?(pe=J(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o),le}function tt(){var le,pe,Ce,ye;if(le=Y,U.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(ie)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=xt(),ye!==o?(pe=C(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function xt(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=ri(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=ri(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=ri(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function Qt(){var le,pe,Ce,ye;if(le=Y,se.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(ee)),pe!==o){for(Ce=[],ye=Fi();ye!==o;)Ce.push(ye),ye=Fi();Ce!==o?(ye=hi(),ye!==o?(pe=C(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)}else Y=le,le=o;return le}function hi(){var le,pe,Ce,ye,We,Ct;if(le=Y,pe=ui(),pe!==o){for(Ce=[],ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=ui(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);ye!==o;)Ce.push(ye),ye=Y,We=bi(),We===o&&(We=null),We!==o?(Ct=ui(),Ct!==o?(We=[We,Ct],ye=We):(Y=ye,ye=o)):(Y=ye,ye=o);Ce!==o?(pe=h(pe,Ce),le=pe):(Y=le,le=o)}else Y=le,le=o;return le}function ui(){var le,pe,Ce,ye,We,Ct,En,Wu,Di,Dr,el,_o;return le=Y,pe=dr(),pe!==o?(Ce=bi(),Ce===o&&(Ce=null),Ce!==o?(ye=dr(),ye!==o?(We=bi(),We===o&&(We=null),We!==o?(Ct=Li(),Ct!==o?(En=bi(),En!==o?(Wu=Ni(),Wu!==o?(Di=bi(),Di===o&&(Di=null),Di!==o?(Dr=Ni(),Dr!==o?(el=bi(),el===o&&(el=null),el!==o?(_o=ri(),_o!==o?(pe=ve(pe,ye,Ct,Wu,Dr,_o),le=pe):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o),le}function ri(){var le,pe,Ce,ye;return le=Y,pe=Li(),pe!==o?(Ce=bi(),Ce===o&&(Ce=null),Ce!==o?(ye=Li(),ye!==o?(pe=_e(pe,ye),le=pe):(Y=le,le=o)):(Y=le,le=o)):(Y=le,le=o),le}function dr(){var le,pe;return le=Y,pe=is(),pe===o&&(pe=ia()),pe!==o&&(pe=he(pe)),le=pe,le}function Li(){var le,pe,Ce,ye;return le=Y,pe=Y,Ce=Xi(),Ce===o&&(Ce=null),Ce!==o?(ye=is(),ye!==o?(Ce=[Ce,ye],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o),pe===o&&(pe=Y,Ce=Xi(),Ce===o&&(Ce=null),Ce!==o?(ye=ia(),ye!==o?(Ce=[Ce,ye],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o)),pe!==o&&(pe=De(pe)),le=pe,le}function Ni(){var le,pe;return le=Y,we.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(Le)),pe!==o&&(pe=Te(pe)),le=pe,le}function bi(){var le,pe,Ce,ye,We;if(le=Y,pe=[],Ce=Fi(),Ce!==o)for(;Ce!==o;)pe.push(Ce),Ce=Fi();else pe=o;if(pe!==o)if(Ce=on(),Ce===o&&(Ce=null),Ce!==o){for(ye=[],We=Fi();We!==o;)ye.push(We),We=Fi();ye!==o?(pe=[pe,Ce,ye],le=pe):(Y=le,le=o)}else Y=le,le=o;else Y=le,le=o;if(le===o){if(le=Y,pe=Y,Ce=on(),Ce!==o){for(ye=[],We=Fi();We!==o;)ye.push(We),We=Fi();ye!==o?(Ce=[Ce,ye],pe=Ce):(Y=pe,pe=o)}else Y=pe,pe=o;pe!==o&&(pe=ke()),le=pe}return le}function on(){var le;return s.charCodeAt(Y)===44?(le=Xe,Y++):(le=o,mt(et)),le}function is(){var le,pe,Ce,ye;return le=Y,pe=Y,Ce=Wn(),Ce!==o?(ye=Lr(),ye===o&&(ye=null),ye!==o?(Ce=[Ce,ye],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o),pe===o&&(pe=Y,Ce=ia(),Ce!==o?(ye=Lr(),ye!==o?(Ce=[Ce,ye],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o)),pe!==o&&(pe=Ze(pe)),le=pe,le}function Wn(){var le,pe,Ce,ye,We;return le=Y,pe=Y,Ce=ia(),Ce===o&&(Ce=null),Ce!==o?(s.charCodeAt(Y)===46?(ye=st,Y++):(ye=o,mt(_t)),ye!==o?(We=ia(),We!==o?(Ce=[Ce,ye,We],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o)):(Y=pe,pe=o),pe===o&&(pe=Y,Ce=ia(),Ce!==o?(s.charCodeAt(Y)===46?(ye=st,Y++):(ye=o,mt(_t)),ye!==o?(Ce=[Ce,ye],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o)),pe!==o&&(pe=Ze(pe)),le=pe,le}function Lr(){var le,pe,Ce,ye,We;return le=Y,pe=Y,St.test(s.charAt(Y))?(Ce=s.charAt(Y),Y++):(Ce=o,mt(ue)),Ce!==o?(ye=Xi(),ye===o&&(ye=null),ye!==o?(We=ia(),We!==o?(Ce=[Ce,ye,We],pe=Ce):(Y=pe,pe=o)):(Y=pe,pe=o)):(Y=pe,pe=o),pe!==o&&(pe=Ze(pe)),le=pe,le}function Xi(){var le;return Ee.test(s.charAt(Y))?(le=s.charAt(Y),Y++):(le=o,mt(Ae)),le}function ia(){var le,pe,Ce;if(le=Y,pe=[],Ge.test(s.charAt(Y))?(Ce=s.charAt(Y),Y++):(Ce=o,mt(ae)),Ce!==o)for(;Ce!==o;)pe.push(Ce),Ge.test(s.charAt(Y))?(Ce=s.charAt(Y),Y++):(Ce=o,mt(ae));else pe=o;return pe!==o&&(pe=te(pe)),le=pe,le}function Fi(){var le,pe;return le=Y,Ne.test(s.charAt(Y))?(pe=s.charAt(Y),Y++):(pe=o,mt(Re)),pe!==o&&(pe=ke()),le=pe,le}function Ya(le,pe){if(!pe)return[le];for(var Ce=[le],ye=0,We=pe.length;ye<We;ye++)Ce[ye+1]=pe[ye][1];return Ce}var ra={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var ks in ra)ra[ks.toUpperCase()]=ra[ks];function Aa(le,pe){pe||(pe=[{}]);for(var Ce=pe.length;Ce--;){var ye={code:le,command:ra[le]};le==le.toLowerCase()&&(ye.relative=!0);for(var We in pe[Ce])ye[We]=pe[Ce][We];pe[Ce]=ye}return pe}if(qe=u(),qe!==o&&Y===s.length)return qe;throw qe!==o&&Y<s.length&&mt(Dt()),Ht(ot,Ke<s.length?s.charAt(Ke):null,Ke<s.length?Qe(Ke,Ke+1):Qe(Ke,Ke))}t.exports={SyntaxError:r,parse:n}}),uJ=lv((e,t)=>{var i=RTe().parse;i.parseSVG=i,i.makeAbsolute=r,t.exports=i;function r(n){var s,a={x:0,y:0},o={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(s=l),l.x0=a.x,l.y0=a.y;for(var u in o)u in l&&(l[u]+=l.relative?l[o[u]]:0);"x"in l||(l.x=a.x),"y"in l||(l.y=a.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=s.x,l.y=s.y),a=l}),n}}),LTe=lv((e,t)=>{t.exports=function(i,r){for(var n=i.split("."),s=r.split("."),a=0;a<3;a++){var o=Number(n[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),r1="149",vu={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},NTe=0,dV=1,kTe=2,tB=1,BTe=2,Vx=3,Mc=0,wa=1,po=2,Rs=0,Dg=1,fV=2,pV=3,mV=4,zTe=5,m0=100,FTe=101,UTe=102,gV=103,vV=104,jTe=200,VTe=201,HTe=202,WTe=203,cJ=204,hJ=205,GTe=206,qTe=207,YTe=208,XTe=209,KTe=210,$Te=0,ZTe=1,QTe=2,M3=3,JTe=4,eCe=5,tCe=6,iCe=7,dJ=0,rCe=1,nCe=2,Ph=0,sCe=1,aCe=2,oCe=3,lCe=4,uCe=5,fJ=300,Gg=301,qg=302,P3=303,D3=304,Z_=306,Gd=1e3,Mn=1001,I3=1002,ur=1003,yV=1004,gD=1005,Ji=1006,cCe=1007,Dy=1008,yo=1009,hCe=1010,dCe=1011,pJ=1012,fCe=1013,qd=1014,$r=1015,lf=1016,pCe=1017,mCe=1018,Ig=1020,gCe=1021,On=1023,vCe=1024,yCe=1025,Og=1026,Yg=1027,xT=1028,xCe=1029,AC=1030,bCe=1031,mJ=1033,vD=33776,yD=33777,xD=33778,bD=33779,xV=35840,bV=35841,_V=35842,wV=35843,_Ce=36196,EV=37492,SV=37496,TV=37808,CV=37809,AV=37810,MV=37811,PV=37812,DV=37813,IV=37814,OV=37815,RV=37816,LV=37817,NV=37818,kV=37819,BV=37820,zV=37821,_D=36492,wCe=36283,FV=36284,UV=36285,jV=36286,gJ=2200,vJ=2201,iB=2202,MC=2300,PC=2301,wD=2302,H0=2400,W0=2401,DC=2402,rB=2500,ECe=2501,Pc=3e3,$i=3001,mf=3200,yJ=3201,SCe=0,TCe=1,lh="srgb",IC="srgb-linear",ED=7680,CCe=519,O3=35044,ACe=35048,R3="300 es",L3=1035,qa=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let i=t.slice(0);for(let r=0,n=i.length;r<n;r++)i[r].call(this,e);e.target=null}}},io=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],VV=1234567,mb=Math.PI/180,s_=180/Math.PI;function Bu(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(io[e&255]+io[e>>8&255]+io[e>>16&255]+io[e>>24&255]+"-"+io[t&255]+io[t>>8&255]+"-"+io[t>>16&15|64]+io[t>>24&255]+"-"+io[i&63|128]+io[i>>8&255]+"-"+io[i>>16&255]+io[i>>24&255]+io[r&255]+io[r>>8&255]+io[r>>16&255]+io[r>>24&255]).toLowerCase()}function Ms(e,t,i){return Math.max(t,Math.min(i,e))}function nB(e,t){return(e%t+t)%t}function MCe(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)}function PCe(e,t,i){return e!==t?(i-e)/(t-e):0}function gb(e,t,i){return(1-i)*e+i*t}function DCe(e,t,i,r){return gb(e,t,1-Math.exp(-i*r))}function ICe(e,t=1){return t-Math.abs(nB(e,t*2)-t)}function OCe(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))}function RCe(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))}function LCe(e,t){return e+Math.floor(Math.random()*(t-e+1))}function NCe(e,t){return e+Math.random()*(t-e)}function kCe(e){return e*(.5-Math.random())}function BCe(e){e!==void 0&&(VV=e);let t=VV+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function zCe(e){return e*mb}function FCe(e){return e*s_}function N3(e){return(e&e-1)===0&&e!==0}function xJ(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function OC(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function UCe(e,t,i,r,n){let s=Math.cos,a=Math.sin,o=s(i/2),l=a(i/2),u=s((t+r)/2),c=a((t+r)/2),h=s((t-r)/2),d=a((t-r)/2),f=s((r-t)/2),m=a((r-t)/2);switch(n){case"XYX":e.set(o*c,l*h,l*d,o*u);break;case"YZY":e.set(l*d,o*c,l*h,o*u);break;case"ZXZ":e.set(l*h,l*d,o*c,o*u);break;case"XZX":e.set(o*c,l*m,l*f,o*u);break;case"YXY":e.set(l*f,o*c,l*m,o*u);break;case"ZYZ":e.set(l*m,l*f,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Yd(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function hn(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var Xt=Object.freeze({__proto__:null,DEG2RAD:mb,RAD2DEG:s_,ceilPowerOfTwo:xJ,clamp:Ms,damp:DCe,degToRad:zCe,denormalize:Yd,euclideanModulo:nB,floorPowerOfTwo:OC,generateUUID:Bu,inverseLerp:PCe,isPowerOfTwo:N3,lerp:gb,mapLinear:MCe,normalize:hn,pingpong:ICe,radToDeg:FCe,randFloat:NCe,randFloatSpread:kCe,randInt:LCe,seededRandom:BCe,setQuaternionFromProperEuler:UCe,smootherstep:RCe,smoothstep:OCe}),Ie=class{constructor(e=0,t=0){Ie.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),r=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*i-s*r+e.x,this.y=n*r+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Is=class{constructor(){Is.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,n,s,a,o,l){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=n,u[5]=o,u[6]=i,u[7]=s,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,n=this.elements,s=i[0],a=i[3],o=i[6],l=i[1],u=i[4],c=i[7],h=i[2],d=i[5],f=i[8],m=r[0],g=r[3],y=r[6],x=r[1],w=r[4],b=r[7],C=r[2],A=r[5],E=r[8];return n[0]=s*m+a*x+o*C,n[3]=s*g+a*w+o*A,n[6]=s*y+a*b+o*E,n[1]=l*m+u*x+c*C,n[4]=l*g+u*w+c*A,n[7]=l*y+u*b+c*E,n[2]=h*m+d*x+f*C,n[5]=h*g+d*w+f*A,n[8]=h*y+d*b+f*E,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],u=e[8];return t*s*u-t*a*l-i*n*u+i*a*o+r*n*l-r*s*o}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=u*s-a*l,h=a*o-u*n,d=l*n-s*o,f=t*c+i*h+r*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let m=1/f;return e[0]=c*m,e[1]=(r*l-u*i)*m,e[2]=(a*i-r*s)*m,e[3]=h*m,e[4]=(u*t-r*o)*m,e[5]=(r*n-a*t)*m,e[6]=d*m,e[7]=(i*o-l*t)*m,e[8]=(s*t-i*n)*m,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(i*o,i*l,-i*(o*s+l*a)+s+e,-r*l,r*o,-r*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(SD.makeScale(e,t)),this}rotate(e){return this.premultiply(SD.makeRotation(-e)),this}translate(e,t){return this.premultiply(SD.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},SD=new Is;function bJ(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var jCe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function yE(e,t){return new jCe[e](t)}function a_(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function VCe(e,t,i){return new Promise(function(r,n){function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:n();break;case e.TIMEOUT_EXPIRED:setTimeout(s,i);break;default:r()}}setTimeout(s,i)})}function Rg(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function bT(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var TD={[lh]:{[IC]:Rg},[IC]:{[lh]:bT}},Do={legacyMode:!0,get workingColorSpace(){return IC},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(this.legacyMode||t===i||!t||!i)return e;if(TD[t]&&TD[t][i]!==void 0){let r=TD[t][i];return e.r=r(e.r),e.g=r(e.g),e.b=r(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},_J={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Us={r:0,g:0,b:0},Ju={h:0,s:0,l:0},xE={h:0,s:0,l:0};function CD(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}function bE(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var mi=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=lh){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Do.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Do.workingColorSpace){return this.r=e,this.g=t,this.b=i,Do.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Do.workingColorSpace){if(e=nB(e,1),t=Ms(t,0,1),i=Ms(i,0,1),t===0)this.r=this.g=this.b=i;else{let n=i<=.5?i*(1+t):i+t-i*t,s=2*i-n;this.r=CD(s,n,e+1/3),this.g=CD(s,n,e),this.b=CD(s,n,e-1/3)}return Do.toWorkingColorSpace(this,r),this}setStyle(e,t=lh){function i(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,Do.toWorkingColorSpace(this,t),i(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,Do.toWorkingColorSpace(this,t),i(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let o=parseFloat(n[1])/360,l=parseFloat(n[2])/100,u=parseFloat(n[3])/100;return i(n[4]),this.setHSL(o,l,u,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=r[1],s=n.length;if(s===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,Do.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,Do.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=lh){let i=_J[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Rg(e.r),this.g=Rg(e.g),this.b=Rg(e.b),this}copyLinearToSRGB(e){return this.r=bT(e.r),this.g=bT(e.g),this.b=bT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=lh){return Do.fromWorkingColorSpace(bE(this,Us),e),Ms(Us.r*255,0,255)<<16^Ms(Us.g*255,0,255)<<8^Ms(Us.b*255,0,255)<<0}getHexString(e=lh){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Do.workingColorSpace){Do.fromWorkingColorSpace(bE(this,Us),t);let i=Us.r,r=Us.g,n=Us.b,s=Math.max(i,r,n),a=Math.min(i,r,n),o,l,u=(a+s)/2;if(a===s)o=0,l=0;else{let c=s-a;switch(l=u<=.5?c/(s+a):c/(2-s-a),s){case i:o=(r-n)/c+(r<n?6:0);break;case r:o=(n-i)/c+2;break;case n:o=(i-r)/c+4;break}o/=6}return e.h=o,e.s=l,e.l=u,e}getRGB(e,t=Do.workingColorSpace){return Do.fromWorkingColorSpace(bE(this,Us),t),e.r=Us.r,e.g=Us.g,e.b=Us.b,e}getStyle(e=lh){return Do.fromWorkingColorSpace(bE(this,Us),e),e!==lh?`color(${e} ${Us.r} ${Us.g} ${Us.b})`:`rgb(${Us.r*255|0},${Us.g*255|0},${Us.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(Ju),Ju.h+=e,Ju.s+=t,Ju.l+=i,this.setHSL(Ju.h,Ju.s,Ju.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ju),e.getHSL(xE);let i=gb(Ju.h,xE.h,t),r=gb(Ju.s,xE.s,t),n=gb(Ju.l,xE.l,t);return this.setHSL(i,r,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};mi.NAMES=_J;var Rv,wJ=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Rv===void 0&&(Rv=a_("canvas")),Rv.width=e.width,Rv.height=e.height;let i=Rv.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Rv}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=a_("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),n=r.data;for(let s=0;s<n.length;s++)n[s]=Rg(n[s]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Rg(t[i]/255)*255):t[i]=Rg(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},EJ=class{constructor(e=null){this.isSource=!0,this.uuid=Bu(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let n;if(Array.isArray(r)){n=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?n.push(AD(r[s].image)):n.push(AD(r[s]))}else n=AD(r);i.url=n}return t||(e.images[this.uuid]=i),i}};function AD(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?wJ.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var HCe=0,jn=class extends qa{constructor(e=jn.DEFAULT_IMAGE,t=jn.DEFAULT_MAPPING,i=Mn,r=Mn,n=Ji,s=Dy,a=On,o=yo,l=jn.DEFAULT_ANISOTROPY,u=Pc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:HCe++}),this.uuid=Bu(),this.name="",this.source=new EJ(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Ie(0,0),this.repeat=new Ie(1,1),this.center=new Ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Is,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==fJ)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Gd:e.x=e.x-Math.floor(e.x);break;case Mn:e.x=e.x<0?0:1;break;case I3:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Gd:e.y=e.y-Math.floor(e.y);break;case Mn:e.y=e.y<0?0:1;break;case I3:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};jn.DEFAULT_IMAGE=null;jn.DEFAULT_MAPPING=fJ;jn.DEFAULT_ANISOTROPY=1;var Pi=class{constructor(e=0,t=0,i=0,r=1){Pi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r+s[12]*n,this.y=s[1]*t+s[5]*i+s[9]*r+s[13]*n,this.z=s[2]*t+s[6]*i+s[10]*r+s[14]*n,this.w=s[3]*t+s[7]*i+s[11]*r+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,n,s=e.elements,a=s[0],o=s[4],l=s[8],u=s[1],c=s[5],h=s[9],d=s[2],f=s[6],m=s[10];if(Math.abs(o-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(o+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(a+c+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let y=(a+1)/2,x=(c+1)/2,w=(m+1)/2,b=(o+u)/4,C=(l+d)/4,A=(h+f)/4;return y>x&&y>w?y<.01?(i=0,r=.707106781,n=.707106781):(i=Math.sqrt(y),r=b/i,n=C/i):x>w?x<.01?(i=.707106781,r=0,n=.707106781):(r=Math.sqrt(x),i=b/r,n=A/r):w<.01?(i=.707106781,r=.707106781,n=0):(n=Math.sqrt(w),i=C/n,r=A/n),this.set(i,r,n,t),this}let g=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(u-o)*(u-o));return Math.abs(g)<.001&&(g=1),this.x=(f-h)/g,this.y=(l-d)/g,this.z=(u-o)/g,this.w=Math.acos((a+c+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Tr=class extends qa{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Pi(0,0,e,t),this.scissorTest=!1,this.viewport=new Pi(0,0,e,t);let r={width:e,height:t,depth:1};this.texture=new jn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Ji,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new EJ(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},SJ=class extends jn{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ur,this.minFilter=ur,this.wrapR=Mn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},WCe=class extends jn{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ur,this.minFilter=ur,this.wrapR=Mn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},TJ=class extends Tr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,n=this.texture.length;r<n;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Si=class{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,n,s,a){let o=i[r+0],l=i[r+1],u=i[r+2],c=i[r+3],h=n[s+0],d=n[s+1],f=n[s+2],m=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c;return}if(a===1){e[t+0]=h,e[t+1]=d,e[t+2]=f,e[t+3]=m;return}if(c!==m||o!==h||l!==d||u!==f){let g=1-a,y=o*h+l*d+u*f+c*m,x=y>=0?1:-1,w=1-y*y;if(w>Number.EPSILON){let C=Math.sqrt(w),A=Math.atan2(C,y*x);g=Math.sin(g*A)/C,a=Math.sin(a*A)/C}let b=a*x;if(o=o*g+h*b,l=l*g+d*b,u=u*g+f*b,c=c*g+m*b,g===1-a){let C=1/Math.sqrt(o*o+l*l+u*u+c*c);o*=C,l*=C,u*=C,c*=C}}e[t]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,i,r,n,s){let a=i[r],o=i[r+1],l=i[r+2],u=i[r+3],c=n[s],h=n[s+1],d=n[s+2],f=n[s+3];return e[t]=a*f+u*c+o*d-l*h,e[t+1]=o*f+u*h+l*c-a*d,e[t+2]=l*f+u*d+a*h-o*c,e[t+3]=u*f-a*c-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,r=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(i/2),u=a(r/2),c=a(n/2),h=o(i/2),d=o(r/2),f=o(n/2);switch(s){case"XYZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"YXZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"ZXY":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"ZYX":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"YZX":this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f;break;case"XZY":this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],r=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],u=t[6],c=t[10],h=i+a+c;if(h>0){let d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(u-o)*d,this._y=(n-l)*d,this._z=(s-r)*d}else if(i>a&&i>c){let d=2*Math.sqrt(1+i-a-c);this._w=(u-o)/d,this._x=.25*d,this._y=(r+s)/d,this._z=(n+l)/d}else if(a>c){let d=2*Math.sqrt(1+a-i-c);this._w=(n-l)/d,this._x=(r+s)/d,this._y=.25*d,this._z=(o+u)/d}else{let d=2*Math.sqrt(1+c-i-a);this._w=(s-r)/d,this._x=(n+l)/d,this._y=(o+u)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ms(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,r=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,u=t._w;return this._x=i*u+s*a+r*l-n*o,this._y=r*u+s*o+n*a-i*l,this._z=n*u+s*l+i*o-r*a,this._w=s*u-i*a-r*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,r=this._y,n=this._z,s=this._w,a=s*e._w+i*e._x+r*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=r,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*i+t*this._x,this._y=d*r+t*this._y,this._z=d*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),u=Math.atan2(l,a),c=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=s*c+this._w*h,this._x=i*c+this._x*h,this._y=r*c+this._y*h,this._z=n*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(n),i*Math.cos(n),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},q=class{constructor(e=0,t=0,i=0){q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HV.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HV.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6]*r,this.y=n[1]*t+n[4]*i+n[7]*r,this.z=n[2]*t+n[5]*i+n[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,n=e.elements,s=1/(n[3]*t+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*t+n[4]*i+n[8]*r+n[12])*s,this.y=(n[1]*t+n[5]*i+n[9]*r+n[13])*s,this.z=(n[2]*t+n[6]*i+n[10]*r+n[14])*s,this}applyQuaternion(e){let t=this.x,i=this.y,r=this.z,n=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*r-a*i,u=o*i+a*t-n*r,c=o*r+n*i-s*t,h=-n*t-s*i-a*r;return this.x=l*o+h*-n+u*-a-c*-s,this.y=u*o+h*-s+c*-n-l*-a,this.z=c*o+h*-a+l*-s-u*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[4]*i+n[8]*r,this.y=n[1]*t+n[5]*i+n[9]*r,this.z=n[2]*t+n[6]*i+n[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,r=e.y,n=e.z,s=t.x,a=t.y,o=t.z;return this.x=r*o-n*a,this.y=n*s-i*o,this.z=i*a-r*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return MD.copy(this).projectOnVector(e),this.sub(MD)}reflect(e){return this.sub(MD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Ms(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},MD=new q,HV=new Si,xs=class{constructor(e=new q(1/0,1/0,1/0),t=new q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let u=e[o],c=e[o+1],h=e[o+2];u<t&&(t=u),c<i&&(i=c),h<r&&(r=h),u>n&&(n=u),c>s&&(s=c),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(n,s,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let u=e.getX(o),c=e.getY(o),h=e.getZ(o);u<t&&(t=u),c<i&&(i=c),h<r&&(r=h),u>n&&(n=u),c>s&&(s=c),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(n,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=Fm.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){let n=i.attributes.position;for(let s=0,a=n.count;s<a;s++)Fm.fromBufferAttribute(n,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Fm)}else i.boundingBox===null&&i.computeBoundingBox(),PD.copy(i.boundingBox),PD.applyMatrix4(e.matrixWorld),this.union(PD);let r=e.children;for(let n=0,s=r.length;n<s;n++)this.expandByObject(r[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Fm),Fm.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(K1),_E.subVectors(this.max,K1),Lv.subVectors(e.a,K1),Nv.subVectors(e.b,K1),kv.subVectors(e.c,K1),Nf.subVectors(Nv,Lv),kf.subVectors(kv,Nv),Um.subVectors(Lv,kv);let t=[0,-Nf.z,Nf.y,0,-kf.z,kf.y,0,-Um.z,Um.y,Nf.z,0,-Nf.x,kf.z,0,-kf.x,Um.z,0,-Um.x,-Nf.y,Nf.x,0,-kf.y,kf.x,0,-Um.y,Um.x,0];return!DD(t,Lv,Nv,kv,_E)||(t=[1,0,0,0,1,0,0,0,1],!DD(t,Lv,Nv,kv,_E))?!1:(wE.crossVectors(Nf,kf),t=[wE.x,wE.y,wE.z],DD(t,Lv,Nv,kv,_E))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Fm.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Fm).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(vd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),vd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),vd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),vd[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),vd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),vd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),vd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),vd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(vd),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},vd=[new q,new q,new q,new q,new q,new q,new q,new q],Fm=new q,PD=new xs,Lv=new q,Nv=new q,kv=new q,Nf=new q,kf=new q,Um=new q,K1=new q,_E=new q,wE=new q,jm=new q;function DD(e,t,i,r,n){for(let s=0,a=e.length-3;s<=a;s+=3){jm.fromArray(e,s);let o=n.x*Math.abs(jm.x)+n.y*Math.abs(jm.y)+n.z*Math.abs(jm.z),l=t.dot(jm),u=i.dot(jm),c=r.dot(jm);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>o)return!1}return!0}var GCe=new xs,$1=new q,ID=new q,Rl=class{constructor(t=new q,i=-1){this.center=t,this.radius=i}set(t,i){return this.center.copy(t),this.radius=i,this}setFromPoints(t,i){let r=this.center;i!==void 0?r.copy(i):GCe.setFromPoints(t).getCenter(r);let n=0;for(let s=0,a=t.length;s<a;s++)n=Math.max(n,r.distanceToSquared(t[s]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,i){let r=this.center.distanceToSquared(t);return i.copy(t),r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;$1.subVectors(t,this.center);let i=$1.lengthSq();if(i>this.radius*this.radius){let r=Math.sqrt(i),n=(r-this.radius)*.5;this.center.addScaledVector($1,n/r),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(ID.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint($1.copy(t.center).add(ID)),this.expandByPoint($1.copy(t.center).sub(ID))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},yd=new q,OD=new q,EE=new q,Bf=new q,RD=new q,SE=new q,LD=new q,n1=class{constructor(e=new q,t=new q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,yd)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=yd.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(yd.copy(this.direction).multiplyScalar(t).add(this.origin),yd.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){OD.copy(e).add(t).multiplyScalar(.5),EE.copy(t).sub(e).normalize(),Bf.copy(this.origin).sub(OD);let n=e.distanceTo(t)*.5,s=-this.direction.dot(EE),a=Bf.dot(this.direction),o=-Bf.dot(EE),l=Bf.lengthSq(),u=Math.abs(1-s*s),c,h,d,f;if(u>0)if(c=s*o-a,h=s*a-o,f=n*u,c>=0)if(h>=-f)if(h<=f){let m=1/u;c*=m,h*=m,d=c*(c+s*h+2*a)+h*(s*c+h+2*o)+l}else h=n,c=Math.max(0,-(s*h+a)),d=-c*c+h*(h+2*o)+l;else h=-n,c=Math.max(0,-(s*h+a)),d=-c*c+h*(h+2*o)+l;else h<=-f?(c=Math.max(0,-(-s*n+a)),h=c>0?-n:Math.min(Math.max(-n,-o),n),d=-c*c+h*(h+2*o)+l):h<=f?(c=0,h=Math.min(Math.max(-n,-o),n),d=h*(h+2*o)+l):(c=Math.max(0,-(s*n+a)),h=c>0?n:Math.min(Math.max(-n,-o),n),d=-c*c+h*(h+2*o)+l);else h=s>0?-n:n,c=Math.max(0,-(s*h+a)),d=-c*c+h*(h+2*o)+l;return i&&i.copy(this.direction).multiplyScalar(c).add(this.origin),r&&r.copy(EE).multiplyScalar(h).add(OD),d}intersectSphere(e,t){yd.subVectors(e.center,this.origin);let i=yd.dot(this.direction),r=yd.dot(yd)-i*i,n=e.radius*e.radius;if(r>n)return null;let s=Math.sqrt(n-r),a=i-s,o=i+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,n,s,a,o,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(n=(e.min.y-h.y)*u,s=(e.max.y-h.y)*u):(n=(e.max.y-h.y)*u,s=(e.min.y-h.y)*u),i>s||n>r||((n>i||isNaN(i))&&(i=n),(s<r||isNaN(r))&&(r=s),c>=0?(a=(e.min.z-h.z)*c,o=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,o=(e.min.z-h.z)*c),i>o||a>r)||((a>i||i!==i)&&(i=a),(o<r||r!==r)&&(r=o),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,yd)!==null}intersectTriangle(e,t,i,r,n){RD.subVectors(t,e),SE.subVectors(i,e),LD.crossVectors(RD,SE);let s=this.direction.dot(LD),a;if(s>0){if(r)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Bf.subVectors(this.origin,e);let o=a*this.direction.dot(SE.crossVectors(Bf,SE));if(o<0)return null;let l=a*this.direction.dot(RD.cross(Bf));if(l<0||o+l>s)return null;let u=-a*Bf.dot(LD);return u<0?null:this.at(u/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Pt=class{constructor(){Pt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,i,r,n,s,a,o,l,u,c,h,d,f,m,g,y){let x=this.elements;return x[0]=t,x[4]=i,x[8]=r,x[12]=n,x[1]=s,x[5]=a,x[9]=o,x[13]=l,x[2]=u,x[6]=c,x[10]=h,x[14]=d,x[3]=f,x[7]=m,x[11]=g,x[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Pt().fromArray(this.elements)}copy(t){let i=this.elements,r=t.elements;return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this}copyPosition(t){let i=this.elements,r=t.elements;return i[12]=r[12],i[13]=r[13],i[14]=r[14],this}setFromMatrix3(t){let i=t.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(t,i,r){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,i,r){return this.set(t.x,i.x,r.x,0,t.y,i.y,r.y,0,t.z,i.z,r.z,0,0,0,0,1),this}extractRotation(t){let i=this.elements,r=t.elements,n=1/Bv.setFromMatrixColumn(t,0).length(),s=1/Bv.setFromMatrixColumn(t,1).length(),a=1/Bv.setFromMatrixColumn(t,2).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[3]=0,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=0,i[8]=r[8]*a,i[9]=r[9]*a,i[10]=r[10]*a,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(t){let i=this.elements,r=t.x,n=t.y,s=t.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(n),u=Math.sin(n),c=Math.cos(s),h=Math.sin(s);if(t.order==="XYZ"){let d=a*c,f=a*h,m=o*c,g=o*h;i[0]=l*c,i[4]=-l*h,i[8]=u,i[1]=f+m*u,i[5]=d-g*u,i[9]=-o*l,i[2]=g-d*u,i[6]=m+f*u,i[10]=a*l}else if(t.order==="YXZ"){let d=l*c,f=l*h,m=u*c,g=u*h;i[0]=d+g*o,i[4]=m*o-f,i[8]=a*u,i[1]=a*h,i[5]=a*c,i[9]=-o,i[2]=f*o-m,i[6]=g+d*o,i[10]=a*l}else if(t.order==="ZXY"){let d=l*c,f=l*h,m=u*c,g=u*h;i[0]=d-g*o,i[4]=-a*h,i[8]=m+f*o,i[1]=f+m*o,i[5]=a*c,i[9]=g-d*o,i[2]=-a*u,i[6]=o,i[10]=a*l}else if(t.order==="ZYX"){let d=a*c,f=a*h,m=o*c,g=o*h;i[0]=l*c,i[4]=m*u-f,i[8]=d*u+g,i[1]=l*h,i[5]=g*u+d,i[9]=f*u-m,i[2]=-u,i[6]=o*l,i[10]=a*l}else if(t.order==="YZX"){let d=a*l,f=a*u,m=o*l,g=o*u;i[0]=l*c,i[4]=g-d*h,i[8]=m*h+f,i[1]=h,i[5]=a*c,i[9]=-o*c,i[2]=-u*c,i[6]=f*h+m,i[10]=d-g*h}else if(t.order==="XZY"){let d=a*l,f=a*u,m=o*l,g=o*u;i[0]=l*c,i[4]=-h,i[8]=u*c,i[1]=d*h+g,i[5]=a*c,i[9]=f*h-m,i[2]=m*h-f,i[6]=o*c,i[10]=g*h+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(t){return this.compose(qCe,t,YCe)}lookAt(t,i,r){let n=this.elements;return ql.subVectors(t,i),ql.lengthSq()===0&&(ql.z=1),ql.normalize(),zf.crossVectors(r,ql),zf.lengthSq()===0&&(Math.abs(r.z)===1?ql.x+=1e-4:ql.z+=1e-4,ql.normalize(),zf.crossVectors(r,ql)),zf.normalize(),TE.crossVectors(ql,zf),n[0]=zf.x,n[4]=TE.x,n[8]=ql.x,n[1]=zf.y,n[5]=TE.y,n[9]=ql.y,n[2]=zf.z,n[6]=TE.z,n[10]=ql.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){let r=t.elements,n=i.elements,s=this.elements,a=r[0],o=r[4],l=r[8],u=r[12],c=r[1],h=r[5],d=r[9],f=r[13],m=r[2],g=r[6],y=r[10],x=r[14],w=r[3],b=r[7],C=r[11],A=r[15],E=n[0],_=n[4],P=n[8],I=n[12],D=n[1],k=n[5],B=n[9],z=n[13],W=n[2],$=n[6],Z=n[10],G=n[14],V=n[3],J=n[7],U=n[11],ie=n[15];return s[0]=a*E+o*D+l*W+u*V,s[4]=a*_+o*k+l*$+u*J,s[8]=a*P+o*B+l*Z+u*U,s[12]=a*I+o*z+l*G+u*ie,s[1]=c*E+h*D+d*W+f*V,s[5]=c*_+h*k+d*$+f*J,s[9]=c*P+h*B+d*Z+f*U,s[13]=c*I+h*z+d*G+f*ie,s[2]=m*E+g*D+y*W+x*V,s[6]=m*_+g*k+y*$+x*J,s[10]=m*P+g*B+y*Z+x*U,s[14]=m*I+g*z+y*G+x*ie,s[3]=w*E+b*D+C*W+A*V,s[7]=w*_+b*k+C*$+A*J,s[11]=w*P+b*B+C*Z+A*U,s[15]=w*I+b*z+C*G+A*ie,this}multiplyScalar(t){let i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}determinant(){let t=this.elements,i=t[0],r=t[4],n=t[8],s=t[12],a=t[1],o=t[5],l=t[9],u=t[13],c=t[2],h=t[6],d=t[10],f=t[14],m=t[3],g=t[7],y=t[11],x=t[15];return m*(+s*l*h-n*u*h-s*o*d+r*u*d+n*o*f-r*l*f)+g*(+i*l*f-i*u*d+s*a*d-n*a*f+n*u*c-s*l*c)+y*(+i*u*h-i*o*f-s*a*h+r*a*f+s*o*c-r*u*c)+x*(-n*o*c-i*l*h+i*o*d+n*a*h-r*a*d+r*l*c)}transpose(){let t=this.elements,i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}setPosition(t,i,r){let n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=i,n[14]=r),this}invert(){let t=this.elements,i=t[0],r=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],m=t[12],g=t[13],y=t[14],x=t[15],w=h*y*u-g*d*u+g*l*f-o*y*f-h*l*x+o*d*x,b=m*d*u-c*y*u-m*l*f+a*y*f+c*l*x-a*d*x,C=c*g*u-m*h*u+m*o*f-a*g*f-c*o*x+a*h*x,A=m*h*l-c*g*l-m*o*d+a*g*d+c*o*y-a*h*y,E=i*w+r*b+n*C+s*A;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let _=1/E;return t[0]=w*_,t[1]=(g*d*s-h*y*s-g*n*f+r*y*f+h*n*x-r*d*x)*_,t[2]=(o*y*s-g*l*s+g*n*u-r*y*u-o*n*x+r*l*x)*_,t[3]=(h*l*s-o*d*s-h*n*u+r*d*u+o*n*f-r*l*f)*_,t[4]=b*_,t[5]=(c*y*s-m*d*s+m*n*f-i*y*f-c*n*x+i*d*x)*_,t[6]=(m*l*s-a*y*s-m*n*u+i*y*u+a*n*x-i*l*x)*_,t[7]=(a*d*s-c*l*s+c*n*u-i*d*u-a*n*f+i*l*f)*_,t[8]=C*_,t[9]=(m*h*s-c*g*s-m*r*f+i*g*f+c*r*x-i*h*x)*_,t[10]=(a*g*s-m*o*s+m*r*u-i*g*u-a*r*x+i*o*x)*_,t[11]=(c*o*s-a*h*s-c*r*u+i*h*u+a*r*f-i*o*f)*_,t[12]=A*_,t[13]=(c*g*n-m*h*n+m*r*d-i*g*d-c*r*y+i*h*y)*_,t[14]=(m*o*n-a*g*n-m*r*l+i*g*l+a*r*y-i*o*y)*_,t[15]=(a*h*n-c*o*n+c*r*l-i*h*l-a*r*d+i*o*d)*_,this}scale(t){let i=this.elements,r=t.x,n=t.y,s=t.z;return i[0]*=r,i[4]*=n,i[8]*=s,i[1]*=r,i[5]*=n,i[9]*=s,i[2]*=r,i[6]*=n,i[10]*=s,i[3]*=r,i[7]*=n,i[11]*=s,this}getMaxScaleOnAxis(){let t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,r,n))}makeTranslation(t,i,r){return this.set(1,0,0,t,0,1,0,i,0,0,1,r,0,0,0,1),this}makeRotationX(t){let i=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,i,-r,0,0,r,i,0,0,0,0,1),this}makeRotationY(t){let i=Math.cos(t),r=Math.sin(t);return this.set(i,0,r,0,0,1,0,0,-r,0,i,0,0,0,0,1),this}makeRotationZ(t){let i=Math.cos(t),r=Math.sin(t);return this.set(i,-r,0,0,r,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,i){let r=Math.cos(i),n=Math.sin(i),s=1-r,a=t.x,o=t.y,l=t.z,u=s*a,c=s*o;return this.set(u*a+r,u*o-n*l,u*l+n*o,0,u*o+n*l,c*o+r,c*l-n*a,0,u*l-n*o,c*l+n*a,s*l*l+r,0,0,0,0,1),this}makeScale(t,i,r){return this.set(t,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,i,r,n,s,a){return this.set(1,r,s,0,t,1,a,0,i,n,1,0,0,0,0,1),this}compose(t,i,r){let n=this.elements,s=i._x,a=i._y,o=i._z,l=i._w,u=s+s,c=a+a,h=o+o,d=s*u,f=s*c,m=s*h,g=a*c,y=a*h,x=o*h,w=l*u,b=l*c,C=l*h,A=r.x,E=r.y,_=r.z;return n[0]=(1-(g+x))*A,n[1]=(f+C)*A,n[2]=(m-b)*A,n[3]=0,n[4]=(f-C)*E,n[5]=(1-(d+x))*E,n[6]=(y+w)*E,n[7]=0,n[8]=(m+b)*_,n[9]=(y-w)*_,n[10]=(1-(d+g))*_,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,i,r){let n=this.elements,s=Bv.set(n[0],n[1],n[2]).length(),a=Bv.set(n[4],n[5],n[6]).length(),o=Bv.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],ec.copy(this);let l=1/s,u=1/a,c=1/o;return ec.elements[0]*=l,ec.elements[1]*=l,ec.elements[2]*=l,ec.elements[4]*=u,ec.elements[5]*=u,ec.elements[6]*=u,ec.elements[8]*=c,ec.elements[9]*=c,ec.elements[10]*=c,i.setFromRotationMatrix(ec),r.x=s,r.y=a,r.z=o,this}makePerspective(t,i,r,n,s,a){let o=this.elements,l=2*s/(i-t),u=2*s/(r-n),c=(i+t)/(i-t),h=(r+n)/(r-n),d=-(a+s)/(a-s),f=-2*a*s/(a-s);return o[0]=l,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,i,r,n,s,a){let o=this.elements,l=1/(i-t),u=1/(r-n),c=1/(a-s),h=(i+t)*l,d=(r+n)*u,f=(a+s)*c;return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){let i=this.elements,r=t.elements;for(let n=0;n<16;n++)if(i[n]!==r[n])return!1;return!0}fromArray(t,i=0){for(let r=0;r<16;r++)this.elements[r]=t[r+i];return this}toArray(t=[],i=0){let r=this.elements;return t[i]=r[0],t[i+1]=r[1],t[i+2]=r[2],t[i+3]=r[3],t[i+4]=r[4],t[i+5]=r[5],t[i+6]=r[6],t[i+7]=r[7],t[i+8]=r[8],t[i+9]=r[9],t[i+10]=r[10],t[i+11]=r[11],t[i+12]=r[12],t[i+13]=r[13],t[i+14]=r[14],t[i+15]=r[15],t}},Bv=new q,ec=new Pt,qCe=new q(0,0,0),YCe=new q(1,1,1),zf=new q,TE=new q,ql=new q,WV=new Pt,GV=new Si,Ks=class{constructor(e=0,t=0,i=0,r=Ks.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let r=e.elements,n=r[0],s=r[4],a=r[8],o=r[1],l=r[5],u=r[9],c=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Ms(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Ms(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,n),this._z=0);break;case"ZXY":this._x=Math.asin(Ms(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-Ms(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Ms(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,n)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Ms(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return WV.makeRotationFromQuaternion(e),this.setFromRotationMatrix(WV,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return GV.setFromEuler(this),this.setFromQuaternion(GV,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Ks.DEFAULT_ORDER="XYZ";var sB=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},XCe=0,qV=new q,zv=new Si,xd=new Pt,CE=new q,Z1=new q,KCe=new q,$Ce=new Si,YV=new q(1,0,0),XV=new q(0,1,0),KV=new q(0,0,1),ZCe={type:"added"},$V={type:"removed"},qr=class extends qa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:XCe++}),this.uuid=Bu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qr.DEFAULT_UP.clone();let e=new q,t=new Ks,i=new Si,r=new q(1,1,1);function n(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(n),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Pt},normalMatrix:{value:new Is}}),this.matrix=new Pt,this.matrixWorld=new Pt,this.matrixAutoUpdate=qr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=qr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new sB,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return zv.setFromAxisAngle(e,t),this.quaternion.multiply(zv),this}rotateOnWorldAxis(e,t){return zv.setFromAxisAngle(e,t),this.quaternion.premultiply(zv),this}rotateX(e){return this.rotateOnAxis(YV,e)}rotateY(e){return this.rotateOnAxis(XV,e)}rotateZ(e){return this.rotateOnAxis(KV,e)}translateOnAxis(e,t){return qV.copy(e).applyQuaternion(this.quaternion),this.position.add(qV.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(YV,e)}translateY(e){return this.translateOnAxis(XV,e)}translateZ(e){return this.translateOnAxis(KV,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(xd.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?CE.copy(e):CE.set(e,t,i);let r=this.parent;this.updateWorldMatrix(!0,!1),Z1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xd.lookAt(Z1,CE,this.up):xd.lookAt(CE,Z1,this.up),this.quaternion.setFromRotationMatrix(xd),r&&(xd.extractRotation(r.matrixWorld),zv.setFromRotationMatrix(xd),this.quaternion.premultiply(zv.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ZCe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent($V)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent($V)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),xd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),xd.multiply(e.parent.matrixWorld)),e.applyMatrix4(xd),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){let n=this.children[i].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,n=this.children.length;r<n;r++){let s=this.children[r].getObjectsByProperty(e,t);s.length>0&&(i=i.concat(s))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Z1,e,KCe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Z1,$Ce,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,r=t.length;i<r;i++){let n=t[i];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let r=this.children;for(let n=0,s=r.length;n<s;n++){let a=r[n];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function n(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=n(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,u=o.length;l<u;l++){let c=o[l];n(e.shapes,c)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(n(e.materials,this.material[o]));r.material=a}else r.material=n(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];r.animations.push(n(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),u=s(e.images),c=s(e.shapes),h=s(e.skeletons),d=s(e.animations),f=s(e.nodes);a.length>0&&(i.geometries=a),o.length>0&&(i.materials=o),l.length>0&&(i.textures=l),u.length>0&&(i.images=u),c.length>0&&(i.shapes=c),h.length>0&&(i.skeletons=h),d.length>0&&(i.animations=d),f.length>0&&(i.nodes=f)}return i.object=r,i;function s(a){let o=[];for(let l in a){let u=a[l];delete u.metadata,o.push(u)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){let r=e.children[i];this.add(r.clone())}return this}};qr.DEFAULT_UP=new q(0,1,0);qr.DEFAULT_MATRIX_AUTO_UPDATE=!0;qr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var tc=new q,bd=new q,ND=new q,_d=new q,Fv=new q,Uv=new q,ZV=new q,kD=new q,BD=new q,zD=new q,Fa=class{constructor(t=new q,i=new q,r=new q){this.a=t,this.b=i,this.c=r}static getNormal(t,i,r,n){n.subVectors(r,i),tc.subVectors(t,i),n.cross(tc);let s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(t,i,r,n,s){tc.subVectors(n,i),bd.subVectors(r,i),ND.subVectors(t,i);let a=tc.dot(tc),o=tc.dot(bd),l=tc.dot(ND),u=bd.dot(bd),c=bd.dot(ND),h=a*u-o*o;if(h===0)return s.set(-2,-1,-1);let d=1/h,f=(u*l-o*c)*d,m=(a*c-o*l)*d;return s.set(1-f-m,m,f)}static containsPoint(t,i,r,n){return this.getBarycoord(t,i,r,n,_d),_d.x>=0&&_d.y>=0&&_d.x+_d.y<=1}static getUV(t,i,r,n,s,a,o,l){return this.getBarycoord(t,i,r,n,_d),l.set(0,0),l.addScaledVector(s,_d.x),l.addScaledVector(a,_d.y),l.addScaledVector(o,_d.z),l}static isFrontFacing(t,i,r,n){return tc.subVectors(r,i),bd.subVectors(t,i),tc.cross(bd).dot(n)<0}set(t,i,r){return this.a.copy(t),this.b.copy(i),this.c.copy(r),this}setFromPointsAndIndices(t,i,r,n){return this.a.copy(t[i]),this.b.copy(t[r]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,i,r,n){return this.a.fromBufferAttribute(t,i),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return tc.subVectors(this.c,this.b),bd.subVectors(this.a,this.b),tc.cross(bd).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Fa.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,i){return Fa.getBarycoord(t,this.a,this.b,this.c,i)}getUV(t,i,r,n,s){return Fa.getUV(t,this.a,this.b,this.c,i,r,n,s)}containsPoint(t){return Fa.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Fa.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,i){let r=this.a,n=this.b,s=this.c,a,o;Fv.subVectors(n,r),Uv.subVectors(s,r),kD.subVectors(t,r);let l=Fv.dot(kD),u=Uv.dot(kD);if(l<=0&&u<=0)return i.copy(r);BD.subVectors(t,n);let c=Fv.dot(BD),h=Uv.dot(BD);if(c>=0&&h<=c)return i.copy(n);let d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return a=l/(l-c),i.copy(r).addScaledVector(Fv,a);zD.subVectors(t,s);let f=Fv.dot(zD),m=Uv.dot(zD);if(m>=0&&f<=m)return i.copy(s);let g=f*u-l*m;if(g<=0&&u>=0&&m<=0)return o=u/(u-m),i.copy(r).addScaledVector(Uv,o);let y=c*m-f*h;if(y<=0&&h-c>=0&&f-m>=0)return ZV.subVectors(s,n),o=(h-c)/(h-c+(f-m)),i.copy(n).addScaledVector(ZV,o);let x=1/(y+g+d);return a=g*x,o=d*x,i.copy(r).addScaledVector(Fv,a).addScaledVector(Uv,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},QCe=0,Q_=class extends qa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:QCe++}),this.uuid=Bu(),this.name="",this.type="Material",this.blending=Dg,this.side=Mc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=cJ,this.blendDst=hJ,this.blendEquation=m0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=M3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=CCe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ED,this.stencilZFail=ED,this.stencilZPass=ED,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Dg&&(i.blending=this.blending),this.side!==Mc&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=r(e.textures),s=r(e.images);n.length>0&&(i.textures=n),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let r=t.length;i=new Array(r);for(let n=0;n!==r;++n)i[n]=t[n].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},uf=class extends Q_{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=dJ,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Ss=new q,AE=new Ie,gi=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=O3,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,n=this.itemSize;r<n;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)AE.fromBufferAttribute(this,t),AE.applyMatrix3(e),this.setXY(t,AE.x,AE.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Ss.fromBufferAttribute(this,t),Ss.applyMatrix3(e),this.setXYZ(t,Ss.x,Ss.y,Ss.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ss.fromBufferAttribute(this,t),Ss.applyMatrix4(e),this.setXYZ(t,Ss.x,Ss.y,Ss.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ss.fromBufferAttribute(this,t),Ss.applyNormalMatrix(e),this.setXYZ(t,Ss.x,Ss.y,Ss.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ss.fromBufferAttribute(this,t),Ss.transformDirection(e),this.setXYZ(t,Ss.x,Ss.y,Ss.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Yd(t,this.array)),t}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Yd(t,this.array)),t}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Yd(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Yd(t,this.array)),t}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),r=hn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,n){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),r=hn(r,this.array),n=hn(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==O3&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},CJ=class extends gi{constructor(e,t,i){super(new Uint16Array(e),t,i)}},sy=class extends gi{constructor(e,t,i){super(new Uint32Array(e),t,i)}},Vt=class extends gi{constructor(e,t,i){super(new Float32Array(e),t,i)}},JCe=0,yu=new Pt,FD=new qr,jv=new q,Yl=new xs,Q1=new xs,ha=new q,ai=class extends qa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:JCe++}),this.uuid=Bu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(bJ(e)?sy:CJ)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let n=new Is().getNormalMatrix(e);i.applyNormalMatrix(n),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return yu.makeRotationFromQuaternion(e),this.applyMatrix4(yu),this}rotateX(e){return yu.makeRotationX(e),this.applyMatrix4(yu),this}rotateY(e){return yu.makeRotationY(e),this.applyMatrix4(yu),this}rotateZ(e){return yu.makeRotationZ(e),this.applyMatrix4(yu),this}translate(e,t,i){return yu.makeTranslation(e,t,i),this.applyMatrix4(yu),this}scale(e,t,i){return yu.makeScale(e,t,i),this.applyMatrix4(yu),this}lookAt(e){return FD.lookAt(e),FD.updateMatrix(),this.applyMatrix4(FD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jv).negate(),this.translate(jv.x,jv.y,jv.z),this}setFromPoints(e){let t=[];for(let i=0,r=e.length;i<r;i++){let n=e[i];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Vt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xs);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new q(-1/0,-1/0,-1/0),new q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){let n=t[i];Yl.setFromBufferAttribute(n),this.morphTargetsRelative?(ha.addVectors(this.boundingBox.min,Yl.min),this.boundingBox.expandByPoint(ha),ha.addVectors(this.boundingBox.max,Yl.max),this.boundingBox.expandByPoint(ha)):(this.boundingBox.expandByPoint(Yl.min),this.boundingBox.expandByPoint(Yl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Rl);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new q,1/0);return}if(e){let i=this.boundingSphere.center;if(Yl.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){let a=t[n];Q1.setFromBufferAttribute(a),this.morphTargetsRelative?(ha.addVectors(Yl.min,Q1.min),Yl.expandByPoint(ha),ha.addVectors(Yl.max,Q1.max),Yl.expandByPoint(ha)):(Yl.expandByPoint(Q1.min),Yl.expandByPoint(Q1.max))}Yl.getCenter(i);let r=0;for(let n=0,s=e.count;n<s;n++)ha.fromBufferAttribute(e,n),r=Math.max(r,i.distanceToSquared(ha));if(t)for(let n=0,s=t.length;n<s;n++){let a=t[n],o=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)ha.fromBufferAttribute(a,l),o&&(jv.fromBufferAttribute(e,l),ha.add(jv)),r=Math.max(r,i.distanceToSquared(ha))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,r=t.position.array,n=t.normal.array,s=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new gi(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],u=[];for(let I=0;I<a;I++)l[I]=new q,u[I]=new q;let c=new q,h=new q,d=new q,f=new Ie,m=new Ie,g=new Ie,y=new q,x=new q;function w(I,D,k){c.fromArray(r,I*3),h.fromArray(r,D*3),d.fromArray(r,k*3),f.fromArray(s,I*2),m.fromArray(s,D*2),g.fromArray(s,k*2),h.sub(c),d.sub(c),m.sub(f),g.sub(f);let B=1/(m.x*g.y-g.x*m.y);!isFinite(B)||(y.copy(h).multiplyScalar(g.y).addScaledVector(d,-m.y).multiplyScalar(B),x.copy(d).multiplyScalar(m.x).addScaledVector(h,-g.x).multiplyScalar(B),l[I].add(y),l[D].add(y),l[k].add(y),u[I].add(x),u[D].add(x),u[k].add(x))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let I=0,D=b.length;I<D;++I){let k=b[I],B=k.start,z=k.count;for(let W=B,$=B+z;W<$;W+=3)w(i[W+0],i[W+1],i[W+2])}let C=new q,A=new q,E=new q,_=new q;function P(I){E.fromArray(n,I*3),_.copy(E);let D=l[I];C.copy(D),C.sub(E.multiplyScalar(E.dot(D))).normalize(),A.crossVectors(_,D);let k=A.dot(u[I])<0?-1:1;o[I*4]=C.x,o[I*4+1]=C.y,o[I*4+2]=C.z,o[I*4+3]=k}for(let I=0,D=b.length;I<D;++I){let k=b[I],B=k.start,z=k.count;for(let W=B,$=B+z;W<$;W+=3)P(i[W+0]),P(i[W+1]),P(i[W+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new gi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let h=0,d=i.count;h<d;h++)i.setXYZ(h,0,0,0);let r=new q,n=new q,s=new q,a=new q,o=new q,l=new q,u=new q,c=new q;if(e)for(let h=0,d=e.count;h<d;h+=3){let f=e.getX(h+0),m=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,f),n.fromBufferAttribute(t,m),s.fromBufferAttribute(t,g),u.subVectors(s,n),c.subVectors(r,n),u.cross(c),a.fromBufferAttribute(i,f),o.fromBufferAttribute(i,m),l.fromBufferAttribute(i,g),a.add(u),o.add(u),l.add(u),i.setXYZ(f,a.x,a.y,a.z),i.setXYZ(m,o.x,o.y,o.z),i.setXYZ(g,l.x,l.y,l.z)}else for(let h=0,d=t.count;h<d;h+=3)r.fromBufferAttribute(t,h+0),n.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),u.subVectors(s,n),c.subVectors(r,n),u.cross(c),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ha.fromBufferAttribute(e,t),ha.normalize(),e.setXYZ(t,ha.x,ha.y,ha.z)}toNonIndexed(){function e(a,o){let l=a.array,u=a.itemSize,c=a.normalized,h=new l.constructor(o.length*u),d=0,f=0;for(let m=0,g=o.length;m<g;m++){a.isInterleavedBufferAttribute?d=o[m]*a.data.stride+a.offset:d=o[m]*u;for(let y=0;y<u;y++)h[f++]=l[d++]}return new gi(h,u,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new ai,i=this.index.array,r=this.attributes;for(let a in r){let o=r[a],l=e(o,i);t.setAttribute(a,l)}let n=this.morphAttributes;for(let a in n){let o=[],l=n[a];for(let u=0,c=l.length;u<c;u++){let h=l[u],d=e(h,i);o.push(d)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let o in i){let l=i[o];e.data.attributes[o]=l.toJSON(e.data)}let r={},n=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],u=[];for(let c=0,h=l.length;c<h;c++){let d=l[c];u.push(d.toJSON(e.data))}u.length>0&&(r[o]=u,n=!0)}n&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let r=e.attributes;for(let l in r){let u=r[l];this.setAttribute(l,u.clone(t))}let n=e.morphAttributes;for(let l in n){let u=[],c=n[l];for(let h=0,d=c.length;h<d;h++)u.push(c[h].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,u=s.length;l<u;l++){let c=s[l];this.addGroup(c.start,c.count,c.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},QV=new Pt,Vv=new n1,UD=new Rl,J1=new q,ex=new q,tx=new q,jD=new q,ME=new q,PE=new Ie,DE=new Ie,IE=new Ie,VD=new q,OE=new q,dn=class extends qr{constructor(e=new ai,t=new uf){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=i.length;r<n;r++){let s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}getVertexPosition(e,t){let i=this.geometry,r=i.attributes.position,n=i.morphAttributes.position,s=i.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(n&&a){ME.set(0,0,0);for(let o=0,l=n.length;o<l;o++){let u=a[o],c=n[o];u!==0&&(jD.fromBufferAttribute(c,e),s?ME.addScaledVector(jD,u):ME.addScaledVector(jD.sub(t),u))}t.add(ME)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let i=this.geometry,r=this.material,n=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),UD.copy(i.boundingSphere),UD.applyMatrix4(n),e.ray.intersectsSphere(UD)===!1)||(QV.copy(n).invert(),Vv.copy(e.ray).applyMatrix4(QV),i.boundingBox!==null&&Vv.intersectsBox(i.boundingBox)===!1))return;let s,a=i.index,o=i.attributes.position,l=i.attributes.uv,u=i.attributes.uv2,c=i.groups,h=i.drawRange;if(a!==null)if(Array.isArray(r))for(let d=0,f=c.length;d<f;d++){let m=c[d],g=r[m.materialIndex],y=Math.max(m.start,h.start),x=Math.min(a.count,Math.min(m.start+m.count,h.start+h.count));for(let w=y,b=x;w<b;w+=3){let C=a.getX(w),A=a.getX(w+1),E=a.getX(w+2);s=RE(this,g,e,Vv,l,u,C,A,E),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=m.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),f=Math.min(a.count,h.start+h.count);for(let m=d,g=f;m<g;m+=3){let y=a.getX(m),x=a.getX(m+1),w=a.getX(m+2);s=RE(this,r,e,Vv,l,u,y,x,w),s&&(s.faceIndex=Math.floor(m/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(r))for(let d=0,f=c.length;d<f;d++){let m=c[d],g=r[m.materialIndex],y=Math.max(m.start,h.start),x=Math.min(o.count,Math.min(m.start+m.count,h.start+h.count));for(let w=y,b=x;w<b;w+=3){let C=w,A=w+1,E=w+2;s=RE(this,g,e,Vv,l,u,C,A,E),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=m.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),f=Math.min(o.count,h.start+h.count);for(let m=d,g=f;m<g;m+=3){let y=m,x=m+1,w=m+2;s=RE(this,r,e,Vv,l,u,y,x,w),s&&(s.faceIndex=Math.floor(m/3),t.push(s))}}}};function eAe(e,t,i,r,n,s,a,o){let l;if(t.side===wa?l=r.intersectTriangle(a,s,n,!0,o):l=r.intersectTriangle(n,s,a,t.side===Mc,o),l===null)return null;OE.copy(o),OE.applyMatrix4(e.matrixWorld);let u=i.ray.origin.distanceTo(OE);return u<i.near||u>i.far?null:{distance:u,point:OE.clone(),object:e}}function RE(e,t,i,r,n,s,a,o,l){e.getVertexPosition(a,J1),e.getVertexPosition(o,ex),e.getVertexPosition(l,tx);let u=eAe(e,t,i,r,J1,ex,tx,VD);if(u){n&&(PE.fromBufferAttribute(n,a),DE.fromBufferAttribute(n,o),IE.fromBufferAttribute(n,l),u.uv=Fa.getUV(VD,J1,ex,tx,PE,DE,IE,new Ie)),s&&(PE.fromBufferAttribute(s,a),DE.fromBufferAttribute(s,o),IE.fromBufferAttribute(s,l),u.uv2=Fa.getUV(VD,J1,ex,tx,PE,DE,IE,new Ie));let c={a,b:o,c:l,normal:new q,materialIndex:0};Fa.getNormal(J1,ex,tx,c.normal),u.face=c}return u}var Dc=class extends ai{constructor(e=1,t=1,i=1,r=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:n,depthSegments:s};let a=this;r=Math.floor(r),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],u=[],c=[],h=0,d=0;f("z","y","x",-1,-1,i,t,e,s,n,0),f("z","y","x",1,-1,i,t,-e,s,n,1),f("x","z","y",1,1,e,i,t,r,s,2),f("x","z","y",1,-1,e,i,-t,r,s,3),f("x","y","z",1,-1,e,t,i,r,n,4),f("x","y","z",-1,-1,e,t,-i,r,n,5),this.setIndex(o),this.setAttribute("position",new Vt(l,3)),this.setAttribute("normal",new Vt(u,3)),this.setAttribute("uv",new Vt(c,2));function f(m,g,y,x,w,b,C,A,E,_,P){let I=b/E,D=C/_,k=b/2,B=C/2,z=A/2,W=E+1,$=_+1,Z=0,G=0,V=new q;for(let J=0;J<$;J++){let U=J*D-B;for(let ie=0;ie<W;ie++){let se=ie*I-k;V[m]=se*x,V[g]=U*w,V[y]=z,l.push(V.x,V.y,V.z),V[m]=0,V[g]=0,V[y]=A>0?1:-1,u.push(V.x,V.y,V.z),c.push(ie/E),c.push(1-J/_),Z+=1}}for(let J=0;J<_;J++)for(let U=0;U<E;U++){let ie=h+U+W*J,se=h+U+W*(J+1),ee=h+(U+1)+W*(J+1),ve=h+(U+1)+W*J;o.push(ie,se,ve),o.push(se,ee,ve),G+=6}a.addGroup(d,G,P),d+=G,h+=Z}}static fromJSON(e){return new Dc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Iy(e){let t={};for(let i in e){t[i]={};for(let r in e[i]){let n=e[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[i][r]=n.clone():Array.isArray(n)?t[i][r]=n.slice():t[i][r]=n}}return t}function Lo(e){let t={};for(let i=0;i<e.length;i++){let r=Iy(e[i]);for(let n in r)t[n]=r[n]}return t}function tAe(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}function AJ(e){return e.getRenderTarget()===null&&e.outputEncoding===$i?lh:IC}var s1={clone:Iy,merge:Lo},iAe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,rAe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Cr=class extends Q_{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=iAe,this.fragmentShader=rAe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Iy(e.uniforms),this.uniformsGroups=tAe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},sm=class extends qr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Pt,this.projectionMatrix=new Pt,this.projectionMatrixInverse=new Pt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},ho=class extends sm{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=s_*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(mb*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return s_*2*Math.atan(Math.tan(mb*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(mb*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,n=-.5*r,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*r/o,t-=s.offsetY*i/l,r*=s.width/o,i*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Hv=-90,Wv=1,nAe=class extends qr{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;let r=new ho(Hv,Wv,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);let n=new ho(Hv,Wv,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new ho(Hv,Wv,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new ho(Hv,Wv,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new ho(Hv,Wv,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new ho(Hv,Wv,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[r,n,s,a,o,l]=this.children,u=e.getRenderTarget(),c=e.toneMapping,h=e.xr.enabled;e.toneMapping=Ph,e.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,n),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,o),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(u),e.toneMapping=c,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}},aB=class extends jn{constructor(e,t,i,r,n,s,a,o,l,u){e=e!==void 0?e:[],t=t!==void 0?t:Gg,super(e,t,i,r,n,s,a,o,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},sAe=class extends Tr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new aB(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ji}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Dc(5,5,5),n=new Cr({name:"CubemapFromEquirect",uniforms:Iy(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:wa,blending:Rs});n.uniforms.tEquirect.value=t;let s=new dn(r,n),a=t.minFilter;return t.minFilter===Dy&&(t.minFilter=Ji),new nAe(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,r){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,r);e.setRenderTarget(n)}},HD=new q,aAe=new q,oAe=new Is,bl=class{constructor(e=new q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let r=HD.subVectors(i,t).cross(aAe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let i=e.delta(HD),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/r;return n<0||n>1?null:t.copy(i).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||oAe.getNormalMatrix(e),r=this.coplanarPoint(HD).applyMatrix4(e),n=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Gv=new Rl,LE=new q,oB=class{constructor(e=new bl,t=new bl,i=new bl,r=new bl,n=new bl,s=new bl){this.planes=[e,t,i,r,n,s]}set(e,t,i,r,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){let t=this.planes,i=e.elements,r=i[0],n=i[1],s=i[2],a=i[3],o=i[4],l=i[5],u=i[6],c=i[7],h=i[8],d=i[9],f=i[10],m=i[11],g=i[12],y=i[13],x=i[14],w=i[15];return t[0].setComponents(a-r,c-o,m-h,w-g).normalize(),t[1].setComponents(a+r,c+o,m+h,w+g).normalize(),t[2].setComponents(a+n,c+l,m+d,w+y).normalize(),t[3].setComponents(a-n,c-l,m-d,w-y).normalize(),t[4].setComponents(a-s,c-u,m-f,w-x).normalize(),t[5].setComponents(a+s,c+u,m+f,w+x).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Gv.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Gv)}intersectsSprite(e){return Gv.center.set(0,0,0),Gv.radius=.7071067811865476,Gv.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gv)}intersectsSphere(e){let t=this.planes,i=e.center,r=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let r=t[i];if(LE.x=r.normal.x>0?e.max.x:e.min.x,LE.y=r.normal.y>0?e.max.y:e.min.y,LE.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(LE)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function MJ(){let e=null,t=!1,i=null,r=null;function n(s,a){i(s,a),r=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&i!==null&&(r=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){e=s}}}function lAe(e,t){let i=t.isWebGL2,r=new WeakMap;function n(u,c){let h=u.array,d=u.usage,f=e.createBuffer();e.bindBuffer(c,f),e.bufferData(c,h,d),u.onUploadCallback();let m;if(h instanceof Float32Array)m=5126;else if(h instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(i)m=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else m=5123;else if(h instanceof Int16Array)m=5122;else if(h instanceof Uint32Array)m=5125;else if(h instanceof Int32Array)m=5124;else if(h instanceof Int8Array)m=5120;else if(h instanceof Uint8Array)m=5121;else if(h instanceof Uint8ClampedArray)m=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:f,type:m,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version}}function s(u,c,h){let d=c.array,f=c.updateRange;e.bindBuffer(h,u),f.count===-1?e.bufferSubData(h,0,d):(i?e.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):e.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),c.onUploadCallback()}function a(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function o(u){u.isInterleavedBufferAttribute&&(u=u.data);let c=r.get(u);c&&(e.deleteBuffer(c.buffer),r.delete(u))}function l(u,c){if(u.isGLBufferAttribute){let d=r.get(u);(!d||d.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);let h=r.get(u);h===void 0?r.set(u,n(u,c)):h.version<u.version&&(s(h.buffer,u,c),h.version=u.version)}return{get:a,remove:o,update:l}}var Nh=class extends ai{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};let n=e/2,s=t/2,a=Math.floor(i),o=Math.floor(r),l=a+1,u=o+1,c=e/a,h=t/o,d=[],f=[],m=[],g=[];for(let y=0;y<u;y++){let x=y*h-s;for(let w=0;w<l;w++){let b=w*c-n;f.push(b,-x,0),m.push(0,0,1),g.push(w/a),g.push(1-y/o)}}for(let y=0;y<o;y++)for(let x=0;x<a;x++){let w=x+l*y,b=x+l*(y+1),C=x+1+l*(y+1),A=x+1+l*y;d.push(w,b,A),d.push(b,C,A)}this.setIndex(d),this.setAttribute("position",new Vt(f,3)),this.setAttribute("normal",new Vt(m,3)),this.setAttribute("uv",new Vt(g,2))}static fromJSON(e){return new Nh(e.width,e.height,e.widthSegments,e.heightSegments)}},uAe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,cAe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,hAe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,dAe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,fAe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,pAe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,mAe="vec3 transformed = vec3( position );",gAe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,vAe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,yAe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,xAe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,bAe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,_Ae=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,wAe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,EAe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,SAe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,TAe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,CAe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,AAe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,MAe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,PAe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,DAe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,IAe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,OAe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,RAe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,LAe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,NAe="gl_FragColor = linearToOutputTexel( gl_FragColor );",kAe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,BAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,zAe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,FAe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,UAe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,jAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,VAe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,HAe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,WAe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,GAe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,qAe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,YAe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,XAe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,KAe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,$Ae=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,ZAe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,QAe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,JAe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,eMe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,tMe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,iMe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,rMe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,nMe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,sMe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,aMe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,oMe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,lMe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,uMe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cMe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,hMe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,dMe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,fMe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,pMe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,mMe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gMe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,vMe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,yMe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,xMe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,bMe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,_Me=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,wMe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,EMe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,SMe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,TMe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,CMe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,AMe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,MMe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,PMe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,DMe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,IMe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,OMe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,RMe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,LMe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,NMe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,kMe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,BMe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,zMe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,FMe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,UMe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,jMe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,VMe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,HMe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,WMe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,GMe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,qMe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,YMe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,XMe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,KMe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,$Me=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,ZMe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,QMe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,JMe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,e2e=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,t2e=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,i2e=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,r2e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,n2e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,s2e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,a2e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,o2e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,l2e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,u2e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,c2e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,h2e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,d2e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,f2e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,p2e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,m2e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,g2e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,v2e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,y2e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,x2e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,b2e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,_2e=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,w2e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,E2e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,S2e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,T2e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,C2e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A2e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,M2e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,P2e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,D2e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,I2e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,O2e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,R2e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,L2e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N2e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,k2e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,B2e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,z2e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,F2e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,U2e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Qi={alphamap_fragment:uAe,alphamap_pars_fragment:cAe,alphatest_fragment:hAe,alphatest_pars_fragment:dAe,aomap_fragment:fAe,aomap_pars_fragment:pAe,begin_vertex:mAe,beginnormal_vertex:gAe,bsdfs:vAe,iridescence_fragment:yAe,bumpmap_pars_fragment:xAe,clipping_planes_fragment:bAe,clipping_planes_pars_fragment:_Ae,clipping_planes_pars_vertex:wAe,clipping_planes_vertex:EAe,color_fragment:SAe,color_pars_fragment:TAe,color_pars_vertex:CAe,color_vertex:AAe,common:MAe,cube_uv_reflection_fragment:PAe,defaultnormal_vertex:DAe,displacementmap_pars_vertex:IAe,displacementmap_vertex:OAe,emissivemap_fragment:RAe,emissivemap_pars_fragment:LAe,encodings_fragment:NAe,encodings_pars_fragment:kAe,envmap_fragment:BAe,envmap_common_pars_fragment:zAe,envmap_pars_fragment:FAe,envmap_pars_vertex:UAe,envmap_physical_pars_fragment:QAe,envmap_vertex:jAe,fog_vertex:VAe,fog_pars_vertex:HAe,fog_fragment:WAe,fog_pars_fragment:GAe,gradientmap_pars_fragment:qAe,lightmap_fragment:YAe,lightmap_pars_fragment:XAe,lights_lambert_fragment:KAe,lights_lambert_pars_fragment:$Ae,lights_pars_begin:ZAe,lights_toon_fragment:JAe,lights_toon_pars_fragment:eMe,lights_phong_fragment:tMe,lights_phong_pars_fragment:iMe,lights_physical_fragment:rMe,lights_physical_pars_fragment:nMe,lights_fragment_begin:sMe,lights_fragment_maps:aMe,lights_fragment_end:oMe,logdepthbuf_fragment:lMe,logdepthbuf_pars_fragment:uMe,logdepthbuf_pars_vertex:cMe,logdepthbuf_vertex:hMe,map_fragment:dMe,map_pars_fragment:fMe,map_particle_fragment:pMe,map_particle_pars_fragment:mMe,metalnessmap_fragment:gMe,metalnessmap_pars_fragment:vMe,morphcolor_vertex:yMe,morphnormal_vertex:xMe,morphtarget_pars_vertex:bMe,morphtarget_vertex:_Me,normal_fragment_begin:wMe,normal_fragment_maps:EMe,normal_pars_fragment:SMe,normal_pars_vertex:TMe,normal_vertex:CMe,normalmap_pars_fragment:AMe,clearcoat_normal_fragment_begin:MMe,clearcoat_normal_fragment_maps:PMe,clearcoat_pars_fragment:DMe,iridescence_pars_fragment:IMe,output_fragment:OMe,packing:RMe,premultiplied_alpha_fragment:LMe,project_vertex:NMe,dithering_fragment:kMe,dithering_pars_fragment:BMe,roughnessmap_fragment:zMe,roughnessmap_pars_fragment:FMe,shadowmap_pars_fragment:UMe,shadowmap_pars_vertex:jMe,shadowmap_vertex:VMe,shadowmask_pars_fragment:HMe,skinbase_vertex:WMe,skinning_pars_vertex:GMe,skinning_vertex:qMe,skinnormal_vertex:YMe,specularmap_fragment:XMe,specularmap_pars_fragment:KMe,tonemapping_fragment:$Me,tonemapping_pars_fragment:ZMe,transmission_fragment:QMe,transmission_pars_fragment:JMe,uv_pars_fragment:e2e,uv_pars_vertex:t2e,uv_vertex:i2e,uv2_pars_fragment:r2e,uv2_pars_vertex:n2e,uv2_vertex:s2e,worldpos_vertex:a2e,background_vert:o2e,background_frag:l2e,backgroundCube_vert:u2e,backgroundCube_frag:c2e,cube_vert:h2e,cube_frag:d2e,depth_vert:f2e,depth_frag:p2e,distanceRGBA_vert:m2e,distanceRGBA_frag:g2e,equirect_vert:v2e,equirect_frag:y2e,linedashed_vert:x2e,linedashed_frag:b2e,meshbasic_vert:_2e,meshbasic_frag:w2e,meshlambert_vert:E2e,meshlambert_frag:S2e,meshmatcap_vert:T2e,meshmatcap_frag:C2e,meshnormal_vert:A2e,meshnormal_frag:M2e,meshphong_vert:P2e,meshphong_frag:D2e,meshphysical_vert:I2e,meshphysical_frag:O2e,meshtoon_vert:R2e,meshtoon_frag:L2e,points_vert:N2e,points_frag:k2e,shadow_vert:B2e,shadow_frag:z2e,sprite_vert:F2e,sprite_frag:U2e},Ut={common:{diffuse:{value:new mi(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Is},uv2Transform:{value:new Is},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new mi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new mi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Is}},sprite:{diffuse:{value:new mi(16777215)},opacity:{value:1},center:{value:new Ie(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Is}}},ch={basic:{uniforms:Lo([Ut.common,Ut.specularmap,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.fog]),vertexShader:Qi.meshbasic_vert,fragmentShader:Qi.meshbasic_frag},lambert:{uniforms:Lo([Ut.common,Ut.specularmap,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.fog,Ut.lights,{emissive:{value:new mi(0)}}]),vertexShader:Qi.meshlambert_vert,fragmentShader:Qi.meshlambert_frag},phong:{uniforms:Lo([Ut.common,Ut.specularmap,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.fog,Ut.lights,{emissive:{value:new mi(0)},specular:{value:new mi(1118481)},shininess:{value:30}}]),vertexShader:Qi.meshphong_vert,fragmentShader:Qi.meshphong_frag},standard:{uniforms:Lo([Ut.common,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.roughnessmap,Ut.metalnessmap,Ut.fog,Ut.lights,{emissive:{value:new mi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qi.meshphysical_vert,fragmentShader:Qi.meshphysical_frag},toon:{uniforms:Lo([Ut.common,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.gradientmap,Ut.fog,Ut.lights,{emissive:{value:new mi(0)}}]),vertexShader:Qi.meshtoon_vert,fragmentShader:Qi.meshtoon_frag},matcap:{uniforms:Lo([Ut.common,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.fog,{matcap:{value:null}}]),vertexShader:Qi.meshmatcap_vert,fragmentShader:Qi.meshmatcap_frag},points:{uniforms:Lo([Ut.points,Ut.fog]),vertexShader:Qi.points_vert,fragmentShader:Qi.points_frag},dashed:{uniforms:Lo([Ut.common,Ut.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qi.linedashed_vert,fragmentShader:Qi.linedashed_frag},depth:{uniforms:Lo([Ut.common,Ut.displacementmap]),vertexShader:Qi.depth_vert,fragmentShader:Qi.depth_frag},normal:{uniforms:Lo([Ut.common,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,{opacity:{value:1}}]),vertexShader:Qi.meshnormal_vert,fragmentShader:Qi.meshnormal_frag},sprite:{uniforms:Lo([Ut.sprite,Ut.fog]),vertexShader:Qi.sprite_vert,fragmentShader:Qi.sprite_frag},background:{uniforms:{uvTransform:{value:new Is},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Qi.background_vert,fragmentShader:Qi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Qi.backgroundCube_vert,fragmentShader:Qi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qi.cube_vert,fragmentShader:Qi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qi.equirect_vert,fragmentShader:Qi.equirect_frag},distanceRGBA:{uniforms:Lo([Ut.common,Ut.displacementmap,{referencePosition:{value:new q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qi.distanceRGBA_vert,fragmentShader:Qi.distanceRGBA_frag},shadow:{uniforms:Lo([Ut.lights,Ut.fog,{color:{value:new mi(0)},opacity:{value:1}}]),vertexShader:Qi.shadow_vert,fragmentShader:Qi.shadow_frag}};ch.physical={uniforms:Lo([ch.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ie(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new mi(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ie},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new mi(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new mi(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Qi.meshphysical_vert,fragmentShader:Qi.meshphysical_frag};var NE={r:0,b:0,g:0};function j2e(e,t,i,r,n,s,a){let o=new mi(0),l=s===!0?0:1,u,c,h=null,d=0,f=null;function m(y,x){let w=!1,b=x.isScene===!0?x.background:null;b&&b.isTexture&&(b=(x.backgroundBlurriness>0?i:t).get(b));let C=e.xr,A=C.getSession&&C.getSession();A&&A.environmentBlendMode==="additive"&&(b=null),b===null?g(o,l):b&&b.isColor&&(g(b,1),w=!0),(e.autoClear||w)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),b&&(b.isCubeTexture||b.mapping===Z_)?(c===void 0&&(c=new dn(new Dc(1,1,1),new Cr({name:"BackgroundCubeMaterial",uniforms:Iy(ch.backgroundCube.uniforms),vertexShader:ch.backgroundCube.vertexShader,fragmentShader:ch.backgroundCube.fragmentShader,side:wa,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(E,_,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),c.material.uniforms.envMap.value=b,c.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,c.material.toneMapped=b.encoding!==$i,(h!==b||d!==b.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,h=b,d=b.version,f=e.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null)):b&&b.isTexture&&(u===void 0&&(u=new dn(new Nh(2,2),new Cr({name:"BackgroundMaterial",uniforms:Iy(ch.background.uniforms),vertexShader:ch.background.vertexShader,fragmentShader:ch.background.fragmentShader,side:Mc,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=b,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.toneMapped=b.encoding!==$i,b.matrixAutoUpdate===!0&&b.updateMatrix(),u.material.uniforms.uvTransform.value.copy(b.matrix),(h!==b||d!==b.version||f!==e.toneMapping)&&(u.material.needsUpdate=!0,h=b,d=b.version,f=e.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}function g(y,x){y.getRGB(NE,AJ(e)),r.buffers.color.setClear(NE.r,NE.g,NE.b,x,a)}return{getClearColor:function(){return o},setClearColor:function(y,x=1){o.set(y),l=x,g(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,g(o,l)},render:m}}function V2e(e,t,i,r){let n=e.getParameter(34921),s=r.isWebGL2?null:t.get("OES_vertex_array_object"),a=r.isWebGL2||s!==null,o={},l=y(null),u=l,c=!1;function h(W,$,Z,G,V){let J=!1;if(a){let U=g(G,Z,$);u!==U&&(u=U,f(u.object)),J=x(W,G,Z,V),J&&w(W,G,Z,V)}else{let U=$.wireframe===!0;(u.geometry!==G.id||u.program!==Z.id||u.wireframe!==U)&&(u.geometry=G.id,u.program=Z.id,u.wireframe=U,J=!0)}V!==null&&i.update(V,34963),(J||c)&&(c=!1,P(W,$,Z,G),V!==null&&e.bindBuffer(34963,i.get(V).buffer))}function d(){return r.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function f(W){return r.isWebGL2?e.bindVertexArray(W):s.bindVertexArrayOES(W)}function m(W){return r.isWebGL2?e.deleteVertexArray(W):s.deleteVertexArrayOES(W)}function g(W,$,Z){let G=Z.wireframe===!0,V=o[W.id];V===void 0&&(V={},o[W.id]=V);let J=V[$.id];J===void 0&&(J={},V[$.id]=J);let U=J[G];return U===void 0&&(U=y(d()),J[G]=U),U}function y(W){let $=[],Z=[],G=[];for(let V=0;V<n;V++)$[V]=0,Z[V]=0,G[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:$,enabledAttributes:Z,attributeDivisors:G,object:W,attributes:{},index:null}}function x(W,$,Z,G){let V=u.attributes,J=$.attributes,U=0,ie=Z.getAttributes();for(let se in ie)if(ie[se].location>=0){let ee=V[se],ve=J[se];if(ve===void 0&&(se==="instanceMatrix"&&W.instanceMatrix&&(ve=W.instanceMatrix),se==="instanceColor"&&W.instanceColor&&(ve=W.instanceColor)),ee===void 0||ee.attribute!==ve||ve&&ee.data!==ve.data)return!0;U++}return u.attributesNum!==U||u.index!==G}function w(W,$,Z,G){let V={},J=$.attributes,U=0,ie=Z.getAttributes();for(let se in ie)if(ie[se].location>=0){let ee=J[se];ee===void 0&&(se==="instanceMatrix"&&W.instanceMatrix&&(ee=W.instanceMatrix),se==="instanceColor"&&W.instanceColor&&(ee=W.instanceColor));let ve={};ve.attribute=ee,ee&&ee.data&&(ve.data=ee.data),V[se]=ve,U++}u.attributes=V,u.attributesNum=U,u.index=G}function b(){let W=u.newAttributes;for(let $=0,Z=W.length;$<Z;$++)W[$]=0}function C(W){A(W,0)}function A(W,$){let Z=u.newAttributes,G=u.enabledAttributes,V=u.attributeDivisors;Z[W]=1,G[W]===0&&(e.enableVertexAttribArray(W),G[W]=1),V[W]!==$&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](W,$),V[W]=$)}function E(){let W=u.newAttributes,$=u.enabledAttributes;for(let Z=0,G=$.length;Z<G;Z++)$[Z]!==W[Z]&&(e.disableVertexAttribArray(Z),$[Z]=0)}function _(W,$,Z,G,V,J){r.isWebGL2===!0&&(Z===5124||Z===5125)?e.vertexAttribIPointer(W,$,Z,V,J):e.vertexAttribPointer(W,$,Z,G,V,J)}function P(W,$,Z,G){if(r.isWebGL2===!1&&(W.isInstancedMesh||G.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;b();let V=G.attributes,J=Z.getAttributes(),U=$.defaultAttributeValues;for(let ie in J){let se=J[ie];if(se.location>=0){let ee=V[ie];if(ee===void 0&&(ie==="instanceMatrix"&&W.instanceMatrix&&(ee=W.instanceMatrix),ie==="instanceColor"&&W.instanceColor&&(ee=W.instanceColor)),ee!==void 0){let ve=ee.normalized,_e=ee.itemSize,he=i.get(ee);if(he===void 0)continue;let De=he.buffer,we=he.type,Le=he.bytesPerElement;if(ee.isInterleavedBufferAttribute){let Te=ee.data,ke=Te.stride,Xe=ee.offset;if(Te.isInstancedInterleavedBuffer){for(let et=0;et<se.locationSize;et++)A(se.location+et,Te.meshPerAttribute);W.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=Te.meshPerAttribute*Te.count)}else for(let et=0;et<se.locationSize;et++)C(se.location+et);e.bindBuffer(34962,De);for(let et=0;et<se.locationSize;et++)_(se.location+et,_e/se.locationSize,we,ve,ke*Le,(Xe+_e/se.locationSize*et)*Le)}else{if(ee.isInstancedBufferAttribute){for(let Te=0;Te<se.locationSize;Te++)A(se.location+Te,ee.meshPerAttribute);W.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Te=0;Te<se.locationSize;Te++)C(se.location+Te);e.bindBuffer(34962,De);for(let Te=0;Te<se.locationSize;Te++)_(se.location+Te,_e/se.locationSize,we,ve,_e*Le,_e/se.locationSize*Te*Le)}}else if(U!==void 0){let ve=U[ie];if(ve!==void 0)switch(ve.length){case 2:e.vertexAttrib2fv(se.location,ve);break;case 3:e.vertexAttrib3fv(se.location,ve);break;case 4:e.vertexAttrib4fv(se.location,ve);break;default:e.vertexAttrib1fv(se.location,ve)}}}}E()}function I(){B();for(let W in o){let $=o[W];for(let Z in $){let G=$[Z];for(let V in G)m(G[V].object),delete G[V];delete $[Z]}delete o[W]}}function D(W){if(o[W.id]===void 0)return;let $=o[W.id];for(let Z in $){let G=$[Z];for(let V in G)m(G[V].object),delete G[V];delete $[Z]}delete o[W.id]}function k(W){for(let $ in o){let Z=o[$];if(Z[W.id]===void 0)continue;let G=Z[W.id];for(let V in G)m(G[V].object),delete G[V];delete Z[W.id]}}function B(){z(),c=!0,u!==l&&(u=l,f(u.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:B,resetDefaultState:z,dispose:I,releaseStatesOfGeometry:D,releaseStatesOfProgram:k,initAttributes:b,enableAttribute:C,disableUnusedAttributes:E}}function H2e(e,t,i,r){let n=r.isWebGL2,s;function a(u){s=u}function o(u,c){e.drawArrays(s,u,c),i.update(c,s,1)}function l(u,c,h){if(h===0)return;let d,f;if(n)d=e,f="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,u,c,h),i.update(c,s,h)}this.setMode=a,this.render=o,this.renderInstances=l}function W2e(e,t,i){let r;function n(){if(r!==void 0)return r;if(t.has("EXT_texture_filter_anisotropic")===!0){let _=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(_.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(_){if(_==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";_="mediump"}return _==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=i.precision!==void 0?i.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let u=a||t.has("WEBGL_draw_buffers"),c=i.logarithmicDepthBuffer===!0,h=e.getParameter(34930),d=e.getParameter(35660),f=e.getParameter(3379),m=e.getParameter(34076),g=e.getParameter(34921),y=e.getParameter(36347),x=e.getParameter(36348),w=e.getParameter(36349),b=d>0,C=a||t.has("OES_texture_float"),A=b&&C,E=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:u,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:m,maxAttributes:g,maxVertexUniforms:y,maxVaryings:x,maxFragmentUniforms:w,vertexTextures:b,floatFragmentTextures:C,floatVertexTextures:A,maxSamples:E}}function G2e(e){let t=this,i=null,r=0,n=!1,s=!1,a=new bl,o=new Is,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let f=h.length!==0||d||r!==0||n;return n=d,r=h.length,f},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){i=c(h,d,0)},this.setState=function(h,d,f){let m=h.clippingPlanes,g=h.clipIntersection,y=h.clipShadows,x=e.get(h);if(!n||m===null||m.length===0||s&&!y)s?c(null):u();else{let w=s?0:r,b=w*4,C=x.clippingState||null;l.value=C,C=c(m,d,b,f);for(let A=0;A!==b;++A)C[A]=i[A];x.clippingState=C,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==i&&(l.value=i,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function c(h,d,f,m){let g=h!==null?h.length:0,y=null;if(g!==0){if(y=l.value,m!==!0||y===null){let x=f+g*4,w=d.matrixWorldInverse;o.getNormalMatrix(w),(y===null||y.length<x)&&(y=new Float32Array(x));for(let b=0,C=f;b!==g;++b,C+=4)a.copy(h[b]).applyMatrix4(w,o),a.normal.toArray(y,C),y[C+3]=a.constant}l.value=y,l.needsUpdate=!0}return t.numPlanes=g,t.numIntersection=0,y}}function q2e(e){let t=new WeakMap;function i(a,o){return o===P3?a.mapping=Gg:o===D3&&(a.mapping=qg),a}function r(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===P3||o===D3)if(t.has(a)){let l=t.get(a).texture;return i(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let u=new sAe(l.height/2);return u.fromEquirectangularTexture(e,a),t.set(a,u),a.addEventListener("dispose",n),i(u.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:r,dispose:s}}var _M=class extends sm{constructor(e=-1,t=1,i=1,r=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=i-e,s=i+e,a=r+t,o=r-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=u*this.view.offsetY,o=a-u*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},G0=4,JV=[.125,.215,.35,.446,.526,.582],og=20,WD=new _M,e8=new mi,GD=null,ig=(1+Math.sqrt(5))/2,qv=1/ig,t8=[new q(1,1,1),new q(-1,1,1),new q(1,1,-1),new q(-1,1,-1),new q(0,ig,qv),new q(0,ig,-qv),new q(qv,0,ig),new q(-qv,0,ig),new q(ig,qv,0),new q(-ig,qv,0)],i8=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){GD=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,i,r,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=s8(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=n8(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(GD),e.scissorTest=!1,kE(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Gg||e.mapping===qg?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),GD=this._renderer.getRenderTarget();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Ji,minFilter:Ji,generateMipmaps:!1,type:lf,format:On,encoding:Pc,depthBuffer:!1},r=r8(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=r8(e,t,i);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Y2e(n)),this._blurMaterial=X2e(n,e,t)}return r}_compileMaterial(e){let t=new dn(this._lodPlanes[0],e);this._renderer.compile(t,WD)}_sceneToCubeUV(e,t,i,r){let n=new ho(90,1,t,i),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,u=o.toneMapping;o.getClearColor(e8),o.toneMapping=Ph,o.autoClear=!1;let c=new uf({name:"PMREM.Background",side:wa,depthWrite:!1,depthTest:!1}),h=new dn(new Dc,c),d=!1,f=e.background;f?f.isColor&&(c.color.copy(f),e.background=null,d=!0):(c.color.copy(e8),d=!0);for(let m=0;m<6;m++){let g=m%3;g===0?(n.up.set(0,s[m],0),n.lookAt(a[m],0,0)):g===1?(n.up.set(0,0,s[m]),n.lookAt(0,a[m],0)):(n.up.set(0,s[m],0),n.lookAt(0,0,a[m]));let y=this._cubeSize;kE(r,g*y,m>2?y:0,y,y),o.setRenderTarget(r),d&&o.render(h,n),o.render(e,n)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=u,o.autoClear=l,e.background=f}_textureToCubeUV(e,t){let i=this._renderer,r=e.mapping===Gg||e.mapping===qg;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=s8()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=n8());let n=r?this._cubemapMaterial:this._equirectMaterial,s=new dn(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;kE(t,0,0,3*o,2*o),i.setRenderTarget(t),i.render(s,WD)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){let n=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),s=t8[(r-1)%t8.length];this._blur(e,r-1,r,n,s)}t.autoClear=i}_blur(e,t,i,r,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",n),this._halfBlur(s,e,i,i,r,"longitudinal",n)}_halfBlur(e,t,i,r,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,c=new dn(this._lodPlanes[r],l),h=l.uniforms,d=this._sizeLods[i]-1,f=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*og-1),m=n/f,g=isFinite(n)?1+Math.floor(u*m):og;g>og&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${og}`);let y=[],x=0;for(let E=0;E<og;++E){let _=E/m,P=Math.exp(-_*_/2);y.push(P),E===0?x+=P:E<g&&(x+=2*P)}for(let E=0;E<y.length;E++)y[E]=y[E]/x;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=y,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:w}=this;h.dTheta.value=f,h.mipInt.value=w-i;let b=this._sizeLods[r],C=3*b*(r>w-G0?r-w+G0:0),A=4*(this._cubeSize-b);kE(t,C,A,3*b,2*b),o.setRenderTarget(t),o.render(c,WD)}};function Y2e(e){let t=[],i=[],r=[],n=e,s=e-G0+1+JV.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);i.push(o);let l=1/o;a>e-G0?l=JV[a-e+G0-1]:a===0&&(l=0),r.push(l);let u=1/(o-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],f=6,m=6,g=3,y=2,x=1,w=new Float32Array(g*m*f),b=new Float32Array(y*m*f),C=new Float32Array(x*m*f);for(let E=0;E<f;E++){let _=E%3*2/3-1,P=E>2?0:-1,I=[_,P,0,_+2/3,P,0,_+2/3,P+1,0,_,P,0,_+2/3,P+1,0,_,P+1,0];w.set(I,g*m*E),b.set(d,y*m*E);let D=[E,E,E,E,E,E];C.set(D,x*m*E)}let A=new ai;A.setAttribute("position",new gi(w,g)),A.setAttribute("uv",new gi(b,y)),A.setAttribute("faceIndex",new gi(C,x)),t.push(A),n>G0&&n--}return{lodPlanes:t,sizeLods:i,sigmas:r}}function r8(e,t,i){let r=new Tr(e,t,i);return r.texture.mapping=Z_,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function kE(e,t,i,r,n){e.viewport.set(t,i,r,n),e.scissor.set(t,i,r,n)}function X2e(e,t,i){let r=new Float32Array(og),n=new q(0,1,0);return new Cr({name:"SphericalGaussianBlur",defines:{n:og,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:lB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function n8(){return new Cr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function s8(){return new Cr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function lB(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function K2e(e){let t=new WeakMap,i=null;function r(o){if(o&&o.isTexture){let l=o.mapping,u=l===P3||l===D3,c=l===Gg||l===qg;if(u||c)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let h=t.get(o);return i===null&&(i=new i8(e)),h=u?i.fromEquirectangular(o,h):i.fromCubemap(o,h),t.set(o,h),h.texture}else{if(t.has(o))return t.get(o).texture;{let h=o.image;if(u&&h&&h.height>0||c&&h&&n(h)){i===null&&(i=new i8(e));let d=u?i.fromEquirectangular(o):i.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function n(o){let l=0,u=6;for(let c=0;c<u;c++)o[c]!==void 0&&l++;return l===u}function s(o){let l=o.target;l.removeEventListener("dispose",s);let u=t.get(l);u!==void 0&&(t.delete(l),u.dispose())}function a(){t=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:r,dispose:a}}function $2e(e){let t={};function i(r){if(t[r]!==void 0)return t[r];let n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(r){return i(r)!==null},init:function(r){r.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(r){let n=i(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function Z2e(e,t,i,r){let n={},s=new WeakMap;function a(h){let d=h.target;d.index!==null&&t.remove(d.index);for(let m in d.attributes)t.remove(d.attributes[m]);d.removeEventListener("dispose",a),delete n[d.id];let f=s.get(d);f&&(t.remove(f),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function o(h,d){return n[d.id]===!0||(d.addEventListener("dispose",a),n[d.id]=!0,i.memory.geometries++),d}function l(h){let d=h.attributes;for(let m in d)t.update(d[m],34962);let f=h.morphAttributes;for(let m in f){let g=f[m];for(let y=0,x=g.length;y<x;y++)t.update(g[y],34962)}}function u(h){let d=[],f=h.index,m=h.attributes.position,g=0;if(f!==null){let w=f.array;g=f.version;for(let b=0,C=w.length;b<C;b+=3){let A=w[b+0],E=w[b+1],_=w[b+2];d.push(A,E,E,_,_,A)}}else{let w=m.array;g=m.version;for(let b=0,C=w.length/3-1;b<C;b+=3){let A=b+0,E=b+1,_=b+2;d.push(A,E,E,_,_,A)}}let y=new(bJ(d)?sy:CJ)(d,1);y.version=g;let x=s.get(h);x&&t.remove(x),s.set(h,y)}function c(h){let d=s.get(h);if(d){let f=h.index;f!==null&&d.version<f.version&&u(h)}else u(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:c}}function Q2e(e,t,i,r){let n=r.isWebGL2,s;function a(d){s=d}let o,l;function u(d){o=d.type,l=d.bytesPerElement}function c(d,f){e.drawElements(s,f,o,d*l),i.update(f,s,1)}function h(d,f,m){if(m===0)return;let g,y;if(n)g=e,y="drawElementsInstanced";else if(g=t.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[y](s,f,o,d*l,m),i.update(f,s,m)}this.setMode=a,this.setIndex=u,this.render=c,this.renderInstances=h}function J2e(e){let t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(i.calls++,a){case 4:i.triangles+=o*(s/3);break;case 1:i.lines+=o*(s/2);break;case 3:i.lines+=o*(s-1);break;case 2:i.lines+=o*s;break;case 0:i.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:n,update:r}}function ePe(e,t){return e[0]-t[0]}function tPe(e,t){return Math.abs(t[1])-Math.abs(e[1])}function iPe(e,t,i){let r={},n=new Float32Array(8),s=new WeakMap,a=new Pi,o=[];for(let u=0;u<8;u++)o[u]=[u,0];function l(u,c,h,d){let f=u.morphTargetInfluences;if(t.isWebGL2===!0){let m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,g=m!==void 0?m.length:0,y=s.get(c);if(y===void 0||y.count!==g){let b=function(){W.dispose(),s.delete(c),c.removeEventListener("dispose",b)};y!==void 0&&y.texture.dispose();let C=c.morphAttributes.position!==void 0,A=c.morphAttributes.normal!==void 0,E=c.morphAttributes.color!==void 0,_=c.morphAttributes.position||[],P=c.morphAttributes.normal||[],I=c.morphAttributes.color||[],D=0;C===!0&&(D=1),A===!0&&(D=2),E===!0&&(D=3);let k=c.attributes.position.count*D,B=1;k>t.maxTextureSize&&(B=Math.ceil(k/t.maxTextureSize),k=t.maxTextureSize);let z=new Float32Array(k*B*4*g),W=new SJ(z,k,B,g);W.type=$r,W.needsUpdate=!0;let $=D*4;for(let Z=0;Z<g;Z++){let G=_[Z],V=P[Z],J=I[Z],U=k*B*4*Z;for(let ie=0;ie<G.count;ie++){let se=ie*$;C===!0&&(a.fromBufferAttribute(G,ie),z[U+se+0]=a.x,z[U+se+1]=a.y,z[U+se+2]=a.z,z[U+se+3]=0),A===!0&&(a.fromBufferAttribute(V,ie),z[U+se+4]=a.x,z[U+se+5]=a.y,z[U+se+6]=a.z,z[U+se+7]=0),E===!0&&(a.fromBufferAttribute(J,ie),z[U+se+8]=a.x,z[U+se+9]=a.y,z[U+se+10]=a.z,z[U+se+11]=J.itemSize===4?a.w:1)}}y={count:g,texture:W,size:new Ie(k,B)},s.set(c,y),c.addEventListener("dispose",b)}let x=0;for(let b=0;b<f.length;b++)x+=f[b];let w=c.morphTargetsRelative?1:1-x;d.getUniforms().setValue(e,"morphTargetBaseInfluence",w),d.getUniforms().setValue(e,"morphTargetInfluences",f),d.getUniforms().setValue(e,"morphTargetsTexture",y.texture,i),d.getUniforms().setValue(e,"morphTargetsTextureSize",y.size)}else{let m=f===void 0?0:f.length,g=r[c.id];if(g===void 0||g.length!==m){g=[];for(let C=0;C<m;C++)g[C]=[C,0];r[c.id]=g}for(let C=0;C<m;C++){let A=g[C];A[0]=C,A[1]=f[C]}g.sort(tPe);for(let C=0;C<8;C++)C<m&&g[C][1]?(o[C][0]=g[C][0],o[C][1]=g[C][1]):(o[C][0]=Number.MAX_SAFE_INTEGER,o[C][1]=0);o.sort(ePe);let y=c.morphAttributes.position,x=c.morphAttributes.normal,w=0;for(let C=0;C<8;C++){let A=o[C],E=A[0],_=A[1];E!==Number.MAX_SAFE_INTEGER&&_?(y&&c.getAttribute("morphTarget"+C)!==y[E]&&c.setAttribute("morphTarget"+C,y[E]),x&&c.getAttribute("morphNormal"+C)!==x[E]&&c.setAttribute("morphNormal"+C,x[E]),n[C]=_,w+=_):(y&&c.hasAttribute("morphTarget"+C)===!0&&c.deleteAttribute("morphTarget"+C),x&&c.hasAttribute("morphNormal"+C)===!0&&c.deleteAttribute("morphNormal"+C),n[C]=0)}let b=c.morphTargetsRelative?1:1-w;d.getUniforms().setValue(e,"morphTargetBaseInfluence",b),d.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function rPe(e,t,i,r){let n=new WeakMap;function s(l){let u=r.render.frame,c=l.geometry,h=t.get(l,c);return n.get(h)!==u&&(t.update(h),n.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),h}function a(){n=new WeakMap}function o(l){let u=l.target;u.removeEventListener("dispose",o),i.remove(u.instanceMatrix),u.instanceColor!==null&&i.remove(u.instanceColor)}return{update:s,dispose:a}}var PJ=new jn,DJ=new SJ,IJ=new WCe,OJ=new aB,a8=[],o8=[],l8=new Float32Array(16),u8=new Float32Array(9),c8=new Float32Array(4);function a1(e,t,i){let r=e[0];if(r==null||r<=0||r>0)return e;let n=t*i,s=a8[n];if(s===void 0&&(s=new Float32Array(n),a8[n]=s),t!==0){r.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=i,e[a].toArray(s,o)}return s}function Js(e,t){if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(e[i]!==t[i])return!1;return!0}function ea(e,t){for(let i=0,r=t.length;i<r;i++)e[i]=t[i]}function wM(e,t){let i=o8[t];i===void 0&&(i=new Int32Array(t),o8[t]=i);for(let r=0;r!==t;++r)i[r]=e.allocateTextureUnit();return i}function nPe(e,t){let i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function sPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Js(i,t))return;e.uniform2fv(this.addr,t),ea(i,t)}}function aPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Js(i,t))return;e.uniform3fv(this.addr,t),ea(i,t)}}function oPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Js(i,t))return;e.uniform4fv(this.addr,t),ea(i,t)}}function lPe(e,t){let i=this.cache,r=t.elements;if(r===void 0){if(Js(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),ea(i,t)}else{if(Js(i,r))return;c8.set(r),e.uniformMatrix2fv(this.addr,!1,c8),ea(i,r)}}function uPe(e,t){let i=this.cache,r=t.elements;if(r===void 0){if(Js(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),ea(i,t)}else{if(Js(i,r))return;u8.set(r),e.uniformMatrix3fv(this.addr,!1,u8),ea(i,r)}}function cPe(e,t){let i=this.cache,r=t.elements;if(r===void 0){if(Js(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),ea(i,t)}else{if(Js(i,r))return;l8.set(r),e.uniformMatrix4fv(this.addr,!1,l8),ea(i,r)}}function hPe(e,t){let i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function dPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Js(i,t))return;e.uniform2iv(this.addr,t),ea(i,t)}}function fPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(Js(i,t))return;e.uniform3iv(this.addr,t),ea(i,t)}}function pPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Js(i,t))return;e.uniform4iv(this.addr,t),ea(i,t)}}function mPe(e,t){let i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function gPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Js(i,t))return;e.uniform2uiv(this.addr,t),ea(i,t)}}function vPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(Js(i,t))return;e.uniform3uiv(this.addr,t),ea(i,t)}}function yPe(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Js(i,t))return;e.uniform4uiv(this.addr,t),ea(i,t)}}function xPe(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture2D(t||PJ,n)}function bPe(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(t||IJ,n)}function _Pe(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTextureCube(t||OJ,n)}function wPe(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(t||DJ,n)}function EPe(e){switch(e){case 5126:return nPe;case 35664:return sPe;case 35665:return aPe;case 35666:return oPe;case 35674:return lPe;case 35675:return uPe;case 35676:return cPe;case 5124:case 35670:return hPe;case 35667:case 35671:return dPe;case 35668:case 35672:return fPe;case 35669:case 35673:return pPe;case 5125:return mPe;case 36294:return gPe;case 36295:return vPe;case 36296:return yPe;case 35678:case 36198:case 36298:case 36306:case 35682:return xPe;case 35679:case 36299:case 36307:return bPe;case 35680:case 36300:case 36308:case 36293:return _Pe;case 36289:case 36303:case 36311:case 36292:return wPe}}function SPe(e,t){e.uniform1fv(this.addr,t)}function TPe(e,t){let i=a1(t,this.size,2);e.uniform2fv(this.addr,i)}function CPe(e,t){let i=a1(t,this.size,3);e.uniform3fv(this.addr,i)}function APe(e,t){let i=a1(t,this.size,4);e.uniform4fv(this.addr,i)}function MPe(e,t){let i=a1(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function PPe(e,t){let i=a1(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function DPe(e,t){let i=a1(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function IPe(e,t){e.uniform1iv(this.addr,t)}function OPe(e,t){e.uniform2iv(this.addr,t)}function RPe(e,t){e.uniform3iv(this.addr,t)}function LPe(e,t){e.uniform4iv(this.addr,t)}function NPe(e,t){e.uniform1uiv(this.addr,t)}function kPe(e,t){e.uniform2uiv(this.addr,t)}function BPe(e,t){e.uniform3uiv(this.addr,t)}function zPe(e,t){e.uniform4uiv(this.addr,t)}function FPe(e,t,i){let r=this.cache,n=t.length,s=wM(i,n);Js(r,s)||(e.uniform1iv(this.addr,s),ea(r,s));for(let a=0;a!==n;++a)i.setTexture2D(t[a]||PJ,s[a])}function UPe(e,t,i){let r=this.cache,n=t.length,s=wM(i,n);Js(r,s)||(e.uniform1iv(this.addr,s),ea(r,s));for(let a=0;a!==n;++a)i.setTexture3D(t[a]||IJ,s[a])}function jPe(e,t,i){let r=this.cache,n=t.length,s=wM(i,n);Js(r,s)||(e.uniform1iv(this.addr,s),ea(r,s));for(let a=0;a!==n;++a)i.setTextureCube(t[a]||OJ,s[a])}function VPe(e,t,i){let r=this.cache,n=t.length,s=wM(i,n);Js(r,s)||(e.uniform1iv(this.addr,s),ea(r,s));for(let a=0;a!==n;++a)i.setTexture2DArray(t[a]||DJ,s[a])}function HPe(e){switch(e){case 5126:return SPe;case 35664:return TPe;case 35665:return CPe;case 35666:return APe;case 35674:return MPe;case 35675:return PPe;case 35676:return DPe;case 5124:case 35670:return IPe;case 35667:case 35671:return OPe;case 35668:case 35672:return RPe;case 35669:case 35673:return LPe;case 5125:return NPe;case 36294:return kPe;case 36295:return BPe;case 36296:return zPe;case 35678:case 36198:case 36298:case 36306:case 35682:return FPe;case 35679:case 36299:case 36307:return UPe;case 35680:case 36300:case 36308:case 36293:return jPe;case 36289:case 36303:case 36311:case 36292:return VPe}}var WPe=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=EPe(t.type)}},GPe=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=HPe(t.type)}},qPe=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){if(t===void 0)return;let r=this.seq;for(let n=0,s=r.length;n!==s;++n){let a=r[n];a.setValue(e,t[a.id],i)}}},qD=/(\w+)(\])?(\[|\.)?/g;function h8(e,t){e.seq.push(t),e.map[t.id]=t}function YPe(e,t,i){let r=e.name,n=r.length;for(qD.lastIndex=0;;){let s=qD.exec(r),a=qD.lastIndex,o=s[1],l=s[2]==="]",u=s[3];if(l&&(o=o|0),u===void 0||u==="["&&a+2===n){h8(i,u===void 0?new WPe(o,e,t):new GPe(o,e,t));break}else{let c=i.map[o];c===void 0&&(c=new qPe(o),h8(i,c)),i=c}}}var _T=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){let n=e.getActiveUniform(t,r),s=e.getUniformLocation(t,n.name);YPe(n,s,this)}}setValue(e,t,i,r){let n=this.map[t];n!==void 0&&n.setValue(e,i,r)}setOptional(e,t,i){let r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=i[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,r)}}static seqWithValue(e,t){let i=[];for(let r=0,n=e.length;r!==n;++r){let s=e[r];s.id in t&&i.push(s)}return i}};function d8(e,t,i){let r=e.createShader(t);return e.shaderSource(r,i),e.compileShader(r),r}var XPe=0;function KPe(e,t){let i=e.split(`
`),r=[],n=Math.max(t-6,0),s=Math.min(t+6,i.length);for(let a=n;a<s;a++){let o=a+1;r.push(`${o===t?">":" "} ${o}: ${i[a]}`)}return r.join(`
`)}function $Pe(e){switch(e){case Pc:return["Linear","( value )"];case $i:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function f8(e,t,i){let r=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(r&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return i.toUpperCase()+`

`+n+`

`+KPe(e.getShaderSource(t),a)}else return n}function ZPe(e,t){let i=$Pe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function QPe(e,t){let i;switch(t){case sCe:i="Linear";break;case aCe:i="Reinhard";break;case oCe:i="OptimizedCineon";break;case lCe:i="ACESFilmic";break;case uCe:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function JPe(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Hx).join(`
`)}function eDe(e){let t=[];for(let i in e){let r=e[i];r!==!1&&t.push("#define "+i+" "+r)}return t.join(`
`)}function tDe(e,t){let i={},r=e.getProgramParameter(t,35721);for(let n=0;n<r;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),i[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return i}function Hx(e){return e!==""}function p8(e,t){let i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function m8(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var iDe=/^[ \t]*#include +<([\w\d./]+)>/gm;function k3(e){return e.replace(iDe,rDe)}function rDe(e,t){let i=Qi[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return k3(i)}var nDe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function g8(e){return e.replace(nDe,sDe)}function sDe(e,t,i,r){let n="";for(let s=parseInt(t);s<parseInt(i);s++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function v8(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function aDe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===tB?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===BTe?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Vx&&(t="SHADOWMAP_TYPE_VSM"),t}function oDe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Gg:case qg:t="ENVMAP_TYPE_CUBE";break;case Z_:t="ENVMAP_TYPE_CUBE_UV";break}return t}function lDe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case qg:t="ENVMAP_MODE_REFRACTION";break}return t}function uDe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case dJ:t="ENVMAP_BLENDING_MULTIPLY";break;case rCe:t="ENVMAP_BLENDING_MIX";break;case nCe:t="ENVMAP_BLENDING_ADD";break}return t}function cDe(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let i=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:r,maxMip:i}}function hDe(e,t,i,r){let n=e.getContext(),s=i.defines,a=i.vertexShader,o=i.fragmentShader,l=aDe(i),u=oDe(i),c=lDe(i),h=uDe(i),d=cDe(i),f=i.isWebGL2?"":JPe(i),m=eDe(s),g=n.createProgram(),y,x,w=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(y=[m].filter(Hx).join(`
`),y.length>0&&(y+=`
`),x=[f,m].filter(Hx).join(`
`),x.length>0&&(x+=`
`)):(y=[v8(i),"#define SHADER_NAME "+i.shaderName,m,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Hx).join(`
`),x=[f,v8(i),"#define SHADER_NAME "+i.shaderName,m,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Ph?"#define TONE_MAPPING":"",i.toneMapping!==Ph?Qi.tonemapping_pars_fragment:"",i.toneMapping!==Ph?QPe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Qi.encodings_pars_fragment,ZPe("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Hx).join(`
`)),a=k3(a),a=p8(a,i),a=m8(a,i),o=k3(o),o=p8(o,i),o=m8(o,i),a=g8(a),o=g8(o),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,x=["#define varying in",i.glslVersion===R3?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===R3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);let b=w+y+a,C=w+x+o,A=d8(n,35633,b),E=d8(n,35632,C);if(n.attachShader(g,A),n.attachShader(g,E),i.index0AttributeName!==void 0?n.bindAttribLocation(g,0,i.index0AttributeName):i.morphTargets===!0&&n.bindAttribLocation(g,0,"position"),n.linkProgram(g),e.debug.checkShaderErrors){let I=n.getProgramInfoLog(g).trim(),D=n.getShaderInfoLog(A).trim(),k=n.getShaderInfoLog(E).trim(),B=!0,z=!0;if(n.getProgramParameter(g,35714)===!1){B=!1;let W=f8(n,A,"vertex"),$=f8(n,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(g,35715)+`

Program Info Log: `+I+`
`+W+`
`+$)}else I!==""?console.warn("THREE.WebGLProgram: Program Info Log:",I):(D===""||k==="")&&(z=!1);z&&(this.diagnostics={runnable:B,programLog:I,vertexShader:{log:D,prefix:y},fragmentShader:{log:k,prefix:x}})}n.deleteShader(A),n.deleteShader(E);let _;this.getUniforms=function(){return _===void 0&&(_=new _T(n,g)),_};let P;return this.getAttributes=function(){return P===void 0&&(P=tDe(n,g)),P},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(g),this.program=void 0},this.name=i.shaderName,this.id=XPe++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=A,this.fragmentShader=E,this}var dDe=0,fDe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),n=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return s.has(r)===!1&&(s.add(r),r.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new pDe(e),t.set(e,i)),i}},pDe=class{constructor(e){this.id=dDe++,this.code=e,this.usedTimes=0}};function mDe(e,t,i,r,n,s,a){let o=new sB,l=new fDe,u=[],c=n.isWebGL2,h=n.logarithmicDepthBuffer,d=n.vertexTextures,f=n.precision,m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(P,I,D,k,B){let z=k.fog,W=B.geometry,$=P.isMeshStandardMaterial?k.environment:null,Z=(P.isMeshStandardMaterial?i:t).get(P.envMap||$),G=Z&&Z.mapping===Z_?Z.image.height:null,V=m[P.type];P.precision!==null&&(f=n.getMaxPrecision(P.precision),f!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",f,"instead."));let J=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color,U=J!==void 0?J.length:0,ie=0;W.morphAttributes.position!==void 0&&(ie=1),W.morphAttributes.normal!==void 0&&(ie=2),W.morphAttributes.color!==void 0&&(ie=3);let se,ee,ve,_e;if(V){let Te=ch[V];se=Te.vertexShader,ee=Te.fragmentShader}else se=P.vertexShader,ee=P.fragmentShader,l.update(P),ve=l.getVertexShaderID(P),_e=l.getFragmentShaderID(P);let he=e.getRenderTarget(),De=P.alphaTest>0,we=P.clearcoat>0,Le=P.iridescence>0;return{isWebGL2:c,shaderID:V,shaderName:P.type,vertexShader:se,fragmentShader:ee,defines:P.defines,customVertexShaderID:ve,customFragmentShaderID:_e,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:f,instancing:B.isInstancedMesh===!0,instancingColor:B.isInstancedMesh===!0&&B.instanceColor!==null,supportsVertexTextures:d,outputEncoding:he===null?e.outputEncoding:he.isXRRenderTarget===!0?he.texture.encoding:Pc,map:!!P.map,matcap:!!P.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:G,lightMap:!!P.lightMap,aoMap:!!P.aoMap,emissiveMap:!!P.emissiveMap,bumpMap:!!P.bumpMap,normalMap:!!P.normalMap,objectSpaceNormalMap:P.normalMapType===TCe,tangentSpaceNormalMap:P.normalMapType===SCe,decodeVideoTexture:!!P.map&&P.map.isVideoTexture===!0&&P.map.encoding===$i,clearcoat:we,clearcoatMap:we&&!!P.clearcoatMap,clearcoatRoughnessMap:we&&!!P.clearcoatRoughnessMap,clearcoatNormalMap:we&&!!P.clearcoatNormalMap,iridescence:Le,iridescenceMap:Le&&!!P.iridescenceMap,iridescenceThicknessMap:Le&&!!P.iridescenceThicknessMap,displacementMap:!!P.displacementMap,roughnessMap:!!P.roughnessMap,metalnessMap:!!P.metalnessMap,specularMap:!!P.specularMap,specularIntensityMap:!!P.specularIntensityMap,specularColorMap:!!P.specularColorMap,opaque:P.transparent===!1&&P.blending===Dg,alphaMap:!!P.alphaMap,alphaTest:De,gradientMap:!!P.gradientMap,sheen:P.sheen>0,sheenColorMap:!!P.sheenColorMap,sheenRoughnessMap:!!P.sheenRoughnessMap,transmission:P.transmission>0,transmissionMap:!!P.transmissionMap,thicknessMap:!!P.thicknessMap,combine:P.combine,vertexTangents:!!P.normalMap&&!!W.attributes.tangent,vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!W.attributes.color&&W.attributes.color.itemSize===4,vertexUvs:!!P.map||!!P.bumpMap||!!P.normalMap||!!P.specularMap||!!P.alphaMap||!!P.emissiveMap||!!P.roughnessMap||!!P.metalnessMap||!!P.clearcoatMap||!!P.clearcoatRoughnessMap||!!P.clearcoatNormalMap||!!P.iridescenceMap||!!P.iridescenceThicknessMap||!!P.displacementMap||!!P.transmissionMap||!!P.thicknessMap||!!P.specularIntensityMap||!!P.specularColorMap||!!P.sheenColorMap||!!P.sheenRoughnessMap,uvsVertexOnly:!(P.map||P.bumpMap||P.normalMap||P.specularMap||P.alphaMap||P.emissiveMap||P.roughnessMap||P.metalnessMap||P.clearcoatNormalMap||P.iridescenceMap||P.iridescenceThicknessMap||P.transmission>0||P.transmissionMap||P.thicknessMap||P.specularIntensityMap||P.specularColorMap||P.sheen>0||P.sheenColorMap||P.sheenRoughnessMap)&&!!P.displacementMap,fog:!!z,useFog:P.fog===!0,fogExp2:z&&z.isFogExp2,flatShading:!!P.flatShading,sizeAttenuation:P.sizeAttenuation,logarithmicDepthBuffer:h,skinning:B.isSkinnedMesh===!0,morphTargets:W.morphAttributes.position!==void 0,morphNormals:W.morphAttributes.normal!==void 0,morphColors:W.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:ie,numDirLights:I.directional.length,numPointLights:I.point.length,numSpotLights:I.spot.length,numSpotLightMaps:I.spotLightMap.length,numRectAreaLights:I.rectArea.length,numHemiLights:I.hemi.length,numDirLightShadows:I.directionalShadowMap.length,numPointLightShadows:I.pointShadowMap.length,numSpotLightShadows:I.spotShadowMap.length,numSpotLightShadowsWithMaps:I.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:P.dithering,shadowMapEnabled:e.shadowMap.enabled&&D.length>0,shadowMapType:e.shadowMap.type,toneMapping:P.toneMapped?e.toneMapping:Ph,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===po,flipSided:P.side===wa,useDepthPacking:!!P.depthPacking,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionDerivatives:P.extensions&&P.extensions.derivatives,extensionFragDepth:P.extensions&&P.extensions.fragDepth,extensionDrawBuffers:P.extensions&&P.extensions.drawBuffers,extensionShaderTextureLOD:P.extensions&&P.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:P.customProgramCacheKey()}}function y(P){let I=[];if(P.shaderID?I.push(P.shaderID):(I.push(P.customVertexShaderID),I.push(P.customFragmentShaderID)),P.defines!==void 0)for(let D in P.defines)I.push(D),I.push(P.defines[D]);return P.isRawShaderMaterial===!1&&(x(I,P),w(I,P),I.push(e.outputEncoding)),I.push(P.customProgramCacheKey),I.join()}function x(P,I){P.push(I.precision),P.push(I.outputEncoding),P.push(I.envMapMode),P.push(I.envMapCubeUVHeight),P.push(I.combine),P.push(I.vertexUvs),P.push(I.fogExp2),P.push(I.sizeAttenuation),P.push(I.morphTargetsCount),P.push(I.morphAttributeCount),P.push(I.numDirLights),P.push(I.numPointLights),P.push(I.numSpotLights),P.push(I.numSpotLightMaps),P.push(I.numHemiLights),P.push(I.numRectAreaLights),P.push(I.numDirLightShadows),P.push(I.numPointLightShadows),P.push(I.numSpotLightShadows),P.push(I.numSpotLightShadowsWithMaps),P.push(I.shadowMapType),P.push(I.toneMapping),P.push(I.numClippingPlanes),P.push(I.numClipIntersection),P.push(I.depthPacking)}function w(P,I){o.disableAll(),I.isWebGL2&&o.enable(0),I.supportsVertexTextures&&o.enable(1),I.instancing&&o.enable(2),I.instancingColor&&o.enable(3),I.map&&o.enable(4),I.matcap&&o.enable(5),I.envMap&&o.enable(6),I.lightMap&&o.enable(7),I.aoMap&&o.enable(8),I.emissiveMap&&o.enable(9),I.bumpMap&&o.enable(10),I.normalMap&&o.enable(11),I.objectSpaceNormalMap&&o.enable(12),I.tangentSpaceNormalMap&&o.enable(13),I.clearcoat&&o.enable(14),I.clearcoatMap&&o.enable(15),I.clearcoatRoughnessMap&&o.enable(16),I.clearcoatNormalMap&&o.enable(17),I.iridescence&&o.enable(18),I.iridescenceMap&&o.enable(19),I.iridescenceThicknessMap&&o.enable(20),I.displacementMap&&o.enable(21),I.specularMap&&o.enable(22),I.roughnessMap&&o.enable(23),I.metalnessMap&&o.enable(24),I.gradientMap&&o.enable(25),I.alphaMap&&o.enable(26),I.alphaTest&&o.enable(27),I.vertexColors&&o.enable(28),I.vertexAlphas&&o.enable(29),I.vertexUvs&&o.enable(30),I.vertexTangents&&o.enable(31),I.uvsVertexOnly&&o.enable(32),P.push(o.mask),o.disableAll(),I.fog&&o.enable(0),I.useFog&&o.enable(1),I.flatShading&&o.enable(2),I.logarithmicDepthBuffer&&o.enable(3),I.skinning&&o.enable(4),I.morphTargets&&o.enable(5),I.morphNormals&&o.enable(6),I.morphColors&&o.enable(7),I.premultipliedAlpha&&o.enable(8),I.shadowMapEnabled&&o.enable(9),I.physicallyCorrectLights&&o.enable(10),I.doubleSided&&o.enable(11),I.flipSided&&o.enable(12),I.useDepthPacking&&o.enable(13),I.dithering&&o.enable(14),I.specularIntensityMap&&o.enable(15),I.specularColorMap&&o.enable(16),I.transmission&&o.enable(17),I.transmissionMap&&o.enable(18),I.thicknessMap&&o.enable(19),I.sheen&&o.enable(20),I.sheenColorMap&&o.enable(21),I.sheenRoughnessMap&&o.enable(22),I.decodeVideoTexture&&o.enable(23),I.opaque&&o.enable(24),P.push(o.mask)}function b(P){let I=m[P.type],D;if(I){let k=ch[I];D=s1.clone(k.uniforms)}else D=P.uniforms;return D}function C(P,I){let D;for(let k=0,B=u.length;k<B;k++){let z=u[k];if(z.cacheKey===I){D=z,++D.usedTimes;break}}return D===void 0&&(D=new hDe(e,I,P,s),u.push(D)),D}function A(P){if(--P.usedTimes===0){let I=u.indexOf(P);u[I]=u[u.length-1],u.pop(),P.destroy()}}function E(P){l.remove(P)}function _(){l.dispose()}return{getParameters:g,getProgramCacheKey:y,getUniforms:b,acquireProgram:C,releaseProgram:A,releaseShaderCache:E,programs:u,dispose:_}}function gDe(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function i(s){e.delete(s)}function r(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:i,update:r,dispose:n}}function vDe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function y8(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function x8(){let e=[],t=0,i=[],r=[],n=[];function s(){t=0,i.length=0,r.length=0,n.length=0}function a(h,d,f,m,g,y){let x=e[t];return x===void 0?(x={id:h.id,object:h,geometry:d,material:f,groupOrder:m,renderOrder:h.renderOrder,z:g,group:y},e[t]=x):(x.id=h.id,x.object=h,x.geometry=d,x.material=f,x.groupOrder=m,x.renderOrder=h.renderOrder,x.z=g,x.group=y),t++,x}function o(h,d,f,m,g,y){let x=a(h,d,f,m,g,y);f.transmission>0?r.push(x):f.transparent===!0?n.push(x):i.push(x)}function l(h,d,f,m,g,y){let x=a(h,d,f,m,g,y);f.transmission>0?r.unshift(x):f.transparent===!0?n.unshift(x):i.unshift(x)}function u(h,d){i.length>1&&i.sort(h||vDe),r.length>1&&r.sort(d||y8),n.length>1&&n.sort(d||y8)}function c(){for(let h=t,d=e.length;h<d;h++){let f=e[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:r,transparent:n,init:s,push:o,unshift:l,finish:c,sort:u}}function yDe(){let e=new WeakMap;function t(r,n){let s=e.get(r),a;return s===void 0?(a=new x8,e.set(r,[a])):n>=s.length?(a=new x8,s.push(a)):a=s[n],a}function i(){e=new WeakMap}return{get:t,dispose:i}}function xDe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new q,color:new mi};break;case"SpotLight":i={position:new q,direction:new q,color:new mi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new q,color:new mi,distance:0,decay:0};break;case"HemisphereLight":i={direction:new q,skyColor:new mi,groundColor:new mi};break;case"RectAreaLight":i={color:new mi,position:new q,halfWidth:new q,halfHeight:new q};break}return e[t.id]=i,i}}}function bDe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=i,i}}}var _De=0;function wDe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function EDe(e,t){let i=new xDe,r=bDe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)n.probe.push(new q);let s=new q,a=new Pt,o=new Pt;function l(c,h){let d=0,f=0,m=0;for(let k=0;k<9;k++)n.probe[k].set(0,0,0);let g=0,y=0,x=0,w=0,b=0,C=0,A=0,E=0,_=0,P=0;c.sort(wDe);let I=h!==!0?Math.PI:1;for(let k=0,B=c.length;k<B;k++){let z=c[k],W=z.color,$=z.intensity,Z=z.distance,G=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)d+=W.r*$*I,f+=W.g*$*I,m+=W.b*$*I;else if(z.isLightProbe)for(let V=0;V<9;V++)n.probe[V].addScaledVector(z.sh.coefficients[V],$);else if(z.isDirectionalLight){let V=i.get(z);if(V.color.copy(z.color).multiplyScalar(z.intensity*I),z.castShadow){let J=z.shadow,U=r.get(z);U.shadowBias=J.bias,U.shadowNormalBias=J.normalBias,U.shadowRadius=J.radius,U.shadowMapSize=J.mapSize,n.directionalShadow[g]=U,n.directionalShadowMap[g]=G,n.directionalShadowMatrix[g]=z.shadow.matrix,C++}n.directional[g]=V,g++}else if(z.isSpotLight){let V=i.get(z);V.position.setFromMatrixPosition(z.matrixWorld),V.color.copy(W).multiplyScalar($*I),V.distance=Z,V.coneCos=Math.cos(z.angle),V.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),V.decay=z.decay,n.spot[x]=V;let J=z.shadow;if(z.map&&(n.spotLightMap[_]=z.map,_++,J.updateMatrices(z),z.castShadow&&P++),n.spotLightMatrix[x]=J.matrix,z.castShadow){let U=r.get(z);U.shadowBias=J.bias,U.shadowNormalBias=J.normalBias,U.shadowRadius=J.radius,U.shadowMapSize=J.mapSize,n.spotShadow[x]=U,n.spotShadowMap[x]=G,E++}x++}else if(z.isRectAreaLight){let V=i.get(z);V.color.copy(W).multiplyScalar($),V.halfWidth.set(z.width*.5,0,0),V.halfHeight.set(0,z.height*.5,0),n.rectArea[w]=V,w++}else if(z.isPointLight){let V=i.get(z);if(V.color.copy(z.color).multiplyScalar(z.intensity*I),V.distance=z.distance,V.decay=z.decay,z.castShadow){let J=z.shadow,U=r.get(z);U.shadowBias=J.bias,U.shadowNormalBias=J.normalBias,U.shadowRadius=J.radius,U.shadowMapSize=J.mapSize,U.shadowCameraNear=J.camera.near,U.shadowCameraFar=J.camera.far,n.pointShadow[y]=U,n.pointShadowMap[y]=G,n.pointShadowMatrix[y]=z.shadow.matrix,A++}n.point[y]=V,y++}else if(z.isHemisphereLight){let V=i.get(z);V.skyColor.copy(z.color).multiplyScalar($*I),V.groundColor.copy(z.groundColor).multiplyScalar($*I),n.hemi[b]=V,b++}}w>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ut.LTC_FLOAT_1,n.rectAreaLTC2=Ut.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Ut.LTC_HALF_1,n.rectAreaLTC2=Ut.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=f,n.ambient[2]=m;let D=n.hash;(D.directionalLength!==g||D.pointLength!==y||D.spotLength!==x||D.rectAreaLength!==w||D.hemiLength!==b||D.numDirectionalShadows!==C||D.numPointShadows!==A||D.numSpotShadows!==E||D.numSpotMaps!==_)&&(n.directional.length=g,n.spot.length=x,n.rectArea.length=w,n.point.length=y,n.hemi.length=b,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=A,n.pointShadowMap.length=A,n.spotShadow.length=E,n.spotShadowMap.length=E,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=A,n.spotLightMatrix.length=E+_-P,n.spotLightMap.length=_,n.numSpotLightShadowsWithMaps=P,D.directionalLength=g,D.pointLength=y,D.spotLength=x,D.rectAreaLength=w,D.hemiLength=b,D.numDirectionalShadows=C,D.numPointShadows=A,D.numSpotShadows=E,D.numSpotMaps=_,n.version=_De++)}function u(c,h){let d=0,f=0,m=0,g=0,y=0,x=h.matrixWorldInverse;for(let w=0,b=c.length;w<b;w++){let C=c[w];if(C.isDirectionalLight){let A=n.directional[d];A.direction.setFromMatrixPosition(C.matrixWorld),s.setFromMatrixPosition(C.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(x),d++}else if(C.isSpotLight){let A=n.spot[m];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(x),A.direction.setFromMatrixPosition(C.matrixWorld),s.setFromMatrixPosition(C.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(x),m++}else if(C.isRectAreaLight){let A=n.rectArea[g];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(x),o.identity(),a.copy(C.matrixWorld),a.premultiply(x),o.extractRotation(a),A.halfWidth.set(C.width*.5,0,0),A.halfHeight.set(0,C.height*.5,0),A.halfWidth.applyMatrix4(o),A.halfHeight.applyMatrix4(o),g++}else if(C.isPointLight){let A=n.point[f];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(x),f++}else if(C.isHemisphereLight){let A=n.hemi[y];A.direction.setFromMatrixPosition(C.matrixWorld),A.direction.transformDirection(x),y++}}}return{setup:l,setupView:u,state:n}}function b8(e,t){let i=new EDe(e,t),r=[],n=[];function s(){r.length=0,n.length=0}function a(c){r.push(c)}function o(c){n.push(c)}function l(c){i.setup(r,c)}function u(c){i.setupView(r,c)}return{init:s,state:{lightsArray:r,shadowsArray:n,lights:i},setupLights:l,setupLightsView:u,pushLight:a,pushShadow:o}}function SDe(e,t){let i=new WeakMap;function r(s,a=0){let o=i.get(s),l;return o===void 0?(l=new b8(e,t),i.set(s,[l])):a>=o.length?(l=new b8(e,t),o.push(l)):l=o[a],l}function n(){i=new WeakMap}return{get:r,dispose:n}}var RJ=class extends Q_{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=mf,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},TDe=class extends Q_{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new q,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},CDe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ADe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function MDe(e,t,i){let r=new oB,n=new Ie,s=new Ie,a=new Pi,o=new RJ({depthPacking:yJ}),l=new TDe,u={},c=i.maxTextureSize,h={[Mc]:wa,[wa]:Mc,[po]:po},d=new Cr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ie},radius:{value:4}},vertexShader:CDe,fragmentShader:ADe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let m=new ai;m.setAttribute("position",new gi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let g=new dn(m,d),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=tB,this.render=function(C,A,E){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||C.length===0)return;let _=e.getRenderTarget(),P=e.getActiveCubeFace(),I=e.getActiveMipmapLevel(),D=e.state;D.setBlending(Rs),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);for(let k=0,B=C.length;k<B;k++){let z=C[k],W=z.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;n.copy(W.mapSize);let $=W.getFrameExtents();if(n.multiply($),s.copy(W.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(s.x=Math.floor(c/$.x),n.x=s.x*$.x,W.mapSize.x=s.x),n.y>c&&(s.y=Math.floor(c/$.y),n.y=s.y*$.y,W.mapSize.y=s.y)),W.map===null){let G=this.type!==Vx?{minFilter:ur,magFilter:ur}:{};W.map=new Tr(n.x,n.y,G),W.map.texture.name=z.name+".shadowMap",W.camera.updateProjectionMatrix()}e.setRenderTarget(W.map),e.clear();let Z=W.getViewportCount();for(let G=0;G<Z;G++){let V=W.getViewport(G);a.set(s.x*V.x,s.y*V.y,s.x*V.z,s.y*V.w),D.viewport(a),W.updateMatrices(z,G),r=W.getFrustum(),b(A,E,W.camera,z,this.type)}W.isPointLightShadow!==!0&&this.type===Vx&&x(W,E),W.needsUpdate=!1}y.needsUpdate=!1,e.setRenderTarget(_,P,I)};function x(C,A){let E=t.update(g);d.defines.VSM_SAMPLES!==C.blurSamples&&(d.defines.VSM_SAMPLES=C.blurSamples,f.defines.VSM_SAMPLES=C.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),C.mapPass===null&&(C.mapPass=new Tr(n.x,n.y)),d.uniforms.shadow_pass.value=C.map.texture,d.uniforms.resolution.value=C.mapSize,d.uniforms.radius.value=C.radius,e.setRenderTarget(C.mapPass),e.clear(),e.renderBufferDirect(A,null,E,d,g,null),f.uniforms.shadow_pass.value=C.mapPass.texture,f.uniforms.resolution.value=C.mapSize,f.uniforms.radius.value=C.radius,e.setRenderTarget(C.map),e.clear(),e.renderBufferDirect(A,null,E,f,g,null)}function w(C,A,E,_,P,I){let D=null,k=E.isPointLight===!0?C.customDistanceMaterial:C.customDepthMaterial;if(k!==void 0)D=k;else if(D=E.isPointLight===!0?l:o,e.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){let B=D.uuid,z=A.uuid,W=u[B];W===void 0&&(W={},u[B]=W);let $=W[z];$===void 0&&($=D.clone(),W[z]=$),D=$}return D.visible=A.visible,D.wireframe=A.wireframe,I===Vx?D.side=A.shadowSide!==null?A.shadowSide:A.side:D.side=A.shadowSide!==null?A.shadowSide:h[A.side],D.alphaMap=A.alphaMap,D.alphaTest=A.alphaTest,D.map=A.map,D.clipShadows=A.clipShadows,D.clippingPlanes=A.clippingPlanes,D.clipIntersection=A.clipIntersection,D.displacementMap=A.displacementMap,D.displacementScale=A.displacementScale,D.displacementBias=A.displacementBias,D.wireframeLinewidth=A.wireframeLinewidth,D.linewidth=A.linewidth,E.isPointLight===!0&&D.isMeshDistanceMaterial===!0&&(D.referencePosition.setFromMatrixPosition(E.matrixWorld),D.nearDistance=_,D.farDistance=P),D}function b(C,A,E,_,P){if(C.visible===!1)return;if(C.layers.test(A.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&P===Vx)&&(!C.frustumCulled||r.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,C.matrixWorld);let D=t.update(C),k=C.material;if(Array.isArray(k)){let B=D.groups;for(let z=0,W=B.length;z<W;z++){let $=B[z],Z=k[$.materialIndex];if(Z&&Z.visible){let G=w(C,Z,_,E.near,E.far,P);e.renderBufferDirect(E,null,D,G,C,$)}}}else if(k.visible){let B=w(C,k,_,E.near,E.far,P);e.renderBufferDirect(E,null,D,B,C,null)}}let I=C.children;for(let D=0,k=I.length;D<k;D++)b(I[D],A,E,_,P)}}function PDe(e,t,i){let r=i.isWebGL2;function n(){let Ue=!1,dt=new Pi,gt=null,Bt=new Pi(0,0,0,0);return{setMask:function(ei){gt!==ei&&!Ue&&(e.colorMask(ei,ei,ei,ei),gt=ei)},setLocked:function(ei){Ue=ei},setClear:function(ei,zi,vi,Yi,wn){wn===!0&&(ei*=Yi,zi*=Yi,vi*=Yi),dt.set(ei,zi,vi,Yi),Bt.equals(dt)===!1&&(e.clearColor(ei,zi,vi,Yi),Bt.copy(dt))},reset:function(){Ue=!1,gt=null,Bt.set(-1,0,0,0)}}}function s(){let Ue=!1,dt=null,gt=null,Bt=null;return{setTest:function(ei){ei?De(2929):we(2929)},setMask:function(ei){dt!==ei&&!Ue&&(e.depthMask(ei),dt=ei)},setFunc:function(ei){if(gt!==ei){switch(ei){case $Te:e.depthFunc(512);break;case ZTe:e.depthFunc(519);break;case QTe:e.depthFunc(513);break;case M3:e.depthFunc(515);break;case JTe:e.depthFunc(514);break;case eCe:e.depthFunc(518);break;case tCe:e.depthFunc(516);break;case iCe:e.depthFunc(517);break;default:e.depthFunc(515)}gt=ei}},setLocked:function(ei){Ue=ei},setClear:function(ei){Bt!==ei&&(e.clearDepth(ei),Bt=ei)},reset:function(){Ue=!1,dt=null,gt=null,Bt=null}}}function a(){let Ue=!1,dt=null,gt=null,Bt=null,ei=null,zi=null,vi=null,Yi=null,wn=null;return{setTest:function(yr){Ue||(yr?De(2960):we(2960))},setMask:function(yr){dt!==yr&&!Ue&&(e.stencilMask(yr),dt=yr)},setFunc:function(yr,Rn,Yr){(gt!==yr||Bt!==Rn||ei!==Yr)&&(e.stencilFunc(yr,Rn,Yr),gt=yr,Bt=Rn,ei=Yr)},setOp:function(yr,Rn,Yr){(zi!==yr||vi!==Rn||Yi!==Yr)&&(e.stencilOp(yr,Rn,Yr),zi=yr,vi=Rn,Yi=Yr)},setLocked:function(yr){Ue=yr},setClear:function(yr){wn!==yr&&(e.clearStencil(yr),wn=yr)},reset:function(){Ue=!1,dt=null,gt=null,Bt=null,ei=null,zi=null,vi=null,Yi=null,wn=null}}}let o=new n,l=new s,u=new a,c=new WeakMap,h=new WeakMap,d={},f={},m=new WeakMap,g=[],y=null,x=!1,w=null,b=null,C=null,A=null,E=null,_=null,P=null,I=!1,D=null,k=null,B=null,z=null,W=null,$=e.getParameter(35661),Z=!1,G=0,V=e.getParameter(7938);V.indexOf("WebGL")!==-1?(G=parseFloat(/^WebGL (\d)/.exec(V)[1]),Z=G>=1):V.indexOf("OpenGL ES")!==-1&&(G=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),Z=G>=2);let J=null,U={},ie=e.getParameter(3088),se=e.getParameter(2978),ee=new Pi().fromArray(ie),ve=new Pi().fromArray(se);function _e(Ue,dt,gt){let Bt=new Uint8Array(4),ei=e.createTexture();e.bindTexture(Ue,ei),e.texParameteri(Ue,10241,9728),e.texParameteri(Ue,10240,9728);for(let zi=0;zi<gt;zi++)e.texImage2D(dt+zi,0,6408,1,1,0,6408,5121,Bt);return ei}let he={};he[3553]=_e(3553,3553,1),he[34067]=_e(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),u.setClear(0),De(2929),l.setFunc(M3),_t(!1),St(dV),De(2884),Ze(Rs);function De(Ue){d[Ue]!==!0&&(e.enable(Ue),d[Ue]=!0)}function we(Ue){d[Ue]!==!1&&(e.disable(Ue),d[Ue]=!1)}function Le(Ue,dt){return f[Ue]!==dt?(e.bindFramebuffer(Ue,dt),f[Ue]=dt,r&&(Ue===36009&&(f[36160]=dt),Ue===36160&&(f[36009]=dt)),!0):!1}function Te(Ue,dt){let gt=g,Bt=!1;if(Ue)if(gt=m.get(dt),gt===void 0&&(gt=[],m.set(dt,gt)),Ue.isWebGLMultipleRenderTargets){let ei=Ue.texture;if(gt.length!==ei.length||gt[0]!==36064){for(let zi=0,vi=ei.length;zi<vi;zi++)gt[zi]=36064+zi;gt.length=ei.length,Bt=!0}}else gt[0]!==36064&&(gt[0]=36064,Bt=!0);else gt[0]!==1029&&(gt[0]=1029,Bt=!0);Bt&&(i.isWebGL2?e.drawBuffers(gt):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(gt))}function ke(Ue){return y!==Ue?(e.useProgram(Ue),y=Ue,!0):!1}let Xe={[m0]:32774,[FTe]:32778,[UTe]:32779};if(r)Xe[gV]=32775,Xe[vV]=32776;else{let Ue=t.get("EXT_blend_minmax");Ue!==null&&(Xe[gV]=Ue.MIN_EXT,Xe[vV]=Ue.MAX_EXT)}let et={[jTe]:0,[VTe]:1,[HTe]:768,[cJ]:770,[KTe]:776,[YTe]:774,[GTe]:772,[WTe]:769,[hJ]:771,[XTe]:775,[qTe]:773};function Ze(Ue,dt,gt,Bt,ei,zi,vi,Yi){if(Ue===Rs){x===!0&&(we(3042),x=!1);return}if(x===!1&&(De(3042),x=!0),Ue!==zTe){if(Ue!==w||Yi!==I){if((b!==m0||E!==m0)&&(e.blendEquation(32774),b=m0,E=m0),Yi)switch(Ue){case Dg:e.blendFuncSeparate(1,771,1,771);break;case fV:e.blendFunc(1,1);break;case pV:e.blendFuncSeparate(0,769,0,1);break;case mV:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ue);break}else switch(Ue){case Dg:e.blendFuncSeparate(770,771,1,771);break;case fV:e.blendFunc(770,1);break;case pV:e.blendFuncSeparate(0,769,0,1);break;case mV:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ue);break}C=null,A=null,_=null,P=null,w=Ue,I=Yi}return}ei=ei||dt,zi=zi||gt,vi=vi||Bt,(dt!==b||ei!==E)&&(e.blendEquationSeparate(Xe[dt],Xe[ei]),b=dt,E=ei),(gt!==C||Bt!==A||zi!==_||vi!==P)&&(e.blendFuncSeparate(et[gt],et[Bt],et[zi],et[vi]),C=gt,A=Bt,_=zi,P=vi),w=Ue,I=!1}function st(Ue,dt){Ue.side===po?we(2884):De(2884);let gt=Ue.side===wa;dt&&(gt=!gt),_t(gt),Ue.blending===Dg&&Ue.transparent===!1?Ze(Rs):Ze(Ue.blending,Ue.blendEquation,Ue.blendSrc,Ue.blendDst,Ue.blendEquationAlpha,Ue.blendSrcAlpha,Ue.blendDstAlpha,Ue.premultipliedAlpha),l.setFunc(Ue.depthFunc),l.setTest(Ue.depthTest),l.setMask(Ue.depthWrite),o.setMask(Ue.colorWrite);let Bt=Ue.stencilWrite;u.setTest(Bt),Bt&&(u.setMask(Ue.stencilWriteMask),u.setFunc(Ue.stencilFunc,Ue.stencilRef,Ue.stencilFuncMask),u.setOp(Ue.stencilFail,Ue.stencilZFail,Ue.stencilZPass)),Ee(Ue.polygonOffset,Ue.polygonOffsetFactor,Ue.polygonOffsetUnits),Ue.alphaToCoverage===!0?De(32926):we(32926)}function _t(Ue){D!==Ue&&(Ue?e.frontFace(2304):e.frontFace(2305),D=Ue)}function St(Ue){Ue!==NTe?(De(2884),Ue!==k&&(Ue===dV?e.cullFace(1029):Ue===kTe?e.cullFace(1028):e.cullFace(1032))):we(2884),k=Ue}function ue(Ue){Ue!==B&&(Z&&e.lineWidth(Ue),B=Ue)}function Ee(Ue,dt,gt){Ue?(De(32823),(z!==dt||W!==gt)&&(e.polygonOffset(dt,gt),z=dt,W=gt)):we(32823)}function Ae(Ue){Ue?De(3089):we(3089)}function Ge(Ue){Ue===void 0&&(Ue=33984+$-1),J!==Ue&&(e.activeTexture(Ue),J=Ue)}function ae(Ue,dt,gt){gt===void 0&&(J===null?gt=33984+$-1:gt=J);let Bt=U[gt];Bt===void 0&&(Bt={type:void 0,texture:void 0},U[gt]=Bt),(Bt.type!==Ue||Bt.texture!==dt)&&(J!==gt&&(e.activeTexture(gt),J=gt),e.bindTexture(Ue,dt||he[Ue]),Bt.type=Ue,Bt.texture=dt)}function te(){let Ue=U[J];Ue!==void 0&&Ue.type!==void 0&&(e.bindTexture(Ue.type,null),Ue.type=void 0,Ue.texture=void 0)}function Ne(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function Re(){try{e.compressedTexImage3D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function Y(){try{e.texSubImage2D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function Me(){try{e.texSubImage3D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function Ke(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function ot(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function qe(){try{e.texStorage2D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function It(){try{e.texStorage3D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function Ot(){try{e.texImage2D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function Dt(){try{e.texImage3D.apply(e,arguments)}catch(Ue){console.error("THREE.WebGLState:",Ue)}}function kt(Ue){ee.equals(Ue)===!1&&(e.scissor(Ue.x,Ue.y,Ue.z,Ue.w),ee.copy(Ue))}function Qe(Ue){ve.equals(Ue)===!1&&(e.viewport(Ue.x,Ue.y,Ue.z,Ue.w),ve.copy(Ue))}function mt(Ue,dt){let gt=h.get(dt);gt===void 0&&(gt=new WeakMap,h.set(dt,gt));let Bt=gt.get(Ue);Bt===void 0&&(Bt=e.getUniformBlockIndex(dt,Ue.name),gt.set(Ue,Bt))}function Ht(Ue,dt){let gt=h.get(dt).get(Ue);c.get(dt)!==gt&&(e.uniformBlockBinding(dt,gt,Ue.__bindingPointIndex),c.set(dt,gt))}function Wt(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),r===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},J=null,U={},f={},m=new WeakMap,g=[],y=null,x=!1,w=null,b=null,C=null,A=null,E=null,_=null,P=null,I=!1,D=null,k=null,B=null,z=null,W=null,ee.set(0,0,e.canvas.width,e.canvas.height),ve.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),u.reset()}return{buffers:{color:o,depth:l,stencil:u},enable:De,disable:we,bindFramebuffer:Le,drawBuffers:Te,useProgram:ke,setBlending:Ze,setMaterial:st,setFlipSided:_t,setCullFace:St,setLineWidth:ue,setPolygonOffset:Ee,setScissorTest:Ae,activeTexture:Ge,bindTexture:ae,unbindTexture:te,compressedTexImage2D:Ne,compressedTexImage3D:Re,texImage2D:Ot,texImage3D:Dt,updateUBOMapping:mt,uniformBlockBinding:Ht,texStorage2D:qe,texStorage3D:It,texSubImage2D:Y,texSubImage3D:Me,compressedTexSubImage2D:Ke,compressedTexSubImage3D:ot,scissor:kt,viewport:Qe,reset:Wt}}function DDe(e,t,i,r,n,s,a){let o=n.isWebGL2,l=n.maxTextures,u=n.maxCubemapSize,c=n.maxTextureSize,h=n.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,g,y=new WeakMap,x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(ae,te){return x?new OffscreenCanvas(ae,te):a_("canvas")}function b(ae,te,Ne,Re){let Y=1;if((ae.width>Re||ae.height>Re)&&(Y=Re/Math.max(ae.width,ae.height)),Y<1||te===!0)if(typeof HTMLImageElement<"u"&&ae instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ae instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ae instanceof ImageBitmap){let Me=te?OC:Math.floor,Ke=Me(Y*ae.width),ot=Me(Y*ae.height);g===void 0&&(g=w(Ke,ot));let qe=Ne?w(Ke,ot):g;return qe.width=Ke,qe.height=ot,qe.getContext("2d").drawImage(ae,0,0,Ke,ot),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ae.width+"x"+ae.height+") to ("+Ke+"x"+ot+")."),qe}else return"data"in ae&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ae.width+"x"+ae.height+")."),ae;return ae}function C(ae){return N3(ae.width)&&N3(ae.height)}function A(ae){return o?!1:ae.wrapS!==Mn||ae.wrapT!==Mn||ae.minFilter!==ur&&ae.minFilter!==Ji}function E(ae,te){return ae.generateMipmaps&&te&&ae.minFilter!==ur&&ae.minFilter!==Ji}function _(ae){e.generateMipmap(ae)}function P(ae,te,Ne,Re,Y=!1){if(o===!1)return te;if(ae!==null){if(e[ae]!==void 0)return e[ae];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ae+"'")}let Me=te;return te===6403&&(Ne===5126&&(Me=33326),Ne===5131&&(Me=33325),Ne===5121&&(Me=33321)),te===33319&&(Ne===5126&&(Me=33328),Ne===5131&&(Me=33327),Ne===5121&&(Me=33323)),te===6408&&(Ne===5126&&(Me=34836),Ne===5131&&(Me=34842),Ne===5121&&(Me=Re===$i&&Y===!1?35907:32856),Ne===32819&&(Me=32854),Ne===32820&&(Me=32855)),(Me===33325||Me===33326||Me===33327||Me===33328||Me===34842||Me===34836)&&t.get("EXT_color_buffer_float"),Me}function I(ae,te,Ne){return E(ae,Ne)===!0||ae.isFramebufferTexture&&ae.minFilter!==ur&&ae.minFilter!==Ji?Math.log2(Math.max(te.width,te.height))+1:ae.mipmaps!==void 0&&ae.mipmaps.length>0?ae.mipmaps.length:ae.isCompressedTexture&&Array.isArray(ae.image)?te.mipmaps.length:1}function D(ae){return ae===ur||ae===yV||ae===gD?9728:9729}function k(ae){let te=ae.target;te.removeEventListener("dispose",k),z(te),te.isVideoTexture&&m.delete(te)}function B(ae){let te=ae.target;te.removeEventListener("dispose",B),$(te)}function z(ae){let te=r.get(ae);if(te.__webglInit===void 0)return;let Ne=ae.source,Re=y.get(Ne);if(Re){let Y=Re[te.__cacheKey];Y.usedTimes--,Y.usedTimes===0&&W(ae),Object.keys(Re).length===0&&y.delete(Ne)}r.remove(ae)}function W(ae){let te=r.get(ae);e.deleteTexture(te.__webglTexture);let Ne=ae.source,Re=y.get(Ne);delete Re[te.__cacheKey],a.memory.textures--}function $(ae){let te=ae.texture,Ne=r.get(ae),Re=r.get(te);if(Re.__webglTexture!==void 0&&(e.deleteTexture(Re.__webglTexture),a.memory.textures--),ae.depthTexture&&ae.depthTexture.dispose(),ae.isWebGLCubeRenderTarget)for(let Y=0;Y<6;Y++)e.deleteFramebuffer(Ne.__webglFramebuffer[Y]),Ne.__webglDepthbuffer&&e.deleteRenderbuffer(Ne.__webglDepthbuffer[Y]);else{if(e.deleteFramebuffer(Ne.__webglFramebuffer),Ne.__webglDepthbuffer&&e.deleteRenderbuffer(Ne.__webglDepthbuffer),Ne.__webglMultisampledFramebuffer&&e.deleteFramebuffer(Ne.__webglMultisampledFramebuffer),Ne.__webglColorRenderbuffer)for(let Y=0;Y<Ne.__webglColorRenderbuffer.length;Y++)Ne.__webglColorRenderbuffer[Y]&&e.deleteRenderbuffer(Ne.__webglColorRenderbuffer[Y]);Ne.__webglDepthRenderbuffer&&e.deleteRenderbuffer(Ne.__webglDepthRenderbuffer)}if(ae.isWebGLMultipleRenderTargets)for(let Y=0,Me=te.length;Y<Me;Y++){let Ke=r.get(te[Y]);Ke.__webglTexture&&(e.deleteTexture(Ke.__webglTexture),a.memory.textures--),r.remove(te[Y])}r.remove(te),r.remove(ae)}let Z=0;function G(){Z=0}function V(){let ae=Z;return ae>=l&&console.warn("THREE.WebGLTextures: Trying to use "+ae+" texture units while this GPU supports only "+l),Z+=1,ae}function J(ae){let te=[];return te.push(ae.wrapS),te.push(ae.wrapT),te.push(ae.wrapR||0),te.push(ae.magFilter),te.push(ae.minFilter),te.push(ae.anisotropy),te.push(ae.internalFormat),te.push(ae.format),te.push(ae.type),te.push(ae.generateMipmaps),te.push(ae.premultiplyAlpha),te.push(ae.flipY),te.push(ae.unpackAlignment),te.push(ae.encoding),te.join()}function U(ae,te){let Ne=r.get(ae);if(ae.isVideoTexture&&Ae(ae),ae.isRenderTargetTexture===!1&&ae.version>0&&Ne.__version!==ae.version){let Re=ae.image;if(Re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{we(Ne,ae,te);return}}i.bindTexture(3553,Ne.__webglTexture,33984+te)}function ie(ae,te){let Ne=r.get(ae);if(ae.version>0&&Ne.__version!==ae.version){we(Ne,ae,te);return}i.bindTexture(35866,Ne.__webglTexture,33984+te)}function se(ae,te){let Ne=r.get(ae);if(ae.version>0&&Ne.__version!==ae.version){we(Ne,ae,te);return}i.bindTexture(32879,Ne.__webglTexture,33984+te)}function ee(ae,te){let Ne=r.get(ae);if(ae.version>0&&Ne.__version!==ae.version){Le(Ne,ae,te);return}i.bindTexture(34067,Ne.__webglTexture,33984+te)}let ve={[Gd]:10497,[Mn]:33071,[I3]:33648},_e={[ur]:9728,[yV]:9984,[gD]:9986,[Ji]:9729,[cCe]:9985,[Dy]:9987};function he(ae,te,Ne){if(Ne?(e.texParameteri(ae,10242,ve[te.wrapS]),e.texParameteri(ae,10243,ve[te.wrapT]),(ae===32879||ae===35866)&&e.texParameteri(ae,32882,ve[te.wrapR]),e.texParameteri(ae,10240,_e[te.magFilter]),e.texParameteri(ae,10241,_e[te.minFilter])):(e.texParameteri(ae,10242,33071),e.texParameteri(ae,10243,33071),(ae===32879||ae===35866)&&e.texParameteri(ae,32882,33071),(te.wrapS!==Mn||te.wrapT!==Mn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(ae,10240,D(te.magFilter)),e.texParameteri(ae,10241,D(te.minFilter)),te.minFilter!==ur&&te.minFilter!==Ji&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let Re=t.get("EXT_texture_filter_anisotropic");if(te.magFilter===ur||te.minFilter!==gD&&te.minFilter!==Dy||te.type===$r&&t.has("OES_texture_float_linear")===!1||o===!1&&te.type===lf&&t.has("OES_texture_half_float_linear")===!1)return;(te.anisotropy>1||r.get(te).__currentAnisotropy)&&(e.texParameterf(ae,Re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(te.anisotropy,n.getMaxAnisotropy())),r.get(te).__currentAnisotropy=te.anisotropy)}}function De(ae,te){let Ne=!1;ae.__webglInit===void 0&&(ae.__webglInit=!0,te.addEventListener("dispose",k));let Re=te.source,Y=y.get(Re);Y===void 0&&(Y={},y.set(Re,Y));let Me=J(te);if(Me!==ae.__cacheKey){Y[Me]===void 0&&(Y[Me]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,Ne=!0),Y[Me].usedTimes++;let Ke=Y[ae.__cacheKey];Ke!==void 0&&(Y[ae.__cacheKey].usedTimes--,Ke.usedTimes===0&&W(te)),ae.__cacheKey=Me,ae.__webglTexture=Y[Me].texture}return Ne}function we(ae,te,Ne){let Re=3553;(te.isDataArrayTexture||te.isCompressedArrayTexture)&&(Re=35866),te.isData3DTexture&&(Re=32879);let Y=De(ae,te),Me=te.source;i.bindTexture(Re,ae.__webglTexture,33984+Ne);let Ke=r.get(Me);if(Me.version!==Ke.__version||Y===!0){i.activeTexture(33984+Ne),e.pixelStorei(37440,te.flipY),e.pixelStorei(37441,te.premultiplyAlpha),e.pixelStorei(3317,te.unpackAlignment),e.pixelStorei(37443,0);let ot=A(te)&&C(te.image)===!1,qe=b(te.image,ot,!1,c);qe=Ge(te,qe);let It=C(qe)||o,Ot=s.convert(te.format,te.encoding),Dt=s.convert(te.type),kt=P(te.internalFormat,Ot,Dt,te.encoding,te.isVideoTexture);he(Re,te,It);let Qe,mt=te.mipmaps,Ht=o&&te.isVideoTexture!==!0,Wt=Ke.__version===void 0||Y===!0,Ue=I(te,qe,It);if(te.isDepthTexture)kt=6402,o?te.type===$r?kt=36012:te.type===qd?kt=33190:te.type===Ig?kt=35056:kt=33189:te.type===$r&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),te.format===Og&&kt===6402&&te.type!==pJ&&te.type!==qd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),te.type=qd,Dt=s.convert(te.type)),te.format===Yg&&kt===6402&&(kt=34041,te.type!==Ig&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),te.type=Ig,Dt=s.convert(te.type))),Wt&&(Ht?i.texStorage2D(3553,1,kt,qe.width,qe.height):i.texImage2D(3553,0,kt,qe.width,qe.height,0,Ot,Dt,null));else if(te.isDataTexture)if(mt.length>0&&It){Ht&&Wt&&i.texStorage2D(3553,Ue,kt,mt[0].width,mt[0].height);for(let dt=0,gt=mt.length;dt<gt;dt++)Qe=mt[dt],Ht?i.texSubImage2D(3553,dt,0,0,Qe.width,Qe.height,Ot,Dt,Qe.data):i.texImage2D(3553,dt,kt,Qe.width,Qe.height,0,Ot,Dt,Qe.data);te.generateMipmaps=!1}else Ht?(Wt&&i.texStorage2D(3553,Ue,kt,qe.width,qe.height),i.texSubImage2D(3553,0,0,0,qe.width,qe.height,Ot,Dt,qe.data)):i.texImage2D(3553,0,kt,qe.width,qe.height,0,Ot,Dt,qe.data);else if(te.isCompressedTexture)if(te.isCompressedArrayTexture){Ht&&Wt&&i.texStorage3D(35866,Ue,kt,mt[0].width,mt[0].height,qe.depth);for(let dt=0,gt=mt.length;dt<gt;dt++)Qe=mt[dt],te.format!==On?Ot!==null?Ht?i.compressedTexSubImage3D(35866,dt,0,0,0,Qe.width,Qe.height,qe.depth,Ot,Qe.data,0,0):i.compressedTexImage3D(35866,dt,kt,Qe.width,Qe.height,qe.depth,0,Qe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ht?i.texSubImage3D(35866,dt,0,0,0,Qe.width,Qe.height,qe.depth,Ot,Dt,Qe.data):i.texImage3D(35866,dt,kt,Qe.width,Qe.height,qe.depth,0,Ot,Dt,Qe.data)}else{Ht&&Wt&&i.texStorage2D(3553,Ue,kt,mt[0].width,mt[0].height);for(let dt=0,gt=mt.length;dt<gt;dt++)Qe=mt[dt],te.format!==On?Ot!==null?Ht?i.compressedTexSubImage2D(3553,dt,0,0,Qe.width,Qe.height,Ot,Qe.data):i.compressedTexImage2D(3553,dt,kt,Qe.width,Qe.height,0,Qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ht?i.texSubImage2D(3553,dt,0,0,Qe.width,Qe.height,Ot,Dt,Qe.data):i.texImage2D(3553,dt,kt,Qe.width,Qe.height,0,Ot,Dt,Qe.data)}else if(te.isDataArrayTexture)Ht?(Wt&&i.texStorage3D(35866,Ue,kt,qe.width,qe.height,qe.depth),i.texSubImage3D(35866,0,0,0,0,qe.width,qe.height,qe.depth,Ot,Dt,qe.data)):i.texImage3D(35866,0,kt,qe.width,qe.height,qe.depth,0,Ot,Dt,qe.data);else if(te.isData3DTexture)Ht?(Wt&&i.texStorage3D(32879,Ue,kt,qe.width,qe.height,qe.depth),i.texSubImage3D(32879,0,0,0,0,qe.width,qe.height,qe.depth,Ot,Dt,qe.data)):i.texImage3D(32879,0,kt,qe.width,qe.height,qe.depth,0,Ot,Dt,qe.data);else if(te.isFramebufferTexture){if(Wt)if(Ht)i.texStorage2D(3553,Ue,kt,qe.width,qe.height);else{let dt=qe.width,gt=qe.height;for(let Bt=0;Bt<Ue;Bt++)i.texImage2D(3553,Bt,kt,dt,gt,0,Ot,Dt,null),dt>>=1,gt>>=1}}else if(mt.length>0&&It){Ht&&Wt&&i.texStorage2D(3553,Ue,kt,mt[0].width,mt[0].height);for(let dt=0,gt=mt.length;dt<gt;dt++)Qe=mt[dt],Ht?i.texSubImage2D(3553,dt,0,0,Ot,Dt,Qe):i.texImage2D(3553,dt,kt,Ot,Dt,Qe);te.generateMipmaps=!1}else Ht?(Wt&&i.texStorage2D(3553,Ue,kt,qe.width,qe.height),i.texSubImage2D(3553,0,0,0,Ot,Dt,qe)):i.texImage2D(3553,0,kt,Ot,Dt,qe);E(te,It)&&_(Re),Ke.__version=Me.version,te.onUpdate&&te.onUpdate(te)}ae.__version=te.version}function Le(ae,te,Ne){if(te.image.length!==6)return;let Re=De(ae,te),Y=te.source;i.bindTexture(34067,ae.__webglTexture,33984+Ne);let Me=r.get(Y);if(Y.version!==Me.__version||Re===!0){i.activeTexture(33984+Ne),e.pixelStorei(37440,te.flipY),e.pixelStorei(37441,te.premultiplyAlpha),e.pixelStorei(3317,te.unpackAlignment),e.pixelStorei(37443,0);let Ke=te.isCompressedTexture||te.image[0].isCompressedTexture,ot=te.image[0]&&te.image[0].isDataTexture,qe=[];for(let dt=0;dt<6;dt++)!Ke&&!ot?qe[dt]=b(te.image[dt],!1,!0,u):qe[dt]=ot?te.image[dt].image:te.image[dt],qe[dt]=Ge(te,qe[dt]);let It=qe[0],Ot=C(It)||o,Dt=s.convert(te.format,te.encoding),kt=s.convert(te.type),Qe=P(te.internalFormat,Dt,kt,te.encoding),mt=o&&te.isVideoTexture!==!0,Ht=Me.__version===void 0||Re===!0,Wt=I(te,It,Ot);he(34067,te,Ot);let Ue;if(Ke){mt&&Ht&&i.texStorage2D(34067,Wt,Qe,It.width,It.height);for(let dt=0;dt<6;dt++){Ue=qe[dt].mipmaps;for(let gt=0;gt<Ue.length;gt++){let Bt=Ue[gt];te.format!==On?Dt!==null?mt?i.compressedTexSubImage2D(34069+dt,gt,0,0,Bt.width,Bt.height,Dt,Bt.data):i.compressedTexImage2D(34069+dt,gt,Qe,Bt.width,Bt.height,0,Bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):mt?i.texSubImage2D(34069+dt,gt,0,0,Bt.width,Bt.height,Dt,kt,Bt.data):i.texImage2D(34069+dt,gt,Qe,Bt.width,Bt.height,0,Dt,kt,Bt.data)}}}else{Ue=te.mipmaps,mt&&Ht&&(Ue.length>0&&Wt++,i.texStorage2D(34067,Wt,Qe,qe[0].width,qe[0].height));for(let dt=0;dt<6;dt++)if(ot){mt?i.texSubImage2D(34069+dt,0,0,0,qe[dt].width,qe[dt].height,Dt,kt,qe[dt].data):i.texImage2D(34069+dt,0,Qe,qe[dt].width,qe[dt].height,0,Dt,kt,qe[dt].data);for(let gt=0;gt<Ue.length;gt++){let Bt=Ue[gt].image[dt].image;mt?i.texSubImage2D(34069+dt,gt+1,0,0,Bt.width,Bt.height,Dt,kt,Bt.data):i.texImage2D(34069+dt,gt+1,Qe,Bt.width,Bt.height,0,Dt,kt,Bt.data)}}else{mt?i.texSubImage2D(34069+dt,0,0,0,Dt,kt,qe[dt]):i.texImage2D(34069+dt,0,Qe,Dt,kt,qe[dt]);for(let gt=0;gt<Ue.length;gt++){let Bt=Ue[gt];mt?i.texSubImage2D(34069+dt,gt+1,0,0,Dt,kt,Bt.image[dt]):i.texImage2D(34069+dt,gt+1,Qe,Dt,kt,Bt.image[dt])}}}E(te,Ot)&&_(34067),Me.__version=Y.version,te.onUpdate&&te.onUpdate(te)}ae.__version=te.version}function Te(ae,te,Ne,Re,Y){let Me=s.convert(Ne.format,Ne.encoding),Ke=s.convert(Ne.type),ot=P(Ne.internalFormat,Me,Ke,Ne.encoding);r.get(te).__hasExternalTextures||(Y===32879||Y===35866?i.texImage3D(Y,0,ot,te.width,te.height,te.depth,0,Me,Ke,null):i.texImage2D(Y,0,ot,te.width,te.height,0,Me,Ke,null)),i.bindFramebuffer(36160,ae),Ee(te)?d.framebufferTexture2DMultisampleEXT(36160,Re,Y,r.get(Ne).__webglTexture,0,ue(te)):(Y===3553||Y>=34069&&Y<=34074)&&e.framebufferTexture2D(36160,Re,Y,r.get(Ne).__webglTexture,0),i.bindFramebuffer(36160,null)}function ke(ae,te,Ne){if(e.bindRenderbuffer(36161,ae),te.depthBuffer&&!te.stencilBuffer){let Re=33189;if(Ne||Ee(te)){let Y=te.depthTexture;Y&&Y.isDepthTexture&&(Y.type===$r?Re=36012:Y.type===qd&&(Re=33190));let Me=ue(te);Ee(te)?d.renderbufferStorageMultisampleEXT(36161,Me,Re,te.width,te.height):e.renderbufferStorageMultisample(36161,Me,Re,te.width,te.height)}else e.renderbufferStorage(36161,Re,te.width,te.height);e.framebufferRenderbuffer(36160,36096,36161,ae)}else if(te.depthBuffer&&te.stencilBuffer){let Re=ue(te);Ne&&Ee(te)===!1?e.renderbufferStorageMultisample(36161,Re,35056,te.width,te.height):Ee(te)?d.renderbufferStorageMultisampleEXT(36161,Re,35056,te.width,te.height):e.renderbufferStorage(36161,34041,te.width,te.height),e.framebufferRenderbuffer(36160,33306,36161,ae)}else{let Re=te.isWebGLMultipleRenderTargets===!0?te.texture:[te.texture];for(let Y=0;Y<Re.length;Y++){let Me=Re[Y],Ke=s.convert(Me.format,Me.encoding),ot=s.convert(Me.type),qe=P(Me.internalFormat,Ke,ot,Me.encoding),It=ue(te);Ne&&Ee(te)===!1?e.renderbufferStorageMultisample(36161,It,qe,te.width,te.height):Ee(te)?d.renderbufferStorageMultisampleEXT(36161,It,qe,te.width,te.height):e.renderbufferStorage(36161,qe,te.width,te.height)}}e.bindRenderbuffer(36161,null)}function Xe(ae,te){if(te&&te.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,ae),!(te.depthTexture&&te.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(te.depthTexture).__webglTexture||te.depthTexture.image.width!==te.width||te.depthTexture.image.height!==te.height)&&(te.depthTexture.image.width=te.width,te.depthTexture.image.height=te.height,te.depthTexture.needsUpdate=!0),U(te.depthTexture,0);let Ne=r.get(te.depthTexture).__webglTexture,Re=ue(te);if(te.depthTexture.format===Og)Ee(te)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,Ne,0,Re):e.framebufferTexture2D(36160,36096,3553,Ne,0);else if(te.depthTexture.format===Yg)Ee(te)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,Ne,0,Re):e.framebufferTexture2D(36160,33306,3553,Ne,0);else throw new Error("Unknown depthTexture format")}function et(ae){let te=r.get(ae),Ne=ae.isWebGLCubeRenderTarget===!0;if(ae.depthTexture&&!te.__autoAllocateDepthBuffer){if(Ne)throw new Error("target.depthTexture not supported in Cube render targets");Xe(te.__webglFramebuffer,ae)}else if(Ne){te.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)i.bindFramebuffer(36160,te.__webglFramebuffer[Re]),te.__webglDepthbuffer[Re]=e.createRenderbuffer(),ke(te.__webglDepthbuffer[Re],ae,!1)}else i.bindFramebuffer(36160,te.__webglFramebuffer),te.__webglDepthbuffer=e.createRenderbuffer(),ke(te.__webglDepthbuffer,ae,!1);i.bindFramebuffer(36160,null)}function Ze(ae,te,Ne){let Re=r.get(ae);te!==void 0&&Te(Re.__webglFramebuffer,ae,ae.texture,36064,3553),Ne!==void 0&&et(ae)}function st(ae){let te=ae.texture,Ne=r.get(ae),Re=r.get(te);ae.addEventListener("dispose",B),ae.isWebGLMultipleRenderTargets!==!0&&(Re.__webglTexture===void 0&&(Re.__webglTexture=e.createTexture()),Re.__version=te.version,a.memory.textures++);let Y=ae.isWebGLCubeRenderTarget===!0,Me=ae.isWebGLMultipleRenderTargets===!0,Ke=C(ae)||o;if(Y){Ne.__webglFramebuffer=[];for(let ot=0;ot<6;ot++)Ne.__webglFramebuffer[ot]=e.createFramebuffer()}else{if(Ne.__webglFramebuffer=e.createFramebuffer(),Me)if(n.drawBuffers){let ot=ae.texture;for(let qe=0,It=ot.length;qe<It;qe++){let Ot=r.get(ot[qe]);Ot.__webglTexture===void 0&&(Ot.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&ae.samples>0&&Ee(ae)===!1){let ot=Me?te:[te];Ne.__webglMultisampledFramebuffer=e.createFramebuffer(),Ne.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,Ne.__webglMultisampledFramebuffer);for(let qe=0;qe<ot.length;qe++){let It=ot[qe];Ne.__webglColorRenderbuffer[qe]=e.createRenderbuffer(),e.bindRenderbuffer(36161,Ne.__webglColorRenderbuffer[qe]);let Ot=s.convert(It.format,It.encoding),Dt=s.convert(It.type),kt=P(It.internalFormat,Ot,Dt,It.encoding,ae.isXRRenderTarget===!0),Qe=ue(ae);e.renderbufferStorageMultisample(36161,Qe,kt,ae.width,ae.height),e.framebufferRenderbuffer(36160,36064+qe,36161,Ne.__webglColorRenderbuffer[qe])}e.bindRenderbuffer(36161,null),ae.depthBuffer&&(Ne.__webglDepthRenderbuffer=e.createRenderbuffer(),ke(Ne.__webglDepthRenderbuffer,ae,!0)),i.bindFramebuffer(36160,null)}}if(Y){i.bindTexture(34067,Re.__webglTexture),he(34067,te,Ke);for(let ot=0;ot<6;ot++)Te(Ne.__webglFramebuffer[ot],ae,te,36064,34069+ot);E(te,Ke)&&_(34067),i.unbindTexture()}else if(Me){let ot=ae.texture;for(let qe=0,It=ot.length;qe<It;qe++){let Ot=ot[qe],Dt=r.get(Ot);i.bindTexture(3553,Dt.__webglTexture),he(3553,Ot,Ke),Te(Ne.__webglFramebuffer,ae,Ot,36064+qe,3553),E(Ot,Ke)&&_(3553)}i.unbindTexture()}else{let ot=3553;(ae.isWebGL3DRenderTarget||ae.isWebGLArrayRenderTarget)&&(o?ot=ae.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(ot,Re.__webglTexture),he(ot,te,Ke),Te(Ne.__webglFramebuffer,ae,te,36064,ot),E(te,Ke)&&_(ot),i.unbindTexture()}ae.depthBuffer&&et(ae)}function _t(ae){let te=C(ae)||o,Ne=ae.isWebGLMultipleRenderTargets===!0?ae.texture:[ae.texture];for(let Re=0,Y=Ne.length;Re<Y;Re++){let Me=Ne[Re];if(E(Me,te)){let Ke=ae.isWebGLCubeRenderTarget?34067:3553,ot=r.get(Me).__webglTexture;i.bindTexture(Ke,ot),_(Ke),i.unbindTexture()}}}function St(ae){if(o&&ae.samples>0&&Ee(ae)===!1){let te=ae.isWebGLMultipleRenderTargets?ae.texture:[ae.texture],Ne=ae.width,Re=ae.height,Y=16384,Me=[],Ke=ae.stencilBuffer?33306:36096,ot=r.get(ae),qe=ae.isWebGLMultipleRenderTargets===!0;if(qe)for(let It=0;It<te.length;It++)i.bindFramebuffer(36160,ot.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+It,36161,null),i.bindFramebuffer(36160,ot.__webglFramebuffer),e.framebufferTexture2D(36009,36064+It,3553,null,0);i.bindFramebuffer(36008,ot.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,ot.__webglFramebuffer);for(let It=0;It<te.length;It++){Me.push(36064+It),ae.depthBuffer&&Me.push(Ke);let Ot=ot.__ignoreDepthValues!==void 0?ot.__ignoreDepthValues:!1;if(Ot===!1&&(ae.depthBuffer&&(Y|=256),ae.stencilBuffer&&(Y|=1024)),qe&&e.framebufferRenderbuffer(36008,36064,36161,ot.__webglColorRenderbuffer[It]),Ot===!0&&(e.invalidateFramebuffer(36008,[Ke]),e.invalidateFramebuffer(36009,[Ke])),qe){let Dt=r.get(te[It]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,Dt,0)}e.blitFramebuffer(0,0,Ne,Re,0,0,Ne,Re,Y,9728),f&&e.invalidateFramebuffer(36008,Me)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),qe)for(let It=0;It<te.length;It++){i.bindFramebuffer(36160,ot.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+It,36161,ot.__webglColorRenderbuffer[It]);let Ot=r.get(te[It]).__webglTexture;i.bindFramebuffer(36160,ot.__webglFramebuffer),e.framebufferTexture2D(36009,36064+It,3553,Ot,0)}i.bindFramebuffer(36009,ot.__webglMultisampledFramebuffer)}}function ue(ae){return Math.min(h,ae.samples)}function Ee(ae){let te=r.get(ae);return o&&ae.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&te.__useRenderToTexture!==!1}function Ae(ae){let te=a.render.frame;m.get(ae)!==te&&(m.set(ae,te),ae.update())}function Ge(ae,te){let Ne=ae.encoding,Re=ae.format,Y=ae.type;return ae.isCompressedTexture===!0||ae.isVideoTexture===!0||ae.format===L3||Ne!==Pc&&(Ne===$i?o===!1?t.has("EXT_sRGB")===!0&&Re===On?(ae.format=L3,ae.minFilter=Ji,ae.generateMipmaps=!1):te=wJ.sRGBToLinear(te):(Re!==On||Y!==yo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Ne)),te}this.allocateTextureUnit=V,this.resetTextureUnits=G,this.setTexture2D=U,this.setTexture2DArray=ie,this.setTexture3D=se,this.setTextureCube=ee,this.rebindTextures=Ze,this.setupRenderTarget=st,this.updateRenderTargetMipmap=_t,this.updateMultisampleRenderTarget=St,this.setupDepthRenderbuffer=et,this.setupFrameBufferTexture=Te,this.useMultisampledRTT=Ee}function IDe(e,t,i){let r=i.isWebGL2;function n(s,a=null){let o;if(s===yo)return 5121;if(s===pCe)return 32819;if(s===mCe)return 32820;if(s===hCe)return 5120;if(s===dCe)return 5122;if(s===pJ)return 5123;if(s===fCe)return 5124;if(s===qd)return 5125;if(s===$r)return 5126;if(s===lf)return r?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===gCe)return 6406;if(s===On)return 6408;if(s===vCe)return 6409;if(s===yCe)return 6410;if(s===Og)return 6402;if(s===Yg)return 34041;if(s===L3)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===xT)return 6403;if(s===xCe)return 36244;if(s===AC)return 33319;if(s===bCe)return 33320;if(s===mJ)return 36249;if(s===vD||s===yD||s===xD||s===bD)if(a===$i)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===vD)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===yD)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===xD)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===bD)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===vD)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===yD)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===xD)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===bD)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===xV||s===bV||s===_V||s===wV)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===xV)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===bV)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===_V)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===wV)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===_Ce)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===EV||s===SV)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===EV)return a===$i?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===SV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===TV||s===CV||s===AV||s===MV||s===PV||s===DV||s===IV||s===OV||s===RV||s===LV||s===NV||s===kV||s===BV||s===zV)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===TV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===CV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===AV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===MV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===PV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===DV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===IV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===OV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===RV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===LV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===NV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===kV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===BV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===zV)return a===$i?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===_D)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===_D)return a===$i?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===wCe||s===FV||s===UV||s===jV)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===_D)return o.COMPRESSED_RED_RGTC1_EXT;if(s===FV)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===UV)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===jV)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Ig?r?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var ODe=class extends ho{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Xd=class extends qr{constructor(){super(),this.isGroup=!0,this.type="Group"}},RDe={type:"move"},YD=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Xd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Xd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Xd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let m of e.hand.values()){let g=t.getJointPose(m,i),y=this._getHandJoint(l,m);g!==null&&(y.matrix.fromArray(g.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=g.radius),y.visible=g!==null}let u=l.joints["index-finger-tip"],c=l.joints["thumb-tip"],h=u.position.distanceTo(c.position),d=.02,f=.005;l.inputState.pinching&&h>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,i),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&n!==null&&(r=n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(RDe)))}return a!==null&&(a.visible=r!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new Xd;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},Oy=class extends jn{constructor(e,t,i,r,n,s,a,o,l,u){if(u=u!==void 0?u:Og,u!==Og&&u!==Yg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===Og&&(i=qd),i===void 0&&u===Yg&&(i=Ig),super(null,r,n,s,a,o,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ur,this.minFilter=o!==void 0?o:ur,this.flipY=!1,this.generateMipmaps=!1}},LDe=class extends qa{constructor(e,t){super();let i=this,r=null,n=1,s=null,a="local-floor",o=1,l=null,u=null,c=null,h=null,d=null,f=null,m=t.getContextAttributes(),g=null,y=null,x=[],w=[],b=new Set,C=new Map,A=new ho;A.layers.enable(1),A.viewport=new Pi;let E=new ho;E.layers.enable(2),E.viewport=new Pi;let _=[A,E],P=new ODe;P.layers.enable(1),P.layers.enable(2);let I=null,D=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ie){let se=x[ie];return se===void 0&&(se=new YD,x[ie]=se),se.getTargetRaySpace()},this.getControllerGrip=function(ie){let se=x[ie];return se===void 0&&(se=new YD,x[ie]=se),se.getGripSpace()},this.getHand=function(ie){let se=x[ie];return se===void 0&&(se=new YD,x[ie]=se),se.getHandSpace()};function k(ie){let se=w.indexOf(ie.inputSource);if(se===-1)return;let ee=x[se];ee!==void 0&&ee.dispatchEvent({type:ie.type,data:ie.inputSource})}function B(){r.removeEventListener("select",k),r.removeEventListener("selectstart",k),r.removeEventListener("selectend",k),r.removeEventListener("squeeze",k),r.removeEventListener("squeezestart",k),r.removeEventListener("squeezeend",k),r.removeEventListener("end",B),r.removeEventListener("inputsourceschange",z);for(let ie=0;ie<x.length;ie++){let se=w[ie];se!==null&&(w[ie]=null,x[ie].disconnect(se))}I=null,D=null,e.setRenderTarget(g),d=null,h=null,c=null,r=null,y=null,U.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ie){n=ie,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ie){a=ie,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(ie){l=ie},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return c},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(ie){if(r=ie,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",k),r.addEventListener("selectstart",k),r.addEventListener("selectend",k),r.addEventListener("squeeze",k),r.addEventListener("squeezestart",k),r.addEventListener("squeezeend",k),r.addEventListener("end",B),r.addEventListener("inputsourceschange",z),m.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let se={antialias:r.renderState.layers===void 0?m.antialias:!0,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:n};d=new XRWebGLLayer(r,t,se),r.updateRenderState({baseLayer:d}),y=new Tr(d.framebufferWidth,d.framebufferHeight,{format:On,type:yo,encoding:e.outputEncoding,stencilBuffer:m.stencil})}else{let se=null,ee=null,ve=null;m.depth&&(ve=m.stencil?35056:33190,se=m.stencil?Yg:Og,ee=m.stencil?Ig:qd);let _e={colorFormat:32856,depthFormat:ve,scaleFactor:n};c=new XRWebGLBinding(r,t),h=c.createProjectionLayer(_e),r.updateRenderState({layers:[h]}),y=new Tr(h.textureWidth,h.textureHeight,{format:On,type:yo,depthTexture:new Oy(h.textureWidth,h.textureHeight,ee,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:m.stencil,encoding:e.outputEncoding,samples:m.antialias?4:0});let he=e.properties.get(y);he.__ignoreDepthValues=h.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await r.requestReferenceSpace(a),U.setContext(r),U.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function z(ie){for(let se=0;se<ie.removed.length;se++){let ee=ie.removed[se],ve=w.indexOf(ee);ve>=0&&(w[ve]=null,x[ve].disconnect(ee))}for(let se=0;se<ie.added.length;se++){let ee=ie.added[se],ve=w.indexOf(ee);if(ve===-1){for(let he=0;he<x.length;he++)if(he>=w.length){w.push(ee),ve=he;break}else if(w[he]===null){w[he]=ee,ve=he;break}if(ve===-1)break}let _e=x[ve];_e&&_e.connect(ee)}}let W=new q,$=new q;function Z(ie,se,ee){W.setFromMatrixPosition(se.matrixWorld),$.setFromMatrixPosition(ee.matrixWorld);let ve=W.distanceTo($),_e=se.projectionMatrix.elements,he=ee.projectionMatrix.elements,De=_e[14]/(_e[10]-1),we=_e[14]/(_e[10]+1),Le=(_e[9]+1)/_e[5],Te=(_e[9]-1)/_e[5],ke=(_e[8]-1)/_e[0],Xe=(he[8]+1)/he[0],et=De*ke,Ze=De*Xe,st=ve/(-ke+Xe),_t=st*-ke;se.matrixWorld.decompose(ie.position,ie.quaternion,ie.scale),ie.translateX(_t),ie.translateZ(st),ie.matrixWorld.compose(ie.position,ie.quaternion,ie.scale),ie.matrixWorldInverse.copy(ie.matrixWorld).invert();let St=De+st,ue=we+st,Ee=et-_t,Ae=Ze+(ve-_t),Ge=Le*we/ue*St,ae=Te*we/ue*St;ie.projectionMatrix.makePerspective(Ee,Ae,Ge,ae,St,ue)}function G(ie,se){se===null?ie.matrixWorld.copy(ie.matrix):ie.matrixWorld.multiplyMatrices(se.matrixWorld,ie.matrix),ie.matrixWorldInverse.copy(ie.matrixWorld).invert()}this.updateCamera=function(ie){if(r===null)return;P.near=E.near=A.near=ie.near,P.far=E.far=A.far=ie.far,(I!==P.near||D!==P.far)&&(r.updateRenderState({depthNear:P.near,depthFar:P.far}),I=P.near,D=P.far);let se=ie.parent,ee=P.cameras;G(P,se);for(let _e=0;_e<ee.length;_e++)G(ee[_e],se);P.matrixWorld.decompose(P.position,P.quaternion,P.scale),ie.matrix.copy(P.matrix),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale);let ve=ie.children;for(let _e=0,he=ve.length;_e<he;_e++)ve[_e].updateMatrixWorld(!0);ee.length===2?Z(P,A,E):P.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return P},this.getFoveation=function(){if(!(h===null&&d===null))return o},this.setFoveation=function(ie){o=ie,h!==null&&(h.fixedFoveation=ie),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=ie)},this.getPlanes=function(){return b};let V=null;function J(ie,se){if(u=se.getViewerPose(l||s),f=se,u!==null){let ee=u.views;d!==null&&(e.setRenderTargetFramebuffer(y,d.framebuffer),e.setRenderTarget(y));let ve=!1;ee.length!==P.cameras.length&&(P.cameras.length=0,ve=!0);for(let _e=0;_e<ee.length;_e++){let he=ee[_e],De=null;if(d!==null)De=d.getViewport(he);else{let Le=c.getViewSubImage(h,he);De=Le.viewport,_e===0&&(e.setRenderTargetTextures(y,Le.colorTexture,h.ignoreDepthValues?void 0:Le.depthStencilTexture),e.setRenderTarget(y))}let we=_[_e];we===void 0&&(we=new ho,we.layers.enable(_e),we.viewport=new Pi,_[_e]=we),we.matrix.fromArray(he.transform.matrix),we.projectionMatrix.fromArray(he.projectionMatrix),we.viewport.set(De.x,De.y,De.width,De.height),_e===0&&P.matrix.copy(we.matrix),ve===!0&&P.cameras.push(we)}}for(let ee=0;ee<x.length;ee++){let ve=w[ee],_e=x[ee];ve!==null&&_e!==void 0&&_e.update(ve,se,l||s)}if(V&&V(ie,se),se.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:se.detectedPlanes});let ee=null;for(let ve of b)se.detectedPlanes.has(ve)||(ee===null&&(ee=[]),ee.push(ve));if(ee!==null)for(let ve of ee)b.delete(ve),C.delete(ve),i.dispatchEvent({type:"planeremoved",data:ve});for(let ve of se.detectedPlanes)if(!b.has(ve))b.add(ve),C.set(ve,se.lastChangedTime),i.dispatchEvent({type:"planeadded",data:ve});else{let _e=C.get(ve);ve.lastChangedTime>_e&&(C.set(ve,ve.lastChangedTime),i.dispatchEvent({type:"planechanged",data:ve}))}}f=null}let U=new MJ;U.setAnimationLoop(J),this.setAnimationLoop=function(ie){V=ie},this.dispose=function(){}}};function NDe(e,t){function i(g,y){y.color.getRGB(g.fogColor.value,AJ(e)),y.isFog?(g.fogNear.value=y.near,g.fogFar.value=y.far):y.isFogExp2&&(g.fogDensity.value=y.density)}function r(g,y,x,w,b){y.isMeshBasicMaterial||y.isMeshLambertMaterial?n(g,y):y.isMeshToonMaterial?(n(g,y),c(g,y)):y.isMeshPhongMaterial?(n(g,y),u(g,y)):y.isMeshStandardMaterial?(n(g,y),h(g,y),y.isMeshPhysicalMaterial&&d(g,y,b)):y.isMeshMatcapMaterial?(n(g,y),f(g,y)):y.isMeshDepthMaterial?n(g,y):y.isMeshDistanceMaterial?(n(g,y),m(g,y)):y.isMeshNormalMaterial?n(g,y):y.isLineBasicMaterial?(s(g,y),y.isLineDashedMaterial&&a(g,y)):y.isPointsMaterial?o(g,y,x,w):y.isSpriteMaterial?l(g,y):y.isShadowMaterial?(g.color.value.copy(y.color),g.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function n(g,y){g.opacity.value=y.opacity,y.color&&g.diffuse.value.copy(y.color),y.emissive&&g.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(g.map.value=y.map),y.alphaMap&&(g.alphaMap.value=y.alphaMap),y.bumpMap&&(g.bumpMap.value=y.bumpMap,g.bumpScale.value=y.bumpScale,y.side===wa&&(g.bumpScale.value*=-1)),y.displacementMap&&(g.displacementMap.value=y.displacementMap,g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias),y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap),y.normalMap&&(g.normalMap.value=y.normalMap,g.normalScale.value.copy(y.normalScale),y.side===wa&&g.normalScale.value.negate()),y.specularMap&&(g.specularMap.value=y.specularMap),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);let x=t.get(y).envMap;if(x&&(g.envMap.value=x,g.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=y.reflectivity,g.ior.value=y.ior,g.refractionRatio.value=y.refractionRatio),y.lightMap){g.lightMap.value=y.lightMap;let C=e.physicallyCorrectLights!==!0?Math.PI:1;g.lightMapIntensity.value=y.lightMapIntensity*C}y.aoMap&&(g.aoMap.value=y.aoMap,g.aoMapIntensity.value=y.aoMapIntensity);let w;y.map?w=y.map:y.specularMap?w=y.specularMap:y.displacementMap?w=y.displacementMap:y.normalMap?w=y.normalMap:y.bumpMap?w=y.bumpMap:y.roughnessMap?w=y.roughnessMap:y.metalnessMap?w=y.metalnessMap:y.alphaMap?w=y.alphaMap:y.emissiveMap?w=y.emissiveMap:y.clearcoatMap?w=y.clearcoatMap:y.clearcoatNormalMap?w=y.clearcoatNormalMap:y.clearcoatRoughnessMap?w=y.clearcoatRoughnessMap:y.iridescenceMap?w=y.iridescenceMap:y.iridescenceThicknessMap?w=y.iridescenceThicknessMap:y.specularIntensityMap?w=y.specularIntensityMap:y.specularColorMap?w=y.specularColorMap:y.transmissionMap?w=y.transmissionMap:y.thicknessMap?w=y.thicknessMap:y.sheenColorMap?w=y.sheenColorMap:y.sheenRoughnessMap&&(w=y.sheenRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),g.uvTransform.value.copy(w.matrix));let b;y.aoMap?b=y.aoMap:y.lightMap&&(b=y.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),g.uv2Transform.value.copy(b.matrix))}function s(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity}function a(g,y){g.dashSize.value=y.dashSize,g.totalSize.value=y.dashSize+y.gapSize,g.scale.value=y.scale}function o(g,y,x,w){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.size.value=y.size*x,g.scale.value=w*.5,y.map&&(g.map.value=y.map),y.alphaMap&&(g.alphaMap.value=y.alphaMap),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);let b;y.map?b=y.map:y.alphaMap&&(b=y.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),g.uvTransform.value.copy(b.matrix))}function l(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.rotation.value=y.rotation,y.map&&(g.map.value=y.map),y.alphaMap&&(g.alphaMap.value=y.alphaMap),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);let x;y.map?x=y.map:y.alphaMap&&(x=y.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uvTransform.value.copy(x.matrix))}function u(g,y){g.specular.value.copy(y.specular),g.shininess.value=Math.max(y.shininess,1e-4)}function c(g,y){y.gradientMap&&(g.gradientMap.value=y.gradientMap)}function h(g,y){g.roughness.value=y.roughness,g.metalness.value=y.metalness,y.roughnessMap&&(g.roughnessMap.value=y.roughnessMap),y.metalnessMap&&(g.metalnessMap.value=y.metalnessMap),t.get(y).envMap&&(g.envMapIntensity.value=y.envMapIntensity)}function d(g,y,x){g.ior.value=y.ior,y.sheen>0&&(g.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),g.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(g.sheenColorMap.value=y.sheenColorMap),y.sheenRoughnessMap&&(g.sheenRoughnessMap.value=y.sheenRoughnessMap)),y.clearcoat>0&&(g.clearcoat.value=y.clearcoat,g.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(g.clearcoatMap.value=y.clearcoatMap),y.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap),y.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),g.clearcoatNormalMap.value=y.clearcoatNormalMap,y.side===wa&&g.clearcoatNormalScale.value.negate())),y.iridescence>0&&(g.iridescence.value=y.iridescence,g.iridescenceIOR.value=y.iridescenceIOR,g.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(g.iridescenceMap.value=y.iridescenceMap),y.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=y.iridescenceThicknessMap)),y.transmission>0&&(g.transmission.value=y.transmission,g.transmissionSamplerMap.value=x.texture,g.transmissionSamplerSize.value.set(x.width,x.height),y.transmissionMap&&(g.transmissionMap.value=y.transmissionMap),g.thickness.value=y.thickness,y.thicknessMap&&(g.thicknessMap.value=y.thicknessMap),g.attenuationDistance.value=y.attenuationDistance,g.attenuationColor.value.copy(y.attenuationColor)),g.specularIntensity.value=y.specularIntensity,g.specularColor.value.copy(y.specularColor),y.specularIntensityMap&&(g.specularIntensityMap.value=y.specularIntensityMap),y.specularColorMap&&(g.specularColorMap.value=y.specularColorMap)}function f(g,y){y.matcap&&(g.matcap.value=y.matcap)}function m(g,y){g.referencePosition.value.copy(y.referencePosition),g.nearDistance.value=y.nearDistance,g.farDistance.value=y.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function kDe(e,t,i,r){let n={},s={},a=[],o=i.isWebGL2?e.getParameter(35375):0;function l(w,b){let C=b.program;r.uniformBlockBinding(w,C)}function u(w,b){let C=n[w.id];C===void 0&&(m(w),C=c(w),n[w.id]=C,w.addEventListener("dispose",y));let A=b.program;r.updateUBOMapping(w,A);let E=t.render.frame;s[w.id]!==E&&(d(w),s[w.id]=E)}function c(w){let b=h();w.__bindingPointIndex=b;let C=e.createBuffer(),A=w.__size,E=w.usage;return e.bindBuffer(35345,C),e.bufferData(35345,A,E),e.bindBuffer(35345,null),e.bindBufferBase(35345,b,C),C}function h(){for(let w=0;w<o;w++)if(a.indexOf(w)===-1)return a.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(w){let b=n[w.id],C=w.uniforms,A=w.__cache;e.bindBuffer(35345,b);for(let E=0,_=C.length;E<_;E++){let P=C[E];if(f(P,E,A)===!0){let I=P.__offset,D=Array.isArray(P.value)?P.value:[P.value],k=0;for(let B=0;B<D.length;B++){let z=D[B],W=g(z);typeof z=="number"?(P.__data[0]=z,e.bufferSubData(35345,I+k,P.__data)):z.isMatrix3?(P.__data[0]=z.elements[0],P.__data[1]=z.elements[1],P.__data[2]=z.elements[2],P.__data[3]=z.elements[0],P.__data[4]=z.elements[3],P.__data[5]=z.elements[4],P.__data[6]=z.elements[5],P.__data[7]=z.elements[0],P.__data[8]=z.elements[6],P.__data[9]=z.elements[7],P.__data[10]=z.elements[8],P.__data[11]=z.elements[0]):(z.toArray(P.__data,k),k+=W.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,I,P.__data)}}e.bindBuffer(35345,null)}function f(w,b,C){let A=w.value;if(C[b]===void 0){if(typeof A=="number")C[b]=A;else{let E=Array.isArray(A)?A:[A],_=[];for(let P=0;P<E.length;P++)_.push(E[P].clone());C[b]=_}return!0}else if(typeof A=="number"){if(C[b]!==A)return C[b]=A,!0}else{let E=Array.isArray(C[b])?C[b]:[C[b]],_=Array.isArray(A)?A:[A];for(let P=0;P<E.length;P++){let I=E[P];if(I.equals(_[P])===!1)return I.copy(_[P]),!0}}return!1}function m(w){let b=w.uniforms,C=0,A=16,E=0;for(let _=0,P=b.length;_<P;_++){let I=b[_],D={boundary:0,storage:0},k=Array.isArray(I.value)?I.value:[I.value];for(let B=0,z=k.length;B<z;B++){let W=k[B],$=g(W);D.boundary+=$.boundary,D.storage+=$.storage}if(I.__data=new Float32Array(D.storage/Float32Array.BYTES_PER_ELEMENT),I.__offset=C,_>0){E=C%A;let B=A-E;E!==0&&B-D.boundary<0&&(C+=A-E,I.__offset=C)}C+=D.storage}return E=C%A,E>0&&(C+=A-E),w.__size=C,w.__cache={},this}function g(w){let b={boundary:0,storage:0};return typeof w=="number"?(b.boundary=4,b.storage=4):w.isVector2?(b.boundary=8,b.storage=8):w.isVector3||w.isColor?(b.boundary=16,b.storage=12):w.isVector4?(b.boundary=16,b.storage=16):w.isMatrix3?(b.boundary=48,b.storage=48):w.isMatrix4?(b.boundary=64,b.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),b}function y(w){let b=w.target;b.removeEventListener("dispose",y);let C=a.indexOf(b.__bindingPointIndex);a.splice(C,1),e.deleteBuffer(n[b.id]),delete n[b.id],delete s[b.id]}function x(){for(let w in n)e.deleteBuffer(n[w]);a=[],n={},s={}}return{bind:l,update:u,dispose:x}}function BDe(){let e=a_("canvas");return e.style.display="block",e}function LJ(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:BDe(),i=e.context!==void 0?e.context:null,r=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",u=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,c;i!==null?c=i.getContextAttributes().alpha:c=e.alpha!==void 0?e.alpha:!1;let h=null,d=null,f=[],m=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Pc,this.physicallyCorrectLights=!1,this.toneMapping=Ph,this.toneMappingExposure=1;let g=this,y=!1,x=0,w=0,b=null,C=-1,A=null,E=new Pi,_=new Pi,P=null,I=t.width,D=t.height,k=1,B=null,z=null,W=new Pi(0,0,I,D),$=new Pi(0,0,I,D),Z=!1,G=new oB,V=!1,J=!1,U=null,ie=new Pt,se=new Ie,ee=new q,ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function _e(){return b===null?k:1}let he=i;function De(me,lt){for(let pt=0;pt<me.length;pt++){let tt=me[pt],xt=t.getContext(tt,lt);if(xt!==null)return xt}return null}try{let me={alpha:!0,depth:r,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${r1}`),t.addEventListener("webglcontextlost",kt,!1),t.addEventListener("webglcontextrestored",Qe,!1),t.addEventListener("webglcontextcreationerror",mt,!1),he===null){let lt=["webgl2","webgl","experimental-webgl"];if(g.isWebGL1Renderer===!0&&lt.shift(),he=De(lt,me),he===null)throw De(lt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}he.getShaderPrecisionFormat===void 0&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(me){throw console.error("THREE.WebGLRenderer: "+me.message),me}let we,Le,Te,ke,Xe,et,Ze,st,_t,St,ue,Ee,Ae,Ge,ae,te,Ne,Re,Y,Me,Ke,ot,qe,It;function Ot(){we=new $2e(he),Le=new W2e(he,we,e),we.init(Le),ot=new IDe(he,we,Le),Te=new PDe(he,we,Le),ke=new J2e,Xe=new gDe,et=new DDe(he,we,Te,Xe,Le,ot,ke),Ze=new q2e(g),st=new K2e(g),_t=new lAe(he,Le),qe=new V2e(he,we,_t,Le),St=new Z2e(he,_t,ke,qe),ue=new rPe(he,St,_t,ke),Y=new iPe(he,Le,et),te=new G2e(Xe),Ee=new mDe(g,Ze,st,we,Le,qe,te),Ae=new NDe(g,Xe),Ge=new yDe,ae=new SDe(we,Le),Re=new j2e(g,Ze,st,Te,ue,c,a),Ne=new MDe(g,ue,Le),It=new kDe(he,ke,Le,Te),Me=new H2e(he,we,ke,Le),Ke=new Q2e(he,we,ke,Le),ke.programs=Ee.programs,g.capabilities=Le,g.extensions=we,g.properties=Xe,g.renderLists=Ge,g.shadowMap=Ne,g.state=Te,g.info=ke}Ot();let Dt=new LDe(g,he);this.xr=Dt,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){let me=we.get("WEBGL_lose_context");me&&me.loseContext()},this.forceContextRestore=function(){let me=we.get("WEBGL_lose_context");me&&me.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(me){me!==void 0&&(k=me,this.setSize(I,D,!1))},this.getSize=function(me){return me.set(I,D)},this.setSize=function(me,lt,pt){if(Dt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}I=me,D=lt,t.width=Math.floor(me*k),t.height=Math.floor(lt*k),pt!==!1&&(t.style.width=me+"px",t.style.height=lt+"px"),this.setViewport(0,0,me,lt)},this.getDrawingBufferSize=function(me){return me.set(I*k,D*k).floor()},this.setDrawingBufferSize=function(me,lt,pt){I=me,D=lt,k=pt,t.width=Math.floor(me*pt),t.height=Math.floor(lt*pt),this.setViewport(0,0,me,lt)},this.getCurrentViewport=function(me){return me.copy(E)},this.getViewport=function(me){return me.copy(W)},this.setViewport=function(me,lt,pt,tt){me.isVector4?W.set(me.x,me.y,me.z,me.w):W.set(me,lt,pt,tt),Te.viewport(E.copy(W).multiplyScalar(k).floor())},this.getScissor=function(me){return me.copy($)},this.setScissor=function(me,lt,pt,tt){me.isVector4?$.set(me.x,me.y,me.z,me.w):$.set(me,lt,pt,tt),Te.scissor(_.copy($).multiplyScalar(k).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(me){Te.setScissorTest(Z=me)},this.setOpaqueSort=function(me){B=me},this.setTransparentSort=function(me){z=me},this.getClearColor=function(me){return me.copy(Re.getClearColor())},this.setClearColor=function(){Re.setClearColor.apply(Re,arguments)},this.getClearAlpha=function(){return Re.getClearAlpha()},this.setClearAlpha=function(){Re.setClearAlpha.apply(Re,arguments)},this.clear=function(me=!0,lt=!0,pt=!0){let tt=0;me&&(tt|=16384),lt&&(tt|=256),pt&&(tt|=1024),he.clear(tt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",kt,!1),t.removeEventListener("webglcontextrestored",Qe,!1),t.removeEventListener("webglcontextcreationerror",mt,!1),Ge.dispose(),ae.dispose(),Xe.dispose(),Ze.dispose(),st.dispose(),ue.dispose(),qe.dispose(),It.dispose(),Ee.dispose(),Dt.dispose(),Dt.removeEventListener("sessionstart",Bt),Dt.removeEventListener("sessionend",ei),U&&(U.dispose(),U=null),zi.stop()};function kt(me){me.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Qe(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;let me=ke.autoReset,lt=Ne.enabled,pt=Ne.autoUpdate,tt=Ne.needsUpdate,xt=Ne.type;Ot(),ke.autoReset=me,Ne.enabled=lt,Ne.autoUpdate=pt,Ne.needsUpdate=tt,Ne.type=xt}function mt(me){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",me.statusMessage)}function Ht(me){let lt=me.target;lt.removeEventListener("dispose",Ht),Wt(lt)}function Wt(me){Ue(me),Xe.remove(me)}function Ue(me){let lt=Xe.get(me).programs;lt!==void 0&&(lt.forEach(function(pt){Ee.releaseProgram(pt)}),me.isShaderMaterial&&Ee.releaseShaderCache(me))}this.renderBufferDirect=function(me,lt,pt,tt,xt,Qt){lt===null&&(lt=ve);let hi=xt.isMesh&&xt.matrixWorld.determinant()<0,ui=Jo(me,lt,pt,tt,xt);Te.setMaterial(tt,hi);let ri=pt.index,dr=1;tt.wireframe===!0&&(ri=St.getWireframeAttribute(pt),dr=2);let Li=pt.drawRange,Ni=pt.attributes.position,bi=Li.start*dr,on=(Li.start+Li.count)*dr;Qt!==null&&(bi=Math.max(bi,Qt.start*dr),on=Math.min(on,(Qt.start+Qt.count)*dr)),ri!==null?(bi=Math.max(bi,0),on=Math.min(on,ri.count)):Ni!=null&&(bi=Math.max(bi,0),on=Math.min(on,Ni.count));let is=on-bi;if(is<0||is===1/0)return;qe.setup(xt,tt,ui,pt,ri);let Wn,Lr=Me;if(ri!==null&&(Wn=_t.get(ri),Lr=Ke,Lr.setIndex(Wn)),xt.isMesh)tt.wireframe===!0?(Te.setLineWidth(tt.wireframeLinewidth*_e()),Lr.setMode(1)):Lr.setMode(4);else if(xt.isLine){let Xi=tt.linewidth;Xi===void 0&&(Xi=1),Te.setLineWidth(Xi*_e()),xt.isLineSegments?Lr.setMode(1):xt.isLineLoop?Lr.setMode(2):Lr.setMode(3)}else xt.isPoints?Lr.setMode(0):xt.isSprite&&Lr.setMode(4);if(xt.isInstancedMesh)Lr.renderInstances(bi,is,xt.count);else if(pt.isInstancedBufferGeometry){let Xi=pt._maxInstanceCount!==void 0?pt._maxInstanceCount:1/0,ia=Math.min(pt.instanceCount,Xi);Lr.renderInstances(bi,is,ia)}else Lr.render(bi,is)},this.compile=function(me,lt){function pt(tt,xt,Qt){tt.transparent===!0&&tt.side===po&&tt.forceSinglePass===!1?(tt.side=wa,tt.needsUpdate=!0,Yr(tt,xt,Qt),tt.side=Mc,tt.needsUpdate=!0,Yr(tt,xt,Qt),tt.side=po):Yr(tt,xt,Qt)}d=ae.get(me),d.init(),m.push(d),me.traverseVisible(function(tt){tt.isLight&&tt.layers.test(lt.layers)&&(d.pushLight(tt),tt.castShadow&&d.pushShadow(tt))}),d.setupLights(g.physicallyCorrectLights),me.traverse(function(tt){let xt=tt.material;if(xt)if(Array.isArray(xt))for(let Qt=0;Qt<xt.length;Qt++){let hi=xt[Qt];pt(hi,me,tt)}else pt(xt,me,tt)}),m.pop(),d=null};let dt=null;function gt(me){dt&&dt(me)}function Bt(){zi.stop()}function ei(){zi.start()}let zi=new MJ;zi.setAnimationLoop(gt),typeof self<"u"&&zi.setContext(self),this.setAnimationLoop=function(me){dt=me,Dt.setAnimationLoop(me),me===null?zi.stop():zi.start()},Dt.addEventListener("sessionstart",Bt),Dt.addEventListener("sessionend",ei),this.render=function(me,lt){if(lt!==void 0&&lt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),lt.parent===null&&lt.matrixWorldAutoUpdate===!0&&lt.updateMatrixWorld(),Dt.enabled===!0&&Dt.isPresenting===!0&&(Dt.cameraAutoUpdate===!0&&Dt.updateCamera(lt),lt=Dt.getCamera()),me.isScene===!0&&me.onBeforeRender(g,me,lt,b),d=ae.get(me,m.length),d.init(),m.push(d),ie.multiplyMatrices(lt.projectionMatrix,lt.matrixWorldInverse),G.setFromProjectionMatrix(ie),J=this.localClippingEnabled,V=te.init(this.clippingPlanes,J),h=Ge.get(me,f.length),h.init(),f.push(h),vi(me,lt,0,g.sortObjects),h.finish(),g.sortObjects===!0&&h.sort(B,z),V===!0&&te.beginShadows();let pt=d.state.shadowsArray;if(Ne.render(pt,me,lt),V===!0&&te.endShadows(),this.info.autoReset===!0&&this.info.reset(),Re.render(h,me),d.setupLights(g.physicallyCorrectLights),lt.isArrayCamera){let tt=lt.cameras;for(let xt=0,Qt=tt.length;xt<Qt;xt++){let hi=tt[xt];Yi(h,me,hi,hi.viewport)}}else Yi(h,me,lt);b!==null&&(et.updateMultisampleRenderTarget(b),et.updateRenderTargetMipmap(b)),me.isScene===!0&&me.onAfterRender(g,me,lt),qe.resetDefaultState(),C=-1,A=null,m.pop(),m.length>0?d=m[m.length-1]:d=null,f.pop(),f.length>0?h=f[f.length-1]:h=null};function vi(me,lt,pt,tt){if(me.visible===!1)return;if(me.layers.test(lt.layers)){if(me.isGroup)pt=me.renderOrder;else if(me.isLOD)me.autoUpdate===!0&&me.update(lt);else if(me.isLight)d.pushLight(me),me.castShadow&&d.pushShadow(me);else if(me.isSprite){if(!me.frustumCulled||G.intersectsSprite(me)){tt&&ee.setFromMatrixPosition(me.matrixWorld).applyMatrix4(ie);let Qt=ue.update(me),hi=me.material;hi.visible&&h.push(me,Qt,hi,pt,ee.z,null)}}else if((me.isMesh||me.isLine||me.isPoints)&&(me.isSkinnedMesh&&me.skeleton.frame!==ke.render.frame&&(me.skeleton.update(),me.skeleton.frame=ke.render.frame),!me.frustumCulled||G.intersectsObject(me))){tt&&ee.setFromMatrixPosition(me.matrixWorld).applyMatrix4(ie);let Qt=ue.update(me),hi=me.material;if(Array.isArray(hi)){let ui=Qt.groups;for(let ri=0,dr=ui.length;ri<dr;ri++){let Li=ui[ri],Ni=hi[Li.materialIndex];Ni&&Ni.visible&&h.push(me,Qt,Ni,pt,ee.z,Li)}}else hi.visible&&h.push(me,Qt,hi,pt,ee.z,null)}}let xt=me.children;for(let Qt=0,hi=xt.length;Qt<hi;Qt++)vi(xt[Qt],lt,pt,tt)}function Yi(me,lt,pt,tt){let xt=me.opaque,Qt=me.transmissive,hi=me.transparent;d.setupLightsView(pt),V===!0&&te.setGlobalState(g.clippingPlanes,pt),Qt.length>0&&wn(xt,lt,pt),tt&&Te.viewport(E.copy(tt)),xt.length>0&&yr(xt,lt,pt),Qt.length>0&&yr(Qt,lt,pt),hi.length>0&&yr(hi,lt,pt),Te.buffers.depth.setTest(!0),Te.buffers.depth.setMask(!0),Te.buffers.color.setMask(!0),Te.setPolygonOffset(!1)}function wn(me,lt,pt){let tt=Le.isWebGL2;U===null&&(U=new Tr(1,1,{generateMipmaps:!0,type:we.has("EXT_color_buffer_half_float")?lf:yo,minFilter:Dy,samples:tt&&s===!0?4:0})),g.getDrawingBufferSize(se),tt?U.setSize(se.x,se.y):U.setSize(OC(se.x),OC(se.y));let xt=g.getRenderTarget();g.setRenderTarget(U),g.clear();let Qt=g.toneMapping;g.toneMapping=Ph,yr(me,lt,pt),g.toneMapping=Qt,et.updateMultisampleRenderTarget(U),et.updateRenderTargetMipmap(U),g.setRenderTarget(xt)}function yr(me,lt,pt){let tt=lt.isScene===!0?lt.overrideMaterial:null;for(let xt=0,Qt=me.length;xt<Qt;xt++){let hi=me[xt],ui=hi.object,ri=hi.geometry,dr=tt===null?hi.material:tt,Li=hi.group;ui.layers.test(pt.layers)&&Rn(ui,lt,pt,ri,dr,Li)}}function Rn(me,lt,pt,tt,xt,Qt){me.onBeforeRender(g,lt,pt,tt,xt,Qt),me.modelViewMatrix.multiplyMatrices(pt.matrixWorldInverse,me.matrixWorld),me.normalMatrix.getNormalMatrix(me.modelViewMatrix),xt.onBeforeRender(g,lt,pt,tt,me,Qt),xt.transparent===!0&&xt.side===po&&xt.forceSinglePass===!1?(xt.side=wa,xt.needsUpdate=!0,g.renderBufferDirect(pt,lt,tt,xt,me,Qt),xt.side=Mc,xt.needsUpdate=!0,g.renderBufferDirect(pt,lt,tt,xt,me,Qt),xt.side=po):g.renderBufferDirect(pt,lt,tt,xt,me,Qt),me.onAfterRender(g,lt,pt,tt,xt,Qt)}function Yr(me,lt,pt){lt.isScene!==!0&&(lt=ve);let tt=Xe.get(me),xt=d.state.lights,Qt=d.state.shadowsArray,hi=xt.state.version,ui=Ee.getParameters(me,xt.state,Qt,lt,pt),ri=Ee.getProgramCacheKey(ui),dr=tt.programs;tt.environment=me.isMeshStandardMaterial?lt.environment:null,tt.fog=lt.fog,tt.envMap=(me.isMeshStandardMaterial?st:Ze).get(me.envMap||tt.environment),dr===void 0&&(me.addEventListener("dispose",Ht),dr=new Map,tt.programs=dr);let Li=dr.get(ri);if(Li!==void 0){if(tt.currentProgram===Li&&tt.lightsStateVersion===hi)return Hn(me,ui),Li}else ui.uniforms=Ee.getUniforms(me),me.onBuild(pt,ui,g),me.onBeforeCompile(ui,g),Li=Ee.acquireProgram(ui,ri),dr.set(ri,Li),tt.uniforms=ui.uniforms;let Ni=tt.uniforms;(!me.isShaderMaterial&&!me.isRawShaderMaterial||me.clipping===!0)&&(Ni.clippingPlanes=te.uniform),Hn(me,ui),tt.needsLights=Ln(me),tt.lightsStateVersion=hi,tt.needsLights&&(Ni.ambientLightColor.value=xt.state.ambient,Ni.lightProbe.value=xt.state.probe,Ni.directionalLights.value=xt.state.directional,Ni.directionalLightShadows.value=xt.state.directionalShadow,Ni.spotLights.value=xt.state.spot,Ni.spotLightShadows.value=xt.state.spotShadow,Ni.rectAreaLights.value=xt.state.rectArea,Ni.ltc_1.value=xt.state.rectAreaLTC1,Ni.ltc_2.value=xt.state.rectAreaLTC2,Ni.pointLights.value=xt.state.point,Ni.pointLightShadows.value=xt.state.pointShadow,Ni.hemisphereLights.value=xt.state.hemi,Ni.directionalShadowMap.value=xt.state.directionalShadowMap,Ni.directionalShadowMatrix.value=xt.state.directionalShadowMatrix,Ni.spotShadowMap.value=xt.state.spotShadowMap,Ni.spotLightMatrix.value=xt.state.spotLightMatrix,Ni.spotLightMap.value=xt.state.spotLightMap,Ni.pointShadowMap.value=xt.state.pointShadowMap,Ni.pointShadowMatrix.value=xt.state.pointShadowMatrix);let bi=Li.getUniforms(),on=_T.seqWithValue(bi.seq,Ni);return tt.currentProgram=Li,tt.uniformsList=on,Li}function Hn(me,lt){let pt=Xe.get(me);pt.outputEncoding=lt.outputEncoding,pt.instancing=lt.instancing,pt.skinning=lt.skinning,pt.morphTargets=lt.morphTargets,pt.morphNormals=lt.morphNormals,pt.morphColors=lt.morphColors,pt.morphTargetsCount=lt.morphTargetsCount,pt.numClippingPlanes=lt.numClippingPlanes,pt.numIntersection=lt.numClipIntersection,pt.vertexAlphas=lt.vertexAlphas,pt.vertexTangents=lt.vertexTangents,pt.toneMapping=lt.toneMapping}function Jo(me,lt,pt,tt,xt){lt.isScene!==!0&&(lt=ve),et.resetTextureUnits();let Qt=lt.fog,hi=tt.isMeshStandardMaterial?lt.environment:null,ui=b===null?g.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:Pc,ri=(tt.isMeshStandardMaterial?st:Ze).get(tt.envMap||hi),dr=tt.vertexColors===!0&&!!pt.attributes.color&&pt.attributes.color.itemSize===4,Li=!!tt.normalMap&&!!pt.attributes.tangent,Ni=!!pt.morphAttributes.position,bi=!!pt.morphAttributes.normal,on=!!pt.morphAttributes.color,is=tt.toneMapped?g.toneMapping:Ph,Wn=pt.morphAttributes.position||pt.morphAttributes.normal||pt.morphAttributes.color,Lr=Wn!==void 0?Wn.length:0,Xi=Xe.get(tt),ia=d.state.lights;if(V===!0&&(J===!0||me!==A)){let ye=me===A&&tt.id===C;te.setState(tt,me,ye)}let Fi=!1;tt.version===Xi.__version?(Xi.needsLights&&Xi.lightsStateVersion!==ia.state.version||Xi.outputEncoding!==ui||xt.isInstancedMesh&&Xi.instancing===!1||!xt.isInstancedMesh&&Xi.instancing===!0||xt.isSkinnedMesh&&Xi.skinning===!1||!xt.isSkinnedMesh&&Xi.skinning===!0||Xi.envMap!==ri||tt.fog===!0&&Xi.fog!==Qt||Xi.numClippingPlanes!==void 0&&(Xi.numClippingPlanes!==te.numPlanes||Xi.numIntersection!==te.numIntersection)||Xi.vertexAlphas!==dr||Xi.vertexTangents!==Li||Xi.morphTargets!==Ni||Xi.morphNormals!==bi||Xi.morphColors!==on||Xi.toneMapping!==is||Le.isWebGL2===!0&&Xi.morphTargetsCount!==Lr)&&(Fi=!0):(Fi=!0,Xi.__version=tt.version);let Ya=Xi.currentProgram;Fi===!0&&(Ya=Yr(tt,lt,xt));let ra=!1,ks=!1,Aa=!1,le=Ya.getUniforms(),pe=Xi.uniforms;if(Te.useProgram(Ya.program)&&(ra=!0,ks=!0,Aa=!0),tt.id!==C&&(C=tt.id,ks=!0),ra||A!==me){if(le.setValue(he,"projectionMatrix",me.projectionMatrix),Le.logarithmicDepthBuffer&&le.setValue(he,"logDepthBufFC",2/(Math.log(me.far+1)/Math.LN2)),A!==me&&(A=me,ks=!0,Aa=!0),tt.isShaderMaterial||tt.isMeshPhongMaterial||tt.isMeshToonMaterial||tt.isMeshStandardMaterial||tt.envMap){let ye=le.map.cameraPosition;ye!==void 0&&ye.setValue(he,ee.setFromMatrixPosition(me.matrixWorld))}(tt.isMeshPhongMaterial||tt.isMeshToonMaterial||tt.isMeshLambertMaterial||tt.isMeshBasicMaterial||tt.isMeshStandardMaterial||tt.isShaderMaterial)&&le.setValue(he,"isOrthographic",me.isOrthographicCamera===!0),(tt.isMeshPhongMaterial||tt.isMeshToonMaterial||tt.isMeshLambertMaterial||tt.isMeshBasicMaterial||tt.isMeshStandardMaterial||tt.isShaderMaterial||tt.isShadowMaterial||xt.isSkinnedMesh)&&le.setValue(he,"viewMatrix",me.matrixWorldInverse)}if(xt.isSkinnedMesh){le.setOptional(he,xt,"bindMatrix"),le.setOptional(he,xt,"bindMatrixInverse");let ye=xt.skeleton;ye&&(Le.floatVertexTextures?(ye.boneTexture===null&&ye.computeBoneTexture(),le.setValue(he,"boneTexture",ye.boneTexture,et),le.setValue(he,"boneTextureSize",ye.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let Ce=pt.morphAttributes;if((Ce.position!==void 0||Ce.normal!==void 0||Ce.color!==void 0&&Le.isWebGL2===!0)&&Y.update(xt,pt,tt,Ya),(ks||Xi.receiveShadow!==xt.receiveShadow)&&(Xi.receiveShadow=xt.receiveShadow,le.setValue(he,"receiveShadow",xt.receiveShadow)),tt.isMeshGouraudMaterial&&tt.envMap!==null&&(pe.envMap.value=ri,pe.flipEnvMap.value=ri.isCubeTexture&&ri.isRenderTargetTexture===!1?-1:1),ks&&(le.setValue(he,"toneMappingExposure",g.toneMappingExposure),Xi.needsLights&&Bl(pe,Aa),Qt&&tt.fog===!0&&Ae.refreshFogUniforms(pe,Qt),Ae.refreshMaterialUniforms(pe,tt,k,D,U),_T.upload(he,Xi.uniformsList,pe,et)),tt.isShaderMaterial&&tt.uniformsNeedUpdate===!0&&(_T.upload(he,Xi.uniformsList,pe,et),tt.uniformsNeedUpdate=!1),tt.isSpriteMaterial&&le.setValue(he,"center",xt.center),le.setValue(he,"modelViewMatrix",xt.modelViewMatrix),le.setValue(he,"normalMatrix",xt.normalMatrix),le.setValue(he,"modelMatrix",xt.matrixWorld),xt.previousModelViewMatrix&&le.setValue(he,"previousModelViewMatrix",xt.previousModelViewMatrix),me.previousProjectionMatrix&&le.setValue(he,"previousProjectionMatrix",me.previousProjectionMatrix),tt.isShaderMaterial||tt.isRawShaderMaterial){let ye=tt.uniformsGroups;for(let We=0,Ct=ye.length;We<Ct;We++)if(Le.isWebGL2){let En=ye[We];It.update(En,Ya),It.bind(En,Ya)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ya}function Bl(me,lt){me.ambientLightColor.needsUpdate=lt,me.lightProbe.needsUpdate=lt,me.directionalLights.needsUpdate=lt,me.directionalLightShadows.needsUpdate=lt,me.pointLights.needsUpdate=lt,me.pointLightShadows.needsUpdate=lt,me.spotLights.needsUpdate=lt,me.spotLightShadows.needsUpdate=lt,me.rectAreaLights.needsUpdate=lt,me.hemisphereLights.needsUpdate=lt}function Ln(me){return me.isMeshLambertMaterial||me.isMeshToonMaterial||me.isMeshPhongMaterial||me.isMeshStandardMaterial||me.isShadowMaterial||me.isShaderMaterial&&me.lights===!0}this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(me,lt,pt){Xe.get(me.texture).__webglTexture=lt,Xe.get(me.depthTexture).__webglTexture=pt;let tt=Xe.get(me);tt.__hasExternalTextures=!0,tt.__hasExternalTextures&&(tt.__autoAllocateDepthBuffer=pt===void 0,tt.__autoAllocateDepthBuffer||we.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),tt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(me,lt){let pt=Xe.get(me);pt.__webglFramebuffer=lt,pt.__useDefaultFramebuffer=lt===void 0},this.setRenderTarget=function(me,lt=0,pt=0){b=me,x=lt,w=pt;let tt=!0,xt=null,Qt=!1,hi=!1;if(me){let ui=Xe.get(me);ui.__useDefaultFramebuffer!==void 0?(Te.bindFramebuffer(36160,null),tt=!1):ui.__webglFramebuffer===void 0?et.setupRenderTarget(me):ui.__hasExternalTextures&&et.rebindTextures(me,Xe.get(me.texture).__webglTexture,Xe.get(me.depthTexture).__webglTexture);let ri=me.texture;(ri.isData3DTexture||ri.isDataArrayTexture||ri.isCompressedArrayTexture)&&(hi=!0);let dr=Xe.get(me).__webglFramebuffer;me.isWebGLCubeRenderTarget?(xt=dr[lt],Qt=!0):Le.isWebGL2&&me.samples>0&&et.useMultisampledRTT(me)===!1?xt=Xe.get(me).__webglMultisampledFramebuffer:xt=dr,E.copy(me.viewport),_.copy(me.scissor),P=me.scissorTest}else E.copy(W).multiplyScalar(k).floor(),_.copy($).multiplyScalar(k).floor(),P=Z;if(Te.bindFramebuffer(36160,xt)&&Le.drawBuffers&&tt&&Te.drawBuffers(me,xt),Te.viewport(E),Te.scissor(_),Te.setScissorTest(P),Qt){let ui=Xe.get(me.texture);he.framebufferTexture2D(36160,36064,34069+lt,ui.__webglTexture,pt)}else if(hi){let ui=Xe.get(me.texture),ri=lt||0;he.framebufferTextureLayer(36160,36064,ui.__webglTexture,pt||0,ri)}C=-1},this.readRenderTargetPixels=function(me,lt,pt,tt,xt,Qt,hi){if(!(me&&me.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ui=Xe.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&hi!==void 0&&(ui=ui[hi]),ui){Te.bindFramebuffer(36160,ui);try{let ri=me.texture,dr=ri.format,Li=ri.type;if(dr!==On&&ot.convert(dr)!==he.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ni=Li===lf&&(we.has("EXT_color_buffer_half_float")||Le.isWebGL2&&we.has("EXT_color_buffer_float"));if(Li!==yo&&ot.convert(Li)!==he.getParameter(35738)&&!(Li===$r&&(Le.isWebGL2||we.has("OES_texture_float")||we.has("WEBGL_color_buffer_float")))&&!Ni){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}lt>=0&&lt<=me.width-tt&&pt>=0&&pt<=me.height-xt&&he.readPixels(lt,pt,tt,xt,ot.convert(dr),ot.convert(Li),Qt)}finally{let ri=b!==null?Xe.get(b).__webglFramebuffer:null;Te.bindFramebuffer(36160,ri)}}},this.readRenderTargetPixelsAsync=async function(me,lt,pt,tt,xt,Qt,hi){if(!(me&&me.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ui=Xe.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&hi!==void 0&&(ui=ui[hi]),ui){let ri=me.texture,dr=ri.format,Li=ri.type;if(lt>=0&&lt<=me.width-tt&&pt>=0&&pt<=me.height-xt){Te.bindFramebuffer(he.FRAMEBUFFER,ui);let Ni=he.createBuffer();he.bindBuffer(he.PIXEL_PACK_BUFFER,Ni),he.bufferData(he.PIXEL_PACK_BUFFER,Qt.byteLength,he.STREAM_READ),he.readPixels(lt,pt,tt,xt,ot.convert(dr),ot.convert(Li),0);let bi=b!==null?Xe.get(b).__webglFramebuffer:null;Te.bindFramebuffer(he.FRAMEBUFFER,bi);let on=he.fenceSync(he.SYNC_GPU_COMMANDS_COMPLETE,0);return he.flush(),await VCe(he,on,4),he.bindBuffer(he.PIXEL_PACK_BUFFER,Ni),he.getBufferSubData(he.PIXEL_PACK_BUFFER,0,Qt),he.deleteBuffer(Ni),he.deleteSync(on),Qt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(me,lt,pt=0){let tt=Math.pow(2,-pt),xt=Math.floor(lt.image.width*tt),Qt=Math.floor(lt.image.height*tt);et.setTexture2D(lt,0),he.copyTexSubImage2D(3553,pt,0,0,me.x,me.y,xt,Qt),Te.unbindTexture()},this.copyTextureToTexture=function(me,lt,pt,tt=0){let xt=lt.image.width,Qt=lt.image.height,hi=ot.convert(pt.format),ui=ot.convert(pt.type);et.setTexture2D(pt,0),he.pixelStorei(37440,pt.flipY),he.pixelStorei(37441,pt.premultiplyAlpha),he.pixelStorei(3317,pt.unpackAlignment),lt.isDataTexture?he.texSubImage2D(3553,tt,me.x,me.y,xt,Qt,hi,ui,lt.image.data):lt.isCompressedTexture?he.compressedTexSubImage2D(3553,tt,me.x,me.y,lt.mipmaps[0].width,lt.mipmaps[0].height,hi,lt.mipmaps[0].data):he.texSubImage2D(3553,tt,me.x,me.y,hi,ui,lt.image),tt===0&&pt.generateMipmaps&&he.generateMipmap(3553),Te.unbindTexture()},this.copyTextureToTexture3D=function(me,lt,pt,tt,xt=0){if(g.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Qt=me.max.x-me.min.x+1,hi=me.max.y-me.min.y+1,ui=me.max.z-me.min.z+1,ri=ot.convert(tt.format),dr=ot.convert(tt.type),Li;if(tt.isData3DTexture)et.setTexture3D(tt,0),Li=32879;else if(tt.isDataArrayTexture)et.setTexture2DArray(tt,0),Li=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}he.pixelStorei(37440,tt.flipY),he.pixelStorei(37441,tt.premultiplyAlpha),he.pixelStorei(3317,tt.unpackAlignment);let Ni=he.getParameter(3314),bi=he.getParameter(32878),on=he.getParameter(3316),is=he.getParameter(3315),Wn=he.getParameter(32877),Lr=pt.isCompressedTexture?pt.mipmaps[0]:pt.image;he.pixelStorei(3314,Lr.width),he.pixelStorei(32878,Lr.height),he.pixelStorei(3316,me.min.x),he.pixelStorei(3315,me.min.y),he.pixelStorei(32877,me.min.z),pt.isDataTexture||pt.isData3DTexture?he.texSubImage3D(Li,xt,lt.x,lt.y,lt.z,Qt,hi,ui,ri,dr,Lr.data):pt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),he.compressedTexSubImage3D(Li,xt,lt.x,lt.y,lt.z,Qt,hi,ui,ri,Lr.data)):he.texSubImage3D(Li,xt,lt.x,lt.y,lt.z,Qt,hi,ui,ri,dr,Lr),he.pixelStorei(3314,Ni),he.pixelStorei(32878,bi),he.pixelStorei(3316,on),he.pixelStorei(3315,is),he.pixelStorei(32877,Wn),xt===0&&tt.generateMipmaps&&he.generateMipmap(Li),Te.unbindTexture()},this.initRenderTarget=function(me){Xe.get(me).__webglFramebuffer===void 0&&et.setupRenderTarget(me)},this.initTexture=function(me){me.isCubeTexture?et.setTextureCube(me,0):me.isData3DTexture?et.setTexture3D(me,0):me.isDataArrayTexture||me.isCompressedArrayTexture?et.setTexture2DArray(me,0):et.setTexture2D(me,0),Te.unbindTexture()},this.resetState=function(){x=0,w=0,b=null,Te.reset(),qe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var zDe=class extends LJ{};zDe.prototype.isWebGL1Renderer=!0;var NJ=class{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new mi(e),this.near=t,this.far=i}clone(){return new NJ(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Ol=class extends qr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,i){return super.copy(t,i),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let i=super.toJSON(t);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}},FDe=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=O3,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Bu()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,n=this.stride;r<n;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Io=new q,B3=class{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Io.fromBufferAttribute(this,t),Io.applyMatrix4(e),this.setXYZ(t,Io.x,Io.y,Io.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Io.fromBufferAttribute(this,t),Io.applyNormalMatrix(e),this.setXYZ(t,Io.x,Io.y,Io.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Io.fromBufferAttribute(this,t),Io.transformDirection(e),this.setXYZ(t,Io.x,Io.y,Io.z);return this}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Yd(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Yd(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Yd(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Yd(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),r=hn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),r=hn(r,this.array),n=hn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[r+n])}return new gi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new B3(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[r+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},kJ=class extends qr{constructor(){super(),this.isBone=!0,this.type="Bone"}},Wo=class extends jn{constructor(t=null,i=1,r=1,n,s,a,o,l,u=ur,c=ur,h,d){super(null,a,o,l,u,c,n,s,h,d),this.isDataTexture=!0,this.image={data:t,width:i,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},_8=new Pt,UDe=new Pt,uB=class{constructor(e=[],t=[]){this.uuid=Bu(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Pt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let i=new Pt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:UDe;_8.multiplyMatrices(a,t[n]),_8.toArray(i,n*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new uB(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=xJ(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new Wo(t,e,e,On,$r);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){let n=e.bones[i],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new kJ),this.bones.push(s),this.boneInverses.push(new Pt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let r=0,n=t.length;r<n;r++){let s=t[r];e.bones.push(s.uuid);let a=i[r];e.boneInverses.push(a.toArray())}return e}},o_=class extends gi{constructor(t,i,r,n=1){super(t,i,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}},w8=new Pt,E8=new Pt,BE=[],jDe=new Pt,ix=new dn,VDe=class extends dn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new o_(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,jDe)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let i=this.matrixWorld,r=this.count;if(ix.geometry=this.geometry,ix.material=this.material,ix.material!==void 0)for(let n=0;n<r;n++){this.getMatrixAt(n,w8),E8.multiplyMatrices(i,w8),ix.matrixWorld=E8,ix.raycast(e,BE);for(let s=0,a=BE.length;s<a;s++){let o=BE[s];o.instanceId=n,o.object=this,t.push(o)}BE.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new o_(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},am=class extends Q_{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new mi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},S8=new q,T8=new q,C8=new Pt,XD=new n1,zE=new Rl,RC=class extends qr{constructor(e=new ai,t=new am){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let r=1,n=t.count;r<n;r++)S8.fromBufferAttribute(t,r-1),T8.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=S8.distanceTo(T8);e.setAttribute("lineDistance",new Vt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,r=this.matrixWorld,n=e.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),zE.copy(i.boundingSphere),zE.applyMatrix4(r),zE.radius+=n,e.ray.intersectsSphere(zE)===!1)return;C8.copy(r).invert(),XD.copy(e.ray).applyMatrix4(C8);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new q,u=new q,c=new q,h=new q,d=this.isLineSegments?2:1,f=i.index,m=i.attributes.position;if(f!==null){let g=Math.max(0,s.start),y=Math.min(f.count,s.start+s.count);for(let x=g,w=y-1;x<w;x+=d){let b=f.getX(x),C=f.getX(x+1);if(l.fromBufferAttribute(m,b),u.fromBufferAttribute(m,C),XD.distanceSqToSegment(l,u,h,c)>o)continue;h.applyMatrix4(this.matrixWorld);let A=e.ray.origin.distanceTo(h);A<e.near||A>e.far||t.push({distance:A,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{let g=Math.max(0,s.start),y=Math.min(m.count,s.start+s.count);for(let x=g,w=y-1;x<w;x+=d){if(l.fromBufferAttribute(m,x),u.fromBufferAttribute(m,x+1),XD.distanceSqToSegment(l,u,h,c)>o)continue;h.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=i.length;r<n;r++){let s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}},A8=new q,M8=new q,J_=class extends RC{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let r=0,n=t.count;r<n;r+=2)A8.fromBufferAttribute(t,r),M8.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+A8.distanceTo(M8);e.setAttribute("lineDistance",new Vt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},HDe=class extends jn{constructor(e,t,i,r,n,s,a,o,l){super(e,t,i,r,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Ji,this.magFilter=n!==void 0?n:Ji,this.generateMipmaps=!1;let u=this;function c(){u.needsUpdate=!0,e.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},WDe=class extends jn{constructor(e,t,i,r,n,s,a,o,l){super(e,t,i,r,n,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},Uh=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,r=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),n+=i.distanceTo(r),t.push(n),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),r=0,n=i.length,s;t?s=t:s=e*i[n-1];let a=0,o=n-1,l;for(;a<=o;)if(r=Math.floor(a+(o-a)/2),l=i[r]-s,l<0)a=r+1;else if(l>0)o=r-1;else{o=r;break}if(r=o,i[r]===s)return r/(n-1);let u=i[r],c=i[r+1]-u,h=(s-u)/c;return(r+h)/(n-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);let n=this.getPoint(i),s=this.getPoint(r),a=t||(n.isVector2?new Ie:new q);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new q,r=[],n=[],s=[],a=new q,o=new Pt;for(let d=0;d<=e;d++){let f=d/e;r[d]=this.getTangentAt(f,new q)}n[0]=new q,s[0]=new q;let l=Number.MAX_VALUE,u=Math.abs(r[0].x),c=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),c<=l&&(l=c,i.set(0,1,0)),h<=l&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),n[0].crossVectors(r[0],a),s[0].crossVectors(r[0],n[0]);for(let d=1;d<=e;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(r[d-1],r[d]),a.length()>Number.EPSILON){a.normalize();let f=Math.acos(Ms(r[d-1].dot(r[d]),-1,1));n[d].applyMatrix4(o.makeRotationAxis(a,f))}s[d].crossVectors(r[d],n[d])}if(t===!0){let d=Math.acos(Ms(n[0].dot(n[e]),-1,1));d/=e,r[0].dot(a.crossVectors(n[0],n[e]))>0&&(d=-d);for(let f=1;f<=e;f++)n[f].applyMatrix4(o.makeRotationAxis(r[f],d*f)),s[f].crossVectors(r[f],n[f])}return{tangents:r,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},EM=class extends Uh{constructor(e=0,t=0,i=1,r=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let i=t||new Ie,r=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(s?n=0:n=r),this.aClockwise===!0&&!s&&(n===r?n=-r:n=n-r);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=o-this.aX,d=l-this.aY;o=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return i.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},GDe=class extends EM{constructor(e,t,i,r,n,s){super(e,t,i,i,r,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function cB(){let e=0,t=0,i=0,r=0;function n(s,a,o,l){e=s,t=o,i=-3*s+3*a-2*o-l,r=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,u){n(a,o,u*(o-s),u*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,u,c,h){let d=(a-s)/u-(o-s)/(u+c)+(o-a)/c,f=(o-a)/c-(l-a)/(c+h)+(l-o)/h;d*=c,f*=c,n(a,o,d,f)},calc:function(s){let a=s*s,o=a*s;return e+t*s+i*a+r*o}}}var FE=new q,KD=new cB,$D=new cB,ZD=new cB,qDe=class extends Uh{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new q){let i=t,r=this.points,n=r.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,u;this.closed||a>0?l=r[(a-1)%n]:(FE.subVectors(r[0],r[1]).add(r[0]),l=FE);let c=r[a%n],h=r[(a+1)%n];if(this.closed||a+2<n?u=r[(a+2)%n]:(FE.subVectors(r[n-1],r[n-2]).add(r[n-1]),u=FE),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(c),d),m=Math.pow(c.distanceToSquared(h),d),g=Math.pow(h.distanceToSquared(u),d);m<1e-4&&(m=1),f<1e-4&&(f=m),g<1e-4&&(g=m),KD.initNonuniformCatmullRom(l.x,c.x,h.x,u.x,f,m,g),$D.initNonuniformCatmullRom(l.y,c.y,h.y,u.y,f,m,g),ZD.initNonuniformCatmullRom(l.z,c.z,h.z,u.z,f,m,g)}else this.curveType==="catmullrom"&&(KD.initCatmullRom(l.x,c.x,h.x,u.x,this.tension),$D.initCatmullRom(l.y,c.y,h.y,u.y,this.tension),ZD.initCatmullRom(l.z,c.z,h.z,u.z,this.tension));return i.set(KD.calc(o),$D.calc(o),ZD.calc(o)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(new q().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function P8(e,t,i,r,n){let s=(r-t)*.5,a=(n-i)*.5,o=e*e,l=e*o;return(2*i-2*r+s+a)*l+(-3*i+3*r-2*s-a)*o+s*e+i}function YDe(e,t){let i=1-e;return i*i*t}function XDe(e,t){return 2*(1-e)*e*t}function KDe(e,t){return e*e*t}function vb(e,t,i,r){return YDe(e,t)+XDe(e,i)+KDe(e,r)}function $De(e,t){let i=1-e;return i*i*i*t}function ZDe(e,t){let i=1-e;return 3*i*i*e*t}function QDe(e,t){return 3*(1-e)*e*e*t}function JDe(e,t){return e*e*e*t}function yb(e,t,i,r,n){return $De(e,t)+ZDe(e,i)+QDe(e,r)+JDe(e,n)}var vc=class extends Uh{constructor(e=new Ie,t=new Ie,i=new Ie,r=new Ie){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Ie){let i=t,r=this.v0,n=this.v1,s=this.v2,a=this.v3;return i.set(yb(e,r.x,n.x,s.x,a.x),yb(e,r.y,n.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},wT=class extends Uh{constructor(e=new q,t=new q,i=new q,r=new q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new q){let i=t,r=this.v0,n=this.v1,s=this.v2,a=this.v3;return i.set(yb(e,r.x,n.x,s.x,a.x),yb(e,r.y,n.y,s.y,a.y),yb(e,r.z,n.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},wc=class extends Uh{constructor(e=new Ie,t=new Ie){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ie){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let i=t||new Ie;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},BJ=class extends Uh{constructor(e=new q,t=new q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new q){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Yp=class extends Uh{constructor(e=new Ie,t=new Ie,i=new Ie){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Ie){let i=t,r=this.v0,n=this.v1,s=this.v2;return i.set(vb(e,r.x,n.x,s.x),vb(e,r.y,n.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},eIe=class extends Uh{constructor(e=new q,t=new q,i=new q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new q){let i=t,r=this.v0,n=this.v1,s=this.v2;return i.set(vb(e,r.x,n.x,s.x),vb(e,r.y,n.y,s.y),vb(e,r.z,n.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},hB=class extends Uh{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ie){let i=t,r=this.points,n=(r.length-1)*e,s=Math.floor(n),a=n-s,o=r[s===0?s:s-1],l=r[s],u=r[s>r.length-2?r.length-1:s+1],c=r[s>r.length-3?r.length-1:s+2];return i.set(P8(a,o.x,l.x,u.x,c.x),P8(a,o.y,l.y,u.y,c.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(new Ie().fromArray(r))}return this}},tIe=Object.freeze({__proto__:null,ArcCurve:GDe,CatmullRomCurve3:qDe,CubicBezierCurve:vc,CubicBezierCurve3:wT,EllipseCurve:EM,LineCurve:wc,LineCurve3:BJ,QuadraticBezierCurve:Yp,QuadraticBezierCurve3:eIe,SplineCurve:hB}),zJ=class extends Uh{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new wc(t,e))}getPoint(e,t){let i=e*this.getLength(),r=this.getCurveLengths(),n=0;for(;n<r.length;){if(r[n]>=i){let s=r[n]-i,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],i;for(let r=0,n=this.curves;r<n.length;r++){let s=n[r],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let u=o[l];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let r=e.curves[t];this.curves.push(new tIe[r.type]().fromJSON(r))}return this}},LC=class extends zJ{constructor(e){super(),this.type="Path",this.currentPoint=new Ie,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new wc(this.currentPoint.clone(),new Ie(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){let n=new Yp(this.currentPoint.clone(),new Ie(e,t),new Ie(i,r));return this.curves.push(n),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,n,s){let a=new vc(this.currentPoint.clone(),new Ie(e,t),new Ie(i,r),new Ie(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new hB(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,i,r,n,s),this}absarc(e,t,i,r,n,s){return this.absellipse(e,t,i,i,r,n,s),this}ellipse(e,t,i,r,n,s,a,o){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,i,r,n,s,a,o),this}absellipse(e,t,i,r,n,s,a,o){let l=new EM(e,t,i,r,n,s,a,o);if(this.curves.length>0){let c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},FJ=class extends ai{constructor(e=[new Ie(0,-.5),new Ie(.5,0),new Ie(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=Ms(r,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],u=1/t,c=new q,h=new Ie,d=new q,f=new q,m=new q,g=0,y=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:g=e[x+1].x-e[x].x,y=e[x+1].y-e[x].y,d.x=y*1,d.y=-g,d.z=y*0,m.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(m.x,m.y,m.z);break;default:g=e[x+1].x-e[x].x,y=e[x+1].y-e[x].y,d.x=y*1,d.y=-g,d.z=y*0,f.copy(d),d.x+=m.x,d.y+=m.y,d.z+=m.z,d.normalize(),o.push(d.x,d.y,d.z),m.copy(f)}for(let x=0;x<=t;x++){let w=i+x*u*r,b=Math.sin(w),C=Math.cos(w);for(let A=0;A<=e.length-1;A++){c.x=e[A].x*b,c.y=e[A].y,c.z=e[A].x*C,s.push(c.x,c.y,c.z),h.x=x/t,h.y=A/(e.length-1),a.push(h.x,h.y);let E=o[3*A+0]*b,_=o[3*A+1],P=o[3*A+0]*C;l.push(E,_,P)}}for(let x=0;x<t;x++)for(let w=0;w<e.length-1;w++){let b=w+x*e.length,C=b,A=b+e.length,E=b+e.length+1,_=b+1;n.push(C,A,_),n.push(E,_,A)}this.setIndex(n),this.setAttribute("position",new Vt(s,3)),this.setAttribute("uv",new Vt(a,2)),this.setAttribute("normal",new Vt(l,3))}static fromJSON(e){return new FJ(e.points,e.segments,e.phiStart,e.phiLength)}},dB=class extends ai{constructor(e=1,t=1,i=1,r=32,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;r=Math.floor(r),n=Math.floor(n);let u=[],c=[],h=[],d=[],f=0,m=[],g=i/2,y=0;x(),s===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(u),this.setAttribute("position",new Vt(c,3)),this.setAttribute("normal",new Vt(h,3)),this.setAttribute("uv",new Vt(d,2));function x(){let b=new q,C=new q,A=0,E=(t-e)/i;for(let _=0;_<=n;_++){let P=[],I=_/n,D=I*(t-e)+e;for(let k=0;k<=r;k++){let B=k/r,z=B*o+a,W=Math.sin(z),$=Math.cos(z);C.x=D*W,C.y=-I*i+g,C.z=D*$,c.push(C.x,C.y,C.z),b.set(W,E,$).normalize(),h.push(b.x,b.y,b.z),d.push(B,1-I),P.push(f++)}m.push(P)}for(let _=0;_<r;_++)for(let P=0;P<n;P++){let I=m[P][_],D=m[P+1][_],k=m[P+1][_+1],B=m[P][_+1];u.push(I,D,B),u.push(D,k,B),A+=6}l.addGroup(y,A,0),y+=A}function w(b){let C=f,A=new Ie,E=new q,_=0,P=b===!0?e:t,I=b===!0?1:-1;for(let k=1;k<=r;k++)c.push(0,g*I,0),h.push(0,I,0),d.push(.5,.5),f++;let D=f;for(let k=0;k<=r;k++){let B=k/r*o+a,z=Math.cos(B),W=Math.sin(B);E.x=P*W,E.y=g*I,E.z=P*z,c.push(E.x,E.y,E.z),h.push(0,I,0),A.x=z*.5+.5,A.y=W*.5*I+.5,d.push(A.x,A.y),f++}for(let k=0;k<r;k++){let B=C+k,z=D+k;b===!0?u.push(z,z+1,B):u.push(z+1,z,B),_+=3}l.addGroup(y,_,b===!0?1:2),y+=_}}static fromJSON(e){return new dB(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},fB=class extends dB{constructor(e=1,t=1,i=32,r=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,i,r,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new fB(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},pB=class extends ai{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};let n=[],s=[];a(r),l(i),u(),this.setAttribute("position",new Vt(n,3)),this.setAttribute("normal",new Vt(n.slice(),3)),this.setAttribute("uv",new Vt(s,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(x){let w=new q,b=new q,C=new q;for(let A=0;A<t.length;A+=3)d(t[A+0],w),d(t[A+1],b),d(t[A+2],C),o(w,b,C,x)}function o(x,w,b,C){let A=C+1,E=[];for(let _=0;_<=A;_++){E[_]=[];let P=x.clone().lerp(b,_/A),I=w.clone().lerp(b,_/A),D=A-_;for(let k=0;k<=D;k++)k===0&&_===A?E[_][k]=P:E[_][k]=P.clone().lerp(I,k/D)}for(let _=0;_<A;_++)for(let P=0;P<2*(A-_)-1;P++){let I=Math.floor(P/2);P%2===0?(h(E[_][I+1]),h(E[_+1][I]),h(E[_][I])):(h(E[_][I+1]),h(E[_+1][I+1]),h(E[_+1][I]))}}function l(x){let w=new q;for(let b=0;b<n.length;b+=3)w.x=n[b+0],w.y=n[b+1],w.z=n[b+2],w.normalize().multiplyScalar(x),n[b+0]=w.x,n[b+1]=w.y,n[b+2]=w.z}function u(){let x=new q;for(let w=0;w<n.length;w+=3){x.x=n[w+0],x.y=n[w+1],x.z=n[w+2];let b=g(x)/2/Math.PI+.5,C=y(x)/Math.PI+.5;s.push(b,1-C)}f(),c()}function c(){for(let x=0;x<s.length;x+=6){let w=s[x+0],b=s[x+2],C=s[x+4],A=Math.max(w,b,C),E=Math.min(w,b,C);A>.9&&E<.1&&(w<.2&&(s[x+0]+=1),b<.2&&(s[x+2]+=1),C<.2&&(s[x+4]+=1))}}function h(x){n.push(x.x,x.y,x.z)}function d(x,w){let b=x*3;w.x=e[b+0],w.y=e[b+1],w.z=e[b+2]}function f(){let x=new q,w=new q,b=new q,C=new q,A=new Ie,E=new Ie,_=new Ie;for(let P=0,I=0;P<n.length;P+=9,I+=6){x.set(n[P+0],n[P+1],n[P+2]),w.set(n[P+3],n[P+4],n[P+5]),b.set(n[P+6],n[P+7],n[P+8]),A.set(s[I+0],s[I+1]),E.set(s[I+2],s[I+3]),_.set(s[I+4],s[I+5]),C.copy(x).add(w).add(b).divideScalar(3);let D=g(C);m(A,I+0,x,D),m(E,I+2,w,D),m(_,I+4,b,D)}}function m(x,w,b,C){C<0&&x.x===1&&(s[w]=x.x-1),b.x===0&&b.z===0&&(s[w]=C/2/Math.PI+.5)}function g(x){return Math.atan2(x.z,-x.x)}function y(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}static fromJSON(e){return new pB(e.vertices,e.indices,e.radius,e.details)}},UJ=class extends pB{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,r=1/i,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new UJ(e.radius,e.detail)}},NC=class extends LC{constructor(e){super(e),this.uuid=Bu(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let r=e.holes[t];this.holes.push(new LC().fromJSON(r))}return this}},iIe={triangulate:function(e,t,i=2){let r=t&&t.length,n=r?t[0]*i:e.length,s=jJ(e,0,n,i,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,u,c,h,d,f;if(r&&(s=oIe(e,t,s,i)),e.length>80*i){o=u=e[0],l=c=e[1];for(let m=i;m<n;m+=i)h=e[m],d=e[m+1],h<o&&(o=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);f=Math.max(u-o,c-l),f=f!==0?32767/f:0}return l_(s,a,i,o,l,f,0),a}};function jJ(e,t,i,r,n){let s,a;if(n===yIe(e,t,i,r)>0)for(s=t;s<i;s+=r)a=D8(s,e[s],e[s+1],a);else for(s=i-r;s>=t;s-=r)a=D8(s,e[s],e[s+1],a);return a&&SM(a,a.next)&&(c_(a),a=a.next),a}function Xg(e,t){if(!e)return e;t||(t=e);let i=e,r;do if(r=!1,!i.steiner&&(SM(i,i.next)||Fn(i.prev,i,i.next)===0)){if(c_(i),i=t=i.prev,i===i.next)break;r=!0}else i=i.next;while(r||i!==t);return t}function l_(e,t,i,r,n,s,a){if(!e)return;!a&&s&&dIe(e,r,n,s);let o=e,l,u;for(;e.prev!==e.next;){if(l=e.prev,u=e.next,s?nIe(e,r,n,s):rIe(e)){t.push(l.i/i|0),t.push(e.i/i|0),t.push(u.i/i|0),c_(e),e=u.next,o=u.next;continue}if(e=u,e===o){a?a===1?(e=sIe(Xg(e),t,i),l_(e,t,i,r,n,s,2)):a===2&&aIe(e,t,i,r,n,s):l_(Xg(e),t,i,r,n,s,1);break}}}function rIe(e){let t=e.prev,i=e,r=e.next;if(Fn(t,i,r)>=0)return!1;let n=t.x,s=i.x,a=r.x,o=t.y,l=i.y,u=r.y,c=n<s?n<a?n:a:s<a?s:a,h=o<l?o<u?o:u:l<u?l:u,d=n>s?n>a?n:a:s>a?s:a,f=o>l?o>u?o:u:l>u?l:u,m=r.next;for(;m!==t;){if(m.x>=c&&m.x<=d&&m.y>=h&&m.y<=f&&q0(n,o,s,l,a,u,m.x,m.y)&&Fn(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function nIe(e,t,i,r){let n=e.prev,s=e,a=e.next;if(Fn(n,s,a)>=0)return!1;let o=n.x,l=s.x,u=a.x,c=n.y,h=s.y,d=a.y,f=o<l?o<u?o:u:l<u?l:u,m=c<h?c<d?c:d:h<d?h:d,g=o>l?o>u?o:u:l>u?l:u,y=c>h?c>d?c:d:h>d?h:d,x=z3(f,m,t,i,r),w=z3(g,y,t,i,r),b=e.prevZ,C=e.nextZ;for(;b&&b.z>=x&&C&&C.z<=w;){if(b.x>=f&&b.x<=g&&b.y>=m&&b.y<=y&&b!==n&&b!==a&&q0(o,c,l,h,u,d,b.x,b.y)&&Fn(b.prev,b,b.next)>=0||(b=b.prevZ,C.x>=f&&C.x<=g&&C.y>=m&&C.y<=y&&C!==n&&C!==a&&q0(o,c,l,h,u,d,C.x,C.y)&&Fn(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;b&&b.z>=x;){if(b.x>=f&&b.x<=g&&b.y>=m&&b.y<=y&&b!==n&&b!==a&&q0(o,c,l,h,u,d,b.x,b.y)&&Fn(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;C&&C.z<=w;){if(C.x>=f&&C.x<=g&&C.y>=m&&C.y<=y&&C!==n&&C!==a&&q0(o,c,l,h,u,d,C.x,C.y)&&Fn(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function sIe(e,t,i){let r=e;do{let n=r.prev,s=r.next.next;!SM(n,s)&&VJ(n,r,r.next,s)&&u_(n,s)&&u_(s,n)&&(t.push(n.i/i|0),t.push(r.i/i|0),t.push(s.i/i|0),c_(r),c_(r.next),r=e=s),r=r.next}while(r!==e);return Xg(r)}function aIe(e,t,i,r,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&mIe(a,o)){let l=HJ(a,o);a=Xg(a,a.next),l=Xg(l,l.next),l_(a,t,i,r,n,s,0),l_(l,t,i,r,n,s,0);return}o=o.next}a=a.next}while(a!==e)}function oIe(e,t,i,r){let n=[],s,a,o,l,u;for(s=0,a=t.length;s<a;s++)o=t[s]*r,l=s<a-1?t[s+1]*r:e.length,u=jJ(e,o,l,r,!1),u===u.next&&(u.steiner=!0),n.push(pIe(u));for(n.sort(lIe),s=0;s<n.length;s++)i=uIe(n[s],i);return i}function lIe(e,t){return e.x-t.x}function uIe(e,t){let i=cIe(e,t);if(!i)return t;let r=HJ(i,e);return Xg(r,r.next),Xg(i,i.next)}function cIe(e,t){let i=t,r=-1/0,n,s=e.x,a=e.y;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){let d=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>r&&(r=d,n=i.x<i.next.x?i:i.next,d===s))return n}i=i.next}while(i!==t);if(!n)return null;let o=n,l=n.x,u=n.y,c=1/0,h;i=n;do s>=i.x&&i.x>=l&&s!==i.x&&q0(a<u?s:r,a,l,u,a<u?r:s,a,i.x,i.y)&&(h=Math.abs(a-i.y)/(s-i.x),u_(i,e)&&(h<c||h===c&&(i.x>n.x||i.x===n.x&&hIe(n,i)))&&(n=i,c=h)),i=i.next;while(i!==o);return n}function hIe(e,t){return Fn(e.prev,e,t.prev)<0&&Fn(t.next,e,e.next)<0}function dIe(e,t,i,r){let n=e;do n.z===0&&(n.z=z3(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,fIe(n)}function fIe(e){let t,i,r,n,s,a,o,l,u=1;do{for(i=e,e=null,s=null,a=0;i;){for(a++,r=i,o=0,t=0;t<u&&(o++,r=r.nextZ,!!r);t++);for(l=u;o>0||l>0&&r;)o!==0&&(l===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,o--):(n=r,r=r.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;i=r}s.nextZ=null,u*=2}while(a>1);return e}function z3(e,t,i,r,n){return e=(e-i)*n|0,t=(t-r)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function pIe(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function q0(e,t,i,r,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(r-o)>=(i-a)*(t-o)&&(i-a)*(s-o)>=(n-a)*(r-o)}function mIe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!gIe(e,t)&&(u_(e,t)&&u_(t,e)&&vIe(e,t)&&(Fn(e.prev,e,t.prev)||Fn(e,t.prev,t))||SM(e,t)&&Fn(e.prev,e,e.next)>0&&Fn(t.prev,t,t.next)>0)}function Fn(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function SM(e,t){return e.x===t.x&&e.y===t.y}function VJ(e,t,i,r){let n=jE(Fn(e,t,i)),s=jE(Fn(e,t,r)),a=jE(Fn(i,r,e)),o=jE(Fn(i,r,t));return!!(n!==s&&a!==o||n===0&&UE(e,i,t)||s===0&&UE(e,r,t)||a===0&&UE(i,e,r)||o===0&&UE(i,t,r))}function UE(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function jE(e){return e>0?1:e<0?-1:0}function gIe(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&VJ(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function u_(e,t){return Fn(e.prev,e,e.next)<0?Fn(e,t,e.next)>=0&&Fn(e,e.prev,t)>=0:Fn(e,t,e.prev)<0||Fn(e,e.next,t)<0}function vIe(e,t){let i=e,r=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}function HJ(e,t){let i=new F3(e.i,e.x,e.y),r=new F3(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function D8(e,t,i,r){let n=new F3(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function c_(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function F3(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yIe(e,t,i,r){let n=0;for(let s=t,a=i-r;s<i;s+=r)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var WJ=class{static area(e){let t=e.length,i=0;for(let r=t-1,n=0;n<t;r=n++)i+=e[r].x*e[n].y-e[n].x*e[r].y;return i*.5}static isClockWise(e){return WJ.area(e)<0}static triangulateShape(e,t){let i=[],r=[],n=[];I8(e),O8(i,e);let s=e.length;t.forEach(I8);for(let o=0;o<t.length;o++)r.push(s),s+=t[o].length,O8(i,t[o]);let a=iIe.triangulate(i,r);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function I8(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function O8(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}var GJ=class extends pB{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new GJ(e.radius,e.detail)}},ay=class extends ai{constructor(e=1,t=32,i=16,r=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let o=Math.min(s+a,Math.PI),l=0,u=[],c=new q,h=new q,d=[],f=[],m=[],g=[];for(let y=0;y<=i;y++){let x=[],w=y/i,b=0;y==0&&s==0?b=.5/t:y==i&&o==Math.PI&&(b=-.5/t);for(let C=0;C<=t;C++){let A=C/t;c.x=-e*Math.cos(r+A*n)*Math.sin(s+w*a),c.y=e*Math.cos(s+w*a),c.z=e*Math.sin(r+A*n)*Math.sin(s+w*a),f.push(c.x,c.y,c.z),h.copy(c).normalize(),m.push(h.x,h.y,h.z),g.push(A+b,1-w),x.push(l++)}u.push(x)}for(let y=0;y<i;y++)for(let x=0;x<t;x++){let w=u[y][x+1],b=u[y][x],C=u[y+1][x],A=u[y+1][x+1];(y!==0||s>0)&&d.push(w,b,A),(y!==i-1||o<Math.PI)&&d.push(b,C,A)}this.setIndex(d),this.setAttribute("position",new Vt(f,3)),this.setAttribute("normal",new Vt(m,3)),this.setAttribute("uv",new Vt(g,2))}static fromJSON(e){return new ay(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},qJ=class extends ai{constructor(e=1,t=.4,i=12,r=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:n},i=Math.floor(i),r=Math.floor(r);let s=[],a=[],o=[],l=[],u=new q,c=new q,h=new q;for(let d=0;d<=i;d++)for(let f=0;f<=r;f++){let m=f/r*n,g=d/i*Math.PI*2;c.x=(e+t*Math.cos(g))*Math.cos(m),c.y=(e+t*Math.cos(g))*Math.sin(m),c.z=t*Math.sin(g),a.push(c.x,c.y,c.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),h.subVectors(c,u).normalize(),o.push(h.x,h.y,h.z),l.push(f/r),l.push(d/i)}for(let d=1;d<=i;d++)for(let f=1;f<=r;f++){let m=(r+1)*d+f-1,g=(r+1)*(d-1)+f-1,y=(r+1)*(d-1)+f,x=(r+1)*d+f;s.push(m,g,x),s.push(g,y,x)}this.setIndex(s),this.setAttribute("position",new Vt(a,3)),this.setAttribute("normal",new Vt(o,3)),this.setAttribute("uv",new Vt(l,2))}static fromJSON(e){return new qJ(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},YJ=class extends ai{constructor(e=1,t=.4,i=64,r=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:n,q:s},i=Math.floor(i),r=Math.floor(r);let a=[],o=[],l=[],u=[],c=new q,h=new q,d=new q,f=new q,m=new q,g=new q,y=new q;for(let w=0;w<=i;++w){let b=w/i*n*Math.PI*2;x(b,n,s,e,d),x(b+.01,n,s,e,f),g.subVectors(f,d),y.addVectors(f,d),m.crossVectors(g,y),y.crossVectors(m,g),m.normalize(),y.normalize();for(let C=0;C<=r;++C){let A=C/r*Math.PI*2,E=-t*Math.cos(A),_=t*Math.sin(A);c.x=d.x+(E*y.x+_*m.x),c.y=d.y+(E*y.y+_*m.y),c.z=d.z+(E*y.z+_*m.z),o.push(c.x,c.y,c.z),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(w/i),u.push(C/r)}}for(let w=1;w<=i;w++)for(let b=1;b<=r;b++){let C=(r+1)*(w-1)+(b-1),A=(r+1)*w+(b-1),E=(r+1)*w+b,_=(r+1)*(w-1)+b;a.push(C,A,_),a.push(A,E,_)}this.setIndex(a),this.setAttribute("position",new Vt(o,3)),this.setAttribute("normal",new Vt(l,3)),this.setAttribute("uv",new Vt(u,2));function x(w,b,C,A,E){let _=Math.cos(w),P=Math.sin(w),I=C/b*w,D=Math.cos(I);E.x=A*(2+D)*.5*_,E.y=A*(2+D)*P*.5,E.z=A*Math.sin(I)*.5}}static fromJSON(e){return new YJ(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},xIe=class extends Cr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};function Ff(e,t,i){return XJ(e)?new e.constructor(e.subarray(t,i!==void 0?i:e.length)):e.slice(t,i)}function VE(e,t,i){return!e||e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function XJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function bIe(e){function t(n,s){return e[n]-e[s]}let i=e.length,r=new Array(i);for(let n=0;n!==i;++n)r[n]=n;return r.sort(t),r}function R8(e,t,i){let r=e.length,n=new e.constructor(r);for(let s=0,a=0;a!==r;++s){let o=i[s]*t;for(let l=0;l!==t;++l)n[a++]=e[o+l]}return n}function KJ(e,t,i,r){let n=1,s=e[0];for(;s!==void 0&&s[r]===void 0;)s=e[n++];if(s===void 0)return;let a=s[r];if(a!==void 0)if(Array.isArray(a))do a=s[r],a!==void 0&&(t.push(s.time),i.push.apply(i,a)),s=e[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[r],a!==void 0&&(t.push(s.time),a.toArray(i,i.length)),s=e[n++];while(s!==void 0);else do a=s[r],a!==void 0&&(t.push(s.time),i.push(a)),s=e[n++];while(s!==void 0)}var TM=class{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,r=t[i],n=t[i-1];e:{t:{let s;i:{r:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<n)break r;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(n=r,r=t[++i],e<r)break t}s=t.length;break i}if(!(e>=n)){let a=t[1];e<a&&(i=2,n=a);for(let o=i-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===o)break;if(r=n,n=t[--i-1],e>=n)break t}s=i,i=0;break i}break e}for(;i<s;){let a=i+s>>>1;e<t[a]?s=a:i=a+1}if(r=t[i],n=t[i-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=e*r;for(let s=0;s!==r;++s)t[s]=i[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},_Ie=class extends TM{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:H0,endingEnd:H0}}intervalChanged_(e,t,i){let r=this.parameterPositions,n=e-2,s=e+1,a=r[n],o=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case W0:n=e,a=2*t-i;break;case DC:n=r.length-2,a=t+r[n]-r[n+1];break;default:n=e,a=i}if(o===void 0)switch(this.getSettings_().endingEnd){case W0:s=e,o=2*i-t;break;case DC:s=1,o=i+r[1]-r[0];break;default:s=e-1,o=t}let l=(i-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-i),this._offsetPrev=n*u,this._offsetNext=s*u}interpolate_(e,t,i,r){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(i-t)/(r-t),m=f*f,g=m*f,y=-h*g+2*h*m-h*f,x=(1+h)*g+(-1.5-2*h)*m+(-.5+h)*f+1,w=(-1-d)*g+(1.5+d)*m+.5*f,b=d*g-d*m;for(let C=0;C!==a;++C)n[C]=y*s[u+C]+x*s[l+C]+w*s[o+C]+b*s[c+C];return n}},$J=class extends TM{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,u=(i-t)/(r-t),c=1-u;for(let h=0;h!==a;++h)n[h]=s[l+h]*c+s[o+h]*u;return n}},wIe=class extends TM{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}},jh=class{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=VE(t,this.TimeBufferType),this.values=VE(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:VE(e.times,Array),values:VE(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new wIe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new $J(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new _Ie(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case MC:t=this.InterpolantFactoryMethodDiscrete;break;case PC:t=this.InterpolantFactoryMethodLinear;break;case wD:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return MC;case this.InterpolantFactoryMethodLinear:return PC;case this.InterpolantFactoryMethodSmooth:return wD}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){let i=this.times,r=i.length,n=0,s=r-1;for(;n!==r&&i[n]<e;)++n;for(;s!==-1&&i[s]>t;)--s;if(++s,n!==0||s!==r){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=Ff(i,n,s),this.values=Ff(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,r=this.values,n=i.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let o=i[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(r!==void 0&&XJ(r))for(let a=0,o=r.length;a!==o;++a){let l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=Ff(this.times),t=Ff(this.values),i=this.getValueSize(),r=this.getInterpolation()===wD,n=e.length-1,s=1;for(let a=1;a<n;++a){let o=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(r)o=!0;else{let c=a*i,h=c-i,d=c+i;for(let f=0;f!==i;++f){let m=t[c+f];if(m!==t[h+f]||m!==t[d+f]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let c=a*i,h=s*i;for(let d=0;d!==i;++d)t[h+d]=t[c+d]}++s}}if(n>0){e[s]=e[n];for(let a=n*i,o=s*i,l=0;l!==i;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=Ff(e,0,s),this.values=Ff(t,0,s*i)):(this.times=e,this.values=t),this}clone(){let e=Ff(this.times,0),t=Ff(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};jh.prototype.TimeBufferType=Float32Array;jh.prototype.ValueBufferType=Float32Array;jh.prototype.DefaultInterpolation=PC;var o1=class extends jh{};o1.prototype.ValueTypeName="bool";o1.prototype.ValueBufferType=Array;o1.prototype.DefaultInterpolation=MC;o1.prototype.InterpolantFactoryMethodLinear=void 0;o1.prototype.InterpolantFactoryMethodSmooth=void 0;var ZJ=class extends jh{};ZJ.prototype.ValueTypeName="color";var kC=class extends jh{};kC.prototype.ValueTypeName="number";var EIe=class extends TM{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(i-t)/(r-t),l=e*a;for(let u=l+a;l!==u;l+=4)Si.slerpFlat(n,0,s,l-a,s,l,o);return n}},ew=class extends jh{InterpolantFactoryMethodLinear(e){return new EIe(this.times,this.values,this.getValueSize(),e)}};ew.prototype.ValueTypeName="quaternion";ew.prototype.DefaultInterpolation=PC;ew.prototype.InterpolantFactoryMethodSmooth=void 0;var l1=class extends jh{};l1.prototype.ValueTypeName="string";l1.prototype.ValueBufferType=Array;l1.prototype.DefaultInterpolation=MC;l1.prototype.InterpolantFactoryMethodLinear=void 0;l1.prototype.InterpolantFactoryMethodSmooth=void 0;var BC=class extends jh{};BC.prototype.ValueTypeName="vector";var U3=class{constructor(e,t=-1,i,r=rB){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Bu(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,r=1/(e.fps||1);for(let s=0,a=i.length;s!==a;++s)t.push(TIe(i[s]).scale(r));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=i.length;n!==s;++n)t.push(jh.toJSON(i[n]));return r}static CreateFromMorphTargetSequence(e,t,i,r){let n=t.length,s=[];for(let a=0;a<n;a++){let o=[],l=[];o.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let u=bIe(o);o=R8(o,1,u),l=R8(l,1,u),!r&&o[0]===0&&(o.push(n),l.push(l[0])),s.push(new kC(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let r={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],u=l.name.match(n);if(u&&u.length>1){let c=u[1],h=r[c];h||(r[c]=h=[]),h.push(l)}}let s=[];for(let a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(u,c,h,d,f){if(h.length!==0){let m=[],g=[];KJ(h,m,g,d),m.length!==0&&f.push(new u(c,m,g))}},r=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let u=0;u<l.length;u++){let c=l[u].keys;if(!(!c||c.length===0))if(c[0].morphTargets){let h={},d;for(d=0;d<c.length;d++)if(c[d].morphTargets)for(let f=0;f<c[d].morphTargets.length;f++)h[c[d].morphTargets[f]]=-1;for(let f in h){let m=[],g=[];for(let y=0;y!==c[d].morphTargets.length;++y){let x=c[d];m.push(x.time),g.push(x.morphTarget===f?1:0)}r.push(new kC(".morphTargetInfluence["+f+"]",m,g))}o=h.length*s}else{let h=".bones["+t[u].name+"]";i(BC,h+".position",c,"pos",r),i(ew,h+".quaternion",c,"rot",r),i(BC,h+".scale",c,"scl",r)}}return r.length===0?null:new this(n,o,r,a)}resetDuration(){let e=this.tracks,t=0;for(let i=0,r=e.length;i!==r;++i){let n=this.tracks[i];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function SIe(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return kC;case"vector":case"vector2":case"vector3":case"vector4":return BC;case"color":return ZJ;case"quaternion":return ew;case"bool":case"boolean":return o1;case"string":return l1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function TIe(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=SIe(e.type);if(e.times===void 0){let i=[],r=[];KJ(e.keys,i,r,"value"),e.times=i,e.values=r}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var zC={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},QJ=class{constructor(e,t,i){let r=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,n===!1&&r.onStart!==void 0&&r.onStart(u,s,a),n=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,a),s===a&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return o?o(u):u},this.setURLModifier=function(u){return o=u,this},this.addHandler=function(u,c){return l.push(u,c),this},this.removeHandler=function(u){let c=l.indexOf(u);return c!==-1&&l.splice(c,2),this},this.getHandler=function(u){for(let c=0,h=l.length;c<h;c+=2){let d=l[c],f=l[c+1];if(d.global&&(d.lastIndex=0),d.test(u))return f}return null}}},CIe=new QJ,tw=class{constructor(e){this.manager=e!==void 0?e:CIe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let i=this;return new Promise(function(r,n){i.load(e,r,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},wd={},AIe=class extends Error{constructor(e,t){super(e),this.response=t}},j3=class extends tw{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=zC.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(wd[e]!==void 0){wd[e].push({onLoad:t,onProgress:i,onError:r});return}wd[e]=[],wd[e].push({onLoad:t,onProgress:i,onError:r});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let u=wd[e],c=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=h?parseInt(h):0,f=d!==0,m=0,g=new ReadableStream({start(y){x();function x(){c.read().then(({done:w,value:b})=>{if(w)y.close();else{m+=b.byteLength;let C=new ProgressEvent("progress",{lengthComputable:f,loaded:m,total:d});for(let A=0,E=u.length;A<E;A++){let _=u[A];_.onProgress&&_.onProgress(C)}y.enqueue(b),x()}})}}});return new Response(g)}else throw new AIe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return l.json();default:if(a===void 0)return l.text();{let u=/charset="?([^;"\s]*)"?/i.exec(a),c=u&&u[1]?u[1].toLowerCase():void 0,h=new TextDecoder(c);return l.arrayBuffer().then(d=>h.decode(d))}}}).then(l=>{zC.add(e,l);let u=wd[e];delete wd[e];for(let c=0,h=u.length;c<h;c++){let d=u[c];d.onLoad&&d.onLoad(l)}}).catch(l=>{let u=wd[e];if(u===void 0)throw this.manager.itemError(e),l;delete wd[e];for(let c=0,h=u.length;c<h;c++){let d=u[c];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},MIe=class extends tw{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=zC.get(e);if(s!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let a=a_("img");function o(){u(),zC.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(c){u(),r&&r(c),n.manager.itemError(e),n.manager.itemEnd(e)}function u(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(e),a.src=e,a}},PIe=class extends tw{constructor(e){super(e)}load(e,t,i,r){let n=new jn,s=new MIe(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){n.image=a,n.needsUpdate=!0,t!==void 0&&t(n)},i,r),n}},iw=class extends qr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new mi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},DIe=class extends iw{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(qr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new mi(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},QD=new Pt,L8=new q,N8=new q,mB=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ie(512,512),this.map=null,this.mapPass=null,this.matrix=new Pt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new oB,this._frameExtents=new Ie(1,1),this._viewportCount=1,this._viewports=[new Pi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;L8.setFromMatrixPosition(e.matrixWorld),t.position.copy(L8),N8.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(N8),t.updateMatrixWorld(),QD.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(QD),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(QD)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},IIe=class extends mB{constructor(){super(new ho(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=s_*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(i!==t.fov||r!==t.aspect||n!==t.far)&&(t.fov=i,t.aspect=r,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},OIe=class extends iw{constructor(e,t,i=0,r=Math.PI/3,n=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(qr.DEFAULT_UP),this.updateMatrix(),this.target=new qr,this.distance=i,this.angle=r,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new IIe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},k8=new Pt,rx=new q,JD=new q,RIe=class extends mB{constructor(){super(new ho(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ie(4,2),this._viewportCount=6,this._viewports=[new Pi(2,1,1,1),new Pi(0,1,1,1),new Pi(3,1,1,1),new Pi(1,1,1,1),new Pi(3,0,1,1),new Pi(1,0,1,1)],this._cubeDirections=[new q(1,0,0),new q(-1,0,0),new q(0,0,1),new q(0,0,-1),new q(0,1,0),new q(0,-1,0)],this._cubeUps=[new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,0,1),new q(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,r=this.matrix,n=e.distance||i.far;n!==i.far&&(i.far=n,i.updateProjectionMatrix()),rx.setFromMatrixPosition(e.matrixWorld),i.position.copy(rx),JD.copy(i.position),JD.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(JD),i.updateMatrixWorld(),r.makeTranslation(-rx.x,-rx.y,-rx.z),k8.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(k8)}},LIe=class extends iw{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new RIe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},NIe=class extends mB{constructor(){super(new _M(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},kIe=class extends iw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(qr.DEFAULT_UP),this.updateMatrix(),this.target=new qr,this.shadow=new NIe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},JJ=class extends ai{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},eee=class extends tw{constructor(e){super(e)}load(e,t,i,r){let n=this,s=new j3(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){r?r(o):console.error(o),n.manager.itemError(e)}},i,r)}parse(e){let t={},i={};function r(h,d){if(t[d]!==void 0)return t[d];let f=h.interleavedBuffers[d],m=n(h,f.buffer),g=yE(f.type,m),y=new FDe(g,f.stride);return y.uuid=f.uuid,t[d]=y,y}function n(h,d){if(i[d]!==void 0)return i[d];let f=h.arrayBuffers[d],m=new Uint32Array(f).buffer;return i[d]=m,m}let s=e.isInstancedBufferGeometry?new JJ:new ai,a=e.data.index;if(a!==void 0){let h=yE(a.type,a.array);s.setIndex(new gi(h,1))}let o=e.data.attributes;for(let h in o){let d=o[h],f;if(d.isInterleavedBufferAttribute){let m=r(e.data,d.data);f=new B3(m,d.itemSize,d.offset,d.normalized)}else{let m=yE(d.type,d.array),g=d.isInstancedBufferAttribute?o_:gi;f=new g(m,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(h,f)}let l=e.data.morphAttributes;if(l)for(let h in l){let d=l[h],f=[];for(let m=0,g=d.length;m<g;m++){let y=d[m],x;if(y.isInterleavedBufferAttribute){let w=r(e.data,y.data);x=new B3(w,y.itemSize,y.offset,y.normalized)}else{let w=yE(y.type,y.array);x=new gi(w,y.itemSize,y.normalized)}y.name!==void 0&&(x.name=y.name),f.push(x)}s.morphAttributes[h]=f}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let h=0,d=u.length;h!==d;++h){let f=u[h];s.addGroup(f.start,f.count,f.materialIndex)}let c=e.data.boundingSphere;if(c!==void 0){let h=new q;c.center!==void 0&&h.fromArray(c.center),s.boundingSphere=new Rl(h,c.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},BIe=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=B8(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=B8();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function B8(){return(typeof performance>"u"?Date:performance).now()}var zIe=class{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,n,s;switch(t){case"quaternion":r=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let i=this.buffer,r=this.valueSize,n=e*r+r,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)i[n+a]=i[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(i,n,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,i=this.buffer,r=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let o=t*this._origIndex;this._mixBufferRegion(i,r,o,1-n,t)}s>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(i[o]!==i[o+t]){a.setValue(i,r);break}}saveOriginalState(){let e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let n=i,s=r;n!==s;++n)t[n]=t[r+n%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,n){if(r>=.5)for(let s=0;s!==n;++s)e[t+s]=e[i+s]}_slerp(e,t,i,r){Si.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,n){let s=this._workIndex*n;Si.multiplyQuaternionsFlat(e,s,e,t,e,i),Si.slerpFlat(e,t,e,t,e,s,r)}_lerp(e,t,i,r,n){let s=1-r;for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]*s+e[i+a]*r}}_lerpAdditive(e,t,i,r,n){for(let s=0;s!==n;++s){let a=t+s;e[a]=e[a]+e[i+s]*r}}},gB="\\[\\]\\.:\\/",FIe=new RegExp("["+gB+"]","g"),vB="[^"+gB+"]",UIe="[^"+gB.replace("\\.","")+"]",jIe=/((?:WC+[\/:])*)/.source.replace("WC",vB),VIe=/(WCOD+)?/.source.replace("WCOD",UIe),HIe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vB),WIe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vB),GIe=new RegExp("^"+jIe+VIe+HIe+WIe+"$"),qIe=["material","materials","bones","map"],YIe=class{constructor(e,t,i){let r=i||rn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},rn=class{constructor(e,t,i){this.path=t,this.parsedPath=i||rn.parseTrackName(t),this.node=rn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new rn.Composite(e,t,i):new rn(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(FIe,"")}static parseTrackName(e){let t=GIe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let n=i.nodeName.substring(r+1);qIe.indexOf(n)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=n)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){let i=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let o=i(a.children);if(o)return o}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,i=t.objectName,r=t.propertyName,n=t.propertyIndex;if(e||(e=rn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let l=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[r];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(n!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};rn.Composite=YIe;rn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};rn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};rn.prototype.GetterByBindingType=[rn.prototype._getValue_direct,rn.prototype._getValue_array,rn.prototype._getValue_arrayElement,rn.prototype._getValue_toArray];rn.prototype.SetterByBindingTypeAndVersioning=[[rn.prototype._setValue_direct,rn.prototype._setValue_direct_setNeedsUpdate,rn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[rn.prototype._setValue_array,rn.prototype._setValue_array_setNeedsUpdate,rn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[rn.prototype._setValue_arrayElement,rn.prototype._setValue_arrayElement_setNeedsUpdate,rn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[rn.prototype._setValue_fromArray,rn.prototype._setValue_fromArray_setNeedsUpdate,rn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var XIe=class{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;let n=t.tracks,s=n.length,a=new Array(s),o={endingStart:H0,endingEnd:H0};for(let l=0;l!==s;++l){let u=n[l].createInterpolant(null);a[l]=u,u.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vJ,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){let r=this._clip.duration,n=e._clip.duration,s=n/r,a=r/n;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){let r=this._mixer,n=r.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=n,o[1]=n+i,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let o=(e-n)*i;o<0||i===0?t=0:(this._startTime=null,t=i*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case ECe:for(let u=0,c=o.length;u!==c;++u)o[u].evaluate(s),l[u].accumulateAdditive(a);break;case rB:default:for(let u=0,c=o.length;u!==c;++u)o[u].evaluate(s),l[u].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let i=this._weightInterpolant;if(i!==null){let r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,i=this.loop,r=this.time+e,n=this._loopCount,s=i===iB;if(e===0)return n===-1?r:s&&(n&1)===1?t-r:r;if(i===gJ){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=t||r<0){let a=Math.floor(r/t);r-=t*a,n+=Math.abs(a);let o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(n&1)===1)return t-r}return r}_setEndings(e,t,i){let r=this._interpolantSettings;i?(r.endingStart=W0,r.endingEnd=W0):(e?r.endingStart=this.zeroSlopeAtStart?W0:H0:r.endingStart=DC,t?r.endingEnd=this.zeroSlopeAtEnd?W0:H0:r.endingEnd=DC)}_scheduleFading(e,t,i){let r=this._mixer,n=r.time,s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=n,o[0]=t,a[1]=n+e,o[1]=i,this}},KIe=new Float32Array(1),$Ie=class extends qa{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let i=e._localRoot||this._root,r=e._clip.tracks,n=r.length,s=e._propertyBindings,a=e._interpolants,o=i.uuid,l=this._bindingsByRootAndName,u=l[o];u===void 0&&(u={},l[o]=u);for(let c=0;c!==n;++c){let h=r[c],d=h.name,f=u[d];if(f!==void 0)++f.referenceCount,s[c]=f;else{if(f=s[c],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,o,d));continue}let m=t&&t._propertyBindings[c].binding.parsedPath;f=new zIe(rn.create(i,d,m),h.ValueTypeName,h.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,o,d),s[c]=f}a[c].resultBuffer=f.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let i=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,i)}let t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){let n=t[i];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){let n=t[i];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){let r=this._actions,n=this._actionsByClip,s=n[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[i]=e}_removeInactiveAction(e){let t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,s=this._actionsByClip,a=s[n],o=a.knownActions,l=o[o.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,o[u]=l,o.pop(),e._byClipCacheIndex=null;let c=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete c[h],o.length===0&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){let n=t[i];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_takeBackAction(e){let t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_addInactiveBinding(e,t,i){let r=this._bindingsByRootAndName,n=this._bindings,s=r[t];s===void 0&&(s={},r[t]=s),s[i]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,i=e.binding,r=i.rootNode.uuid,n=i.path,s=this._bindingsByRootAndName,a=s[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[n],Object.keys(a).length===0&&delete s[r]}_lendBinding(e){let t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_takeBackBinding(e){let t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return i===void 0&&(i=new $J(new Float32Array(2),new Float32Array(2),1,KIe),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){let t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,n=t[r];e.__cacheIndex=r,t[r]=e,n.__cacheIndex=i,t[i]=n}clipAction(e,t,i){let r=t||this._root,n=r.uuid,s=typeof e=="string"?U3.findByName(r,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(i===void 0&&(s!==null?i=s.blendMode:i=rB),o!==void 0){let c=o.actionByRoot[n];if(c!==void 0&&c.blendMode===i)return c;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let u=new XIe(this,s,t,i);return this._bindAction(u,l),this._addInactiveAction(u,a,n),u}existingAction(e,t){let i=t||this._root,r=i.uuid,n=typeof e=="string"?U3.findByName(i,e):e,s=n?n.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;let t=this._actions,i=this._nActiveActions,r=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==i;++l)t[l]._update(r,e,n,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,i=e.uuid,r=this._actionsByClip,n=r[i];if(n!==void 0){let s=n.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(e){let t=e.uuid,i=this._actionsByClip;for(let s in i){let a=i[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let r=this._bindingsByRootAndName,n=r[t];if(n!==void 0)for(let s in n){let a=n[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},wt=class{constructor(t){this.value=t}clone(){return new wt(this.value.clone===void 0?this.value:this.value.clone())}},tee=class{constructor(e,t,i=0,r=1/0){this.ray=new n1(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new sB,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return V3(e,this,i,t),i.sort(z8),i}intersectObjects(e,t=!0,i=[]){for(let r=0,n=e.length;r<n;r++)V3(e[r],this,i,t);return i.sort(z8),i}};function z8(e,t){return e.distance-t.distance}function V3(e,t,i,r){if(e.layers.test(t.layers)&&e.raycast(t,i),r===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)V3(n[s],t,i,!0)}}var F8=class{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Ms(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},U8=new Ie,yB=class{constructor(e=new Ie(1/0,1/0),t=new Ie(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=U8.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return U8.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},j8=new q,HE=new q,zu=class{constructor(e=new q,t=new q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){j8.subVectors(e,this.start),HE.subVectors(this.end,this.start);let i=HE.dot(HE),r=HE.dot(j8)/i;return t&&(r=Ms(r,0,1)),r}closestPointToPoint(e,t,i){let r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},V8=new q,ZIe=class extends qr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let i=new ai,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,u=a/o*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Vt(r,3));let n=new am({fog:!1,toneMapped:!1});this.cone=new J_(i,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),V8.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(V8),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},QIe=class extends dn{constructor(e,t,i){let r=new ay(t,4,2),n=new uf({wireframe:!0,fog:!1,toneMapped:!1});super(r,n),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},H8=new q,WE=new q,W8=new q,JIe=class extends qr{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new ai;r.setAttribute("position",new Vt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new am({fog:!1,toneMapped:!1});this.lightPlane=new RC(r,n),this.add(this.lightPlane),r=new ai,r.setAttribute("position",new Vt([0,0,0,0,0,1],3)),this.targetLine=new RC(r,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),H8.setFromMatrixPosition(this.light.matrixWorld),WE.setFromMatrixPosition(this.light.target.matrixWorld),W8.subVectors(WE,H8),this.lightPlane.lookAt(WE),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(WE),this.targetLine.scale.z=W8.length()}},GE=new q,Yn=new sm,FC=class extends J_{constructor(e){let t=new ai,i=new am({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],n=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(f,m){o(f),o(m)}function o(f){r.push(0,0,0),n.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(r.length/3-1)}t.setAttribute("position",new Vt(r,3)),t.setAttribute("color",new Vt(n,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new mi(16755200),u=new mi(16711680),c=new mi(43775),h=new mi(16777215),d=new mi(3355443);this.setColors(l,u,c,h,d)}setColors(e,t,i,r,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,i=1,r=1;Yn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),us("c",t,e,Yn,0,0,-1),us("t",t,e,Yn,0,0,1),us("n1",t,e,Yn,-1,-1,-1),us("n2",t,e,Yn,i,-1,-1),us("n3",t,e,Yn,-1,r,-1),us("n4",t,e,Yn,i,r,-1),us("f1",t,e,Yn,-1,-1,1),us("f2",t,e,Yn,i,-1,1),us("f3",t,e,Yn,-1,r,1),us("f4",t,e,Yn,i,r,1),us("u1",t,e,Yn,i*.7,r*1.1,-1),us("u2",t,e,Yn,-1*.7,r*1.1,-1),us("u3",t,e,Yn,0,r*2,-1),us("cf1",t,e,Yn,-1,0,1),us("cf2",t,e,Yn,i,0,1),us("cf3",t,e,Yn,0,-1,1),us("cf4",t,e,Yn,0,r,1),us("cn1",t,e,Yn,-1,0,-1),us("cn2",t,e,Yn,i,0,-1),us("cn3",t,e,Yn,0,-1,-1),us("cn4",t,e,Yn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function us(e,t,i,r,n,s,a){GE.set(n,s,a).unproject(r);let o=t[e];if(o!==void 0){let l=i.getAttribute("position");for(let u=0,c=o.length;u<c;u++)l.setXYZ(o[u],GE.x,GE.y,GE.z)}}var UC=class extends J_{constructor(e,t=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new ai;n.setIndex(new gi(i,1)),n.setAttribute("position",new Vt(r,3)),super(n,new am({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},eOe=class extends J_{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new ai;r.setAttribute("position",new Vt(t,3)),r.setAttribute("color",new Vt(i,3));let n=new am({vertexColors:!0,toneMapped:!1});super(r,n),this.type="AxesHelper"}setColors(e,t,i){let r=new mi,n=this.geometry.attributes.color.array;return r.set(e),r.toArray(n,0),r.toArray(n,3),r.set(t),r.toArray(n,6),r.toArray(n,9),r.set(i),r.toArray(n,12),r.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},jd=tOe();function tOe(){let e=new ArrayBuffer(4),t=new Float32Array(e),i=new Uint32Array(e),r=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let u=l-127;u<-27?(r[l]=0,r[l|256]=32768,n[l]=24,n[l|256]=24):u<-14?(r[l]=1024>>-u-14,r[l|256]=1024>>-u-14|32768,n[l]=-u-1,n[l|256]=-u-1):u<=15?(r[l]=u+15<<10,r[l|256]=u+15<<10|32768,n[l]=13,n[l|256]=13):u<128?(r[l]=31744,r[l|256]=64512,n[l]=24,n[l|256]=24):(r[l]=31744,r[l|256]=64512,n[l]=13,n[l|256]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;!(u&8388608);)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:t,uint32View:i,baseTable:r,shiftTable:n,mantissaTable:s,exponentTable:a,offsetTable:o}}function iOe(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Ms(e,-65504,65504),jd.floatView[0]=e;let t=jd.uint32View[0],i=t>>23&511;return jd.baseTable[i]+((t&8388607)>>jd.shiftTable[i])}function rOe(e){let t=e>>10;return jd.uint32View[0]=jd.mantissaTable[jd.offsetTable[t]+(e&1023)]+jd.exponentTable[t],jd.floatView[0]}var nOe=Object.freeze({__proto__:null,fromHalfFloat:rOe,toHalfFloat:iOe});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r1}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r1);var nx=".",xB=Symbol("target"),iee=Symbol("unsubscribe");function H3(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function sOe(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var gh=Array.isArray;function bB(e){return typeof e=="symbol"}var aOe={after:(e,t)=>gh(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>gh(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=nx),bB(t)?e+t.toString():e+t):e,initial:e=>{if(gh(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(nx);return t===-1?"":e.slice(0,t)},last:e=>{if(gh(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(nx);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(gh(e))for(let i of e)t(i);else if(e!==""){let i=0,r=e.indexOf(nx);if(r===-1)t(e);else for(;i<e.length;)r===-1&&(r=e.length),t(e.slice(i,r)),i=r+1,r=e.indexOf(nx,i)}},get(e,t){return this.walk(t,i=>{e&&(e=e[i])}),e}},Tu=aOe;function oOe(e){return typeof e=="object"&&typeof e.next=="function"}function lOe(e,t,i,r,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],r),a.value[1]=n(a.value[1],t,a.value[0],r)),a};else if(t.name==="values"){let a=i[xB].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,r)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,r)),a};return e}function G8(e,t,i){return e.isUnsubscribed||t.ignoreSymbols&&bB(i)||t.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(i)}var uOe=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),i=t.get(e);return i===void 0&&(i={},t.set(e,i)),i}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let i=this._getProperties(e),r=i[t];return r===void 0&&(r=Reflect.getOwnPropertyDescriptor(e,t),i[t]=r),r}getProxy(e,t,i,r){if(this.isUnsubscribed)return e;let n=e[r],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,i):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Tu.get(t,this.getPath(e)))}defineProperty(e,t,i){return Reflect.defineProperty(e,t,i)?(this.isUnsubscribed||(this._getProperties(e)[t]=i),!0):!1}setProperty(e,t,i,r,n){if(!this._equals(n,i)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,i,r):Reflect.set(e,t,i)}return!0}deleteProperty(e,t,i){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let r=this._getDescriptorCache().get(e);r&&(delete r[t],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(e,t,i){let r=this._getOwnPropertyDescriptor(t,i);return e!==void 0&&r!==void 0&&Object.is(e.value,r.value)&&(e.writable||!1)===(r.writable||!1)&&(e.enumerable||!1)===(r.enumerable||!1)&&(e.configurable||!1)===(r.configurable||!1)&&e.get===r.get&&e.set===r.set}isGetInvariant(e,t){let i=this._getOwnPropertyDescriptor(e,t);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function W3(e){return toString.call(e)==="[object Object]"}function qE(){return!0}function Yv(e,t){return e.length!==t.length||e.some((i,r)=>t[r]!==i)}var ree=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),cOe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),nee={push:qE,pop:qE,shift:qE,unshift:qE,copyWithin:Yv,reverse:Yv,sort:Yv,splice:Yv,flat:Yv,fill:Yv},hOe=new Set([...ree,...cOe,...Object.keys(nee)]);function YE(e,t){if(e.size!==t.size)return!0;for(let i of e)if(!t.has(i))return!0;return!1}var see=["keys","values","entries"],aee=new Set(["has","toString"]),oee={add:YE,clear:YE,delete:YE,forEach:YE},dOe=new Set([...aee,...Object.keys(oee),...see]);function XE(e,t){if(e.size!==t.size)return!0;let i;for(let[r,n]of e)if(i=t.get(r),i!==n||i===void 0&&!t.has(r))return!0;return!1}var fOe=new Set([...aee,"get"]),lee={set:XE,clear:XE,delete:XE,forEach:XE},pOe=new Set([...fOe,...Object.keys(lee),...see]),Xp=class{constructor(e,t,i,r){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=r,this._changes=r?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return ree.has(e)}_shallowClone(e){let t=e;if(W3(e))t={...e};else if(gh(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(i=>this._shallowClone(i)));else if(e instanceof Map){t=new Map;for(let[i,r]of e.entries())t.set(i,this._shallowClone(r))}return this._clonedCache.add(t),t}preferredThisArg(e,t,i,r){return e?(gh(r)?this._onIsChanged=nee[t]:r instanceof Set?this._onIsChanged=oee[t]:r instanceof Map&&(this._onIsChanged=lee[t]),r):i}update(e,t,i){let r=Tu.after(e,this._path);if(t!=="length"){let n=this.clone;Tu.walk(r,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:r,property:t,previous:i}),n&&n[t]&&(n[t]=i)}this._isChanged=!0}undo(e){let t;for(let i=this._changes.length-1;i!==-1;i--)t=this._changes[i],Tu.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},q8=class extends Xp{static isHandledMethod(e){return hOe.has(e)}},mOe=class extends Xp{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},Y8=class extends Xp{static isHandledMethod(e){return dOe.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},X8=class extends Xp{static isHandledMethod(e){return pOe.has(e)}undo(e){for(let[t,i]of this.clone.entries())e.set(t,i);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},gOe=class extends Xp{constructor(e,t,i,r){super(void 0,t,i,r),this._arg1=i[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},vOe=class extends Xp{constructor(e,t,i,r){super(void 0,t,i,r),this._weakKey=i[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},g0=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return W3(e)||gh(e)||H3(e)}static isHandledMethod(e,t){return W3(e)?Xp.isHandledMethod(t):gh(e)?q8.isHandledMethod(t):e instanceof Set?Y8.isHandledMethod(t):e instanceof Map?X8.isHandledMethod(t):H3(e)}get isCloning(){return this._stack.length>0}start(e,t,i){let r=Xp;gh(e)?r=q8:e instanceof Date?r=mOe:e instanceof Set?r=Y8:e instanceof Map?r=X8:e instanceof WeakSet?r=gOe:e instanceof WeakMap&&(r=vOe),this._stack.push(new r(e,t,i,this._hasOnValidate))}update(e,t,i){this._stack[this._stack.length-1].update(e,t,i)}preferredThisArg(e,t,i){let{name:r}=e,n=g0.isHandledMethod(i,r);return this._stack[this._stack.length-1].preferredThisArg(n,r,t,i)}isChanged(e,t,i){return this._stack[this._stack.length-1].isChanged(e,t,i)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},yOe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},_B=(e,t,i={})=>{i={...yOe,...i};let r=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=i,l=new uOe(n),u=typeof i.onValidate=="function",c=new g0(u),h=(w,b,C,A,E)=>!u||c.isCloning||i.onValidate(Tu.concat(l.getPath(w),b),C,A,E)===!0,d=(w,b,C,A)=>{!G8(l,i,b)&&!(a&&l.isDetached(w,e))&&f(l.getPath(w),b,C,A)},f=(w,b,C,A,E)=>{c.isCloning?c.update(w,b,A):t(Tu.concat(w,b),C,A,E)},m=w=>w&&(w[r]||w),g=(w,b,C,A)=>sOe(w)||C==="constructor"||s&&!g0.isHandledMethod(b,C)||G8(l,i,C)||l.isGetInvariant(b,C)||a&&l.isDetached(b,e)?w:(A===void 0&&(A=l.getPath(b)),l.getProxy(w,Tu.concat(A,C),y,r)),y={get(w,b,C){if(bB(b)){if(b===r||b===xB)return w;if(b===iee&&!l.isUnsubscribed&&l.getPath(w).length===0)return l.unsubscribe(),w}let A=H3(w)?Reflect.get(w,b):Reflect.get(w,b,C);return g(A,w,b)},set(w,b,C,A){C=m(C);let E=w[r]||w,_=E[b];if(n(_,C)&&b in w)return!0;let P=h(w,b,C,_);return P&&l.setProperty(E,b,C,A,_)?(d(w,b,w[b],_),!0):!P},defineProperty(w,b,C){if(!l.isSameDescriptor(C,w,b)){let A=w[b];h(w,b,C.value,A)&&l.defineProperty(w,b,C,A)&&d(w,b,C.value,A)}return!0},deleteProperty(w,b){if(!Reflect.has(w,b))return!0;let C=Reflect.get(w,b),A=h(w,b,void 0,C);return A&&l.deleteProperty(w,b,C)?(d(w,b,void 0,C),!0):!A},apply(w,b,C){let A=b[r]||b;if(l.isUnsubscribed)return Reflect.apply(w,A,C);if((o===!1||o!==!0&&!o.includes(w.name))&&g0.isHandledType(A)){let E=Tu.initial(l.getPath(w)),_=g0.isHandledMethod(A,w.name);c.start(A,E,C);let P=Reflect.apply(w,c.preferredThisArg(w,b,A),_?C.map(k=>m(k)):C),I=c.isChanged(A,n),D=c.stop();if(g0.isHandledType(P)&&_&&(b instanceof Map&&w.name==="get"&&(E=Tu.concat(E,C[0])),P=l.getProxy(P,E,y)),I){let k={name:w.name,args:C,result:P},B=c.isCloning?Tu.initial(E):E,z=c.isCloning?Tu.last(E):"";h(Tu.get(e,B),z,A,D,k)?f(B,z,A,D,k):c.undo(A)}return(b instanceof Map||b instanceof Set)&&oOe(P)?lOe(P,w,b,E,g):P}return Reflect.apply(w,b,C)}},x=l.getProxy(e,i.pathAsArray?[]:"",y);return t=t.bind(x),u&&(i.onValidate=i.onValidate.bind(x)),x};_B.target=e=>e&&e[xB]||e;_B.unsubscribe=e=>e[iee]||e;var K8=_B,xOe=typeof global=="object"&&global&&global.Object===Object&&global,uee=xOe,bOe=typeof self=="object"&&self&&self.Object===Object&&self,_Oe=uee||bOe||Function("return this")(),Rc=_Oe,wOe=Rc.Symbol,Vu=wOe,cee=Object.prototype,EOe=cee.hasOwnProperty,SOe=cee.toString,sx=Vu?Vu.toStringTag:void 0;function TOe(e){var t=EOe.call(e,sx),i=e[sx];try{e[sx]=void 0;var r=!0}catch{}var n=SOe.call(e);return r&&(t?e[sx]=i:delete e[sx]),n}var COe=TOe,AOe=Object.prototype,MOe=AOe.toString;function POe(e){return MOe.call(e)}var DOe=POe,IOe="[object Null]",OOe="[object Undefined]",$8=Vu?Vu.toStringTag:void 0;function ROe(e){return e==null?e===void 0?OOe:IOe:$8&&$8 in Object(e)?COe(e):DOe(e)}var uv=ROe;function LOe(e){return e!=null&&typeof e=="object"}var cf=LOe,NOe="[object Symbol]";function kOe(e){return typeof e=="symbol"||cf(e)&&uv(e)==NOe}var rw=kOe;function BOe(e,t){for(var i=-1,r=e==null?0:e.length,n=Array(r);++i<r;)n[i]=t(e[i],i,e);return n}var hee=BOe,zOe=Array.isArray,kh=zOe,Z8=Vu?Vu.prototype:void 0,Q8=Z8?Z8.toString:void 0;function dee(e){if(typeof e=="string")return e;if(kh(e))return hee(e,dee)+"";if(rw(e))return Q8?Q8.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var FOe=dee,UOe=/\s/;function jOe(e){for(var t=e.length;t--&&UOe.test(e.charAt(t)););return t}var VOe=jOe,HOe=/^\s+/;function WOe(e){return e&&e.slice(0,VOe(e)+1).replace(HOe,"")}var GOe=WOe;function qOe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ic=qOe,J8=NaN,YOe=/^[-+]0x[0-9a-f]+$/i,XOe=/^0b[01]+$/i,KOe=/^0o[0-7]+$/i,$Oe=parseInt;function ZOe(e){if(typeof e=="number")return e;if(rw(e))return J8;if(Ic(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ic(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=GOe(e);var i=XOe.test(e);return i||KOe.test(e)?$Oe(e.slice(2),i?2:8):YOe.test(e)?J8:+e}var e9=ZOe;function QOe(e){return e}var fee=QOe,JOe="[object AsyncFunction]",eRe="[object Function]",tRe="[object GeneratorFunction]",iRe="[object Proxy]";function rRe(e){if(!Ic(e))return!1;var t=uv(e);return t==eRe||t==tRe||t==JOe||t==iRe}var pee=rRe,nRe=Rc["__core-js_shared__"],eI=nRe,t9=function(){var e=/[^.]+$/.exec(eI&&eI.keys&&eI.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function sRe(e){return!!t9&&t9 in e}var aRe=sRe,oRe=Function.prototype,lRe=oRe.toString;function uRe(e){if(e!=null){try{return lRe.call(e)}catch{}try{return e+""}catch{}}return""}var cv=uRe,cRe=/[\\^$.*+?()[\]{}|]/g,hRe=/^\[object .+?Constructor\]$/,dRe=Function.prototype,fRe=Object.prototype,pRe=dRe.toString,mRe=fRe.hasOwnProperty,gRe=RegExp("^"+pRe.call(mRe).replace(cRe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function vRe(e){if(!Ic(e)||aRe(e))return!1;var t=pee(e)?gRe:hRe;return t.test(cv(e))}var yRe=vRe;function xRe(e,t){return e==null?void 0:e[t]}var bRe=xRe;function _Re(e,t){var i=bRe(e,t);return yRe(i)?i:void 0}var hv=_Re,wRe=hv(Rc,"WeakMap"),G3=wRe,i9=Object.create,ERe=function(){function e(){}return function(t){if(!Ic(t))return{};if(i9)return i9(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),SRe=ERe;function TRe(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var CRe=TRe;function ARe(e,t){var i=-1,r=e.length;for(t||(t=Array(r));++i<r;)t[i]=e[i];return t}var MRe=ARe,PRe=800,DRe=16,IRe=Date.now;function ORe(e){var t=0,i=0;return function(){var r=IRe(),n=DRe-(r-i);if(i=r,n>0){if(++t>=PRe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var RRe=ORe;function LRe(e){return function(){return e}}var NRe=LRe,kRe=function(){try{var e=hv(Object,"defineProperty");return e({},"",{}),e}catch{}}(),jC=kRe,BRe=jC?function(e,t){return jC(e,"toString",{configurable:!0,enumerable:!1,value:NRe(t),writable:!0})}:fee,zRe=BRe,FRe=RRe(zRe),URe=FRe;function jRe(e,t){for(var i=-1,r=e==null?0:e.length;++i<r&&t(e[i],i,e)!==!1;);return e}var VRe=jRe,HRe=9007199254740991,WRe=/^(?:0|[1-9]\d*)$/;function GRe(e,t){var i=typeof e;return t=t??HRe,!!t&&(i=="number"||i!="symbol"&&WRe.test(e))&&e>-1&&e%1==0&&e<t}var wB=GRe;function qRe(e,t,i){t=="__proto__"&&jC?jC(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var mee=qRe;function YRe(e,t){return e===t||e!==e&&t!==t}var EB=YRe,XRe=Object.prototype,KRe=XRe.hasOwnProperty;function $Re(e,t,i){var r=e[t];(!(KRe.call(e,t)&&EB(r,i))||i===void 0&&!(t in e))&&mee(e,t,i)}var SB=$Re;function ZRe(e,t,i,r){var n=!i;i||(i={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=r?r(i[o],e[o],o,i,e):void 0;l===void 0&&(l=e[o]),n?mee(i,o,l):SB(i,o,l)}return i}var nw=ZRe,r9=Math.max;function QRe(e,t,i){return t=r9(t===void 0?e.length-1:t,0),function(){for(var r=arguments,n=-1,s=r9(r.length-t,0),a=Array(s);++n<s;)a[n]=r[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=r[n];return o[t]=i(a),CRe(e,this,o)}}var JRe=QRe,e3e=9007199254740991;function t3e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=e3e}var TB=t3e;function i3e(e){return e!=null&&TB(e.length)&&!pee(e)}var gee=i3e,r3e=Object.prototype;function n3e(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||r3e;return e===i}var CB=n3e;function s3e(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}var a3e=s3e,o3e="[object Arguments]";function l3e(e){return cf(e)&&uv(e)==o3e}var n9=l3e,vee=Object.prototype,u3e=vee.hasOwnProperty,c3e=vee.propertyIsEnumerable,h3e=n9(function(){return arguments}())?n9:function(e){return cf(e)&&u3e.call(e,"callee")&&!c3e.call(e,"callee")},AB=h3e;function d3e(){return!1}var f3e=d3e,yee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,s9=yee&&typeof module=="object"&&module&&!module.nodeType&&module,p3e=s9&&s9.exports===yee,a9=p3e?Rc.Buffer:void 0,m3e=a9?a9.isBuffer:void 0,g3e=m3e||f3e,VC=g3e,v3e="[object Arguments]",y3e="[object Array]",x3e="[object Boolean]",b3e="[object Date]",_3e="[object Error]",w3e="[object Function]",E3e="[object Map]",S3e="[object Number]",T3e="[object Object]",C3e="[object RegExp]",A3e="[object Set]",M3e="[object String]",P3e="[object WeakMap]",D3e="[object ArrayBuffer]",I3e="[object DataView]",O3e="[object Float32Array]",R3e="[object Float64Array]",L3e="[object Int8Array]",N3e="[object Int16Array]",k3e="[object Int32Array]",B3e="[object Uint8Array]",z3e="[object Uint8ClampedArray]",F3e="[object Uint16Array]",U3e="[object Uint32Array]",An={};An[O3e]=An[R3e]=An[L3e]=An[N3e]=An[k3e]=An[B3e]=An[z3e]=An[F3e]=An[U3e]=!0;An[v3e]=An[y3e]=An[D3e]=An[x3e]=An[I3e]=An[b3e]=An[_3e]=An[w3e]=An[E3e]=An[S3e]=An[T3e]=An[C3e]=An[A3e]=An[M3e]=An[P3e]=!1;function j3e(e){return cf(e)&&TB(e.length)&&!!An[uv(e)]}var V3e=j3e;function H3e(e){return function(t){return e(t)}}var MB=H3e,xee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xb=xee&&typeof module=="object"&&module&&!module.nodeType&&module,W3e=xb&&xb.exports===xee,tI=W3e&&uee.process,G3e=function(){try{var e=xb&&xb.require&&xb.require("util").types;return e||tI&&tI.binding&&tI.binding("util")}catch{}}(),Ry=G3e,o9=Ry&&Ry.isTypedArray,q3e=o9?MB(o9):V3e,bee=q3e,Y3e=Object.prototype,X3e=Y3e.hasOwnProperty;function K3e(e,t){var i=kh(e),r=!i&&AB(e),n=!i&&!r&&VC(e),s=!i&&!r&&!n&&bee(e),a=i||r||n||s,o=a?a3e(e.length,String):[],l=o.length;for(var u in e)(t||X3e.call(e,u))&&!(a&&(u=="length"||n&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||wB(u,l)))&&o.push(u);return o}var _ee=K3e;function $3e(e,t){return function(i){return e(t(i))}}var wee=$3e,Z3e=wee(Object.keys,Object),Q3e=Z3e,J3e=Object.prototype,eLe=J3e.hasOwnProperty;function tLe(e){if(!CB(e))return Q3e(e);var t=[];for(var i in Object(e))eLe.call(e,i)&&i!="constructor"&&t.push(i);return t}var iLe=tLe;function rLe(e){return gee(e)?_ee(e):iLe(e)}var PB=rLe;function nLe(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var sLe=nLe,aLe=Object.prototype,oLe=aLe.hasOwnProperty;function lLe(e){if(!Ic(e))return sLe(e);var t=CB(e),i=[];for(var r in e)r=="constructor"&&(t||!oLe.call(e,r))||i.push(r);return i}var uLe=lLe;function cLe(e){return gee(e)?_ee(e,!0):uLe(e)}var xg=cLe,hLe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dLe=/^\w*$/;function fLe(e,t){if(kh(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||rw(e)?!0:dLe.test(e)||!hLe.test(e)||t!=null&&e in Object(t)}var pLe=fLe,mLe=hv(Object,"create"),h_=mLe;function gLe(){this.__data__=h_?h_(null):{},this.size=0}var vLe=gLe;function yLe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var xLe=yLe,bLe="__lodash_hash_undefined__",_Le=Object.prototype,wLe=_Le.hasOwnProperty;function ELe(e){var t=this.__data__;if(h_){var i=t[e];return i===bLe?void 0:i}return wLe.call(t,e)?t[e]:void 0}var SLe=ELe,TLe=Object.prototype,CLe=TLe.hasOwnProperty;function ALe(e){var t=this.__data__;return h_?t[e]!==void 0:CLe.call(t,e)}var MLe=ALe,PLe="__lodash_hash_undefined__";function DLe(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=h_&&t===void 0?PLe:t,this}var ILe=DLe;function u1(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}u1.prototype.clear=vLe;u1.prototype.delete=xLe;u1.prototype.get=SLe;u1.prototype.has=MLe;u1.prototype.set=ILe;var l9=u1;function OLe(){this.__data__=[],this.size=0}var RLe=OLe;function LLe(e,t){for(var i=e.length;i--;)if(EB(e[i][0],t))return i;return-1}var CM=LLe,NLe=Array.prototype,kLe=NLe.splice;function BLe(e){var t=this.__data__,i=CM(t,e);if(i<0)return!1;var r=t.length-1;return i==r?t.pop():kLe.call(t,i,1),--this.size,!0}var zLe=BLe;function FLe(e){var t=this.__data__,i=CM(t,e);return i<0?void 0:t[i][1]}var ULe=FLe;function jLe(e){return CM(this.__data__,e)>-1}var VLe=jLe;function HLe(e,t){var i=this.__data__,r=CM(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}var WLe=HLe;function c1(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}c1.prototype.clear=RLe;c1.prototype.delete=zLe;c1.prototype.get=ULe;c1.prototype.has=VLe;c1.prototype.set=WLe;var AM=c1,GLe=hv(Rc,"Map"),d_=GLe;function qLe(){this.size=0,this.__data__={hash:new l9,map:new(d_||AM),string:new l9}}var YLe=qLe;function XLe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var KLe=XLe;function $Le(e,t){var i=e.__data__;return KLe(t)?i[typeof t=="string"?"string":"hash"]:i.map}var MM=$Le;function ZLe(e){var t=MM(this,e).delete(e);return this.size-=t?1:0,t}var QLe=ZLe;function JLe(e){return MM(this,e).get(e)}var eNe=JLe;function tNe(e){return MM(this,e).has(e)}var iNe=tNe;function rNe(e,t){var i=MM(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}var nNe=rNe;function h1(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}h1.prototype.clear=YLe;h1.prototype.delete=QLe;h1.prototype.get=eNe;h1.prototype.has=iNe;h1.prototype.set=nNe;var PM=h1,sNe="Expected a function";function DB(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(sNe);var i=function(){var r=arguments,n=t?t.apply(this,r):r[0],s=i.cache;if(s.has(n))return s.get(n);var a=e.apply(this,r);return i.cache=s.set(n,a)||s,a};return i.cache=new(DB.Cache||PM),i}DB.Cache=PM;var aNe=DB,oNe=500;function lNe(e){var t=aNe(e,function(r){return i.size===oNe&&i.clear(),r}),i=t.cache;return t}var uNe=lNe,cNe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,hNe=/\\(\\)?/g,dNe=uNe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(cNe,function(i,r,n,s){t.push(n?s.replace(hNe,"$1"):r||i)}),t}),fNe=dNe;function pNe(e){return e==null?"":FOe(e)}var mNe=pNe;function gNe(e,t){return kh(e)?e:pLe(e,t)?[e]:fNe(mNe(e))}var d1=gNe;function vNe(e){if(typeof e=="string"||rw(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var DM=vNe;function yNe(e,t){t=d1(t,e);for(var i=0,r=t.length;e!=null&&i<r;)e=e[DM(t[i++])];return i&&i==r?e:void 0}var Eee=yNe;function xNe(e,t){for(var i=-1,r=t.length,n=e.length;++i<r;)e[n+i]=t[i];return e}var IB=xNe,u9=Vu?Vu.isConcatSpreadable:void 0;function bNe(e){return kh(e)||AB(e)||!!(u9&&e&&e[u9])}var _Ne=bNe;function See(e,t,i,r,n){var s=-1,a=e.length;for(i||(i=_Ne),n||(n=[]);++s<a;){var o=e[s];t>0&&i(o)?t>1?See(o,t-1,i,r,n):IB(n,o):r||(n[n.length]=o)}return n}var wNe=See;function ENe(e){var t=e==null?0:e.length;return t?wNe(e,1):[]}var SNe=ENe;function TNe(e){return URe(JRe(e,void 0,SNe),e+"")}var Tee=TNe,CNe=wee(Object.getPrototypeOf,Object),OB=CNe,ANe="[object Object]",MNe=Function.prototype,PNe=Object.prototype,Cee=MNe.toString,DNe=PNe.hasOwnProperty,INe=Cee.call(Object);function ONe(e){if(!cf(e)||uv(e)!=ANe)return!1;var t=OB(e);if(t===null)return!0;var i=DNe.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&Cee.call(i)==INe}var RNe=ONe;function LNe(e,t,i){var r=-1,n=e.length;t<0&&(t=-t>n?0:n+t),i=i>n?n:i,i<0&&(i+=n),n=t>i?0:i-t>>>0,t>>>=0;for(var s=Array(n);++r<n;)s[r]=e[r+t];return s}var NNe=LNe;function kNe(){this.__data__=new AM,this.size=0}var BNe=kNe;function zNe(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var FNe=zNe;function UNe(e){return this.__data__.get(e)}var jNe=UNe;function VNe(e){return this.__data__.has(e)}var HNe=VNe,WNe=200;function GNe(e,t){var i=this.__data__;if(i instanceof AM){var r=i.__data__;if(!d_||r.length<WNe-1)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new PM(r)}return i.set(e,t),this.size=i.size,this}var qNe=GNe;function f1(e){var t=this.__data__=new AM(e);this.size=t.size}f1.prototype.clear=BNe;f1.prototype.delete=FNe;f1.prototype.get=jNe;f1.prototype.has=HNe;f1.prototype.set=qNe;var ET=f1;function YNe(e,t){return e&&nw(t,PB(t),e)}var XNe=YNe;function KNe(e,t){return e&&nw(t,xg(t),e)}var $Ne=KNe,Aee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,c9=Aee&&typeof module=="object"&&module&&!module.nodeType&&module,ZNe=c9&&c9.exports===Aee,h9=ZNe?Rc.Buffer:void 0,d9=h9?h9.allocUnsafe:void 0;function QNe(e,t){if(t)return e.slice();var i=e.length,r=d9?d9(i):new e.constructor(i);return e.copy(r),r}var JNe=QNe;function eke(e,t){for(var i=-1,r=e==null?0:e.length,n=0,s=[];++i<r;){var a=e[i];t(a,i,e)&&(s[n++]=a)}return s}var tke=eke;function ike(){return[]}var Mee=ike,rke=Object.prototype,nke=rke.propertyIsEnumerable,f9=Object.getOwnPropertySymbols,ske=f9?function(e){return e==null?[]:(e=Object(e),tke(f9(e),function(t){return nke.call(e,t)}))}:Mee,RB=ske;function ake(e,t){return nw(e,RB(e),t)}var oke=ake,lke=Object.getOwnPropertySymbols,uke=lke?function(e){for(var t=[];e;)IB(t,RB(e)),e=OB(e);return t}:Mee,Pee=uke;function cke(e,t){return nw(e,Pee(e),t)}var hke=cke;function dke(e,t,i){var r=t(e);return kh(e)?r:IB(r,i(e))}var Dee=dke;function fke(e){return Dee(e,PB,RB)}var q3=fke;function pke(e){return Dee(e,xg,Pee)}var Iee=pke,mke=hv(Rc,"DataView"),Y3=mke,gke=hv(Rc,"Promise"),X3=gke,vke=hv(Rc,"Set"),K3=vke,p9="[object Map]",yke="[object Object]",m9="[object Promise]",g9="[object Set]",v9="[object WeakMap]",y9="[object DataView]",xke=cv(Y3),bke=cv(d_),_ke=cv(X3),wke=cv(K3),Eke=cv(G3),rg=uv;(Y3&&rg(new Y3(new ArrayBuffer(1)))!=y9||d_&&rg(new d_)!=p9||X3&&rg(X3.resolve())!=m9||K3&&rg(new K3)!=g9||G3&&rg(new G3)!=v9)&&(rg=function(e){var t=uv(e),i=t==yke?e.constructor:void 0,r=i?cv(i):"";if(r)switch(r){case xke:return y9;case bke:return p9;case _ke:return m9;case wke:return g9;case Eke:return v9}return t});var f_=rg,Ske=Object.prototype,Tke=Ske.hasOwnProperty;function Cke(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&Tke.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var Ake=Cke,Mke=Rc.Uint8Array,HC=Mke;function Pke(e){var t=new e.constructor(e.byteLength);return new HC(t).set(new HC(e)),t}var LB=Pke;function Dke(e,t){var i=t?LB(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var Ike=Dke,Oke=/\w*$/;function Rke(e){var t=new e.constructor(e.source,Oke.exec(e));return t.lastIndex=e.lastIndex,t}var Lke=Rke,x9=Vu?Vu.prototype:void 0,b9=x9?x9.valueOf:void 0;function Nke(e){return b9?Object(b9.call(e)):{}}var kke=Nke;function Bke(e,t){var i=t?LB(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var zke=Bke,Fke="[object Boolean]",Uke="[object Date]",jke="[object Map]",Vke="[object Number]",Hke="[object RegExp]",Wke="[object Set]",Gke="[object String]",qke="[object Symbol]",Yke="[object ArrayBuffer]",Xke="[object DataView]",Kke="[object Float32Array]",$ke="[object Float64Array]",Zke="[object Int8Array]",Qke="[object Int16Array]",Jke="[object Int32Array]",e4e="[object Uint8Array]",t4e="[object Uint8ClampedArray]",i4e="[object Uint16Array]",r4e="[object Uint32Array]";function n4e(e,t,i){var r=e.constructor;switch(t){case Yke:return LB(e);case Fke:case Uke:return new r(+e);case Xke:return Ike(e,i);case Kke:case $ke:case Zke:case Qke:case Jke:case e4e:case t4e:case i4e:case r4e:return zke(e,i);case jke:return new r;case Vke:case Gke:return new r(e);case Hke:return Lke(e);case Wke:return new r;case qke:return kke(e)}}var s4e=n4e;function a4e(e){return typeof e.constructor=="function"&&!CB(e)?SRe(OB(e)):{}}var o4e=a4e,l4e="[object Map]";function u4e(e){return cf(e)&&f_(e)==l4e}var c4e=u4e,_9=Ry&&Ry.isMap,h4e=_9?MB(_9):c4e,d4e=h4e,f4e="[object Set]";function p4e(e){return cf(e)&&f_(e)==f4e}var m4e=p4e,w9=Ry&&Ry.isSet,g4e=w9?MB(w9):m4e,v4e=g4e,y4e=1,x4e=2,b4e=4,Oee="[object Arguments]",_4e="[object Array]",w4e="[object Boolean]",E4e="[object Date]",S4e="[object Error]",Ree="[object Function]",T4e="[object GeneratorFunction]",C4e="[object Map]",A4e="[object Number]",Lee="[object Object]",M4e="[object RegExp]",P4e="[object Set]",D4e="[object String]",I4e="[object Symbol]",O4e="[object WeakMap]",R4e="[object ArrayBuffer]",L4e="[object DataView]",N4e="[object Float32Array]",k4e="[object Float64Array]",B4e="[object Int8Array]",z4e="[object Int16Array]",F4e="[object Int32Array]",U4e="[object Uint8Array]",j4e="[object Uint8ClampedArray]",V4e="[object Uint16Array]",H4e="[object Uint32Array]",gn={};gn[Oee]=gn[_4e]=gn[R4e]=gn[L4e]=gn[w4e]=gn[E4e]=gn[N4e]=gn[k4e]=gn[B4e]=gn[z4e]=gn[F4e]=gn[C4e]=gn[A4e]=gn[Lee]=gn[M4e]=gn[P4e]=gn[D4e]=gn[I4e]=gn[U4e]=gn[j4e]=gn[V4e]=gn[H4e]=!0;gn[S4e]=gn[Ree]=gn[O4e]=!1;function ST(e,t,i,r,n,s){var a,o=t&y4e,l=t&x4e,u=t&b4e;if(i&&(a=n?i(e,r,n,s):i(e)),a!==void 0)return a;if(!Ic(e))return e;var c=kh(e);if(c){if(a=Ake(e),!o)return MRe(e,a)}else{var h=f_(e),d=h==Ree||h==T4e;if(VC(e))return JNe(e,o);if(h==Lee||h==Oee||d&&!n){if(a=l||d?{}:o4e(e),!o)return l?hke(e,$Ne(a,e)):oke(e,XNe(a,e))}else{if(!gn[h])return n?e:{};a=s4e(e,h,o)}}s||(s=new ET);var f=s.get(e);if(f)return f;s.set(e,a),v4e(e)?e.forEach(function(y){a.add(ST(y,t,i,y,e,s))}):d4e(e)&&e.forEach(function(y,x){a.set(x,ST(y,t,i,x,e,s))});var m=u?l?Iee:q3:l?xg:PB,g=c?void 0:m(e);return VRe(g||e,function(y,x){g&&(x=y,y=e[x]),SB(a,x,ST(y,t,i,x,e,s))}),a}var Nee=ST,W4e=1,G4e=4;function q4e(e){return Nee(e,W4e|G4e)}var IM=q4e,Y4e="__lodash_hash_undefined__";function X4e(e){return this.__data__.set(e,Y4e),this}var K4e=X4e;function $4e(e){return this.__data__.has(e)}var Z4e=$4e;function WC(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new PM;++t<i;)this.add(e[t])}WC.prototype.add=WC.prototype.push=K4e;WC.prototype.has=Z4e;var Q4e=WC;function J4e(e,t){for(var i=-1,r=e==null?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}var eBe=J4e;function tBe(e,t){return e.has(t)}var iBe=tBe,rBe=1,nBe=2;function sBe(e,t,i,r,n,s){var a=i&rBe,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var u=s.get(e),c=s.get(t);if(u&&c)return u==t&&c==e;var h=-1,d=!0,f=i&nBe?new Q4e:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var m=e[h],g=t[h];if(r)var y=a?r(g,m,h,t,e,s):r(m,g,h,e,t,s);if(y!==void 0){if(y)continue;d=!1;break}if(f){if(!eBe(t,function(x,w){if(!iBe(f,w)&&(m===x||n(m,x,i,r,s)))return f.push(w)})){d=!1;break}}else if(!(m===g||n(m,g,i,r,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var kee=sBe;function aBe(e){var t=-1,i=Array(e.size);return e.forEach(function(r,n){i[++t]=[n,r]}),i}var oBe=aBe;function lBe(e){var t=-1,i=Array(e.size);return e.forEach(function(r){i[++t]=r}),i}var uBe=lBe,cBe=1,hBe=2,dBe="[object Boolean]",fBe="[object Date]",pBe="[object Error]",mBe="[object Map]",gBe="[object Number]",vBe="[object RegExp]",yBe="[object Set]",xBe="[object String]",bBe="[object Symbol]",_Be="[object ArrayBuffer]",wBe="[object DataView]",E9=Vu?Vu.prototype:void 0,iI=E9?E9.valueOf:void 0;function EBe(e,t,i,r,n,s,a){switch(i){case wBe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _Be:return!(e.byteLength!=t.byteLength||!s(new HC(e),new HC(t)));case dBe:case fBe:case gBe:return EB(+e,+t);case pBe:return e.name==t.name&&e.message==t.message;case vBe:case xBe:return e==t+"";case mBe:var o=oBe;case yBe:var l=r&cBe;if(o||(o=uBe),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=hBe,a.set(e,t);var c=kee(o(e),o(t),r,n,s,a);return a.delete(e),c;case bBe:if(iI)return iI.call(e)==iI.call(t)}return!1}var SBe=EBe,TBe=1,CBe=Object.prototype,ABe=CBe.hasOwnProperty;function MBe(e,t,i,r,n,s){var a=i&TBe,o=q3(e),l=o.length,u=q3(t),c=u.length;if(l!=c&&!a)return!1;for(var h=l;h--;){var d=o[h];if(!(a?d in t:ABe.call(t,d)))return!1}var f=s.get(e),m=s.get(t);if(f&&m)return f==t&&m==e;var g=!0;s.set(e,t),s.set(t,e);for(var y=a;++h<l;){d=o[h];var x=e[d],w=t[d];if(r)var b=a?r(w,x,d,t,e,s):r(x,w,d,e,t,s);if(!(b===void 0?x===w||n(x,w,i,r,s):b)){g=!1;break}y||(y=d=="constructor")}if(g&&!y){var C=e.constructor,A=t.constructor;C!=A&&"constructor"in e&&"constructor"in t&&!(typeof C=="function"&&C instanceof C&&typeof A=="function"&&A instanceof A)&&(g=!1)}return s.delete(e),s.delete(t),g}var PBe=MBe,DBe=1,S9="[object Arguments]",T9="[object Array]",KE="[object Object]",IBe=Object.prototype,C9=IBe.hasOwnProperty;function OBe(e,t,i,r,n,s){var a=kh(e),o=kh(t),l=a?T9:f_(e),u=o?T9:f_(t);l=l==S9?KE:l,u=u==S9?KE:u;var c=l==KE,h=u==KE,d=l==u;if(d&&VC(e)){if(!VC(t))return!1;a=!0,c=!1}if(d&&!c)return s||(s=new ET),a||bee(e)?kee(e,t,i,r,n,s):SBe(e,t,l,i,r,n,s);if(!(i&DBe)){var f=c&&C9.call(e,"__wrapped__"),m=h&&C9.call(t,"__wrapped__");if(f||m){var g=f?e.value():e,y=m?t.value():t;return s||(s=new ET),n(g,y,i,r,s)}}return d?(s||(s=new ET),PBe(e,t,i,r,n,s)):!1}var RBe=OBe;function Bee(e,t,i,r,n){return e===t?!0:e==null||t==null||!cf(e)&&!cf(t)?e!==e&&t!==t:RBe(e,t,i,r,Bee,n)}var LBe=Bee;function NBe(e,t){return e!=null&&t in Object(e)}var kBe=NBe;function BBe(e,t,i){t=d1(t,e);for(var r=-1,n=t.length,s=!1;++r<n;){var a=DM(t[r]);if(!(s=e!=null&&i(e,a)))break;e=e[a]}return s||++r!=n?s:(n=e==null?0:e.length,!!n&&TB(n)&&wB(a,n)&&(kh(e)||AB(e)))}var zBe=BBe;function FBe(e,t){return e!=null&&zBe(e,t,kBe)}var UBe=FBe,jBe=function(){return Rc.Date.now()},rI=jBe,VBe="Expected a function",HBe=Math.max,WBe=Math.min;function GBe(e,t,i){var r,n,s,a,o,l,u=0,c=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(VBe);t=e9(t)||0,Ic(i)&&(c=!!i.leading,h="maxWait"in i,s=h?HBe(e9(i.maxWait)||0,t):s,d="trailing"in i?!!i.trailing:d);function f(E){var _=r,P=n;return r=n=void 0,u=E,a=e.apply(P,_),a}function m(E){return u=E,o=setTimeout(x,t),c?f(E):a}function g(E){var _=E-l,P=E-u,I=t-_;return h?WBe(I,s-P):I}function y(E){var _=E-l,P=E-u;return l===void 0||_>=t||_<0||h&&P>=s}function x(){var E=rI();if(y(E))return w(E);o=setTimeout(x,g(E))}function w(E){return o=void 0,d&&r?f(E):(r=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),u=0,r=l=n=o=void 0}function C(){return o===void 0?a:w(rI())}function A(){var E=rI(),_=y(E);if(r=arguments,n=this,l=E,_){if(o===void 0)return m(l);if(h)return clearTimeout(o),o=setTimeout(x,t),f(l)}return o===void 0&&(o=setTimeout(x,t)),a}return A.cancel=b,A.flush=C,A}var p_=GBe;function qBe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var YBe=qBe;function XBe(e,t){return e>t}var KBe=XBe;function $Be(e,t){return t.length<2?e:Eee(e,NNe(t,0,-1))}var ZBe=$Be;function QBe(e,t){return LBe(e,t)}var NB=QBe;function JBe(e,t,i){for(var r=-1,n=e.length;++r<n;){var s=e[r],a=t(s);if(a!=null&&(o===void 0?a===a&&!rw(a):i(a,o)))var o=a,l=s}return l}var eze=JBe;function tze(e){return e&&e.length?eze(e,fee,KBe):void 0}var ize=tze;function rze(e,t){return t=d1(t,e),e=ZBe(e,t),e==null||delete e[DM(YBe(t))]}var nze=rze;function sze(e){return RNe(e)?void 0:e}var aze=sze,oze=1,lze=2,uze=4,cze=Tee(function(e,t){var i={};if(e==null)return i;var r=!1;t=hee(t,function(s){return s=d1(s,e),r||(r=s.length>1),s}),nw(e,Iee(e),i),r&&(i=Nee(i,oze|lze|uze,aze));for(var n=t.length;n--;)nze(i,t[n]);return i}),$3=cze;function hze(e,t,i,r){if(!Ic(e))return e;t=d1(t,e);for(var n=-1,s=t.length,a=s-1,o=e;o!=null&&++n<s;){var l=DM(t[n]),u=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=a){var c=o[l];u=r?r(c,l,o):void 0,u===void 0&&(u=Ic(c)?c:wB(t[n+1])?[]:{})}SB(o,l,u),o=o[l]}return e}var dze=hze;function fze(e,t,i){for(var r=-1,n=t.length,s={};++r<n;){var a=t[r],o=Eee(e,a);i(o,a)&&dze(s,d1(a,e),o)}return s}var pze=fze;function mze(e,t){return pze(e,t,function(i,r){return UBe(e,r)})}var gze=mze,vze=Tee(function(e,t){return e==null?{}:gze(e,t)}),Dh=vze,yze="Expected a function";function xze(e,t,i){var r=!0,n=!0;if(typeof e!="function")throw new TypeError(yze);return Ic(i)&&(r="leading"in i?!!i.leading:r,n="trailing"in i?!!i.trailing:n),p_(e,t,{leading:r,maxWait:t,trailing:n})}var bze=xze;function zee(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function Hu(e,t){return Object.setPrototypeOf(e,t),e}var _ze=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),wze=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),Eze=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||OM&&"ontouchend"in document,Sze=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Tze=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,Cze=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},Aze=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},Mze=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},Fee=_ze();Fee&&Mze();var OM=wze(),sw=Eze(),Pze=Sze(),Jl=Tze(),A9=Cze(),Dze=Number(Aze());function Uee(e){return Array.isArray(e)?e:[e]}function jee(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}function $E(e){return OM?e.metaKey:e.ctrlKey}function Ize(e){return e.wheelDeltaY===0||e.deltaY===0?OM&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var wi=[],GC={},Wx={},TT={};function Vee(e){wi.includes(e)||wi.push(e)}function oy(e){delete GC[e.pointerId];for(let t=0;t<wi.length;t++)if(wi[t].pointerId===e.pointerId){wi.splice(t,1);break}}function Oze(){wi.splice(0,wi.length)}function qC(e){if(e.pointerType!=="touch")return;let t=GC[e.pointerId];t===void 0&&(t={x:0,y:0},GC[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function nI(e){let t=e.pointerId===wi[0].pointerId?wi[1]:wi[0];return GC[t.pointerId]}function Hee(e){Wx[e.key]=!0,TT[e.key]=TT[e.key]===void 0?1:TT[e.key]+1}function Wee(e){if(OM&&Wx.Meta)for(let t in Wx)Wx[t]=!1;else Wx[e.key]=!1;TT={}}function Rze(e){e.addEventListener("pointerdown",Vee,!0),e.addEventListener("pointerdown",qC,!0),e.addEventListener("pointermove",qC,!0),e.addEventListener("pointerup",oy,!0),e.addEventListener("pointercancel",oy,!0),e.addEventListener("pointerleave",oy,!0),window.addEventListener("keydown",Hee,!0),window.addEventListener("keyup",Wee,!0)}function Lze(e){e.removeEventListener("pointerdown",Vee,!0),e.removeEventListener("pointerdown",qC,!0),e.removeEventListener("pointermove",qC,!0),e.removeEventListener("pointerup",oy,!0),e.removeEventListener("pointercancel",oy,!0),e.removeEventListener("pointerleave",oy,!0),window.removeEventListener("keydown",Hee,!0),window.removeEventListener("keyup",Wee,!0)}var Gee,Nze=new Promise(e=>{Gee=e}),ZE;function kze(){if(ZE)return ZE;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@1.9.81/build",i=Ll(()=>import("./navmesh-BFd9Mv4x.js"),[]),[r,n]=await Promise.all([i,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),s=r.default,a=await s({wasmBinary:n});Gee(a)}return ZE=e(),ZE}var qee,Bze=new Promise(e=>{qee=e}),QE;function zze(){if(QE)return QE;async function e(){let t=await Ll(()=>import("./physics-BM4kW-A5.js"),[]);await t.init(),qee(t)}return QE=e(),QE}var pi=class{modifyById(e,t){let i=this;if(i[e]===void 0)throw new Error("not expected");{let r={...i,[e]:t};return Object.setPrototypeOf(r,pi.prototype),r}}add(e,t){var i;return((i=this.runOp({type:1,id:e,data:t}))==null?void 0:i.data)??this}runOp(e){let t=this;if(e.type===1){let i=t[e.id],r;i===void 0?r={type:2,id:e.id}:r={type:1,id:e.id,data:i};let{id:n,data:s}=e,a={...t,[n]:s};return Object.setPrototypeOf(a,pi.prototype),{data:a,actual:e,reverse:r}}else if(e.type===2){let{id:i}=e,r=t[i];if(r===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,pi.prototype),delete n[i],{data:n,actual:e,reverse:{type:1,id:i,data:r}}}}return null}};function kB(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let i of t){let r=e[i];r&&typeof r=="object"&&kB(r)}return Object.freeze(e)}function Fze(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}var Yee=class extends Error{};function sI(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function xp(e,t,i){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let r=[],n=1/(i+1);for(let s=0;s<i;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;r.push(a)}return r}function BB(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function Uze(){return typeof process<"u"}function Xee(e,t){for(let i of e)t(i.id,i.data)!==!0&&Xee(i.children,t)}function Kee(e,t){if(t(e.id,e.data)!==!0)for(let i of e.children)Kee(i,t)}var Ua=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Ua.prototype)}deepFreeze(){let e=0;for(;e<this.length;)kB(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let i of e.children)this.fillCaches0(i,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let i=this.get(e);i&&Kee(i,t)}}traverse(e){Xee(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this.parent(e),r=this.childrenArray(i),n=r.findIndex(a=>a.id===e);if(n<0)throw new Error("not expected");let s=r[n];return r=[...r],r[n]={...s,data:t},this.modifyArrayBy(i,r)}}modifyArrayBy(e,t){let i=e,r=t;for(;i!==null;){let s=r,a=i;if(i=this.parent(i),i===void 0)throw new Error;r=this.childrenArray(i);let o=r.findIndex(l=>l.id===a);if(o<0)throw new Error;r=[...r],r[o]={...r[o],children:s}}Object.setPrototypeOf(r,Ua.prototype);let n=r;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let i of t)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(e){let{parent:t,fi:i,id:r,data:n,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:i,id:r,data:n,children:s};return o=[...o,l],o.sort((u,c)=>u.fi-c.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:r}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let i=this.parent(t);if(i===void 0)return null;let r=this.childrenArray(i),n=r.findIndex(a=>a.id===t);e.localIndex=n,r=[...r];let s=r.splice(n,1)[0];return{data:this.modifyArrayBy(i,r),actual:e,reverse:{type:7,...s,parent:i}}}}moveOp(e){let{parent:t,fi:i,id:r}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:r});if(t!==null){let h=t;for(;h!==null;){if(h===void 0)throw new Error;if(h===r)throw new Yee("cyclic tree");h=this.parent(h)}}let n=this.parent(r);if(n===void 0)return null;let s=n,a=this.childrenArray(n),o=a.findIndex(h=>h.id===r);a=[...a];let l=a.splice(o,1)[0],u=this.modifyArrayBy(n,a);n=t,a=u.childrenArray(n);let c=l.fi;return l={...l,fi:i},a=[...a,l],a.sort((h,d)=>h.fi-d.fi),e.localIndex=a.indexOf(l),u=u.modifyArrayBy(n,a),{data:u,actual:e,reverse:{type:9,parent:s,fi:c,id:r}}}previous(e,t){if(t===null){let r=this.childrenArray(e);return r.length===0?null:r[r.length-1].id}let i=null;for(let r of this.childrenArray(e)){if(r.id===t)return i;i=r.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),r=i.findIndex(n=>n.id===e)+1;if(r<i.length)return i[r].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),r=i.findIndex(n=>n.id===e)-1;return r>=0?this.traverseSortPrevious(i[r].id):t}}getAllSorted(e){let t=[];for(let i of e){let r=this.getWithSortKey(i.id);r!==void 0&&t.push({...i,...r})}t.sort((i,r)=>Fze(i.sortKey,r.sortKey));for(let i of t)delete i.sortKey;return t}getWithSortKey(e){var t=e;let i=[],r=this.get(t),n=r;if(r!==void 0){for(;t;)i.splice(0,0,r.fi),t=this.parent(t),t!==null&&(r=this.get(t));return{...n,sortKey:i}}}insertBeforeHelper(e,t,i){return this.insertAfterHelper(e,this.previous(e,t),i)}insertAfterHelper(e,t,i){let r=this.childrenArray(e);if(t===null){if(r.length===0)return xp(0,i,i);{let n=r[0].fi;return xp(n-i,n,i)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=r.find(a=>a.fi>n.fi);if(s===void 0){let a=r[r.length-1].fi;return xp(a,a+i,i)}else return xp(n.fi,s.fi,i)}}},YC;(e=>{function t(i,r){if(r.type!==0)return null;if(Array.isArray(i)){let n=r.props,s={},a=[...i],o=!1;if(n)for(let l of Object.keys(n)){let u=parseInt(l);if(isNaN(u))throw new Error("wrong index");s[l]=a[u],a[u]=n[l],o=!0}return o?{data:a,actual:r,reverse:{type:0,props:s}}:null}else{let n=r.props,s={},a={...i},o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let u=n[l];u===void 0?delete a[l]:a[l]=u,o=!0}return o?{data:a,actual:r,reverse:{type:0,props:s}}:null}}e.runOp=t})(YC||(YC={}));var oi=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,oi.prototype)}deepFreeze(){let e=0;for(;e<this.length;)kB(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this,r=i.findIndex(s=>s.id===e);if(r<0)throw new Error("not expected");let n=i[r];return i=[...i],i[r]={...n,data:t},this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,oi.prototype);let t=e;return Uze()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:i,data:r}=e,n=this,s={fi:t,id:i,data:r};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:t}=e,i=this,r=i.findIndex(s=>s.id===t);if(r===-1)return null;e.localIndex=r,i=[...i];let n=i.splice(r,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:i}=e,r=this;r=[...r];let n=r.findIndex(o=>o.id===i);if(n===-1)return null;let s=r[n].fi,a={...r[n],fi:t};return r[n]=a,r.sort((o,l)=>o.fi-l.fi),e.localIndex=r.indexOf(a),{data:this.modifyArrayBy(r),actual:e,reverse:{type:6,fi:s,id:i}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let i of this){if(i.id===e)return t;t=i.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let i=this;if(e===null){if(i.length===0)return xp(0,t,t);{let r=i[0].fi;return xp(r-t,r,t)}}else{let r=this.get(e);if(r===void 0)throw new Error("illegal args");let n=i.find(s=>s.fi>r.fi);if(n===void 0){let s=i[i.length-1].fi;return xp(s,s+t,t)}else return xp(r.fi,n.fi,t)}}};function Ly(e){return e&&typeof e=="object"&&e instanceof Ls}var Ls=class{unusedFunOverridesTable(t){}runOp(t){let i=[],r=this,n=0,s={};for(;n<t.path.length;){if(i.push(r),r=r===void 0?void 0:r[t.path[n]],r!==void 0&&!Ly(r))return null;n+=1}r=r?sI(r):new Ls;for(let[l,u]of Object.entries(t.props)){let c=r[l];s[l]=c,u===void 0?delete r[l]:r[l]=u}for(;n>0;){if(Object.keys(r).length===0){let l=i[n-1];l&&(r=sI(l),delete r[t.path[n-1]])}else{let l=i[n-1];if(l){let u=sI(l);u[t.path[n-1]]=r,r=u}else{let u=new Ls;u[t.path[n-1]]=r,r=u}}n-=1}let a=Object.setPrototypeOf(r,Ls.prototype),o={...t,props:s};return{data:a,actual:t,reverse:o}}},Fp;(e=>{function t(n,s){return m_(n,s)??n}e.apply=t;function i(n,s){return FB(n,s)}e.merge=i;function r(n,s){let a=0,o=s.path,l=n;for(;a<o.length&&l!==void 0;){if(l=$s.zoomOnce(l,o[a]),l===void 0)return s;if(!Ly(l))return;a+=1}if(l===void 0)return s;if(Ly(l))if(s.type===0){let u={...s.props};for(let c of Object.keys(l))delete u[c];return{...s,props:u}}else if(s.type===1||s.type===4||s.type===7){let u=zB([s],l);return u?(console.log(u),u):s}else return s}e.filterOp=r})(Fp||(Fp={}));function zB(e,t){if(t===void 0)return;let i=!1,r=e.map(n=>{let s=n.id,a=m_(n.data,t[s]);if(i=i||a!==void 0,a===void 0&&(a=n.data),n.children){let o=zB(n.children,t);return o!==void 0?i=!0:o=n.children,{...n,id:s,data:a,children:o}}else return{...n,id:s,data:a}});if(i)return r}function jze(e,t){if(t===void 0)return;let i=!1,r=e.map(n=>{let s=n.id,a=m_(n.data,t[s]);return i=i||a!==void 0,a===void 0&&(a=n.data),{...n,id:s,data:a}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}function m_(e,t){if(!Ly(t))return t;if(e instanceof Ua){let i=zB(e,t);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof oi)return jze(e,t);if(Array.isArray(e)){let i=!1,r=e.map((n,s)=>{let a=m_(n,t[s]);return i=i||a!==void 0,a===void 0&&(a=n),a});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}else{if(e instanceof Ls)return FB(e,t);if(e&&typeof e=="object"){let i={},r=!1;for(let[n,s]of Object.entries(e)){let a=m_(s,t[n]);r=r||a!==void 0,a===void 0&&(a=s),i[n]=a}return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}}}}function FB(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!Ly(t))return t;if(!Ly(e))return Fp.apply(e,t);let i=new Set;for(let n of Object.keys(e))i.add(n);for(let n of Object.keys(t))i.add(n);let r=new Ls;for(let n of i){let s=FB(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);r[n]=s}return r}function Vze(e,t){let i={cur:[],result:[],len:0};return e=g_(e,t,i)??e,[e,i.result]}function XC(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function KC(e){e&&(e.len-=1)}function Hze(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function $ee(e,t,i){let r=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(r=!0,a=o,i!==null))throw new Error("not supported");let l=g_(s.data,t,XC(i,a));KC(i),r=r||l!==void 0,l===void 0&&(l=s.data);let u=$ee(s.children,t,i);return u!==void 0?r=!0:u=s.children,{...s,id:a,data:l,children:u}});if(r)return n}function Wze(e,t,i){let r=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(r=!0,a=o,i!==null))throw new Error("not supported");let l=g_(s.data,t,XC(i,a));return KC(i),r=r||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(r)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function g_(e,t,i){if(e instanceof Ua){let r=$ee(e,t,i);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof oi)return Wze(e,t,i);if(Array.isArray(e)){let r=!1,n=e.map((s,a)=>{let o=g_(s,t,XC(i,a));return KC(i),r=r||o!==void 0,o===void 0&&(o=s),o});return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!BB(e)){let r={},n=!1;for(let[s,a]of Object.entries(e))if(s!=="name"&&s!=="variableId"){let o=t[s];if(typeof o=="string"){if(i!==null)throw new Error("not supported");n=!0,s=o}let l=g_(a,t,XC(i,s));KC(i),n=n||l!==void 0,l===void 0&&(l=a),r[s]=l}else r[s]=a;return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}else if(typeof e=="string"){let r=t[e];return r!==void 0&&Hze(i),r}else return}}var $C;(e=>{function t(i,r){let n=$s.zoom(r,i.path);if(typeof n=="object"){let s={};for(let a of Object.keys(i.props))s[a]=n[a];return{...i,props:s}}else return{...i,props:{}}}e.replaceProps=t})($C||($C={}));var xa;(e=>{function t(l,u){return{...l,path:l.path.slice(u)}}e.drop=t;function i(l,u){var c;return((c=r(l,u))==null?void 0:c.data)??l}e.applySimple=i;function r(l,u){var d,f;let c=u.path;for(var h=[];;){let m;if(l instanceof Ls&&u.type===0&&(m=l.runOp({...u,path:c.slice(h.length)}),m===null&&(m=void 0)),m===void 0&&h.length===c.length&&(l instanceof Ua||l instanceof oi||l instanceof pi?m=l.runOp(u):m=YC.runOp(l,u)),m!==void 0)if(m!==null){let x=m.data;for(let w=h.length-1;w>=0;w--){let b=c[w],C=h[w];if(C instanceof Ua){if(typeof b=="number")throw new Error("illegal arg");x=C.modifyById(b,x)}else if(C instanceof oi){if(typeof b=="number")throw new Error("illegal arg");x=C.modifyById(b,x)}else if(C instanceof pi){if(typeof b=="number")throw new Error("illegal arg");x=C.modifyById(b,x)}else if(C instanceof Ls){let A={...C,[b]:x};x=Object.setPrototypeOf(A,Ls.prototype)}else if(typeof C=="object")if(Array.isArray(C)){if(typeof b=="string"&&(b=parseInt(b),isNaN(b)))throw new Error("Invalid path");let A=x;x=[...C],x[b]=A}else x={...C,[b]:x};else return null}return{data:x,actual:{...m.actual,path:c},reverse:{...m.reverse,path:c}}}else return null;let g=c[h.length],y;if(l instanceof Ua){if(typeof g=="number")throw new Error("");y=(d=l.get(g))==null?void 0:d.data}else if(l instanceof oi){if(typeof g=="number")throw new Error("");y=(f=l.get(g))==null?void 0:f.data}else l!==null&&(y=l[g]);if(y!==void 0)h.push(l),l=y;else return null}}e.apply=r;function n(l,u){for(let c=0;c<l.length&&c<u.length;c++)if(l[c]!==u[c])return!0;return!1}e.pathDisjoint=n;function s(l,u){if(l.length!==u.length)return!1;for(let c=0;c<l.length;c++)if(l[c]!==u[c])return!1;return!0}e.pathEq=s;function a(l,u){return n(l.path,u.path)}e.commutative=a;function o(l,u){return l.type===0&&u.type===0&&s(l.path,u.path)?Object.keys(l.props).every(c=>u.props[c]!==void 0):!1}e.subsumed=o})(xa||(xa={}));var Z3;(e=>{function t(){return[]}e.empty=t;function i(u,c){let h=[];for(let d of u){let[f,...m]=d.path;f===c&&h.push({...d,path:m})}return h}e.removePrefix=i;function r(u,c){return u.map(h=>({...h,path:[c,...h.path]}))}e.addPrefix=r;function n(u,c){return[...u,...c]}e.concat=n;function s(u,c){return[...u.filter(h=>!c.some(d=>xa.subsumed(h,d))),...c]}e.compress=s;function a(u,c){return u.every(h=>c.every(d=>xa.commutative(h,d)))}e.commutative=a;function o(u,c){for(let h of c){let d=l(u,h);d!==null&&(u=d.data)}return u}e.applyAll=o;function l(u,c){var h=u;let d=[],f=[];for(let m of c)try{if(m.type===3||m.type===5&&m.path[m.path.length-1]==="variables"){let g,y,x;if(m.type===3?(g=$s.zoom(h,[...m.path,m.id]),x=xa.apply(h,{...m,type:2})):(g=$s.zoom(h,[...m.path,m.id,"value"]),x=xa.apply(h,m)),x!==null){h=x.data;let[w,b]=Vze(h,{[m.id]:g});h=w;for(let C=0;C<b.length;C++){let A=b[C],E=A.pop();if(typeof E=="number"){let _=[E];for(let I=C+1;I<b.length;I++){let D=b[I],k=D[D.length-1];if(typeof k=="number"&&$s.equal(A,D.slice(0,D.length-1)))_.push(k),b.splice(I,1);else break}let P=$s.zoom(h,A);y=P.map((I,D)=>_.includes(D)?m.id:I),g=P,E=A.pop()}else{if(E==="alphaOverride"||E==="alpha"){g/=100;let _=g,P=$s.zoom(h,A.slice(0,A.length-2)),I=P.layers.map(D=>D.id===A[A.length-1]?{...D,data:{...D.data,[E]:_}}:D);Object.setPrototypeOf(I,Object.getPrototypeOf(P.layers)),P.layers=I}y=m.id}d.push({type:0,path:A,props:{[E]:g}}),f.push({type:0,path:A,props:{[E]:y}})}f.push(x.reverse),d.push(x.actual)}}else{let g=xa.apply(h,m);g!==null&&(d.push(g.actual),h=g.data,f.push(g.reverse))}}catch(g){if(g instanceof Yee)return null;throw g}return{data:h,actual:d,reverse:f.reverse()}}e.apply=l})(Z3||(Z3={}));var Zee=Symbol(),Gze=Symbol(),RM=Symbol(),aw=class{reportOp(e,t,i=[]){let r=this;if(t===null)return;r._current=t.data;let n=i;for(;!(r instanceof Jee);){let s=r._path,a=r._current;if(s!==""&&n.splice(0,0,s),r=r._parent,r===null)return;r.update(s,a)}r.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let i=t[RM];i&&i(),delete this._children[e]}}}},qze=class extends aw{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,YC.runOp(this._current,e),e.path)}},Yze=class extends aw{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,pi.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},Qee={get(e,t){if(t===RM)return()=>{e._parent=null};if(t===Zee)return e._current;if(t===Gze)return e;let{_current:i,_children:r}=e;if(t==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let n=r===void 0?void 0:r[t];if(n!==void 0)return n;let s=i[t],a=LM(e,t,s);return a!==s?(r===void 0&&(r={},e._children=r),r[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let i=e._current,r=Reflect.getOwnPropertyDescriptor(i,t);return r&&{writable:!0,configurable:!0,enumerable:r.enumerable,value:i[t]}}},Xze={...Qee,set(e,t,i){let r={type:0,props:{[t]:vs(i)??i}};return e.deleteChildren(t),e.runOp(r),!0},deleteProperty(e,t){let i={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(i),!0}},Kze={...Qee,set(e,t,i){return i===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:i})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},UB=class extends aw{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[RM]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,i)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:i}=this,r=i===void 0?void 0:i[e];if(r!==void 0)return r;let n=(a=t.get(e))==null?void 0:a.data,s=LM(this,e,n);return s!==n?(i===void 0&&(i={},this._children=i),i[e]=s,s):n}add(e,t,i,r,n){this.runOp({type:7,parent:e,fi:t,id:i,data:r,children:n})}move(e,t,i){this.runOp({type:9,parent:e,fi:t,id:i})}insertAfter(e,t,i){let r=this._current.insertAfterHelper(e,t,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.add(e,r[n],s.id,s.data,s.children)}}insertBefore(e,t,i){let r=this._current.insertBeforeHelper(e,t,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.add(e,r[n],s.id,s.data,s.children)}}moveAfter(e,t,i){let r=this._current.insertAfterHelper(e,t,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.move(e,r[n],s)}}moveBefore(e,t,i){let r=this._current.insertBeforeHelper(e,t,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.move(e,r[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},jB=class extends aw{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[RM]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let i=0;i<t;i++){let r=this._current[i].id,n=this._current[i].fi;e(this.data(this._current[i].id),r,n)}}find(e){let t=this.length;for(let i=0;i<t;i++){let r=this._current[i].id;if(e(this.data(r),r))return this.get(r)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var a;let{_current:t,_children:i}=this,r=i===void 0?void 0:i[e];if(r!==void 0)return r;let n=(a=t.get(e))==null?void 0:a.data,s=LM(this,e,n);return s!==n?(i===void 0&&(i={},this._children=i),i[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,i){this.runOp({type:4,fi:e,id:t,data:i})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let r=0;r<t.length;r++){let n=t[r];this.add(i[r],n.id,n.data)}}insertBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let r=0;r<t.length;r++){let n=t[r];this.add(i[r],n.id,n.data)}}moveAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let r=0;r<t.length;r++){let n=t[r];this.move(i[r],n)}}moveBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let r=0;r<t.length;r++){let n=t[r];this.move(i[r],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function aI(e,t,i){if(e.length>0){let r=e[e.length-1];if(r.type===0&&t.type===0&&$s.equal(r.path,i)){Object.assign(r.props,t.props);return}}e.push({...t,path:i})}var Jee=class extends aw{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,i,r){aI(this.ts,t,e),aI(this.actual,i,e),aI(this.reverse,r,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function LM(e,t,i){return i instanceof Ua?new UB(e,t,i):i instanceof oi?new jB(e,t,i):i instanceof pi?new Proxy(new Yze(e,t,i),Kze):i!==null&&typeof i=="object"?BB(i)?i:new Proxy(new qze(e,t,i),Xze):i}function ete(e){let t=new Jee(e);return[LM(t,"",e),t]}function v_(e,t){let[i,r]=ete(e);return t(i),r.result()}function vs(e){return e instanceof UB||e instanceof jB?e._current:e!==null&&typeof e=="object"?e[Zee]:e}var $s;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function i(s,a,o){let l=n(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let u={...a};return Object.keys(l).forEach(c=>{delete u[c]}),u}else return a}e.removeOverridden=i;function r(s,a){if((s instanceof Ua||s instanceof UB)&&typeof a=="string"||(s instanceof oi||s instanceof jB)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=r;function n(s,a,o=0){for(;o<a.length&&s!==void 0;)s=r(s,a[o]),o+=1;return s}e.zoom=n})($s||($s={}));function $ze(e,t){let i=[];if(t.length===e.length)for(var r=0;r<e.length;){if(t[r]==="*")i.push(e[r]);else if(e[r]!==t[r])return null;r+=1}else return null;return i}function sn(e,t){let i=[];if(t.length<=e.length)for(var r=0;r<t.length;){if(t[r]==="*")i.push(e[r]);else if(e[r]!==t[r])return null;r+=1}else return null;return i}var tte=class{},M9=class extends tte{constructor(e){super(),this.id=e}},P9=class extends tte{constructor(e){super(),this.data=e}},Q3;try{Q3=new TextDecoder}catch{}var ti,Up,nt=0,wl={},Fr,bp,Cu=0,vh=0,Zl,ef,Xo=[],Gr,D9={useRecords:!1,mapsAsObjects:!0},ite=class{},rte=new ite;rte.name="MessagePack 0xC1";var Ny=!1,ZC=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(ti)return ute(()=>(eL(),this?this.unpack(e,t):ZC.prototype.unpack.call(D9,e,t)));Up=t>-1?t:e.length,nt=0,vh=0,bp=null,Zl=null,ti=e;try{Gr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw ti=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof ZC){if(wl=this,this.structures)return Fr=this.structures,JE();(!Fr||Fr.length>0)&&(Fr=[])}else wl=D9,(!Fr||Fr.length>0)&&(Fr=[]);return JE()}unpackMultiple(e,t){let i,r=0;try{Ny=!0;let n=e.length,s=this?this.unpack(e,n):kM.unpack(e,n);if(t){for(t(s);nt<n;)if(r=nt,t(JE())===!1)return}else{for(i=[s];nt<n;)r=nt,i.push(JE());return i}}catch(n){throw n.lastPosition=r,n.values=i,n}finally{Ny=!1,eL()}}_mergeStructures(e,t){e=e||[];for(let i=0,r=e.length;i<r;i++){let n=e[i];n&&(n.isShared=!0,i>=32&&(n.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in t||[])if(i>=0){let r=e[i],n=t[i];n&&(r&&((e.restoreStructures||(e.restoreStructures=[]))[i]=r),e[i]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function JE(){try{if(!wl.trusted&&!Ny){let t=Fr.sharedLength||0;t<Fr.length&&(Fr.length=t)}let e=Qn();if(nt==Up)Fr.restoreStructures&&I9(),Fr=null,ti=null,ef&&(ef=null);else if(nt>Up){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Ny)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Fr.restoreStructures&&I9(),eL(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function I9(){for(let e in Fr.restoreStructures)Fr[e]=Fr.restoreStructures[e];Fr.restoreStructures=null}function Qn(){let e=ti[nt++];if(e<160)if(e<128){if(e<64)return e;{let t=Fr[e&63]||wl.getStructures&&nte()[e&63];return t?(t.read||(t.read=VB(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,wl.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[ate()]=Qn();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(Qn(),Qn());return t}else{e-=144;let t=new Array(e);for(let i=0;i<e;i++)t[i]=Qn();return t}else if(e<192){let t=e-160;if(vh>=nt)return bp.slice(nt-Cu,(nt+=t)-Cu);if(vh==0&&Up<140){let i=t<16?HB(t):ste(t);if(i!=null)return i}return J3(t)}else{let t;switch(e){case 192:return null;case 193:return Zl?(t=Qn(),t>0?Zl[1].slice(Zl.position1,Zl.position1+=t):Zl[0].slice(Zl.position0,Zl.position0-=t)):rte;case 194:return!1;case 195:return!0;case 196:return oI(ti[nt++]);case 197:return t=Gr.getUint16(nt),nt+=2,oI(t);case 198:return t=Gr.getUint32(nt),nt+=4,oI(t);case 199:return Vm(ti[nt++]);case 200:return t=Gr.getUint16(nt),nt+=2,Vm(t);case 201:return t=Gr.getUint32(nt),nt+=4,Vm(t);case 202:if(t=Gr.getFloat32(nt),wl.useFloat32>2){let i=WB[(ti[nt]&127)<<1|ti[nt+1]>>7];return nt+=4,(i*t+(t>0?.5:-.5)>>0)/i}return nt+=4,t;case 203:return t=Gr.getFloat64(nt),nt+=8,t;case 204:return ti[nt++];case 205:return t=Gr.getUint16(nt),nt+=2,t;case 206:return t=Gr.getUint32(nt),nt+=4,t;case 207:return wl.int64AsNumber?(t=Gr.getUint32(nt)*4294967296,t+=Gr.getUint32(nt+4)):t=Gr.getBigUint64(nt),nt+=8,t;case 208:return Gr.getInt8(nt++);case 209:return t=Gr.getInt16(nt),nt+=2,t;case 210:return t=Gr.getInt32(nt),nt+=4,t;case 211:return wl.int64AsNumber?(t=Gr.getInt32(nt)*4294967296,t+=Gr.getUint32(nt+4)):t=Gr.getBigInt64(nt),nt+=8,t;case 212:if(t=ti[nt++],t==114)return k9(ti[nt++]&63);{let i=Xo[t];if(i)return i.read?(nt++,i.read(Qn())):i.noBuffer?(nt++,i()):i(ti.subarray(nt,++nt));throw new Error("Unknown extension "+t)}case 213:return t=ti[nt],t==114?(nt++,k9(ti[nt++]&63,ti[nt++])):Vm(2);case 214:return Vm(4);case 215:return Vm(8);case 216:return Vm(16);case 217:return t=ti[nt++],vh>=nt?bp.slice(nt-Cu,(nt+=t)-Cu):Qze(t);case 218:return t=Gr.getUint16(nt),nt+=2,vh>=nt?bp.slice(nt-Cu,(nt+=t)-Cu):Jze(t);case 219:return t=Gr.getUint32(nt),nt+=4,vh>=nt?bp.slice(nt-Cu,(nt+=t)-Cu):eFe(t);case 220:return t=Gr.getUint16(nt),nt+=2,R9(t);case 221:return t=Gr.getUint32(nt),nt+=4,R9(t);case 222:return t=Gr.getUint16(nt),nt+=2,L9(t);case 223:return t=Gr.getUint32(nt),nt+=4,L9(t);default:if(e>=224)return e-256;if(e===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+e)}}}var Zze=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function VB(e,t){function i(){if(i.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>Zze.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Qn);return e.highByte===0&&(e.read=O9(t,e.read)),n()}let r={};for(let n=0,s=e.length;n<s;n++){let a=e[n];r[a]=Qn()}return r}return i.count=0,e.highByte===0?O9(t,i):i}var O9=(e,t)=>function(){let i=ti[nt++];if(i===0)return t();let r=e<32?-(e+(i<<5)):e+(i<<5),n=Fr[r]||nte()[r];if(!n)throw new Error("Record id is not defined for "+r);return n.read||(n.read=VB(n,e)),n.read()};function nte(){let e=ute(()=>(ti=null,wl.getStructures()));return Fr=wl._mergeStructures(e,Fr)}var J3=NM,Qze=NM,Jze=NM,eFe=NM;function NM(e){let t;if(e<16&&(t=HB(e)))return t;if(e>64&&Q3)return Q3.decode(ti.subarray(nt,nt+=e));let i=nt+e,r=[];for(t="";nt<i;){let n=ti[nt++];if(!(n&128))r.push(n);else if((n&224)===192){let s=ti[nt++]&63;r.push((n&31)<<6|s)}else if((n&240)===224){let s=ti[nt++]&63,a=ti[nt++]&63;r.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=ti[nt++]&63,a=ti[nt++]&63,o=ti[nt++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(n);r.length>=4096&&(t+=pa.apply(String,r),r.length=0)}return r.length>0&&(t+=pa.apply(String,r)),t}function R9(e){let t=new Array(e);for(let i=0;i<e;i++)t[i]=Qn();return t}function L9(e){if(wl.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[ate()]=Qn();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(Qn(),Qn());return t}}var pa=String.fromCharCode;function ste(e){let t=nt,i=new Array(e);for(let r=0;r<e;r++){let n=ti[nt++];if((n&128)>0){nt=t;return}i[r]=n}return pa.apply(String,i)}function HB(e){if(e<4)if(e<2){if(e===0)return"";{let t=ti[nt++];if((t&128)>1){nt-=1;return}return pa(t)}}else{let t=ti[nt++],i=ti[nt++];if((t&128)>0||(i&128)>0){nt-=2;return}if(e<3)return pa(t,i);let r=ti[nt++];if((r&128)>0){nt-=3;return}return pa(t,i,r)}else{let t=ti[nt++],i=ti[nt++],r=ti[nt++],n=ti[nt++];if((t&128)>0||(i&128)>0||(r&128)>0||(n&128)>0){nt-=4;return}if(e<6){if(e===4)return pa(t,i,r,n);{let s=ti[nt++];if((s&128)>0){nt-=5;return}return pa(t,i,r,n,s)}}else if(e<8){let s=ti[nt++],a=ti[nt++];if((s&128)>0||(a&128)>0){nt-=6;return}if(e<7)return pa(t,i,r,n,s,a);let o=ti[nt++];if((o&128)>0){nt-=7;return}return pa(t,i,r,n,s,a,o)}else{let s=ti[nt++],a=ti[nt++],o=ti[nt++],l=ti[nt++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){nt-=8;return}if(e<10){if(e===8)return pa(t,i,r,n,s,a,o,l);{let u=ti[nt++];if((u&128)>0){nt-=9;return}return pa(t,i,r,n,s,a,o,l,u)}}else if(e<12){let u=ti[nt++],c=ti[nt++];if((u&128)>0||(c&128)>0){nt-=10;return}if(e<11)return pa(t,i,r,n,s,a,o,l,u,c);let h=ti[nt++];if((h&128)>0){nt-=11;return}return pa(t,i,r,n,s,a,o,l,u,c,h)}else{let u=ti[nt++],c=ti[nt++],h=ti[nt++],d=ti[nt++];if((u&128)>0||(c&128)>0||(h&128)>0||(d&128)>0){nt-=12;return}if(e<14){if(e===12)return pa(t,i,r,n,s,a,o,l,u,c,h,d);{let f=ti[nt++];if((f&128)>0){nt-=13;return}return pa(t,i,r,n,s,a,o,l,u,c,h,d,f)}}else{let f=ti[nt++],m=ti[nt++];if((f&128)>0||(m&128)>0){nt-=14;return}if(e<15)return pa(t,i,r,n,s,a,o,l,u,c,h,d,f,m);let g=ti[nt++];if((g&128)>0){nt-=15;return}return pa(t,i,r,n,s,a,o,l,u,c,h,d,f,m,g)}}}}}function oI(e){return wl.copyBuffers?Uint8Array.prototype.slice.call(ti,nt,nt+=e):ti.subarray(nt,nt+=e)}function Vm(e){let t=ti[nt++];if(Xo[t])return Xo[t](ti.subarray(nt,nt+=e));throw new Error("Unknown extension type "+t)}var N9=new Array(4096);function ate(){let e=ti[nt++];if(e>=160&&e<192){if(e=e-160,vh>=nt)return bp.slice(nt-Cu,(nt+=e)-Cu);if(!(vh==0&&Up<180))return J3(e)}else return nt--,Qn();let t=(e<<5^(e>1?Gr.getUint16(nt):e>0?ti[nt]:0))&4095,i=N9[t],r=nt,n=nt+e-3,s,a=0;if(i&&i.bytes==e){for(;r<n;){if(s=Gr.getUint32(r),s!=i[a++]){r=1879048192;break}r+=4}for(n+=3;r<n;)if(s=ti[r++],s!=i[a++]){r=1879048192;break}if(r===n)return nt=r,i.string;n-=3,r=nt}for(i=[],N9[t]=i,i.bytes=e;r<n;)s=Gr.getUint32(r),i.push(s),r+=4;for(n+=3;r<n;)s=ti[r++],i.push(s);let o=e<16?HB(e):ste(e);return o!=null?i.string=o:i.string=J3(e)}var k9=(e,t)=>{var i=Qn();let r=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,i.highByte=t);let n=Fr[e];return n&&n.isShared&&((Fr.restoreStructures||(Fr.restoreStructures=[]))[e]=n),Fr[e]=i,i.read=VB(i,r),i.read()},ote=typeof self=="object"?self:global;Xo[0]=()=>{};Xo[0].noBuffer=!0;Xo[101]=()=>{let e=Qn();return(ote[e[0]]||Error)(e[1])};Xo[105]=e=>{let t=Gr.getUint32(nt-4);ef||(ef=new Map);let i=ti[nt],r;i>=144&&i<160||i==220||i==221?r=[]:r={};let n={target:r};ef.set(t,n);let s=Qn();return n.used?Object.assign(r,s):(n.target=s,s)};Xo[112]=e=>{let t=Gr.getUint32(nt-4),i=ef.get(t);return i.used=!0,i.target};Xo[115]=()=>new Set(Qn());var lte=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Xo[116]=e=>{let t=e[0],i=lte[t];if(!i)throw new Error("Could not find typed array for code "+t);return new ote[i](Uint8Array.prototype.slice.call(e,1).buffer)};Xo[120]=()=>{let e=Qn();return new RegExp(e[0],e[1])};Xo[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],i=nt;nt+=t-4,Zl=[Qn(),Qn()],Zl.position0=0,Zl.position1=0;let r=nt;nt=i;try{return Qn()}finally{nt=r}};Xo[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function ute(e){let t=Up,i=nt,r=Cu,n=vh,s=bp,a=ef,o=Zl,l=new Uint8Array(ti.slice(0,Up)),u=Fr,c=Fr.slice(0,Fr.length),h=wl,d=Ny,f=e();return Up=t,nt=i,Cu=r,vh=n,bp=s,ef=a,Zl=o,ti=l,Ny=d,Fr=u,Fr.splice(0,Fr.length,...c),wl=h,Gr=new DataView(ti.buffer,ti.byteOffset,ti.byteLength),f}function eL(){ti=null,ef=null,Fr=null}function tFe(e){e.unpack?Xo[e.type]=e.unpack:Xo[e.type]=e}var WB=new Array(147);for(let e=0;e<256;e++)WB[e]=+("1e"+Math.floor(45.15-e*.30103));var kM=new ZC({useRecords:!1});kM.unpack;kM.unpackMultiple;kM.unpack;var iFe=new Float32Array(1);new Uint8Array(iFe.buffer,0,4);var CT;try{CT=new TextEncoder}catch{}var QC,GB,BM=typeof Buffer<"u",lI=BM?Buffer.allocUnsafeSlow:Uint8Array,cte=BM?Buffer:Uint8Array,B9=BM?4294967296:2144337920,Et,cs,ht=0,Gc,qc=null,rFe=/[\u0080-\uFFFF]/,ax=Symbol("record-id"),hte=class extends ZC{constructor(e){super(e),this.offset=0;let t,i,r,n,s,a=0,o=cte.prototype.utf8Write?function(E,_,P){return Et.utf8Write(E,_,P)}:CT&&CT.encodeInto?function(E,_){return CT.encodeInto(E,Et.subarray(_)).written}:!1,l=this;e||(e={});let u=e&&e.sequential,c=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=c?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=c?32:64),u&&!e.saveStructures&&(this.structures=[]);let f=h>32||d+h>64,m=h+64,g=h+d+64;if(g>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let y=[],x=0,w=0;this.pack=this.encode=function(E,_){if(Et||(Et=new lI(8192),cs=new DataView(Et.buffer,0,8192),ht=0),Gc=Et.length-10,Gc-ht<2048?(Et=new lI(Et.length),cs=new DataView(Et.buffer,0,Et.length),Gc=Et.length-10,ht=0):ht=ht+7&2147483640,t=ht,s=l.structuredClone?new Map:null,l.bundleStrings?(qc=["",""],Et[ht++]=214,Et[ht++]=98,qc.position=ht-t,ht+=4):qc=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let P=i.sharedLength||0;if(P>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let I=0;I<P;I++){let D=i[I];if(!D)continue;let k,B=i.transitions;for(let z=0,W=D.length;z<W;z++){let $=D[z];k=B[$],k||(k=B[$]=Object.create(null)),B=k}B[ax]=I+64}a=P}u||(i.nextId=P+64)}r&&(r=!1),n=i||[];try{if(b(E),qc){cs.setUint32(qc.position+t,ht-qc.position-t);let P=qc;qc=null,b(P[0]),b(P[1])}if(l.offset=ht,s&&s.idsToInsert){ht+=s.idsToInsert.length*6,ht>Gc&&A(ht),l.offset=ht;let P=sFe(Et.subarray(t,ht),s.idsToInsert);return s=null,P}return _&aFe?(Et.start=t,Et.end=ht,Et):Et.subarray(t,ht)}finally{if(i){if(w<10&&w++,x>1e4)i.transitions=null,w=0,x=0,y.length>0&&(y=[]);else if(y.length>0&&!u){for(let P=0,I=y.length;P<I;P++)y[P][ax]=0;y=[]}if(r&&l.saveStructures){let P=i.sharedLength||h;i.length>P&&(i=i.slice(0,P));let I=Et.subarray(t,ht);return l.saveStructures(i,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(E)):(a=P,I)}}_&oFe&&(ht=t)}};let b=E=>{ht>Gc&&(Et=A(ht));var _=typeof E,P;if(_==="string"){let I=E.length;if(qc&&I>=8&&I<4096){let B=rFe.test(E);qc[B?0:1]+=E,Et[ht++]=193,b(B?-I:I);return}let D;I<32?D=1:I<256?D=2:I<65536?D=3:D=5;let k=I*3;if(ht+k>Gc&&(Et=A(ht+k)),I<64||!o){let B,z,W,$=ht+D;for(B=0;B<I;B++)z=E.charCodeAt(B),z<128?Et[$++]=z:z<2048?(Et[$++]=z>>6|192,Et[$++]=z&63|128):(z&64512)===55296&&((W=E.charCodeAt(B+1))&64512)===56320?(z=65536+((z&1023)<<10)+(W&1023),B++,Et[$++]=z>>18|240,Et[$++]=z>>12&63|128,Et[$++]=z>>6&63|128,Et[$++]=z&63|128):(Et[$++]=z>>12|224,Et[$++]=z>>6&63|128,Et[$++]=z&63|128);P=$-ht-D}else P=o(E,ht+D,k);P<32?Et[ht++]=160|P:P<256?(D<2&&Et.copyWithin(ht+2,ht+1,ht+1+P),Et[ht++]=217,Et[ht++]=P):P<65536?(D<3&&Et.copyWithin(ht+3,ht+2,ht+2+P),Et[ht++]=218,Et[ht++]=P>>8,Et[ht++]=P&255):(D<5&&Et.copyWithin(ht+5,ht+3,ht+3+P),Et[ht++]=219,cs.setUint32(ht,P),ht+=4),ht+=P}else if(_==="number")if(E>>>0===E)E<64?Et[ht++]=E:E<256?(Et[ht++]=204,Et[ht++]=E):E<65536?(Et[ht++]=205,Et[ht++]=E>>8,Et[ht++]=E&255):(Et[ht++]=206,cs.setUint32(ht,E),ht+=4);else if(E>>0===E)E>=-32?Et[ht++]=256+E:E>=-128?(Et[ht++]=208,Et[ht++]=E+256):E>=-32768?(Et[ht++]=209,cs.setInt16(ht,E),ht+=2):(Et[ht++]=210,cs.setInt32(ht,E),ht+=4);else{let I;if((I=this.useFloat32)>0&&E<4294967296&&E>=-2147483648){Et[ht++]=202,cs.setFloat32(ht,E);let D;if(I<4||(D=E*WB[(Et[ht]&127)<<1|Et[ht+1]>>7])>>0===D){ht+=4;return}else ht--}Et[ht++]=203,cs.setFloat64(ht,E),ht+=8}else if(_==="object")if(!E)Et[ht++]=192;else{if(s){let D=s.get(E);if(D){if(!D.id){let k=s.idsToInsert||(s.idsToInsert=[]);D.id=k.push(D)}Et[ht++]=214,Et[ht++]=112,cs.setUint32(ht,D.id),ht+=4;return}else s.set(E,{offset:ht-t})}let I=E.constructor;if(I===Object)C(E,!0);else if(I===Array){P=E.length,P<16?Et[ht++]=144|P:P<65536?(Et[ht++]=220,Et[ht++]=P>>8,Et[ht++]=P&255):(Et[ht++]=221,cs.setUint32(ht,P),ht+=4);for(let D=0;D<P;D++)b(E[D])}else if(I===Map){P=E.size,P<16?Et[ht++]=128|P:P<65536?(Et[ht++]=222,Et[ht++]=P>>8,Et[ht++]=P&255):(Et[ht++]=223,cs.setUint32(ht,P),ht+=4);for(let[D,k]of E)b(D),b(k)}else{for(let D=0,k=QC.length;D<k;D++){let B=GB[D];if(E instanceof B){let z=QC[D];if(z.write){z.type&&(Et[ht++]=212,Et[ht++]=z.type,Et[ht++]=0),b(z.write.call(this,E));return}let W=Et,$=cs,Z=ht;Et=null;let G;try{G=z.pack.call(this,E,V=>(Et=W,W=null,ht+=V,ht>Gc&&A(ht),{target:Et,targetView:cs,position:ht-V}),b)}finally{W&&(Et=W,cs=$,ht=Z,Gc=Et.length-10)}G&&(G.length+ht>Gc&&A(G.length+ht),ht=nFe(G,Et,ht,z.type));return}}C(E,!E.hasOwnProperty)}}else if(_==="boolean")Et[ht++]=E?195:194;else if(_==="bigint"){if(E<BigInt(1)<<BigInt(63)&&E>=-(BigInt(1)<<BigInt(63)))Et[ht++]=211,cs.setBigInt64(ht,E);else if(E<BigInt(1)<<BigInt(64)&&E>0)Et[ht++]=207,cs.setBigUint64(ht,E);else if(this.largeBigIntToFloat)Et[ht++]=203,cs.setFloat64(ht,Number(E));else throw new RangeError(E+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ht+=8}else if(_==="undefined")this.encodeUndefinedAsNil?Et[ht++]=192:(Et[ht++]=212,Et[ht++]=0,Et[ht++]=0);else if(_==="function")b(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+_)},C=this.useRecords===!1?this.variableMapSize?E=>{let _=Object.keys(E),P=_.length;P<16?Et[ht++]=128|P:P<65536?(Et[ht++]=222,Et[ht++]=P>>8,Et[ht++]=P&255):(Et[ht++]=223,cs.setUint32(ht,P),ht+=4);let I;for(let D=0;D<P;D++)b(I=_[D]),b(E[I])}:(E,_)=>{Et[ht++]=222;let P=ht-t;ht+=2;let I=0;for(let D in E)(_||E.hasOwnProperty(D))&&(b(D),b(E[D]),I++);Et[P+++t]=I>>8,Et[P+t]=I&255}:E=>{let _=Object.keys(E),P,I=n.transitions||(n.transitions=Object.create(null)),D=0;for(let B=0,z=_.length;B<z;B++){let W=_[B];P=I[W],P||(P=I[W]=Object.create(null),D++),I=P}let k=I[ax];if(k)k>=96&&f?(Et[ht++]=((k-=96)&31)+96,Et[ht++]=k>>5):Et[ht++]=k;else{k=n.nextId,k||(k=64),k<m&&this.shouldShareStructure&&!this.shouldShareStructure(_)?(k=n.nextOwnId,k<g||(k=m),n.nextOwnId=k+1):(k>=g&&(k=m),n.nextId=k+1);let B=_.highByte=k>=96&&f?k-96>>5:-1;I[ax]=k,n[k-64]=_,k<m?(_.isShared=!0,n.sharedLength=k-63,r=!0,B>=0?(Et[ht++]=(k&31)+96,Et[ht++]=B):Et[ht++]=k):(B>=0?(Et[ht++]=213,Et[ht++]=114,Et[ht++]=(k&31)+96,Et[ht++]=B):(Et[ht++]=212,Et[ht++]=114,Et[ht++]=k),D&&(x+=w*D),y.length>=d&&(y.shift()[ax]=0),y.push(I),b(_))}for(let B=0,z=_.length;B<z;B++)b(E[_[B]])},A=E=>{let _;if(E>16777216){if(E-t>B9)throw new Error("Packed buffer would be larger than maximum buffer size");_=Math.min(B9,Math.round(Math.max((E-t)*(E>67108864?1.25:2),4194304)/4096)*4096)}else _=(Math.max(E-t<<2,Et.length-1)>>12)+1<<12;let P=new lI(_);return cs=new DataView(P.buffer,0,_),Et.copy?Et.copy(P,0,t,E):P.set(Et.slice(t,E)),ht-=t,t=0,Gc=P.length-10,Et=P}}useBuffer(e){Et=e,cs=new DataView(Et.buffer,Et.byteOffset,Et.byteLength),ht=0}};GB=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,ite];QC=[{pack(e,t,i){let r=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,r)}else if(r>0&&r<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(a+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return t(0),i(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(r)))}}},{pack(e,t,i){let r=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),i(r)}},{pack(e,t,i){let{target:r,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(r[n++]=212,r[n++]=101,r[n++]=0),i([e.name,e.message])}},{pack(e,t,i){let{target:r,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(r[n++]=212,r[n++]=120,r[n++]=0),i([e.source,e.flags])}},{pack(e,t){this.structuredClone?z9(e,16,t):F9(BM?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let i=e.constructor;i!==cte&&this.structuredClone?z9(e,lte.indexOf(i.name),t):F9(e,t)}},{pack(e,t){let{target:i,position:r}=t(1);i[r]=193}}];function z9(e,t,i,r){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=i(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=i(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=i(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function F9(e,t){let i=e.byteLength;var r,n;if(i<256){var{target:r,position:n}=t(i+2);r[n++]=196,r[n++]=i}else if(i<65536){var{target:r,position:n}=t(i+3);r[n++]=197,r[n++]=i>>8,r[n++]=i&255}else{var{target:r,position:n,targetView:s}=t(i+5);r[n++]=198,s.setUint32(n,i),n+=4}r.set(e,n)}function nFe(e,t,i,r){let n=e.length;switch(n){case 1:t[i++]=212;break;case 2:t[i++]=213;break;case 4:t[i++]=214;break;case 8:t[i++]=215;break;case 16:t[i++]=216;break;default:n<256?(t[i++]=199,t[i++]=n):n<65536?(t[i++]=200,t[i++]=n>>8,t[i++]=n&255):(t[i++]=201,t[i++]=n>>24,t[i++]=n>>16&255,t[i++]=n>>8&255,t[i++]=n&255)}return t[i++]=r,t.set(e,i),i+=n,i}function sFe(e,t){let i,r=t.length*6,n=e.length-r;for(t.sort((s,a)=>s.offset>a.offset?1:-1);i=t.pop();){let s=i.offset,a=i.id;e.copyWithin(s+r,s,n),r-=6;let o=s+r;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function p1(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");GB.unshift(e.Class),QC.unshift(e)}tFe(e)}var dte=new hte({useRecords:!1});dte.pack;dte.pack;var aFe=512,oFe=1024,U9=new hte({structuredClone:!0});p1({Class:pi.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,pi.prototype),e}});p1({Class:oi.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,oi.prototype),e}});p1({Class:Ua.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Ua.prototype),e}});p1({Class:M9.prototype.constructor,type:4,write(e){return e.id},read(e){return new M9(e)}});p1({Class:P9.prototype.constructor,type:5,write(e){return e.data},read(e){return new P9(e)}});p1({Class:Ls.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Ls.prototype),e}});function lFe(e){var t=0;if(e.length===0)return t;for(let i=0;i<e.length;i++){let r=e[i];t=(t<<5)-t+r,t=t&t}return t}function tL(e){if(BB(e))return e;if(Array.isArray(e))return e.map(tL);if(typeof e=="object"&&e!==null){let t={};for(let i of Object.keys(e).sort())t[i]=tL(e[i]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var iL;(e=>{function t(n){return U9.pack(n)}e.serialize=t;function i(n){return U9.unpack(n)}e.deserialize=i;function r(n){return lFe(t(tL(n))).toString()}e.checksum=r})(iL||(iL={}));var j9;(e=>{function t(r){return r.type==="Conditional"?r.condition.type==="Distance"?"Distance":"StateChange":r.type}e.toEventUIType=t;function i(r){return r==="Distance"||r==="StateChange"?"Conditional":r}e.fromEventUIType=i})(j9||(j9={}));function V9(e){return e==="MouseDown"||e==="MouseUp"||e==="KeyDown"||e==="KeyUp"||e==="Collision"||e==="Trigger"}var ro={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},H9;(e=>{function t(r){return r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress"||r.type==="KeyDown"||r.type==="KeyUp"||r.type==="KeyPress"}e.is=t;function i(r){return r==="MouseDown"||r==="MouseUp"||r==="MousePress"?{type:r,mode:"Object",disabled:!1,actions:new oi}:{type:r,disabled:!1,key:void 0,actions:new oi}}e.defaultData=i})(H9||(H9={}));var JC;(e=>{function t(i){return{type:"Property",value:[i??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(JC||(JC={}));var rL;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:JC.propertyDefaultData(n),rOperand:{...JC.valueDefaultData}}}e.comparisonDefaultData=t;function i(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=i;function r(n,s){return{type:"State",object:n??null,state:s??null}}e.stateDefaultData=r})(rL||(rL={}));var W9;(e=>{function t(i){return i.find(r=>r==="ifActions"||r==="elseActions")!==void 0}e.isConditionalSubActions=t})(W9||(W9={}));var G9;(e=>{function t(r){return r.type==="Conditional"}e.is=t;function i(r){return{type:"Conditional",disabled:!1,inActions:new oi,outActions:new oi,condition:rL.distanceDefaultData(r)}}e.defaultData=i})(G9||(G9={}));var q9;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new oi,drop:new oi}})(q9||(q9={}));var nL;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new oi})(nL||(nL={}));var sL;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(sL||(sL={}));var Y9;(e=>{function t(r){return r.type==="MouseHover"}e.is=t;function i(){return{type:"MouseHover",disabled:!1,actions:new oi}}e.defaultData=i})(Y9||(Y9={}));var X9;(e=>{function t(r){return r.type==="Scroll"}e.is=t;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new oi}}e.defaultData=i})(X9||(X9={}));var K9;(e=>{function t(r){return r.type==="Start"}e.is=t;function i(){return{type:"Start",disabled:!1,actions:new oi}}e.defaultData=i})(K9||(K9={}));var $9;(e=>{function t(r){return r.type==="Collision"}e.is=t;function i(){return{type:"Collision",disabled:!1,target:"character",actions:new oi}}e.defaultData=i})($9||($9={}));var Z9;(e=>{function t(r){return r.type==="Trigger"}e.is=t;function i(r,n){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new oi,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:r.toArray(),radius:r.length()/2,helperVisible:!0}}e.defaultData=i})(Z9||(Z9={}));var aL;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function i(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=i;function r(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=r;function n(){let a={size:"mobile",operator:"<",actions:new oi},o={size:"tablet",operator:"<",actions:new oi},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new oi},u=new oi;return u.push({id:Xt.generateUUID(),fi:0,data:a},{id:Xt.generateUUID(),fi:1,data:o},{id:Xt.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:u}}e.defaultData=n;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new oi}}e.defaultBreakpointData=s})(aL||(aL={}));var oL;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(r){return r.type==="VariableChange"}e.is=t;function i(){return{disabled:!1,type:"VariableChange",actions:new oi,variableId:"",objectId:null,property:"Position X"}}e.defaultData=i})(oL||(oL={}));var Q9;(e=>{function t(r){return r.type==="API"}e.is=t;function i(){return{disabled:!1,type:"API",successActions:new oi,errorActions:new oi,userAPIId:""}}e.defaultData=i})(Q9||(Q9={}));var J9;(e=>{function t(r){return r.type==="WEBHOOK"}e.is=t;function i(){return{disabled:!1,type:"WEBHOOK",actions:new oi,userWebhookId:""}}e.defaultData=i})(J9||(J9={}));var eH;(e=>{function t(r){return r.type==="AIAssistantListener"}e.is=t;function i(){return{disabled:!1,type:"AIAssistantListener",actions:new oi,analysis:"average",analysisRange:[0,71],analysisSingle:0}}e.defaultData=i})(eH||(eH={}));var tH;(e=>{function t(r){return r.type==="AIAssistantTrigger"}e.is=t;function i(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new oi}}e.defaultData=i})(tH||(tH={}));var m1="personal camera",bb="a218fcc3-276b-49b9-b485-49037fd14f5f",uFe=2960946,su=5526619,Kd;(e=>{function t(m,g){return m[0]===g[0]&&m[1]===g[1]}e.isEqual=t;function i(m,g,y){return[m[0]+(g[0]-m[0])*y,m[1]+(g[1]-m[1])*y]}e.lerp=i;function r(m,g){return[m[0]+g[0],m[1]+g[1]]}e.add=r;function n(m,g){return[m[0]-g[0],m[1]-g[1]]}e.sub=n;function s(m,g){return[m[0]*g[0],m[1]*g[1]]}e.multiply=s;function a(m,g){return[m[0]/g[0],m[1]/g[1]]}e.divide=a;function o(m,g){return Math.pow(g[0]-m[0],2)+Math.pow(g[1]-m[1],2)}e.distanceSquared=o;function l(m,g){return Math.sqrt(o(m,g))}e.distance=l;function u(m,g){return m[0]*g[0]+m[1]*g[1]}e.dot=u;function c(m,g){return[m[0]*g,m[1]*g]}e.scalarMultiply=c;function h(m,g,y){let x=e.sub(g,m),w=e.sub(y,m),b=e.dot(x,w)/e.dot(x,x),C=e.scalarMultiply(x,b);return e.add(m,C)}e.projectionOnto=h;function d(m,g,y){return l(m,h(m,g,y))}e.projectionOntoDistance=d;function f(m,g){return[(m[0]+g[0])*.5,(m[1]+g[1])*.5]}e.center=f})(Kd||(Kd={}));var Lg;(e=>{function t(l,u){return l[0]===u[0]&&l[1]===u[1]&&l[2]===u[2]}e.isEqual=t;function i(l,u){return[l[0]+u[0],l[1]+u[1],l[2]+u[2]]}e.add=i;function r(l,u){return[l[0]-u[0],l[1]-u[1],l[2]-u[2]]}e.sub=r;function n(l,u){return[l[0]/u[0],l[1]/u[1],l[2]/u[2]]}e.div=n;function s(l,u){return[l[0]*u[0],l[1]*u[1],l[2]*u[2]]}e.mul=s;function a(l,u){return Math.hypot(l[0]-u[0],l[1]-u[1],l[2]-u[2])}e.dist=a;function o(l,u,c){return[l[0]+(u[0]-l[0])*c,l[1]+(u[1]-l[1])*c,l[2]+(u[2]-l[2])*c]}e.lerp=o})(Lg||(Lg={}));var eA;(e=>{function t(r,n){return r[0]===n[0]&&r[1]===n[1]&&r[2]===n[2]&&r[3]===n[3]}e.isEqual=t;function i(r,n,s){return[r[0]+(n[0]-r[0])*s,r[1]+(n[1]-r[1])*s,r[2]+(n[2]-r[2])*s,r[3]+(n[3]-r[3])*s]}e.lerp=i})(eA||(eA={}));var iH;(e=>{let t=180/Math.PI,i=Math.PI/180;function r(o){return typeof o=="number"?o*t:o}function n(o){return typeof o=="number"?o*i:o}function s(o){return[r(o[0]),r(o[1]),r(o[2])]}e.radToDeg=s;function a(o){return[n(o[0]),n(o[1]),n(o[2])]}e.degToRad=a})(iH||(iH={}));var ky;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function i(n){return n??e.identity}e.simplify=i;function r(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let u=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/u,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/u,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/u}return a}e.applyMatrix4=r})(ky||(ky={}));var za;(e=>{function t(u){return typeof u=="object"&&typeof u.r=="number"&&typeof u.g=="number"&&typeof u.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function i(u){return{r:Math.round(u.r*255),g:Math.round(u.g*255),b:Math.round(u.b*255),a:1}}e.toRgb255a1=i;function r(u){return{r:u.r,g:u.g,b:u.b}}e.clone=r;function n(u){return u=Math.floor(u),{r:(u>>16&255)/255,g:(u>>8&255)/255,b:(u&255)/255}}e.fromHex=n;function s(u){return Math.round(u.r*255)*65536+Math.round(u.g*255)*256+Math.round(u.b*255)}e.toHex=s;function a(u,c){return u.r===c.r&&u.g===c.g&&u.b===c.b}e.equals=a;function o(u,c){return u.r.toFixed(2)===c.r.toFixed(2)&&u.g.toFixed(2)===c.g.toFixed(2)&&u.b.toFixed(2)===c.b.toFixed(2)}e.equalsFixed=o;function l(u,c,h){return{r:u.r+(c.r-u.r)*h,g:u.g+(c.g-u.g)*h,b:u.b+(c.b-u.b)*h}}e.lerp=l})(za||(za={}));var Qr;(e=>{e.white={...za.white,a:1},e.transparent={...za.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function i(l,u){return{...za.fromHex(l),a:u}}e.fromHexAndA=i;function r(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=r;function n(l,u){return za.equals(l,u)&&l.a===u.a}e.equals=n;function s(l,u){return za.equalsFixed(l,u)&&l.a.toFixed(2)===u.a.toFixed(2)}e.equalsFixed=s;function a(l,u,c){return{r:l.r+(u.r-l.r)*c,g:l.g+(u.g-l.g)*c,b:l.b+(u.b-l.b)*c,a:l.a+(u.a-l.a)*c}}e.lerp=a;function o({r:l,g:u,b:c,a:h}=e.white){return`rgba(${l*255}, ${u*255}, ${c*255}, ${h})`}e.toStyle=o})(Qr||(Qr={}));var lL;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(lL||(lL={}));var rH;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(rH||(rH={}));var nH;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(nH||(nH={}));var np;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(np||(np={}));function sH(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var Kg;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(i){return e.all.includes(i)}e.is=t})(Kg||(Kg={}));var By;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(i){var r,n;return i.type==="PerspectiveCamera"?((r=i.perspective)==null?void 0:r.zoom)??1:((n=i.orthographic)==null?void 0:n.zoom)??1}e.getZoom=t})(By||(By={}));var _p;(e=>{function t(r,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(r[0],r[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[r[0]+r[0]*n,0,0]},grid:{count:[2,2,2],size:r.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function i(r,n){let s={...r};if(fte.forEach(a=>{Object.assign(s,{[a]:n[a]??r[a]})}),s.radial={...r.radial},n.radial){let a=r.radial,o=n.radial;pte.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...r.linear},n.linear){let a=r.linear,o=n.linear;mte.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...r.grid},n.grid){let a=r.grid,o=n.grid;gte.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...r.toObject},n.toObject){let a=r.toObject,o=n.toObject;vte.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...r.randomnessObject},n.randomnessObject){let a=r.randomnessObject,o=n.randomnessObject;yte.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=i})(_p||(_p={}));var uL;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function i(r,n){let s=[];r.count!==void 0&&s.push({type:0,path:n,props:{count:r.count}});for(let a of t){let o=r[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...n,a],props:o})}return s}e.toOps=i})(uL||(uL={}));var fte=["count"],pte=["radius","start","end","position","scale","rotation"],mte=["position","scale","rotation"],gte=["count","size"],vte=["count","position","scale","rotation"],yte=["strength","scale","rotation","position","movement","seed","freqScale"],cL;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(i){return e.all.includes(i)}e.is=t})(cL||(cL={}));var hL;(e=>{function t(r){return i(r)}e.defaultData=t;function i(r){if(r==="PointLight")return{type:r,color:Qr.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(r==="SpotLight")return{type:r,color:Qr.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(r==="DirectionalLight")return{type:r,color:Qr.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(hL||(hL={}));var tA;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}))(tA||(tA={}));var zy;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(zy||(zy={}));var dL;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(i,r){return i.castShadow===r.castShadow&&i.receiveShadow===r.receiveShadow}e.equals=t})(dL||(dL={}));var fL;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(i,r){return i.flatShading===r.flatShading&&i.side===r.side&&i.wireframe===r.wireframe}e.equals=t})(fL||(fL={}));var pL;(e=>e.defaultData={...fL.defaultData,...dL.defaultData})(pL||(pL={}));var aH;(e=>{function t(i,r){var s,a;let n=[];if("material"in i){let o=typeof i.material=="string"?r.materials[i.material]??((s=r.lib.materials[i.material])==null?void 0:s.asset):i.material;o&&n.push(o)}else if("materials"in i)for(let o of i.materials){let l=typeof o=="string"?r.materials[o]??((a=r.lib.materials[o])==null?void 0:a.asset):o;l&&n.push(l)}return n}e.getMaterialData=t})(aH||(aH={}));var iA;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(iA||(iA={}));var oH;(e=>{function t(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="particle"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}e.is=t})(oH||(oH={}));function cFe(e){return e.type!=="displace"}var lH;(e=>{function t(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}e.is=t})(lH||(lH={}));var xte=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],hFe=["wrapping","image","video","name","minFilter","magFilter"],ma;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let u=s.texture;u&&Object.assign(u,o)}}e.patch=t;function i(s,a){return s==="light"&&a?r(a):n(s)}e.defaultData=i;function r(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:iA.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...a,type:"color",color:za.fromHex(su)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...za.fromHex(6710886),a:1},colorB:{...za.fromHex(6710886),a:1},colorC:{...za.fromHex(16777215),a:1},colorD:{...za.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:Qr.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Qr.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:Qr.fromHexAndA(0,1),contourColor:Qr.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...za.fromHex(0),a:1},colorB:{...za.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(ma||(ma={}));var ba;(e=>{function t(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}e.isMergable=t;function i(c){let h="";return c.layers.forEach(d=>{Object.entries(d.data).forEach(([f,m])=>{h+=`${f}${m}`,Array.isArray(m)?m.forEach(g=>h+=`${g}`):typeof m=="object"?Object.values(m).forEach(g=>{typeof g=="number"?h+=`${g.toFixed(4)}`:h+=`${g}`}):h+=`${m}`})}),h}e.getHash=i;function r(){return{layers:new oi}}e.defaultEmptyData=r;function n(c="layer1",h="layer2"){return a("phong",c,h)}e.defaultData=n;function s(c,h){return{...c,name:h}}e.withName=s;function a(c,h="layer1",d="layer2"){let f=new oi;return f.push({fi:0,data:ma.defaultData("light",c),id:h}),f.push({fi:1,data:ma.defaultData("color"),id:d}),{layers:f}}e.defaultTwoLayerData=a;function o(c){let h=ma.defaultData("texture");c&&Object.assign(h.texture,{image:c});let d=new oi;return d.push({fi:0,data:h,id:"layer1"}),d.push({fi:1,data:{...ma.defaultData("transmission"),alpha:1},id:"layer2"}),d.push({fi:2,data:{...ma.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:d}}e.defaultUIObjectMaterial=o;function l(c,h="phong",d="layer1",f="layer2"){let m=ma.defaultData("texture");Object.assign(m.texture,{image:c});let g=new oi;return g.push({fi:0,data:m,id:d}),g.push({fi:1,data:ma.defaultData("light",h),id:f}),{layers:g}}e.defaultTwoLayerTextureData=l;function u(c,h="phong",d="layer1",f="layer2"){let m=ma.defaultData("video");Object.assign(m.texture,{video:c});let g=new oi;return g.push({fi:0,data:m,id:d}),g.push({fi:1,data:ma.defaultData("light",h),id:f}),{layers:g}}e.defaultTwoLayerVideoTextureData=u})(ba||(ba={}));var rA;(e=>{function t(){return{points:new oi,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(rA||(rA={}));var nA;(e=>{function t(){return{points:new oi,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(nA||(nA={}));var bte={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},mL;(e=>{function t(i,r){let n={...i};return wte.forEach(s=>{Object.assign(n,{[s]:r[s]??i[s]})}),n}e.merge=t})(mL||(mL={}));var _te={shape:bte,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},wte=["depth","offset","angle","twist","startScale","endScale"],sA;(e=>{function t(r){return r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"||r==="UIGeometry"}e.is2DParametricMesh=t;function i(r){return r==="PolygonGeometry"||r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"||r==="PathGeometry"||r==="VectorGeometry"||r==="ConeGeometry"||r==="CubeGeometry"||r==="CylinderGeometry"||r==="DodecahedronGeometry"||r==="HelixGeometry"||r==="IcosahedronGeometry"||r==="LatheGeometry"||r==="PyramidGeometry"||r==="SphereGeometry"||r==="PlaneGeometry"||r==="BackdropGeometry"||r==="TorusGeometry"||r==="TorusKnotGeometry"||r==="BooleanGeometry"||r==="TextGeometry"||r==="InputGeometry"}e.isParametricMesh=i})(sA||(sA={}));var gL;(e=>{function t(i,r){let n={...i};return Object.assign(n,r),n.type==="PathGeometry"&&"extrusion"in r&&r.extrusion&&(n.extrusion={...i.extrusion},Object.assign(n.extrusion,mL.merge(n.extrusion,r.extrusion))),n}e.merge=t})(gL||(gL={}));var cp;(e=>{function t(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="UIGeometry")return{type:i,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:nA.defaultData(),extrusion:_te};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:rA.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="ShapeBlendGeometry")return{type:i,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="InputGeometry")return{...e.defaultData("TextGeometry"),type:i,editable:!0};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(cp||(cp={}));var uI=["width","height","depth"],vL;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:za.white,near:.1,far:2e3})(vL||(vL={}));var aA;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(aA||(aA={}));var yL;(e=>e.defaultData={softShadowQuality:"low"})(yL||(yL={}));var xL;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(xL||(xL={}));var bL;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(bL||(bL={}));var Fy;(e=>e.defaultData={usePhysics:!1,gravity:-10})(Fy||(Fy={}));var _L;(e=>e.defaultData={playCamera:m1,gameControlObject:null})(_L||(_L={}));var wL;(e=>e.defaultData={backgroundColor:Qr.fromHexAndA(uFe,1),postprocessing:aA.defaultData,fog:vL.defaultData,globalPhysics:Fy.defaultData,ambient:xL.defaultData,ao:bL.defaultData,shadow:yL.defaultData,publish:_L.defaultData})(wL||(wL={}));var EL;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(EL||(EL={}));var uH;(e=>{function t(r){return r==="Component"||r==="Instance"}e.isComponentRelated=t;function i(r){return r==="Empty"||r==="Instance"}e.isEmptyOrComponent=i})(uH||(uH={}));var Uy;(e=>{e.identity={...lL.identity,hiddenMatrix:ky.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function i(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}e.merge=i;function r(n,s){return zee({position:Lg.isEqual(n.position,s.position)?void 0:s.position,rotation:Lg.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:Lg.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:ky.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=r})(Uy||(Uy={}));var Zs;(e=>e.defaultData={states:new oi,events:new oi,visible:!0,raycastLock:!1,physics:zy.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Uy.identity,cloner:null})(Zs||(Zs={}));var SL;(e=>e.defaultData={type:"Empty",...Zs.defaultData})(SL||(SL={}));var cH;(e=>e.defaultData={type:"ParticleCollider",...EL.defaultData,...Zs.defaultData})(cH||(cH={}));var hH;(e=>e.defaultData={type:"Component",...Zs.defaultData})(hH||(hH={}));var dH;(e=>e.defaultData={type:"Particle",...Zs.defaultData,...tA.defaultData})(dH||(dH={}));var hp;(e=>e.defaultData={type:"Mesh",...Zs.defaultData,...pL.defaultData})(hp||(hp={}));var y_;(e=>e.defaultData={...Zs.defaultData,...Uy.identity,position:[0,0,By.DefaultTargetOffset],...By.defaultData})(y_||(y_={}));var TL;(e=>{function t(i){return{...Zs.defaultData,...hL.defaultData(i)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(TL||(TL={}));var oA;(e=>{function t(r,n,s=0){for(;s<n.length;){let a=r?r[n[s]]:void 0;if(n.length===s+1)return a;if(a)r=a.descendants,s+=1;else return}}e.resolveWithDes=t;function i(r,n,s=0){let a=t(r,n,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=i})(oA||(oA={}));var wp;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(r,n){return{...Zs.defaultData,...n,component:r,overrides:new Ls,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function i(r){let n=Uy.fromObject(r.data);return t(r.id,n)}e.fromComponentData=i})(wp||(wp={}));var jy;(e=>{e.defaultData={type:"Page",...Zs.defaultData,physics:{...zy.defaultData,fusedBody:!1},...wL.defaultData,camera:y_.defaultData};function t(i){return i.uiScene!==void 0}e.isUIPage=t})(jy||(jy={}));var CL;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:ky.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:zy.defaultData,states:new oi,events:new oi,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...By.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Zs.defaultData,...hp.defaultData,geometry:cp.defaultData("RectangleGeometry"),material:ba.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Zs.defaultData,...hp.defaultData,geometry:cp.defaultData("BooleanGeometry"),material:ba.defaultTwoLayerData("phong","layer1","layer2")},e.defaultShapeBlendObject={name:"Shape Blend",...Zs.defaultData,...hp.defaultData,geometry:cp.defaultData("ShapeBlendGeometry"),material:ba.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Zs.defaultData,...hp.defaultData,geometry:cp.defaultData("TextGeometry"),material:ba.defaultTwoLayerData("phong","layer1","layer2")},e.defaultInputObject={name:"Input",...Zs.defaultData,...hp.defaultData,geometry:cp.defaultData("InputGeometry"),material:ba.defaultTwoLayerData("phong","layer1","layer2")}))(CL||(CL={}));var bg;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new Ls}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new Ls})))):Kg.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function i(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=v_(o.material,l=>{if(typeof l!="string")for(let[u,c]of Object.entries(a.material.layers)){let h=l.layers.data(u);h&&ma.patch(h,c)}}).data),o.materials&&a.materials&&(o.materials=v_(o.materials,l=>{var u,c;for(let h=0;h<o.materials.length;h++){let d=a.materials[h];if(typeof d!="string")for(let[f,m]of Object.entries(d.layers)){let g=(c=(u=l[h])==null?void 0:u.layers)==null?void 0:c.data(f);g&&ma.patch(g,m)}}}).data),o}function r(s,a){let o,l=[],u={orthographic:0,perspective:0,geometry:0};function c(h,d){for(let[f,m]of Object.entries(d.layers)){let{texture:g,...y}=m;if(g!==void 0&&Object.keys(g).length>0){let x={path:[...h,"layers",f,"texture"],props:g,type:0};l.push(x)}if(Object.keys(y).length>0){let x={path:[...h,"layers",f],props:y,type:0};l.push(x)}}}for(let[h,d]of Object.entries(a))if(h!=="name")if(h==="cloner")l.push(...uL.toOps(d,["cloner"]));else if(h==="pathSnapping")l.push({path:[h],props:{slide:d.slide,offset:d.offset},type:0});else if(h==="material")c(["material"],d);else if(h==="materials")for(let[f,m]of Object.entries(d))c(["materials",f],m);else if(u[h]===0){if(h==="geometry"&&d.extrusion!==void 0){let f={path:[h,"extrusion"],props:d.extrusion,type:0};l.push(f),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let f={path:[h],props:d,type:0};l.push(f)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[h]=d;return l}e.toOps=r;function n(s,a){var l,u,c,h,d,f;if(a===void 0)return s;let o={...s};if(Object.assign(o,Uy.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=a.pathSnapping)==null?void 0:l.slide)??((u=o.pathSnapping)==null?void 0:u.slide)??0,offset:((c=a.pathSnapping)==null?void 0:c.offset)??((h=o.pathSnapping)==null?void 0:h.offset)??0})}),Kg.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let m=a;((d=m.orthographic)==null?void 0:d.zoom)!==void 0&&(o.orthographic.zoom=m.orthographic.zoom),((f=m.perspective)==null?void 0:f.zoom)!==void 0&&(o.perspective.zoom=m.perspective.zoom),m.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=m.isUpVectorFlipped),m.targetOffset!==void 0&&(o.targetOffset=m.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:gL.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=i(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:_p.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:_p.merge(o.cloner,a.cloner)});else if(cL.is(s.type)){let m=a;m.intensity!==void 0&&(o.intensity=m.intensity),m.color!==void 0&&(typeof m.color=="string"?o.color=m.color:o.color=za.clone(m.color))}return o}e.patch=n})(bg||(bg={}));var lA;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(lA||(lA={}));var Ep;(e=>e.defaultData={orbitControls:lA.defaultData,playPage:bb,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,i)=>{let r=0,n=0;return i<5?n=-30:i<10&&(n=30),i===0||i===10||i===5?r=30:(i===4||i===11||i===9)&&(r=-30),[120,[r,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(Ep||(Ep={}));var AL;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(AL||(AL={}));var ML;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(ML||(ML={}));var _g;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...AL.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:ML.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(_g||(_g={}));var x_;(e=>{function t(r){return r.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function i(r,n,s){r.scene.objects.traverseFrom(n,(a,o)=>{var l;if(o.type==="Instance"){let u=(l=hA.getComponentData(r,o.component))==null?void 0:l.data;u&&s(a,o,u.events)}else s(a,o,o.events)})}e.traverseModuleInstances=i})(x_||(x_={}));var wg;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:TL.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function t(n=!0,s=[]){let a=[],o=CL.defaultMeshObject;n&&(a.push({...e.defaultLight}),a.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]})),a.push(...s);let l=new Ua;return l.push({fi:1,id:bb,data:{...jy.defaultData,name:"Scene 1"},children:a}),l}e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:Ep.defaultData,styles:_g.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new Ua,publish:Ep.defaultData,styles:_g.defaultData()}},e.emptyDataWithPage=function(n=!0){return{objects:t(n),publish:Ep.defaultData,styles:_g.defaultData()}},e.emptyData=function(){return{objects:new Ua,publish:{...Ep.defaultData},styles:_g.defaultData()}};function i(n){return{...e.defaultData,objects:Hu(n,Ua.prototype)}}e.withObjs=i;function r(n,s){return i([{id:n,data:s,children:[],fi:0}])}e.withObj=r})(wg||(wg={}));var _b;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(_b||(_b={}));var PL;(e=>(e.defaultData=t=>({url:t,name:"New Webhook",parametersSchemas:new oi}),e.defaultParameterValueByType=t=>t==="number"?0:t==="boolean"?!1:""))(PL||(PL={}));var fH;(e=>e.defaultData=(t,i="GET")=>({url:t,method:i,name:"New API",headers:new oi,queries:new oi,autoStart:!0}))(fH||(fH={}));var ja;(e=>{function t(a){return a.textValue!==void 0}e.isTextValue=t;function i(a){return typeof a=="number"}e.isNumber=i;function r(a){return typeof a=="boolean"}e.isBoolean=r;function n(a){return t(a)?"string":r(a)?"boolean":"number"}e.typeOfVariable=n;function s(a){return e.isTextValue(a)?Array.isArray(a.textValue)?a.textValue.map(o=>o.toString().padStart(a.padding??2,"0")).join(a.deliminator??":")+(a.suffix!==void 0?" "+a.suffix:""):a.textValue.toString():e.isBoolean(a)?a?"True":"False":e.isNumber(a)?parseFloat(a.toFixed(3)).toString():a.toString()}e.getDisplayedValue=s})(ja||(ja={}));var DL;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(DL||(DL={}));var pH;(e=>e.all=[...DL.all,"components"])(pH||(pH={}));var mH;(e=>{function t(){return{images:new pi,videos:new pi,colors:new pi,audios:new pi,particles:new pi,fonts:new pi,materials:new pi,components:new pi,variables:new pi,userAPIs:new pi,userWebhooks:new pi}}e.defaultData=t})(mH||(mH={}));var hf;(e=>{function t(){return{images:new pi,videos:new pi,colors:new pi,audios:new pi,particles:new pi,fonts:new pi,materials:new pi,components:new pi,variables:new pi,userAPIs:new pi,userWebhooks:new pi}}e.defaultData=t})(hf||(hf={}));var Mu;(e=>{function t(){let a={};return a["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Hu(a,pi.prototype)}e.defaultColors=t;function i(){return Hu({},pi.prototype)}e.defaultImages=i;function r(){return{catelogs:new pi,materials:new pi,images:new pi,videos:new pi,colors:new pi,audios:new pi,particles:new pi,fonts:new pi,variables:new oi,userAPIs:new pi,userWebhooks:new pi,lib:hf.defaultData()}}e.emptyData=r;function n(a){switch(a){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let o=[0,0,0];return{name:"Time",value:{textValue:o,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:o,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",a)}}e.defaultVariables=n;function s(a,o){if(o.format==="HH:mm:ss"){let l=Math.floor(a/3600),u=Math.floor((a-l*3600)/60),c=Math.round(a-l*3600-u*60);return{textValue:[l,u,c]}}else if(o.format==="mm:ss"){let l=Math.floor(a/60),u=Math.round(a-l*60);return{textValue:[l,u]}}else return o.format==="number"?a=Math.round(a):a=Math.round(a*1e3)/1e3,a}e.getFormattedTimerTime=s})(Mu||(Mu={}));var uA;(e=>e.list=["idle","move","jump","run"])(uA||(uA={}));var cA;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new oi,move:new oi,jump:new oi,run:new oi},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Qr.fromHexAndA(3728051,1)}}))(cA||(cA={}));function gH(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let i=t.colorA,r=t.colorB,n=[[i.r,i.g,i.b,i.a],[r.r,r.g,r.b,r.a]],s=[0,1];for(let o=2;o<10;o++)n.push(n[1]),s.push(1);let a={...Dh(vs(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let i={...vs(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,i)}})}function dp(e,t){Object.values(e.shared.materials).forEach(i=>t(i))}function fp(e,t){e.scene.objects.traverse((i,r)=>{"materials"in r?r.materials.forEach((n,s)=>{n===void 0&&(r.materials[s]=ba.defaultData(),n=r.materials[s]),typeof n!="string"&&t(n)}):"material"in r?typeof r.material!="string"&&(r.material===void 0&&(r.material=ba.defaultData()),t(r.material)):r.type==="Mesh"&&(r.material===void 0&&(r.material=ba.defaultData()),t(r.material)),"overrides"in r&&Object.values(r.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==Ls.prototype&&t(n.material)})})}function dFe(e){Object.assign(e.scene.publish,{orbitControls:{...lA.defaultData,...vs(e.scene.publish.orbitControls)}})}function fFe(e){Object.assign(e.scene.publish.settings,{video:{...Ep.defaultData.settings.video,...vs(e.scene.publish.settings.video)}})}function pFe(e){function t(i){if(i.layers){for(let r of Object.values(i.layers))if(r){for(let[n,s]of Object.entries(r))if((xte.includes(n)||typeof s=="boolean")&&delete r[n],n==="texture")for(let[a,o]of Object.entries(s))(hFe.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((i,r)=>{r.states.forEach(n=>{let s=n;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function mFe(e){e.scene.publish.withBackground=!0}function gFe(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function vFe(e){e.scene.objects.traverse((t,i)=>{let r=i.cloner;r&&(r.radial.scale=r.radial.scale.map(n=>n+1),r.linear.scale=r.linear.scale.map(n=>n+1))})}function yFe(e){e.scene.objects.traverse((t,i)=>{let r=i.geometry;r&&(r.type==="DodecahedronGeometry"||r.type==="IcosahedronGeometry")&&(r.detail=Math.round(r.detail))})}function xFe(e){e.scene.objects.traverse((t,i)=>{let r=e.scene.objects.unproxy().parent(t);if(r){let n=vs(e.scene.objects.data(r));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=vs(i).booleanExclude!==!0)}})}function bFe(e){e.scene.objects.traverse((t,i)=>{if(i.type==="Mesh"){let r=i;i.geometry.type==="NonParametricGeometry"?r.material!==void 0&&delete r.material:r.materials!==void 0&&delete r.materials}})}function _Fe(e){function t(r){Object.setPrototypeOf(r,Ls.prototype),r.texture&&Object.setPrototypeOf(r.texture,Ls.prototype)}function i(r){Object.setPrototypeOf(r,Ls.prototype);for(let n in r)t(r[n])}e.scene.objects.traverse((r,n)=>{n.states.forEach(s=>{let a=s;if(a.material){let o=vs(a.material).layers;i(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],u=vs(l).layers;i(u),l.layers=u}})})}function vH(e){e.layers===void 0&&Object.assign(e,ba.defaultTwoLayerData("lambert"))}function cI(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let i=[...t.colors];i.push(t.colors[9]);let r=[...t.steps];r.push(t.steps[9]);let n={...vs(t),colors:i,steps:r};Object.assign(t,n)}})}function wFe(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function yH(e){e.scene.objects.traverse((t,i)=>{"materials"in i?i.materials.forEach(r=>{typeof r!="string"&&cI(r)}):"material"in i&&typeof i.material!="string"&&cI(i.material)}),Object.values(e.shared.materials).forEach(t=>cI(t))}function EFe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function SFe(e){e.shared.audios=Hu({},pi.prototype)}function TFe(e){e.shared.videos=Hu({},pi.prototype)}function CFe(e){let t=e.shared.materials;Object.entries(t).forEach(([i,r])=>{if(!r.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[i]:n})}})}function AFe(e){Object.entries(vs(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(vs(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function MFe(e){e.scene.publish.settings.web.preload=!1}function xH(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function bH(e){e.layers&&e.layers.forEach(t=>{cFe(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function PFe(e){e.shared.fonts=Hu({},pi.prototype)}function DFe(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function IFe(e){let t=[];e.scene.objects.traverse((i,r)=>{let n=r;if(n.type==="TextFrame"){let s=ba.defaultTwoLayerData("phong"),a=typeof n.color=="string"?e.shared.colors[n.color]:n.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=n.alpha;let o=DFe(n.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:n.name,...Zs.defaultData,...hp.defaultData,flatShading:!1,wireframe:!1,geometry:{...cp.defaultData("TextGeometry"),width:n.width,height:n.height,font:o,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:vs(n.states),events:vs(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},u=vs(e.scene.objects).parent(i);e.scene.objects.insertAfter(u??null,i,[{id:i+"new",data:l,children:[]}]),t.push(i)}}),t.forEach(i=>{e.scene.objects.delete(i)})}function OFe(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((i,r)=>{r.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new oi,move:new oi,jump:new oi}});else{let s=new oi;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:Xt.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((a,o,l)=>{let u={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},c={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(c,Dh(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(c,{control1:{...a.control1},control2:{...a.control2}});let h={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},d={state:a.state,...h,...c},f={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new oi({fi:0,id:Xt.generateUUID(),data:u},{fi:1,id:Xt.generateUUID(),data:d})};s.push({fi:l,id:o,data:f})}),delete n.targets)}})})}function RFe(e){e.scene.objects.traverse((t,i)=>{function r(n,s){var l;let a=new oi,o=[];if(i.events.forEach((u,c,h)=>{if(u.type==="Audio"&&u.trigger===s){let d;o.push(c),u.interaction==="play"?d={...Dh(u,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in u?u.after:void 0,toggle:"after"in u?u.toggle:void 0,type:"Audio"}:(u.interaction==="pause"||u.interaction==="stop")&&(d={...Dh(u,"interaction","delay","object","playAudio"),type:"Audio"}),d&&a.push({fi:h,id:c,data:d})}}),o.forEach(u=>i.events.delete(u)),a.length){let u=(l=i.events.find(c=>c.type===n))==null?void 0:l.data;u?"actions"in u&&u.actions.insertBefore(null,a):i.events.insertBefore(null,[{id:Xt.generateUUID(),data:{type:n,actions:a}}])}}r("Start","start"),r("MouseDown","mouseDown"),r("MouseUp","mouseUp"),r("KeyDown","keyDown"),r("KeyUp","keyUp")})}function _H(e){var i;let t=(i=e.layers.find(r=>r.type==="light"))==null?void 0:i.data;if((t==null?void 0:t.category)==="basic"){let r=ma.defaultData("light","phong"),n=t;Object.assign(n,r),n.visible=!1}}function wH(e){dp(e,_H),fp(e,_H)}function LFe(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function NFe(e){e.scene.objects.traverse((t,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function kFe(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=ba.defaultTwoLayerData("phong"))})}function BFe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function zFe(e){e.scene.objects.traverse((t,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function FFe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function UFe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function jFe(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.resetYPosition=Math.abs(r.resetYPosition-i.position[1]))})})}function VFe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((i,r)=>{t&&r.physics===null?r.collision=!1:r.collision="visibility"})}function HFe(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.navmesh=cA.defaultDataThirdPerson.navmesh)})})}function WFe(e){e.scene.styles||(e.scene.styles=_g.defaultData())}function EH(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function GFe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),fp(e,EH),dp(e,EH)}function qFe(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&Object.assign(r.gameActions,{run:new oi})})})}function YFe(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.keyAssignments=[...r.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function SH(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function XFe(e,t){if(t<1&&(fp(e,gH),dp(e,gH),e.schema=1),t<2&&(dFe(e),e.schema=2),t<3&&(pFe(e),e.schema=3),t<4&&(mFe(e),e.schema=4),t<5&&(gFe(e),e.schema=5),t<6&&(vFe(e),e.schema=6),t<7&&(yFe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(yH(e),e.schema=9),t<10&&(wFe(e),e.schema=10),t<11&&(EFe(e),e.schema=11),t<12&&(yH(e),e.schema=12),t<13&&(SFe(e),e.schema=13),t<14&&(CFe(e),e.schema=14),t<15&&(AFe(e),e.schema=15),t<16&&(MFe(e),e.schema=16),t<17&&(fp(e,xH),dp(e,xH),e.schema=17),t<18&&(fp(e,vH),dp(e,vH),e.schema=18),t<19&&(fFe(e),e.schema=19),t<20&&(PFe(e),IFe(e),e.schema=20),t<21&&(OFe(e),RFe(e),e.schema=21),t<22&&(wH(e),e.schema=22),t<23&&(LFe(e),e.schema=23),t<24&&(NFe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(TFe(e),t<25&&(e.schema=25)),t<26&&(xFe(e),e.schema=26),t<27&&(bFe(e),e.schema=27),t<28&&(wH(e),e.schema=28),t<29&&(_Fe(e),e.schema=29),t<30&&(kFe(e),e.schema=30),t<31&&(BFe(e),e.schema=31),t<33&&(zFe(e),e.schema=33),t<34&&(FFe(e),e.schema=34),t<35&&(UFe(e),e.schema=35),t<36&&(jFe(e),e.schema=36),t<37&&(VFe(e),e.schema=37),t<38&&(fp(e,bH),dp(e,bH),e.schema=38),t<39&&(HFe(e),e.schema=39),t<40&&(WFe(e),e.schema=40),t<41&&(GFe(e),e.schema=41),t<42&&(qFe(e),e.schema=42),t<43&&(YFe(e),e.schema=43),t<99){fp(e,SH),dp(e,SH),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=m1);let i=vs(e.scene.objects),r=e.scene.objects;e.scene.publish.playPage=bb,r.insertBefore(null,null,[{id:bb,data:{...jy.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:Dh(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:Dh(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...Fy.defaultData,...Dh(e.scene.environment,"usePhysics","gravity")},camera:vs(e.scene.ownerCamera)??jy.defaultData.camera,name:"Scene"},children:[]}]);for(let a of i)a.id!==wg.TRASH_CAN_ID&&r.move(bb,a.fi,a.id);let n=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,zy.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function TH(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function KFe(e){e.scene.objects.traverse((t,i)=>{let r=i.geometry;r&&r.type==="PathGeometry"&&(r.extrusion.capType="flat",r.extrusion.bevel=50,r.extrusion.bevelSides=6,r.extrusion.shape.type==="Custom"&&(r.extrusion.shape.shapeQuality="low"))})}function $Fe(e){var t;Array.isArray(vs(e.events))&&((t=e.events)==null||t.forEach(i=>{"disabled"in i||(i.disabled=!1),(i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress")&&(i.mode=i.mode||"Object")}))}var v0=180/Math.PI;function CH(e){e.rotation=e.rotation.slice(0,3).map(t=>t*v0)}function Ete(e){var i,r;CH(e),e.type==="Page"&&CH(e.camera),(i=e.states)==null||i.forEach(n=>{n.rotation===void 0||n.rotation===null||(n.rotation=n.rotation.slice(0,3).map(s=>s*v0))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*v0),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*v0),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=v0,t.extrusion.twist*=v0),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(vs(e.events))&&((r=e.events)==null||r.forEach(n=>{(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"||n.type==="Collision"||n.type==="Trigger")&&(n.runMode=n.toggle?"Toggle":"Repeat")}))}function ZFe(e){e.shared.variables=Hu({},pi.prototype)}function QFe(e){let t=vs(e.shared.variables);e.shared.variables=Hu(Object.entries(t??{}).map(([i,r],n)=>({fi:n,id:i,data:r})),oi.prototype)}var Bd=115;function Ste(e,t){t(e.data);for(let i of e.children)Ste(i,t)}function JFe(e){let t=e.schema??104;t!==Bd&&t<105&&(Ste(e.asset,Ete),e.schema=105)}function e5e(e){e.shared.particles=Hu({},pi.prototype),e.shared.lib&&(e.shared.lib.particles=hf.defaultData().particles)}function t5e(e){e.scene.objects.traverse((t,i)=>{i.type==="Particle"&&typeof i.renderMaterial.size=="number"&&Object.assign(i.renderMaterial,{size:[i.renderMaterial.size,i.renderMaterial.size]})})}function i5e(e){e.scene.objects.traverse((t,i)=>{i.type==="Page"&&(i.postprocessing.depthOfField.focusDistance=100,i.postprocessing.depthOfField.focalLength=20,i.postprocessing.depthOfField.bokehScale=5)})}function r5e(e){e.scene.objects.traverse((t,i)=>{var r;Array.isArray(vs(i.events))!==!1&&((r=i.events)==null||r.forEach(n=>{var a,o,l,u,c,h,d,f,m,g,y;let s=n.runMode;n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="Collision"||n.type==="Trigger"?(a=n.actions)==null||a.forEach(x=>{x.type==="Transition"&&(x.runMode=s??"Repeat"),(x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode=s==="Toggle"?"Toggle":"Normal")}):n.type==="MouseHover"||n.type==="MousePress"||n.type==="KeyPress"?(o=n.actions)==null||o.forEach(x=>{(x.type==="Transition"||x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Toggle")}):n.type==="GameControl"?(delete n.actions,Object.keys(n.gameActions).forEach(x=>{var w;(w=n.gameActions[x])==null||w.forEach(b=>{b.type==="Transition"&&(b.runMode="Repeat"),b.type==="Animation"&&(b.runMode="Normal")})})):n.type==="DragDrop"?(delete n.actions,(u=(l=n.dragDropActions)==null?void 0:l.drag)==null||u.forEach(x=>{(x.type==="Transition"||x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Toggle")}),(h=(c=n.dragDropActions)==null?void 0:c.drop)==null||h.forEach(x=>{(x.type==="Transition"||x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Toggle")})):n.type==="Resize"?(delete n.actions,(d=n.breakpoints)==null||d.forEach(x=>{var w;(w=x.actions)==null||w.forEach(b=>{(b.type==="Transition"||b.type==="Animation"||b.type==="SwitchCamera")&&(b.runMode="Toggle")})})):n.type==="Start"?(f=n.actions)==null||f.forEach(x=>{x.type==="Transition"&&(x.runMode="Once"),(x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Normal")}):n.type==="VariableChange"||n.type==="Scroll"?(m=n.actions)==null||m.forEach(x=>{x.type==="Transition"&&(x.runMode="Repeat"),(x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Normal")}):n.type==="Conditional"&&(delete n.actions,(g=n.inActions)==null||g.forEach(x=>{x.type==="Transition"&&(x.runMode="Repeat"),(x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Normal")}),(y=n.outActions)==null||y.forEach(x=>{x.type==="Transition"&&(x.runMode="Repeat"),(x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Normal")}))}))})}function n5e(e){e.shared.userAPIs=Hu({},pi.prototype),e.shared.userWebhooks=Hu({},pi.prototype),e.shared.lib&&(e.shared.lib.userAPIs=hf.defaultData().userAPIs,e.shared.lib.userWebhooks=hf.defaultData().userWebhooks)}function Tte(e){let t=e.schema??0;if(t!==Bd){console.warn("updating from ",t,"to ",Bd),XFe(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=Ep.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(fp(e,TH),dp(e,TH),e.schema=101),t<102&&(KFe(e),e.schema=102),t<104&&(e.shared.catelogs=new pi,e.shared.lib=hf.defaultData(),e.schema=104),t<105&&(ZFe(e),e.scene.objects.traverse((i,r)=>{Ete(r)}),e.schema=105);for(let i of Object.values(e.shared.lib.components))JFe(i);t<106&&(QFe(e),e.schema=106),t<107&&(e.shared.lib.variables=hf.defaultData().variables,e.schema=107),t<109&&(e5e(e),e.schema=109),t<110&&(t5e(e),e.schema=110),t<111&&(e.scene.objects.traverse((i,r)=>{$Fe(r)}),e.schema=111),t<112&&(i5e(e),e.schema=112),t<113&&(r5e(e),e.schema=113),t<114&&(e.scene.publish.settings.web.imageQuality===void 0&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),t<115&&(n5e(e),e.schema=115)}}var hA;(e=>{e.defaultData={schema:Bd,scene:wg.defaultData,frames:new pi().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",_b.defaultData),shared:{...Mu.emptyData(),colors:Mu.defaultColors()}},e.emptyDataForImports=function(){let s=wg.emptyDataWithPage();return{schema:Bd,scene:s,frames:new pi().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",_b.defaultData),shared:{...Mu.emptyData(),colors:Mu.defaultColors(),images:Mu.defaultImages()}}},e.emptyData=function(){return{schema:Bd,scene:wg.emptyDataWithPage(),frames:new pi().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",_b.defaultData),shared:Mu.emptyData()}},e.clipboard2dData=function(){return{schema:Bd,scene:wg.emptyData(),frames:new pi,shared:Mu.emptyData()}},e.collabHelper={...Z3,updateSchema(s){return(s.schema??0)<Bd?v_(s,Tte):(s.schema??0)-Bd}};function t(s){let a=e.collabHelper.updateSchema(s);return typeof a=="number"?a===0?s:null:a.data}e.updateSchemaDirectly=t;function i(s){return{...s,shared:{...s.shared,lib:hf.defaultData()}}}e.withoutLib=i;function r(s,a){let o=s.scene.objects.get(a);if(o&&o.data.type==="Component")return o;{let l=s.shared.lib.components[a];if(l)return l.asset}}e.getComponentData=r;function n(s){let a=Object.values(s.shared.userAPIs);for(let o of a){let l=o.headers;for(let u of l)if(u.data.key.toLowerCase()==="authorization"&&u.data.value!=="")return!0}return!1}e.hasSensitiveData=n})(hA||(hA={}));var IL;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(IL||(IL={}));var AH;(e=>{function t(i){return!0}e.is=t})(AH||(AH={}));var dA;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function t(r,n){return{position:(n==null?void 0:n.position)??r.position,rotation:(n==null?void 0:n.rotation)??r.rotation,scale:(n==null?void 0:n.scale)??r.scale,shear:(n==null?void 0:n.shear)??r.shear}}e.merge=t;function i(r,n){return zee({position:Kd.isEqual(r.position,n.position)?void 0:n.position,rotation:r.rotation===n.rotation?void 0:n.rotation,scale:Kd.isEqual(r.scale,n.scale)?void 0:n.scale,shear:r.shear&&n.shear&&Kd.isEqual(r.shear,n.shear)?void 0:n.shear})}e.diff=i})(dA||(dA={}));var OL;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})(OL||(OL={}));var MH;(e=>e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(MH||(MH={}));var fA;(e=>e.defaultData={opacity:1,fill:{color:Qr.fromHexAndA(su,1),enabled:!0},stroke:{color:Qr.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:Qr.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:Qr.from0to1([0,0,0,1]),enabled:!1,spread:0}})(fA||(fA={}));var Eg;(e=>{function t(a,o){return{name:o}}e.newEmpty=t;function i(a,o){if(o===void 0)return a;let l={...a},u=["width","height","cornerRadius"];for(let c of u)c in l&&c in o&&o[c]!==void 0&&Object.assign(l,{[c]:o[c]});return l}function r(a,o){if(o===void 0)return a;let l={...a};return"fill"in l&&"fill"in o&&o.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...o.fill}}),"stroke"in l&&"stroke"in o&&o.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...o.stroke}}),"layerBlur"in l&&"layerBlur"in o&&o.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...o.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in o&&o.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...o.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in o&&o.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...o.dropShadow}}),"innerShadow"in l&&"innerShadow"in o&&o.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...o.innerShadow}}),l}function n(a,o){if(o===void 0)return a;let l={...a};return Object.assign(l,dA.merge(l,o)),l=i(l,o),l=r(l,o),l}e.patch=n;function s(a,o){let l,u=[];for(let[c,h]of Object.entries(o))c!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},u.push(l)),l.props[c]=h);return u}e.toOps=s})(Eg||(Eg={}));var b_;(e=>e.defaultData={...dA.defaultData,...OL.defaultData,states:new oi,events:new oi,visible:!0,raycastLock:!1})(b_||(b_={}));var Vy;(e=>e.defaultData={...b_.defaultData,...fA.defaultData})(Vy||(Vy={}));var pA;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(pA||(pA={}));var RL;(e=>e.defaultData={...Vy.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(RL||(RL={}));var __;(e=>e.defaultData={...Vy.defaultData,...pA.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(__||(__={}));var LL;(e=>e.defaultData={...Vy.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(LL||(LL={}));var NL;(e=>e.defaultData={...Vy.defaultData,type:"path2d",path:"",name:"Path"})(NL||(NL={}));var PH;(e=>{function t(i){return i.type==="ellipse2d"||i.type==="rectangle2d"||i.type==="text2d"||i.type==="vector2d"||i.type==="path2d"}e.is=t})(PH||(PH={}));var mA;(e=>e.defaultData={...b_.defaultData,name:"Group",type:"group2d"})(mA||(mA={}));var kL;(e=>e.defaultData=()=>({...b_.defaultData,...pA.defaultData,...fA.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:Qr.fromHexAndA(4737101,1),enabled:!0},stroke:{color:Qr.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(kL||(kL={}));var Ng;(e=>{function t(a){switch(a){case"rectangle2d":return{...__.defaultData};case"ellipse2d":return{...RL.defaultData};case"text2d":return{...LL.defaultData};case"vector2d":return{...__.defaultData};case"path2d":return{...NL.defaultData};case"frame2d":return{...kL.defaultData()};case"group2d":return{...mA.defaultData}}}e.defaultData=t;function i(a){return"width"in a&&"height"in a?[typeof a.width=="number"?a.width*.5:0,typeof a.height=="number"?a.height*.5:0]:[0,0]}e.getPivot=i;function r(a){return a.type==="rectangle2d"||a.type==="ellipse2d"||a.type==="text2d"||a.type==="frame2d"}e.isResizeable=r;function n(a){return a.type==="frame2d"&&a.autoLayout!==void 0}e.isAutoLayoutable=n;function s(a){return a.type==="rectangle2d"||a.type==="frame2d"}e.hasCorners=s})(Ng||(Ng={}));var BL;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new Ua},e.emptyData=function(){return{type:"scene2d",objects:new Ua}}))(BL||(BL={}));function Sg(e,t=!1){let i=e[0].index!==null,r=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new ai,u=0;for(let c=0;c<e.length;++c){let h=e[c],d=0;if(i!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in h.attributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(h.attributes[f]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in h.morphAttributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;a[f]===void 0&&(a[f]=[]),a[f].push(h.morphAttributes[f])}if(t){let f;if(i)f=h.index.count;else if(h.attributes.position!==void 0)f=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,f,c),u+=f}}if(i){let c=0,h=[];for(let d=0;d<e.length;++d){let f=e[d].index;for(let m=0;m<f.count;++m)h.push(f.getX(m)+c);c+=e[d].attributes.position.count}l.setIndex(h)}for(let c in s){let h=DH(s[c]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,h)}for(let c in a){let h=a[c][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<h;++d){let f=[];for(let g=0;g<a[c].length;++g)f.push(a[c][g][d]);let m=DH(f);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(m)}}return l}function DH(e){let t,i,r,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(i===void 0&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=l.normalized),r!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new gi(s,i,r)}var s5e=Math.pow(2,-24),eS=class{constructor(){}};function yh(e,t,i){return i.min.x=t[e],i.min.y=t[e+1],i.min.z=t[e+2],i.max.x=t[e+3],i.max.y=t[e+4],i.max.z=t[e+5],i}function IH(e){let t=-1,i=-1/0;for(let r=0;r<3;r++){let n=e[r+3]-e[r];n>i&&(i=n,t=r)}return t}function OH(e,t){t.set(e)}function RH(e,t,i){let r,n;for(let s=0;s<3;s++){let a=s+3;r=e[s],n=t[s],i[s]=r<n?r:n,r=e[a],n=t[a],i[a]=r>n?r:n}}function tS(e,t,i){for(let r=0;r<3;r++){let n=t[e+2*r],s=t[e+2*r+1],a=n-s,o=n+s;a<i[r]&&(i[r]=a),o>i[r+3]&&(i[r+3]=o)}}function ox(e){let t=e[3]-e[0],i=e[4]-e[1],r=e[5]-e[2];return 2*(t*i+i*r+r*t)}function a5e(e,t){if(!e.index){let i=e.attributes.position.count,r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;i>65535?n=new Uint32Array(new r(4*i)):n=new Uint16Array(new r(2*i)),e.setIndex(new gi(n,1));for(let s=0;s<i;s++)n[s]=s}}function o5e(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],i=new Set;for(let n of e.groups)i.add(n.start),i.add(n.start+n.count);let r=Array.from(i.values()).sort((n,s)=>n-s);for(let n=0;n<r.length-1;n++){let s=r[n],a=r[n+1];t.push({offset:s/3,count:(a-s)/3})}return t}function hI(e,t,i,r,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0,h=1/0,d=1/0,f=1/0,m=-1/0,g=-1/0,y=-1/0,x=n!==null;for(let w=t*6,b=(t+i)*6;w<b;w+=6){let C=e[w+0],A=e[w+1],E=C-A,_=C+A;E<s&&(s=E),_>l&&(l=_),x&&C<h&&(h=C),x&&C>m&&(m=C);let P=e[w+2],I=e[w+3],D=P-I,k=P+I;D<a&&(a=D),k>u&&(u=k),x&&P<d&&(d=P),x&&P>g&&(g=P);let B=e[w+4],z=e[w+5],W=B-z,$=B+z;W<o&&(o=W),$>c&&(c=$),x&&B<f&&(f=B),x&&B>y&&(y=B)}r[0]=s,r[1]=a,r[2]=o,r[3]=l,r[4]=u,r[5]=c,x&&(n[0]=h,n[1]=d,n[2]=f,n[3]=m,n[4]=g,n[5]=y)}function l5e(e,t,i,r){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,u=-1/0;for(let c=t*6,h=(t+i)*6;c<h;c+=6){let d=e[c+0];d<n&&(n=d),d>o&&(o=d);let f=e[c+2];f<s&&(s=f),f>l&&(l=f);let m=e[c+4];m<a&&(a=m),m>u&&(u=m)}r[0]=n,r[1]=s,r[2]=a,r[3]=o,r[4]=l,r[5]=u}function u5e(e,t,i,r,n){let s=i,a=i+r-1,o=n.pos,l=n.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let u=0;u<3;u++){let c=e[s*3+u];e[s*3+u]=e[a*3+u],e[a*3+u]=c;let h=t[s*6+u*2+0];t[s*6+u*2+0]=t[a*6+u*2+0],t[a*6+u*2+0]=h;let d=t[s*6+u*2+1];t[s*6+u*2+1]=t[a*6+u*2+1],t[a*6+u*2+1]=d}s++,a--}else return s}}var Dd=32,c5e=(e,t)=>e.candidate-t.candidate,Uf=new Array(Dd).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),iS=new Float32Array(6);function h5e(e,t,i,r,n,s){let a=-1,o=0;if(s===0)a=IH(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=IH(e),a!==-1&&(o=d5e(i,r,n,a));else if(s===2){let l=ox(e),u=1.25*n,c=r*6,h=(r+n)*6;for(let d=0;d<3;d++){let f=t[d],m=(t[d+3]-f)/Dd;if(n<Dd/4){let g=[...Uf];g.length=n;let y=0;for(let w=c;w<h;w+=6,y++){let b=g[y];b.candidate=i[w+2*d],b.count=0;let{bounds:C,leftCacheBounds:A,rightCacheBounds:E}=b;for(let _=0;_<3;_++)E[_]=1/0,E[_+3]=-1/0,A[_]=1/0,A[_+3]=-1/0,C[_]=1/0,C[_+3]=-1/0;tS(w,i,C)}g.sort(c5e);let x=n;for(let w=0;w<x;w++){let b=g[w];for(;w+1<x&&g[w+1].candidate===b.candidate;)g.splice(w+1,1),x--}for(let w=c;w<h;w+=6){let b=i[w+2*d];for(let C=0;C<x;C++){let A=g[C];b>=A.candidate?tS(w,i,A.rightCacheBounds):(tS(w,i,A.leftCacheBounds),A.count++)}}for(let w=0;w<x;w++){let b=g[w],C=b.count,A=n-b.count,E=b.leftCacheBounds,_=b.rightCacheBounds,P=0;C!==0&&(P=ox(E)/l);let I=0;A!==0&&(I=ox(_)/l);let D=1+1.25*(P*C+I*A);D<u&&(a=d,u=D,o=b.candidate)}}else{for(let x=0;x<Dd;x++){let w=Uf[x];w.count=0,w.candidate=f+m+x*m;let b=w.bounds;for(let C=0;C<3;C++)b[C]=1/0,b[C+3]=-1/0}for(let x=c;x<h;x+=6){let w=~~((i[x+2*d]-f)/m);w>=Dd&&(w=Dd-1);let b=Uf[w];b.count++,tS(x,i,b.bounds)}let g=Uf[Dd-1];OH(g.bounds,g.rightCacheBounds);for(let x=Dd-2;x>=0;x--){let w=Uf[x],b=Uf[x+1];RH(w.bounds,b.rightCacheBounds,w.rightCacheBounds)}let y=0;for(let x=0;x<Dd-1;x++){let w=Uf[x],b=w.count,C=w.bounds,A=Uf[x+1].rightCacheBounds;b!==0&&(y===0?OH(C,iS):RH(C,iS,iS)),y+=b;let E=0,_=0;y!==0&&(E=ox(iS)/l);let P=n-y;P!==0&&(_=ox(A)/l);let I=1+1.25*(E*y+_*P);I<u&&(a=d,u=I,o=w.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function d5e(e,t,i,r){let n=0;for(let s=t,a=t+i;s<a;s++)n+=e[s*6+r*2];return n/i}function f5e(e,t){let i=e.attributes.position,r=e.index.array,n=r.length/3,s=new Float32Array(n*6),a=i.normalized,o=i.array,l=i.offset||0,u=3;i.isInterleavedBufferAttribute&&(u=i.data.stride);let c=["getX","getY","getZ"];for(let h=0;h<n;h++){let d=h*3,f=h*6,m,g,y;a?(m=r[d+0],g=r[d+1],y=r[d+2]):(m=r[d+0]*u+l,g=r[d+1]*u+l,y=r[d+2]*u+l);for(let x=0;x<3;x++){let w,b,C;a?(w=i[c[x]](m),b=i[c[x]](g),C=i[c[x]](y)):(w=o[m+x],b=o[g+x],C=o[y+x]);let A=w;b<A&&(A=b),C<A&&(A=C);let E=w;b>E&&(E=b),C>E&&(E=C);let _=(E-A)/2,P=x*2;s[f+P+0]=A+_,s[f+P+1]=_+(Math.abs(A)+_)*s5e,A<t[x]&&(t[x]=A),E>t[x+3]&&(t[x+3]=E)}}return s}function p5e(e,t){function i(x){d&&d(x/f)}function r(x,w,b,C=null,A=0){if(!m&&A>=l&&(m=!0,u&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),b<=c||A>=l)return i(w+b),x.offset=w,x.count=b,x;let E=h5e(x.boundingData,C,a,w,b,h);if(E.axis===-1)return i(w+b),x.offset=w,x.count=b,x;let _=u5e(o,a,w,b,E);if(_===w||_===w+b)i(w+b),x.offset=w,x.count=b;else{x.splitAxis=E.axis;let P=new eS,I=w,D=_-w;x.left=P,P.boundingData=new Float32Array(6),hI(a,I,D,P.boundingData,s),r(P,I,D,s,A+1);let k=new eS,B=_,z=b-D;x.right=k,k.boundingData=new Float32Array(6),hI(a,B,z,k.boundingData,s),r(k,B,z,s,A+1)}return x}a5e(e,t);let n=new Float32Array(6),s=new Float32Array(6),a=f5e(e,n),o=e.index.array,l=t.maxDepth,u=t.verbose,c=t.maxLeafTris,h=t.strategy,d=t.onProgress,f=e.index.count/3,m=!1,g=[],y=o5e(e);if(y.length===1){let x=y[0],w=new eS;w.boundingData=n,l5e(a,x.offset,x.count,s),r(w,x.offset,x.count,s),g.push(w)}else for(let x of y){let w=new eS;w.boundingData=new Float32Array(6),hI(a,x.offset,x.count,w.boundingData,s),r(w,x.offset,x.count,s),g.push(w)}return g}function m5e(e,t){let i=p5e(e,t),r,n,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let c=0;c<i.length;c++){let h=i[c],d=l(h),f=new o(32*d);r=new Float32Array(f),n=new Uint32Array(f),s=new Uint16Array(f),u(0,h),a.push(f)}return a;function l(c){return c.count?1:1+l(c.left)+l(c.right)}function u(c,h){let d=c/4,f=c/2,m=!!h.count,g=h.boundingData;for(let y=0;y<6;y++)r[d+y]=g[y];if(m){let y=h.offset,x=h.count;return n[d+6]=y,s[f+14]=x,s[f+15]=65535,c+32}else{let y=h.left,x=h.right,w=h.splitAxis,b;if(b=u(c+32,y),b/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[d+6]=b/4,b=u(b,x),n[d+7]=w,b}}}var df=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,r=-1/0;for(let n=0,s=e.length;n<s;n++){let a=e[n][t];i=a<i?a:i,r=a>r?a:r}this.min=i,this.max=r}setFromPoints(e,t){let i=1/0,r=-1/0;for(let n=0,s=t.length;n<s;n++){let a=t[n],o=e.dot(a);i=o<i?o:i,r=o>r?o:r}this.min=i,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}};df.prototype.setFromBox=function(){let e=new q;return function(t,i){let r=i.min,n=i.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let u=0;u<=1;u++){e.x=r.x*o+n.x*(1-o),e.y=r.y*l+n.y*(1-l),e.z=r.z*u+n.z*(1-u);let c=t.dot(e);s=Math.min(c,s),a=Math.max(c,a)}this.min=s,this.max=a}}();var g5e=function(){let e=new q,t=new q,i=new q;return function(r,n,s){let a=r.start,o=e,l=n.start,u=t;i.subVectors(a,l),e.subVectors(r.end,r.start),t.subVectors(n.end,n.start);let c=i.dot(u),h=u.dot(o),d=u.dot(u),f=i.dot(o),m=o.dot(o)*d-h*h,g,y;m!==0?g=(c*h-f*d)/m:g=0,y=(c+g*h)/d,s.x=g,s.y=y}}(),qB=function(){let e=new Ie,t=new q,i=new q;return function(r,n,s,a){g5e(r,n,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){r.at(o,s),n.at(l,a);return}else if(o>=0&&o<=1){l<0?n.at(0,a):n.at(1,a),r.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?r.at(0,s):r.at(1,s),n.closestPointToPoint(s,!0,a);return}else{let u;o<0?u=r.start:u=r.end;let c;l<0?c=n.start:c=n.end;let h=t,d=i;if(r.closestPointToPoint(c,!0,t),n.closestPointToPoint(u,!0,i),h.distanceToSquared(c)<=d.distanceToSquared(u)){s.copy(h),a.copy(c);return}else{s.copy(u),a.copy(d);return}}}}(),v5e=function(){let e=new q,t=new q,i=new bl,r=new zu;return function(n,s){let{radius:a,center:o}=n,{a:l,b:u,c}=s;if(r.start=l,r.end=u,r.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(r.start=l,r.end=c,r.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(r.start=u,r.end=c,r.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(i);if(Math.abs(h.distanceToPoint(o))<=a){let d=h.projectPoint(o,t);if(s.containsPoint(d))return!0}return!1}}(),y5e=1e-15;function Xv(e){return Math.abs(e)<y5e}var ff=class extends Fa{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new q),this.satBounds=new Array(4).fill().map(()=>new df),this.points=[this.a,this.b,this.c],this.sphere=new Rl,this.plane=new bl,this.needsUpdate=!0}intersectsSphere(e){return v5e(e,this)}update(){let e=this.a,t=this.b,i=this.c,r=this.points,n=this.satAxes,s=this.satBounds,a=n[0],o=s[0];this.getNormal(a),o.setFromPoints(a,r);let l=n[1],u=s[1];l.subVectors(e,t),u.setFromPoints(l,r);let c=n[2],h=s[2];c.subVectors(t,i),h.setFromPoints(c,r);let d=n[3],f=s[3];d.subVectors(i,e),f.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};ff.prototype.closestPointToSegment=function(){let e=new q,t=new q,i=new zu;return function(r,n=null,s=null){let{start:a,end:o}=r,l=this.points,u,c=1/0;for(let h=0;h<3;h++){let d=(h+1)%3;i.start.copy(l[h]),i.end.copy(l[d]),qB(i,r,e,t),u=e.distanceToSquared(t),u<c&&(c=u,n&&n.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),u=a.distanceToSquared(e),u<c&&(c=u,n&&n.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),u=o.distanceToSquared(e),u<c&&(c=u,n&&n.copy(e),s&&s.copy(o)),Math.sqrt(c)}}();ff.prototype.intersectsTriangle=function(){let e=new ff,t=new Array(3),i=new Array(3),r=new df,n=new df,s=new q,a=new q,o=new q,l=new q,u=new zu,c=new zu,h=new zu;return function(d,f=null,m=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let g=this.plane,y=d.plane;if(Math.abs(g.normal.dot(y.normal))>1-1e-10){let x=this.satBounds,w=this.satAxes;i[0]=d.a,i[1]=d.b,i[2]=d.c;for(let A=0;A<4;A++){let E=x[A],_=w[A];if(r.setFromPoints(_,i),E.isSeparated(r))return!1}let b=d.satBounds,C=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let A=0;A<4;A++){let E=b[A],_=C[A];if(r.setFromPoints(_,t),E.isSeparated(r))return!1}for(let A=0;A<4;A++){let E=w[A];for(let _=0;_<4;_++){let P=C[_];if(s.crossVectors(E,P),r.setFromPoints(s,t),n.setFromPoints(s,i),r.isSeparated(n))return!1}}return f&&(m||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let x=this.points,w=!1,b=0;for(let z=0;z<3;z++){let W=x[z],$=x[(z+1)%3];u.start.copy(W),u.end.copy($),u.delta(a);let Z=w?c.start:c.end,G=Xv(y.distanceToPoint(W));if(Xv(y.normal.dot(a))&&G){c.copy(u),b=2;break}if((y.intersectLine(u,Z)||G)&&!Xv(Z.distanceTo($))){if(b++,w)break;w=!0}}if(b===1&&d.containsPoint(c.end))return f&&(f.start.copy(c.end),f.end.copy(c.end)),!0;if(b!==2)return!1;let C=d.points,A=!1,E=0;for(let z=0;z<3;z++){let W=C[z],$=C[(z+1)%3];u.start.copy(W),u.end.copy($),u.delta(o);let Z=A?h.start:h.end,G=Xv(g.distanceToPoint(W));if(Xv(g.normal.dot(o))&&G){h.copy(u),E=2;break}if((g.intersectLine(u,Z)||G)&&!Xv(Z.distanceTo($))){if(E++,A)break;A=!0}}if(E===1&&this.containsPoint(h.end))return f&&(f.start.copy(h.end),f.end.copy(h.end)),!0;if(E!==2)return!1;if(c.delta(a),h.delta(o),a.dot(o)<0){let z=h.start;h.start=h.end,h.end=z}let _=c.start.dot(a),P=c.end.dot(a),I=h.start.dot(a),D=h.end.dot(a),k=P<I,B=_<D;return _!==D&&I!==P&&k===B?!1:(f&&(l.subVectors(c.start,h.start),l.dot(a)>0?f.start.copy(c.start):f.start.copy(h.start),l.subVectors(c.end,h.end),l.dot(a)<0?f.end.copy(c.end):f.end.copy(h.end)),!0)}}}();ff.prototype.distanceToPoint=function(){let e=new q;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ff.prototype.distanceToTriangle=function(){let e=new q,t=new q,i=["a","b","c"],r=new zu,n=new zu;return function(s,a=null,o=null){let l=a||o?r:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let u=1/0;for(let c=0;c<3;c++){let h,d=i[c],f=s[d];this.closestPointToPoint(f,e),h=f.distanceToSquared(e),h<u&&(u=h,a&&a.copy(e),o&&o.copy(f));let m=this[d];s.closestPointToPoint(m,e),h=m.distanceToSquared(e),h<u&&(u=h,a&&a.copy(m),o&&o.copy(e))}for(let c=0;c<3;c++){let h=i[c],d=i[(c+1)%3];r.set(this[h],this[d]);for(let f=0;f<3;f++){let m=i[f],g=i[(f+1)%3];n.set(s[m],s[g]),qB(r,n,e,t);let y=e.distanceToSquared(t);y<u&&(u=y,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(u)}}();var Bh=class{constructor(e,t,i){this.isOrientedBox=!0,this.min=new q,this.max=new q,this.matrix=new Pt,this.invMatrix=new Pt,this.points=new Array(8).fill().map(()=>new q),this.satAxes=new Array(3).fill().map(()=>new q),this.satBounds=new Array(3).fill().map(()=>new df),this.alignedSatBounds=new Array(3).fill().map(()=>new df),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};Bh.prototype.update=function(){return function(){let e=this.matrix,t=this.min,i=this.max,r=this.points;for(let l=0;l<=1;l++)for(let u=0;u<=1;u++)for(let c=0;c<=1;c++){let h=1*l|2*u|4*c,d=r[h];d.x=l?i.x:t.x,d.y=u?i.y:t.y,d.z=c?i.z:t.z,d.applyMatrix4(e)}let n=this.satBounds,s=this.satAxes,a=r[0];for(let l=0;l<3;l++){let u=s[l],c=n[l],h=1<<l,d=r[h];u.subVectors(a,d),c.setFromPoints(u,r)}let o=this.alignedSatBounds;o[0].setFromPointsField(r,"x"),o[1].setFromPointsField(r,"y"),o[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Bh.prototype.intersectsBox=function(){let e=new df;return function(t){this.needsUpdate&&this.update();let i=t.min,r=t.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=i.x,e.max=r.x,a[0].isSeparated(e)||(e.min=i.y,e.max=r.y,a[1].isSeparated(e))||(e.min=i.z,e.max=r.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],u=n[o];if(e.setFromBox(l,t),u.isSeparated(e))return!1}return!0}}();Bh.prototype.intersectsTriangle=function(){let e=new ff,t=new Array(3),i=new df,r=new df,n=new q;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let h=0;h<3;h++){let d=a[h],f=o[h];if(i.setFromPoints(f,t),d.isSeparated(i))return!1}let l=s.satBounds,u=s.satAxes,c=this.points;for(let h=0;h<3;h++){let d=l[h],f=u[h];if(i.setFromPoints(f,c),d.isSeparated(i))return!1}for(let h=0;h<3;h++){let d=o[h];for(let f=0;f<4;f++){let m=u[f];if(n.crossVectors(d,m),i.setFromPoints(n,t),r.setFromPoints(n,c),i.isSeparated(r))return!1}}return!0}}();Bh.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();Bh.prototype.distanceToPoint=function(){let e=new q;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();Bh.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new zu),i=new Array(12).fill().map(()=>new zu),r=new q,n=new q;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(n),this.closestPointToPoint(n,r),s.closestPointToPoint(r,n),o&&o.copy(r),l&&l.copy(n)),0;let u=a*a,c=s.min,h=s.max,d=this.points,f=1/0;for(let g=0;g<8;g++){let y=d[g];n.copy(y).clamp(c,h);let x=y.distanceToSquared(n);if(x<f&&(f=x,o&&o.copy(y),l&&l.copy(n),x<u))return Math.sqrt(x)}let m=0;for(let g=0;g<3;g++)for(let y=0;y<=1;y++)for(let x=0;x<=1;x++){let w=(g+1)%3,b=(g+2)%3,C=y<<w|x<<b,A=1<<g|y<<w|x<<b,E=d[C],_=d[A];t[m].set(E,_);let P=e[g],I=e[w],D=e[b],k=i[m],B=k.start,z=k.end;B[P]=c[P],B[I]=y?c[I]:h[I],B[D]=x?c[D]:h[I],z[P]=h[P],z[I]=y?c[I]:h[I],z[D]=x?c[D]:h[I],m++}for(let g=0;g<=1;g++)for(let y=0;y<=1;y++)for(let x=0;x<=1;x++){n.x=g?h.x:c.x,n.y=y?h.y:c.y,n.z=x?h.z:c.z,this.closestPointToPoint(n,r);let w=n.distanceToSquared(r);if(w<f&&(f=w,o&&o.copy(r),l&&l.copy(n),w<u))return Math.sqrt(w)}for(let g=0;g<12;g++){let y=t[g];for(let x=0;x<12;x++){let w=i[x];qB(y,w,r,n);let b=r.distanceToSquared(n);if(b<f&&(f=b,o&&o.copy(r),l&&l.copy(n),b<u))return Math.sqrt(b)}}return Math.sqrt(f)}}();var Kv=new q,$v=new q,Zv=new q,rS=new Ie,nS=new Ie,sS=new Ie,LH=new q,NH=new q,kH=new q,aS=new q;function x5e(e,t,i,r,n,s){let a;return s===wa?a=e.intersectTriangle(r,i,t,!0,n):a=e.intersectTriangle(t,i,r,s!==po,n),a===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function b5e(e,t,i,r,n,s,a,o,l){Kv.fromBufferAttribute(t,s),$v.fromBufferAttribute(t,a),Zv.fromBufferAttribute(t,o);let u=x5e(e,Kv,$v,Zv,aS,l);if(u){r&&(rS.fromBufferAttribute(r,s),nS.fromBufferAttribute(r,a),sS.fromBufferAttribute(r,o),u.uv=Fa.getInterpolation(aS,Kv,$v,Zv,rS,nS,sS,new Ie)),n&&(rS.fromBufferAttribute(n,s),nS.fromBufferAttribute(n,a),sS.fromBufferAttribute(n,o),u.uv1=Fa.getInterpolation(aS,Kv,$v,Zv,rS,nS,sS,new Ie)),i&&(LH.fromBufferAttribute(i,s),NH.fromBufferAttribute(i,a),kH.fromBufferAttribute(i,o),u.normal=Fa.getInterpolation(aS,Kv,$v,Zv,LH,NH,kH,new q),u.normal.dot(e.direction)>0&&u.normal.multiplyScalar(-1));let c={a:s,b:a,c:o,normal:new q,materialIndex:0};Fa.getNormal(Kv,$v,Zv,c.normal),u.face=c,u.faceIndex=s}return u}function Cte(e,t,i,r,n){let s=r*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:u,normal:c,uv:h,uv1:d}=e.attributes,f=b5e(i,u,c,h,d,a,o,l,t);return f?(f.faceIndex=r,n&&n.push(f),f):null}function _5e(e,t,i,r,n,s){for(let a=r,o=r+n;a<o;a++)Cte(e,t,i,a,s)}function w5e(e,t,i,r,n){let s=1/0,a=null;for(let o=r,l=r+n;o<l;o++){let u=Cte(e,t,i,o);u&&u.distance<s&&(a=u,s=u.distance)}return a}function hh(e,t,i,r){let n=e.a,s=e.b,a=e.c,o=t,l=t+1,u=t+2;i&&(o=i.getX(t),l=i.getX(t+1),u=i.getX(t+2)),n.x=r.getX(o),n.y=r.getY(o),n.z=r.getZ(o),s.x=r.getX(l),s.y=r.getY(l),s.z=r.getZ(l),a.x=r.getX(u),a.y=r.getY(u),a.z=r.getZ(u)}function BH(e,t,i,r,n,s,a){let o=i.index,l=i.attributes.position;for(let u=e,c=t+e;u<c;u++)if(hh(a,u*3,o,l),a.needsUpdate=!0,r(a,u,n,s))return!0;return!1}var Ate=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function pp(e,t){return t[e+15]===65535}function ly(e,t){return t[e+6]}function w_(e,t){return t[e+14]}function E_(e){return e+8}function S_(e,t){return t[e+6]}function E5e(e,t){return t[e+7]}var Y0=new xs,gA=new q,S5e=["x","y","z"];function zL(e,t,i,r,n){let s=e*2,a=g1,o=jp,l=Vp;if(pp(s,o)){let u=ly(e,l),c=w_(s,o);_5e(t,i,r,u,c,n)}else{let u=E_(e);vA(u,a,r,gA)&&zL(u,t,i,r,n);let c=S_(e,l);vA(c,a,r,gA)&&zL(c,t,i,r,n)}}function FL(e,t,i,r){let n=e*2,s=g1,a=jp,o=Vp;if(pp(n,a)){let l=ly(e,o),u=w_(n,a);return w5e(t,i,r,l,u)}else{let l=E5e(e,o),u=S5e[l],c=r.direction[u]>=0,h,d;c?(h=E_(e),d=S_(e,o)):(h=S_(e,o),d=E_(e));let f=vA(h,s,r,gA)?FL(h,t,i,r):null;if(f){let g=f.point[u];if(c?g<=s[d+l]:g>=s[d+l+3])return f}let m=vA(d,s,r,gA)?FL(d,t,i,r):null;return f&&m?f.distance<=m.distance?f:m:f||m||null}}var T5e=function(){let e,t,i=[],r=new Ate(()=>new xs);return function(...s){e=r.getPrimitive(),t=r.getPrimitive(),i.push(e,t);let a=n(...s);r.releasePrimitive(e),r.releasePrimitive(t),i.pop(),i.pop();let o=i.length;return o>0&&(t=i[o-1],e=i[o-2]),a};function n(s,a,o,l,u=null,c=0,h=0){function d(w){let b=w*2,C=jp,A=Vp;for(;!pp(b,C);)w=E_(w),b=w*2;return ly(w,A)}function f(w){let b=w*2,C=jp,A=Vp;for(;!pp(b,C);)w=S_(w,A),b=w*2;return ly(w,A)+w_(b,C)}let m=s*2,g=g1,y=jp,x=Vp;if(pp(m,y)){let w=ly(s,x),b=w_(m,y);return yh(s,g,e),l(w,b,!1,h,c+s,e)}else{let w=E_(s),b=S_(s,x),C=w,A=b,E,_,P,I;if(u&&(P=e,I=t,yh(C,g,P),yh(A,g,I),E=u(P),_=u(I),_<E)){C=b,A=w;let Z=E;E=_,_=Z,P=I}P||(P=e,yh(C,g,P));let D=pp(C*2,y),k=o(P,D,E,h+1,c+C),B;if(k===2){let Z=d(C),G=f(C)-Z;B=l(Z,G,!0,h+1,c+C,P)}else B=k&&n(C,a,o,l,u,c,h+1);if(B)return!0;I=t,yh(A,g,I);let z=pp(A*2,y),W=o(I,z,_,h+1,c+A),$;if(W===2){let Z=d(A),G=f(A)-Z;$=l(Z,G,!0,h+1,c+A,I)}else $=W&&n(A,a,o,l,u,c,h+1);return!!$}}}(),C5e=function(){let e=new ff,t=new ff,i=new Pt,r=new Bh,n=new Bh;return function s(a,o,l,u,c=null){let h=a*2,d=g1,f=jp,m=Vp;if(c===null&&(l.boundingBox||l.computeBoundingBox(),r.set(l.boundingBox.min,l.boundingBox.max,u),c=r),pp(h,f)){let g=o,y=g.index,x=g.attributes.position,w=l.index,b=l.attributes.position,C=ly(a,m),A=w_(h,f);if(i.copy(u).invert(),l.boundsTree)return yh(a,d,n),n.matrix.copy(i),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:E=>n.intersectsBox(E),intersectsTriangle:E=>{E.a.applyMatrix4(u),E.b.applyMatrix4(u),E.c.applyMatrix4(u),E.needsUpdate=!0;for(let _=C*3,P=(A+C)*3;_<P;_+=3)if(hh(t,_,y,x),t.needsUpdate=!0,E.intersectsTriangle(t))return!0;return!1}});for(let E=C*3,_=A+C*3;E<_;E+=3){hh(e,E,y,x),e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let P=0,I=w.count;P<I;P+=3)if(hh(t,P,w,b),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let g=a+8,y=m[a+6];return yh(g,d,Y0),!!(c.intersectsBox(Y0)&&s(g,o,l,u,c)||(yh(y,d,Y0),c.intersectsBox(Y0)&&s(y,o,l,u,c)))}}}();function vA(e,t,i,r){return yh(e,t,Y0),i.intersectBox(Y0,r)}var UL=[],AT,g1,jp,Vp;function Gx(e){AT&&UL.push(AT),AT=e,g1=new Float32Array(e),jp=new Uint16Array(e),Vp=new Uint32Array(e)}function oS(){AT=null,g1=null,jp=null,Vp=null,UL.length&&Gx(UL.pop())}var dI=Symbol("skip tree generation"),fI=new xs,pI=new xs,Qv=new Pt,Hm=new Bh,lx=new Bh,ux=new q,lS=new q,A5e=new q,M5e=new q,P5e=new q,zH=new xs,Yc=new Ate(()=>new ff),wb=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),wb.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let i=e.geometry,r=e._roots,n=i.getIndex(),s;return t.cloneBuffers?s={roots:r.map(a=>a.slice()),index:n.array.slice()}:s={roots:r,index:n.array},s}static deserialize(e,t,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),wb.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:r,roots:n}=e,s=new wb(t,{...i,[dI]:!0});if(s._roots=n,i.setIndex){let a=t.getIndex();if(a===null){let o=new gi(e.index,1,!1);t.setIndex(o)}else a.array!==r&&(a.array.set(r),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[dI]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[dI]||(this._roots=m5e(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new xs))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,i=t.index.array,r=t.attributes.position,n,s,a,o,l=0,u=this._roots;for(let h=0,d=u.length;h<d;h++)n=u[h],s=new Uint32Array(n),a=new Uint16Array(n),o=new Float32Array(n),c(0,l),l+=n.byteLength;function c(h,d,f=!1){let m=h*2;if(a[m+15]===65535){let g=s[h+6],y=a[m+14],x=1/0,w=1/0,b=1/0,C=-1/0,A=-1/0,E=-1/0;for(let _=3*g,P=3*(g+y);_<P;_++){let I=i[_],D=r.getX(I),k=r.getY(I),B=r.getZ(I);D<x&&(x=D),D>C&&(C=D),k<w&&(w=k),k>A&&(A=k),B<b&&(b=B),B>E&&(E=B)}return o[h+0]!==x||o[h+1]!==w||o[h+2]!==b||o[h+3]!==C||o[h+4]!==A||o[h+5]!==E?(o[h+0]=x,o[h+1]=w,o[h+2]=b,o[h+3]=C,o[h+4]=A,o[h+5]=E,!0):!1}else{let g=h+8,y=s[h+6],x=g+d,w=y+d,b=f,C=!1,A=!1;e?b||(C=e.has(x),A=e.has(w),b=!C&&!A):(C=!0,A=!0);let E=b||C,_=b||A,P=!1;E&&(P=c(g,d,b));let I=!1;_&&(I=c(y,d,b));let D=P||I;if(D)for(let k=0;k<3;k++){let B=g+k,z=y+k,W=o[B],$=o[B+3],Z=o[z],G=o[z+3];o[h+k]=W<Z?W:Z,o[h+k+3]=$>G?$:G}return D}}}traverse(e,t=0){let i=this._roots[t],r=new Uint32Array(i),n=new Uint16Array(i);s(0);function s(a,o=0){let l=a*2,u=n[l+15]===65535;if(u){let c=r[a+6],h=n[l+14];e(o,u,new Float32Array(i,a*4,6),c,h)}else{let c=a+8,h=r[a+6],d=r[a+7];e(o,u,new Float32Array(i,a*4,6),d)||(s(c,o+1),s(h,o+1))}}}raycast(e,t=Mc){let i=this._roots,r=this.geometry,n=[],s=t.isMaterial,a=Array.isArray(t),o=r.groups,l=s?t.side:t;for(let u=0,c=i.length;u<c;u++){let h=a?t[o[u].materialIndex].side:l,d=n.length;if(Gx(i[u]),zL(0,r,h,e,n),oS(),a){let f=o[u].materialIndex;for(let m=d,g=n.length;m<g;m++)n[m].face.materialIndex=f}}return n}raycastFirst(e,t=Mc){let i=this._roots,r=this.geometry,n=t.isMaterial,s=Array.isArray(t),a=null,o=r.groups,l=n?t.side:t;for(let u=0,c=i.length;u<c;u++){let h=s?t[o[u].materialIndex].side:l;Gx(i[u]);let d=FL(0,r,h,e);oS(),d!=null&&(a==null||d.distance<a.distance)&&(a=d,s&&(d.face.materialIndex=o[u].materialIndex))}return a}intersectsGeometry(e,t){let i=this.geometry,r=!1;for(let n of this._roots)if(Gx(n),r=C5e(0,i,e,t),oS(),r)break;return r}shapecast(e,t,i){let r=this.geometry;if(e instanceof Function){if(t){let h=t;t=(d,f,m,g)=>{let y=f*3;return h(d,y,y+1,y+2,m,g)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=Yc.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let h=o;o=(d,f,m,g,y)=>h(d,f,m,g,y)?!0:BH(d,f,r,l,m,g,n)}else o||(l?o=(h,d,f,m)=>BH(h,d,r,l,f,m,n):o=(h,d,f)=>f);let u=!1,c=0;for(let h of this._roots){if(Gx(h),u=T5e(0,r,a,o,s,c),oS(),u)break;c+=h.byteLength}return Yc.releasePrimitive(n),u}bvhcast(e,t,i){let{intersectsRanges:r,intersectsTriangles:n}=i,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;Qv.copy(t).invert();let u=Yc.getPrimitive(),c=Yc.getPrimitive();if(n){let d=function(f,m,g,y,x,w,b,C){for(let A=g,E=g+y;A<E;A++){hh(c,A*3,o,l),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let _=f,P=f+m;_<P;_++)if(hh(u,_*3,s,a),u.needsUpdate=!0,n(u,c,_,A,x,w,b,C))return!0}return!1};if(r){let f=r;r=function(m,g,y,x,w,b,C,A){return f(m,g,y,x,w,b,C,A)?!0:d(m,g,y,x,w,b,C,A)}}else r=d}e.getBoundingBox(pI),pI.applyMatrix4(t);let h=this.shapecast({intersectsBounds:d=>pI.intersectsBox(d),intersectsRange:(d,f,m,g,y,x)=>(fI.copy(x),fI.applyMatrix4(Qv),e.shapecast({intersectsBounds:w=>fI.intersectsBox(w),intersectsRange:(w,b,C,A,E)=>r(d,f,w,b,g,y,A,E)}))});return Yc.releasePrimitive(u),Yc.releasePrimitive(c),h}intersectsBox(e,t){return Hm.set(e.min,e.max,t),Hm.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Hm.intersectsBox(i),intersectsTriangle:i=>Hm.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},r={},n=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Hm.set(e.boundingBox.min,e.boundingBox.max,t),Hm.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,u=e.attributes.position,c=e.index,h=Yc.getPrimitive(),d=Yc.getPrimitive(),f=lS,m=A5e,g=null,y=null;r&&(g=M5e,y=P5e);let x=1/0,w=null,b=null;return Qv.copy(t).invert(),lx.matrix.copy(Qv),this.shapecast({boundsTraverseOrder:C=>Hm.distanceToBox(C),intersectsBounds:(C,A,E)=>E<x&&E<s?(A&&(lx.min.copy(C.min),lx.max.copy(C.max),lx.needsUpdate=!0),!0):!1,intersectsRange:(C,A)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:E=>lx.distanceToBox(E),intersectsBounds:(E,_,P)=>P<x&&P<s,intersectsRange:(E,_)=>{for(let P=E*3,I=(E+_)*3;P<I;P+=3){hh(d,P,c,u),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let D=C*3,k=(C+A)*3;D<k;D+=3){hh(h,D,l,o),h.needsUpdate=!0;let B=h.distanceToTriangle(d,f,g);if(B<x&&(m.copy(f),y&&y.copy(g),x=B,w=D/3,b=P/3),B<n)return!0}}}});{let E=c?c.count:u.count;for(let _=0,P=E;_<P;_+=3){hh(d,_,c,u),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let I=C*3,D=(C+A)*3;I<D;I+=3){hh(h,I,l,o),h.needsUpdate=!0;let k=h.distanceToTriangle(d,f,g);if(k<x&&(m.copy(f),y&&y.copy(g),x=k,w=I/3,b=_/3),k<n)return!0}}}}}),Yc.releasePrimitive(h),Yc.releasePrimitive(d),x===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=x,i.faceIndex=w,r&&(r.point?r.point.copy(y):r.point=y.clone(),r.point.applyMatrix4(Qv),m.applyMatrix4(Qv),r.distance=m.sub(r.point).length(),r.faceIndex=b),i)}closestPointToPoint(e,t={},i=0,r=1/0){let n=i*i,s=r*r,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:u=>(ux.copy(e).clamp(u.min,u.max),ux.distanceToSquared(e)),intersectsBounds:(u,c,h)=>h<a&&h<s,intersectsTriangle:(u,c)=>{u.closestPointToPoint(e,ux);let h=e.distanceToSquared(ux);return h<a&&(lS.copy(ux),a=h,o=c),h<n}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(lS):t.point=lS.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{yh(0,new Float32Array(t),zH),e.union(zH)}),e}},jL=nm(DTe()),D5e=.5*(Math.sqrt(3)-1),cx=(3-Math.sqrt(3))/6,I5e=1/3,Xc=1/6,Eb=e=>Math.floor(e)|0,FH=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),mI=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function O5e(e=Math.random){let t=Mte(e),i=new Float64Array(t).map(n=>FH[n%12*2]),r=new Float64Array(t).map(n=>FH[n%12*2+1]);return function(n,s){let a=0,o=0,l=0,u=(n+s)*D5e,c=Eb(n+u),h=Eb(s+u),d=(c+h)*cx,f=c-d,m=h-d,g=n-f,y=s-m,x,w;g>y?(x=1,w=0):(x=0,w=1);let b=g-x+cx,C=y-w+cx,A=g-1+2*cx,E=y-1+2*cx,_=c&255,P=h&255,I=.5-g*g-y*y;if(I>=0){let B=_+t[P],z=i[B],W=r[B];I*=I,a=I*I*(z*g+W*y)}let D=.5-b*b-C*C;if(D>=0){let B=_+x+t[P+w],z=i[B],W=r[B];D*=D,o=D*D*(z*b+W*C)}let k=.5-A*A-E*E;if(k>=0){let B=_+1+t[P+1],z=i[B],W=r[B];k*=k,l=k*k*(z*A+W*E)}return 70*(a+o+l)}}function R5e(e=Math.random){let t=Mte(e),i=new Float64Array(t).map(s=>mI[s%12*3]),r=new Float64Array(t).map(s=>mI[s%12*3+1]),n=new Float64Array(t).map(s=>mI[s%12*3+2]);return function(s,a,o){let l,u,c,h,d=(s+a+o)*I5e,f=Eb(s+d),m=Eb(a+d),g=Eb(o+d),y=(f+m+g)*Xc,x=f-y,w=m-y,b=g-y,C=s-x,A=a-w,E=o-b,_,P,I,D,k,B;C>=A?A>=E?(_=1,P=0,I=0,D=1,k=1,B=0):C>=E?(_=1,P=0,I=0,D=1,k=0,B=1):(_=0,P=0,I=1,D=1,k=0,B=1):A<E?(_=0,P=0,I=1,D=0,k=1,B=1):C<E?(_=0,P=1,I=0,D=0,k=1,B=1):(_=0,P=1,I=0,D=1,k=1,B=0);let z=C-_+Xc,W=A-P+Xc,$=E-I+Xc,Z=C-D+2*Xc,G=A-k+2*Xc,V=E-B+2*Xc,J=C-1+3*Xc,U=A-1+3*Xc,ie=E-1+3*Xc,se=f&255,ee=m&255,ve=g&255,_e=.6-C*C-A*A-E*E;if(_e<0)l=0;else{let Le=se+t[ee+t[ve]];_e*=_e,l=_e*_e*(i[Le]*C+r[Le]*A+n[Le]*E)}let he=.6-z*z-W*W-$*$;if(he<0)u=0;else{let Le=se+_+t[ee+P+t[ve+I]];he*=he,u=he*he*(i[Le]*z+r[Le]*W+n[Le]*$)}let De=.6-Z*Z-G*G-V*V;if(De<0)c=0;else{let Le=se+D+t[ee+k+t[ve+B]];De*=De,c=De*De*(i[Le]*Z+r[Le]*G+n[Le]*V)}let we=.6-J*J-U*U-ie*ie;if(we<0)h=0;else{let Le=se+1+t[ee+1+t[ve+1]];we*=we,h=we*we*(i[Le]*J+r[Le]*U+n[Le]*ie)}return 32*(l+u+c+h)}}function Mte(e){let t=new Uint8Array(512);for(let i=0;i<512/2;i++)t[i]=i;for(let i=0;i<512/2-1;i++){let r=i+~~(e()*(256-i)),n=t[i];t[i]=t[r],t[r]=n}for(let i=256;i<512;i++)t[i]=t[i-256];return t}var ic=new Fa,L5e=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let r=0;r<e.count;r+=3){let n=1;ic.a.fromBufferAttribute(e,r),ic.b.fromBufferAttribute(e,r+1),ic.c.fromBufferAttribute(e,r+2),n*=ic.getArea(),t[r/3]=n}this.distribution=new Float32Array(e.count/3);let i=0;for(let r=0;r<t.length;r++)i+=t[r],this.distribution[r]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let i=this.distribution[this.distribution.length-1],r=this.binarySearch(this.randomFunction()*i);return this.sampleFace(r,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,i=0,r=t.length-1,n=-1;for(;i<=r;){let s=Math.ceil((i+r)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?r=s-1:i=s+1}return n}sampleFace(e,t,i){let r=this.randomFunction(),n=this.randomFunction();return r+n>1&&(r=1-r,n=1-n),ic.a.fromBufferAttribute(this.positionAttribute,e*3),ic.b.fromBufferAttribute(this.positionAttribute,e*3+1),ic.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(ic.a,r).addScaledVector(ic.b,n).addScaledVector(ic.c,1-(r+n)),ic.getNormal(i),this}},N5e=nm(lJ()),k5e=new Pt,B5e=new Pt,z5e=new Pt,$g;(e=>{function t(i){return i&&i.__isSPEObject}e.is=t})($g||($g={}));var YB=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new Pt,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Pt,this.matrixWorldRigid=new Pt,this.shearScale=new Pt,this.shearScaleInv=new Pt}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof qr&&(t=t.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===t)return!0;i=i.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let i of this.children)i.updateMatrixWorld(t)}updateWorldMatrix(t,i){let r=this.parent;if(t&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,i=0){for(let r of this.children)$g.is(r)&&r.traverseObject(t,i+1)}traverseObject(t,i=0){if(t(this,i)!==!0)for(let r of this.children)$g.is(r)&&r.traverseObject(t,i+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,i=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:r,v:n,q:s}=(0,N5e.SVD)(i),a=k5e.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),o=B5e.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=z5e.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(u=>Math.abs(s[0]-u)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,i){this.updateWorldMatrix(!0,!1);let r=new Pt().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),r.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof Pt?t.hiddenMatrix.premultiply(r):t.applyMatrix4(r),t.updateWorldMatrix(!1,!1),this.add(t),i!==void 0&&(this.children.pop(),this.children.splice(i,0,t)),this}copy(t,i=!1){return super.copy(t,i),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,i,r,n,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},F5e=class extends YB(qr){},U5e=e=>e.type==="Mesh",Va=class extends F5e{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1,this.hasNonUniformScale=t.hasNonUniformScale}raycast(t,i){}expand(){let t=0,i=this.object.entityChildren(t);for(;i;){let r=this.children[t];(r==null?void 0:r.object)!==i&&(r&&this.remove(r),r=new Va(i),this.add(r),this.children.splice(t,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=i.matrix,r.hiddenMatrix=i.hiddenMatrix),r.expand(),t+=1,i=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return U5e(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},lg=new q,ug=new q,uy=new Pt,Pte=[new q(-1,1,1),new q(-1,-1,1),new q(1,-1,1),new q(1,1,1),new q(-1,1,-1),new q(-1,-1,-1),new q(1,-1,-1),new q(1,1,-1)],j5e=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],V5e=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],UH=(e,t,i)=>{e.updateEntityBoxSize(lg,ug),uy.copy(t).multiply(e.matrixWorld),ug.x===0&&ug.y===0&&ug.z===0?i.push(new q(lg.x,lg.y,lg.z).applyMatrix4(uy)):Pte.forEach(r=>{i.push(r.clone().multiply(ug).add(lg).applyMatrix4(uy))})},jH=class extends xs{constructor(){super(...arguments),this.matrix=new Pt,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let i=new Pt().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t,i=!1){let r=[];return i===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){r.push(new q);return}UH(n,t,r)}}):UH(e,t,r),this.setFromPoints(r)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(uy.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(ug).multiplyScalar(.5),this.getCenter(lg),uy.copy(this.matrix).setPosition(lg),this.vertices=Pte.map(e=>e.clone().multiply(ug).applyMatrix4(uy))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=j5e.map(([e,t])=>new zu(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new q))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=V5e.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},Sp={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},H5e=class extends zJ{constructor(){super()}getPoints(e=12){let t=[],i,r=this.getCurveLengths(),n=r[r.length-1]/r.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?r[s]:r[s]-r[s-1],u=Math.ceil(e*l/n),c=o.getPoints(u);for(let h=0;h<c.length;h++){let d=c[h];i&&i.equals(d)||(t.push(d),i=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},VL=.001;function HL(e,t,i){return t.clone().sub(e).cross(t.clone().sub(i)).length()<=VL}function gI(e,t){let i=new q(...e.position),r=new q(...e.controlNext.position),n=new q(...t.controlPrevious.position),s=new q(...t.position);return HL(i,r,s)&&HL(i,n,s)}function Dte(e){let t=e.points.map(c=>new q(...c.data.position)),i=[e.points[0]],r=new q(...i[0].data.position);for(let c=0;c<e.points.length-1;c++)HL(r,t[c],t[c+1])||(i.push(e.points[c]),r=t[c]);i.push(e.points[e.points.length-1]);let n=e.isClosed,s=i.length-(n?0:1),a=i.length,o=[];for(let c=0;c<a;c++){let h=i[c].data,d=new q(...h.position),f=new q(...h.controlPrevious.position),m=new q(...h.controlNext.position),g={position:d,baseRoundness:h.roundness,controlPrevious:f,controlNext:m};if(h.roundness===0||!e.isClosed&&(c===0||c===a-1)){o[c]={...g,removedLength:0};continue}let y=n&&c==0?a-1:c-1,x=n&&c==a-1?0:c+1,w=i[y].data,b=i[x].data,C=new q(...w.position),A=new q(...b.position),E=C.clone().sub(d).normalize(),_=A.clone().sub(d).normalize();Object.assign(g,{prevDir:E,nextDir:_});let P=gI(w,h),I=gI(h,b);if(!P||!I)o[c]={...g,removedLength:0};else{let D=E.clone().add(_).normalize(),k=D.clone().cross(E).length()/E.dot(D);o[c]={...g,tan:k,removedLength:h.roundness/k}}}for(let c=0;c<s;c++){let h=c,d=n&&c===a-1?0:c+1,f=o[h],m=o[d];if(f.removedLength!==0||m.removedLength!==0){let g=f.position.distanceTo(m.position);f.removedLength=Math.min(f.removedLength,g/2),m.removedLength=Math.min(m.removedLength,g/2)}}let l=[];for(let c=0;c<s;c++){let h=c,d=n&&c===a-1?0:c+1,f=o[h],m=o[d],g=null;if(!gI(i[h].data,i[d].data))f.position.distanceTo(m.position)>VL&&(g=new wT(f.position,f.controlNext,m.controlPrevious,m.position));else{let y=f.position.clone(),x=m.position.clone();(f.removedLength!==0||m.removedLength!==0)&&(f.nextDir&&y.add(f.nextDir.clone().setLength(f.removedLength)),m.prevDir&&x.add(m.prevDir.clone().setLength(m.removedLength))),y.distanceTo(x)>VL&&(g=new wT(y,y.clone().lerp(x,.3),x.clone().lerp(y,.3),x))}l[2*c+1]=g}for(let c=0;c<a;c++){let h=o[c];if(h.removedLength===0){l[2*c]=null;continue}let d=h.position,f=h.prevDir.clone().multiplyScalar(h.removedLength).add(d),m=h.nextDir.clone().multiplyScalar(h.removedLength).add(d),g=h.tan*h.removedLength,y=h.prevDir.clone().add(h.nextDir).normalize(),x=f.clone().lerp(m,.5),w=f.distanceTo(m)/2,b=y.clone().multiplyScalar(Math.sqrt(Math.pow(g,2)-Math.pow(w,2))).add(x),C=y.clone().multiplyScalar(-g).add(b),A=d.distanceTo(C)/d.distanceTo(x),E=h.prevDir.clone().multiplyScalar(A*d.distanceTo(f)).add(d),_=E.clone().lerp(C,2),P=f.clone().lerp(E,4/3),I=m.clone().lerp(_,4/3);l[2*c]=new wT(f,P,I,m)}let u=new H5e;return l.forEach(c=>{c&&u.add(c)}),u}var wr;(e=>{function t(i){return i&&i.__isEntity}e.is=t})(wr||(wr={}));var zd=e=>wr.is(e),W5e={type:"completeState",isfromEntity:!0},G5e=["x","y","z"],vI=new q,q5e=new q().set(0,1,0),XB=e=>class extends YB(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new jH,this._recursiveBBox=new jH,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let i=this.children[t];if(wr.is(i))return i}entityChildrenCount(){let t=this.children.length;for(;t--;)if(wr.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let i=t.parent;if(wr.is(i))t=i;else return}return t}forInstancesRec(t){this.instances.forEach(i=>{i.disposed||t(i),i.forInstancesRec(t)})}super_Entity(t,i){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,i,r=!1){if(!(this.data.states.length===0&&!r)){for(let n of this.data.states)bg.toOps(this.data,n.data).forEach(s=>{let a=$C.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,i)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=bg.patch(this.data,n),bg.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,i)}))}r&&this.updateTransformState(this.dataPatched,i),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,i){t.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{zd(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let i;return this.traverseEntity(r=>{r.uuid===t&&(i=r)}),i}traverseSortNextHelper(){let t=this.parent;if(t){let i=t.children,r=i.indexOf(this)+1;if(wr.is(i[r]))return i[r];if(wr.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&wr.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let i=this;for(;t>0&&i!==null;)i=i.parent,t-=1;return i}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let i=this.parent;for(;i;){if(t===i)return!0;i=i.parent}return!1}countToAccestor(t){let i=0,r=this;for(;r!==t;){if(r===null)return-1;r=r.parent,i+=1}return i}forEachEntity(t){for(let i of this.children)zd(i)&&t(i)}traverseEntityAncestors(t){this.traverseAncestors(i=>{wr.is(i)&&t(i)})}traverseConcreteEntity(t,i=0){if(t(this,i)!==!0)for(let r of this.children)zd(r)&&r.isConcreteEntity&&r.traverseEntity(t,i+1)}traverseEntity(t,i=0){if(t(this,i)!==!0)for(let r of this.children)zd(r)&&r.traverseEntity(t,i+1)}traverseVisibleEntity(t){t(this);for(let i of this.children)zd(i)&&i.visible&&i.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,i=!1){return super.copy(t,i),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>zd(t))}isAncestorOf(t){if(this.uuid===t)return!1;let i=!1;return this.traverseEntity(r=>{r.uuid===t&&(i=!0)}),i}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x*Xt.RAD2DEG,this.rotation.y*Xt.RAD2DEG,this.rotation.z*Xt.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return $3(i,t)}getTransformValues(t,i,r){return i[t].map((n,s)=>(r==null?void 0:r.shared.getVariable(n,[this.uuid,t,G5e[s]]))??n)}updateTransformState(t,i){let r=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,i)),r=!0),t.rotation&&(vI.fromArray(this.getTransformValues("rotation",t,i)).multiplyScalar(Xt.DEG2RAD),this.rotation.setFromVector3(vI),r=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,i)),r=!0),t.hiddenMatrix!==void 0&&(r=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??ky.identity)),r&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),r}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)wr.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{wr.is(t)&&t.disposeRecursively()})}toState(t=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return $3(i,t)}updateByObjUpdateOp(t,i){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},i,!1)}updateByOp(t,i,r,n){let s=this.data;this.data=i;let a=t,o=sn(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let u={...t.props};if(delete u.name,Object.values(t.props).some(c=>c===void 0)){let c=this.data;if(c!==void 0){let h=$s.zoom(c,t.path.slice(2));if(h)for(let d in t.props)t.props[d]===void 0&&d in h&&(u[d]=h[d])}}a={...t,props:u,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:c,...h}=l;l=h}if(t.props.material!==void 0&&"material"in l){let{material:c,...h}=l;l=h}let u=$s.removeOverridden(t.path,t.props,l);a={...t,props:u}}}if(this.updateByPatchedOpBase(a,bg.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r),sn(t.path,["overrides"])){let l=[],u=[...t.path];for(l.push(u[1]),u.splice(0,2);u.length>0&&u[0]==="descendants";)l.push(u[1]),u.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let c of Object.keys(t.props)){l[l.length-1]=c;let h=r.scene.findInstance([this.uuid,...l]);h&&(h.overrideData=t.props[c],h.updateState(Fp.apply(h.component.data,h.overrideData),r))}}else{let c=r.scene.findInstance([this.uuid,...l]);if(c){let h=$s.zoom(c.component.data,u);if(t={...t,path:u},t.type===0){let d=t.props;if(h)for(let[f,m]of Object.entries(t.props))m===void 0&&(d===t.props&&(d={...t.props}),d[f]=h[f]);t={...t,props:d}}c.overrideData=oA.resolve(i.overrides,l),c.updateByOp(t,xa.applySimple(c.data,t),r,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let u;for(let c of wp.rootOverrideProps)c in t.props&&(u===void 0&&(u={}),u[c]=t.props[c]);u&&(l={...t,props:u})}else for(let u of wp.rootOverrideProps)if(sn(t.path,[u])){l=t;break}l!==void 0&&this.instances.forEach(u=>{if(u.isInstanceRoot){let c=Fp.filterOp(u.overrideData,l);c&&u.updateByOp(c,xa.applySimple(u.data,c),r,!0)}}),this.instances.forEach(u=>{if(!u.isInstanceRoot){let c=Fp.filterOp(u.overrideData,t);if(c){let h;s===u.data&&t===c?h=i:h=xa.applySimple(u.data,c),u.updateByOp(c,h,r,!0)}}})}}updateByPatchedOpBase(t,i,r){if(this.dataPatched=i,t.path.length===0&&t.type===0)t.props.type!==void 0&&!Kg.is(t.props.type)&&Sp.changeEntityProptotype(this,i,r);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){Sp.changeEntityProptotype(this,i,r);for(let n of this.children)wr.is(n)&&n.updateVisible(r.scene)}this.updateByPatchedOp(t,i,r)}updateByPatchedOp(t,i,r){var n;if(t.path.length===0&&t.type===0?this.updateState(t.props,r):t.type===0&&("resolutionLevel"in t.props||"useChildrenColors"in t.props)&&this.updateState(i,r),t.path[0]==="morphTargetInfluences"&&t.type===0){let s=(n=i.morphTargetInfluences.get(t.path[1]))==null?void 0:n.data.name;s&&this.updateMorphInfluences(s,r.shared.getVariable(t.props.value,[this.uuid,"morphTargetInfluences",s]))}if(sn(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),sn(t.path,["cloner"])!==null){let s=xa.drop(t,1);s.path.length===0&&s.type===0&&s.props.disabled===!0?this.setFromClonerState(null,r):this.cloner?this.cloner.updateState(i.cloner,r.scene):(this.setFromClonerState(i.cloner,r),this.expandCloner(r.scene)),this.updateVisible(r.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var m,g,y,x,w;let i=((m=this._updatedPathSnapping)==null?void 0:m.pathId)??this.dataPatched.pathSnapping.pathId,r=((g=this._updatedPathSnapping)==null?void 0:g.slide)??this.dataPatched.pathSnapping.slide??0,n=((y=this._updatedPathSnapping)==null?void 0:y.offset)??this.dataPatched.pathSnapping.offset??0,s=((x=this._updatedPathSnapping)==null?void 0:x.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let a=t.find(i);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=Dte(o.geometry.path),u=(r+n)%1;r+n===1&&u===0&&(u=1);let c=null;try{c=l.curves.length?l.getPointAt(u):null}catch{}if(c===null)return;let h=this.parent?(w=this.parent)==null?void 0:w.matrixWorld:new Pt;a.updateMatrixWorld();let d=new Pt().multiplyMatrices(h.clone().invert(),a.matrixWorld);c.applyMatrix4(d);let f={position:c.toArray(),rotation:o.rotation};if(s==="tangential"){let b=new Pt().extractRotation(a.matrixWorld),C=l.getTangentAt(u).applyMatrix4(b).add(c),A=new Pt().lookAt(c,C,q5e),E=vI.setFromEuler(new Ks().setFromRotationMatrix(A)).multiplyScalar(Xt.RAD2DEG);f={...f,rotation:E.toArray()}}this.updateTransformState(f),this.traverseEntity(b=>{b._cameraType&&b.dispatchEvent(W5e)})}updateVisible(t){var r;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((r=this.dataPatched.cloner)==null?void 0:r.hideBase)!==!0),!t)return;let i=!1;this.traverseEntity(n=>{if(n.data.type==="Splat")return i=!0,!0}),i&&t.reloadSplats()}updateState_Entity(t,i){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(i==null?void 0:i.scene),this.resetBBoxNeedsUpdate()),i&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,i),this.updateVisible(i.scene)),this.updateTransformState(t,i)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof Sp.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,i){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new Sp.Cloner(this,t),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,i.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},Ite=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var l,u;let i=(l=e.parameters)==null?void 0:l.radiusTop,r=(u=e.parameters)==null?void 0:u.radiusBottom,n=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);n.thetaLength=Xt.clamp(n.thetaLength,0,360);let s=n.width/2,a=n.radiusTop??s,o=n.radiusBottom??s;if(a===o?(a=s,o=s):a>o?(a=s,o=o*s/a):(a=a*s/o,o=s),n.shapeBlendNode){a=i??s,o=r??s;let c=Math.max(a,o)*2;n.width=c,n.depth=c}return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),radiusTop:a,radiusBottom:o})}}static build(e){let{width:t,depth:i,height:r,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:u,radiusBottom:c,cornerRadius:h,cornerSegments:d,hollow:f}=e.parameters,m;return l===0?(m=new ai,m.setAttribute("position",new Vt([],3))):h||f?m=new Ote(u,c,r,n,s,a,o,l*Math.PI/180,h,h,d,f):m=new dB(u,c,r,n,s,a,o,l*Math.PI/180),m.scale(1,1,i/t),Object.assign(m,{userData:{...e,type:"CylinderGeometry"}})}};function jf(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function VH(e){return new Ie(e.y,-e.x)}var Ote=class extends ai{constructor(e,t,i,r,n,s,a,o,l,u,c,h,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,i=i||1,r=Math.floor(r)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,u=0);let f=[],m=[],g=[],y=[],x=0,w=i/2,b=new q,C=new q;d&&e==0&&(e=l),d&&t==0&&(t=u);let A=new Ie(e,w),E=new Ie(t,-w),_=null,P=null,I=null,D=null,k=A.clone().sub(E),B=0,z=0,W=0;h>0&&(B=Math.min(e,t)*(1-h),z=e-B,W=t-B);let $=A.clone();$.x-=B;let Z=Math.PI-k.angle(),G=k.angle(),V=Math.tan(G/2),J=Math.tan(Z/2),U=V+J,ie=h?U:J,se=h?U:V;if(l=Math.min(l,(e-z)/ie,k.length()/U),u=Math.min(u,(t-W)/se,k.length()/U),l>0){let we=l/V;_=A.clone().sub(new Ie(we,l)),h&&(I=_.clone(),I.x-=B-U*l),A.sub(k.clone().setLength(we))}if(u>0){let we=u/J;P=E.clone().sub(new Ie(we,-u)),E.add(k.clone().setLength(we)),h&&(D=P.clone(),D.x-=B-U*u,$.sub(k.clone().setLength(we)))}k=A.clone().sub(E);let ee=k.length()<.5,ve=[];for(let we=0;we<=r;we++){let Le=[],Te=we/r,ke=Te*o+a,Xe=new Ie(Math.sin(ke),Math.cos(ke));D&&P?(_e(Le,Te,Xe,Z,u,D,-1,!0),_e(Le,Te,Xe,G,u,P,-1,!1)):P?(he(Le,Xe,P.x,0,-1),_e(Le,Te,Xe,G,u,P,-1,!1)):s||he(Le,Xe,t,W,-1);let et=VH(k).normalize();if(jf(et,Xe,b),!ee)for(let Ze=0;Ze<=n;Ze++){let st=Ze/n,_t=k.clone().multiplyScalar(st).add(E);jf(_t,Xe,C),m.push(C.x,C.y,C.z),g.push(b.x,b.y,b.z),y.push(Te,.5+C.y/i),Le.push(x++)}if(I&&_?(_e(Le,Te,Xe,Z,l,_,1,!1),_e(Le,Te,Xe,G,l,I,1,!0)):_?(_e(Le,Te,Xe,Z,l,_,1,!1),he(Le,Xe,_.x,0,1)):s||he(Le,Xe,e,z,1),h&&!ee){let Ze=VH(k).multiplyScalar(-1).normalize();jf(Ze,Xe,b);for(let st=0;st<=n;st++){let _t=st/n,St=k.clone().multiplyScalar(-_t).add($);jf(St,Xe,C),m.push(C.x,C.y,C.z),g.push(b.x,b.y,b.z),y.push(Te,.5+C.y/i),Le.push(x++)}}h&&!s&&Le.push(Le[0]),ve.push(Le)}for(let we=0;we<ve.length-1;we++)for(let Le=0;Le<ve[0].length-1;Le++){if(s&&h&&Le==n)continue;let Te=ve[we][Le],ke=ve[we+1][Le],Xe=ve[we+1][Le+1],et=ve[we][Le+1],Ze=m[Xe*3+0],st=m[Xe*3+2];f.push(Te,ke,et),(Ze!=0||st!=0)&&f.push(ke,Xe,et)}o<Math.PI*2&&(De(-1,ve[0],a),De(1,ve[ve.length-1],a+o)),this.setIndex(f),this.setAttribute("position",new Vt(m,3)),this.setAttribute("normal",new Vt(g,3)),this.setAttribute("uv",new Vt(y,2));function _e(we,Le,Te,ke,Xe,et,Ze,st){for(let _t=0;_t<c+1;_t++){let St=_t/c,ue=Ze<0?St:1-St;st&&(ue-=1),ue*=ke;let Ee=new Ie(Math.sin(ue),Math.cos(ue)*Ze),Ae=Ee.clone().multiplyScalar(Xe).add(et);jf(Ae,Te,C),m.push(C.x,C.y,C.z),jf(Ee,Te,b),g.push(b.x,b.y,b.z),y.push(Le,.5+C.y/i),we.push(x++)}}function he(we,Le,Te,ke,Xe){let et=new q,Ze=new Ie,st=[Te,ke];Xe<0&&st.reverse();for(let _t of st)Ze.set(_t,w*Xe),jf(Ze,Le,et),m.push(et.x,et.y,et.z),g.push(0,Xe,0),y.push(.5,.5),we.push(x++)}function De(we,Le,Te){let ke=new Ie(Math.sin(Te),Math.cos(Te)),Xe=new Ie(-Math.cos(Te),Math.sin(Te)),et=new q,Ze=we<0?(St,ue,Ee)=>f.push(St,ue,Ee):(St,ue,Ee)=>f.push(St,Ee,ue),st=new Ie((e+t+z+W)/4,0);jf(st,ke,et),m.push(et.x,et.y,et.z),g.push(Xe.x,0,Xe.y),y.push(.5,.5);let _t=x++;for(let St of Le){let ue=m.slice(St*3,St*3+3);m.push(...ue),g.push(Xe.x,0,Xe.y);let Ee=y.slice(St*2,St*2+2);y.push(...Ee),x++}for(let St=_t+1;St<x-1;St++)Ze(_t,St,St+1);Ze(_t,x-1,_t+1)}}},Y5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return i.thetaLength=Xt.clamp(i.thetaLength,0,360),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,depth:i,height:r,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:u,cornerRadiusBottom:c,cornerSegments:h}=e.parameters,d;return l===0?(d=new ai,d.setAttribute("position",new Vt([],3))):u>0||c>0||l<360?d=new Ote(0,t/2,r,n,s,a,o,l*Math.PI/180,u,c,h,0,!0):d=new fB(t/2,r,n,s,a),d.scale(1,1,i/t),Object.assign(d,{userData:{...e,type:"ConeGeometry"}})}},X5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,u;return o===0?u=new Dc(t,i,r,n,s,a):u=new K5e(t,i,r,n,s,a,o,l),Object.assign(u,{userData:{...e,type:"CubeGeometry"}})}},yI=Math.PI/2,K5e=class extends ai{constructor(e=1,t=1,i=1,r=1,n=1,s=1,a=0,o=4){super(),this.type="BoxGeometry",r=Math.floor(r),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,i/2);let l=[],u=[],c=[],h=[],d=0;f("z","y","x",-1,-1,i,t,e,s,n),f("z","y","x",1,-1,i,t,-e,s,n),f("x","z","y",1,1,e,i,t,r,s),f("x","z","y",1,-1,e,i,-t,r,s),f("x","y","z",1,-1,e,t,i,r,n),f("x","y","z",-1,-1,e,t,-i,r,n),a>0&&(m("z","y","x",-1,-1,1,i,t,e,s),m("z","y","x",1,-1,-1,i,t,e,s),m("z","y","x",-1,1,-1,i,t,e,s),m("z","y","x",1,1,1,i,t,e,s),m("x","y","z",-1,-1,-1,e,t,i,r),m("x","y","z",1,-1,1,e,t,i,r),m("x","y","z",-1,1,1,e,t,i,r),m("x","y","z",1,1,-1,e,t,i,r),m("y","x","z",-1,-1,1,t,e,i,n),m("y","x","z",1,-1,-1,t,e,i,n),m("y","x","z",1,1,1,t,e,i,n),m("y","x","z",-1,1,-1,t,e,i,n),g(1,1,1),g(-1,1,1),g(1,-1,1),g(-1,-1,1),g(1,1,-1),g(-1,1,-1),g(1,-1,-1),g(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new Vt(u,3)),this.setAttribute("normal",new Vt(c,3)),this.setAttribute("uv",new Vt(h,2));function f(y,x,w,b,C,A,E,_,P,I){let D=(A-2*a)/P,k=(E-2*a)/I,B=A/2-a,z=E/2-a,W=_/2,$=P+1,Z=I+1,G=0,V=new q;for(let J=0;J<Z;J++){let U=J*k-z;for(let ie=0;ie<$;ie++){let se=ie*D-B;V[y]=se*b,V[x]=U*C,V[w]=W,u.push(V.x,V.y,V.z),V[y]=0,V[x]=0,V[w]=_>0?1:-1,c.push(V.x,V.y,V.z),h.push(ie/P),h.push(1-J/I),G+=1}}for(let J=0;J<I;J++)for(let U=0;U<P;U++){let ie=d+U+$*J,se=d+U+$*(J+1),ee=d+(U+1)+$*(J+1),ve=d+(U+1)+$*J;l.push(ie,se,ve),l.push(se,ee,ve)}d+=G}function m(y,x,w,b,C,A,E,_,P,I){let D=(E-2*a)/I,k=E/2-a,B=_/2-a,z=P/2,W=I+1,$=0,Z=new q,G=new q;for(let V=0;V<o+1;V++){let J=V/o*yI,U=Math.sin(J)*a,ie=(1-Math.cos(J))*a,se=Math.sin(J),ee=Math.cos(J);Z[x]=(B+U)*C,Z[w]=(z-ie)*A,G[y]=0,G[x]=se*Math.sign(Z[x]),G[w]=ee*Math.sign(Z[w]);for(let ve=0;ve<W;ve++){let _e=ve*D-k;Z[y]=_e*b,u.push(Z.x,Z.y,Z.z),c.push(G.x,G.y,G.z),h.push(ve/I),h.push(0),$+=1}}for(let V=0;V<o;V++)for(let J=0;J<I;J++){let U=d+J+W*V,ie=d+J+W*(V+1),se=d+(J+1)+W*(V+1),ee=d+(J+1)+W*V;l.push(U,ie,ee),l.push(ie,se,ee)}d+=$}function g(y,x,w){let b=new q,C=new q(e/2,t/2,i/2);C.subScalar(a);let A=[],E=y*x*w>0?(P,I,D)=>l.push(P,I,D):(P,I,D)=>l.push(P,D,I);for(let P=0;P<=o;P++){let I=[],D=yI*(1-P/o),k=Math.cos(D),B=Math.sin(D),z=0;for(let W=0;W<=P;W++){let $=Math.cos(z),Z=Math.sin(z);b.x=k*$,b.y=B,b.z=k*Z;let G=C.clone().addScaledVector(b,a);u.push(y*G.x,x*G.y,w*G.z),c.push(y*b.x,x*b.y,w*b.z),h.push(0,0),I.push(d++),z+=yI/P}A.push(I)}let _=A.length-1;for(let P=0;P<_;P++){let I=A[P],D=A[P+1],k=I.length-1;E(I[0],D[1],D[0]);for(let B=1;B<=k;B++)E(I[B-1],I[B],D[B]),E(I[B],D[B+1],D[B])}}}},KB=class extends ai{constructor(e=[],t=[],i="",r=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];u(),c(),this.setAttribute("position",new Vt(a,3)),this.setAttribute("normal",new Vt(l,3)),this.setAttribute("uv",new Vt(o,2));return;function u(){var G;n=Math.min(1-1e-5,n),n==0&&(s=0);let h={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],d=new q,f=d.clone(),m=new Fa,g=n*r,y=r-g,x=s+1,w=new q,b=(V,J)=>w.subVectors(V,J).normalize(),C=(V,J)=>Array(V).fill(void 0).map(J),A=C(e.length/3,(V,J)=>new q().fromArray(e,J*3).setLength(r)),E=[],_=1e6;for(let V=0;V<A.length;V++){let J=A[V],U=[],ie,se,ee,ve=1e10,_e=-1;for(;(_e=t.indexOf(V,_e+1))!=-1;){let Le=_e-_e%3;ie=t[Le+(_e+1)%3],se=t[Le+(_e+2)%3],ee=J.distanceToSquared(A[ie]),ve=Math.min(ve,ee),U.push([ie,se,ee])}ve+=1e-6;let he=[],De=0,we=U.length;for(let Le=0;Le<we;Le++){[ie,se,ee]=U[De];let Te=((G=E[ie])==null?void 0:G.includes(V))==!0;ee<=ve&&he.push(ie+ +Te*_),De=U.findIndex(ke=>ke[0]==se)}E.push(he)}let P=[];{let V=0,J=0,U,ie,se=h==3;for(let ee=0;ee<=s;ee++){U=ee*(ee+1)/2,ie=(ee+1)*(ee+2)/2;for(let ve=0;ve<s-ee;ve++)[V,J]=[U+ve+ee+2,ie+ve+ee+3],P.push(U,ie,...se?[J,U]:[V,ie],J,V),[U,ie]=[V,J];P.push(U,ie,U+s+2)}}let I=d.clone(),D=d.clone(),k=d.clone(),B=d.clone(),z=d.clone(),W=[],$=C(A.length,()=>C(h,()=>d.clone()));for(let V=0;V<A.length;V++){d.copy(A[V]).normalize(),I.copy(d).multiplyScalar(y);let J=E[V];for(let he=0;he<J.length;he++){let De=J[he],we=J[(he+1)%h];m.setFromPointsAndIndices(A,V,De%_,we%_),m.b.sub(m.a).setLength(1e10).add(m.a),m.c.sub(m.a).setLength(1e10).add(m.a),m.closestPointToPoint(I,$[V][he])}let U=[],ie=[],se=[],ee=new q;s==0&&[...$[V]].reduce((he,De)=>he.add(De),ee).multiplyScalar(1/h);for(let he=0;he<h;he++){let De=[],we=(he-1+h)%h,Le=$[V][we],Te=$[V][he];d.copy(Le).sub(I),f.copy(Te).sub(I);let ke=I.angleTo(d),Xe=d.angleTo(f),et=Math.cos(ke)*g;s==0?D.copy(ee):D.copy(I).setLength(y+et),ie.push(et);let Ze=[D,Le,Te];for(let st=0;st<2;st++){let _t=Ze[st],St=Ze[st+1];B.subVectors(_t,I),z.subVectors(St,I),k.crossVectors(B,z).normalize();for(let ue=0;ue<x;ue++){let Ee=[ke,Xe][st]*ue/x;d.copy(B).applyAxisAngle(k,Ee).add(I),U.push(d.clone()),st&&(b(d,I),De.push([ue==0?_t:d.clone(),w.clone()]))}st&&(b(St,I),De.push([St,w.clone()]))}se.push(De)}W.push(se);let ve=2*x,_e=2;for(let he=0;he<h;he++){let De=ve*he,we=ve*((he+1)%h),Le=[U[De]];for(let ke=1;ke<x;ke++){B=U[De+ke],z=U[we+ke],Le.push(B);for(let Xe=1,et=ke-_e+1;Xe<=et;Xe++)d.lerpVectors(B,z,Xe/(et+1)),d.sub(I).setLength(ie[he]).add(I),Le.push(d.clone());Le.push(z)}for(let ke=0;ke<x;ke++)Le.push(U[ke+x+De]);Le.push(U[we+x]);let Te=P.map(ke=>Le[ke]);a.push(...Te.map(ke=>[ke.x,ke.y,ke.z]).flat()),l.push(...Te.map(ke=>(b(ke,I),[w.x,w.y,w.z])).flat())}}let Z=[];for(let V=0;V<E.length;V++)for(let J=0;J<h;J++){let U=E[V][J];if(U<_){let ie=E[U].findIndex(ve=>ve%_==V),se=W[V][J],ee=W[U][ie];for(let ve=0;ve<x;ve++){let _e=se[ve],he=ee[x-ve],De=se[ve+1],we=ee[x-(ve+1)];[_e,he,De,De,he,we].forEach(Le=>{a.push(Le[0].x,Le[0].y,Le[0].z),l.push(Le[1].x,Le[1].y,Le[1].z)})}Z.push(se[0][0],ee[x][0],se[x][0],ee[0][0])}}for(;Z.length;){let V,J,U,ie;[V,J]=Z.splice(0,2);let se=[V];for(;V!=J;)se.push(J),U=Z.indexOf(J),ie=U%2,J=Z.splice(U-ie,2)[1-ie];w.subVectors(se[0],se[1]).cross(d.subVectors(se[0],se[2])).normalize();let ee=w.dot(se[0])<0;ee&&w.negate();for(let ve=1;ve<=se.length-2;ve++)[se[ve+ +ee],se[ve+1-+ee],se[0]].forEach(_e=>{a.push(_e.x,_e.y,_e.z),l.push(w.x,w.y,w.z)})}}function c(){let h=new q;for(let E=0;E<a.length;E+=3){h.x=a[E+0],h.y=a[E+1],h.z=a[E+2];let _=C(h)/2/Math.PI+.5,P=A(h)/Math.PI+.5;o.push(_,1-P)}let d=new q,f=new q,m=new q,g=new q,y=new Ie,x=new Ie,w=new Ie,b=(E,_,P,I)=>{I<0&&E.x===1&&(o[_]=E.x-1),P.x===0&&P.z===0&&(o[_]=I/2/Math.PI+.5)};for(let E=0,_=0;E<a.length;E+=9,_+=6){d.set(a[E+0],a[E+1],a[E+2]),f.set(a[E+3],a[E+4],a[E+5]),m.set(a[E+6],a[E+7],a[E+8]),y.set(o[_+0],o[_+1]),x.set(o[_+2],o[_+3]),w.set(o[_+4],o[_+5]),g.copy(d).add(f).add(m).divideScalar(3);let P=C(g);b(y,_+0,d,P),b(x,_+2,f,P),b(w,_+4,m,P)}for(let E=0;E<o.length;E+=6){let _=o[E+0],P=o[E+2],I=o[E+4],D=Math.max(_,P,I),k=Math.min(_,P,I);D>.9&&k<.1&&(_<.2&&(o[E+0]+=1),P<.2&&(o[E+2]+=1),I<.2&&(o[E+4]+=1))}function C(E){return Math.atan2(E.z,-E.x)}function A(E){return Math.atan2(-E.y,Math.sqrt(E.x*E.x+E.z*E.z))}}}static fromJSON(e){return new KB(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},$5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new Rte(t*.5,s,a):new UJ(t*.5,n);return o.scale(1,i/t,r/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},Rte=class extends KB{constructor(e=1,t=.2,i=4){let r=(1+Math.sqrt(5))/2,n=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,i),this.type=o}static fromJSON(e){return new Rte(e.radius,e.corner,e.cornerSides)}},hx=1e-12,$B=class{constructor(e){this.position=new Ie,this.startPosition=new Ie,this.uuid=Xt.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new $B(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},WL=class extends $B{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new WL(this.parent).copy(this)}},cy=class extends $B{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new WL(this),new WL(this))}static create(e,t){let i=new cy(e,new Ie(...t.position));return i.controls[0].position.set(...t.controlPrevious.position),i.controls[1].position.set(...t.controlNext.position),i.roundness=t.roundness,i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,i}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let i=0,r=this.controls.length;i<r;i++){let n=this.controls[i];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new cy(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,r;let e=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),t=(r=this.curveAfter)==null?void 0:r.getTangentAt(0);return[e,t]}computeNormals(e=new Ie,t=new Ie){let[i,r]=this.computeTangents();return i&&r&&(HH(i,e),HH(r,t)),[e,t]}computeTangent(e=new Ie){let[t,i]=this.computeTangents();return t&&i&&e.copy(t).add(i).normalize(),e}computeNormal(e=new Ie){let[t,i]=this.computeNormals();return e.copy(t).add(i).normalize(),e}};function HH(e,t=new Ie){let i=e.length();return t.set(-e.y/i,e.x/i)}var ZB=e=>e,v1=new Ie,zM=new Ie,Z5e=new Ie,Q5e=new Ie,J5e=new Ie,eUe=new Ie,Lte=new q,Nte=new q;function tUe(e){let t=new Ie;t.addVectors(e.v0,v1.subVectors(e.v1,e.v0).multiplyScalar(2/3));let i=new Ie;return i.addVectors(e.v2,zM.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new vc(e.v0,t,i,e.v2)}function qx(e,t,i=Number.EPSILON){return Math.abs(e-t)<i}function iUe(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function rUe(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function kte(e,t,i){let r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),s=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));return Math.acos((n*n+r*r-s*s)/(2*n*r))}function nUe(e,t,i){return GH(e,t)&&GH(t,i)&&GL(e.position,t.position,i.position)}function GL(e,t,i){return v1.copy(t).sub(e).cross(zM.copy(i).sub(e))===0}function sUe(e,t,i,r,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(e.y-t.y)/s,u=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return r.set(o+l,a+u),n.set(o-l,a-u),[r,n]}function aUe(e,t,i){let r=e.distanceTo(i),n=t.distanceTo(i);return r<n?t:e}function oUe(e,t,i,r,n,s){let a=t.x-e.x,o=t.y-e.y,l=i.x-e.x,u=i.y-e.y,c=Math.sqrt((a+l)*(a+l)+(o+u)*(o+u)),h;return kte(t,e,i)>Math.PI&&(c*=-1),qx(u,o)?h=(o+u)*(r/c-.5)*8/3/(a-l):h=(a+l)*(r/c-.5)*8/3/(u-o),n.set(t.x-h*o,t.y+h*a),s.set(i.x+h*u,i.y-h*l),[n,s]}function WH(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function GH(e,t){return GL(e.position,e.controls[1].position,t.position)&&GL(e.position,t.controls[0].position,t.position)}function lUe(e,t,i,r,n=.5){let s=v1.subVectors(t,e).multiplyScalar(n).add(e),a=zM.subVectors(i,t).multiplyScalar(n).add(t),o=Z5e.subVectors(r,i).multiplyScalar(n).add(i),l=s,u=Q5e.subVectors(a,s).multiplyScalar(n).add(s),c=J5e.subVectors(o,a).multiplyScalar(n).add(a),h=o,d=eUe.subVectors(c,u).multiplyScalar(n).add(u);return[e.x,e.y,l.x,l.y,u.x,u.y,d.x,d.y,c.x,c.y,h.x,h.y,r.x,r.y]}function uUe(e,t,i=12,r=!0){let n=Nte.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=ZB(t[o]),u=v1,c=kg(l,i);for(let h=0;h<=c;h++)if(l instanceof vc||l instanceof Yp||l instanceof wc){if(l.getPoint(h/c,u),n.set(u.x,u.y,0),s!==void 0&&rUe(s,n))continue;s===void 0&&(s=Lte),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return r&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function cUe(e,t,i,r=12,n=!0){let s=Nte.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(i[l]===!1)continue;let u,c=ZB(t[l]),h=v1,d=kg(c,r);o.push(d);for(let f=0;f<=d;f++)if(c instanceof vc||c instanceof Yp||c instanceof wc){if(c.getPoint(f/d,h),s.set(h.x,h.y,0),u==null?void 0:u.equals(s))continue;u===void 0?u=Lte:(e.setXYZ(a,u.x,u.y,u.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),u.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function qH(e,t=12,i=!1){let r=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(i&&a.roundedCurveCorner!==void 0){let l=kg(a.roundedCurveCorner,t)*.5;n>0&&(r[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=kg(a.curveAfter,t)),r.push(o)}return e.length>0&&i&&e[0].roundedCurveCorner!==void 0&&(r[e.length-1]+=kg(e[0].roundedCurveCorner,t)*.5),r}function kg(e,t=12){return e&&e instanceof EM?t*2:e&&(e instanceof wc||e instanceof BJ)?1:e&&e instanceof hB?t*e.points.length:t}function hUe(e,t,i=12,r=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=ZB(t[a]),l=kg(o,i),u=v1;for(let c=0;c<=l;c++)if(o instanceof vc||o instanceof Yp||o instanceof wc){if(o.getPoint(c/l,u),n!==void 0&&iUe(n,u,hx))continue;n===void 0&&(n=zM),n.copy(u),e.push(u.x,u.y),s++}}return qx(e[0],e[e.length-2],hx)&&qx(e[1],e[e.length-1],hx)&&(e.pop(),e.pop()),r&&s>1&&!(qx(e[s-1],e[1],hx)&&qx(e[s-2],e[0],hx))&&(e.push(e[0],e[1]),s++),e}var xI=new Ie,dUe=new Ie,fUe=new Ie,pUe=new Ie,mUe=new Ie,gUe=new Ie,Jn=class extends NC{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new bl(new q(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Xt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,i){let r=new Jn;return r.isClosed=e.isClosed,r.points=e.points.map(n=>cy.create(n.id,n.data)),typeof e.roundness=="number"&&(r.roundness=e.roundness),r.shapeHoles=e.shapeHoles.map(n=>Jn.createFromState(n)),t!==void 0&&i!==void 0&&r.applySize(t,i),r.update(),r}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,i=this.points.length;t<i;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,i=this.points.findIndex(r=>r.uuid===e);if(i<0){let r=t;for(let n=0,s=this.shapeHoles.length;n<s;n++){let a=this.shapeHoles[n],o=a.points.length,l=a.getPointIndexById(e);if(l<0)r+=o;else return l+r}}return i}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let i=0,r=this.shapeHoles.length;i<r;i++){let n=this.shapeHoles[i],s=e-t;if(s<=n.points.length-1)return n.points[s];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let i=0,r=this.shapeHoles.length;i<r;i++){let n=this.shapeHoles[i],s=n.points.indexOf(e);if(s>=0)return t+s;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let i=xI.set(e,t);for(let r=0,n=this.points.length;r<n;r++){let s=this.points[r];s.position.multiply(i),s.controls[0].position.multiply(i),s.controls[1].position.multiply(i)}for(let r=0,n=this.shapeHoles.length;r<n;r++)this.shapeHoles[r].applyScale(e,t);this._update()}createPoint(e,t=0,i=Xt.generateUUID()){let r;e instanceof Ie?r=e:r=new Ie(e,t);let n=new cy(i,r);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];if(r.uuid===e)return r}for(let t=0,i=this.shapeHoles.length;t<i;t++){let r=this.shapeHoles[t].getPointByUuid(e);if(r)return r}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(i=>i.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,i=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let r=i?this.roundedCurveDivisions:this.curveDivisions;return uUe(e,i?this.roundedCurves:this.curves,t,this.autoClose),r.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=qH(this.points,e,!1),this.roundedCurveDivisions=qH(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,i=12){return cUe(e,this.curves,t,i,this.autoClose).reduce((r,n)=>r+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),hUe(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let r=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=kg(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-n;s<0&&(s+=r.reduce((a,o)=>a+o,0));for(let a=0,o=r.length;a<o;a++){let l=r[a];if(s<i+l)return[a,(s-i+1)/l];i+=l}return[0,1]}getCurveT(e,t,i){let r=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(WH(r,n)){let l=r.position.distanceTo(n.position);return r.position.distanceTo(xI.set(i.x,i.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){WH(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let i=this.curves[this.curves.length-1];e.curveBefore=i,t.curveAfter=i;let r=i.clone();e.roundedCurveBefore=r,t.roundedCurveAfter=r,e.roundedCurveCorner=void 0,this.roundedCurves.push(r)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];if(t===0)this.moveTo(r.position.x,r.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(r,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(t,i)}if(this.points.length>2){let t=0;for(let i=0,r=this.points.length;i<r;i++){let n=this.points[i],s=this.points[i-1]??this.points[this.points.length-1],a=this.points[i+1]??this.points[0],o=n.roundness,l=s&&a&&nUe(s,n,a);if(!n.controlsMoved()&&o>0&&!l){let u=n.curveBefore,c=n.curveAfter;if(u===void 0||c===void 0)continue;let h=n.roundedCurveBefore,d=n.roundedCurveAfter,f=u.getLength(),m=c.getLength(),g=Math.min(o,f*.499),y=Math.min(o,m*.499),x=Math.min(g,y),w=1-x/f,b=x/m,C=u.getPointAt(w,xI),A=c.getPointAt(b,dUe);this._subSplitCurve(u,h,w,C,void 0),this._subSplitCurve(c,d,b,void 0,A);let E;if(this.useCubicForRoundedCorners){let _=kte(C,n.position,A)/2,P=Math.tan(_)*C.distanceTo(n.position),[I,D]=sUe(C,A,P,fUe,pUe),k=aUe(I,D,n.position),[B,z]=oUe(k,C,A,P,mUe,gUe);E=new vc(C.clone(),B.clone(),z.clone(),A.clone())}else E=new Yp(C.clone(),n.position.clone(),A.clone());n.roundedCurveCorner=E,this.roundedCurves.splice(i+t,0,E),t++}}}}_subSplitCurve(e,t,i,r,n){if(e instanceof wc)r!==void 0&&t.v2.copy(r),n!==void 0&&t.v1.copy(n);else{let s=e,a=t,o=s.getUtoTmapping(i,0),l=lUe(s.v0,s.v1,s.v2,s.v3,o);return r!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),n!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new Jn(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var i;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let r=0;r<t;r++){let n=r*7,s=e.points[n+0],a=e.points[n+1],o=e.points[n+2],l=e.points[n+3],u=e.points[n+4],c=e.points[n+5],h=e.points[n+6],d=new cy(Xt.generateUUID(),new Ie(s,a));d.controls[0].position.set(o,l),d.controls[1].position.set(u,c),d.roundness=h,this.points.push(d)}return this.shapeHoles=(i=e.shapeHoles)!=null&&i.length?e.shapeHoles.map(r=>{let n=new Jn;return n.fromJSON(r),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e,t=!1){this.isText=t;let i=(n,s)=>{s instanceof vc&&s.v3.equals(n.position)&&n.controls[0].position.copy(s.v2)},r=n=>{let s=[],a,o;for(a=0,o=n.length;a<o;a++)n[a]instanceof Yp&&(n[a]=tUe(n[a]));for(a=0,o=n.length;a<o;a++){let c=n[a],h=a>0?n[a-1]:null,d;c instanceof vc?(d=this.createPoint(c.v0),d.controls[1].position.copy(c.v1)):c instanceof wc&&(d=this.createPoint(c.v1)),d!==void 0&&(h!==null&&i(d,h),s.push(d))}let l=n[n.length-1],u=!1;return l instanceof vc?l.v3.equals(s[0].position)&&(s[0].controls[0].position.copy(l.v2),u=!0):l instanceof wc&&l.v2.equals(s[0].position)&&(u=!0),this.isClosed=u,s};return this.points=r(e.curves),e instanceof NC&&(this.shapeHoles=e.holes.map(n=>{let s=new Jn;return s.fromShape(n),s})),this.update(),this}updatePoint(e,t){let i=this.getPointByUuid(e);i&&(t.position!==void 0&&i.position.fromArray(t.position),t.roundness!==void 0&&(i.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var r;let i=(r=this.getPointByUuid(e))==null?void 0:r.controls[0];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var r;let i=(r=this.getPointByUuid(e))==null?void 0:r.controls[1];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}},Bte=Math.PI*2;function bI({x:e,y:t},i,r,n,s){return{x:e*i+n,y:t*r+s}}function vUe(e,t){let i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:r-n*i,y:n+r*i},{x:s+a*i,y:a-s*i},{x:s,y:a}]}function YH(e,t,i,r){let n=e*r-t*i<0?-1:1,s=Math.min(1,Math.max(-1,e*i+t*r));return n*Math.acos(s)}function yUe(e,t,i,r,n,s,a,o,l,u){let c=Math.pow(n,2),h=Math.pow(s,2),d=Math.pow(a,2),f=Math.pow(o,2),m=c*h-c*f-h*d;m<0&&(m=0),m/=c*f+h*d,m=Math.sqrt(m)*(l===u?-1:1);let g=m*n/s*o,y=m*-s/n*a,x=g+(e+i)/2,w=y+(t+r)/2,b=(a-g)/n,C=(o-y)/s,A=(-a-g)/n,E=(-o-y)/s,_=YH(1,0,b,C),P=YH(b,C,A,E);return P<0&&(P+=Bte),{centerx:x,centery:w,ang1:_,ang2:P}}function xUe({px:e,py:t,cx:i,cy:r,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let u=(e-i)/2,c=(t-r)/2;if(u===0&&c===0)return[];n=Math.abs(n),s=Math.abs(s);let h=Math.pow(u,2)/Math.pow(n,2)+Math.pow(c,2)/Math.pow(s,2);h>1&&(n*=Math.sqrt(h),s*=Math.sqrt(h));let d=yUe(e,t,i,r,n,s,u,c,a,o),{ang1:f,ang2:m}=d,{centerx:g,centery:y}=d,x=Math.abs(m)/(Bte/4);Math.abs(1-x)<1e-7&&(x=1);let w=Math.max(Math.ceil(x),1);m/=w;for(let b=0;b<w;b++)l.push(vUe(f,m)),f+=m;return l.map(b=>{let{x:C,y:A}=bI(b[0],n,s,g,y),{x:E,y:_}=bI(b[1],n,s,g,y),{x:P,y:I}=bI(b[2],n,s,g,y);return{x1:C,y1:A,x2:E,y2:_,x:P,y:I}})}var Zr;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Zr||(Zr={}));var Ds;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Ds||(Ds={}));function Ei(e,t){if(!e)throw t||"Assertion Failed!"}var di=function(){function e(){}return e.vertEq=function(t,i){return t.s===i.s&&t.t===i.t},e.vertLeq=function(t,i){return t.s<i.s||t.s===i.s&&t.t<=i.t},e.transLeq=function(t,i){return t.t<i.t||t.t===i.t&&t.s<=i.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,i){return Math.abs(t.s-i.s)+Math.abs(t.t-i.t)},e.edgeEval=function(t,i,r){Ei(e.vertLeq(t,i)&&e.vertLeq(i,r));var n=i.s-t.s,s=r.s-i.s;return n+s>0?n<s?i.t-t.t+(t.t-r.t)*(n/(n+s)):i.t-r.t+(r.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,i,r){Ei(e.vertLeq(t,i)&&e.vertLeq(i,r));var n=i.s-t.s,s=r.s-i.s;return n+s>0?(i.t-r.t)*n+(i.t-t.t)*s:0},e.transEval=function(t,i,r){Ei(e.transLeq(t,i)&&e.transLeq(i,r));var n=i.t-t.t,s=r.t-i.t;return n+s>0?n<s?i.s-t.s+(t.s-r.s)*(n/(n+s)):i.s-r.s+(r.s-t.s)*(s/(n+s)):0},e.transSign=function(t,i,r){Ei(e.transLeq(t,i)&&e.transLeq(i,r));var n=i.t-t.t,s=r.t-i.t;return n+s>0?(i.s-r.s)*n+(i.s-t.s)*s:0},e.vertCCW=function(t,i,r){return t.s*(i.t-r.t)+i.s*(r.t-t.t)+r.s*(t.t-i.t)>=0},e.interpolate=function(t,i,r,n){return t=t<0?0:t,r=r<0?0:r,t<=r?r===0?(i+n)/2:i+(n-i)*(t/(t+r)):n+(i-n)*(r/(t+r))},e.intersect=function(t,i,r,n,s){var a,o,l;e.vertLeq(t,i)||(l=t,t=i,i=l),e.vertLeq(r,n)||(l=r,r=n,n=l),e.vertLeq(t,r)||(l=t,t=r,r=l,l=i,i=n,n=l),e.vertLeq(r,i)?e.vertLeq(i,n)?(a=e.edgeEval(t,r,i),o=e.edgeEval(r,i,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,r.s,o,i.s)):(a=e.edgeSign(t,r,i),o=-e.edgeSign(t,n,i),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,r.s,o,n.s)):s.s=(r.s+i.s)/2,e.transLeq(t,i)||(l=t,t=i,i=l),e.transLeq(r,n)||(l=r,r=n,n=l),e.transLeq(t,r)||(l=t,t=r,r=l,l=i,i=n,n=l),e.transLeq(r,i)?e.transLeq(i,n)?(a=e.transEval(t,r,i),o=e.transEval(r,i,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,r.t,o,i.t)):(a=e.transSign(t,r,i),o=-e.transSign(t,n,i),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,r.t,o,n.t)):s.t=(r.t+i.t)/2},e}(),dx=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),uS=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),y0=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),XH=function(){function e(){var t=new y0,i=new dx,r=new uS(0),n=new uS(1);t.next=t.prev=t,t.anEdge=null,i.next=i.prev=i,r.next=r,r.Sym=n,n.next=n,n.Sym=r,this.vHead=t,this.fHead=i,this.eHead=r,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var i=new uS(0),r=new uS(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return r.next=n,n.Sym.next=i,i.next=t,t.Sym.next=r,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i},e.prototype.splice_=function(t,i){var r=t.Onext,n=i.Onext;r.Sym.Lnext=i,n.Sym.Lnext=t,t.Onext=n,i.Onext=r},e.prototype.makeVertex_=function(t,i,r){var n=t;Ei(n,"Vertex can't be null!");var s=r.prev;n.prev=s,s.next=n,n.next=r,r.prev=n,n.anEdge=i;var a=i;do a.Org=n,a=a.Onext;while(a!==i)},e.prototype.makeFace_=function(t,i,r){var n=t;Ei(n,"Face can't be null");var s=r.prev;n.prev=s,s.next=n,n.next=r,r.prev=n,n.anEdge=i,n.trail=null,n.marked=!1,n.inside=r.inside;var a=i;do a.Lface=n,a=a.Lnext;while(a!==i)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var i=t.next,r=t.Sym.next;i.Sym.next=r,r.Sym.next=i},e.prototype.killVertex_=function(t,i){var r=t.anEdge,n=r;do n.Org=i,n=n.Onext;while(n!==r);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,i){var r=t.anEdge,n=r;do n.Lface=i,n=n.Lnext;while(n!==r);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new y0,i=new y0,r=new dx,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(i,n.Sym,this.vHead),this.makeFace_(r,n,this.fHead),n},e.prototype.splice=function(t,i){var r=!1,n=!1;if(t!==i){if(i.Org!==t.Org&&(n=!0,this.killVertex_(i.Org,t.Org)),i.Lface!==t.Lface&&(r=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(i,t),!n){var s=new y0;this.makeVertex_(s,i,t.Org),t.Org.anEdge=t}if(!r){var a=new dx;this.makeFace_(a,i,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var i=t.Sym,r=!1;if(t.Lface!==t.Rface&&(r=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!r){var n=new dx;this.makeFace_(n,t,t.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(t.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var i=this.makeEdge_(t),r=i.Sym;this.splice_(i,t.Lnext),i.Org=t.Dst;var n=new y0;return this.makeVertex_(n,r,i.Org),i.Lface=r.Lface=t.Lface,i},e.prototype.splitEdge=function(t){var i=this.addEdgeVertex(t),r=i.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,r),t.Dst=r.Org,r.Dst.anEdge=r.Sym,r.Rface=t.Rface,r.winding=t.winding,r.Sym.winding=t.Sym.winding,r.idx=t.idx,r.Sym.idx=t.Sym.idx,r},e.prototype.connect=function(t,i){var r=!1,n=this.makeEdge_(t),s=n.Sym;if(i.Lface!==t.Lface&&(r=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,i),n.Org=t.Dst,s.Org=i.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!r){var a=new dx;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var i=t.anEdge,r,n,s,a,o;n=i.Lnext;do r=n,n=r.Lnext,r.Lface=null,r.Rface===null&&(r.Onext===r?this.killVertex_(r.Org,null):(r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),s=r.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(r));while(r!=i);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var i=t.anEdge,r=0;do r++,i=i.Lnext;while(i!==t.anEdge);return r},e.prototype.mergeConvexFaces=function(t){var i,r,n,s,a,o,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(r=i.anEdge,a=r.Org;n=r.Lnext,s=r.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(i),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&di.vertCCW(r.Lprev.Org,r.Org,s.Lnext.Lnext.Org)&&di.vertCCW(s.Lprev.Org,s.Org,r.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),r=null,s=null)),!(r&&r.Lnext.Org===a);)r=n;return!0},e.prototype.check=function(){var t=this.fHead,i=this.vHead,r=this.eHead,n,s,a,o,l,u;for(s=t,s=t;(n=s.next)!==t;s=n){Ei(n.prev===s),l=n.anEdge;do Ei(l.Sym!==l),Ei(l.Sym.Sym===l),Ei(l.Lnext.Onext.Sym===l),Ei(l.Onext.Sym.Lnext===l),Ei(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(Ei(n.prev===s&&n.anEdge===null),o=i,o=i;(a=o.next)!==i;o=a){Ei(a.prev===o),l=a.anEdge;do Ei(l.Sym!==l),Ei(l.Sym.Sym===l),Ei(l.Lnext.Onext.Sym===l),Ei(l.Onext.Sym.Lnext===l),Ei(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(Ei(a.prev===o&&a.anEdge===null),u=r,u=r;(l=u.next)!==r;u=l)Ei(l.Sym.next===u.Sym),Ei(l.Sym!==l),Ei(l.Sym.Sym===l),Ei(l.Org!==null),Ei(l.Dst!==null),Ei(l.Lnext.Onext.Sym===l),Ei(l.Onext.Sym.Lnext===l);Ei(l.Sym.next===u.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),KH=function(){function e(){this.handle=null}return e}(),$H=function(){function e(){this.key=null,this.node=0}return e}(),bUe=function(){function e(t,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var r=0;r<t+1;r++)this.nodes[r]=new KH,this.handles[r]=new $H;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var i=this.nodes,r=this.handles,n,s,a;for(n=i[t].handle;;){if(a=t<<1,a<this.size&&this.leq(r[i[a+1].handle].key,r[i[a].handle].key)&&++a,Ei(a<=this.max),s=i[a].handle,a>this.size||this.leq(r[n].key,r[s].key)){i[t].handle=n,r[n].node=t;break}i[t].handle=s,r[s].node=t,t=a}},e.prototype.floatUp_=function(t){var i=this.nodes,r=this.handles,n,s,a;for(n=i[t].handle;;){if(a=t>>1,s=i[a].handle,a===0||this.leq(r[s].key,r[n].key)){i[t].handle=n,r[n].node=t;break}i[t].handle=s,r[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var i,r;if(i=++this.size,i*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new KH;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new $H}return this.freeList===0?r=i:(r=this.freeList,this.freeList=this.handles[r].node),this.nodes[i].handle=r,this.handles[r].node=i,this.handles[r].key=t,this.initialized&&this.floatUp_(i),r},e.prototype.extractMin=function(){var t=this.nodes,i=this.handles,r=t[1].handle,n=i[r].key;return this.size>0&&(t[1].handle=t[this.size].handle,i[t[1].handle].node=1,i[r].key=null,i[r].node=this.freeList,this.freeList=r,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var i=this.nodes,r=this.handles,n;Ei(t>=1&&t<=this.max&&r[t].key!==null),n=r[t].node,i[n].handle=i[this.size].handle,r[i[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(r[i[n>>1].handle].key,r[i[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),r[t].key=null,r[t].node=this.freeList,this.freeList=t},e}(),_I=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),ZH=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),_Ue=function(){function e(t,i){this.frame=t,this.leq=i,this.head=new ZH,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,t,i.key));return i},e.prototype.insertBefore=function(t,i){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,i));var r=new ZH;return r.key=i,r.next=t.next,t.next.prev=r,r.prev=t,t.next=r,r},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),wUe=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.edgeLeq=function(t,i,r){var n=t.event,s=i.eUp,a=r.eUp;if(s.Dst===n)return a.Dst===n?di.vertLeq(s.Org,a.Org)?di.edgeSign(a.Dst,s.Org,a.Org)<=0:di.edgeSign(s.Dst,a.Org,s.Org)>=0:di.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return di.edgeSign(s.Dst,n,s.Org)>=0;var o=di.edgeEval(s.Dst,n,s.Org),l=di.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,i){i.fixUpperEdge&&Ei(i.eUp.winding===0),i.eUp.activeRegion=null,t.dict.delete(i.nodeUp)},e.fixUpperEdge=function(t,i,r){Ei(i.fixUpperEdge),t.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=r,r.activeRegion=i},e.topLeftRegion=function(t,i){var r=i.eUp.Org,n;do i=e.regionAbove(i);while(i.eUp.Org===r);if(i.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(i).eUp.Sym,i.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,i,n),i=e.regionAbove(i)}return i},e.topRightRegion=function(t){var i=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===i);return t},e.addRegionBelow=function(t,i,r){var n=new _I;return n.eUp=r,n.nodeUp=t.dict.insertBefore(i.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,r.activeRegion=n,n},e.isWindingInside=function(t,i){switch(t.windingRule){case Zr.ODD:return(i&1)!==0;case Zr.NONZERO:return i!==0;case Zr.POSITIVE:return i>0;case Zr.NEGATIVE:return i<0;case Zr.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,i){i.windingNumber=e.regionAbove(i).windingNumber+i.eUp.winding,i.inside=e.isWindingInside(t,i.windingNumber)},e.finishRegion=function(t,i){var r=i.eUp,n=r.Lface;n.inside=i.inside,n.anEdge=r,e.deleteRegion(t,i)},e.finishLeftRegions=function(t,i,r){for(var n,s=null,a=i,o=i.eUp;a!==r;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,i,r,n,s,a){var o,l,u,c,h=!0;u=r;do Ei(di.vertLeq(u.Org,u.Dst)),e.addRegionBelow(t,i,u.Sym),u=u.Onext;while(u!==n);for(s===null&&(s=e.regionBelow(i).eUp.Rprev),l=i,c=s;o=e.regionBelow(l),u=o.eUp.Sym,u.Org===c.Org;)u.Onext!==c&&(t.mesh.splice(u.Oprev,u),t.mesh.splice(c.Oprev,u)),o.windingNumber=l.windingNumber-u.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(u,c),e.deleteRegion(t,l),t.mesh.delete(c)),h=!1,l=o,c=u;l.dirty=!0,Ei(l.windingNumber-u.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,i,r){t.mesh.splice(i,r)},e.vertexWeights=function(t,i,r){var n=di.vertL1dist(i,t),s=di.vertL1dist(r,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*i.coords[0]+o*r.coords[0],t.coords[1]+=a*i.coords[1]+o*r.coords[1],t.coords[2]+=a*i.coords[2]+o*r.coords[2]},e.getIntersectData=function(t,i,r,n,s,a){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,e.vertexWeights(i,r,n),e.vertexWeights(i,s,a)},e.checkForRightSplice=function(t,i){var r=e.regionBelow(i),n=i.eUp,s=r.eUp;if(di.vertLeq(n.Org,s.Org)){if(di.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;di.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),i.dirty=r.dirty=!0)}else{if(di.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,i){var r=e.regionBelow(i),n=i.eUp,s=r.eUp,a;if(Ei(!di.vertEq(n.Dst,s.Dst)),di.vertLeq(n.Dst,s.Dst)){if(di.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=i.inside}else{if(di.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;i.dirty=r.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=i.inside}return!0},e.checkForIntersect=function(t,i){var r=e.regionBelow(i),n=i.eUp,s=r.eUp,a=n.Org,o=s.Org,l=n.Dst,u=s.Dst,c,h,d=new y0,f,m;if(Ei(!di.vertEq(u,l)),Ei(di.edgeSign(l,t.event,a)<=0),Ei(di.edgeSign(u,t.event,o)>=0),Ei(a!==t.event&&o!==t.event),Ei(!i.fixUpperEdge&&!r.fixUpperEdge),a===o||(c=Math.min(a.t,l.t),h=Math.max(o.t,u.t),c>h))return!1;if(di.vertLeq(a,o)){if(di.edgeSign(u,a,o)>0)return!1}else if(di.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),di.intersect(l,a,u,o,d),Ei(Math.min(a.t,l.t)<=d.t),Ei(d.t<=Math.max(o.t,u.t)),Ei(Math.min(u.s,l.s)<=d.s),Ei(d.s<=Math.max(o.s,a.s)),di.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),f=di.vertLeq(a,o)?a:o,di.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),di.vertEq(d,a)||di.vertEq(d,o)?(e.checkForRightSplice(t,i),!1):!di.vertEq(l,t.event)&&di.edgeSign(l,t.event,d)>=0||!di.vertEq(u,t.event)&&di.edgeSign(u,t.event,d)<=0?u===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),i=e.topLeftRegion(t,i),n=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),r),e.addRightEdges(t,i,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),r=i,i=e.topRightRegion(i),m=e.regionBelow(i).eUp.Rprev,r.eUp=s.Oprev,s=e.finishLeftRegions(t,r,null),e.addRightEdges(t,i,s.Onext,n.Rprev,m,!0),!0):(di.edgeSign(l,t.event,d)>=0&&(e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),di.edgeSign(u,t.event,d)<=0&&(i.dirty=r.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=d.s,n.Org.t=d.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,u),e.regionAbove(i).dirty=i.dirty=r.dirty=!0,!1)},e.walkDirtyRegions=function(t,i){for(var r=e.regionBelow(i),n,s;;){for(;r.dirty;)i=r,r=e.regionBelow(r);if(!i.dirty&&(r=i,i=e.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,n=i.eUp,s=r.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,i)&&(r.fixUpperEdge?(e.deleteRegion(t,r),t.mesh.delete(s),r=e.regionBelow(i),s=r.eUp):i.fixUpperEdge&&(e.deleteRegion(t,i),t.mesh.delete(n),i=e.regionAbove(r),n=i.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!i.fixUpperEdge&&!r.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,i))return}else e.checkForRightSplice(t,i);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,i),t.mesh.delete(n),i=e.regionAbove(r))}},e.connectRightVertex=function(t,i,r){var n,s=r.Onext,a=e.regionBelow(i),o=i.eUp,l=a.eUp,u=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,i),di.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),i=e.topLeftRegion(t,i),s=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),a),u=!0),di.vertEq(l.Org,t.event)&&(t.mesh.splice(r,l.Oprev),r=e.finishLeftRegions(t,a,null),u=!0),u){e.addRightEdges(t,i,r.Onext,s,s,!0);return}di.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(r.Lprev,n),e.addRightEdges(t,i,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,i)},e.connectLeftDegenerate=function(t,i,r){var n,s,a,o,l;if(n=i.eUp,di.vertEq(n.Org,r)){Ei(!1),e.spliceMergeVertices(t,n,r.anEdge);return}if(!di.vertEq(n.Dst,r)){t.mesh.splitEdge(n.Sym),i.fixUpperEdge&&(t.mesh.delete(n.Onext),i.fixUpperEdge=!1),t.mesh.splice(r.anEdge,n),e.sweepEvent(t,r);return}Ei(!1),i=e.topRightRegion(i),l=e.regionBelow(i),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(Ei(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(r.anEdge,a),di.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,i,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,i){var r,n,s,a,o,l,u=new _I;if(u.eUp=i.anEdge.Sym,r=t.dict.search(u).key,n=e.regionBelow(r),!!n){if(a=r.eUp,o=n.eUp,di.edgeSign(a.Dst,i,a.Org)===0){e.connectLeftDegenerate(t,r,i);return}if(s=di.vertLeq(o.Dst,a.Dst)?r:n,r.inside||s.fixUpperEdge){if(s===r)l=t.mesh.connect(i.anEdge.Sym,a.Lnext);else{var c=t.mesh.connect(o.Dnext,i.anEdge);l=c.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,r,l)),e.sweepEvent(t,i)}else e.addRightEdges(t,r,i.anEdge,i.anEdge,null,!0)}},e.sweepEvent=function(t,i){t.event=i,e.debugEvent(t);for(var r=i.anEdge;r.activeRegion===null;)if(r=r.Onext,r===i.anEdge){e.connectLeftVertex(t,i);return}var n=e.topLeftRegion(t,r.activeRegion);Ei(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,i,r,n){var s=new _I,a=t.mesh.makeEdge();a.Org.s=r,a.Org.t=n,a.Dst.s=i,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new _Ue(t,e.edgeLeq);var i=t.bmax[0]-t.bmin[0],r=t.bmax[1]-t.bmin[1],n=t.bmin[0]-i,s=t.bmax[0]+i,a=t.bmin[1]-r,o=t.bmax[1]+r;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var i,r=0;(i=t.dict.min().key)!==null;)i.sentinel||(Ei(i.fixUpperEdge),Ei(++r===1)),Ei(i.windingNumber===0),e.deleteRegion(t,i)},e.removeDegenerateEdges=function(t){var i,r,n,s=t.mesh.eHead;for(i=s.next;i!==s;i=r)r=i.next,n=i.Lnext,di.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(e.spliceMergeVertices(t,n,i),t.mesh.delete(i),i=n,n=i.Lnext),n.Lnext===i&&(n!==i&&((n===r||n===r.Sym)&&(r=r.next),t.mesh.delete(n)),(i===r||i===r.Sym)&&(r=r.next),t.mesh.delete(i))},e.initPriorityQ=function(t){var i,r,n,s=0;for(n=t.mesh.vHead,r=n.next;r!==n;r=r.next)s++;for(s+=8,i=t.pq=new bUe(s,di.vertLeq),n=t.mesh.vHead,r=n.next;r!==n;r=r.next)r.pqHandle=i.insert(r);return r!==n?!1:(i.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,i){var r,n,s;for(r=i.fHead.next;r!==i.fHead;r=n)n=r.next,s=r.anEdge,Ei(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,i){i===void 0&&(i=!0);var r,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(r=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!di.vertEq(n,r));)n=t.pq.extractMin(),e.spliceMergeVertices(t,r.anEdge,n.anEdge);e.sweepEvent(t,r)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(i&&t.mesh.check(),!0):!1},e}(),EUe=function(){function e(){this.mesh=new XH,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Zr.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},e.prototype.normalize_=function(t){var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),t[0]/=i,t[1]/=i,t[2]/=i},e.prototype.longAxis_=function(t){var i=0;return Math.abs(t[1])>Math.abs(t[0])&&(i=1),Math.abs(t[2])>Math.abs(t[i])&&(i=2),i},e.prototype.computeNormal_=function(t){var i,r,n,s,a,o,l=[0,0,0],u=[0,0,0],c=[0,0,0],h=[0,0,0],d=[0,0,0],f=[null,null,null],m=[null,null,null],g=this.mesh.vHead;i=g.next;for(var y=0;y<3;++y)s=i.coords[y],u[y]=s,m[y]=i,l[y]=s,f[y]=i;for(i=g.next;i!==g;i=i.next)for(var x=0;x<3;++x)s=i.coords[x],s<u[x]&&(u[x]=s,m[x]=i),s>l[x]&&(l[x]=s,f[x]=i);var w=0;if(l[1]-u[1]>l[0]-u[0]&&(w=1),l[2]-u[2]>l[w]-u[w]&&(w=2),u[w]>=l[w]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,r=m[w],n=f[w],c[0]=r.coords[0]-n.coords[0],c[1]=r.coords[1]-n.coords[1],c[2]=r.coords[2]-n.coords[2],i=g.next;i!==g;i=i.next)h[0]=i.coords[0]-n.coords[0],h[1]=i.coords[1]-n.coords[1],h[2]=i.coords[2]-n.coords[2],d[0]=c[1]*h[2]-c[2]*h[1],d[1]=c[2]*h[0]-c[0]*h[2],d[2]=c[0]*h[1]-c[1]*h[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(c)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,i,r=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(i=r.next;i!==r;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,i=[0,0,0],r,n,s=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),s=!0),r=this.sUnit,n=this.tUnit;var a=this.longAxis_(i);r[a]=0,r[(a+1)%3]=1,r[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=i[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,r),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,u=t.next;u!==t;u=u.next)l?(this.bmin[0]=this.bmax[0]=u.s,this.bmin[1]=this.bmax[1]=u.t,l=!1):(u.s<this.bmin[0]&&(this.bmin[0]=u.s),u.s>this.bmax[0]&&(this.bmax[0]=u.s),u.t<this.bmin[1]&&(this.bmin[1]=u.t),u.t>this.bmax[1]&&(this.bmax[1]=u.t))},e.prototype.addWinding_=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,i){var r,n;if(r=i.anEdge,!(r.Lnext!==r&&r.Lnext.Lnext!==r))throw"Mono region invalid";for(;di.vertLeq(r.Dst,r.Org);r=r.Lprev);for(;di.vertLeq(r.Org,r.Dst);r=r.Lnext);n=r.Lprev;for(var s=void 0;r.Lnext!==n;)if(di.vertLeq(r.Dst,n.Org)){for(;n.Lnext!==r&&(di.edgeGoesLeft(n.Lnext)||di.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==r&&(di.edgeGoesRight(r.Lprev)||di.edgeSign(r.Dst,r.Org,r.Lprev.Org)>=0);)s=t.connect(r,r.Lprev),r=s.Sym;r=r.Lnext}if(n.Lnext===r)throw"Mono region invalid";for(;n.Lnext.Lnext!==r;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i)if(i=r.next,r.inside&&!this.tessellateMonoRegion_(t,r))return!1;return!0},e.prototype.discardExterior_=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i)i=r.next,r.inside||t.zapFace(r)},e.prototype.setWindingNumber_=function(t,i,r){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?i:-i:r?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,i,r,n){var s,a=0,o=0,l;r>3&&t.mergeConvexFaces(r);for(var u=t.vHead.next;u!==t.vHead;u=u.next)u.n=-1;for(var c=t.fHead.next;c!==t.fHead;c=c.next)if(c.n=-1,!!c.inside){s=c.anEdge,l=0;do{var u=s.Org;u.n===-1&&(u.n=o,o++),l++,s=s.Lnext}while(s!==c.anEdge);if(l>r)throw"Face vertex greater that support polygon";c.n=a,++a}this.elementCount=a,i===Ds.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*r,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var u=t.vHead.next;u!==t.vHead;u=u.next)if(u.n!==-1){var h=u.n*n;this.vertices[h+0]=u.coords[0],this.vertices[h+1]=u.coords[1],n>2&&(this.vertices[h+2]=u.coords[2]),this.vertexIndices[u.n]=u.idx}for(var d=0,c=t.fHead.next;c!==t.fHead;c=c.next)if(c.inside){s=c.anEdge,l=0;do{var u=s.Org;this.elements[d++]=u.n,l++,s=s.Lnext}while(s!==c.anEdge);for(var f=l;f<r;++f)this.elements[d++]=-1;if(i===Ds.CONNECTED_POLYGONS){s=c.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==c.anEdge);for(var m=l;m<r;++m)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,i){var r,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=r=o.anEdge;do this.vertexCount++,r=r.Lnext;while(r!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,u=0,c=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=r=o.anEdge;do this.vertices[l++]=r.Org.coords[0],this.vertices[l++]=r.Org.coords[1],i>2&&(this.vertices[l++]=r.Org.coords[2]),this.vertexIndices[u++]=this.vertexIdCallback?this.vertexIdCallback(r):r.Org.idx,a++,r=r.Lnext;while(r!==n);this.elements[c++]=s,this.elements[c++]=a,s+=a}},e.prototype.addContour=function(t,i){this.mesh===null&&(this.mesh=new XH),t<2&&(t=2),t>3&&(t=3);for(var r=null,n=0;n<i.length;n+=t)r===null?(r=this.mesh.makeEdge(),this.mesh.splice(r,r.Sym)):(this.mesh.splitEdge(r),r=r.Lnext),r.Org.coords[0]=i[n+0],r.Org.coords[1]=i[n+1],t>2?r.Org.coords[2]=i[n+2]:r.Org.coords[2]=0,r.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(r),r.winding=1,r.Sym.winding=-1},e.prototype.tesselate=function(t,i,r,n,s,a){if(t===void 0&&(t=Zr.ODD),i===void 0&&(i=Ds.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),wUe.computeInterior(this,a);var o=this.mesh;return i===Ds.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),i===Ds.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,i,r,n),!0},e}();function Tp(e){var t=e.windingRule,i=t===void 0?Zr.ODD:t,r=e.elementType,n=r===void 0?Ds.POLYGONS:r,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,u=e.normal,c=u===void 0?[0,0,1]:u,h=e.contours,d=h===void 0?[]:h,f=e.strict,m=f===void 0?!0:f,g=e.debug,y=g===void 0?!1:g;if(!d&&m)throw new Error("Contours can't be empty");if(d){var x=new EUe;e.edgeCreateCallback&&(x.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(x.vertexIdCallback=e.vertexIdCallback);for(var w=0;w<d.length;w++)x.addContour(l||2,d[w]);return x.tesselate(i,n,a,l,c,m),{vertices:x.vertices,vertexIndices:x.vertexIndices,vertexCount:x.vertexCount,elements:x.elements,elementCount:x.elementCount,mesh:y?x.mesh:void 0}}}Zr.ODD;Zr.NONZERO;Zr.POSITIVE;Zr.NEGATIVE;Zr.ABS_GEQ_TWO;Ds.POLYGONS;Ds.CONNECTED_POLYGONS;Ds.BOUNDARY_CONTOURS;var qL=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let i=e*qL.eSize;this.buffer=new ArrayBuffer(i);let r=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*r,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*r,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*r,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let i=e*qL.eSize,r=new ArrayBuffer(i),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(r,s*n,3*e);s+=3*e;let o=new Float32Array(r,s*n,3*e);s+=3*e;let l=new Float32Array(r,s*n,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=r,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let r=this.capacity;for(;t>r;)r*=2;this.realloc(r)}let i=this.size;return this.size=t,i}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},zte=qL;zte.eSize=8*Float32Array.BYTES_PER_ELEMENT;var SUe=class{constructor(e=[],t=(i,r)=>i<r?-1:i>r?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:i}=this,r=t[e];for(;e>0;){let n=e-1>>1,s=t[n];if(i(r,s)>=0)break;t[e]=s,e=n}t[e]=r}_down(e){let{data:t,compare:i}=this,r=this.length>>1,n=t[e];for(;e<r;){let s=(e<<1)+1,a=s+1;if(a<this.length&&i(t[a],t[s])<0&&(s=a),i(t[s],n)>=0)break;t[e]=t[s],e=s}t[e]=n}};function TUe(e,t,i=1,r=!1){let n=1/0,s=1/0,a=-1/0,o=-1/0;for(let[w,b]of e[0])w<n&&(n=w),b<s&&(s=b),w>a&&(a=w),b>o&&(o=b);let l=a-n,u=o-s,c=Math.max(i,Math.min(l,u));if(c===i){let w=[n,s];return w.distance=0,w.distance}let h=new SUe([],(w,b)=>b.max-w.max),d=AUe(e),f=new yA(n+l/2,s+u/2,0,e);f.d>d.d&&(d=f);let m=2;function g(w,b,C){let A=new yA(w,b,C,e);if(m++,A.max>d.d+i&&h.push(A),A.d>d.d&&(d=A,r&&console.log(`found best ${Math.round(1e4*A.d)/1e4} after ${m} probes`),d.d>t))return t}let y=c/2;for(let w=n;w<a;w+=c)for(let b=s;b<o;b+=c)g(w+y,b+y,y);for(;h.length;){let{max:w,x:b,y:C,h:A}=h.pop();if(w-d.d<=i)break;y=A/2,g(b-y,C-y,y),g(b+y,C-y,y),g(b-y,C+y,y),g(b+y,C+y,y)}r&&console.log(`num probes: ${m}
best distance: ${d.d}`);let x=[d.x,d.y];return x.distance=d.d,x.distance}function yA(e,t,i,r){this.x=e,this.y=t,this.h=i,this.d=CUe(e,t,r),this.max=this.d+this.h*Math.SQRT2}function CUe(e,t,i){let r=!1,n=1/0;for(let s of i)for(let a=0,o=s.length,l=o-1;a<o;l=a++){let u=s[a],c=s[l];u[1]>t!=c[1]>t&&e<(c[0]-u[0])*(t-u[1])/(c[1]-u[1])+u[0]&&(r=!r),n=Math.min(n,MUe(e,t,u,c))}return n===0?0:(r?1:-1)*Math.sqrt(n)}function AUe(e){let t=0,i=0,r=0,n=e[0];for(let a=0,o=n.length,l=o-1;a<o;l=a++){let u=n[a],c=n[l],h=u[0]*c[1]-c[0]*u[1];i+=(u[0]+c[0])*h,r+=(u[1]+c[1])*h,t+=h*3}let s=new yA(i/t,r/t,0,e);return t===0||s.d<0?new yA(n[0][0],n[0][1],0,e):s}function MUe(e,t,i,r){let n=i[0],s=i[1],a=r[0]-n,o=r[1]-s;if(a!==0||o!==0){let l=((e-n)*a+(t-s)*o)/(a*a+o*o);l>1?(n=r[0],s=r[1]):l>0&&(n+=a*l,s+=o*l)}return a=e-n,o=t-s,a*a+o*o}var QB={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Fte={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Ute={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},wI=(e,t)=>([i,r])=>(r<i&&(r+=t),(e>=i?e:e+t)<=r),JB=class extends ai{constructor(e,t,i=0,r=12,n=3,s=Zr.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=r,this._bevelSegmentsInput=n;let o=this._shape.extractShapePointsToFlatArray([],r),l=this._shape.shapeHoles.map(I=>{let D=I.extractShapePointsToFlatArray([],r),k=[];for(let B=D.length-1;B>=1;B-=2){let z=D[B-1],W=D[B-0];k.push(z,W)}return k}),u=[],c=[];for(let I=0;I<o.length;I+=2)c.push([o[I],o[I+1]]);u.push(c);for(let I=0;I<l.length;I++){let D=l[I],k=[];for(let B=0;B<D.length;B+=2)k.push([D[B],D[B+1]]);u.push(k)}let h;e.isText?h=new yB().setFromPoints(e.points.map(I=>I.position)).getSize(new Ie).length()*.1:u[0].length===0?h=i:i>0?h=TUe(u,i):h=1e-5,i<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(i,h,t/2),this._bevelSegments=Math.floor(n));let d;try{d=Tp({windingRule:s,elementType:Ds.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{d=QB}let f;try{f=Tp({windingRule:Zr.ODD,elementType:Ds.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{f=Fte}if(!d)throw new Error("error generating geometry");let m=d.elementCount;if(f){d.elementCount+=f.elementCount;for(let I=0;I<f.elements.length;I++){let D=f.elements[I],k=I%2===0?d.vertexCount:0;d.elements.push(D+k)}for(let I=0;I<f.vertexIndices.length;I++){let D=f.vertexIndices[I],k=d.vertexCount;d.vertexIndices.push(D+k)}for(let I=0;I<f.vertices.length;I++){let D=f.vertices[I];d.vertices.push(D)}}let g=1/0,y=-1/0,x=1/0,w=-1/0;for(let I=0,D=d.vertexCount;I<D;I++){let k=I*2,B=d.vertices[k+0],z=d.vertices[k+1];B<g&&(g=B),B>y&&(y=B),z<x&&(x=z),z>w&&(w=z)}this._minX=g,this._minY=x,this._width=y-g,this._height=w-x,this._buffer=new zte(this._computeBufferEstimatedSize(d));let b=[],C=[];for(let I=d.elementCount-1;I>=0;I--){let D=I>=m,k=I*2,B=d.elements[k+0],z=d.elements[k+1],W=B+z,$={start:B,count:z,normals:[],continuous:[],concave:[]},Z=B,G=W-1,V=B+1,J=this._shape.roundedCurves.length;do{let ve=Z-B,_e=d.vertices[G*2+0],he=d.vertices[G*2+1],De=d.vertices[Z*2+0],we=d.vertices[Z*2+1],Le=d.vertices[V*2+0],Te=d.vertices[V*2+1],ke=De-_e,Xe=we-he,et=Math.sqrt(ke*ke+Xe*Xe);ke/=et,Xe/=et;let Ze=De-Le,st=we-Te,_t=Math.sqrt(Ze*Ze+st*st);Ze/=_t,st/=_t,$.normals[ve*2+0]=-st,$.normals[ve*2+1]=Ze,$.concave[ve]=ke*st-Xe*Ze>0;let St=d.vertexIndices[Z];if(Array.isArray(St))$.continuous[ve]=!1;else{let[ue,Ee]=this._shape.getCurveIndexFromVertexId(St-1,!0);if(Ee>0&&Ee<1)$.continuous[ve]=!0;else{let Ae=Ee===1?ue+1:ue-1;Ae=(Ae+J)%J;let Ge=Ee===1?0:1,ae=this._shape.roundedCurves[ue].getTangent(Ee),te=this._shape.roundedCurves[Ae].getTangent(Ge);$.continuous[ve]=ae.dot(te)>.95}}D&&($.normals[ve*2+0]*=-1,$.normals[ve*2+1]*=-1),[G,Z,V]=[Z,V,V+1],V>=W&&(V-=z)}while(V!==B+1);let U=[];U.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(B*2,W*2),vertexCount:z,vertexIndices:new Array(z).fill(!0).map((ve,_e)=>[_e,_e]),elements:[0,z],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(B*2,W*2)});let ie=0;for(let ve=1;ve<=this._bevelSegments;ve++){let _e=ve/this._bevelSegments*Math.PI/2,he=(1-Math.cos(_e))*this._bevel,De=[],we=[],Le=0;for(let ke=0;ke<z;ke++){let Xe=ke*2,et=(ke-1+z)%z*2,Ze=d.vertices[$.start*2+Xe+0],st=d.vertices[$.start*2+Xe+1],_t=-$.normals[et+0]*he,St=-$.normals[et+1]*he,ue=-$.normals[Xe+0]*he,Ee=-$.normals[Xe+1]*he;if($.concave[ke]||!$.concave[ke]&&D){let Ae=Math.atan2(St,_t),Ge=Math.atan2(Ee,ue);Ge>Ae&&(Ge-=Math.PI*2);let ae=Ge-Ae;if($.continuous[ke]||D){let te=Ae+ae/2,Ne=Math.cos(te)*he,Re=Math.sin(te)*he;De[2*Le+0]=Ze+Ne*(D?-1:1),De[2*Le+1]=st+Re*(D?-1:1),we[Le]=ke,Le++}else{let te=Math.max(1,Math.floor(r/4*Math.abs(ae)/Math.PI));for(let Ne=0;Ne<=te;Ne++){let Re=Ae+ae*(Ne/te),Y=Math.cos(Re)*he,Me=Math.sin(Re)*he;De[2*Le+0]=Ze+Y,De[2*Le+1]=st+Me,we[Le]=ke,Le++}}}else De[2*Le+0]=Ze+_t,De[2*Le+1]=st+St,we[Le]=ke,Le++,De[2*Le+0]=Ze,De[2*Le+1]=st,we[Le]=ke,Le++,De[2*Le+0]=Ze+ue,De[2*Le+1]=st+Ee,we[Le]=ke,Le++}let Te=Tp({windingRule:Zr.POSITIVE,elementType:Ds.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[De],edgeCreateCallback:ke=>{let Xe=ke.Org.idx,et=we[Xe],Ze=we[(Xe+1)%we.length];ke.idx=[et,Ze],ke.Sym.idx=[Ze,et]},vertexIdCallback:ke=>{let Xe=ke.Lprev.idx;return[Xe?Xe[1]:0,ke.idx?ke.idx[0]:0]}});if(!Te)throw console.log("Error"),new Error(`error generating bevel geometry for ${ve}'th loop`);if(!Te.vertexCount){let ke=(ve-1)/this._bevelSegments*Math.PI/2;ie=(1-Math.sin(ke))*this._bevel;break}for(let ke=0;ke<Te.vertexIndices.length;ke++){let[Xe,et]=Te.vertexIndices[ke];if(Xe===et)continue;let Ze=et;et<Xe&&(Ze+=z);for(let st=Xe;st<Ze;st++){let _t=st%z,St=(st+1)%z;if(!$.continuous[_t]||!$.continuous[St]){Te.vertexIndices[ke]=[Xe,_t],Te.vertexIndices.splice(ke+1,0,[St,et]),Te.vertices.splice((ke+1)*2,0,Te.vertices[ke*2],Te.vertices[ke*2+1]);break}}}U.push({bevelI:ve,angle:_e,size:he,boundary:Te,reverseMap:we,insetPoints:De})}let se=(ve,_e,he)=>{let De=0,we=ve.boundary.vertexIndices.length;for(;De<we&&he(ve.boundary.vertexIndices[_e]);)_e=(_e+1)%we,De++;return De},ee=b.length;for(let ve=1;ve<U.length;ve++){let _e=U[ve-1],he=U[ve],De=_e.boundary.vertexIndices.length,we=he.boundary.vertexIndices.length;if(!De||!we)break;let Le=$.concave.length,Te=0,ke=wI(Te,z);for(;!_e.boundary.vertexIndices.filter(ke).length||!he.boundary.vertexIndices.filter(ke).length;)Te++,ke=wI(Te,z);let Xe=_e.boundary.vertexIndices.findIndex(ke),et=he.boundary.vertexIndices.findIndex(ke);do Xe=(Xe+1)%De;while(ke(_e.boundary.vertexIndices[Xe]));do et=(et+1)%we;while(ke(he.boundary.vertexIndices[et]));Te=(Te+1)%z;let Ze=Te,st=0,_t=this._buildBevelVert($,_e,(Xe-1+De)%De,void 0,st),St=this._buildBevelVert($,he,(et-1+we)%we,void 0,st),ue=_t,Ee=St,Ae,Ge,ae=!1;do{st=(Te||Le)/Le,ke=wI(Te,z);let te=se(_e,Xe,ke),Ne=se(he,et,ke),Re=ae;if(ae=!1,te&&!Ne){for(let Y=0;Y<te;Y++)Ae=this._buildBevelVert($,_e,(Xe+Y)%De,Y/(te-1),st),b.push(ue.topN,Ae.topP,Ee.topN),a===!1&&b.push(Ae.bottomP,ue.bottomN,Ee.bottomN),ue=Ae;ae=!0}else if(!te&&Ne)for(let Y=0;Y<Ne;Y++)Ge=this._buildBevelVert($,he,(et+Y)%we,Y/(Ne-1),st),b.push(Ee.topN,ue.topP,Ge.topP),a===!1&&b.push(ue.bottomP,Ee.bottomN,Ge.bottomP),Ee=Ge;else if(te&&Ne)if(Ae=this._buildBevelVert($,_e,Xe,0,st),Ge=this._buildBevelVert($,he,et,0,st),Re?(b.push(ue.topN,Ge.topP,Ee.topN),b.push(ue.topN,Ae.topP,Ge.topP),a===!1&&(b.push(Ge.bottomP,ue.bottomN,Ee.bottomN),b.push(Ge.bottomP,Ae.bottomP,ue.bottomN))):(b.push(Ee.topN,ue.topN,Ae.topP),b.push(Ee.topN,Ae.topP,Ge.topP),a===!1&&(b.push(Ae.bottomP,ue.bottomN,Ee.bottomN),b.push(Ae.bottomP,Ee.bottomN,Ge.bottomP))),ue=Ae,Ee=Ge,te===Ne)for(let Y=1;Y<te;Y++)Ae=this._buildBevelVert($,_e,(Xe+Y)%De,Y/(te-1),st),Ge=this._buildBevelVert($,he,(et+Y)%we,Y/(Ne-1),st),b.push(ue.topN,Ae.topP,Ee.topN),b.push(Ee.topN,Ae.topP,Ge.topP),a===!1&&(b.push(Ae.bottomP,ue.bottomN,Ee.bottomN),b.push(Ae.bottomP,Ee.bottomN,Ge.bottomP)),ue=Ae,Ee=Ge;else if(te>Ne){let Y=te/Ne,Me=0;for(let Ke=1;Ke<te;Ke++)Ae=this._buildBevelVert($,_e,(Xe+Ke)%De,Ke/(te-1),st),b.push(ue.topN,Ae.topP,Ee.topN),a===!1&&b.push(Ae.bottomP,ue.bottomN,Ee.bottomN),ue=Ae,Ke>(Me+1)*Y&&(Me++,Ge=this._buildBevelVert($,he,(et+Me)%we,Me/(Ne-1),st),b.push(Ee.topN,Ae.topP,Ge.topP),a===!1&&b.push(Ae.bottomP,Ee.bottomN,Ge.bottomP),Ee=Ge)}else{let Y=Ne/te,Me=0;for(let Ke=1;Ke<Ne;Ke++)Ge=this._buildBevelVert($,he,(et+Ke)%we,Ke/(Ne-1),st),b.push(Ee.topN,Ae.topP,Ge.topP),a===!1&&b.push(Ae.bottomP,Ee.bottomN,Ge.bottomP),Ee=Ge,Ke>(Me+1)*Y&&(Me++,Ae=this._buildBevelVert($,_e,(Xe+Me)%De,Me/(te-1),st),b.push(ue.topN,Ae.topP,Ee.topN),a===!1&&b.push(Ae.bottomP,ue.bottomN,Ee.bottomN),ue=Ae)}Xe=(Xe+te)%De,et=(et+Ne)%we,Te=(Te+1)%Le}while(Te!==Ze)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(U,$,b),D){let ve=[];for(let _e=b.length-1;_e>=ee+2;_e-=3){let he=b[_e-2],De=b[_e-1],we=b[_e-0];ve.push(we,De,he)}b.splice(ee,b.length-ee,...ve)}if(D){let ve=[];for(let _e=U[U.length-1].boundary.vertices.length-1;_e>=1;_e-=2){let he=U[U.length-1].boundary.vertices[_e-1],De=U[U.length-1].boundary.vertices[_e-0];ve.push(he,De)}C.push(ve)}if(!D){let ve=U[U.length-1],_e;try{_e=Tp({windingRule:U.length>1?Zr.POSITIVE:Zr.ODD,elementType:Ds.POLYGONS,vertexSize:2,strict:!0,contours:[ve.insetPoints,...C]})}catch{_e=Ute}if(!_e)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<h&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let he=0;he<_e.elementCount*3;he+=3){let De=this._buildSurfaceVert(_e,_e.elements[he+0],ie),we=this._buildSurfaceVert(_e,_e.elements[he+1],ie),Le=this._buildSurfaceVert(_e,_e.elements[he+2],ie);b.push(De.top,we.top,Le.top),a===!1&&b.push(Le.bottom,we.bottom,De.bottom)}}this.vertexCache={}}this._buffer.shrink();let A=new gi(Uint32Array.from(b),1),E=new gi(this._buffer.positions,3),_=new gi(this._buffer.normals,3),P=new gi(this._buffer.uvs,2);E.needsUpdate=!0,_.needsUpdate=!0,P.needsUpdate=!0,A.needsUpdate=!0,this.setAttribute("position",E),this.setAttribute("normal",_),this.setAttribute("uv",P),this.setIndex(A)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let r=e[0];for(let n=0,s=r.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,r,n),o=this._buildBevelVert(t,r,(n+1)%s);i.push(o.topP,a.topN,a.bottomN),i.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,i){let r=t.toString();if(r in this.vertexCache)return this.vertexCache[r];let n=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(n-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),u=l*3,c=l*2,h={top:l+0,bottom:l+1};return this._buffer.positions[u+0]=n,this._buffer.positions[u+1]=s,this._buffer.positions[u+2]=this.forPathBevel?this._bevel:this._depth-i,this._buffer.normals[u+0]=0,this._buffer.normals[u+1]=0,this._buffer.normals[u+2]=1,this._buffer.uvs[c+0]=a,this._buffer.uvs[c+1]=o,this.forPathBevel===!1&&(this._buffer.positions[u+3]=n,this._buffer.positions[u+4]=s,this._buffer.positions[u+5]=i,this._buffer.normals[u+3]=0,this._buffer.normals[u+4]=0,this._buffer.normals[u+5]=-1,this._buffer.uvs[c+2]=a,this._buffer.uvs[c+3]=o),this.vertexCache[r]=h,h}_buildBevelVert(e,t,i,r=1,n){let s=`${t.bevelI}:${i}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[i],l,u,c,h;a!==o?(u=a,l=o,h=!1,c=e.continuous[u]&&e.continuous[l]):(l=a,u=(l-1+e.count)%e.count,h=e.concave[l]&&t.bevelI>0,c=e.continuous[l]||h);let d=Math.cos(t.angle),f=Math.sin(t.angle),m=i*2,g=l*2,y=u*2,x=t.boundary.vertices[m+0],w=t.boundary.vertices[m+1],b=(1-f)*this._bevel,C=(x-this._minX)/this._width,A=(w-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(C=n),A=1);let E=e.normals[g+0],_=e.normals[g+1],P=e.normals[y+0],I=e.normals[y+1];if(h){let W=P-E,$=I-_;E=E+W*(1-r),_=_+$*(1-r);let Z=Math.sqrt(E*E+_*_);E/=Z,_/=Z}let D=this.forPathBevel?this._buffer.get(c?1:2):this._buffer.get(c?2:4),k=D*3,B=D*2,z={i,fi:l,topP:D+0,topN:D+0,bottomP:D+1,bottomN:D+1,pathBevelUCoord:n};return this._buffer.positions[k+0]=x,this._buffer.positions[k+1]=w,this._buffer.positions[k+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[k+0]=E*d,this._buffer.normals[k+1]=_*d,this._buffer.normals[k+2]=f,this._buffer.uvs[B+0]=C,this._buffer.uvs[B+1]=A,this.forPathBevel===!1&&(this._buffer.positions[k+3]=x,this._buffer.positions[k+4]=w,this._buffer.positions[k+5]=b,this._buffer.normals[k+3]=E*d,this._buffer.normals[k+4]=_*d,this._buffer.normals[k+5]=-f,this._buffer.uvs[B+2]=A,this._buffer.uvs[B+3]=C),c||(this.forPathBevel?(D+=1,k+=3,B+=2):(D+=2,k+=6,B+=4),z.topP=D+0,z.bottomP=D+1,this._buffer.positions[k+0]=x,this._buffer.positions[k+1]=w,this._buffer.positions[k+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[k+0]=P*d,this._buffer.normals[k+1]=I*d,this._buffer.normals[k+2]=f,this._buffer.uvs[B+0]=C,this._buffer.uvs[B+1]=A,this.forPathBevel===!1&&(this._buffer.positions[k+3]=x,this._buffer.positions[k+4]=w,this._buffer.positions[k+5]=b,this._buffer.normals[k+3]=P*d,this._buffer.normals[k+4]=I*d,this._buffer.normals[k+5]=-f,this._buffer.uvs[B+2]=A,this._buffer.uvs[B+3]=C)),this.vertexCache[s]=z,z}clone(){let e=new JB(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=IM(this.userData),e}},jte=class extends ai{constructor(e,t=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=Zr.ODD,this.elementType=Ds.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Zr.ODD,elementType:Ds.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let r=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,u;for(let d=0,f=r.length/2;d<f;d++){let m=d*2,g=r[m+0],y=r[m+1];if(l!==void 0&&g!==l&&(a=!1),u!==void 0&&y!==u&&(o=!1),l=g,u=y,!a&&!o)break}if(!a&&!o)try{s=Tp({contours:[r,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=QB}let c=(s==null?void 0:s.vertexCount)??1,h=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new gi(new Float32Array(c*3),3),this._normalAttribute=new gi(new Float32Array(c*3),3),this._uvAttribute=new gi(new Float32Array(c*2),2),this._indexAttribute=new gi(new Uint32Array(h*3),1),s){let d=1/0,f=-1/0,m=1/0,g=-1/0;for(let w=0,b=c;w<b;w++){let C=w*2,A=s.vertices[C+0],E=s.vertices[C+1];A<d&&(d=A),A>f&&(f=A),E<m&&(m=E),E>g&&(g=E)}let y=f-d,x=g-m;for(let w=0,b=c;w<b;w++){let C=w*2,A=s.vertices[C+0],E=s.vertices[C+1],_=(A-d)/y,P=(E-m)/x;this._positionAttribute.setXYZ(w,A,E,0),this._normalAttribute.setXYZ(w,0,0,1),this._uvAttribute.setXY(w,_,P)}for(let w=0,b=h;w<b;w++){let C=w*3,A=s.elements[C+0],E=s.elements[C+1],_=s.elements[C+2];this._indexAttribute.setX(C+0,A),this._indexAttribute.setX(C+1,E),this._indexAttribute.setX(C+2,_)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new jte(this._shape,this._curveSegments);return e.userData=IM(this.userData),e}},Vte=class extends JB{constructor(e,t,i=0,r=12,n=3,s=Zr.ODD){super(e,t,i,r,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let r=e[0];for(let n=0,s=r.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,r,n),o=this._buildBevelVert(t,r,(n+1)%s);i.push(o.topP,a.topN,a.bottomN),i.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new Vte(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=IM(this.userData),e}},dv=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var u,c;let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Zr.ODD},e.parameters),r=Math.abs(i.width),n=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),a=e.shape??(t==null?void 0:t.shape),o=(a==null?void 0:a.roundness)??i.roundness;a!==void 0&&(a instanceof Jn?(a.width!==r||a.height!==n)&&a.applySize(r,n):a=new Jn(r,n).fromJSON(a),((u=e.parameters)==null?void 0:u.roundness)!==void 0&&((c=e.parameters)==null?void 0:c.roundness)>0&&a.update());let l=a??new Jn(r,n);return{parameters:Object.assign(i,{width:r,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:i,extrudeBevelSegments:r,subdivisions:n,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new jte(e.shape,n,{windingRule:a}):o=new Vte(e.shape,t,i,n,r,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},Hte=Math.PI*2,ez=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return i.angle=Xt.clamp(i.angle,0,360),{shape:e.shape&&e.shape instanceof Jn?e.shape:new Jn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:r,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,u=e.shape,c=t*.5,h=i*.5,d=PUe(u,c,h,n*Math.PI/180,r,s);u.isClosed=!0,u.update();let f;return n===0?(f=new ai,f.setAttribute("position",new Vt([],3))):f=dv.create({shape:u,parameters:{subdivisions:d,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}}),Object.assign(f,{userData:{...e,type:"EllipseGeometry"}})}};function PUe(e,t,i,r,n,s){if(r>=Hte)return n>30||n%4===0?(IUe(e,t,i,s),Math.round(n/4)):QH(e,r,n,t,i,s);r=Math.max(r,.001);let a={x:0,y:i},o=r+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*i},u=xUe({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:i,largeArcFlag:r>Math.PI,sweepFlag:!0});return n>30||n%u.length===0?DUe(e,a.x,a.y,u,n,t,i,s):QH(e,r,n,t,i,s)}function DUe(e,t,i,r,n,s,a,o){let l=Math.round(n/r.length);e.addPoint(hy(t,i));for(let u=0,c=r.length;u<c;u++){let h=r[u],d=e.points[u],f=hy(h.x,h.y);d.controls[1].position.set(h.x1,h.y1),f.controls[0].position.set(h.x2,h.y2),e.addPoint(f)}return o>0?Wte(e,s,a,o):e.addPoint(hy(0,0)),l}function QH(e,t,i,r,n,s){let a=-t/i;for(let o=0;o<=i;o++){let l=a*o,u=Math.sin(l)*r,c=Math.cos(l)*n;e.addPoint(hy(u,c))}return t<Hte?s>0?Wte(e,r,n,s):e.addPoint(hy(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&Gte(e,r,n,s)),1}function IUe(e,t,i,r=0,n=0,s=0){let a=.5522847498,o=t*a,l=i*a;e.addPoint(cS(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(cS(n,s+i,n-o,s+i,n+o,s+i)),e.addPoint(cS(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(cS(n,s-i,n+o,s-i,n-o,s-i)),r>0&&Gte(e,t,i,r)}function hy(e,t){return new cy(Xt.generateUUID(),new Ie(e,t))}function cS(e,t,i,r,n,s){let a=hy(e,t);return a.controls[0].position.set(i,r),a.controls[1].position.set(n,s),a}function Wte(e,t,i,r){qte(e,t,i,r).forEach(n=>e.addPoint(n))}function Gte(e,t,i,r){let n=qte(e,t,i,r),s=new Jn;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function qte(e,t,i,r){let n=r*t/100,s=n*(Math.abs(i)/Math.abs(t)),a=new Ie(n/t,s/i),o=e.points.map(l=>{let u=l.clone();return u.uuid=Xt.generateUUID(),u}).reverse();return o.forEach(l=>{l.position.multiply(a);let u=l.controls[0].position.clone().multiply(a),c=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(c),l.controls[1].position.copy(u)}),o}var OUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),r=Math.abs(i.width),n=Math.abs(i.height??r),s=Math.abs(i.depth??r),a=Math.abs(Math.min(r,s))/2;return{parameters:Object.assign(i,{width:r,height:n,depth:s,radius:a,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(e){let{width:t,height:i,depth:r,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:u,cornerRadius:c,cornerSegments:h}=e.parameters,d=new Yte(!1,t,i,r,n,s,a,o,l,u,c,h);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},EI=new sy([0,0,0],1),Yte=class extends ai{constructor(e=!0,t=1,i=1,r=1,n=1,s=1,a=1,o=1,l=1,u=1,c=1,h=1){if(super(),s===0)return;let d=e&&s===1;d&&(h=0),c>100&&(c=100),c===0&&(h=0);let f=()=>new q,m=new q,g=f(),y=f(),x=f(),w,b,C,A,E,_,P,I,D=f(),k=f(),B=f(),z=f(),W=f(),$=f(),Z=f(),G=f(),V=i-2*o+.001,J=V/s,U=Math.ceil(a*s),ie=U+1,se=V/U,ee=-V/2,ve=u+1,_e=2*Math.PI/u,he=Math.PI/2/h,De=.01,we=Math.min((1-c/100)*o,o-De),Le=o-we,Te=0,ke=2,Xe=h*ke+ke,et=ve*Xe/ke,Ze=et+ve*ie,st=Math.max(0,ve*(ie+Xe)),[_t,St,ue]=[3,3,2].map(qe=>Array(st*qe).fill(0)),Ee=[],Ae=n-o;function Ge(qe,It){let Ot=Math.PI/2;_=It*se,I=2*Math.PI*(_%J)/J+Ot,_+=ee,P=Math.sin(I)*Ae,E=Math.cos(I)*Ae,e?qe.set(E,P,_):qe.set(E,_,P)}Ge(m,-1e-10),Ge(g,0),D.copy(m),Ge(m,1);let ae=m.distanceTo(g),te=d?0:Le+we,Ne=ae*U+2*te,Re=we,Y=Ne-te;for(let qe=0;qe<=U;qe++){Ge(y,qe),G.subVectors(y,D).normalize(),D.copy(y),$.copy(y).setComponent(+e+1,0).normalize(),Z.crossVectors(G,$).normalize();let It=qe===0,Ot=qe===U,Dt=It?3*Math.PI/2:he,kt=It?Re:Y,Qe=It?ve:Ze,mt=It?0:st-ve,Ht=G.clone().multiplyScalar(It?-Le:Le).add(y),Wt=G.clone().multiplyScalar(It?-1:1).normalize();for(let Ue=0;Ue<ve;Ue++){let dt=Ue*_e;if(k.addVectors(m.copy($).multiplyScalar(o*Math.cos(dt)),g.copy(Z).multiplyScalar(o*Math.sin(dt))),B.copy(k).normalize(),It||Ot){d||(Te=mt+Ue,[0,1,2].forEach(gt=>{_t[Te*3+gt]=Ht.getComponent(gt),St[Te*3+gt]=Wt.getComponent(gt)}),ue[Te*2]=+Ot,ue[Te*2+1]=Ue/u),g.copy(B).multiplyScalar(we),x.addVectors(y,g);for(let gt=0;gt<h;gt++){let Bt=gt*he+Dt;z.addVectors(m.copy(G).multiplyScalar(Le*Math.sin(Bt)),g.copy(B).multiplyScalar(Le*Math.cos(Bt))),W.copy(z).normalize(),g.addVectors(x,z),z.normalize(),Te=Qe+gt*ve+Ue,[0,1,2].forEach(zi=>{_t[Te*3+zi]=g.getComponent(zi),St[Te*3+zi]=W.getComponent(zi)});let ei=+It+Math.sin(Bt);ue[Te*2]=(kt+Le*ei)/Ne,ue[Te*2+1]=Ue/u}}g.addVectors(y,k),Te=et+qe*ve+Ue,[0,1,2].forEach(gt=>{_t[Te*3+gt]=g.getComponent(gt),St[Te*3+gt]=B.getComponent(gt)}),ue[Te*2]=(te+qe*ae)/Ne,ue[Te*2+1]=Ue/u}}let Me=ie+2*h+ke,[Ke,ot]=[+d,Me-1];for(let qe=Ke;qe<=ot-1;qe++){let It=d&&qe===ot-1;for(let Ot=0;Ot<ve-1;Ot++)w=qe*ve+Ot,b=w+1,C=(It?Ot:w)+ve,A=(It?Ot+1:b)+ve,qe===0?Ee.push(b,A,C):qe===Me-2?Ee.push(w,b,C):Ee.push(w,b,C,b,A,C)}this.setIndex(Ee),this.setAttribute("position",new Vt(_t,3)),this.setAttribute("normal",new Vt(St,3)),this.setAttribute("uv",new Vt(ue,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),i=e.radialSegments+1,r=Array.from(this.getIndex().array),n,s,a,o,l=6*(t-1)*e.radialSegments,u=t,c=u===t;for(let h=0;h<e.radialSegments;h++)n=u*i+h,s=n+1,a=(c?h:n)+i,o=(c?h+1:s)+i,r[l++]=n,r[l++]=s,r[l++]=a,r[l++]=s,r[l++]=o,r[l++]=a;return r.length=l,EI.array=r,EI.count=r.length,EI}},RUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new Xte(t*.5,s,a):new GJ(t*.5,n);return o.scale(1,i/t,r/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},Xte=class extends KB{constructor(e=1,t=.2,i=4){let r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,i),this.type=a}static fromJSON(e){return new Xte(e.radius,e.corner,e.cornerSides)}},LUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r;(((r=e.parameters)==null?void 0:r.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{points:t,segments:i,verticalSegments:r}=e.parameters,n=new NC;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new FJ(n.extractPoints(r).shape,i);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},Kc=new Pt,SI=new qr,hS=new q,xA=class extends qa{constructor(){super(),this.uuid=Xt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new Is().getNormalMatrix(e);for(let i=0,r=this.vertices.length;i<r;i++)this.vertices[i].applyMatrix4(e);for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Kc.makeRotationX(e),this.applyMatrix4(Kc),this}rotateY(e){return Kc.makeRotationY(e),this.applyMatrix4(Kc),this}rotateZ(e){return Kc.makeRotationZ(e),this.applyMatrix4(Kc),this}translate(e,t,i){return Kc.makeTranslation(e,t,i),this.applyMatrix4(Kc),this}scale(e,t,i){return Kc.makeScale(e,t,i),this.applyMatrix4(Kc),this}lookAt(e){return SI.lookAt(e),SI.updateMatrix(),this.applyMatrix4(SI.matrix),this}fromBufferGeometry(e){let t=this,i=e.index!==null?e.index:void 0,r=e.attributes;if(r.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=r.position,s=r.normal,a=r.color,o=r.uv,l=r.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<n.count;h++)t.vertices.push(new q().fromBufferAttribute(n,h)),a!==void 0&&t.colors.push(new mi().fromBufferAttribute(a,h));function u(h,d,f,m){let g=a===void 0?[]:[t.colors[h].clone(),t.colors[d].clone(),t.colors[f].clone()],y=s===void 0?[]:[new q().fromBufferAttribute(s,h),new q().fromBufferAttribute(s,d),new q().fromBufferAttribute(s,f)],x=new YL(h,d,f,y,g,m);t.faces.push(x),o!==void 0&&t.faceVertexUvs[0].push([new Ie().fromBufferAttribute(o,h),new Ie().fromBufferAttribute(o,d),new Ie().fromBufferAttribute(o,f)]),l!==void 0&&t.faceVertexUvs[1].push([new Ie().fromBufferAttribute(l,h),new Ie().fromBufferAttribute(l,d),new Ie().fromBufferAttribute(l,f)])}let c=e.groups;if(c.length>0)for(let h=0;h<c.length;h++){let d=c[h],f=d.start,m=d.count;for(let g=f,y=f+m;g<y;g+=3)i!==void 0?u(i.getX(g),i.getX(g+1),i.getX(g+2),d.materialIndex):u(g,g+1,g+2,d.materialIndex)}else if(i!==void 0)for(let h=0;h<i.count;h+=3)u(i.getX(h),i.getX(h+1),i.getX(h+2));else for(let h=0;h<n.count;h+=3)u(h,h+1,h+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(hS).negate(),this.translate(hS.x,hS.y,hS.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,i=t===0?1:1/t,r=new Pt;return r.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(r),this}computeFaceNormals(){let e=new q,t=new q;for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let i=0,r=this.vertices.length;i<r;i++)t[i]=new q;if(e){let i=new q,r=new q;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],u=this.vertices[a.c];i.subVectors(u,l),r.subVectors(o,l),i.cross(r),t[a.a].add(i),t[a.b].add(i),t[a.c].add(i)}}else{this.computeFaceNormals();for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let i=0,r=this.vertices.length;i<r;i++)t[i].normalize();for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let i=this.faces[e],r=i.vertexNormals;r.length===3?(r[0].copy(i.normal),r[1].copy(i.normal),r[2].copy(i.normal)):(r[0]=i.normal.clone(),r[1]=i.normal.clone(),r[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,i=this.faces.length;t<i;t++){let r=this.faces[t];r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]);for(let n=0,s=r.vertexNormals.length;n<s;n++)r.__originalVertexNormals[n]?r.__originalVertexNormals[n].copy(r.vertexNormals[n]):r.__originalVertexNormals[n]=r.vertexNormals[n].clone()}let e=new xA;e.faces=this.faces;for(let t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new q,u={a:new q,b:new q,c:new q};n.push(l),s.push(u)}}let r=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=r.faceNormals[n],l=r.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,i=this.faces.length;t<i;t++){let r=this.faces[t];r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xs),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Rl),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,i=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let r,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,u=this.colors,c=e.colors;t!==void 0&&(r=new Is().getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let f=a[h].clone();t!==void 0&&f.applyMatrix4(t),s.push(f)}for(let h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(let h=0,d=l.length;h<d;h++){let f=l[h],m,g,y=f.vertexNormals,x=f.vertexColors,w=new YL(f.a+n,f.b+n,f.c+n);w.normal.copy(f.normal),r!==void 0&&w.normal.applyMatrix3(r).normalize();for(let b=0,C=y.length;b<C;b++)m=y[b].clone(),r!==void 0&&m.applyMatrix3(r).normalize(),w.vertexNormals.push(m);w.color.copy(f.color);for(let b=0,C=x.length;b<C;b++)g=x[b],w.vertexColors.push(g.clone());w.materialIndex=f.materialIndex+i,o.push(w)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let f=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let m=0,g=f.length;m<g;m++){let y=f[m],x=[];for(let w=0,b=y.length;w<b;w++)x.push(y[w].clone());this.faceVertexUvs[h].push(x)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},i=[],r=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let u=this.vertices[o],c=Math.round(u.x*n)+"_"+Math.round(u.y*n)+"_"+Math.round(u.z*n);t[c]===void 0?(t[c]=o,i.push(this.vertices[o]),r[o]=i.length-1):r[o]=r[t[c]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let u=this.faces[o];u.a=r[u.a],u.b=r[u.b],u.c=r[u.c];let c=[u.a,u.b,u.c];for(let h=0;h<3;h++)if(c[h]===c[(h+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let u=0,c=this.faceVertexUvs.length;u<c;u++)this.faceVertexUvs[u].splice(l,1)}let a=this.vertices.length-i.length;return this.vertices=i,a}setFromPoints(e){this.vertices=[];for(let t=0,i=e.length;t<i;t++){let r=e[t];this.vertices.push(new q(r.x,r.y,r.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function i(o,l){return o.materialIndex-l.materialIndex}e.sort(i);let r=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;r&&r.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(r[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let m in f)f[m]!==void 0&&(e[m]=f[m]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let m=this.vertices[f];t.push(m.x,m.y,m.z)}let i=[],r=[],n={},s=[],a={},o=[],l={};for(let f=0;f<this.faces.length;f++){let m=this.faces[f],g=!0,y=!1,x=this.faceVertexUvs[0][f]!==void 0,w=m.normal.length()>0,b=m.vertexNormals.length>0,C=m.color.r!==1||m.color.g!==1||m.color.b!==1,A=m.vertexColors.length>0,E=0;if(E=u(E,0,0),E=u(E,1,g),E=u(E,2,y),E=u(E,3,x),E=u(E,4,w),E=u(E,5,b),E=u(E,6,C),E=u(E,7,A),i.push(E),i.push(m.a,m.b,m.c),i.push(m.materialIndex),x){let _=this.faceVertexUvs[0][f];i.push(d(_[0]),d(_[1]),d(_[2]))}if(w&&i.push(c(m.normal)),b){let _=m.vertexNormals;i.push(c(_[0]),c(_[1]),c(_[2]))}if(C&&i.push(h(m.color)),A){let _=m.vertexColors;i.push(h(_[0]),h(_[1]),h(_[2]))}}function u(f,m,g){return g?f|1<<m:f&~(1<<m)}function c(f){let m=f.x.toString()+f.y.toString()+f.z.toString();return n[m]!==void 0||(n[m]=r.length/3,r.push(f.x,f.y,f.z)),n[m]}function h(f){let m=f.r.toString()+f.g.toString()+f.b.toString();return a[m]!==void 0||(a[m]=s.length,s.push(f.getHex())),a[m]}function d(f){let m=f.x.toString()+f.y.toString();return l[m]!==void 0||(l[m]=o.length/2,o.push(f.x,f.y)),l[m]}return e.data={},e.data.vertices=t,e.data.normals=r,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=i,e}clone(){return new xA().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let i=e.colors;for(let h=0,d=i.length;h<d;h++)this.colors.push(i[h].clone());let r=e.faces;for(let h=0,d=r.length;h<d;h++)this.faces.push(r[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let f=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let m=0,g=f.length;m<g;m++){let y=f[m],x=[];for(let w=0,b=y.length;w<b;w++){let C=y[w];x.push(C.clone())}this.faceVertexUvs[h].push(x)}}let n=e.morphTargets;for(let h=0,d=n.length;h<d;h++){let f={};if(f.name=n[h].name,n[h].vertices!==void 0){f.vertices=[];for(let m=0,g=n[h].vertices.length;m<g;m++)f.vertices.push(n[h].vertices[m].clone())}if(n[h].normals!==void 0){f.normals=[];for(let m=0,g=n[h].normals.length;m<g;m++)f.normals.push(n[h].normals[m].clone())}this.morphTargets.push(f)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let f={};if(s[h].vertexNormals!==void 0){f.vertexNormals=[];for(let m=0,g=s[h].vertexNormals.length;m<g;m++){let y=s[h].vertexNormals[m],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),f.vertexNormals.push(x)}}if(s[h].faceNormals!==void 0){f.faceNormals=[];for(let m=0,g=s[h].faceNormals.length;m<g;m++)f.faceNormals.push(s[h].faceNormals[m].clone())}this.morphNormals.push(f)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new NUe().fromGeometry(this),t=new ai,i=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",dS.call(new gi(i,3),e.vertices)),e.normals.length>0){let r=new Float32Array(e.normals.length*3);t.setAttribute("normal",dS.call(new gi(r,3),e.normals))}if(e.colors.length>0){let r=new Float32Array(e.colors.length*3);t.setAttribute("color",JH.call(new gi(r,3),e.colors))}if(e.uvs.length>0){let r=new Float32Array(e.uvs.length*2);t.setAttribute("uv",eW.call(new gi(r,2),e.uvs))}if(e.uvs2.length>0){let r=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",eW.call(new gi(r,2),e.uvs2))}t.groups=e.groups;for(let r in e.morphTargets){let n=[],s=e.morphTargets[r];for(let a=0,o=s.length;a<o;a++){let l=s[a],u=new Vt(l.data.length*3,3);u.name=l.name,n.push(dS.call(u,l.data))}t.morphAttributes[r]=n}if(e.skinIndices.length>0){let r=new Vt(e.skinIndices.length*4,4);t.setAttribute("skinIndex",tW.call(r,e.skinIndices))}if(e.skinWeights.length>0){let r=new Vt(e.skinWeights.length*4,4);t.setAttribute("skinWeight",tW.call(r,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new ai,i=e.geometry;if(e.isPoints||e.isLine){let r=new Vt(i.vertices.length*3,3),n=new Vt(i.colors.length*3,3);if(t.setAttribute("position",dS.call(r,i.vertices)),t.setAttribute("color",JH.call(n,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let s=new Vt(i.lineDistances.length,1);t.setAttribute("lineDistance",kUe.call(s,i.lineDistances))}i.boundingSphere!==null&&(t.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(t.boundingBox=i.boundingBox.clone())}else e.isMesh&&(t=i.toBufferGeometry());return t}};xA.prototype.isGeometry=!0;var NUe=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],i,r,n,s=e.faces;for(r=0;r<s.length;r++){let a=s[r];a.materialIndex!==n&&(n=a.materialIndex,i!==void 0&&(i.count=r*3-i.start,t.push(i)),i={start:r*3,materialIndex:n})}i!==void 0&&(i.count=r*3-i.start,t.push(i)),this.groups=t}fromGeometry(e){let t=e.faces,i=e.vertices,r=e.faceVertexUvs,n=r[0]&&r[0].length>0,s=r[1]&&r[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let y=0;y<o;y++)l[y]={name:a[y].name,data:[]};this.morphTargets.position=l}let u=e.morphNormals,c=u.length,h;if(c>0){h=[];for(let y=0;y<c;y++)h[y]={name:u[y].name,data:[]};this.morphTargets.normal=h}let d=e.skinIndices,f=e.skinWeights,m=d.length===i.length,g=f.length===i.length;i.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let y=0;y<t.length;y++){let x=t[y];this.vertices.push(i[x.a],i[x.b],i[x.c]);let w=x.vertexNormals;if(w.length===3)this.normals.push(w[0],w[1],w[2]);else{let C=x.normal;this.normals.push(C,C,C)}let b=x.vertexColors;if(b.length===3)this.colors.push(b[0],b[1],b[2]);else{let C=x.color;this.colors.push(C,C,C)}if(n===!0){let C=r[0][y];C!==void 0?this.uvs.push(C[0],C[1],C[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",y),this.uvs.push(new Ie,new Ie,new Ie))}if(s===!0){let C=r[1][y];C!==void 0?this.uvs2.push(C[0],C[1],C[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",y),this.uvs2.push(new Ie,new Ie,new Ie))}for(let C=0;C<o;C++){let A=a[C].vertices;l[C].data.push(A[x.a],A[x.b],A[x.c])}for(let C=0;C<c;C++){let A=u[C].vertexNormals[y];h[C].data.push(A.a,A.b,A.c)}m&&this.skinIndices.push(d[x.a],d[x.b],d[x.c]),g&&this.skinWeights.push(f[x.a],f[x.b],f[x.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},YL=class{constructor(e,t,i,r,n,s=0){this.a=e,this.b=t,this.c=i,this.normal=r&&r.isVector3?r:new q,this.vertexNormals=Array.isArray(r)?r:[],this.color=n&&n.isColor?n:new mi,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function kUe(e){return this.array.set(e),this}function JH(e){let t=this.array,i=0;for(let r=0,n=e.length;r<n;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new mi),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this}function eW(e){let t=this.array,i=0;for(let r=0,n=e.length;r<n;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new Ie),t[i++]=s.x,t[i++]=s.y}return this}function dS(e){let t=this.array,i=0;for(let r=0,n=e.length;r<n;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new q),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this}function tW(e){let t=this.array,i=0;for(let r=0,n=e.length;r<n;r++){let s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new Pi),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this}var BUe=["a","b","c"];function zUe(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function TI(e,t,i){let r=Math.min(e,t),n=Math.max(e,t),s=r+"_"+n;return i.get(s)}function CI(e,t,i,r,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,u;if(r.has(l))u=r.get(l);else{let c=i[a],h=i[o];u={a:c,b:h,newEdge:null,faces:[]},r.set(l,u)}u.faces.push(n),s[e].edges.push(u),s[t].edges.push(u)}function FUe(e,t,i,r){let n,s,a;for(n=0,s=e.length;n<s;n++)i[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],CI(a.a,a.b,e,r,a,i),CI(a.b,a.c,e,r,a,i),CI(a.c,a.a,e,r,a,i)}function fS(e,t,i,r,n){e.push(new YL(t,i,r,void 0,void 0,n))}function Jv(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function pS(e,t,i,r){e.push([t.clone(),i.clone(),r.clone()])}var UUe=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof ai?e=new xA().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new q,i,r,n,s,a,o=e.vertices,l=e.faces,u=e.faceVertexUvs[0],c=u!==void 0&&u.length>0,h=[],d=new Map;FUe(o,l,h,d);let f=[],m,g,y,x,w,b,C;for(let De of Array.from(d.keys())){for(g=d.get(De),y=new q,w=3/8,b=1/8,C=g.faces.length,C!=2&&(w=.5,b=0,C!=1),y.addVectors(g.a,g.b).multiplyScalar(w),t.set(0,0,0),s=0;s<C;s++){for(x=g.faces[s],a=0;a<3&&(m=o[zUe(x,BUe[a])],!(m!==g.a&&m!==g.b));a++);m&&t.add(m)}t.multiplyScalar(b),y.add(t),g.newEdge=f.length,f.push(y)}let A,E,_,P,I,D,k,B=[];for(r=0,n=o.length;r<n;r++){for(D=o[r],I=h[r].edges,i=I.length,i==3?A=3/16:i>3&&(A=3/(8*i)),E=1-i*Number(A),_=A,i<=2&&(i==2?(E=3/4,_=1/8):i==1||i==0),k=D.clone().multiplyScalar(E),t.set(0,0,0),s=0;s<i;s++)P=I[s],m=P.a!==D?P.a:P.b,t.add(m);t.multiplyScalar(Number(_)),k.add(t),B.push(k)}let z=B.concat(f),W=B.length,$,Z,G,V=[],J=[],U,ie,se,ee,ve=new Ie,_e=new Ie,he=new Ie;for(r=0,n=l.length;r<n;r++)x=l[r],$=Number(TI(x.a,x.b,d).newEdge)+W,Z=Number(TI(x.b,x.c,d).newEdge)+W,G=Number(TI(x.c,x.a,d).newEdge)+W,fS(V,$,Z,G,x.materialIndex),fS(V,x.a,$,G,x.materialIndex),fS(V,x.b,Z,$,x.materialIndex),fS(V,x.c,G,Z,x.materialIndex),c&&(U=u[r],ie=U[0],se=U[1],ee=U[2],ve.set(Jv(ie.x,se.x),Jv(ie.y,se.y)),_e.set(Jv(se.x,ee.x),Jv(se.y,ee.y)),he.set(Jv(ie.x,ee.x),Jv(ie.y,ee.y)),pS(J,ve,_e,he),pS(J,ie,ve,he),pS(J,se,_e,ve),pS(J,ee,he,_e));e.vertices=z,e.faces=V,c&&(e.faceVertexUvs[0]=J)}},js=new q,jUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=e.geometry??(t==null?void 0:t.geometry)??new ai().copy(new Dc(100,100,100)),r;t===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(js),r={width:js.x,height:js.y,depth:js.z,subdivisions:0}):r=t.parameters;let n={...r,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:i}}static build(e){let{width:t,height:i,depth:r,subdivisions:n}=e.parameters,s=e.geometry??new ai().copy(new Dc(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(js)):js.set(a.width,a.height,a.depth),(t!==js.x||i!==js.y||r!==js.z)&&s.scale(js.x===0?1:t/js.x,js.y===0?1:i/js.y,js.z===0?1:r/js.z);let o=s.originalGeometry;try{n>0?(o===void 0||(a==null?void 0:a.subdivisions)!==n)&&(o===void 0&&(o=s),s=new UUe(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,i){new eee(i).load(e,r=>{let n=this.normalizeInputs({geometry:r});r.boundingBox.getSize(js);let s=100/js.x;Object.assign(n.parameters,{width:100,height:js.y*s,depth:js.z*s}),t(this.build(n))})}},Kte=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Jn?e.shape:new Jn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:r,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,u=t*.5,c=i*.5,h=0,d=0,f=2*Math.PI/r;for(let g=0;g<r;g++){let y=f*g,x=h+Math.sin(y)*u,w=d+Math.cos(y)*c;l.addPoint(l.createPoint(x,w))}l.isClosed=!0;for(let g=0,y=l.points.length;g<y;g++)l.points[g].roundness=n;l.roundness=n,l.update();let m=dv.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(m,{userData:{...e,type:"PolygonGeometry"}})}},VUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,u=new WUe(t*.5,i,n,s,a,o,l);return u.scale(1,1,r/t),Object.assign(u,{userData:{...e,type:"PyramidGeometry"}})}};function fx(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function AI(e,t,i,r,n,s){let a=t.clone().sub(e),o=i.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),r===n){let u=a.add(o).normalize();s.copy(e).addScaledVector(u,r/Math.sin(l/2))}else{let u=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(u)),s.addScaledVector(o,r/Math.sin(u))}}function HUe(e,t,i){let r=e.clone().sub(t),n=i.clone().sub(t);return r.projectOnVector(n),r.add(t)}var WUe=class extends ai{constructor(e=.5,t=1,i=4,r=1,n=!1,s=0,a=4){super(),i=Math.floor(Math.max(3,i)),r=Math.floor(r),a=Math.floor(a);let o=[],l=[],u=[],c=[],h=0,d=t/2,f=Math.PI/i,m=e*Math.cos(Math.PI/i),g=2*Math.PI/i,y=(i-2)*Math.PI/i,x=Math.PI-y,w=new q(0,-d,0),b=new q(0,d,0),C=new Ie(e,-d),A=new Ie(m,-d),E=new Ie(0,b.y).sub(A),_=new Ie(0,b.y).sub(C),P=new Ie(E.y,-E.x).normalize(),I=new Ie(_.y,-_.x).normalize(),D=e*Math.cos(Math.PI/i)*Math.tan((Math.PI-E.angle())/2)-1e-8;s=Math.min(s,D);let k;{let G=new q(P.x,P.y,0),V=new q(Math.cos(g)*G.x,G.y,Math.sin(g)*G.x);k=G.angleTo(V)}let B=s/Math.tan((Math.PI-E.angle())/2),z=s/Math.tan((Math.PI-k)/2),W=new q;if(!n){l.push(w.x,w.y,w.z),u.push(0,-1,0),c.push(0,0);let G=h++,V=[],J=C.clone(),U=B/Math.cos(Math.PI/i);J.x-=U;for(let ie=0;ie<i;ie++){let se=ie/i*Math.PI*2+f,ee=new Ie(Math.sin(se),Math.cos(se));fx(J,ee,W),l.push(W.x,W.y,W.z),u.push(0,-1,0),c.push(0,0),V.push(h++)}for(let ie=0;ie<V.length;ie++)o.push(V[ie],G,V[(ie+1)%V.length])}{let G=new q,V=new q,J=new q,U=new q,ie=new q,se=new q;for(let ee=0;ee<i;ee++){let ve=ee/i*Math.PI*2+f,_e=(ee+.5)/i*Math.PI*2+f,he=(ee+1)/i*Math.PI*2+f,De=new Ie(Math.sin(ve),Math.cos(ve)),we=new Ie(Math.sin(_e),Math.cos(_e)),Le=new Ie(Math.sin(he),Math.cos(he));fx(C,De,V),fx(C,Le,J),fx(P,we,G),AI(b,V,J,z,z,U),l.push(U.x,U.y,U.z),AI(V,b,J,z,B,ie),l.push(ie.x,ie.y,ie.z),AI(J,V,b,B,z,se),l.push(se.x,se.y,se.z),u.push(G.x,G.y,G.z),u.push(G.x,G.y,G.z),u.push(G.x,G.y,G.z),c.push(0,0),c.push(0,0),c.push(0,0);let Te=h++,ke=h++,Xe=h++;if(o.push(Te,ke,Xe),s>0){{let st=V.clone().add(J).multiplyScalar(.5),_t=b.clone().sub(st).normalize(),St=w.clone().sub(st).normalize().add(_t).normalize().multiplyScalar(-1),ue=se.clone().sub(ie);$(st,ue,St,E.angle())}let et,Ze;{let st=new q;fx(I,Le,st);let _t=se.clone().add(U).multiplyScalar(.5);_t=HUe(_t,J,b);let St=se.clone().sub(U);[et,Ze]=$(_t,St,st,k,U.y)}{let st=et,_t=st.clone().setY(0).normalize(),St=new q(0,-1,0),ue=_t.clone().cross(St);Z(st,_t,St,ue)}{let st=E.angle(),_t=Math.PI-st,St=b.clone();St.y-=s/Math.sin(st-Math.PI/2);let ue=new q,Ee=[];for(let Ge=0;Ge<a;Ge++){let ae=[],te=Math.PI/2-_t*Ge/a,Ne=Math.cos(te),Re=Math.sin(te),Y=_e;for(let Me=0;Me<=Ge;Me++){let Ke=Math.cos(Y),ot=Math.sin(Y);G.x=Ne*ot,G.y=Re,G.z=Ne*Ke,ue.copy(St).addScaledVector(G,s),l.push(ue.x,ue.y,ue.z),u.push(G.x,G.y,G.z),c.push(0,0),ae.push(h++),Y+=Math.PI*2/Ge/i}Ee.push(ae)}Ze.reverse(),Ee.push(Ze);let Ae=Ee.length-1;for(let Ge=0;Ge<Ae;Ge++){let ae=Ee[Ge],te=Ee[Ge+1],Ne=ae.length-1;o.push(te[1],ae[0],te[0]);for(let Re=1;Re<=Ne;Re++)o.push(ae[Re],ae[Re-1],te[Re]),o.push(te[Re+1],ae[Re],te[Re])}}}}}this.setIndex(o),this.setAttribute("position",new Vt(l,3)),this.setAttribute("normal",new Vt(u,3)),this.setAttribute("uv",new Vt(c,2));function $(G,V,J,U,ie){let se=-U/2,ee=(Math.PI-U)/2,ve=V.clone().normalize().cross(J);G.addScaledVector(J,-s/Math.sin(ee));let _e=new q,he=new q,De=1,we=h,Le=[];for(let Te=0;Te<=a;Te++){let ke=se+Te/a*U;he.set(0,0,0),he.addScaledVector(ve,Math.sin(ke)),he.addScaledVector(J,Math.cos(ke));for(let Xe=0;Xe<=De;Xe++){let et=Xe/De-.5;if(_e.copy(G),_e.addScaledVector(V,et),_e.addScaledVector(he,s),ie!=null){let Ze=Math.max(0,_e.y-ie);_e.addScaledVector(V,-Ze/V.y)}l.push(_e.x,_e.y,_e.z),u.push(he.x,he.y,he.z),c.push(0,0),Xe===0&&Le.push(h),h++}}for(let Te=0;Te<a;Te++)for(let ke=0;ke<De;ke++){let Xe=we+ke+(De+1)*Te,et=Xe+(De+1),Ze=et+1,st=Xe+1;o.push(Xe,et,st),o.push(et,Ze,st)}return[G.clone().addScaledVector(V,.5),Le]}function Z(G,V,J,U){let ie=Math.PI/2,se=_.angle()-ie,ee=[],ve=new q,_e=new q;for(let De=0;De<=a;De++){let we=[],Le=De/a;for(let Te=0;Te<=De;Te++){let ke=((De?Te/De:0)-.5)*x,Xe=Math.cos(ke),et=Math.sin(ke),Ze=Math.atan(Math.tan(se)*Xe),st=(ie+Ze)*Le,_t=Math.cos(st),St=Math.sin(st);ve.set(0,0,0),ve.addScaledVector(V,St*Xe),ve.addScaledVector(J,_t),ve.addScaledVector(U,St*et),_e.copy(G).addScaledVector(ve,s),l.push(_e.x,_e.y,_e.z),u.push(ve.x,ve.y,ve.z),c.push(0,0),we.push(h++)}ee.push(we)}let he=ee.length-1;for(let De=0;De<he;De++){let we=ee[De],Le=ee[De+1],Te=we.length-1;o.push(we[0],Le[1],Le[0]);for(let ke=1;ke<=Te;ke++)o.push(we[ke-1],we[ke],Le[ke]),o.push(we[ke],Le[ke+1],Le[ke])}}}},tz=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),r=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Jn?e.shape:new Jn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:r}}static build(e){let t=e.shape,{width:i,height:r,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,u={x:i*.5,y:r*.5},c={x:-u.x,y:-u.y},h={x:u.x,y:u.y};function d(C,A,E){return A>i&&E>r?Math.min(C*i/A,C*r/E):A>i?C*i/A:E>r?C*r/E:C}let f=[];f[0]=n[0]===0?0:d(n[0],n[0]+n[3],n[0]+n[1]),f[1]=n[1]===0?0:d(n[1],n[1]+n[2],n[1]+n[0]),f[2]=n[2]===0?0:d(n[2],n[2]+n[1],n[2]+n[3]),f[3]=n[3]===0?0:d(n[3],n[3]+n[0],n[3]+n[2]);let m=c.x,g=h.x,y=h.y,x=c.y;t.addPoint(t.createPoint(m,y)),t.addPoint(t.createPoint(g,y)),t.addPoint(t.createPoint(g,x)),t.addPoint(t.createPoint(m,x)),t.isClosed=!0;let w=!0;for(let C=0,A=t.points.length;C<A;C++)t.points[C].roundness=f[C],C>0&&f[C]!==f[C-1]&&(w=!1);w&&(t.roundness=f[0]),t.useCubicForRoundedCorners=s!==1,t.update();let b=dv.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(b,{userData:{...e,type:"RectangleGeometry"}})}},GUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return i.thetaLength=Xt.clamp(i.thetaLength,0,180),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t=100,height:i=t,depth:r=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:u}=e.parameters,c;return u===0?(c=new ai,c.setAttribute("position",new Vt([],3))):c=new ay(.5*t,n,s,a,o,l,u*Xt.DEG2RAD),c.scale(1,i/t,r/t),Object.assign(c,{userData:{...e,type:"SphereGeometry"}})}},qUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(e){let{width:t=100,height:i=t,widthSegments:r=8,heightSegments:n=8}=e.parameters,s=new Nh(t,i,r,n);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},YUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new XUe(t,i,r,n,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},XUe=class extends ai{constructor(e=1,t=1,i=1,r=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],u=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),r=Math.min(180-u,r),r*=Math.PI/180;let c=[],h=Math.PI/2,d=(De=0,we=0,Le=0)=>new q(De,we,Le),f=d(),m=d(),[g,y,x]=[t/2,e/2,i/2],w=-y,b=+y,[C,A,E]=[d(w,-g,+x),d(w,-g,-x),d(w,+g,-x)],_=(De,we=!1)=>Math.sin(De-Math.PI/(1+ +we)),P=(De,we=!1)=>Math.cos(De-Math.PI/(1+ +we));E.y=Math.sin(r)*t-g;let I=Math.cos(r)*t-x,D=C.z-u;r<=h?(E.z=Math.min(I,D),E.z==D&&(E.y-=(I-D)/Math.tan(h-r))):A.z=Math.min(A.z-I-x,C.z-u),f.subVectors(C,A),m.subVectors(E,A);let k=Math.min(f.length(),m.length())*n/100,B=k*Math.tan(r/2),z=k/Math.cos(r/2),W=f.clone().normalize().add(m.normalize()).setLength(z).add(A);f.set(0,_(r,!0),P(r,!0)),c.push([E,f.clone()]);let $=(Math.PI-r)/s;for(let De=0;De<=s;De++){let we=h+r+De*$;f.set(0,Math.sin(we)*B,Math.cos(we)*B),f.add(W),m.set(0,_(we),P(we)),c.push([f.clone(),m.clone()])}c.push([C,d(0,1,0)]);let Z=Math.sin($/2)*B*2,G=c.length-1,V=c[0][0].distanceTo(c[1][0]),J=c[G-1][0].distanceTo(c[G][0]),U=V+Z*s+J;c[0].push(1);for(let De=0;De<=s;De++)c[De+1].push(1-(V+De*Z)/U);c[G].push(0);let[ie,se,ee]=c[0],ve,_e,he;for(let De=1;De<c.length;De++)[ve,_e,he]=c[De],a.push(w,ie.y,ie.z,w,ve.y,ve.z,b,ie.y,ie.z,b,ie.y,ie.z,w,ve.y,ve.z,b,ve.y,ve.z),o.push(0,se.y,se.z,0,_e.y,_e.z,0,se.y,se.z,0,se.y,se.z,0,_e.y,_e.z,0,_e.y,_e.z),l.push(0,ee,0,he,1,ee,1,ee,0,he,1,he),[ie,se,ee]=[ve,_e,he];this.setAttribute("position",new Vt(a,3)),this.setAttribute("normal",new Vt(o,3)),this.setAttribute("uv",new Vt(l,2))}},$te=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Jn?e.shape:new Jn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,innerRadiusPercent:r,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:u}=e.parameters,c=e.shape,h=t*.5,d=i*.5,f=0,m=0,g=a*Math.PI/360/n,y=Math.PI/2*3*-1,x=h*r/100,w=d*r/100;if(n===3&&r===50){g=2*Math.PI/n;for(let C=0;C<n;C++){let A=g*C,E=f+Math.sin(A)*h,_=m+Math.cos(A)*d;c.addPoint(c.createPoint(E,_))}}else for(let C=0;C<n;C++){let A=f+Math.cos(y)*h,E=m+Math.sin(y)*d;c.addPoint(c.createPoint(A,E)),y+=g,A=f+Math.cos(y)*x,E=m+Math.sin(y)*w,c.addPoint(c.createPoint(A,E)),y+=g}c.isClosed=!0;for(let C=0,A=c.points.length;C<A;C++)c.points[C].roundness=s;c.roundness=s,c.update();let b=dv.create({shape:c,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:u}});return Object.assign(b,{userData:{...e,type:"StarGeometry"}})}},KUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i}=e.parameters,r=new Nh(t,i);return Object.assign(r,{userData:{...e,type:"TextFrameGeometry"}})}},$Ue=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),r=Math.abs(i.width),n=Math.abs(i.height??i.width);i.shapeBlendNode&&(n=r);let s=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:r,height:n,depth:s})}}static build(e){let{width:t,height:i,depth:r,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,u=ZUe(t,i,r,t*.5,a,s,0,0,n,o,l);return u.scale(1,i/t,1),Object.assign(u,{userData:{...e,type:"TorusGeometry"}})}};function ZUe(e,t,i,r,n,s,a,o,l,u,c){[t,i]=[i,t],a=t/2;let h=Xt.clamp(n/360,0,1);if(h===0){let d=new ai;return d.setAttribute("position",new Vt([],3)),d}return h===1&&(u=0),new Yte(!0,e,t,i,r,h,s,a,o,l,u,c)}var QUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(e){let{width:t,tube:i,tubularSegments:r,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==i&&(o-=i);let l=new YJ(o,i,r,n,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},JUe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Jn?e.shape:new Jn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t=100,height:i,cornerRadius:r,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,u=t*.5,c=i*.5;o?(l.addPoint(l.createPoint(-u,c)),l.addPoint(l.createPoint(u,-c)),l.addPoint(l.createPoint(-u,-c))):(l.addPoint(l.createPoint(0,c)),l.addPoint(l.createPoint(u,-c)),l.addPoint(l.createPoint(-u,-c))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=r;l.roundness=r,l.update();let h=dv.create({shape:l,parameters:{roundness:r,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(h,{userData:{...e,type:"TriangleGeometry"}})}};function e6e(e,t){let i=2*Math.PI;return(e%i+i)%i===(t%i+i)%i}function t6e(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())}function i6e(e,t,i){let r,n,s,a=Math.floor(e*6),o=e*6-a,l=i*(1-t),u=i*(1-o*t),c=i*(1-(1-o)*t);switch(a%6){case 0:r=i,n=c,s=l;break;case 1:r=u,n=i,s=l;break;case 2:r=l,n=i,s=c;break;case 3:r=l,n=u,s=i;break;case 4:r=c,n=l,s=i;break;case 5:default:r=i,n=l,s=u;break}return{r:r*255,g:n*255,b:s*255}}function r6e(e,t,i){e/=255,t/=255,i/=255;let r=Math.max(e,t,i),n=Math.min(e,t,i),s=r,a=r-n,o=r==0?0:a/r,l;if(r==n)l=0;else{switch(r){case e:l=(t-i)/a+(t<i?6:0);break;case t:l=(i-e)/a+2;break;case i:default:l=(e-t)/a+4;break}l/=6}return{h:l,s:o,v:s}}function n6e(e){return e=Math.floor(e),{r:e>>16&255,g:e>>8&255,b:e&255}}function s6e(e,t,i){return(e<<16)+(t<<8)+i}function a6e(e,t,i){return e=Math.round(e),t=Math.round(t),i=Math.round(i),"#"+[e,t,i].map(r=>r.toString(16).padStart(2,"0")).join("").toUpperCase()}function o6e(e){let t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(r,n,s,a)=>String(n+n+s+s+a+a));let i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}var l6e={parseRgba:t6e,hsvToRgb:i6e,rgbToHsv:r6e,hexToRgb:n6e,rgbToHex:s6e,rgbToHexString:a6e,hexStringToRgb:o6e},u6e=class{add(e,t,i){if(typeof arguments[0]!="string")for(let r in arguments[0])this.add(r,arguments[0][r],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(r){this[r]=this[r]||[],t&&this[r][i?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(i){i.call(t&&t.context?t.context:t,t)})}},c6e=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},yt=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+yt.version}static addUnaryOp(t){return yt.max_unop_len=Math.max(t.length,yt.max_unop_len),yt.unary_ops[t]=1,yt}static addBinaryOp(t,i,r){return yt.max_binop_len=Math.max(t.length,yt.max_binop_len),yt.binary_ops[t]=i,r?yt.right_associative.add(t):yt.right_associative.delete(t),yt}static addIdentifierChar(t){return yt.additional_identifier_chars.add(t),yt}static addLiteral(t,i){return yt.literals[t]=i,yt}static removeUnaryOp(t){return delete yt.unary_ops[t],t.length===yt.max_unop_len&&(yt.max_unop_len=yt.getMaxKeyLen(yt.unary_ops)),yt}static removeAllUnaryOps(){return yt.unary_ops={},yt.max_unop_len=0,yt}static removeIdentifierChar(t){return yt.additional_identifier_chars.delete(t),yt}static removeBinaryOp(t){return delete yt.binary_ops[t],t.length===yt.max_binop_len&&(yt.max_binop_len=yt.getMaxKeyLen(yt.binary_ops)),yt.right_associative.delete(t),yt}static removeAllBinaryOps(){return yt.binary_ops={},yt.max_binop_len=0,yt}static removeLiteral(t){return delete yt.literals[t],yt}static removeAllLiterals(){return yt.literals={},yt}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(t){this.expr=t,this.index=0}static parse(t){return new yt(t).parse()}static getMaxKeyLen(t){return Math.max(0,...Object.keys(t).map(i=>i.length))}static isDecimalDigit(t){return t>=48&&t<=57}static binaryPrecedence(t){return yt.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!yt.binary_ops[String.fromCharCode(t)]||yt.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return yt.isIdentifierStart(t)||yt.isDecimalDigit(t)}throwError(t){let i=new Error(t+" at character "+this.index);throw i.index=this.index,i.description=t,i}runHook(t,i){if(yt.hooks[t]){let r={context:this,node:i};return yt.hooks.run(t,r),r.node}return i}searchHook(t){if(yt.hooks[t]){let i={context:this};return yt.hooks[t].find(function(r){return r.call(i.context,i),i.node}),i.node}}gobbleSpaces(){let t=this.code;for(;t===yt.SPACE_CODE||t===yt.TAB_CODE||t===yt.LF_CODE||t===yt.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let t=this.gobbleExpressions(),i=t.length===1?t[0]:{type:yt.COMPOUND,body:t};return this.runHook("after-all",i)}gobbleExpressions(t){let i=[],r,n;for(;this.index<this.expr.length;)if(r=this.code,r===yt.SEMCOL_CODE||r===yt.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())i.push(n);else if(this.index<this.expr.length){if(r===t)break;this.throwError('Unexpected "'+this.char+'"')}return i}gobbleExpression(){let t=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",t)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,yt.max_binop_len),i=t.length;for(;i>0;){if(yt.binary_ops.hasOwnProperty(t)&&(!yt.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!yt.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=i,t;t=t.substr(0,--i)}return!1}gobbleBinaryExpression(){let t,i,r,n,s,a,o,l,u;if(a=this.gobbleToken(),!a||(i=this.gobbleBinaryOp(),!i))return a;for(s={value:i,prec:yt.binaryPrecedence(i),right_a:yt.right_associative.has(i)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+i),n=[a,s,o];i=this.gobbleBinaryOp();){if(r=yt.binaryPrecedence(i),r===0){this.index-=i.length;break}s={value:i,prec:r,right_a:yt.right_associative.has(i)},u=i;let c=h=>s.right_a&&h.right_a?r>h.prec:r<=h.prec;for(;n.length>2&&c(n[n.length-2]);)o=n.pop(),i=n.pop().value,a=n.pop(),t={type:yt.BINARY_EXP,operator:i,left:a,right:o},n.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+u),n.push(s,t)}for(l=n.length-1,t=n[l];l>1;)t={type:yt.BINARY_EXP,operator:n[l-1].value,left:n[l-2],right:t},l-=2;return t}gobbleToken(){let t,i,r,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(t=this.code,yt.isDecimalDigit(t)||t===yt.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===yt.SQUOTE_CODE||t===yt.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(t===yt.OBRACK_CODE)n=this.gobbleArray();else{for(i=this.expr.substr(this.index,yt.max_unop_len),r=i.length;r>0;){if(yt.unary_ops.hasOwnProperty(i)&&(!yt.isIdentifierStart(this.code)||this.index+i.length<this.expr.length&&!yt.isIdentifierPart(this.expr.charCodeAt(this.index+i.length)))){this.index+=r;let s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:yt.UNARY_EXP,operator:i,argument:s,prefix:!0})}i=i.substr(0,--r)}yt.isIdentifierStart(t)?(n=this.gobbleIdentifier(),yt.literals.hasOwnProperty(n.name)?n={type:yt.LITERAL,value:yt.literals[n.name],raw:n.name}:n.name===yt.this_str&&(n={type:yt.THIS_EXP})):t===yt.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let i=this.code;for(;i===yt.PERIOD_CODE||i===yt.OBRACK_CODE||i===yt.OPAREN_CODE||i===yt.QUMARK_CODE;){let r;if(i===yt.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==yt.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),i=this.code}this.index++,i===yt.OBRACK_CODE?(t={type:yt.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},this.gobbleSpaces(),i=this.code,i!==yt.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):i===yt.OPAREN_CODE?t={type:yt.CALL_EXP,arguments:this.gobbleArguments(yt.CPAREN_CODE),callee:t}:(i===yt.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),t={type:yt.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),r&&(t.optional=!0),this.gobbleSpaces(),i=this.code}return t}gobbleNumericLiteral(){let t="",i,r;for(;yt.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(this.code===yt.PERIOD_CODE)for(t+=this.expr.charAt(this.index++);yt.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(i=this.char,i==="e"||i==="E"){for(t+=this.expr.charAt(this.index++),i=this.char,(i==="+"||i==="-")&&(t+=this.expr.charAt(this.index++));yt.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);yt.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+t+this.char+")")}return r=this.code,yt.isIdentifierStart(r)?this.throwError("Variable names cannot start with a number ("+t+this.char+")"):(r===yt.PERIOD_CODE||t.length===1&&t.charCodeAt(0)===yt.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:yt.LITERAL,value:parseFloat(t),raw:t}}gobbleStringLiteral(){let t="",i=this.index,r=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===r){n=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=s}else t+=s}return n||this.throwError('Unclosed quote after "'+t+'"'),{type:yt.LITERAL,value:t,raw:this.expr.substring(i,this.index)}}gobbleIdentifier(){let t=this.code,i=this.index;for(yt.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,yt.isIdentifierPart(t));)this.index++;return{type:yt.IDENTIFIER,name:this.expr.slice(i,this.index)}}gobbleArguments(t){let i=[],r=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===t){r=!0,this.index++,t===yt.CPAREN_CODE&&n&&n>=i.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}else if(s===yt.COMMA_CODE){if(this.index++,n++,n!==i.length){if(t===yt.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===yt.CBRACK_CODE)for(let a=i.length;a<n;a++)i.push(null)}}else if(i.length!==n&&n!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===yt.COMPOUND)&&this.throwError("Expected comma"),i.push(a)}}return r||this.throwError("Expected "+String.fromCharCode(t)),i}gobbleGroup(){this.index++;let t=this.gobbleExpressions(yt.CPAREN_CODE);if(this.code===yt.CPAREN_CODE)return this.index++,t.length===1?t[0]:t.length?{type:yt.SEQUENCE_EXP,expressions:t}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:yt.ARRAY_EXP,elements:this.gobbleArguments(yt.CBRACK_CODE)}}},h6e=new u6e;Object.assign(yt,{hooks:h6e,plugins:new c6e(yt),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});yt.max_unop_len=yt.getMaxKeyLen(yt.unary_ops);yt.max_binop_len=yt.getMaxKeyLen(yt.binary_ops);var Hy=e=>new yt(e).parse(),d6e=Object.getOwnPropertyNames(yt);d6e.forEach(e=>{Hy[e]===void 0&&e!=="prototype"&&(Hy[e]=yt[e])});Hy.Jsep=yt;var f6e="ConditionalExpression",p6e={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let i=t.node,r=this.gobbleExpression();if(r||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:f6e,test:i,consequent:r,alternate:n},i.operator&&e.binary_ops[i.operator]<=.9){let s=i;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;t.node.test=s.right,s.right=t.node,t.node=i}}else this.throwError("Expected :")}})}};Hy.plugins.register(p6e);function FM(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var Zte=class{constructor(e,t,i){var r;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(n=>n()),this.emitter=FM(),this._innerCallUserAPI=async n=>{var s,a,o;this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await x6e(this.userAPI,n),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(l){let u=((o=(a=(s=l.message)==null?void 0:s.split("_:_"))==null?void 0:a[0])==null?void 0:o.replace("status:",""))??"null";this.error=u,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},((r=t==null?void 0:t.integration)==null?void 0:r.type)==="OpenAI"?this.result={content:""}:t.method==="GET"&&t.url!==""&&(this.prefetchPromise=this.prefetch(i)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=p_(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=this.userAPI.debounce!==void 0&&this.userAPI.debounce>0?p_(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t,i=!0){this.userAPI=e,this._updateDebouncedCallUserAPI(),this.userAPI.url!==""&&this.userAPI.method==="GET"&&i&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return $s.zoom(this.result,e)}catch(t){console.error(t)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?$s.zoom(this.result,e):this.result;if(y6e(t))return Object.entries(t);if(v6e(t))return t.map((i,r)=>[r.toString(),i]);throw g6e(t)?new Error("This path points to a value, use retrieveValue() instead. "+(e==null?void 0:e.join("."))):new Error("Path error"+(e==null?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function m6e(e){let t=new Headers;return e.headers.forEach(i=>{i.data.key!==""&&t.append(i.data.key,i.data.value)}),t}function g6e(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null}function v6e(e){return Array.isArray(e)}function y6e(e){return typeof e=="object"&&e!==null}async function x6e(e,t,i=new AbortController){var l,u,c,h;let r,n=e.url,s=((l=e.proxy)==null?void 0:l.enabled)??!1,a;if(((u=e.integration)==null?void 0:u.type)==="OpenAI"){let d=Yx(e.integration.prompt===""?[]:JSON.parse(e.integration.prompt),t),f=e.integration.behavior===""?[]:Yx(JSON.parse(e.integration.behavior),t);a=`{
		"model": "${e.integration.model}",
		"messages": [${e.integration.useBehavior?`
		{
			"role": "system",
			"content": "${f}"
		},`:""}
		{
			"role": "user",
			"content": "${d}"
		}
		]
	}`}if(s){n=`https://apis.spline.design/file/${e.proxy.fileId}/external-api/request?uuidexternalapi=${e.proxy.proxyId}`;let d;a!==void 0?d=a:e.method==="POST"&&e.body&&(d=Yx(JSON.parse(e.body),t)),d!==void 0&&(n+=`&data=${encodeURIComponent(d.replace(/(\r\n|\n|\r|\t)/gm,""))}`)}else((c=e.integration)==null?void 0:c.type)==="OpenAI"?r=a:e.method==="POST"&&e.body&&(r=Yx(JSON.parse(e.body),t));let o=await fetch(n,{method:s?"GET":e.method,headers:s?void 0:m6e(e),signal:i.signal,body:r});if(!o.ok)throw new Error("status:"+o.status+"_:_"+o.statusText);if(((h=e.integration)==null?void 0:h.type)==="OpenAI"){let d=await o.json();return s&&(d=d.response),{content:d.choices[0].message.content}}else{let d=await o.json();return s&&(d=d.response),d}}var Qte=(e,t)=>{if(typeof e=="string"){let i=t.getVariable(e);if(i)return Qte(i,t)}return ja.isBoolean(e)?ja.getDisplayedValue(e).toLowerCase():ja.getDisplayedValue(e)},Yx=(e,t)=>e.map((i,r)=>{if("text"in i)return i.text;if("type"in i){if(i.type==="paragraph")return(r>0?`
`:"")+Yx(i.children,t);if(i.type==="variable"){let n=t.getVariable(i.variableId);if(n!==void 0)return Qte(n,t)}}return""}).join(""),b6e=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],_6e=["0","1","2","3","4","5","6","7","8","9","."],w6e=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function E6e(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}Hy.addBinaryOp("^",11,!0);function Jte(e,t,i="number"){let r="";for(let a=0;a<e.length;a++){let o=e[a];if("objType"in o&&o.objType==="api"){let l=JSON.parse(o.id),u=l[0],c=t.getUserAPI(u);if(c!==void 0&&c instanceof Zte){let h=c.retrieveValue(l.slice(1));h!==void 0&&(r+=h)}continue}if("objType"in o&&o.objType==="webhook"){let l=JSON.parse(o.id),[u,c]=l,h=t.getUserWebhook(u);if(h!==void 0){let d=h.getParameterValue(c);d!==void 0&&(r+=d)}continue}if("objType"in o&&o.objType==="aiAssistant"){let l=t.openAIRealtime;if("objId"in o&&o.objId!==void 0){let u;if(t.scene.data.objects.traverse((c,h)=>{var f;let d=(f=h.events)==null?void 0:f.find(m=>m.id===o.objId);d&&(u=d)}),u!==void 0&&u.data.type==="AIAssistantListener"){let c=l==null?void 0:l.computeAnalysisForListenerEvent(u.data);if(c!==void 0){r+=c;continue}}}r+=(l==null?void 0:l.voice)??0;continue}if("id"in o){let l=e[a-1];if(a>0&&"id"in l){console.error("Two variables in a row",e);return}let u=t.getVariable(o.id),c=ja.getDisplayedValue(u);i==="number"&&ja.isTextValue(u)&&Array.isArray(u.textValue)&&u.textValue.length===1?c=parseFloat(c).toString():i==="boolean"&&ja.isBoolean(u)?c=u?"true":"false":i==="boolean"&&ja.isTextValue(u)&&!Array.isArray(u.textValue)&&(c='"'+c+'"'),r+=c;continue}else if(i==="string"){o.name!=='"'&&(o.name!=="+"||o.escaped)&&(r+=o.name),o.name==="+"&&!o.escaped&&r[r.length-1]==="\\"&&(r=r.slice(0,-1)+o.name);continue}if(o.name==="and"){r+="&&";continue}if(o.name==="or"){r+="||";continue}if(o.name==="True"){r+="true";continue}if(o.name==="False"){r+="false";continue}if(i==="boolean"&&!E6e(o.name)&&!_6e.includes(o.name)&&!b6e.includes(o.name)&&!w6e.includes(o.name.replace(/\($/g,""))){r+='"'+o.name+'"';continue}r+=o.name}if(i==="string")return r;if(e.length===0){if(i==="number")return 0;if(i==="boolean")return!1}let n;try{n=Hy(r)}catch(a){console.error(r,a);return}let s;try{s=Ir(n)}catch(a){console.error(r,n,a)}return s}function Ir(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(Ir(e.left)===Ir(e.right));case"!=":return+(Ir(e.left)!==Ir(e.right));case">":return+(Ir(e.left)>Ir(e.right));case">=":return+(Ir(e.left)>=Ir(e.right));case"<":return+(Ir(e.left)<Ir(e.right));case"<=":return+(Ir(e.left)<=Ir(e.right));case"+":return Ir(e.left)+Ir(e.right);case"-":return Ir(e.left)-Ir(e.right);case"*":return Ir(e.left)*Ir(e.right);case"/":return Ir(e.left)/Ir(e.right);case"%":return Ir(e.left)%Ir(e.right);case"&&":return Ir(e.left)&&Ir(e.right);case"||":return Ir(e.left)||Ir(e.right);case"^":return Math.pow(Ir(e.left),Ir(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-Ir(e.argument);case"!":return+!Ir(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,i=1;if(e.arguments.length>=1)try{t=Ir(e.arguments[0])}catch(r){console.warn(r)}if(e.arguments.length>=2)try{i=Ir(e.arguments[1])}catch(r){console.warn(r)}return t=Math.min(i,t),i=Math.max(i,t),t+Math.random()*(i-t)}return Math[e.callee.name].apply(null,e.arguments.map(Ir))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var S6e=new Pt,T6e=new Pt;function C6e(e,t,i){let r=[new q,new q,new q],n=[new q,new q,new q];return e.extractBasis(r[0],r[1],r[2]),t.extractBasis(n[0],n[1],n[2]),r.forEach((s,a)=>{let o=n[a],l=Xt.lerp(s.length(),o.length(),i);s.lerp(o,i).setLength(l)}),new Pt().makeBasis(r[0],r[1],r[2])}var A6e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),r=Math.abs(i.width),n=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),a=(t==null?void 0:t.shapeData)??ez.create({parameters:bte}).userData.shape;return{path:e.path??nA.defaultData(),parameters:Object.assign(i,{width:r,height:n,depth:s,extrusion:{..._te,...i.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new M6e(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new ai,{userData:{...e,type:"PathGeometry"}})}},M6e=class extends ai{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!e6e(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:i,offset:r}=this.inputs.parameters.extrusion;i=Math.max(0,Math.min(i,1)),r=Math.max(0,Math.min(r,1));let n=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(r*n),a=this.inputs.path.isClosed?Math.ceil((i+r)*n):Math.ceil(Math.min(1,i+r)*n),o=Math.min(Math.max(2,a-s+1),n+2),l=[],u=[];for(let G=0;G<o;G++){let V=this.inputs.path.isClosed?(G+s)%e.length:Math.min(G+s,e.length-1);l.push(e[V].clone()),u.push(t[V].clone())}let c=(G,V,J)=>{l[G]=l[G].clone().lerp(l[V],J),u[G]=C6e(u[G],u[V],J)},h=0,d=r*n%1;(!this.inputs.path.isClosed||i<=1)&&(d||r===0)&&(h=d,c(0,1,h));let f=0,m=(r+i)*n%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&r+i<1)&&m&&(f=m,c(l.length-1,l.length-2,1-f)),i===0){let G=l.length-1;l[G].copy(l[0]),u[G].copy(u[0])}this._applyPathModifiers(u,h,f);let{bevel:g,bevelSides:y}=this.inputs.parameters.extrusion,x=g>0?this.inputs.parameters.extrusion.capType:"flat",w=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(w=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:b,infos:C,vertices:A}=this._computeShapePoints(w),E=0,_;x==="round"&&(_=new JB(this.inputs.shapeData,2*g,g,w,y,void 0,!0),E=_.getAttribute("position").count);let P=0,I=0;C.sort((G,V)=>G.start-V.start),C.forEach(G=>{G.verticesStart=P,G.verticesCount=G.continuous.reduce((V,J,U)=>V+(U===0||!J?2:1),0),I+=G.verticesCount,P=I});let D=I*o,k,B=0;if(this._isOpenEnded()&&x==="flat"){try{k=Tp({windingRule:Zr.ODD,elementType:Ds.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:b})}catch{k=Ute}B=k.vertexCount}let z=D+2*B+E*2,W=D+2*B,$={positions:new Float32Array(z*3),normals:new Float32Array(z*3),uvs:new Float32Array(z*2)},Z=[];if(C.forEach(G=>{this._extrudeRegion(G,A,u,l,$,Z,this._isGeometryClosed()&&!this._isOpenEnded())}),k&&(this._closeEnd(k,D,Z,$,u[0],l[0],!1),this._closeEnd(k,D+B,Z,$,u[u.length-1],l[l.length-1],!0)),_){$.positions.set(_.getAttribute("position").array,W*3),$.normals.set(_.getAttribute("normal").array,W*3),$.uvs.set(_.getAttribute("uv").array,W*2);for(let U=W;U<W+E;U++)$.uvs[U*2+1]=1e-4;let G=Z.length;Z.push(..._.getIndex().array.map(U=>U+W)),W+=E,$.positions.set(_.getAttribute("position").array,W*3),$.normals.set(_.getAttribute("normal").array,W*3),$.uvs.set(_.getAttribute("uv").array,W*2);let V=Z.length;Z.push(..._.getIndex().array.map(U=>U+W)),this.setAttribute("position",new gi($.positions,3)),this.setAttribute("normal",new gi($.normals,3)),this.setAttribute("uv",new gi($.uvs,2)),this.setIndex(Z);let J=S6e;J.copy(u[u.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(J,W,z),J.copy(u[0]).setPosition(l[0]).multiply(T6e.makeScale(1,1,-1)),this.applyMatrix4OnRange(J,W-E,W),this.reverseIndicesOnRange(G,V)}else this.setAttribute("position",new gi($.positions,3)),this.setAttribute("normal",new gi($.normals,3)),this.setAttribute("uv",new gi($.uvs,2)),this.setIndex(Z)}_extractPathPoints(){let e=Dte(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(i=>{t[t.length-1].distanceToSquared(i)>.001&&t.push(i)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],i=e.length,r=this.inputs.path.isClosed,n=new q,s=new q,a=new q,o=new q,l=new q(0,1,0);for(let m=0;m<i;m++){let g=e[m],y;m===0?y=r?e[e.length-2]:g.clone().multiplyScalar(2).sub(e[1]):y=e[m-1];let x;m===i-1?x=r?e[1]:g.clone().multiplyScalar(2).sub(e[m-1]):x=e[m+1];let w=g.clone().sub(y).normalize(),b=x.clone().sub(g).normalize(),C=w.clone().add(b).normalize();a.copy(C),m===0&&(C.equals(l)||C.clone().negate().equals(l))&&l.set(0,0,1);let A=l.clone().cross(C).normalize(),E=C.clone().cross(A).normalize();l.copy(E),o.copy(A),m===0&&(n.copy(E),s.copy(C));let _=new Pt().makeBasis(A,E,C);t.push(_)}let u=r?s:a,c=r?n:new q(0,1,0),h=u.clone().cross(o).normalize(),d=Math.acos(c.dot(h));if(isNaN(d))return t;let f=c.clone().cross(h);u.dot(f)>0&&(d*=-1);for(let m=1;m<t.length;m++){let g=new Pt().makeRotationZ(d*m/t.length);t[m].multiply(g)}return t}_applyPathModifiers(e,t,i){let r=e.length,{angle:n,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new Pt,u=new Pt;return e.forEach((c,h)=>{let d=h===0?0:h===r-1?1:(h-t)/(r-(i===0?0:1)-(t+(1-i)));l.makeRotationZ(Xt.lerp(n,n+s,d)*Xt.DEG2RAD);let f=Xt.lerp(a,o,d);u.makeScale(f,f,f),c.multiply(l).multiply(u)}),e}_computeShapePoints(e=12,t=Zr.ODD){let i=this.inputs.shapeData,r=i.extractShapePointsToFlatArray([],e),n=i.shapeHoles.map(u=>{let c=u.extractShapePointsToFlatArray([],e),h=[];for(let d=c.length-1;d>=1;d-=2){let f=c[d-1],m=c[d-0];h.push(f,m)}return h}),s;try{s=Tp({windingRule:t,elementType:Ds.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[r]})}catch{s=QB}let a;try{a=Tp({windingRule:Zr.ODD,elementType:Ds.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{a=Fte}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let u=0;u<a.elements.length;u++){let c=a.elements[u],h=u%2===0?s.vertexCount:0;s.elements.push(c+h)}for(let u=0;u<a.vertexIndices.length;u++){let c=a.vertexIndices[u],h=s.vertexCount;s.vertexIndices.push(c+h)}for(let u=0;u<a.vertices.length;u++){let c=a.vertices[u];s.vertices.push(c)}}for(let u=0,c=s.vertexCount;u<c;u++){let h=u*2;s.vertices[h+0],s.vertices[h+1]}let l=[];for(let u=s.elementCount-1;u>=0;u--){let c=u>=o,h=u*2,d=s.elements[h+0],f=s.elements[h+1],m=d+f,g={start:d,count:f,normals:[],isHole:c,continuous:[],verticesStart:0,verticesCount:0};l.push(g);let y=d,x=m-1,w=d+1,b=i.roundedCurves.length;do{let C=y-d;s.vertices[x*2+0],s.vertices[x*2+1];let A=s.vertices[y*2+0],E=s.vertices[y*2+1],_=s.vertices[w*2+0],P=s.vertices[w*2+1],I=A-_,D=E-P,k=Math.sqrt(I*I+D*D);I/=k,D/=k,g.normals[C*2+0]=-D,g.normals[C*2+1]=I;let B=s.vertexIndices[y];if(Array.isArray(B))g.continuous[C]=!1;else{let[z,W]=i.getCurveIndexFromVertexId(B-1,!0);if(W>0&&W<1)g.continuous[C]=!0;else{let $=W===1?z+1:z-1;$=($+b)%b;let Z=W===1?0:1,G=i.roundedCurves[z].getTangent(W),V=i.roundedCurves[$].getTangent(Z);g.continuous[C]=G.dot(V)>.95}}c&&(g.normals[C*2+0]*=-1,g.normals[C*2+1]*=-1),[x,y,w]=[y,w,w+1],w>=m&&(w-=f)}while(w!==d+1)}return{regions:[r,...n],infos:l,vertices:s.vertices}}_insertVertex(e,t,i,r,n){let s=t*2,a=t*3;e.positions[a+0]=i.x,e.positions[a+1]=i.y,e.positions[a+2]=i.z,e.normals[a+0]=r.x,e.normals[a+1]=r.y,e.normals[a+2]=r.z,e.uvs[s+0]=n.x,e.uvs[s+1]=n.y}_extrudeRegion(e,t,i,r,n,s,a){let o=new q,l=new q,u=new q,c=new q,h=new Ie;i.forEach((f,m)=>{let g=r[m],y=e.verticesStart*i.length+e.verticesCount*m;for(let x=0;x<e.count;x++){let w=(e.start+x)*2;if(o.set(t[w+0],t[w+1],0),u.copy(o).applyMatrix4(f).add(g),e.continuous[x])c.set(e.normals[x*2+0],e.normals[x*2+1],0);else{let b=x===0?(e.start+e.count-1)*2:w-2;l.set(t[b+0],t[b+1],0),c.copy(o).sub(l),c.set(-c.y,c.x,0),e.isHole||c.negate()}if(c.applyMatrix4(f).normalize(),h.set(x===0?1:x/e.count,m/(i.length-1)),this._insertVertex(n,y,u,c,h),y++,!e.continuous[x]||x===0){if(x===0)c.set(e.normals[x*2+0],e.normals[x*2+1],0),h.set(0,m/(i.length-1));else{let b=x===e.count-1?e.start*2:w+2;l.set(t[b+0],t[b+1],0),c.copy(l).sub(o),c.set(-c.y,c.x,0),e.isHole||c.negate()}c.applyMatrix4(f).normalize(),this._insertVertex(n,y,u,c,h),y++}}});let d=i.length-1;for(let f=0;f<d;f++){let m=e.verticesStart*i.length+e.verticesCount*f,g=e.verticesStart*i.length+e.verticesCount*(f+1),y=0;for(let x=0;x<e.count;x++){(!e.continuous[x]||x===0)&&y++;let w=x===e.count-1?0:y+1,b=m+y,C=m+w,A=g+w,E=g+y;e.isHole?s.push(b,A,C,b,E,A):s.push(b,C,A,b,A,E),y++}}}_closeEnd(e,t,i,r,n,s,a){let o=e.vertexCount,l=new q(0,0,a?-1:1).applyMatrix4(n),u=new q,c=new Ie;for(let d=0;d<o;d++){let f=2*d;u.set(e.vertices[f+0],e.vertices[f+1],0).applyMatrix4(n).add(s),this._insertVertex(r,t+d,u,l,c)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let f=3*d,m=h[f+0]+t,g=h[f+(a?1:2)]+t,y=h[f+(a?2:1)]+t;i.push(m,g,y)}}applyMatrix4OnRange(e,t,i){let r=e.elements,n=new Is().getNormalMatrix(e).elements,s,a,o,l,u=this.attributes.position,c=this.attributes.normal;if(!u||!c)return;let h=u.array,d=c.array,f=u.itemSize;for(let m=t*f,g=i*f;m<g;m+=f){if(m===t)debugger;s=h[m+0],a=h[m+1],o=h[m+2],l=1/(r[3]*s+r[7]*a+r[11]*o+r[15]),h[m+0]=(r[0]*s+r[4]*a+r[8]*o+r[12])*l,h[m+1]=(r[1]*s+r[5]*a+r[9]*o+r[13])*l,h[m+2]=(r[2]*s+r[6]*a+r[10]*o+r[14])*l,s=d[m+0],a=d[m+1],o=d[m+2],d[m+0]=n[0]*s+n[3]*a+n[6]*o,d[m+1]=n[1]*s+n[4]*a+n[7]*o,d[m+2]=n[2]*s+n[5]*a+n[8]*o}u.needsUpdate=!0,c.needsUpdate=!0}reverseIndicesOnRange(e,t){let i=this.index;if(i){for(let r=e;r<t;r+=3){let n=i.getX(r),s=i.getX(r+1),a=i.getX(r+2);i.setXYZ(r,a,s,n)}i.needsUpdate=!0}}};function eie(){let e=new ai;return e.setAttribute("position",new gi(new Float32Array([]),3)),e.setIndex(new gi(new Uint16Array([]),1)),e}var P6e=eie().attributes,D6e=12,I6e=1,XL=class extends ai{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,P6e),this.userData={parameters:e,type:"TextGeometry"};let i=t.getFont(e.font);i!=null&&i.isLoaded?(this.font=i,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let i=t.getFont(e);i&&(this.font=i,await i.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:r,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,u=ja.getDisplayedValue(o),c=l===2?u.toUpperCase():l===3?u.toLowerCase():u,h=O6e(e,t,c),{shapes:d,charWidths:f,charCoords:m}=t.generateShapes(h,e),g=(typeof i=="number"?i:1)*.5,y=(typeof r=="number"?r:1)*.5,x=d.map(C=>new Jn().fromShape(C,!0));this.vectorShapes=x;let w=x.map(C=>dv.create({shape:C,parameters:{depth:n,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:n<=0?Zr.NONZERO:Zr.ODD,subdivisions:this.isLowResolution&&n>0?I6e:D6e}})),b=w.length?Sg(w):eie();b.translate(-g,y,0),this.dispose(),this.wrappedText=h,this.charCoords=m,this.charWidths=f,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach(([C,A])=>{this.setAttribute(C,A)}),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let e=Hu(new ai,XL.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,i])=>{this.setAttribute(t,i)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:e}})}get text(){return this.userData.parameters.text??""}};function O6e(e,t,i){let r=[""],n="";for(let s of i)n+=s,s===" "||s===`
`?(r[r.length-1]+=n,n="",s===`
`&&r.push("")):t.getTextWidth(r[r.length-1]+n,e)>e.width&&(r[r.length-1].length&&r.push(""),t.getTextWidth(r[r.length-1]+n,e)>e.width&&(n.length===1?(r[r.length-1]+=n,n=""):(r[r.length-1]+=n.slice(0,-1),n=n[n.length-1],r.push(""))));return r[r.length-1]+=n,r}var tie,iie=new Promise(e=>{tie=e}),iW=!1,mS;function R6e(){if(iW)return;if(mS)return mS;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@1.9.81/build",i=Ll(()=>import("./process-BpGnRvBL.js"),[]),[r,n]=await Promise.all([i,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),s=r.default,a=await s({wasmBinary:n});tie(a),iW=!0}return mS=e(),mS}var L6e=["font"];function T_(e,t,i,r){var u,c;let n,s,a;e.type==="PathGeometry"?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s={...e},a=[[]]);for(let h of a){let d=s;for(let f of h)d=d[f];for(n in d){let f=d[n];sH(f)&&!L6e.includes(n)&&(d[n]=t.getVariable(f,[r.uuid,"geometry",...h,n]),sH(d[n])&&(d[n]=1))}}let o={parameters:s,type:s.type};if(s.type==="PathGeometry")o.path=s.path;else if(s.type==="VectorGeometry"){let h=Jn.createFromState(s.shape,s.width,s.height);o.shape=h}else if(s.type==="NonParametricGeometry"){if(s.data.groups&&((u=s.data.groups)==null||u.forEach(h=>h.materialIndex=Math.max(h.materialIndex??0,0))),o.geometry=new eee().parse(s),o.geometry.groups.length===0){let h=o.geometry;h.addGroup(0,Math.max(((c=h.getIndex())==null?void 0:c.count)??0,h.getAttribute("position").count),0)}}else if(s.type==="SubdivGeometry"){let h=new Fo(s,i);return h.data=e,h}else{if(s.type==="TextGeometry")return new XL(s,t);if(s.type==="InputGeometry")return new XL(s,t);if(s.type==="UIGeometry")return tz.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}let l;try{l=oW(o)}catch(h){console.error(h)}if(!l){let h=Jn.createFromState(rA.defaultData(),100,100);o.shape=h,l=oW(o)}return l}var N6e=new Pt;function KL(e,t,i,r){let n=e.position.array,s=e.normal.array,a=N6e.makeScale(t,i,r).invert().elements,o,l,u;for(var c=0,h=n.length;c<h;c+=3)n[c]*=t,n[c+1]*=i,n[c+2]*=r,o=s[c],l=s[c+1],u=s[c+2],s[c]=a[0]*o+a[4]*l+a[8]*u,s[c+1]=a[1]*o+a[5]*l+a[9]*u,s[c+2]=a[2]*o+a[6]*l+a[10]*u;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var gS=new xs,e0=new q,yi;iie.then(e=>{yi=e});var rW=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),nW=new Uint32Array([0,1,2,3]),sW=new Uint8Array([4]),Fo=class extends ai{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let i=this.data.scaleBaked,r=Lg.div(t,i);this.subdividedGeometry&&KL(this.subdividedGeometry.attributes,...r),this.originalGeometry&&KL(this.originalGeometry.attributes,...r),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*r[0],height:n.height*r[1],depth:n.depth*r[2]},this.originalGeometry.boundingSphere.center.multiply(e0.fromArray(r));let s=e0.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,i;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:i}=Fo.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Dc(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let r=this.subdividedGeometry??this.originalGeometry;Object.assign(this,r),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Fo.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Rl,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;gS.setFromBufferAttribute(t),gS.getCenter(i),e.boundingSphere.radius=i.distanceTo(gS.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),gS.getSize(e0);let r={width:e0.x,height:e0.y,depth:e0.z};return this.userData.parameters=r,r}static build(e,t,i,r){let n,s,a,o=(e==null?void 0:e.phongAngle)??35;i===!1&&(o=-1),t&&(yi.free_bvh(t),yi.free_subdivision_surface(t));try{n=Fo.allocate(e,r)}catch(l){console.error(l,e),n=Fo.allocate({positionWASM:rW,indexWASM:nW,verticesPerFaceWASM:sW},r)}if(yi.set_destination_refinement_level(n,0),s=Fo.buildLevel(n,!0,o),e.subdivisions>0)try{yi.set_destination_refinement_level(n,e.subdivisions),a=Fo.buildLevel(n,!1,o)}catch{try{yi.set_destination_refinement_level(n,e.subdivisions-1),a=Fo.buildLevel(n,!1,o)}catch{a=null}}else a=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,i){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let r=e.shape!==void 0||e.path!==void 0?t.geometry:T_(e,i,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=r.getClosedTorusIndicesForBooleanOrSubdiv():n=r.getIndex();let s,a,o,l;({positions:s,triIndices:l}=UM(r.getAttribute("position"),n));let u;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let c=e.radialSegments*e.heightSegments*3*2,h=c+e.radialSegments*3;u=[c,h]}return{indices:a,verticesPerFace:o}=rie(s,l,r,u),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){var b;let i,r,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(i=e.positionWASM,r=e.indexWASM,n=e.verticesPerFaceWASM):(i=rW,r=nW,n=sW);let o=i.length,l=r.length,u=n.length,c=i.length+s.length+a.length,h=r.length+n.length,d=c*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,f=c*Float32Array.BYTES_PER_ELEMENT,m=yi._malloc(d),g=new Float32Array(yi.HEAPF32.buffer,m,c),y=new Uint32Array(yi.HEAPU32.buffer,m+f,h);g.set(i,0),g.set(s,i.length),g.set(a,i.length+s.length),y.set(r,0),y.set(n,r.length);let x;(b=e==null?void 0:e.scaleBaked)!=null&&b.some(C=>C!==1)&&(x=new Pt().makeScale(...e.scaleBaked)),t&&(x?x.premultiply(t):x=t);let w=x?yi.alloc_subdivision_surface2(m,o,m+f,l,m+f+r.length*Uint32Array.BYTES_PER_ELEMENT,u,x.elements):yi.alloc_subdivision_surface(m,o,m+f,l,m+f+r.length*Uint32Array.BYTES_PER_ELEMENT,u);return yi._free(m),w}static buildLevel(e,t,i,r,n){let s=n?yi.get_mesh_data2(e,t?yi.Level.CONTROL:yi.Level.REFINED,i,n.elements):yi.get_mesh_data(e,t?yi.Level.CONTROL:yi.Level.REFINED,i),a=8,o=yi.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,8),u=0,c=yi.HEAPU32[o[u]>>2],h=yi.HEAPF32.subarray(c>>2,(c>>2)+l[u]);u++;let d=yi.HEAPU32[o[u]>>2],f=yi.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let m=yi.HEAPU32[o[u]>>2],g=yi.HEAPU32.subarray(m>>2,(m>>2)+l[u]);u++;let y=yi.HEAPU32[o[u]>>2],x=yi.HEAPU32.subarray(y>>2,(y>>2)+l[u]);if(u++,r===void 0){let w=new ai;if(w.setIndex(new sy(x,1)),w.setAttribute("position",new Vt(h,3)),w.setAttribute("normal",new Vt(f,3)),t){w.setAttribute("faceMap",new sy(g,1));let b=new Float32Array(f.length/3*4).fill(0);w.setAttribute("color",new gi(b,4))}return yi.free_mesh_data(s),w.userData.type="SubdivGeometry",w}r.getAttribute("position").copyArray(h),r.getAttribute("normal").copyArray(f),r.attributes.position.needsUpdate=!0,r.attributes.normal.needsUpdate=!0,yi.free_mesh_data(s)}static freeSubdivPointer(e){yi.free_bvh(e),yi.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,i){let r=yi.get_wireframe_data_for_base_level(e),n=4,s=yi.HEAPU32.subarray(r>>2,(r>>2)+n),a=s.subarray(2,4),o=0,l=yi.HEAPU32[s[o]>>2],u=yi.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let c=yi.HEAPU32[s[o]>>2],h=yi.HEAPU32.subarray(c>>2,(c>>2)+a[o]);if(t===void 0){let d=new ai;d.setAttribute("position",new Vt(u,3));let f=new Float32Array(u.length);for(let m=0,g=u.length;m<g;)f[m++]=i.r,f[m++]=i.g,f[m++]=i.b;return d.setAttribute("color",new gi(f,3)),d.setIndex(new sy(h,1)),yi.free_wireframe_data_for_base_level(r),d}t.getAttribute("position").copyArray(u),t.attributes.position.needsUpdate=!0,yi.free_wireframe_data_for_base_level(r)}static updateCollabMesh(e,t,i){let r=t===0;r||yi.set_destination_refinement_level(e,t);let n=i?yi.get_topological_data2(e,r?yi.Level.CONTROL:yi.Level.REFINED,i.elements):yi.get_topological_data(e,r?yi.Level.CONTROL:yi.Level.REFINED),s=6,a=yi.HEAPU32.subarray(n>>2,(n>>2)+s),o=a.subarray(3,6),l=0,u=yi.HEAPU32[a[l]>>2],c=new Float32Array(yi.HEAPF32.subarray(u>>2,(u>>2)+o[l]));l++;let h=yi.HEAPU32[a[l]>>2],d=new Uint32Array(yi.HEAPU32.subarray(h>>2,(h>>2)+o[l]));l++;let f=yi.HEAPU32[a[l]>>2],m=new Uint8Array(yi.HEAPU32.subarray(f>>2,(f>>2)+o[l]));return yi.free_topological_data(n),{positions:c,indices:d,verticesPerFace:m}}},aW=["getX","getY","getZ"];function UM(e,t){let i={},r=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let u=0;u<r;u++){let c=t?t.getX(u):u,h="";for(let d=0;d<3;d++)h+=`${~~(e[aW[d]](c)*o)},`;if(h in i)s.push(i[h]);else{for(let d=0;d<3;d++)a.push(e[aW[d]](c));i[h]=n,s.push(n),n++}}let l=[];for(let u=0;u<s.length;u+=3)s[u]===s[u+1]||s[u]===s[u+2]||s[u+1]===s[u+2]||l.push(s[u],s[u+1],s[u+2]);return{positions:a,triIndices:l}}var vS=new q,MI=new q,PI=new q,DI=new q;function rie(e,t,i,r){let n=[],s=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let l=i.userData.shape.extractShapePointsToFlatArray([]),u=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&u<=24&&u%4===0&&i.userData.parameters.angle>=360){let d=l.length/2/u;l=l.filter((f,m)=>Math.floor(m/2)%d===0)}let c=0;for(let d=0;d<l.length;d+=2)c+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);e.length=0;let h=0;if(c<0)for(let d=0;d<l.length;d+=2)e.push(l[d],l[d+1],0),n.push(h++);else for(let d=l.length-2;d>=0;d-=2)e.push(l[d],l[d+1],0),n.push(h++);return s.push(h),{indices:n,verticesPerFace:s}}let a=new Float32Array([i.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(i.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){vS.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),MI.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),PI.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),DI.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),MI.sub(vS).normalize(),PI.sub(vS).normalize(),DI.sub(vS).normalize();let l=MI.cross(PI).dot(DI);Math.abs(l)>.005||r&&r.some((u,c)=>c%2===1?!1:o>=r[c]&&o<r[c+1])?(n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(n.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(i.useNgonForTopBottomFaceDuringBake){let l=[],u=[],c=0;for(let h=0,d=0;h<e.length;h+=3,d++)e[h+2]===0&&(l.push(d),c++),e[h+2]===a&&u.push(d);if(i.userData.parameters.extrudeBevelSize===0){let h=u[0];u[0]=u[1],u[1]=h}l.reverse(),n.push(...l,...u),s.push(c,c)}return{indices:n,verticesPerFace:s}}var Ld={};MTe(Ld,{calcBoolean:()=>U6e,calcBooleanTopological:()=>F6e,freeMeshSet:()=>W6e,getMeshSet:()=>j6e,hasOpenEdges:()=>V6e,transformMeshSet:()=>H6e});var nie,k6e=new Promise(e=>{nie=e}),yS;function B6e(){if(yS)return yS;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@1.9.81/build",i=Ll(()=>import("./boolean-Cuf2Mi8k.js"),[]),[r,n]=await Promise.all([i,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),s=r.default,a=await s({wasmBinary:n});nie(a)}return yS=e(),yS}var _r,dy;k6e.then(e=>_r=e);function z6e(e,t,i){let r,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:s,triIndices:a}=UM(e.getAttribute("position"),n),o;if(t&&i){let{indices:l,verticesPerFace:u}=rie(s,a,e);o=u.length,r=[];for(let c=0,h=0;c<o;c++){r.push(u[c]);for(let d=0;d<u[c];d++)r.push(l[h++])}}else{let l=a.length;r=Array(l+l/3),o=0;for(let u=0,c=0;c<r.length;)r[c++]=3,o++,r[c++]=a[u++],r[c++]=a[u++],r[c++]=a[u++]}return{positions:s,faceIndices:r,nFaces:o}}function sie(e){let t=e.length,i=t*Uint32Array.BYTES_PER_ELEMENT,r=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?i:r,s=_r._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(_r.HEAPU32.buffer,s,t):new Float32Array(_r.HEAPF32.buffer,s,t)).set(e,0),s}function aie(e){switch(e){case 0:return _r.OP.UNION;case 1:return _r.OP.INTERSECTION;case 2:return _r.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+e)}}function F6e(e,t){dy===void 0&&(dy=_r.init_csg());let i=sie(e),r=_r.csg_calc_topological(dy,i,e.length,aie(t));_r._free(i);let n=6,s=_r.HEAPU32.subarray(r>>2,(r>>2)+n),a=s.subarray(3,6),o=0,l=_r.HEAPU32[s[o]>>2],u=new Float32Array(_r.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let c=_r.HEAPU32[s[o]>>2],h=new Uint32Array(_r.HEAPU32.subarray(c>>2,(c>>2)+a[o]));o++;let d=_r.HEAPU32[s[o]>>2],f=new Uint8Array(_r.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return _r.free_mesh_data(r),{positions:u,indices:h,verticesPerFace:f}}function U6e(e,t,i,r){dy===void 0&&(dy=_r.init_csg());let n=sie(e),s=_r.csg_calc(dy,n,e.length,r,aie(t));_r._free(n);let a=5,o=_r.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,5),u=0,c=_r.HEAPU32[o[u]>>2],h=_r.HEAPF32.subarray(c>>2,(c>>2)+l[u]);u++;let d=_r.HEAPU32[o[u]>>2],f=_r.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let m=l[u];i.setAttribute("position",new Vt(h,3)),i.setAttribute("normal",new Vt(f,3));let g=_r.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new Rl),i.boundingSphere.center.set(g[0],g[1],g[2]),i.boundingSphere.radius=(g[3]**2+g[4]**2+g[5]**2)**.5,i.userData.parameters={width:g[3]*2,height:g[4]*2,depth:g[5]*2},_r.free_mesh_data(s),m}function j6e(e,t,i){if(_r===void 0)return-1;let r,n,s;if(t&&e.userData.positions!==void 0){let y=e.userData;s=y.verticesPerFace.length,r=y.positions,n=Array(y.verticesPerFace.reduce((x,w)=>x+w,0)+s);for(let x=0,w=0,b=0;x<y.verticesPerFace.length;x++){n[b++]=y.verticesPerFace[x];for(let C=0;C<y.verticesPerFace[x];C++)n[b++]=y.indices[w++]}}else({positions:r,faceIndices:n,nFaces:s}=z6e(e,t,i));let a=r.length,o=n.length,l=r.length,u=n.length,c=l*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=_r._malloc(c),f=new Float32Array(_r.HEAPF32.buffer,d,l),m=new Uint32Array(_r.HEAPU32.buffer,d+h,u);f.set(r,0),m.set(n,0);let g=_r.get_csg_mesh(d,a,d+h,o,s);return _r._free(d),g}function V6e(e){return _r.has_open_edges(e)}function H6e(e,t){_r.transform_csg_mesh(e,t.elements)}function W6e(e){_r.free_csg_mesh(e)}var G6e={ConeGeometry:Y5e,CubeGeometry:X5e,CylinderGeometry:Ite,DodecahedronGeometry:$5e,EllipseGeometry:ez,HelixGeometry:OUe,IcosahedronGeometry:RUe,LatheGeometry:LUe,NonParametricGeometry:jUe,PolygonGeometry:Kte,PyramidGeometry:VUe,RectangleGeometry:tz,SphereGeometry:GUe,PlaneGeometry:qUe,BackdropGeometry:YUe,StarGeometry:$te,TextFrameGeometry:KUe,TorusGeometry:$Ue,TorusKnotGeometry:QUe,TriangleGeometry:JUe,PathGeometry:A6e,VectorGeometry:dv},oW=e=>G6e[e.type].create(e);function t0(e){return e!==null&&"booleanOp"in e}var oie=class extends XB(dn){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Pt}updateVisible(e){super.updateVisible(e),this.visible=!t0(this.parent)&&this.visible,t0(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ld.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),t0(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof oie&&(e.freeBooleanPointer(),t0(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let i=super.updateTransformState(e,t);return i&&t0(this.parent)&&this.invalidateDownstreamBooleanData(!0),i}onVariableUpdate(e=!1){super.onVariableUpdate(e),t0(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},xS=new xs;function iz(e,t=0,i=e.count,r,n){let s=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h=t;h<i;h++){let d=e.getX(h),f=e.getY(h),m=e.getZ(h);d<s&&(s=d),f<a&&(a=f),m<o&&(o=m),d>l&&(l=d),f>u&&(u=f),m>c&&(c=m)}xS.min.set(s,a,o),xS.max.set(l,u,c),xS.getCenter(r),xS.getSize(n).multiplyScalar(.5)}var q6e=new ai,Y6e=new uf,Ko=class extends oie{constructor(t,i){super(q6e,Y6e),this.super_Entity(t,i)}updateState(t,i){this.updateState_Entity(t,i)}updateEntityBoxSize(t,i){let r=this.geometry.getAttribute("position");r!==void 0?iz(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,t,i):super.updateEntityBoxSize(t,i)}},sp=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},sp.uuidContext===null)throw new Error("plz startContext");sp.uuidContext===sp.globalContext?this.uuid="_gid"+sp.uuidContext.nodeContextUuid++:this.uuid="_uid"+sp.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){this.uuidContext===null||this.uuidContext===sp.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,i){return i=i??{},this.analyze(e,i),this.flow(e,t,i)}flow(e,t,i){i=i??{},e.addFlow(i.slot,i.cache,i.context);let r={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),r}build(e,t,i){t=t??this.getType(e,t);let r=e.getNodeData(i??this);return e.analyzing&&this.appendDepsNode(e,r,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,i)}updateFrame(e){}generateReadonly(e,t,i,r,n,s){return""}generate(e,t,i,r,n){return""}parse(e,t,i,r){}appendDepsNode(e,t,i){t.deps=(t.deps||0)+1;let r=e.getTypeLength(i);(r>(t.outputMax||0)||this.getType(e,i))&&(t.outputMax=r,t.output=i)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}},Xs=sp;Xs.globalContext={nodeContextUuid:0},Xs.uuidContext=sp.globalContext;var lW=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},X6e=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,i){i=i!==void 0?i:!0,this.keywords[e]={callback:t,cache:i}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},El=new X6e,en=class extends Xs{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,i,r){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=Xt.generateUUID()),i=e.getUUID(i??this.getUUID(),!n);let s=e.getNodeData(i),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,i)):super.build(e,t,i);if(n)return s.name=s.name||super.build(e,t,i),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,i);i=this.getUUID(!1);let o=this.getTemp(e,i);if(o)return e.format(o,a,t);{o=super.generate(e,t,i,s.output,r);let l=this.generate(e,a,i);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,i)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let i=e.getVars()[t];return i?i.name:void 0}generate(e,t,i,r,n){return this.getShared(e,t)||console.error("TempNode is not shared"),i=i??this.uuid,e.getTempVar(i,r??this.getType(e),n,this.getLabel()).name}},Nl=class extends en{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,i,r,n,s){i=e.getUUID(i??this.getUUID()),r=r??this.getType(e);let a=e.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,i,r,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(r,this,n,s,this.getLabel())),e.format(a.vertex.name,r,t)):(a.fragment||(a.fragment=e.createFragmentUniform(r,this,n,s,this.getLabel())),e.format(a.fragment.name,r,t))}},ka=class extends Nl{constructor(t=0,i){super("v2"),this.nodeType="Vector2",this.value=t instanceof Ie?t:new Ie(t,i)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,i,r,n,s,a){return t.format("vec2("+this.value.x+", "+this.value.y+")",n,i)}},Su=class extends Nl{constructor(e=0,t,i){super("v3"),this.nodeType="Vector3",this.value=e instanceof q?e:new q(e,t,i)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,i,r,n,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",r,t)}},Wa=class extends mi{constructor(t,i,r,n){super(t,i,r),this.isColorA=!0,this.a=n}setRGBA(t,i,r,n){super.setRGB(t,i,r),this.a=n}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(t){return super.equals(t)&&this.a===t.a}setStyle(t,i="srgb"){let r;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let n,s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=s==="rgba"?parseFloat(n[4]):1,super.setStyle(t,i);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=s==="hsla"?parseFloat(n[4]):1,super.setStyle(t,i);break}}return super.setStyle(t,i)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Nd=class extends Nl{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof Wa?e:new Wa(e.r,e.g,e.b,e.a)}generateReadonly(e,t,i,r,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",r,t)}},K6e=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,uW=/[a-z_0-9]+/gi,jt=class extends en{constructor(e,t,i,r,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,i,r)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,i,r,n){let s,a=0,o=this.src;if(this.includes)for(let u=0;u<this.includes.length;u++)e.include(this.includes[u],this);for(let u in this.extensions)e.extensions[u]=!0;let l=[];for(;s=uW.exec(this.src);)l.push(s);for(let u=0;u<l.length;u++){let c=l[u],h=c[0],d=this.isMethod?!this.getInputByName(h):!0,f=h;if(this.keywords[h]||this.useKeywords&&d&&El.containsKeyword(h)){let m=this.keywords[h];if(!m){let g=El.getKeywordData(h);g.cache&&(m=e.keywords[h]),m=m||El.getKeyword(h,e),g.cache&&(e.keywords[h]=m)}f=m.build(e)}h!==f&&o[c.index+a-1]!=="."&&(o=o.substring(0,c.index+a)+f+o.substring(c.index+h.length+a),a+=f.length-h.length),this.getIncludeByName(f)===void 0&&El.contains(f)&&e.include(El.get(f))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,i,r){if(this.src=e||"",this.includes=t??[],this.extensions=i??{},this.keywords=r??{},this.isMethod){let n=K6e.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(uW);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let u=s[a++];this.inputs.push({name:u,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},$6e=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,lie=class extends en{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||lie.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,i,r,n){this.src=e||"";let s,a,o="",l=$6e.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,i,r,n){return e.format(this.name,this.getType(e),t)}},Hr=lie;Hr.PI="PI",Hr.PI2="PI2",Hr.RECIPROCAL_PI="RECIPROCAL_PI",Hr.RECIPROCAL_PI2="RECIPROCAL_PI2",Hr.LOG2="LOG2",Hr.EPSILON="EPSILON";var Z6e=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Q6e=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),uie=class extends en{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,i,r,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Z6e.exec(e);if(t){let i=t[2],r;for(;r=Q6e.exec(i);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name}},rz=class extends en{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",r=e.isShader("vertex")?"uv"+i:"vUv"+i;return e.format(r,this.getType(e),t)}};El.addKeyword("uv",function(){return new rz});El.addKeyword("uv2",function(){return new rz(1)});var x0=class extends en{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??x0.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Pc:return["Linear"];case $i:return["sRGB"];default:return[]}}generate(e,t){var a;let i=this.input.build(e,"v4"),r=this.getType(e),n=x0.Nodes[this.method],s=e.include(n);if(s===x0.LINEAR_TO_LINEAR)return e.format(i,r,t);if(((a=n.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+i+", "+o+" )",r,t)}else return e.format(s+"( "+i+" )",r,t)}fromEncoding(e){let t=x0.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=x0.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},wh=x0;wh.Nodes={LinearToLinear:new jt(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new jt(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new jt(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},wh.LINEAR_TO_LINEAR="LinearToLinear",wh.SRGB_TO_LINEAR="sRGBToLinear",wh.LINEAR_TO_SRGB="LinearTosRGB";var yn=class extends jt{constructor(e="",t,i,r,n){super(e,n,r,i,t),this.nodeType="Expression"}},Vd=class extends Nl{constructor(e=new jn,t,i,r){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new rz,this.bias=i,this.project=r!==void 0?r:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let i=this.getTexture(e,t),r=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+i+", "+r+", "+n+" )":a=s+"( "+i+", "+r+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new wh(new yn("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},Zt=class extends Nl{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,i,r,n,s){return e.format(this.value+(this.value%1?"":".0"),r,t)}},cW=class extends en{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,i,r,n){r=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let u=s.inputs[l],c=this.inputs[l]||this.inputs[u.name];o.push(c.build(e,e.getTypeByFormat(u.type)))}a+=o.join(", ")+" )"}return e.format(a,r,t)}},cie=class extends en{constructor(e,t,i=cie.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=i}getType(e){let t=this.a.getType(e),i=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(i)>e.getTypeLength(t)?i:t}generate(e,t){let i=this.getType(e);this.type=i;let r=this.a.build(e,i),n=this.b.build(e,i);return e.format("( "+r+" "+this.op+" "+n+" )",i,t)}},yl=cie;yl.ADD="+",yl.SUB="-",yl.MUL="*",yl.DIV="/";var Xr=class extends en{constructor(e,t=Xr.ABS,i,r){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:r=t,typeof i!="string"?this.c=i:r=i,this.method=r,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Xr.MIX:case Xr.CLAMP:case Xr.REFRACT:case Xr.SMOOTHSTEP:case Xr.FACEFORWARD:return 3;case Xr.MIN:case Xr.MAX:case Xr.MOD:case Xr.STEP:case Xr.REFLECT:case Xr.DISTANCE:case Xr.DOT:case Xr.CROSS:case Xr.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),i=this.b?e.getTypeLength(this.b.getType(e)):0,r=this.c?e.getTypeLength(this.c.getType(e)):0;return t>i&&t>r?this.a.getType(e):i>r?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Xr.LENGTH:case Xr.DISTANCE:case Xr.DOT:return"f";case Xr.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let i,r,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),u=this.getType(e);switch(this.type=u,this.method){case Xr.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Xr.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Xr.CROSS:i=this.a.build(e,"v3"),r=this.b.build(e,"v3");break;case Xr.STEP:i=this.a.build(e,s===1?"f":l),r=this.b.build(e,l);break;case Xr.MIN:case Xr.MAX:case Xr.MOD:i=this.a.build(e,l),r=this.b.build(e,a===1?"f":l);break;case Xr.REFRACT:i=this.a.build(e,l),r=this.b.build(e,l),n=this.c.build(e,"f");break;case Xr.MIX:i=this.a.build(e,l),r=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:i=this.a.build(e,l),this.b&&(r=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let c=[];c.push(i),r&&c.push(r),n&&c.push(n);let h=this.getNumInputs(e);if(c.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${c.length}.`);return e.format(this.method+"( "+c.join(", ")+" )",u,t)}},qi=Xr;qi.RAD="radians",qi.DEG="degrees",qi.EXP="exp",qi.EXP2="exp2",qi.LOG="log",qi.LOG2="log2",qi.SQRT="sqrt",qi.INV_SQRT="inversesqrt",qi.FLOOR="floor",qi.CEIL="ceil",qi.NORMALIZE="normalize",qi.FRACT="fract",qi.SATURATE="saturate",qi.SIN="sin",qi.COS="cos",qi.TAN="tan",qi.ASIN="asin",qi.ACOS="acos",qi.ARCTAN="atan",qi.ABS="abs",qi.SIGN="sign",qi.LENGTH="length",qi.NEGATE="negate",qi.INVERT="invert",qi.MIN="min",qi.MAX="max",qi.MOD="mod",qi.STEP="step",qi.REFLECT="reflect",qi.DISTANCE="distance",qi.DOT="dot",qi.CROSS="cross",qi.POW="pow",qi.MIX="mix",qi.CLAMP="clamp",qi.REFRACT="refract",qi.SMOOTHSTEP="smoothstep",qi.FACEFORWARD="faceforward";var Xx=class extends en{constructor(e,t,i){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=i}bilinearCubeUV(e,t,i,r){let n=new cW(Xx.Nodes.bilinearCubeUV,[t,i,r]);this.colorSpaceTL=this.colorSpaceTL??new wh(new yn("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new wh(new yn("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new wh(new yn("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new wh(new yn("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new yn(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new yn(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new yn(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new yn(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new yn("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let i=this.uv,r=this.bias||e.context.roughness,n=new cW(Xx.Nodes.roughnessToMip,[r]),s=new qi(n,Xx.Nodes.m0,Xx.Nodes.cubeUV_maxMipLevel,qi.CLAMP),a=new qi(s,qi.FLOOR),o=new qi(s,qi.FRACT),l=this.bilinearCubeUV(e,this.value,i,a),u=this.bilinearCubeUV(e,this.value,i,new yl(a,new Zt(1).setReadonly(!0),yl.ADD)),c=new qi(l,u,o,qi.MIX);return e.format(c.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},$L=Xx;$L.Nodes=function(){let e=new uie(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Hr("float cubeUV_maxMipLevel 8.0",!0),i=new Hr("float cubeUV_minMipLevel 4.0",!0),r=new Hr("float cubeUV_maxTileSize 256.0",!0),n=new Hr("float cubeUV_minTileSize 16.0",!0),s=new jt(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new jt(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new jt(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,i,r,n]);o.useKeywords=!1;let l=new Hr("float r0 1.0",!0),u=new Hr("float v0 0.339",!0),c=new Hr("float m0 -2.0",!0),h=new Hr("float r1 0.8",!0),d=new Hr("float v1 0.276",!0),f=new Hr("float m1 -1.0",!0),m=new Hr("float r4 0.4",!0),g=new Hr("float v4 0.046",!0),y=new Hr("float m4 2.0",!0),x=new Hr("float r5 0.305",!0),w=new Hr("float v5 0.016",!0),b=new Hr("float m5 3.0",!0),C=new Hr("float r6 0.21",!0),A=new Hr("float v6 0.0038",!0),E=new Hr("float m6 4.0",!0),_=[l,u,c,h,d,f,m,g,y,x,w,b,C,A,E],P=new jt(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,_);return{bilinearCubeUV:o,roughnessToMip:P,m0:c,cubeUV_maxMipLevel:t}}();var b0=class extends en{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??b0.VIEW}getShared(){return this.scope===b0.WORLD}build(e,t,i,r){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,i,r):super.build(e,t,i)}generate(e,t,i,r,n){let s;switch(this.scope){case b0.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case b0.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case b0.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},Cl=b0;Cl.LOCAL="local",Cl.WORLD="world",Cl.VIEW="view",Cl.NORMAL="normal";El.addKeyword("viewNormal",function(){return new Cl(Cl.VIEW)});El.addKeyword("localNormal",function(){return new Cl(Cl.NORMAL)});El.addKeyword("worldNormal",function(){return new Cl(Cl.WORLD)});var Id=class extends en{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Id.LOCAL}getType(){switch(this.scope){case Id.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Id.LOCAL:case Id.WORLD:return!1}return!0}generate(e,t,i,r,n){let s;switch(this.scope){case Id.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case Id.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case Id.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Id.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},yc=Id;yc.LOCAL="local",yc.WORLD="world",yc.VIEW="view",yc.PROJECTION="projection";El.addKeyword("position",function(){return new yc});El.addKeyword("worldPosition",function(){return new yc(yc.WORLD)});El.addKeyword("viewPosition",function(){return new yc(yc.VIEW)});var nh=class extends en{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??nh.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case nh.SPHERE:return"v2"}return this.type}generate(e,t){let i=this.getUnique(e);if(e.isShader("fragment")){let r;switch(this.scope){case nh.VECTOR:{let n=new Cl(Cl.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new yc(yc.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,u=`reflect( -normalize( ${o} ), ${a} )`;l&&(u=`normalize( mix( ${u}, ${a}, ${l} * ${l} ) )`);let c=`inverseTransformDirection( ${u}, viewMatrix )`;i?(e.addNodeCode(`vec3 reflectVec = ${c};`),r="reflectVec"):r=c;break}case nh.CUBE:{let n=new nh(nh.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";i?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),r="reflectCubeVec"):r=s;break}case nh.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new nh(nh.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),r="reflectSphereVec"):r=n;break}}return e.format(r,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},fy=nh;fy.CUBE="cube",fy.SPHERE="sphere",fy.VECTOR="vector";var J6e=class extends en{constructor(e=new Vd,t,i){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new $L(this.value,t??new fy(fy.VECTOR),i),this.irradianceNode=new $L(this.value,new Cl(Cl.WORLD),new Zt(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},eje=class extends Nl{constructor(e=new aB,t,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new fy,this.bias=i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let i=this.getTexture(e,t),r=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+i+", "+r+", "+n+" )":s="texCube( "+i+", "+r+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new wh(new yn("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},tje=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,ije=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,rje=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,nje=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,sje=`
layout(location = 1) out vec4 gVelocity;
`,aje=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,hW=["x","y","z","w"],oje=["float","vec2","vec3","vec4"],lje={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},uje={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},hie=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,i){return t.deps.length-i.deps.length}return function(t,i){let r=this.getIncludes(t,i);if(!r)return"";let n="";r=r.sort(e);for(let s=0;s<r.length;s++)r[s].src&&(n+=r[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(tje),this.addFragmentParsCode(ije),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let r=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+r+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+r+";"),this.addVertexFinalCode("vUv"+r+" = uv"+r+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode(`
				#ifndef SHAPEBLEND 
					vObjectNormal = normal;
				#else
					vObjectNormal = objectNormal;
				#endif
			`)),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(rje),this.addFragmentFinalCode(nje)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,i){return this.addSlot(e).addCache(t).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,i,r="varying",n="V",s=""){let a=this.getVars(r),o=a[e];if(!o){let l=a.length;o={name:i||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,i,r){return this.getVar(e,t,i,this.shader,"T",r)}getAttribute(e,t){if(!this.attributes[e]){let i=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(i.name+" = "+e+";"),this.attributes[e]={varying:i,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let i="";for(let r=0,n=e.length;r<n;++r){let s=e[r],a=s.type,o=s.name,l=s.size,u=this.getFormatByType(a);if(u===void 0)throw new Error("Node pars "+u+" not found.");u.includes("[]")?i+=t+" "+u.substring(0,u.length-2)+" "+o+`[${l}];
`:i+=t+" "+u+" "+o+`;
`}return i}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof Xs?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,i,r,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new lW({type:t,size:i.size,name:r||"nodeUA"+o+(s?"_"+s:""),node:i,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new lW({type:t,name:r||"nodeU"+o+(s?"_"+s:""),node:i,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,i,r,n){return this.createUniform("vertex",e,t,i,r,n)}createFragmentUniform(e,t,i,r,n){return this.createUniform("fragment",e,t,i,r,n)}include(e,t,i){var s;let r;if(e=typeof e=="string"?El.get(e):e,this.context.include===!1)return e.name;e instanceof jt?r=this.includes.functions:e instanceof Hr?r=this.includes.consts:e instanceof uie&&(r=this.includes.structs);let n=r[this.shader]=r[this.shader]||[];if(e){let a=n[e.name];if(a||(a=n[e.name]={node:e,deps:[]},n.push(a),a.src=e.build(this,"source")),e instanceof jt&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return i&&(a.src=i),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return oje[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!=null&&i.isNode)return i}}resolve(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case Gg:case qg:return new eje(i);case Z_:return new J6e(new Vd(i));default:return new Vd(i)}else{if(i.isVector2)return new ka(i);if(i.isVector3)return new Su(i);if(i.isVector4)return new Nd(i)}}}}format(e,t,i){switch(this.colorToVector(i+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return lje[e]||e}getFormatByType(e){return uje[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return hW[e]}getIndexByElement(e){return hW.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Pc,t===Pc&&this.context.gamma&&(t=$i),t}},es=class extends Nl{constructor(e=0,t,i,r){super("c"),this.nodeType="Color",this.value=e instanceof Wa?e:new Wa(e||0,t,i,r)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,i,r,n,s){i=e.getUUID(i??this.getUUID()),r=r??this.getType(e);let a=e.getNodeData(i),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,i,r,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(r,this,n,s,this.getLabel())),e.format(a.vertex.name,r,t)):(a.fragment||(a.fragment=e.createFragmentUniform(r,this,n,s,this.getLabel())),e.format(a.fragment.name,r,t))}generateReadonly(e,t,i,r,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",r,t)}},nn=class extends Nl{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,i,r,n,s){return e.format(this.value.toString(),r,t)}},Uo=class extends Nl{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,i,r){return e.format(this.value?"true":"false",r,t)}},ng=class extends Nl{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},nz=class extends Nl{},cje=class extends nz{constructor(e){super("v3"),this.image=e,this._value=new q}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},ZL=class extends nz{constructor(e,t,i=1008,r=1006){super("t"),this.image=e,this.wrap=t,this.minFilter=i,this.magFilter=r}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},die=class extends Nl{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new Is}generateReadonly(e,t,i,r,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",r,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},zh=class extends Nl{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new Pt}generateReadonly(e,t,i,r,n,s){return e.format("mat4("+this.value.elements.join(", ")+")",r,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function dW(e,t,i,r=0){e.setUvTransform(i[0],i[1],t[0],t[1],0,0,0).premultiply(new Is().makeRotation(r*Xt.DEG2RAD))}var hje=class extends die{constructor(e,t,i=0){super(new Is),this.repeat=e,this.offset=t,this.rotation=i,dW(this.value,e,t,i)}updateMatrix(){dW(this.value,this.repeat,this.offset,this.rotation)}},sg=class extends Nl{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Pi?new Array(e).fill(t):new Array(e).fill(new Pi(0))}},fW=class extends en{constructor(e,t,i,r){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=i,this.mode=r}generate(e,t){if(e.isShader("fragment")){let i=[];return i.push(this.a.build(e,"c")),i.push(this.b.build(e,"c")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),e.format("spe_blend("+i.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},fie=class extends en{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(fie.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.color.build(e,"v3")),r.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},QL=fie;QL.Nodes=function(){return{customColor:new jt(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var pie=class extends en{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(pie.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.cnormal.build(e,"v3")),r.push("normal"),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},mie=pie;mie.Nodes=function(){return{customNormal:new jt(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Kx=class extends en{constructor(e,t,i,r,n,s,a,o,l,u,c,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=i,this.projection=r,this.axis=n,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=u,this.mode=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,r;switch(this.projection.value){case 3:r=e.include(Kx.Nodes.cylindrical);break;case 2:r=e.include(Kx.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new jt(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);r=e.include(o);break;case 4:r=e.include(Kx.Nodes.triplanar);break;default:r=e.include(Kx.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let s=`${i}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",u=`${i}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(u,"vec3"),n.push(a),n.push(o),n.push(l),n.push(u)}else{let s=`${i}_writeUvs`;e.addFragmentVariable(s,"vec2"),n.push(s)}return e.format(r+"("+n.join(",")+")",this.getType(e),t)}},sz=Kx;sz.Nodes=function(){let e=new jt(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new jt(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new jt(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),r=new jt(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:i,triplanar:r}}();var $x=class extends en{constructor(e,t,i,r,n,s,a,o,l,u,c,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=i,this.far=r,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=u,this.isMask=h,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`,r=new jt(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[$x.Nodes.vectorLinearWorldSpaceDepth,$x.Nodes.vectorLinearObjectSpaceDepth,$x.Nodes.vectorSphericalObjectSpaceDepth,$x.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${i}_SMOOTH`),this.isVector.value>.5&&e.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${i}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(r),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},gie=$x;gie.Nodes=function(){let e=new jt(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new jt(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new jt(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),r=new jt(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:r}}();var dje=class extends en{constructor(e,t,i,r,n,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=i,this.intensity=r,this.factor=n,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=new jt(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),r=e.include(i),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(r+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},vie=class extends en{constructor(e,t,i,r,n,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=i,this.steps=r,this.offset=n,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(vie.Nodes.gradient),r=[];return r.push(this.gradientType.build(e,"i")),r.push(this.smooth.build(e,"b")),r.push(this.colors.build(e,"v4[]")),r.push(this.steps.build(e,"f[]")),r.push(this.offset.build(e,"v2")),r.push(this.morph.build(e,"v2")),r.push(this.angle.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},yie=vie;yie.Nodes=function(){return{gradient:new jt(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var xie=class extends en{constructor(e,t,i,r,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=r,this.alpha=t,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=n}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=e.include(xie.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let r=[];return r.push(this.texture.generate(e,"t")),r.push("normal"),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),r.push(this.rotation.build(e,"f")),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},bie=xie;bie.Nodes=function(){return{matcap:new jt(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var _l=function(){let e=new jt(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new jt(`float simplexFast(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 mediump vec3 x = p - s + dot(s, vec3(G3));
			 mediump vec3 hs = s;
			 
			 mediump vec3 e = step(vec3(0.0), x - x.yzx);
			 mediump vec3 i1 = e*(1.0 - e.zxy);
			 mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 mediump vec3 x1 = x - i1 + G3;
			 mediump vec3 x2 = x - i2 + 2.0*G3;
			 mediump vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 mediump vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(hs), x);
			 d.y = dot(random3(hs + i1), x1);
			 d.z = dot(random3(hs + i2), x2);
			 d.w = dot(random3(hs + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Hr("float F3 0.3333333"),t.keywords.G3=new Hr("float G3 0.1666667");let i=new jt(`float simplexPrecise(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);i.keywords.F3=new Hr("float F3 0.3333333"),i.keywords.G3=new Hr("float G3 0.1666667");let r=new jt(`float simplexFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplexFast(m * rot1)
				 + 0.2666667 * simplexFast(2.0 * m * rot2)
				 + 0.1333333 * simplexFast(4.0 * m * rot3)
				 + 0.0666667 * simplexFast(8.0 * m);
		}`,[t]),n=new jt("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),s=new jt("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new jt(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[n,s]),o=new jt("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),l=new jt("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),u=new jt(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[l]),c=new jt(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[u]);c.keywords.NUM_OCTAVES=new Hr("int NUM_OCTAVES 5");let h=new jt("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new jt(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[n,s,h]),f=new jt(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),m=new jt(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),g=new jt(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),y=new jt(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),x=new jt(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),w=new jt(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),b=new jt(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			// Second pass for edge distance  
			// skip for styles don't need
			if (style != 0 &&  style != 5 && style != 7)
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[f,m,g,y,x,w]);return{simplexFast:t,simplexPrecise:i,simplexFractal:r,simplexAshima:a,fbm:c,perlin:d,voronoi:b}}(),_ie=class extends en{constructor(e,t,i,r,n,s,a,o,l,u,c,h,d,f,m,g,y,x,w){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=i,this.fA=r,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=u,this.noiseType=h,this.voronoiStyle=f,this.highCut=m,this.lowCut=g,this.smoothness=y,this.seed=x,this.quality=w,this.isMask=d,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,i,r,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new jt(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[_l.simplexFast,_l.simplexFractal,_l.simplexAshima,_l.fbm,_l.perlin,_l.voronoi]),l=e.include(o),u=[];return u.push(this.scale.build(e,"f")),u.push(this.size.build(e,"v3")),u.push(this.move.build(e,"f")),u.push(this.fA.build(e,"v2")),u.push(this.fB.build(e,"v2")),u.push(this.distortion.build(e,"v2")),u.push(this.colorA.build(e,"v4")),u.push(this.colorB.build(e,"v4")),u.push(this.colorC.build(e,"v4")),u.push(this.colorD.build(e,"v4")),u.push(this.voronoiStyle.build(e,"i")),u.push(this.highCut.build(e,"f")),u.push(this.lowCut.build(e,"f")),u.push(this.smoothness.build(e,"f")),u.push(this.seed.build(e,"f")),u.push(this.quality.build(e,"i")),u.push(this.isMask.build(e,"b")),u.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),u.push(this.alpha.build(e,"f")),u.push(this.calpha),e.format(l+"("+u.join(",")+")",this.getType(e),t)}};_ie.numOctaves=5;var wie=class extends en{constructor(e,t,i,r,n,s,a,o,l,u,c,h,d,f,m,g){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=i,this.contourWidth=r,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=u,this.compensation=c,this.resolution=h,this.normalMap=d,this.depthMap=f,this.pixelRatio=m,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let r=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(r,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${n} * (${r} / 2.0) * ${i}_clipPosition.w * 2.0 * ${a};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(wie.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(r+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},Eie=wie;Eie.Nodes=function(){let e=new jt(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new jt(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Od=class extends en{constructor(e,t,i,r,n,s,a,o,l,u,c,h,d,f,m,g,y,x){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=i,this.blending=r,this.offset=n,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=u,this.smoothness=c,this.zigzag=h,this.rotation=d,this.vertical=f,this.horizontal=m,this.sides=g,this.isMask=x,this.alpha=y,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let r=`g${this.uuid.toString().replace(/-/g,"")}`,n=new jt(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new jt(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let c=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${c};
				float d1 = ${h};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let c=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h="";this.axis.value===0?h=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?h=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,h=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${h}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${c};
				`}let o=new jt(`vec3 ${r}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,Od.DrawFunctions.circle,Od.DrawFunctions.ring,Od.DrawFunctions.polygon,Od.DrawFunctions.cross,Od.DrawFunctions.diamond,Od.DrawFunctions.checkerboard,Od.DrawFunctions.line,Od.DrawFunctions.wave]),l=e.include(o),u=[];return u.push("normal"),u.push(this.blending.build(e,"f")),u.push(this.style.build(e,"i")),u.push(this.offset.build(e,"v2")),u.push(this.colorA.build(e,"v4")),u.push(this.colorB.build(e,"v4")),u.push(this.frequency.build(e,"v2")),u.push(this.size.build(e,"f")),u.push(this.variation.build(e,"f")),u.push(this.smoothness.build(e,"f")),u.push(this.zigzag.build(e,"f")),u.push(this.rotation.build(e,"f")),u.push(this.vertical.build(e,"v2")),u.push(this.horizontal.build(e,"v2")),u.push(this.sides.build(e,"i")),u.push(this.isMask.build(e,"b")),u.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),u.push(this.alpha.build(e,"f")),u.push(this.calpha),e.format(l+"("+u.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},Sie=Od;Sie.DrawFunctions=function(){let e=new jt(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new jt(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),i=new jt(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),r=new jt(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new jt(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new jt(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new jt(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new jt(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new jt(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),u=new jt(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:i,ring:r,polygon:n,cross:s,diamond:a,checkerboard:o,line:l,wave:u}}();var Tie=class extends en{constructor(e,t,i,r,n,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=i,this.noiseStrength=r,this.noiseScale=n,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(Tie.Nodes.rainbow),r=[];return r.push(this.filmThickness.build(e,"f")),r.push(this.movement.build(e,"f")),r.push(this.wavelengths.build(e,"v3")),r.push(this.noiseStrength.build(e,"f")),r.push(this.noiseScale.build(e,"f")),r.push(this.offset.build(e,"v3")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Cie=Tie;Cie.Nodes=function(){let e=new jt(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
				float f = 0.0;
				
				if (noiseStrength != 0.0) {
					vec3 st = position / noiseScale;
					float noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));
					f = noise * noiseStrength;
				}

				vec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;
				float angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));

				mediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);
				return .5 + .5 * color;
			 }`,[_l.simplexFast]);return{rainbow:new jt(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				mediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
			 }`,[e])}}();var Aie=class extends en{constructor(e,t,i,r,n,s,a,o,l,u){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=i,this.source=r,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let i=e.include(Aie.Nodes.toon),r=[];return r.push(this.positioning.build(e,"i")),r.push(this.colors.build(e,"v4[]")),r.push(this.steps.build(e,"f[]")),r.push(this.source.build(e,"v3")),r.push(this.isWorldSpace.build(e,"b")),r.push(this.noiseStrength.build(e,"f")),r.push(this.noiseScale.build(e,"f")),r.push(this.shadowColor.build(e,"v4")),r.push(this.offset.build(e,"v3")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Mie=Aie;Mie.Nodes=function(){let e=new jt(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new jt(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new jt(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),r=new jt(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new jt(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[r]);return{toon:new jt(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplexFast(st),
					// 	simplexFast(st + vec3(111.1, 143.89, 217.19)),
					// 	simplexFast(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[_l.simplexFast,e,i,n])}}();var fje=function(){return{textureBicubic:new jt(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function pje(e,t){return e>=t?new Ie(t/e,1):new Ie(1,e/t)}var Pie=class extends en{constructor(e,t,i,r,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=i,this.transmissionSamplerSize=r,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,xi.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let i=e.include(Pie.Nodes.transmission),r=[];return r.push(this.thickness.build(e,"f")),r.push(this.ior.build(e,"f")),r.push(this.roughness.build(e,"f")),r.push(this.transmissionSamplerSize.build(e,"v2")),r.push(this.transmissionSamplerMap.getTexture(e,"t")),r.push(this.transmissionDepthMap.getTexture(e,"t")),r.push(this.aspectRatio.build(e,"v2")),r.push("normal"),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Die=Pie;Die.Nodes=function(){let e=new jt(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new jt(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new jt(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),r=new jt(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[fje.textureBicubic,i,e]),n=new jt(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[r,t]);return{transmission:new jt(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var JL=(e=>(e.NOISE="noise",e.MAP="map",e))(JL||{}),Iie=class extends en{constructor(e,t,i,r,n,s,a,o,l,u,c){super("v3"),this.displacementTypeIndex=new nn(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(JL)[this.displacementTypeIndex.value]==="map"&&(this.mat=new die(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=u,this.noiseFunctionIndex=c,this.voronoiStyle=r,this.smoothness=n,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let i,r=[];switch(r.push("displaced_position"),r.push("displaced_normal"),Object.values(JL)[this.displacementTypeIndex.value]){case"map":{i=e.include(Iie.Nodes.map),r.push(this.movementOrTexture.getTexture(e,"t")),r.push("uv"),r.push(this.cropOrOffset.build(e,"f")),this.mat&&r.push(this.mat.build(e,"mat3"));break}case"noise":{let n=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],s=new jt(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new jt(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[_l.simplexPrecise,_l.simplexFractal,_l.simplexAshima,_l.fbm,_l.perlin,_l.voronoi]),l=new jt(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);i=e.include(l),r.push(this.scale.build(e,"f")),r.push(this.cropOrOffset.build(e,"v3")),r.push(this.movementOrTexture.build(e,"f")),r.push(this.voronoiStyle.build(e,"i")),r.push(this.smoothness.build(e,"f")),r.push(this.seed.build(e,"f")),r.push(this.highCut.build(e,"f")),r.push(this.lowCut.build(e,"f")),r.push(this.quality.build(e,"i"));break}}return r.push(this.intensity.build(e,"f")),r.push("displaced_normal"),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Oie=Iie;Oie.Nodes=function(){let e=new jt(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new jt(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new jt(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var xi={normalRenderTarget:new Vd,normalRenderTargetDepth:new Vd,transmissionRenderTarget:new Vd,aspectRatio:new ka,transmissionSize:new ka(2048,2048),transmissionRenderTargetDepth:new Vd,aoRenderTarget:new Vd,aoEnabled:new Uo,pixelRatioNode:new Zt(1),resolution:new ka,penumbraSize:new ng(5,.5),frameIndex:new nn(0),transmissionLod:new nn(2)};for(let e of Object.values(xi))e.isRenderGlobal=!0;var Rie={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.81/build/ui.wasm"},az=class extends Xs{constructor(){super("basic"),this.nodeType="Basic",this.color=new es(su),this.shadingAlpha=new Zt(1),this.shadingBlend=new nn(0),this.previousModelViewMatrix=new zh,this.previouseProjectionMatrix=new zh}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({resolution:xi.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(s1.merge([Ut.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),r.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{this.color===void 0&&(this.color=new es(su)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let i=this.color.flow(e,"c",{slot:"color"}),r=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=r!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",i.code];r&&a.push(r.code,"#ifdef ALPHATEST"," if ( "+r.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${i.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),r?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${r.result} * ${o} );`):a.push("gl_FragColor = vec4("+i.result+", 1.0 );"),n&&a.push(`gl_FragColor.a *= ${n.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},mje=class extends Xs{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new es(su),this.emissive=new es(0),this.emissiveIntensity=new Zt(1),this.previousModelViewMatrix=new zh,this.previouseProjectionMatrix=new zh,this.shadingAlpha=new Zt(1),this.shadingBlend=new nn(0),this.occlusion=new Uo(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({resolution:xi.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(s1.merge([Ut.fog,Ut.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),r.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:xi.penumbraSize}),e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({aoMap:xi.aoRenderTarget}),e.mergeUniform({aoEnabled:xi.aoEnabled}),this.color===void 0&&(this.color=new es(su)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),r=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),u&&h.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),r&&h.push(r.code,"reflectedLight.directDiffuse += "+r.result+" * "+n.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},Wy=function(){let e=new jt(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new jt(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),gje=class extends Xs{constructor(){super("phong"),this.nodeType="Phong",this.color=new es(su),this.specular=new es(1118481),this.shininess=new Zt(30),this.previousModelViewMatrix=new zh,this.previouseProjectionMatrix=new zh,this.shadingAlpha=new Zt(1),this.shadingBlend=new nn(0),this.occlusion=new Uo(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({resolution:xi.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(s1.merge([Ut.fog,Ut.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:xi.penumbraSize}),e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({aoMap:xi.aoRenderTarget}),e.mergeUniform({aoEnabled:xi.aoEnabled}),this.color===void 0&&(this.color=new es(su)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(Wy.dHdxy),e.include(Wy.perturbNormalArb);let f=this.bumpMap.texture.flow(e,"t"),m=this.bumpMap.flow(e,"v3"),g=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${g});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${g});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${g});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${g});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}h.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),u&&h.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result});`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},vje=class extends Xs{constructor(){super("standard"),this.nodeType="Standard",this.color=new es(su),this.roughness=new Zt(.3),this.metalness=new Zt(0),this.reflectivity=new Zt(.5),this.previousModelViewMatrix=new zh,this.previouseProjectionMatrix=new zh,this.shadingAlpha=new Zt(1),this.shadingBlend=new nn(0),this.occlusion=new Uo(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({resolution:xi.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(s1.merge([Ut.fog,Ut.lights])),Ut.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:xi.penumbraSize}),e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({aoMap:xi.aoRenderTarget}),e.mergeUniform({aoEnabled:xi.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new es(su)),this.color.analyze(e,{slot:"color",context:i}),this.roughness.analyze(e),this.metalness.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:i}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),u=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(Wy.dHdxy),e.include(Wy.perturbNormalArb);let g=this.bumpMap.texture.flow(e,"t"),y=this.bumpMap.flow(e,"v3"),x=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",w="";this.bumpMap.projection.value===4?w=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${g.result}, uv0, ${x});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${g.result}, uv1, ${x});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${g.result}, uv2, ${x});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:w=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${g.result}, bumpMapCachedUv, ${x});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${y.result};
					${w}
					`)}if(f.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let g=this.roughnessMap.texture.flow(e,"t"),y=this.roughnessMap.flow(e,"v3"),x="";this.roughnessMap.projection.value===4?x=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${g.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${g.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${g.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:x=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${g.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${y.result};

					const float roughnessScale = 1.0;

					${x}
				`)}else f.push(s.code,"	float roughnessFactor = "+s.result+";");c&&f.push(c.code,"#ifdef ALPHATEST","	if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?f.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let m="1.0";this.mask&&(this.mask.analyze(e),m=`luminance(${this.mask.flow(e,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${m} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${m}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),u&&f.push(u.code,`outgoingLight = spe_blend(outgoingLight, ${u.result}, 1.0, SPE_BLENDING_NORMAL);`),c?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&f.push(`gl_FragColor.a *= ${h.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=f.join(`
`)}return t}},yje=class extends Xs{constructor(){super("toon"),this.nodeType="Toon",this.color=new es(su),this.specular=new es(1118481),this.shininess=new Zt(30),this.previousModelViewMatrix=new zh,this.previouseProjectionMatrix=new zh,this.shadingAlpha=new Zt(1),this.shadingBlend=new nn(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({resolution:xi.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(s1.merge([Ut.fog,Ut.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:xi.penumbraSize}),e.mergeUniform({frameIndex:xi.frameIndex}),e.mergeUniform({aoMap:xi.aoRenderTarget}),e.mergeUniform({aoEnabled:xi.aoEnabled}),this.color===void 0&&(this.color=new es(su)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(Wy.dHdxy),e.include(Wy.perturbNormalArb);let d=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,c.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${g}
					`)}c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",r.code,"	vec3 specular = "+r.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${a.result} );
				}
				`),o&&c.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&c.push(`gl_FragColor.a *= ${u.result};`),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=c.join(`
`)}return t}},xje=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),i=this.cache.get(e);return i===void 0?(i={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,i)):(i.time=t,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},bje=class extends xje{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},II;function _je(e){return typeof e=="string"?e:(II||(II=new bje),II.load(e))}var wje=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},Eje=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},Lie=class extends wje{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isBuffer=e.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let r of Object.values(this._cache))for(let n of Object.values(r))for(let s of Object.values(n))s&&(s.image=this.img,s.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var i=new FileReader;i.readAsDataURL(new Blob([e],{type:"video/mp4"}));let r;await new Promise(n=>{i.onloadend=s=>{var a;r=(a=s.target)==null?void 0:a.result,n(null)}}),this.img.src=r}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=_je(e),this.img.onload=t,await new Promise(r=>{this.img.onload=()=>{t(),r(null)}})}getTexture(e,t=1008,i=1006){var n,s;let r=(s=(n=this._cache[e])==null?void 0:n[t])==null?void 0:s[i];if(r)return r;{let a;return this.isBuffer?a=this.img.texture:this.isVideo?a=new HDe(this.img,void 0,e,e):a=new jn(this.img,void 0,e,e,i,t),this.loaded&&(a.needsUpdate=!0),this._cache[e]===void 0&&(this._cache[e]={}),this._cache[e][t]===void 0&&(this._cache[e][t]={}),this._cache[e][t][i]=a,a}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let i of Object.values(t))for(let r of Object.values(i))r&&(r.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[i,r]of Object.entries(t))for(let[n,s]of Object.entries(r))s==null||s.dispose(),this._cache[e]!==void 0&&this._cache[e][i]!==void 0&&(this._cache[e][i][n]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},mp=class extends Lie{};function Sje(e,t){var i=Mje(t);return i.formatToParts?Cje(i,e):Aje(i,e)}var Tje={year:0,month:1,day:2,hour:3,minute:4,second:5};function Cje(e,t){try{for(var i=e.formatToParts(t),r=[],n=0;n<i.length;n++){var s=Tje[i[n].type];s>=0&&(r[s]=parseInt(i[n].value,10))}return r}catch(a){if(a instanceof RangeError)return[NaN];throw a}}function Aje(e,t){var i=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(i);return[r[3],r[1],r[2],r[4],r[5],r[6]]}var OI={};function Mje(e){if(!OI[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),i=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";OI[e]=i?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return OI[e]}function Nie(e,t,i,r,n,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,i),o.setUTCHours(r,n,s,a),o}var pW=36e5,Pje=6e4,RI={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function kie(e,t,i){var r,n;if(!e||(r=RI.timezoneZ.exec(e),r))return 0;var s;if(r=RI.timezoneHH.exec(e),r)return s=parseInt(r[1],10),mW(s)?-(s*pW):NaN;if(r=RI.timezoneHHMM.exec(e),r){s=parseInt(r[1],10);var a=parseInt(r[2],10);return mW(s,a)?(n=Math.abs(s)*pW+a*Pje,s>0?-n:n):NaN}if(Oje(e)){t=new Date(t||Date.now());var o=i?t:Dje(t),l=eN(o,e),u=i?l:Ije(t,l,e);return-u}return NaN}function Dje(e){return Nie(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function eN(e,t){var i=Sje(e,t),r=Nie(i[0],i[1]-1,i[2],i[3]%24,i[4],i[5],0).getTime(),n=e.getTime(),s=n%1e3;return n-=s>=0?s:1e3+s,r-n}function Ije(e,t,i){var r=e.getTime(),n=r-t,s=eN(new Date(n),i);if(t===s)return t;n-=s-t;var a=eN(new Date(n),i);return s===a?s:Math.max(s,a)}function mW(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var gW={};function Oje(e){if(gW[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),gW[e]=!0,!0}catch{return!1}}var Rje=nm(ITe(),1),vW=nm(OTe(),1),Lje=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,Nje=Lje,LI=36e5,yW=6e4,kje=2,jo={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Nje};function Bje(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var i={},r=i.additionalDigits==null?kje:(0,Rje.default)(i.additionalDigits);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=zje(e),s=Fje(n.date,r),a=s.year,o=s.restDateString,l=Uje(o,a);if(isNaN(l))return new Date(NaN);if(l){var u=l.getTime(),c=0,h;if(n.time&&(c=jje(n.time),isNaN(c)))return new Date(NaN);if(n.timeZone||i.timeZone){if(h=kie(n.timeZone||i.timeZone,new Date(u+c)),isNaN(h))return new Date(NaN)}else h=(0,vW.default)(new Date(u+c)),h=(0,vW.default)(new Date(u+c+h));return new Date(u+c+h)}else return new Date(NaN)}function zje(e){var t={},i=jo.dateTimePattern.exec(e),r;if(i?(t.date=i[1],r=i[3]):(i=jo.datePattern.exec(e),i?(t.date=i[1],r=i[2]):(t.date=null,r=e)),r){var n=jo.timeZone.exec(r);n?(t.time=r.replace(n[1],""),t.timeZone=n[1].trim()):t.time=r}return t}function Fje(e,t){var i=jo.YYY[t],r=jo.YYYYY[t],n;if(n=jo.YYYY.exec(e)||r.exec(e),n){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=jo.YY.exec(e)||i.exec(e),n){var a=n[1];return{year:parseInt(a,10)*100,restDateString:e.slice(a.length)}}return{year:null}}function Uje(e,t){if(t===null)return null;var i,r,n,s;if(e.length===0)return r=new Date(0),r.setUTCFullYear(t),r;if(i=jo.MM.exec(e),i)return r=new Date(0),n=parseInt(i[1],10)-1,bW(t,n)?(r.setUTCFullYear(t,n),r):new Date(NaN);if(i=jo.DDD.exec(e),i){r=new Date(0);var a=parseInt(i[1],10);return Wje(t,a)?(r.setUTCFullYear(t,0,a),r):new Date(NaN)}if(i=jo.MMDD.exec(e),i){r=new Date(0),n=parseInt(i[1],10)-1;var o=parseInt(i[2],10);return bW(t,n,o)?(r.setUTCFullYear(t,n,o),r):new Date(NaN)}if(i=jo.Www.exec(e),i)return s=parseInt(i[1],10)-1,_W(t,s)?xW(t,s):new Date(NaN);if(i=jo.WwwD.exec(e),i){s=parseInt(i[1],10)-1;var l=parseInt(i[2],10)-1;return _W(t,s,l)?xW(t,s,l):new Date(NaN)}return null}function jje(e){var t,i,r;if(t=jo.HH.exec(e),t)return i=parseFloat(t[1].replace(",",".")),NI(i)?i%24*LI:NaN;if(t=jo.HHMM.exec(e),t)return i=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),NI(i,r)?i%24*LI+r*yW:NaN;if(t=jo.HHMMSS.exec(e),t){i=parseInt(t[1],10),r=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return NI(i,r,n)?i%24*LI+r*yW+n*1e3:NaN}return null}function xW(e,t,i){t=t||0,i=i||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var n=r.getUTCDay()||7,s=t*7+i+1-n;return r.setUTCDate(r.getUTCDate()+s),r}var Vje=[31,28,31,30,31,30,31,31,30,31,30,31],Hje=[31,29,31,30,31,30,31,31,30,31,30,31];function Bie(e){return e%400===0||e%4===0&&e%100!==0}function bW(e,t,i){if(t<0||t>11)return!1;if(i!=null){if(i<1)return!1;var r=Bie(e);if(r&&i>Hje[t]||!r&&i>Vje[t])return!1}return!0}function Wje(e,t){if(t<1)return!1;var i=Bie(e);return!(i&&t>366||!i&&t>365)}function _W(e,t,i){return!(t<0||t>52||i!=null&&(i<0||i>6))}function NI(e,t,i){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||i!=null&&(i<0||i>=60))}function Gje(e,t,i){var r=Bje(e,i),n=kie(t,r,!0),s=new Date(r.getTime()-n),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}function Go(e,t){return t.color(e)}function wW(e=new Date,t){let i=t.format,r=e.getSeconds(),n=e;t&&t.timeZone!==null&&(n=Gje(new Date,t.timeZone));let s=n.getHours(),a=n.getMinutes(),o;t.format12h24h==="12ampm"&&(o=s>=12?"PM":"AM");let l=s;t.format12h24h!=="24"&&(l=s%12,l===0&&(l=12));let u,c;switch(i){case"HH:mm:ss":u=[l,a,r];break;case"HH:mm":u=[l,a];break;case"HH":u=[l],o=void 0;break;case"mm":u=[a],o=void 0;break;case"ss":u=[r],o=void 0;break;case"year":c=n.getFullYear();break;case"month":c=n.getMonth()+1;break;case"dayOfYear":c=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":c=n.getDate();break;case"secondOfDay":c=s*60*60+a*60+r;break;default:console.error("Unknown time format",i),c=0;break}return u!==void 0?{textValue:u,suffix:o}:c}function qje(e,t){switch(e.type){case"fresnel":return Kje(e,t);case"gradient":return $je(e,t);case"depth":return Zje(e,t);case"normal":return Qje(e,t);case"noise":return Jje(e,t);case"rainbow":return eVe(e,t);case"toon":return tVe(e,t);case"outline":return iVe(e,t);case"transmission":return rVe(e,t);case"color":return Xje(e,t);case"pattern":return nVe(e,t)}}function Yje(e){return{type:e.type}}function Lc(e,t){let{alpha:i,mode:r,isMask:n}=e,s=typeof i=="string"?(Number(t.getVariable(i))??100)/100:i;return{...Yje(e),alpha:s,mode:r,isMask:n}}function Xje(e,t){return{...Lc(e,t),color:Go(e.color,t)}}function Kje(e,t){let{bias:i,scale:r,intensity:n,factor:s,color:a}=e;return{...Lc(e,t),color:Go(a,t),bias:i,scale:r,intensity:n,factor:s}}function $je(e,t){let{gradientType:i,smooth:r,colors:n,steps:s,angle:a,offset:o,morph:l}=e;return{...Lc(e,t),gradientType:i,smooth:r,colors:n.map(u=>new Pi(u[0],u[1],u[2],u[3])),num:n.length,steps:s,offset:new Ie(...o),morph:new Ie(...l),angle:a}}function Zje(e,t){let{gradientType:i,near:r,far:n,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:u,steps:c,smooth:h}=e;return{...Lc(e,t),gradientType:i,near:r,far:n,isVector:s,isWorldSpace:a,origin:new q(...o),direction:l?new q(...l):new q(1,0,0),colors:u.map(d=>d!==void 0?new Pi(d[0],d[1],d[2],d[3]):new Pi(0,0,0,0)),steps:c.slice(0,u.length),smooth:h}}function Qje(e,t){let{cnormal:i}=e;return{...Lc(e,t),cnormal:new q(i[0],i[1],i[2])}}function Jje(e,t){return{...Lc(e,t),scale:e.scale,move:e.move,fA:new Ie(...e.fA),fB:new Ie(...e.fB),size:new q(...e.size),distortion:new Ie(...e.distortion),colorA:Go(e.colorA,t),colorB:Go(e.colorB,t),colorC:Go(e.colorC,t),colorD:Go(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function eVe(e,t){return{...Lc(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new q(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new q(...e.offset)}}function tVe(e,t){return{...Lc(e,t),positioning:e.positioning,colors:e.colors.map(i=>new Pi(i[0],i[1],i[2],i[3])),num:e.colors.length,steps:e.steps,source:new q(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:Go(e.shadowColor,t),offset:new q(...e.offset)}}function iVe(e,t){return{...Lc(e,t),outlineColor:Go(e.outlineColor,t),contourColor:Go(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new q(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function rVe(e,t){return{...Lc(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function nVe(e,t){return{...Lc(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new Ie(...e.offset),colorA:Go(e.colorA,t),colorB:Go(e.colorB,t),frequency:new Ie(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new Ie(...e.vertical),horizontal:new Ie(...e.horizontal),sides:e.sides}}var bA=class extends Wa{},sVe={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},aVe={depth:["colors"]};function oVe(e,t,i){var s,a;if(t==="isMask")return!0;let r=sVe[e.type],n=aVe[e.type];if(n!==void 0){let o=e.color;if(n.includes(t)){let l=(a=(s=o[t])==null?void 0:s.value)==null?void 0:a.length;if(l!==void 0&&l!==i.length)return!0}}return r!==void 0?r.includes(t):!1}function zie(e,t,i){let r=i.uniforms[`f${i.id}_texture`];if(!r)return!1;let n=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=r;l.image instanceof mp||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=r;l.image instanceof mp||l.image.deref(),l.image=o}if("wrapping"in s){let a=r;a.wrap=s.wrapping}if("minFilter"in s){let a=r;a.minFilter=s.minFilter}if("magFilter"in s){let a=r;a.magFilter=s.magFilter}if("rotation"in s&&i.uniforms[`f${i.id}_rotation`])return i.uniforms[`f${i.id}_rotation`].value=(s.rotation??0)*Xt.DEG2RAD,n;if("repeat"in s||"offset"in s||"rotation"in s){let a="mat",o=i.uniforms[`f${i.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),"rotation"in s&&(o.rotation=s.rotation??0),o.updateMatrix()}return n}function lVe(e,t,i,r){let n=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||a===void 0)continue;if(Uie(s,i,r,t)){s==="visible"&&i.type==="light"&&(n=!0);continue}i.visible=r.visible;let o=i.uniforms[`f${i.id}_${s}`];if(o&&!(o instanceof nz))switch(n=n||oVe(i,s,a),o.constructor){case es:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof bA?o.value=new Wa(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case Nd:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof bA?o.value=new Wa(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case ka:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case Su:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case Vd:{zie(a,t,i);break}case sg:{o.value=a.map(l=>new Pi(...l));break}default:{o.value=a;break}}}return n}var Zg=(e,t,i)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,i)??100)/100))??1,ow=class{constructor(e,t,i,r,n){this.id=e,this.uuid=t,this.data=i,this.uniforms={};for(let s in r)this.uniforms[`f${this.id}_${s}`]=r[s];for(let s in i)Uie(s,this,i,n)}get type(){return this.data.type}static create(e,t,i,r){if(i.type==="light")return uh.createLightLayer(e,t,i,r);if(i.type==="texture"||i.type==="video"){let n=i.type==="texture"?r.uiBuffer(i.texture.image)??r.image(i.texture.image):r.video(i.texture.video),s=new ZL(n,i.texture.wrapping,i.texture.minFilter??1008,i.texture.magFilter??1006),a=new cje(n),o=new hje(i.texture.repeat,i.texture.offset,i.texture.rotation??0),l=new Zt(i.crop?1:0),u=new nn(i.projection??0),c=new nn(["x","y","z"].indexOf(i.axis)??0),h=new nn(i.side??0),d=new ka(i.size?new Ie(i.size[0],i.size[1]):new Ie(100,100)),f=new Zt(i.blending??0),m=new Zt(Zg(i.alpha,r)),g=new nn(i.mode??0),y=new Uo(i.isMask??!1),x=new sz(s,a,l,u,c,h,d,f,o,m,g,y),w=new yn(x.calpha,"f");return new Xn(e,t,i,{texture:s,textureSize:a,crop:l,projection:u,axis:c,side:h,size:d,blending:f,mat:o,alpha:m,mode:g,isMask:y},x,g,w,y,r)}else if(i.type==="matcap"){let n=r.image(i.texture.image),s=new ZL(n,i.texture.wrapping,i.texture.minFilter??1008,i.texture.magFilter??1006),a=new Zt(Zg(i.alpha,r)),o=new nn(i.mode??0),l=new Uo(i.isMask??!1),u=new Zt((i.texture.rotation??0)*Xt.DEG2RAD),c=new bie(s,a,o,l,u),h=new yn(c.calpha,"f");return new Xn(e,t,i,{texture:s,alpha:a,mode:o,isMask:l,rotation:u},c,o,h,l,r)}else if(i.type==="displace")if(i.displacementType==="noise"){let n=new Su(new q(...i.offset)),s=new Zt(i.scale??10),a=new Zt(i.intensity??8),o=new Zt(i.movement??1),l=new nn(i.noiseType??0),u=new nn(i.voronoiStyle??0),c=new Zt(i.smoothness??.5),h=new Zt(i.seed??0),d=new Zt(i.highCut??1),f=new Zt(i.lowCut??0),m=new nn(i.quality??1),g=new Oie(a,o,n,u,c,h,d,f,m,s,l);return new Fie(e,t,i,{offset:n,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:u,smoothness:c,seed:h,highCut:d,lowCut:f,quality:m},g,r)}else throw new Error;else return hVe(e,t,i,r)}updateByOp(e,t,i){let r=e;if(r.path[0]===void 0){if(r.type===0)return"type"in r.props||"category"in r.props||"visible"in r.props||"noiseType"in r.props?(i.scene.markNeedsUpdateRendererDirty(),!0):lVe(r.props,i.shared,this,t)}else if(r.path[0]==="texture")return"texture"in t||"video"in t?zie(r.props,i.shared,this):!0;return!1}dispose(){if(uVe(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof mp||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let i=`f${this.id}_${e}`;this.hasValueByKey(i)&&t!==void 0&&(this.uniforms[i].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let i=this.getName(t);i&&e.push(i)}return e}},Xn=class extends ow{constructor(e,t,i,r,n,s,a,o,l){super(e,t,i,r,l),this.params=r,this.color=n,this.mode=s,this.alpha=a,this.isMask=o}},Fie=class extends ow{constructor(e,t,i,r,n,s){super(e,t,i,r,s),this.position=n}},uh=class extends ow{constructor(e,t,i,r,n,s){super(e,t,i,n,s),this.node=r}static createLightLayer(e,t,i,r){let n,s=new Zt(Zg(i.alpha,r)),a=new nn(i.mode),o=new Zt(i.bumpMapIntensity),l=new Zt(Zg(i.alphaOverride,r)),u;if(!i.visible)n=new az,u={};else if(i.category==="lambert"){n=new mje;let c=new es(r.color(i.emissive)??0),h=new Uo(i.occlusion??!0);u={emissive:c,occlusion:h},n.emissive=c,n.occlusion=h}else if(i.category==="toon"){n=new yje;let c=new Zt(i.shininess??30),h=new es(r.color(i.specular)??1118481);u={shininess:c,specular:h},n.shininess=c,n.specular=h}else if(i.category==="physical"){n=new vje;let c=new Zt(i.roughness??.3),h=new Zt(i.metalness??0),d=new Zt(i.reflectivity??.5),f=new Uo(i.occlusion??!0);u={roughness:c,metalness:h,reflectivity:d,occlusion:f},n.roughness=c,n.metalness=h,n.reflectivity=d,n.occlusion=f}else{n=new gje;let c=new Zt(i.shininess??30),h=new es(i.specular!==void 0?r.color(i.specular)??1118481:1118481),d=new Uo(i.occlusion??!0);u={shininess:c,specular:h,occlusion:d},n.shininess=c,n.specular=h,n.occlusion=d}return n.alpha=new Zt(1),n.shadingAlpha=s,n.shadingBlend=a,n.bumpMapIntensity=o,n.alphaOverride=l,u.alpha=n.shadingAlpha,u.mode=n.shadingBlend,u.bumpMapIntensity=n.bumpMapIntensity,u.alphaOverride=n.alphaOverride,new uh(e,t,i,n,u,r)}get category(){return this.node.category}};function uVe(e){let t=e instanceof ow?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function xu(e){return{alpha:new Zt(e.alpha??1),mode:new nn(e.mode??0),isMask:new Uo(e.isMask??!1)}}function cVe(e,t,i,r,n){switch(e.type){case"color":{let s=new es(r.color??su),a=xu(r),o=new QL(s,a.alpha),l=new yn(o.calpha,"f");return new Xn(t,i,e,{color:s,...a},o,a.mode,l,a.isMask,n)}case"fresnel":{let s=new es(r.color??16777215),a=new Zt(r.bias??.1),o=new Zt(r.scale??1),l=new Zt(r.intensity??2),u=new Zt(r.factor??1),c=xu(r),h=new dje(s,a,o,l,u,c.alpha,c.mode,c.isMask),d=new yn(h.calpha,"f");return new Xn(t,i,e,{color:s,bias:a,scale:o,intensity:l,factor:u,...c},h,c.mode,d,c.isMask,n)}case"rainbow":{let s=new Zt(r.filmThickness??30),a=new Zt(r.movement??0),o=new Su(r.wavelengths??new q(0,0,0)),l=new Zt(r.noiseStrength??0),u=new Zt(r.noiseScale??1),c=new Su(r.offset??new q(0,0,0)),h=xu(r),d=new Cie(s,a,o,l,u,c,h.alpha,h.isMask),f=new yn(d.calpha,"f");return new Xn(t,i,e,{filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:u,offset:c,...h},d,h.mode,f,h.isMask,n)}case"transmission":{let s=new Zt(r.thickness??10),a=new Zt(r.ior??1.5),o=new Zt(r.roughness??.5),l=xi.transmissionSize,u=xi.transmissionRenderTarget,c=xi.transmissionRenderTargetDepth,h=window.innerWidth,d=window.innerHeight,f=h>=d?new ka(d/h,1):new ka(1,h/d),m=xu(r),g=new Die(s,a,o,l,u,c,f,m.alpha),y=new yn(g.calpha,"f");return new Xn(t,i,e,{thickness:s,ior:a,roughness:o,aspectRatio:f,...m},g,m.mode,y,m.isMask,n)}case"toon":{let s=new nn(r.positioning??0),a;r.colors?a=new sg(r.colors.length,r.colors):(a=new sg(10,new Pi(0,0,0,1)),a.value[1]=new Pi(1,1,1,1));let o;r.steps?o=new ng(r.steps.length,r.steps):(o=new ng(10,1),o.value[0]=0);let l=new Su(r.source??new q(0,0,0)),u=new Uo(r.isWorldSpace??!0),c=new Zt(r.noiseStrength??0),h=new Zt(r.noiseScale??1),d=new Nd(r.shadowColor),f=new Su(r.offset??new q(0,0,0)),m=xu(r),g=new Mie(s,a,o,l,u,c,h,d,f,m.alpha),y=new yn(g.calpha,"f");return new Xn(t,i,e,{positioning:s,colors:a,steps:o,source:l,isWorldSpace:u,noiseStrength:c,noiseScale:h,shadowColor:d,offset:f,...m},g,m.mode,y,m.isMask,n)}case"outline":{let s=new es(r.outlineColor??16777215),a=new es(r.contourColor??16777215),o=new Zt(r.outlineWidth??.1),l=new Zt(r.contourWidth??.1),u=new Zt(r.outlineThreshold??.1),c=new Zt(r.contourThreshold??.1),h=new Zt(r.outlineSmoothing??.1),d=new Zt(r.contourFrequency??.1),f=new Su(r.contourDirection??new q(0,1,0)),m=new Uo(r.positionalLines??!1),g=new Uo(r.compensation??!0),y=xi.normalRenderTarget,x=xi.normalRenderTargetDepth,w=xi.pixelRatioNode,b=xi.resolution,C=xu(r),A=new Eie(s,a,o,l,u,c,h,d,f,m,g,b,y,x,w,C.alpha),E=new yn(A.calpha,"f");return new Xn(t,i,e,{outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:u,contourThreshold:c,outlineSmoothing:h,contourFrequency:d,contourDirection:f,positionalLines:m,compensation:g,...C},A,C.mode,E,C.isMask,n)}case"depth":{let s=new nn(r.gradientType??0),a=new Uo(r.smooth??!1),o=new Zt(r.near??50),l=new Zt(r.far??200),u=new Zt(r.isVector??1),c=new Zt(r.isWorldSpace??0),h=new Su(r.origin??new q),d=new Su(r.direction??new q),f;r.colors?f=new sg(r.colors.length,r.colors):(f=new sg(2,new Pi(0,0,0,1)),f.value[1]=new Pi(1,1,1,1));let m;r.steps?m=new ng(r.steps.length,r.steps):(m=new ng(2,1),m.value[0]=0);let g=xu(r),y=new gie(s,a,o,l,u,c,h,d,f,m,g.alpha,g.isMask),x=new yn(y.calpha,"f");return new Xn(t,i,e,{gradientType:s,smooth:a,near:o,far:l,isVector:u,isWorldSpace:c,origin:h,direction:d,colors:f,steps:m,...g},y,g.mode,x,g.isMask,n)}case"noise":{let s=new Zt(r.scale??1),a=new Su(r.size??new q(100,100,100)),o=new Zt(r.move??1),l=new ka(r.fA??new Ie(1.7,9.2)),u=new ka(r.fB??new Ie(8.3,2.8)),c=new ka(r.distortion??new Ie(1,1)),h=new Nd(r.colorA),d=new Nd(r.colorB),f=new Nd(r.colorC),m=new Nd(r.colorD),g=new nn(r.noiseType??0),y=new nn(r.voronoiStyle??0),x=new Zt(r.highCut??1),w=new Zt(r.lowCut??0),b=new Zt(r.smoothness??.5),C=new Zt(r.seed??.5),A=new nn(r.quality??1),E=xu(r),_=new _ie(s,a,o,l,u,c,h,d,f,m,E.alpha,g,E.isMask,y,x,w,b,C,A),P=new yn(_.calpha,"f");return new Xn(t,i,e,{scale:s,size:a,move:o,fA:l,fB:u,distortion:c,colorA:h,colorB:d,colorC:f,colorD:m,noiseType:g,...E,voronoiStyle:y,highCut:x,lowCut:w,smoothness:b,seed:C,quality:A},_,E.mode,P,E.isMask,n)}case"normal":{let s=new Su(r.cnormal??new q(1,1,1)),a=xu(r),o=new mie(s,a.alpha),l=new yn(o.calpha,"f");return new Xn(t,i,e,{cnormal:s,...a},o,a.mode,l,a.isMask,n)}case"gradient":{let s=new nn(r.gradientType??0),a=new Uo(r.smooth??!1),o;r.colors?o=new sg(r.colors.length,r.colors):(o=new sg(10,new Pi(0,0,0,1)),o.value[1]=new Pi(1,1,1,1));let l;r.steps?l=new ng(r.steps.length,r.steps):(l=new ng(10,1),l.value[0]=0);let u=new ka(r.offset??new Ie(0,0)),c=new ka(r.morph??new Ie(0,0)),h=new Zt(r.angle??0),d=xu(r),f=new yie(s,a,o,l,u,c,h,d.alpha,d.isMask),m=new yn(f.calpha,"f");return new Xn(t,i,e,{gradientType:s,smooth:a,colors:o,steps:l,offset:u,morph:c,angle:h,...d},f,d.mode,m,d.isMask,n)}case"pattern":{let s=new nn(r.style??0),a=new nn(r.projection??0),o=new nn(["x","y","z"].indexOf(r.axis)??0),l=new Zt(r.blending??0),u=new ka(r.offset??new Ie(0,0)),c=new Nd(r.colorA),h=new Nd(r.colorB),d=new ka(r.frequency??new Ie(10,10)),f=new Zt(r.size??.5),m=new Zt(r.variation??0),g=new Zt(r.smoothness??.5),y=new Zt(r.zigzag??0),x=new Zt(r.rotation??0),w=new ka(r.vertical??new Ie(0,1)),b=new ka(r.horizontal??new Ie(0,1)),C=new nn(r.sides??6),A=xu(r),E=new Sie(s,a,o,l,u,c,h,d,f,m,g,y,x,w,b,C,A.alpha,A.isMask),_=new yn(E.calpha,"f");return new Xn(t,i,e,{style:s,projection:a,axis:o,blending:l,offset:u,colorA:c,colorB:h,frequency:d,size:f,variation:m,smoothness:g,zigzag:y,rotation:x,vertical:w,horizontal:b,sides:C,...A},E,A.mode,_,A.isMask,n)}default:{let s=new es(1,0,0,1),a=xu(r),o=new QL(s,a.alpha),l=new yn(o.calpha,"f");return new Xn(t,i,e,{color:s,...a},o,a.mode,l,a.isMask,n)}}}function hVe(e,t,i,r){let n=qje(i,r);return cVe(i,e,t,n,r)}function Uie(e,t,i,r){if(i.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=i.intensity*(i.visible?1:0),n):void 0}if(i.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=Zg(i.alpha,r)*(i.visible?1:0),i.type==="outline"&&e==="visible"){let s=t.uniforms[`f${t.id}_compensation`];s&&(s.value=i.compensation&&i.visible)}return n}}function X0(e,t){let i=0,r=e.layers.find(n=>n.data.type==="light");if(r){let n=r.data,s=Number(t.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?s/100:n.alphaOverride)<1)return!0}for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(typeof s=="string"&&(s=Math.max(0,Math.min(1,Number(t.getVariable(s)??100)/100))),s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let a of n.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&n.data.type==="noise"){let a=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,u=t.color(n.data.colorD).a,c=Math.min(a,Math.min(o,Math.min(l,u)));c<1&&(s=c)}i+=(1-i)*s}}return i<1}var Kp=class extends Cr{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},dVe=class extends Kp{constructor(e,t,i,r){super(),this.flatShading=e,this.side=t,this.wireframe=i,this.root=r}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,Object.assign(this.defines,e.defines),Object.assign(this.uniforms,e.uniforms),this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,i,r){return this.root.getFlavor(e,t,i,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,i){this.root.updateByOp(e,t,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},oz=class extends Kp{constructor(e,t,i=!0){super(),this.data=e,this.allowVariableSaves=i,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,Xs.startContext(this),this.reset0(e,t),Xs.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,i,r){let n=i?6:(e?3:0)+t;if(n+=(((r==null?void 0:r.resolutionLevel)??0)-(r!=null&&r.useChildrenColors?4:0))*7,n===0)return this;this.flavors===void 0&&(this.flavors=[]),n-=1;let s=this.flavors[n];return s===void 0&&(s=new dVe(e,t,i,this),s.needsJitter=this.needsJitter,this.flavors[n]=s,s.flatShading=e,s.side=t,s.updateAfterBuild(),r&&(s.defines.SHAPEBLEND=r.resolutionLevel,s.defines.SHAPEBLEND_C=r.useChildrenColors?1:0)),s}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t,i=!1){Xs.startContext(this),(this.data!==e||i)&&this.reset0(e,t),Xs.endContext(this)}reset0(e,t){this.data=e;let i=e.layers??ba.defaultTwoLayerData("phong").layers;try{this.layers=i.map(r=>ow.create(this.layerIdGen++,r.id,r.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=X0(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,i){if(e[0]==="alphaOverride")this.transparent=X0(this.data,i.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let r=e[1],n=e[2];if(r&&n){let s=this.layers.find(a=>a.uuid===r);s!=null&&s.hasValue(n)&&(n==="alpha"?(this.transparent=X0(this.data,i.shared),s.setValue(n,Math.max(0,Math.min(Number(t)/100,1)))):s.setValue(n,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(i=>i.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(i=>{"alpha"in i.data&&typeof i.data.alpha=="string"&&e.shared.getVariable(i.data.alpha,["material",this.uuid,"layer",i.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(t=>t instanceof uh),this.lightLayer===void 0&&(this.lightLayer=new uh(0,"",{...ma.defaultData("light","phong"),visible:!1},new az,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(n=>n instanceof uh);if(!e)return;let t=e.data,i=t.bumpMap,r=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof Xn&&s.color instanceof sz&&(s.uuid===i&&(e.node.bumpMap=s.color),s.uuid===r&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,i){if(Xs.startContext(this),t!==void 0?this.data=t:t=this.data,this.transparent=X0(t,i.shared),e.path[0]==="layers"){let r=i.shared,n=e.path[1];if(n===void 0)i.scene.markNeedsUpdateRendererDirty(),this.reset0(t,i);else{e.type===0&&e.props.occlusion!==void 0&&i.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===n);if(s){let a=t.layers.data(n),o;e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?o={...e.props,alpha:Zg(e.props.alpha,r,["material",this.uuid,"layer",n,"alpha"])}:o={...e.props,alphaOverride:Zg(e.props.alphaOverride,r,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...e,...o?{props:o}:{},path:e.path.slice(2)},a,i)&&this.reset0(t,i)}}}else this.reset0(t,i);Xs.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof Xn?t.color.mask=void 0:t instanceof uh&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof Xn&&t.isMask.value&&t.data.visible&&e>0){let i=e-1,r=this.layers[i];r instanceof uh?r.node.mask=new yl(t.color,t.alpha,yl.MUL):r instanceof Xn&&(r.isMask.value||(r.color.mask=new yl(t.color,t.alpha,yl.MUL)))}}}blendColors(){let e=this.layers.findIndex(i=>i instanceof Xn),t=this.layers.findIndex(i=>i instanceof uh);if(e!==-1&&e<t){let i=this.layers[e].color;for(let r=e+1;r<t;++r){let n=this.layers[r];if(n instanceof Xn){if(n.isMask.value)continue;i=new fW(i,n.color,n.alpha,n.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let e=new yn("outgoingLight","f"),t=this.layers.findIndex(i=>i instanceof uh);if(this.layers.length>t+1){for(let i=t+1;i<this.layers.length;++i){let r=this.layers[i];if(r instanceof Xn){if(r.isMask.value)continue;e=new fW(e,r.color,r.alpha,r.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof Fie);if(e.length>0){let t=e[0].position;for(let i=1;i<e.length;++i)e[i]&&(t=new yl(t,e[i].position,yl.ADD),t=new yl(t,new Zt(.5).setReadonly(!0),yl.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.shapeBlendhack&&this.shapeBlendhack(this),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let i=(r,n,s)=>Math.min(Math.max(r,n),s);for(let r of this.layers)if(r.type==="displace"){let n=i(r.uniforms[`f${r.id}_intensity`].value,e,t);r.uniforms[`f${r.id}_intensity`].value=n}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new hie;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof Xn){let t=e.params.texture;if(t instanceof ZL&&!t.image.loaded)return!1}return!0}};Object.defineProperties(Kp.prototype,{properties:{get:function(){return this.fragment.properties}}});var tN=class extends oz{constructor(e,t,i){super(e,t,!1),this.uuid=i,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},EW=new Map;function fVe(e){if(typeof e=="string")return e;let t=EW.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},EW.set(e,t)),t.url}var jie,pVe=new Promise(e=>{jie=e}),SW=!1,bS;function mVe(){if(SW)return;if(bS)return bS;async function e(){await Ll(()=>import("./howler-DLicsSZy.js").then(t=>t.h),[]),jie(window!==void 0?window:global),SW=!0}return bS=e(),bS}var Vie;pVe.then(e=>Vie=e);function gVe(e){let t=!1;return e.scene.objects.traverse((i,r)=>{if(r.events===void 0||Array.isArray(r.events)===!1)return!0;let n=[];r.events.forEach(s=>{"dragDropActions"in s.data?(n.push(...s.data.dragDropActions.drag),n.push(...s.data.dragDropActions.drop)):"inActions"in s.data?(n.push(...s.data.inActions),n.push(...s.data.outActions)):"gameActions"in s.data?(n.push(...s.data.gameActions.idle),n.push(...s.data.gameActions.move),n.push(...s.data.gameActions.jump),n.push(...s.data.gameActions.run)):"breakpoints"in s.data?s.data.breakpoints.forEach(a=>{n.push(...a.data.actions)}):"actions"in s.data&&n.push(...s.data.actions),t=t||n.some(a=>a.data.type==="Audio")})}),t}var Zx=class{constructor({src:e,volume:t,delay:i,loop:r}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:fVe(e),format:"wav"},this.sound=new Vie.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),i!==void 0&&(this.delay=i),r!==void 0&&(this.loop=r)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,i){this.sound.on(e,t,i)}off(e,t,i){this.sound.off(e,t,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},vVe=class{constructor(){this.type="ShapePath",this.color=new mi,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new LC,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var i;return(i=this.currentPath)==null||i.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,n,s){var a;return(a=this.currentPath)==null||a.bezierCurveTo(e,t,i,r,n,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function i(f,m,g,y){let x=f.x,w=m.x,b=g.x,C=y.x,A=f.y,E=m.y,_=g.y,P=y.y,I=(C-b)*(A-_)-(P-_)*(x-b),D=(w-x)*(A-_)-(E-A)*(x-b),k=(P-_)*(w-x)-(C-b)*(E-A),B=I/k,z=D/k;if(k===0&&I!==0||B<=0||B>=1||z<0||z>1)return null;if(I===0&&k===0){for(let W=0;W<2;W++)if(r(W===0?g:y,f,m),t.loc===e.ORIGIN){let $=W===0?g:y;return{x:$.x,y:$.y,t:t.t}}else if(t.loc===e.BETWEEN){let $=+(x+t.t*(w-x)).toPrecision(10),Z=+(A+t.t*(E-A)).toPrecision(10);return{x:$,y:Z,t:t.t}}return null}else{for(let Z=0;Z<2;Z++)if(r(Z===0?g:y,f,m),t.loc===e.ORIGIN){let G=Z===0?g:y;return{x:G.x,y:G.y,t:t.t}}let W=+(x+B*(w-x)).toPrecision(10),$=+(A+B*(E-A)).toPrecision(10);return{x:W,y:$,t:B}}}function r(f,m,g){let y=g.x-m.x,x=g.y-m.y,w=f.x-m.x,b=f.y-m.y,C=y*b-w*x;if(f.x===m.x&&f.y===m.y){t.loc=e.ORIGIN,t.t=0;return}if(f.x===g.x&&f.y===g.y){t.loc=e.DESTINATION,t.t=1;return}if(C<-Number.EPSILON){t.loc=e.LEFT;return}if(C>Number.EPSILON){t.loc=e.RIGHT;return}if(y*w<0||x*b<0){t.loc=e.BEHIND;return}if(Math.sqrt(y*y+x*x)<Math.sqrt(w*w+b*b)){t.loc=e.BEYOND;return}let A;y!==0?A=w/y:A=b/x,t.loc=e.BETWEEN,t.t=A}function n(f,m){let g=[],y=[];for(let x=1;x<f.length;x++){let w=f[x-1],b=f[x];for(let C=1;C<m.length;C++){let A=m[C-1],E=m[C],_=i(w,b,A,E);_!==null&&g.find(P=>P.t<=_.t+Number.EPSILON&&P.t>=_.t-Number.EPSILON)===void 0&&(g.push(_),y.push(new Ie(_.x,_.y)))}}return y}function s(f,m,g){let y=new Ie;m.getCenter(y);let x=[];return g.forEach(w=>{w.boundingBox.containsPoint(y)&&n(f,w.points).forEach(b=>{x.push({identifier:w.identifier,isCW:w.isCW,point:b})})}),x.sort((w,b)=>w.point.x-b.point.x),x}function a(f,m,g,y,x){(x==null||x==="")&&(x="nonzero");let w=new Ie;f.boundingBox.getCenter(w);let b=[new Ie(g,w.y),new Ie(y,w.y)],C=s(b,f.boundingBox,m);C.sort((D,k)=>D.point.x-k.point.x);let A=[],E=[];C.forEach(D=>{D.identifier===f.identifier?A.push(D):E.push(D)});let _=A[0].point.x,P=[],I=0;for(;I<E.length&&E[I].point.x<_;)P.length>0&&P[P.length-1]===E[I].identifier?P.pop():P.push(E[I].identifier),I++;if(P.push(f.identifier),x==="evenodd"){let D=P.length%2===0,k=P[P.length-2];return{identifier:f.identifier,isHole:D,for:k}}else if(x==="nonzero"){let D=!0,k=null,B=null;for(let z=0;z<P.length;z++){let W=P[z];m[W]&&(D?(B=m[W].isCW,D=!1,k=W):B!==m[W].isCW&&(B=m[W].isCW,D=!0))}return{identifier:f.identifier,isHole:D,for:k}}else console.warn('fill-rule: "'+x+'" is currently not implemented.')}let o=0,l=999999999,u=-999999999,c=[];this.subPaths.forEach(f=>{let m=f.getPoints(),g=-999999999,y=999999999,x=-999999999,w=999999999;for(let b=0;b<m.length;b++){let C=m[b];C.y>g&&(g=C.y),C.y<y&&(y=C.y),C.x>x&&(x=C.x),C.x<w&&(w=C.x)}u<=x&&(u=x+1),l>=w&&(l=w-1),m.length&&c.push({curves:f.curves,points:m,isCW:WJ.isClockWise(m),identifier:o++,boundingBox:new yB(new Ie(w,y),new Ie(x,g))})});let h=c.map(f=>{var m;return a(f,c,l,u,(m=this.userData)==null?void 0:m.style.fillRule)}),d=[];return c.forEach(f=>{let m=h[f.identifier];if(m&&!m.isHole){let g=new NC;g.curves=f.curves,h.filter(y=>(y==null?void 0:y.isHole)&&y.for===f.identifier).forEach(y=>{if(y){let x=c[y.identifier],w=new LC;w.curves=x.curves,g.holes.push(w)}}),d.push(g)}}),d}},Hie=!1,Wie,TW=new Promise(e=>{Wie=e}),CW=!1,_S;function yVe(){if(Hie=!0,CW)return;if(_S)return _S;async function e(){let t=await Ll(()=>import("./opentype-D6jUvuOk.js"),[]);Wie(t),CW=!0}return _S=e(),_S}var xVe=class{async load(e,t,i=()=>{}){let{load:r}=await TW;r(e,(n,s)=>{n||!s?i(n??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:i}=await TW;try{let r=t(e),n=new i,s=a=>r.charToGlyphIndex(a.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(r,r.defaultRenderOptions.features),{font:r,bidi:n}}catch(r){console.error(r)}}};async function bVe(e){return await(await fetch(e)).arrayBuffer()}var _Ve=new xVe;async function AW(e){let t,i,r=!1;if(e.url?(t=await bVe(e.url),i=e.url,r=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(Hie){let n=await _Ve.parse(t);if(n)return{font:n.font,url:i,intercepted:r,arr:t,bidi:n.bidi}}else return{font:void 0,url:i,intercepted:r,arr:t,bidi:null}}function wVe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var EVe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=AW(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=AW(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,i){if(!this._bidi)return[];let r=this._bidi;r.getTextGlyphs(t);let n=r.tokenizer.tokens,s=[],a=0,o=i.length===n.length;for(let l=0;l<i.length;l++){let u=i[l].index,c=String.fromCharCode(i[l].unicode),h=n[a];if(wVe(u,h)||o)s.push({char:c,index:u,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),a++;else{let d=h.char,f="",m=[h.state.glyphIndex],g=[],y=!1;for(;!y;)a++,f=t.charAt(a),d+=f,m.push(e.charToGlyphIndex(f)),g=e.stringToGlyphs(d),g.length===1&&g[0].index===u&&(y=!0),a>t.length&&(y=!0);s.push({char:c,index:u,replacements:m,replacementChars:Array.from(d)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let i=this.font,r=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,s=e.map(x=>this.getTextWidth(x,t)),a=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,u=this.computeSpaceWidthForLine(e,0,t),c=this.getLineInitialOffsetX(s[0],a,t.horizontalAlign,e[0],o),h=this.getLineInitialOffsetY(n,e.length,t.height,r,t.verticalAlign),d=[],f=e.map(x=>[]),m=e.map(x=>[]),g;for(let x=0;x<e.length;x++){let w=e[x],b={features:{liga:!0}},C=[];try{C=i.stringToGlyphs(w,b)}catch(E){console.warn(E)}c=this.getLineInitialOffsetX(s[x],a,t.horizontalAlign,w,o);let A=[];try{A=this.reverseLigaturesTable(i,w,C)}catch(E){console.warn(E)}u=this.computeSpaceWidthForLine(e,x,t);for(let E=0;E<C.length;E++){let _=C[E],P=_.index===0?`
`:_.unicode?String.fromCharCode(_.unicode):void 0,I=A[E],D=0,k=0;E===0&&t.horizontalAlign===2&&_.leftSideBearing!==void 0&&(k=-_.leftSideBearing*r),g&&(D=i.getKerningValue(_,g)*r),c+=k+D;let B=0;if(P===`
`)B=l;else if(P===" ")B=u;else{let z=this.createPath(_,r,c,h,t);z&&(B=z.offsetX-(D+k),d.push(z.path))}if(I.replacements.length===1)m[x].push([c,h]),f[x].push(B);else{let z=I.replacements.map(G=>(i.glyphs.get(G).advanceWidth??0)*r),W=z.reduce((G,V)=>G+=V,0),$=z.map(G=>G/W),Z=c;for(let G=0;G<$.length;G++){let V=B*$[G];m[x].push([Z,h]),f[x].push(V),Z+=V}}c+=B,g=_}h-=n}let y=[];for(let x=0,w=d.length;x<w;x++)y.push(...d[x].toShapes());return{shapes:y,charWidths:f,lineWidths:s,charCoords:m}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,i,r,n){return(i===3||i===2)&&r.indexOf(`
`)>=0&&(e-=n),i===3?t*.5-e*.5:i===2?t-e:0}getLineInitialOffsetY(e,t,i,r,n){let s=t*e,a=Math.abs(this.ascender-this.descender)*r,o=e-a,l=-this.ascender*r-o/2;return n===3?-(i-s-l):n===2?-(i*.5-s*.5-l):l}createPath(e,t,i,r,n){var l;let s=e.getPath(i,-r,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new vVe,o=(e.advanceWidth??1)*t;if(e)for(let u of s.commands){let c=(l=a.currentPath)==null?void 0:l.currentPoint;if(!(c&&u.type!=="Z"&&c.x===u.x&&-c.y===u.y))switch(u.type){case"M":a.moveTo(u.x,-u.y);break;case"L":a.lineTo(u.x,-u.y);break;case"Q":a.quadraticCurveTo(u.x1,-u.y1,u.x,-u.y);break;case"C":a.bezierCurveTo(u.x1,-u.y1,u.x2,-u.y2,u.x,-u.y);break}}return a.subPaths.forEach(u=>{let c=SVe(u.curves);c!==void 0&&u.currentPoint.distanceTo(c)>0&&u.lineTo(c.x,c.y)}),{offsetX:o+n.fontSize*n.letterSpacing,path:a}}getCharWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,i){let r=this.getCharWidth(" ",i),n=e[t];if(n){let s=this.countSpaces(n.trimEnd());if(i.horizontalAlign===4&&t<e.length-1&&s){let a=i.width,o=this.getTextWidth(n,i);return(a-(o-s*r))/s}}return r}countSpaces(e){return(e.match(/ /g)||[]).length}};function SVe(e){if(e.length){let t=e[0];if(t instanceof wc)return t.v1;if(t instanceof vc||t instanceof Yp)return t.v0}}var TVe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,i){let r=this.objects.get(e);return r===void 0?(r=this.createObject(e,t,i),this.objects.set(e,r)):r.isShared=!0,r}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let i=this.objects.get(e);if(i&&i.isShared!==!0)return this.objects.delete(e),this.objects.set(t,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let i=this.objects.get(e);t===i&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},MW=class extends TVe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,i){let r=T_(e,t,this.flatShading,i);return r.computeBoundingSphere(),r}},CVe={markNeedsUpdateRendererDirty:()=>{}},MT=1e3,PW=512*MT;function AVe(e,t){let i=typeof e;return!!((t==="string"||t==="number")&&i===t||t==="boolean"&&(e==="true"||e==="false"||e===!0||e===!1)||t==="image"&&i==="string"&&e.startsWith("http"))}var MVe="https://hooks.spline.design",PVe=`${MVe}/events?hashFile=`,DVe=class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=FM(),this.reconnectWaitFor=MT,this._onError=i=>{var r,n,s;(r=this.eventSource)==null||r.removeEventListener("message",this._onMessage),(n=this.eventSource)==null||n.removeEventListener("error",this._onError),(s=this.eventSource)==null||s.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=i=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=MT,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=MT,this._connected=!1},this._onMessage=i=>{let r=i.data,n;try{n=JSON.parse(r)}catch(s){console.error("Error parsing webhook message",s)}if(n){let s=!1;this.userWebhook.parametersSchemas.forEach(({data:a})=>{n[a.name]!==void 0&&AVe(n[a.name],a.type)&&(this.result===void 0&&(this.result={}),this.result[a.name]=n[a.name],s=!0)}),s&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(PVe+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,i,r;(e=this.eventSource)==null||e.removeEventListener("message",this._onMessage),(t=this.eventSource)==null||t.removeEventListener("error",this._onError),(i=this.eventSource)==null||i.removeEventListener("open",this._onConnected),(r=this.eventSource)==null||r.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>PW&&(this.reconnectWaitFor=PW),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(e=>e.data.name)}getParameterValue(e){var t;if(this.getParametersKeys().includes(e)){if(this.result)return(t=this.result)==null?void 0:t[e];for(let i of this.userWebhook.parametersSchemas)if(i.data.name===e)return PL.defaultParameterValueByType(i.data.type)}}},DW=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],IVe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Hp=[],lz=[];for(let e=1;e<=8;e++)for(let t=0;t<DW.length;t++){let i=DW[t];Hp.push(i/Math.pow(2,8-e)),lz.push(IVe[t]+e)}var _A=[32,2e3],IW=Hp.filter((e,t)=>Hp[t]>_A[0]&&Hp[t]<_A[1]),OVe=lz.filter((e,t)=>Hp[t]>_A[0]&&Hp[t]<_A[1]),RVe=class{static getFrequencies(e,t,i,r="frequency",n=-100,s=-30){i||(i=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(i));let a=t/2,o=1/i.length*a,l,u,c;if(r==="music"||r==="voice"){let d=r==="voice"?IW:Hp,f=Array(d.length).fill(n);for(let m=0;m<i.length;m++){let g=m*o,y=i[m];for(let x=d.length-1;x>=0;x--)if(g>d[x]){f[x]=Math.max(f[x],y);break}}l=f,u=r==="voice"?IW:Hp,c=r==="voice"?OVe:lz}else l=Array.from(i),u=l.map((d,f)=>o*f),c=u.map(d=>`${d.toFixed(2)} Hz`);let h=l.map(d=>Math.max(0,Math.min((d-n)/(s-n),1)));return{values:new Float32Array(h),frequencies:u,labels:c}}},LVe="gpt-4o-realtime-preview-2024-12-17",NVe=()=>"https://relayserver.spline.design/";async function kVe(e){try{return(await(await fetch(NVe()+"session?uuidfile="+e)).json()).token}catch(t){console.error("Token generation error:",t)}}var BVe=class{constructor(e){this.value=0,this.frequencies=new Float32Array(0);let t=new AudioContext;this.source=t.createMediaStreamSource(e),this.analyser=t.createAnalyser(),this.source.connect(this.analyser),this.analyser.fftSize=8192,this.analyser.smoothingTimeConstant=.1}getFrequencies(e=-100,t=-30){if(!this.analyser)throw new Error("Not connected, please call .connect() first");return RVe.getFrequencies(this.analyser,44100,void 0,"voice",e,t)}update(){let e=this.getFrequencies(),t=e.values.reduce((i,r)=>i+r,0)/e.values.length;this.value=t,this.frequencies=e.values}disconnect(){this.source.disconnect(),this.analyser.disconnect()}},OW=class{constructor(e,t,i){this.data=e,this.id=t,this.shared=i,this.emitter=FM(),this.rafId=0,this.voice=0,this.frequencies=new Float32Array([0]),this.events=[],this.isConnected=!1,this.isToolsAdded=!1,this.tools=[],this.onMessage=r=>{var s;let n=JSON.parse(r.data);if(this.appendEvent(n),n.type==="session.created"&&this.onSessionCreated(),n.type==="response.done"&&((s=n.response)==null?void 0:s.output)){for(let a of n.response.output)if(a.type==="function_call")for(let[o,l]of this.tools)a.name===o.name&&(l(JSON.parse(a.arguments)),setTimeout(()=>{this.sendClientEvent({type:"response.create",response:{instructions:"notice the user about what you just did"}})}))}},this.onSessionCreated=()=>{this.isToolsAdded||this.registerTools()},this.onOpen=()=>{this.events=[],this.isConnected=!0,this.sendClientEvent({type:"response.create",response:{instructions:"Say hi"}})},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected&&this.analyser){this.analyser.update();let r=this.analyser.value,n=this.analyser.frequencies;this.voice=r,this.frequencies=n,this.emitter.emit("voice",{value:r,frequencies:n})}}}update(e){this.data=e}setColorByName(e,t){let i=this.shared.getColorByName(e);if(i){let{id:r}=i,{r:n,g:s,b:a}=l6e.hexStringToRgb(t)??{r:0,g:0,b:0};this.shared.updateColor(r,{r:n/255,g:s/255,b:a/255})}}async connect(){if(this.isConnected)return;let e=await kVe(this.data.integration.hash);this.pc=new RTCPeerConnection,this.audioElement=document.createElement("audio"),this.audioElement.autoplay=!0,this.pc.ontrack=n=>{let s=n.streams[0];this.audioElement.srcObject=s,this.analyser=new BVe(s)};let t=await navigator.mediaDevices.getUserMedia({audio:!0});this.pc.addTrack(t.getTracks()[0]),this.dc=this.pc.createDataChannel("oai-events"),this.dc.addEventListener("message",this.onMessage),this.dc.addEventListener("open",this.onOpen);let i=await this.pc.createOffer();await this.pc.setLocalDescription(i);let r={type:"answer",sdp:await(await fetch(`https://api.openai.com/v1/realtime?model=${LVe}`,{method:"POST",body:i.sdp,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/sdp"}})).text()};await this.pc.setRemoteDescription(r),this.animate()}appendEvent(e){this.events=[e,...this.events]}sendClientEvent(e){this.dc?(e.event_id=e.event_id||crypto.randomUUID(),this.dc.send(JSON.stringify(e)),this.appendEvent(e)):console.error("Failed to send message - no data channel available",e)}registerTools(){this.isToolsAdded=!0,this.registerTool({type:"function",name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},({color:n})=>{this.setColorByName("Voice Assistant Color",n)});let e=this.shared.getVariablesNames().join(", ");this.registerTool({type:"function",name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the variable that needs to be set. Here's a list of available variables: ${e}. It the variable does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},({name:n,value:s})=>{let a=this.shared.getVariableByName(n);if(a){let o=this.shared.getVariable(a.id),l;typeof o=="number"?l=parseFloat(s):typeof o=="boolean"?l=s.toLowerCase()==="true":l={textValue:s},this.shared.updateVariable(a.id,l)}});let t=this.shared.getColorNames().join(", ");this.registerTool({type:"function",name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the color asset that needs to be set. Here's a list of available color assets: ${t}. It the color asset does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},({name:n,value:s})=>{this.setColorByName(n,s)});let i=this.shared.scene,r=[];i.traverseEntity(n=>{n.data.events.forEach(s=>{if(s.data.type==="AIAssistantTrigger"){let{description:a}=s.data;r.push(a)}})}),this.registerTool({type:"function",name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:`The name of the event that needs to be triggered. Here's a list of available events: ${JSON.stringify(r)}.`},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},({description:n,direction:s})=>{this.emitter.emit("trigger_event",{description:n,direction:s})}),this.sendClientEvent({type:"session.update",session:{tools:this.tools.map(([n])=>n)}})}registerTool(e,t){this.tools.push([e,t])}disconnect(){var e,t,i,r,n,s;cancelAnimationFrame(this.rafId),(e=this.analyser)==null||e.disconnect(),this.voice=0,this.isConnected=!1,this.isToolsAdded=!1,(t=this.dc)==null||t.removeEventListener("message",this.onMessage),(i=this.dc)==null||i.removeEventListener("open",this.onOpen),(r=this.dc)==null||r.close(),(n=this.pc)==null||n.getSenders().forEach(a=>{a.track&&a.track.stop()}),(s=this.pc)==null||s.close(),this.pc=void 0}computeAnalysisForListenerEvent(e){if(e.analysis==="range"){let t=this.frequencies.slice(...e.analysisRange);return t.reduce((i,r)=>i+r,0)/t.length}return e.analysis==="single"?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function iN(e){return"variable_"+e}var zVe=class extends Eje{constructor(e){super(),this.shared=e}create(e){return new Lie(e,this.shared)}},uz=class{constructor(e,t={},i=!0,r=!1){if(this.data=e,this.needsJitter=i,this.enableLocalStorageForPersistentVariables=r,this.geometryCache=new MW(!0),this.geometryCache2=new MW(!1),this.imageHolderCache=new zVe(this),this.thisContext={scene:CVe,shared:this},this.deletedMaterial=new tN(ba.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new mp(IL.emptyImage,this),this.deletedVideo=new mp(iA.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[n,s]of Object.entries(t.images))this.addImage(n,s);if(t.videos)for(let[n,s]of Object.entries(t.videos))this.addVideo(n,s);if(t.audios)for(let[n,s]of Object.entries(t.audios))this.addAudio(n,s);if(t.particles)for(let[n,s]of Object.entries(t.particles))this.addParticle(n,s);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map(e=>e.loadPromise)}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1){this.data=e,this.resetLib(e.lib);for(let{id:i,data:r}of e.variables)this.addVariableHolder(i,r),t&&this.updateVariableHolder(i,r);for(let[i,r]of Object.entries(e.userAPIs))this.addUserAPI(i,r);for(let[i,r]of Object.entries(e.userWebhooks))this.addUserWebhook(i,r);for(let[i,r]of Object.entries(e.images))this.addImage(i,r);for(let[i,r]of Object.entries(e.videos))this.addVideo(i,r);for(let[i,r]of Object.entries(e.colors))this.addColor(i,r);for(let[i,r]of Object.entries(e.materials))this.addMaterial(i,r);for(let[i,r]of Object.entries(e.audios))this.addAudio(i,r);for(let[i,r]of Object.entries(e.particles))this.addParticle(i,r);for(let[i,r]of Object.entries(e.fonts))this.addFont(i,r)}addMaterial(e,t){if(this.materials[e]){let i=this.materials[e];i.reset(t,this.thisContext),i.dispose()}else{let i=new tN(t,this.thisContext,e);this.materials[e]=i}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new oz(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new mp(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new mp(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new mp(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new bA(t.r,t.g,t.b,t.a):this.colors[e]=new bA(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[e];return this.colors[e].r=t.r??i.r,this.colors[e].g=t.g??i.g,this.colors[e].b=t.b??i.b,this.colors[e].a=t.a??i.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map(e=>e.name)}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if(typeof e=="string"){let i=this.getColor(e);i?t=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new Wa(0,0,0,0))}else return"a"in e?new Wa(e.r,e.g,e.b,e.a):new Wa(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Zx)return t;{let i=new Zx({src:t.data});return this.audios[e]=i,i}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Zx&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new EVe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof Zx&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(this.variables[e]===void 0){let i=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let r=localStorage.getItem(iN(e));i=r!==null?JSON.parse(r):t.value}return this.variables[e]={value:i,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(iN(e),JSON.stringify(t));let i=t;for(;typeof i=="string";)i=this.variables[i].value;let r=this.entityOpContext.scene;for(let n=this.variables[e].locations.length-1;n>=0;n--){let s=this.variables[e].locations[n];if(s[0]==="material"){let a=s[1],o=i,l={scene:r,shared:this},u=s.slice(2);r.traverseMaterial(h=>{let d=h.root??h;d.uuid===a&&d.onVariableUpdate(u,o,l)});let c=this.materials[a];c&&c.onVariableUpdate(u,o,l)}else{let a=r.find(s[0]);if(a===void 0){this.variables[e].locations.splice(n,1);continue}if(s[1]!=="geometry"&&s[1]!=="particles"){for(let o=1;o<s.length-1;o++)a=a[s[o]];s[1]==="rotation"?a[s[s.length-1]]=i*Xt.DEG2RAD:a[s[s.length-1]]=i}if(a=r.find(s[0]),a.type==="ParticleEmitter"&&a.updateVariableState(i,s),wr.is(a))if(s[1]==="position"||s[1]==="rotation"||s[1]==="scale")a.onVariableUpdate();else if(s[1]==="geometry"){let o=a;a.component&&(o=a.component);let l=o.dataPatched;o.chooseGeoemtryCache(this).forceDelete(l.geometry),o.createGeometryDelayed(this.entityOpContext),o.onVariableUpdate(!0),o.invalidateDownstreamBooleanData(),o.instances.forEach(u=>{let c=u.dataPatched;u.chooseGeoemtryCache(this).forceDelete(c.geometry),u.createGeometryDelayed(this.entityOpContext),u.onVariableUpdate(!0),u.invalidateDownstreamBooleanData()})}else s[1]==="morphTargetInfluences"&&a.updateMorphInfluences(s[2],i)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){var i,r,n;if(Array.isArray(e)){if(e[0]==="mouse")return((i=this.mouseProperty)==null?void 0:i[e[1]])??0;if(e[0]==="raycast")return((r=this.raycastProperty)==null?void 0:r[e[1]])??0;let s=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return s.geometry.userData.parameters[e[1]];for(let a=1;a<e.length;a++)s=s[e[a]];return e[1]==="rotation"&&(s*=Xt.RAD2DEG),s}for(let s in this.variables){if(t===void 0)break;let a=this.variables[s],o=(n=a.locations)==null?void 0:n.findIndex(l=>$s.equal(l,t));o!==void 0&&o!==-1&&a.locations.splice(o,1)}if(typeof e=="string"){let s=e,a=e;do{if(a=s,this.variables[s]===void 0)break;let o=this.variables[s].value;t&&this.variables[a]!==void 0&&this.variables[a].locations.push(t),s=o}while(typeof s=="string");return s}else return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map(e=>e.data.name)}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,i]of Object.entries(e.images))this.addImage(t,i.asset);for(let[t,i]of Object.entries(e.audios))this.addAudio(t,i.asset);for(let[t,i]of Object.entries(e.particles))this.addParticle(t,i.asset);for(let[t,i]of Object.entries(e.colors))this.addColor(t,i.asset);for(let[t,i]of Object.entries(e.fonts))this.addFont(t,i.asset);for(let[t,i]of Object.entries(e.materials))this.addMaterial(t,i.asset);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i.asset);for(let[t,i]of Object.entries(e.variables))this.addVariableHolder(t,i.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,i){var r;if(this.data=t,e.path[0]==="images")e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id);else if(e.path[0]==="videos")e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id);else if(e.path[0]==="audios")e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id);else if(e.path[0]==="particles")e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id);else if(e.path[0]==="colors")e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id);else if(e.path[0]==="materials")e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(xa.drop(e,2),t.materials[e.path[1]],{shared:this,scene:i});else if(e.path[0]==="fonts")e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,i):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id);else if(e.path[0]==="variables")e.path.length===2&&e.type===0?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id);else if(e.path[0]==="userAPIs"){if(e.path.length===1&&e.type===1)this.addUserAPI(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserAPI(e.id);else if(typeof e.path[1]=="string"){let n=t.userAPIs[e.path[1]];if(n){let s=e.type===0&&e.props.debounce===void 0,a=this.getUserAPI(e.path[1]);a instanceof OW?a.update(n):a==null||a.update(n,this,s)}}}else if(e.path[0]==="userWebhooks"){if(e.path.length===1&&e.type===1)this.addUserWebhook(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserWebhook(e.id);else if(typeof e.path[1]=="string"){let n=t.userWebhooks[e.path[1]];n&&((r=this.getUserWebhook(e.path[1]))==null||r.update(n))}}else e.path[0]==="lib"&&this.updateLibByOp(xa.drop(e,1),i)}updateFont(e,t,i){if(t.props.url){let r=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};r.update(n),r.loadingPromise.then(()=>this.requestRender()),i.updateFont(e,this)}}addUserAPI(e,t){var i,r;return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):((i=this.openAIRealtime)==null?void 0:i.id)===e?(this.openAIRealtime.update(t),!0):((r=t.integration)==null?void 0:r.type)==="VoiceAssistant"?(this.openAIRealtime=new OW(t,e,this),!1):(this.userAPIs[e]=new Zte(e,t,this),!1)}getUserAPI(e){var t;return((t=this.openAIRealtime)==null?void 0:t.id)===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new DVe(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}};new uz(Mu.emptyData());var y1=class extends Ko{updateByPatchedOp(e,t,i){if(super.updateByPatchedOp(e,t,i),$ze(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[r,n]of Object.entries(e.props)){let s=i.shared.material(n);this.material[Number(r)]=s}else if(sn(e.path,["material"])&&this.material instanceof Kp)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(xa.drop(e,1),t.material,i);else if(sn(e.path,["materials","*"])&&Array.isArray(this.material)){let r=e.path[1];if("materials"in t&&r<this.material.length){let n=t.materials[r];typeof n!="string"&&this.material[r].updateByOp(xa.drop(e,2),n,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var n,s;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let i=this.dataPatched;this.dataPatched.type==="Mesh"&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9);let r;if(this.dataPatched.type==="Mesh"&&this.dataPatched.geometry.type==="ShapeBlendGeometry"&&(r={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),((n=e.geometry)==null?void 0:n.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe,r),t.scene.markNeedsUpdateRendererDirty()),(((s=e.geometry)==null?void 0:s.type)==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(a=>t.shared.material(a).getFlavor(i.flatShading,i.side,i.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let a=0;a<this.material.length;a++)this.material[a]=this.material[a].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe,r)}disposeMaterial(){this.material&&Uee(this.material).forEach(e=>{e instanceof Kp&&(e instanceof tN||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},RW=new q,LW=new Pi,NW=new Pi,FVe=new q,kW=new Pt,Os=class extends y1{constructor(e,t,i){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=new Pt().fromArray(t.bindMatrix),this.bindMatrixInverse=new Pt)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof ai&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof uz){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return sA.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return sA.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),sn(e.path,["geometry"])&&this.updateByPatchedOpGeometry(xa.drop(e,1),t.geometry,i)}removeInteractionGeometry(e){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var r;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let u={...this.data.geometry,...n};this.localGeometry=T_(u,t,this.data.flatShading,this)}let s,a,o;n.scaleBaked?[s,a,o]=n.scaleBaked:{width:s,height:a,depth:o}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&KL(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let n={...this.data.geometry,...e};(r=this.localGeometry)==null||r.dispose(),this.localGeometry=T_(n,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,i){var n;let r=!1;e.type===0&&e.path.length===0&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof Fo&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(r=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),r||((n=i.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t);let i=e.morphTargetInfluences;if(i){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:r,value:n}}of i)this.updateMorphInfluences(r,t.shared.getVariable(n,[this.uuid,"morphTargetInfluences",r]))}super.updateState(e,t)}updateMorphInfluences(e,t){if(this.morphTargetDictionary===void 0)return;let i=this.morphTargetDictionary[e];i!==void 0&&(this.morphTargetInfluences[i]=t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;this.is2DType?e.set(0,0,i.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):i.centerOffset?e.fromArray(i.centerOffset):e.setScalar(0),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new Pi,i=this.geometry.attributes.skinWeight;for(let r=0,n=i.count;r<n;r++){t.fromBufferAttribute(i,r);let s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),i.setXYZW(r,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let i=this.skeleton;if(i===void 0)return;let r=this.geometry;LW.fromBufferAttribute(r.attributes.skinIndex,e),NW.fromBufferAttribute(r.attributes.skinWeight,e),RW.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let s=NW.getComponent(n);if(s!==0){let a=LW.getComponent(n);kW.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(FVe.copy(RW).applyMatrix4(kW),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};function UVe(e){var a,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,i=e.geometry.attributes,r=i.position.array,n=i.normal.array,s=new Float32Array(r.length);for(let l=0;l<r.length;l+=3){let u=`${r[l]}_${r[l+1]}_${r[l+2]}`,c=new q(n[l],n[l+1],n[l+2]);t.has(u)?(a=t.get(u))==null||a.normals.push(c):t.set(u,{normals:[c],result:new q})}t.forEach((l,u)=>{for(let c of l.normals)l.result.add(c);l.result.divideScalar(l.normals.length)});for(let l=0;l<r.length;l+=3){let u=`${r[l]}_${r[l+1]}_${r[l+2]}`,c=(o=t.get(u))==null?void 0:o.result;c&&(s[l]=c.x,s[l+1]=c.y,s[l+2]=c.z)}e.geometry.setAttribute("extrudeNormal",new Vt(s,3))}function jVe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),r=new q;for(let n=0;n<t.length;n+=3)r.set(t[n],t[n+1],t[n+2]).normalize(),i[n]=r.x,i[n+1]=r.y,i[n+2]=r.z;e.geometry.setAttribute("extrudeNormal",new Vt(i,3))}function cz(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Kp)||e.material.getLayersOfType("outline").length===0)return;e instanceof Os&&e.is2DAndNoDepth?jVe(e):UVe(e)}function hz(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),r=parseInt(e.uuid.replace(/\D/g,"")),n=[Xt.seededRandom(r),Xt.seededRandom(r+1e4),Xt.seededRandom(r+2e4)];for(let s=0;s<t.length;s++)i[s]=n[s%3];e.geometry.setAttribute("randomColor",new gi(i,3))}var $c=new xs,px=new q;function VVe(e){let t=!1;return e.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var C_=class extends Os{constructor(e,t,i){super(e,t,i),this.data=t,this.hiddenMatrixOld=new Pt,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,a,o;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:i,subdividedGeometry:r,subdivPointer:n}=Fo.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,i!==void 0&&((a=this.originalGeometry)==null||a.dispose(),this.originalGeometry=i),r!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=r??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,cz(this),hz(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let i=this.material;this.material=Array.isArray(i)?i.map(r=>r.getFlavor(!1,r.side,r.wireframe)):i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){Fo.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Fo.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Fo.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Fo.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,Ko.prototype.raycast.call(this,e,t),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Rl,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;$c.setFromBufferAttribute(t),$c.getCenter(i),e.boundingSphere.radius=i.distanceTo($c.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),$c.getSize(px),this.hasNonUniformScale&&px.divide(this.scale);let r={width:px.x,height:px.y,depth:px.z};return this.geometry.userData.parameters=r,r}updateBoundingSphere(e){let t=this.originalGeometry;$c.min.set(e[0],e[2],e[4]),$c.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&($c.min.applyMatrix4(this.shearScaleInv),$c.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new Rl);let i=t.boundingSphere.center;$c.getCenter(i),t.boundingSphere.radius=i.distanceTo($c.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(Fo.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),this.localGeometry&&this.createGeometryByControls(t)}},BW=-1,HVe=1,WVe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},GVe={polygon_center:0,edge:1,vertex:2},wS=(e,t)=>(i,r)=>!t||i===0||e===0?0:e*r/100,Ki=(e,t)=>{let i=Math.abs(t),r=i*-1;return(e-BW)*(i-r)/(HVe-BW)+r},qVe=new q,ES=new q,YVe=new q,XVe=new q;function py(e,t){let i=YVe.fromArray(e),r=XVe.fromArray(t);ES.copy(r).sub(i);let n=ES.length();return ES.normalize().multiplyScalar(n*.5),qVe.copy(i).add(ES).toArray()}var Iu=new Fa,SS=new q,wA=new q,cg=new q;function KVe(e){let t=[];for(let i=0;i<=e.index.count;i++)if(SS.fromArray(e.index.array,i*3),Iu.setFromAttributeAndIndices(e.attributes.position,SS.x,SS.y,SS.z),Iu.getNormal(wA),Iu.getMidpoint(cg),!(isNaN(cg.x)||isNaN(cg.y)||isNaN(cg.z))){let{a:r,b:n,c:s}=Iu,a=r.toArray(),o=n.toArray(),l=s.toArray(),u=r.distanceTo(n),c=n.distanceTo(s),h=s.distanceTo(r),d=py(a,o),f=py(o,l),m=py(l,a),g=[u,c,h],y=Math.max(...g),x=g.filter(C=>Math.round(C)===Math.round(y)).length>1,w=[],b=Iu.getMidpoint(cg).toArray();y===u&&!x&&(w=[f,m,m],b=d),y===c&&!x&&(w=[d,m,m],b=f),y===h&&!x&&(w=[d,f,f],b=m),x&&(w=[d,f,m]),t.push({vertices:[a,o,l],faceCenters:w,midpoint:b,norm:Iu.getNormal(wA).toArray()})}return t}function $Ve(e){let t=[],{position:i}=e.attributes;for(let r=0;r<i.count;r++){Iu.setFromAttributeAndIndices(i,r*3,r*3+1,r*3+2),Iu.getNormal(wA),Iu.getMidpoint(cg);let n=Iu.a.toArray(),s=Iu.b.toArray(),a=Iu.c.toArray();t.push({vertices:[n,s,a],faceCenters:[py(n,s),py(s,a),py(a,n)],midpoint:cg.toArray(),norm:wA.toArray()})}return t}var ZVe=4,QVe=.5,kI=e=>.5*(1-Math.cos(e*Math.PI)),JVe=class{constructor(){this.perlin=new Array(4096)}noise(e,t=0,i=0){if(this.perlin==null){this.perlin=new Array(4096);for(let y=0;y<4096;y++)this.perlin[y]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),i<0&&(i=-i);let r=Math.floor(e),n=Math.floor(t),s=Math.floor(i),a=e-r,o=t-n,l=i-s,u,c,h=0,d=.5,f,m,g;for(let y=0;y<ZVe;y++){let x=r+(n<<4)+(s<<8);u=kI(a),c=kI(o),f=this.perlin[x&4095],f+=u*(this.perlin[x+1&4095]-f),m=this.perlin[x+16&4095],m+=u*(this.perlin[x+16+1&4095]-m),f+=c*(m-f),x+=256,m=this.perlin[x&4095],m+=u*(this.perlin[x+1&4095]-m),g=this.perlin[x+16&4095],g+=u*(this.perlin[x+16+1&4095]-g),m+=c*(g-m),f+=kI(l)*(m-f),h+=f*d,d*=QVe,r<<=1,a*=2,n<<=1,o*=2,s<<=1,l*=2,a>=1&&(r++,a--),o>=1&&(n++,o--),l>=1&&(s++,l--)}return h}noiseSeed(e){let t=(()=>{let i,r;return{setSeed(n){r=i=(n??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return r=(1664525*r+1013904223)%4294967296,r/4294967296}}})();t.setSeed(e),this.perlin=new Array(4096);for(let i=0;i<4096;i++)this.perlin[i]=t.rand()}},e8e=JVe,zW=new q,FW=new Pt,UW=new n1;function jW(e){let t=!1;return e.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&(r.geometry.type==="TextGeometry"||r.geometry.type==="InputGeometry")&&(t=!0)}),t}var dz=class extends Os{constructor(e,t,i){super(e,t,i),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:i}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(FW.copy(i).invert(),UW.copy(e.ray).applyMatrix4(FW),UW.intersectBox(this.singleBBox,zW))){let r=zW.applyMatrix4(i),n=e.ray.origin.distanceTo(r);t.push({distance:n,point:r.clone(),object:this})}}},Oo=1e-4,Zc,Gie,qie,Yie,VW=new q,HW=new q;iie.then(e=>{Zc=e,Gie=[Zc.get_face_center,Zc.get_edge_midpoint,Zc.get_vertex_position],qie=[Zc.get_face_normal,Zc.get_edge_normal,Zc.get_vertex_normal],Yie=[Zc.face_count,Zc.edge_count,Zc.vertex_count]});var t8e=new Pt,i8e=new Pt,Vf=new q,TS=new q,mx=new q,BI=new q,r8e=new q,n8e=new q,s8e=class{constructor(e,t){this.data=e,this.is3D=t,this.perlin=new e8e,e.noiseType==="perlin"?(this.perlin.noiseSeed(e.seed),t?this.noise=(i,r,n)=>this.perlin.noise(i,r,n):this.noise=i=>this.perlin.noise(i)):t?this.noise=R5e((0,jL.default)(e.seed)):this.noise=O5e((0,jL.default)(e.seed))}},Nu=class extends YB(qr){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof Va&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof Va&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"){if(!this.parameters.toObject.object)t=0;else if(e===void 0&&this.parameters.toObject.spreadType!=="random")return}if(this.parameters.type==="toObject"&&this.objectForSample){let i=this.children;if(i.length===t)return;if(i.length<t)for(let r=0,n=t-i.length;r<n;++r){let s=new Va(this.object);s.expand(),this.add(s)}else for(let r=0,n=i.length-t;r<n;++r)this.remove(i[r])}else{if(this.children.length===t)return;if(this.children.length<t)for(let i=0,r=t-this.children.length;i<r;++i){let n=new Va(this.object);n.expand(),this.add(n)}else for(let i=0,r=this.children.length-t;i<r;++i)this.remove(this.children[i])}}getRandom(e,t=!1){return(this.random===null||this.random.data.seed!==e.seed||this.random.is3D!==t)&&(this.random=new s8e(e,t)),this.random}_updateRadial(e){let t=e.radial,i=t.start*Xt.DEG2RAD,r=t.end*Xt.DEG2RAD,n=i-r,s=new Ks(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new q(0,0,1);break;case"y":a=new q(0,1,0);break;default:case"x":a=new q(1,0,0);break}let o=e.randomnessObject??_p.defaultData([1,1,1]).randomnessObject,l=this.getRandom(o),u=wS(o.strength,this.parameters.randomness);for(let[c,h]of this.children.entries()){let d=c*(o.freqScale/10)+o.movement,f=l.noise(d,d,d),m=c+1;h.scale.x=t.scale[0]+u(m,Ki(f,o.scale[0]))||Oo,h.scale.y=t.scale[1]+u(m,Ki(f,o.scale[1]))||Oo,h.scale.z=t.scale[2]+u(m,Ki(f,o.scale[2]))||Oo,h.position.setScalar(0);let g=n/e.count*c-i;switch(t.axis){case"x":h.rotation.set(0,g,0);break;case"y":h.rotation.set(0,0,g);break;case"z":h.rotation.set(g,0,0);break}h.translateOnAxis(a,t.radius),h.position.x+=t.position[0]+u(m,Ki(f,o.position[0])),h.position.y+=t.position[1]+u(m,Ki(f,o.position[1])),h.position.z+=t.position[2]+u(m,Ki(f,o.position[2]));let y=u(m,Ki(f,o.rotation[0])),x=u(m,Ki(f,o.rotation[1])),w=u(m,Ki(f,o.rotation[2]));t.alignment===!0?(h.rotation.x+=s.x+y,h.rotation.y+=s.y+x,h.rotation.z+=s.z+w):h.rotation.set(s.x+y,s.y+x,s.z+w)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,i=new Ks(t.rotation[0],t.rotation[1],t.rotation[2]),r=e.randomnessObject??_p.defaultData([1,1,1]).randomnessObject,n=this.getRandom(r),s=wS(r.strength,this.parameters.randomness);for(let[a,o]of this.children.entries()){let l=a*(r.freqScale/10)+r.movement,u=n.noise(l,l,l),c=a+1,h=s(c,Ki(u,r.rotation[0])),d=s(c,Ki(u,r.rotation[1])),f=s(c,Ki(u,r.rotation[2]));o.scale.x=1+(t.scale[0]-1)*a+s(c,Ki(u,r.scale[0]))||Oo,o.scale.y=1+(t.scale[1]-1)*a+s(c,Ki(u,r.scale[1]))||Oo,o.scale.z=1+(t.scale[2]-1)*a+s(c,Ki(u,r.scale[2]))||Oo,o.rotation.x=i.x*a+h,o.rotation.y=i.y*a+d,o.rotation.z=i.z*a+f,o.position.x=t.position[0]*a+s(c,Ki(u,r.position[0])),o.position.y=t.position[1]*a+s(c,Ki(u,r.position[1])),o.position.z=t.position[2]*a+s(c,Ki(u,r.position[2]))}}_updateGrid(e){let t=0,i=e.grid,r=e.randomnessObject??_p.defaultData([1,1,1]).randomnessObject,n=this.getRandom(r,!0),s=wS(r.strength,this.parameters.randomness);if(i.useCenter===!0){let a={x:i.count[0]%2===0?2:1,y:i.count[1]%2===0?2:1,z:i.count[2]%2===0?2:1},o=new q(i.size[0]*(i.count[0]-a.x)*.5,i.size[1]*(i.count[1]-a.y)*.5,i.size[2]*(i.count[2]-a.z)*.5);for(let l=0;l<i.count[0];l++)for(let u=0;u<i.count[1];u++)for(let c=0;c<i.count[2];c++){let h=n.noise((l+1)*(r.freqScale/10)+r.movement,(u+1)*(r.freqScale/10)+r.movement,(c+1)*(r.freqScale/10)+r.movement),d=this.children[t++];d.scale.x=1+s(t,Ki(h,r.scale[0]))||Oo,d.scale.y=1+s(t,Ki(h,r.scale[1]))||Oo,d.scale.z=1+s(t,Ki(h,r.scale[2]))||Oo;let f=s(t,Ki(h,r.rotation[0])),m=s(t,Ki(h,r.rotation[1])),g=s(t,Ki(h,r.rotation[2]));d.rotation.set(f,m,g),d.position.x=i.size[0]*l-o.x+s(t,Ki(h,r.position[0])),d.position.y=i.size[1]*u-o.y+s(t,Ki(h,r.position[1])),d.position.z=i.size[2]*c-o.z+s(t,Ki(h,r.position[2]))}}else for(let a=0;a<i.count[0];a++)for(let o=0;o<i.count[1];o++)for(let l=0;l<i.count[2];l++){let u=n.noise((a+1)*(r.freqScale/10)+r.movement,(o+1)*(r.freqScale/10)+r.movement,(l+1)*(r.freqScale/10)+r.movement),c=this.children[t++];c.scale.x=1+s(t,Ki(u,r.scale[0]))||Oo,c.scale.y=1+s(t,Ki(u,r.scale[1]))||Oo,c.scale.z=1+s(t,Ki(u,r.scale[2]))||Oo;let h=s(t,Ki(u,r.rotation[0])),d=s(t,Ki(u,r.rotation[1])),f=s(t,Ki(u,r.rotation[2]));c.rotation.set(h,d,f),c.position.x=i.size[0]*a+s(t,Ki(u,r.position[0])),c.position.y=-i.size[1]*o+s(t,Ki(u,r.position[1])),c.position.z=-i.size[2]*l+s(t,Ki(u,r.position[2]))}}_updateToObject(e){var c;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,i=new Ks(t.rotation[0],t.rotation[1],t.rotation[2]),r=e.randomnessObject??_p.defaultData([1,1,1]).randomnessObject,n=this.getRandom(r),s=wS(r.strength,this.parameters.randomness);if(!t.object){for(let[,h]of this.children.entries())h.position.set(0,0,0),h.scale.setScalar(1),h.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof dz)if(!((c=this.objectForSample.font)!=null&&c.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData();if(a.length>0){let h=Math.round(a.length*t.count/100);this._updateCount(h)}else{let h=this.objectForSample.geometry.getAttribute("position");if(!h||isNaN(h.count)||h.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let o=new L5e(this.objectForSample).build(),l=WVe[t.axis],u=this.children;o.setRandomGenerator((0,jL.default)(this.object.uuid+t.seed));for(let[h,d]of u.entries()){let f=h*(r.freqScale/10)+r.movement,m=n.noise(f,f,f),g=h+1,y=s(g,Ki(m,r.rotation[0])),x=s(g,Ki(m,r.rotation[1])),w=s(g,Ki(m,r.rotation[2]));t.spreadType==="random"?o.sample(mx,BI):(a.length&&(mx.fromArray(a[h].pos),BI.fromArray(a[h].norm)),this.objectForSample instanceof C_&&mx.applyMatrix4(t8e.copy(this.objectForSample.matrixWorld).invert())),mx.applyMatrix4(this.object.hiddenMatrix.clone().invert()),d.position.copy(mx),Vf.fromArray(l);let b=t.align==="normal"?BI:this.object.getWorldDirection(n8e),C=TS.fromArray(t.position);TS.x+=s(g,Ki(m,r.position[0])),TS.y+=s(g,Ki(m,r.position[1])),TS.z+=s(g,Ki(m,r.position[2]));let A=Math.acos(b.dot(Vf)),E=r8e.crossVectors(Vf,b).normalize(),_=i8e.makeRotationAxis(E,A),P=b.clone().cross(this.object.up).normalize(),I=P.clone().cross(b).normalize(),D=new Pt().makeBasis(P,b,I),k=new q(Vf.y,Vf.z,Vf.x).normalize(),B=k.clone().cross(Vf).normalize(),z=new Pt().makeBasis(k,Vf,B).invert(),W=new Pt().multiplyMatrices(D,z);d.rotation.setFromRotationMatrix(W),C.applyMatrix4(_),d.position.add(C),d.rotation.x=d.rotation.x+i.x+y,d.rotation.y=d.rotation.y+i.y+x,d.rotation.z=d.rotation.z+i.z+w,d.scale.setScalar(1),d.scale.x=d.scale.x+t.scale[0]+s(g,Ki(m,r.scale[0]))||Oo,d.scale.y=d.scale.y+t.scale[1]+s(g,Ki(m,r.scale[1]))||Oo,d.scale.z=d.scale.z+t.scale[2]+s(g,Ki(m,r.scale[2]))||Oo,d.scale.multiply(this.object.scale),d.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType,t=new Map,i=(n,s)=>{let a=Math.round(n[0]*1e4)+"_"+Math.round(n[1]*1e4)+"_"+Math.round(n[2]*1e4),o=t.get(a);o?(o.pos[0]+=n[0],o.pos[1]+=n[1],o.pos[2]+=n[2],o.norm[0]+=s[0],o.norm[1]+=s[1],o.norm[2]+=s[2],o.count+=1):t.set(a,{pos:[...n],norm:[...s],count:1})};if(e==="random")return[];if(this.objectForSample instanceof C_){let n=this.objectForSample,s=GVe[e],a=Yie[s],o=Gie[s],l=qie[s],u=a(n.subdivPointerNew);for(let c=0;c<=u-1;c++){let h=o(n.subdivPointerNew,c),d=l(n.subdivPointerNew,c);VW.fromArray(h).applyMatrix4(n.matrixWorld),HW.fromArray(d),i(VW.toArray(),HW.toArray())}}else(this.objectForSample.geometry.index?KVe(this.objectForSample.geometry):$Ve(this.objectForSample.geometry)).forEach((n,s)=>{e==="polygon_center"&&i(n.midpoint,n.norm),e==="vertex"&&(i(n.vertices[0],n.norm),i(n.vertices[1],n.norm),i(n.vertices[2],n.norm)),e==="edge"&&(i(n.faceCenters[0],n.norm),i(n.faceCenters[1],n.norm),i(n.faceCenters[2],n.norm))});let r=Array.from(t.values());for(let n of r)n.pos[0]/=n.count,n.pos[1]/=n.count,n.pos[2]/=n.count,n.norm[0]/=n.count,n.norm[1]/=n.count,n.norm[2]/=n.count;return r}updateState(e,t){var i;if(this.parameters=IM(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(i=this.object.parent)==null||i.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let r=t.find(this.parameters.toObject.object);r instanceof Ko?this.objectForSample=r:this.objectForSample=void 0,this.matrix=new Pt,this.hiddenMatrix=new Pt,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,r&&r.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},lw=e=>{var t;return t=class extends e{},t.geometryHelper=new Dc(30,30,30),t},CS=new n1,zI=new Rl,WW=new Pt,uw=(e,t,i,r,n=!1,s=e)=>{let a=t,o=s.matrixWorld;if(a.boundingSphere===null&&a.computeBoundingSphere(),zI.copy(a.boundingSphere),zI.applyMatrix4(o),i.ray.intersectsSphere(zI)===!1||(WW.copy(o).invert(),CS.copy(i.ray).applyMatrix4(WW),a.boundingBox!==null&&CS.intersectsBox(a.boundingBox)===!1))return;let l,u,c,h,d=a.index,f=a.attributes.position,m=a.drawRange,g,y;if(n===!1){let w=Math.max(0,m.start),b=Math.min(d.count,m.start+m.count);for(g=w,y=b;g<y;g+=3)if(u=d.getX(g),c=d.getX(g+1),h=d.getX(g+2),l=x(e,i,CS,f,u,c,h),l){l.faceIndex=Math.floor(g/3),r.push(l);return}}else{let w=a.attributes.position,b=new q,C=new q,A=new q,E=new q,_=2,P=1/((s.scale.x+s.scale.y+s.scale.z)/3),I=P*P,D=Math.max(0,m.start),k=Math.min(w.count,m.start+m.count);for(let B=D,z=k-1;B<z;B+=_){if(b.fromBufferAttribute(w,B),C.fromBufferAttribute(w,B+1),CS.distanceSqToSegment(b,C,E,A)>I)continue;E.applyMatrix4(s.matrixWorld);let W=i.ray.origin.distanceTo(E);W<i.near||W>i.far||r.push({distance:W,point:A.clone().applyMatrix4(s.matrixWorld),object:e})}}function x(w,b,C,A,E,_,P){let I=new q,D=new q,k=new q,B=new q,z=new q;if(I.fromBufferAttribute(A,E),D.fromBufferAttribute(A,_),k.fromBufferAttribute(A,P),C.intersectTriangle(I,D,k,!1,B)===null)return null;z.copy(B),z.applyMatrix4(w.matrixWorld);let W=b.ray.origin.distanceTo(z);return W<b.near||W>b.far?null:{faceIndex:1,distance:W,point:z.clone(),object:w}}},AS=new q,bu=new sm,a8e=class extends J_{constructor(e){let t=new ai,i=new am({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],n=[],s={},a=new mi(15711266),o=new mi(15711266),l=new mi(2857471);u("n1","n2",a),u("n2","n4",a),u("n4","n3",a),u("n3","n1",a),u("f1","f2",a),u("f2","f4",a),u("f4","f3",a),u("f3","f1",a),u("n1","f1",a),u("n2","f2",a),u("n3","f3",a),u("n4","f4",a),u("p","n1",o),u("p","n2",o),u("p","n3",o),u("p","n4",o),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l);function u(h,d,f){c(h,f),c(d,f)}function c(h,d){r.push(0,0,0),n.push(d.r,d.g,d.b),s[h]===void 0&&(s[h]=[]),s[h].push(r.length/3-1)}t.setAttribute("position",new Vt(r,3)),t.setAttribute("color",new Vt(n,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;bu.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,r=1,n=.8;rc("n1",t,e,bu,-1,-1,n),rc("n2",t,e,bu,i,-1,n),rc("n3",t,e,bu,-1,r,n),rc("n4",t,e,bu,i,r,n);let s=n;rc("f1",t,e,bu,-1,-1,s),rc("f2",t,e,bu,i,-1,s),rc("f3",t,e,bu,-1,r,s),rc("f4",t,e,bu,i,r,s);let a=s,o=.5;rc("u1",t,e,bu,i*.7*o,r*1.1,a),rc("u2",t,e,bu,-1*.7*o,r*1.1,a),rc("u3",t,e,bu,0,r*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function rc(e,t,i,r,n,s,a){AS.set(n,s,a).unproject(r);let o=t[e];if(o!==void 0){let l=i.getAttribute("position");for(let u=0,c=o.length;u<c;u++)l.setXYZ(o[u],AS.x,AS.y,AS.z)}}var o8e=class extends lw(a8e){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){uw(this.object,this.geometry,e,t,!0)}},rN;(e=>e.is=t=>"objectHelper"in t)(rN||(rN={}));var x1=(e,t)=>class extends XB(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(i,r){this.objectHelper.raycast(i,r)}showGizmos(){for(let i in this.gizmos){let r=this.gizmos[i];r instanceof UC&&(r.visible=!0)}}updateEntityBoxSize(i,r){this.objectHelper.visible&&this.geometryHelper instanceof Dc?(i.setScalar(0),r.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,r)}hideGizmos(){for(let i in this.gizmos){let r=this.gizmos[i];r instanceof UC&&(r.visible=!1)}}},GW=790,i0=new q,FI=new q,UI=new Si,jI=new q,gx=new q,VI=new q,go=class extends x1(sm,o8e){constructor(e="",t={...y_.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=By.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new Pt,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,r=this.height;this.orthoCamera=new _M(i*-.5,i*.5,r*.5,r*-.5,-5e4,1e4),this.perspCamera=new ho(45,i/r,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,i){typeof e=="number"&&(e=new q(e,t,i)),super.lookAt(e),this.getWorldPosition(i0),this.targetOffset=i0.distanceTo(e)}getTarget(e=new q){return this.getWorldDirection(FI),this.getWorldPosition(i0),FI.multiplyScalar(this.targetOffset),e.copy(i0).add(FI),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(i0),i0.distanceTo(e)}updateUp(){this.getWorldQuaternion(UI),jI.set(0,0,1).applyQuaternion(UI),gx.copy(qr.DEFAULT_UP),this.isUpVectorFlipped&&gx.negate(),gx.applyQuaternion(UI),VI.copy(qr.DEFAULT_UP).projectOnPlane(jI),this.angleOffsetFromUp=VI.angleTo(gx),this.angleOffsetFromUp*=VI.cross(gx).dot(jI)>=0?1:-1}updateTransformState(e,t){let i=super.updateTransformState(e,t);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),i}getViewFrontToObject(e){let t=e.getWorldPosition(new q),i=e.getWorldDirection(new q).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new q).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new q;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,i=!1){if(this.aspect=e/t,i){let r=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-790*.5*r,this.right=GW*.5*r,this.top=GW*.5*(1/n),this.bottom=-790*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,i,r,n,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,i,r,n,s):this.orthoCamera.setViewOffset(e,t,i,r,n,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return $3(t,e)}updateCameraSubtype(e,t){let i=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(i,t.zoom),t.near!==void 0&&this.setNear(i,t.near),t.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},r0=new Pt,l8e=new Pt;function qW(e){let t=!1;return e.scene.objects.traverse((i,r)=>{var n;((n=r.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var Qg=class extends y1{constructor(e,t,i){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new ai,this.onAfterRender=(r,n,s,a,o,l)=>{super.onAfterRender(r,n,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var r;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let s=this.children[n];s instanceof Qg&&s.dataPatched.visible===!0&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let s=this.children[n];if(s instanceof Ko&&s.dataPatched.visible===!0&&((r=s.geometry.attributes.position)==null?void 0:r.count)>0&&s.geometry.drawRange.count>0&&s.booleanMeshSetAddress!==0){r0.multiplyMatrices(s.hiddenMatrix,s.matrix);try{if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ld.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;Ld.transformMeshSet(s.booleanMeshSetAddress,r0),s.booleanMatrixInvOld.copy(r0).invert(),s.booleanWasTransformed=!1}else s instanceof Qg&&s.needsTransformForDownstream===!0?(Ld.transformMeshSet(s.booleanMeshSetAddress,r0),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Ld.transformMeshSet(s.booleanMeshSetAddress,l8e.multiplyMatrices(r0,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(r0).invert(),s.booleanWasTransformed=!1)}catch(a){console.error(a),s.booleanMeshSetAddress=0,s.geometry.userData.booleanOperationDidFail=!0;continue}Ld.hasOpenEdges(s.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.booleanOperationDidFail=!1):s.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Vt([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Ld.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new ai,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=Ld.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,cz(this),hz(this)}dispose(){super.dispose(),this.geometry.dispose()}},nN;(e=>{function t(i){return wr.is(i)&&i instanceof iw}e.is=t})(nN||(nN={}));var fz=(e,t)=>class extends x1(e,t){updateState_Light(i,r){this.updateState_Entity(i,r),i.color!==void 0&&(this.color=r.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},mc=e=>e instanceof Ko,$d=e=>e!==null&&e instanceof Qg,u8e=e=>e instanceof go,c8e=e=>nN.is(e),sN=e=>rN.is(e),h8e=new q(1,1,1),YW=new q,d8e=new q,XW=new Si,cw=class extends lw(eOe){constructor(e,t=15){super(t),this.object=e,this.dummy=new Xd,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){uw(this.object,cw.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(YW,XW,d8e),this.matrix.compose(YW,XW,h8e),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},my=class extends x1(Xd,cw){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},Sb=class extends x1(Xd,cw){constructor(e,t,i){super(),this.super_Entity(e,t),this.context=i,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},Xie={RED:0,GREEN:1},hw="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",f8e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,MS=class extends Cr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new wt(null),kernel16:new wt(null),inputBuffer:new wt(null),cocBuffer:new wt(null),texelSize:new wt(new Ie),scale:new wt(1)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:f8e,vertexShader:hw}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),i=new Float32Array(32),r=0,n=0;for(let o=0;o<80;++o){let l=o*e,u=Math.sqrt(o)/Math.sqrt(80),c=u*Math.cos(l),h=u*Math.sin(l);o%5===0?(i[n++]=c,i[n++]=h):(t[r++]=c,t[r++]=h)}let s=[],a=[];for(let o=0;o<128;)s.push(new Pi(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new Pi(i[o++],i[o++],i[o++],i[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function KW(e,t,i){return e*(t-i)-t}function aN(e,t,i){return Math.min(Math.max((e+t)/(t-i),0),1)}var p8e=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,m8e=class extends Cr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new wt(null),focusDistance:new wt(0),focusRange:new wt(0),cameraNear:new wt(.3),cameraFar:new wt(1e3)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:p8e,vertexShader:hw}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=mf){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-KW(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=aN(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-KW(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=aN(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof ho?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},g8e=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,v8e="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",$W=class extends Cr{constructor(e=new Ie){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new wt(null),texelSize:new wt(new Ie),halfTexelSize:new wt(new Ie),kernel:new wt(0),scale:new wt(1)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:g8e,vertexShader:v8e}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},y8e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,x8e=class extends Cr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new wt(null),opacity:new wt(1)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:y8e,vertexShader:hw}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},b8e=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,_8e=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,jM={COLOR:2},w8e={DISABLED:0},E8e=class extends Cr{constructor(e=new Ie,t=jM.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:r1.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new wt(null),depthBuffer:new wt(null),predicationBuffer:new wt(null),texelSize:new wt(e)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:b8e,vertexShader:_8e}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=mf){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},S8e=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,T8e="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",nc={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},oN=class extends Cr{constructor(e,t,i,r,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:r1.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new wt(null),depthBuffer:new wt(null),resolution:new wt(new Ie),texelSize:new wt(new Ie),cameraNear:new wt(.3),cameraFar:new wt(1e3),aspect:new wt(1),time:new wt(0)},blending:Rs,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),i&&this.setUniforms(i),this.adoptCameraSettings(r)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=mf){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=S8e.replace(nc.FRAGMENT_HEAD,e.get(nc.FRAGMENT_HEAD)).replace(nc.FRAGMENT_MAIN_UV,e.get(nc.FRAGMENT_MAIN_UV)).replace(nc.FRAGMENT_MAIN_IMAGE,e.get(nc.FRAGMENT_MAIN_IMAGE)),this.vertexShader=T8e.replace(nc.VERTEX_HEAD,e.get(nc.VERTEX_HEAD)).replace(nc.VERTEX_MAIN_SUPPORT,e.get(nc.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof ho?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let i=this.uniforms;i.resolution.value.set(e,t),i.texelSize.value.set(1/e,1/t),i.aspect.value=e/t}static get Section(){return nc}},C8e=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,A8e=class extends Cr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:r1.replace(/\D+/g,"")},uniforms:{inputBuffer:new wt(null),threshold:new wt(0),smoothing:new wt(1),range:new wt(null)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:C8e,vertexShader:hw}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},M8e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Kie={DISCARD:0,MULTIPLY:1},P8e=class extends Cr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new wt(e),inputBuffer:new wt(null),strength:new wt(1)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:M8e,vertexShader:hw}),this.toneMapped=!1,this.setColorChannel(Xie.RED),this.setMaskFunction(Kie.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==yo&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},D8e=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,I8e="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",O8e=class extends Cr{constructor(e=new Ie,t=new Ie){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new wt(null),searchTexture:new wt(null),areaTexture:new wt(null),resolution:new wt(t),texelSize:new wt(e)},blending:Rs,depthWrite:!1,depthTest:!1,fragmentShader:D8e,vertexShader:I8e}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.resolution.value.set(e,t)}},R8e=new sm,Hf=null;function L8e(){if(Hf===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Hf=new ai,Hf.setAttribute!==void 0?(Hf.setAttribute("position",new gi(e,3)),Hf.setAttribute("uv",new gi(t,2))):(Hf.addAttribute("position",new gi(e,3)),Hf.addAttribute("uv",new gi(t,2)))}return Hf}var Qo=class{constructor(e="Pass",t=new Ol,i=R8e){this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new dn(L8e(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Ol),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=mf){}render(e,t,i,r,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Ol||t===this.renderer)continue;this[e].dispose()}}}},lN=class extends Qo{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new x8e,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Tr(1,1,{minFilter:Ji,magFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,i,r,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==yo?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===$i&&(this.renderTarget.texture.encoding=$i))}},N8e=class extends Qo{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,i,r,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},HI=new mi,pz=class extends Qo{constructor(e=!0,t=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,i){this.color=e,this.depth=t,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,i,r,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,u=a>=0;l?(HI.copy(e.getClearColor(HI)),e.setClearColor(s,u?a:o)):u&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(HI,o):u&&e.setClearAlpha(o)}},Wf=-1,Al=class extends qa{constructor(e,t=Wf,i=Wf,r=1){super(),this.resizable=e,this.base=new Ie(1,1),this.preferred=new Ie(t,i),this.target=this.preferred,this.s=r}get width(){let{base:e,preferred:t,scale:i}=this,r;return t.width!==Wf?r=t.width:t.height!==Wf?r=Math.round(t.height*(e.width/Math.max(e.height,1))):r=Math.round(e.width*i),r}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:i}=this,r;return t.height!==Wf?r=t.height:t.width!==Wf?r=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):r=Math.round(e.height*i),r}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Wf),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Wf}},WI=!1,ZW=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let i;if(t.material.flatShading)switch(t.material.side){case po:i=this.materialsFlatShadedDoubleSide;break;case wa:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(t.material.side){case po:i=this.materialsDoubleSide;break;case wa:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=i[2]:t.isInstancedMesh?t.material=i[1]:t.material=i[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let i of t)i.uniforms=Object.assign({},e.uniforms),i.side=Mc;t[2].skinning=!0,this.materialsBackSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.side=wa,r}),this.materialsDoubleSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.side=po,r}),this.materialsFlatShaded=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=wa,r}),this.materialsFlatShadedDoubleSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=po,r})}}render(e,t,i){let r=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,WI){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,i);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,i),t.overrideMaterial=n}e.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return WI}static set workaroundEnabled(e){WI=e}},k8e=class extends Qo{constructor(e,t,i=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new pz,this.overrideMaterialManager=i===null?null:new ZW(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new ZW(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,i,r,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,u=s.background,c=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=u,e.shadowMap.autoUpdate=c}},QW=class extends Qo{constructor(e,t,{resolutionScale:i=1,width:r=Al.AUTO_SIZE,height:n=Al.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new k8e(e,t,new RJ({depthPacking:yJ}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new mi(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Tr(1,1,{minFilter:ur,magFilter:ur,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Al(this,r,n,i);l.addEventListener("change",u=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,r,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}},Pr={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},B8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",z8e="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",F8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",U8e="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",j8e="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",V8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",H8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",W8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",G8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",q8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",Y8e="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",X8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",K8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",$8e="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Z8e="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Q8e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",J8e="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",e9e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",t9e=new Map([[Pr.SKIP,null],[Pr.ADD,B8e],[Pr.ALPHA,z8e],[Pr.AVERAGE,F8e],[Pr.COLOR_BURN,U8e],[Pr.COLOR_DODGE,j8e],[Pr.DARKEN,V8e],[Pr.DIFFERENCE,H8e],[Pr.EXCLUSION,W8e],[Pr.LIGHTEN,G8e],[Pr.MULTIPLY,q8e],[Pr.DIVIDE,Y8e],[Pr.NEGATION,X8e],[Pr.NORMAL,K8e],[Pr.OVERLAY,$8e],[Pr.REFLECT,Z8e],[Pr.SCREEN,Q8e],[Pr.SOFT_LIGHT,J8e],[Pr.SUBTRACT,e9e]]),i9e=class extends qa{constructor(e,t=1){super(),this.f=e,this.opacity=new wt(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return t9e.get(this.blendFunction)}},Ih={NONE:0,DEPTH:1,CONVOLUTION:2},Vh=class extends qa{constructor(e,t,{attributes:i=Ih.NONE,blendFunction:r=Pr.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=i,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new i9e(r),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=mf){}update(e,t,i){}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Ol||t===this.renderer)continue;this[e].dispose()}}}};function JW(e,t,i){for(let r of t){let n="$1"+e+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(let a of i.entries())a[1]!==null&&i.set(a[0],a[1].replace(s,n))}}function r9e(e,t,i,r,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),u=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),c=[],h=[],d=!1,f=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(u&&a&Ih.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!u)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let m=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,g=oN.Section;if(u){let x=`	${e}MainUv(UV);
`;i.set(g.FRAGMENT_MAIN_UV,i.get(g.FRAGMENT_MAIN_UV)+x),d=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let x=`	${e}MainSupport(`;x+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,i.set(g.VERTEX_MAIN_SUPPORT,i.get(g.VERTEX_MAIN_SUPPORT)+x),c=c.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(w=>w[1])),h=h.concat(c).concat([...o.get("vertex").matchAll(m)].map(w=>w[1]))}h=h.concat([...o.get("fragment").matchAll(m)].map(x=>x[1])),h=h.concat([...t.defines.keys()].map(x=>x.replace(/\([\w\s,]*\)/g,""))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach((x,w)=>s.set(e+w.charAt(0).toUpperCase()+w.slice(1),x)),t.defines.forEach((x,w)=>n.set(e+w.charAt(0).toUpperCase()+w.slice(1),x)),JW(e,h,n),JW(e,h,o);let y=t.blendMode;if(r.set(y.blendFunction,y),l){let x=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,w=`${e}MainImage(color0, UV, `;a&Ih.DEPTH&&x.test(o.get("fragment"))&&(w+="depth, ",f=!0),w+=`color1);
	`;let b=e+"BlendOpacity";s.set(b,y.opacity),w+=`color0 = blend${y.blendFunction}(color0, color1, ${b});

	`,i.set(g.FRAGMENT_MAIN_IMAGE,i.get(g.FRAGMENT_MAIN_IMAGE)+w),w=`uniform float ${b};

`,i.set(g.FRAGMENT_HEAD,i.get(g.FRAGMENT_HEAD)+w)}i.set(g.FRAGMENT_HEAD,i.get(g.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&i.set(g.VERTEX_HEAD,i.get(g.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:c,transformedUv:d,readDepth:f}}var EA=class extends Qo{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new oN(null,null,null,e),this.effects=t.sort((i,r)=>r.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=oN.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),i=new Map,r=new Map,n=new Map,s=new Set,a=0,o=0,l=0,u=!1,c=!1;for(let d of this.effects)if(d.blendMode.blendFunction===Pr.SKIP)l|=d.getAttributes()&Ih.DEPTH;else if(l&d.getAttributes()&Ih.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+a++,m=r9e(f,d,t,i,r,n,l);if(o+=m.varyings.length,u=u||m.transformedUv,c=c||m.readDepth,d.extensions!==null)for(let g of d.extensions)s.add(g)}let h=/\bblend\b/g;for(let d of i.values()){let f=d.getShaderCode().replace(h,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+f+`
`)}l&Ih.DEPTH?(c&&t.set(e.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+t.get(e.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,u?(t.set(e.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+t.get(e.FRAGMENT_MAIN_UV)),r.set("UV","transformedUv")):r.set("UV","vUv"),t.forEach((d,f,m)=>m.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(r)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=mf){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let i of this.effects)i.setDepthTexture(e,t)}render(e,t,i,r,n){for(let s of this.effects)s.update(e,t,r);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=r,e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let i of this.effects)i.setSize(e,t)}initialize(e,t,i){this.renderer=e;for(let r of this.effects)r.initialize(e,t,i),r.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==yo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},n9e=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],mz=class extends Qo{constructor({resolutionScale:e=.5,width:t=Al.AUTO_SIZE,height:i=Al.AUTO_SIZE,kernelSize:r=VM.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Tr(1,1,{minFilter:Ji,magFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new Al(this,t,i,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new $W,this.ditheredBlurMaterial=new $W,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=r}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,r,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,u=n9e[this.kernelSize],c=this.blurMaterial,h=t,d,f;for(this.fullscreenMaterial=c,d=0,f=u.length-1;d<f;++d){let m=d&1?l:o;c.kernel=u[d],c.inputBuffer=h.texture,e.setRenderTarget(m),e.render(s,a),h=m}this.dithering&&(c=this.ditheredBlurMaterial,this.fullscreenMaterial=c),c.kernel=u[d],c.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:i),e.render(s,a)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let r=i.width,n=i.height;this.renderTargetA.setSize(r,n),this.renderTargetB.setSize(r,n),this.blurMaterial.setSize(r,n),this.ditheredBlurMaterial.setSize(r,n)}initialize(e,t,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==yo?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===$i&&(this.renderTargetA.texture.encoding=$i,this.renderTargetB.texture.encoding=$i))}static get AUTO_SIZE(){return Al.AUTO_SIZE}},s9e=class extends Qo{constructor({width:e=Al.AUTO_SIZE,height:t=Al.AUTO_SIZE,renderTarget:i,luminanceRange:r,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new A8e(n,r),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Tr(1,1,{minFilter:Ji,magFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Al(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,i,r,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}initialize(e,t,i){i!==void 0&&i!==yo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},a9e=class extends Qo{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new pz(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,i,r,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,u=this.clearPass,c=this.inverted?0:1,h=1-c;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,c,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(e,null):(u.render(e,t),u.render(e,i))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(i),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Ou=class extends Qo{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,i,r,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}initialize(e,t,i){i!==void 0&&i!==yo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},GI=1/1e3,o9e=1e3,l9e=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*GI}getFixedDelta(){return this.fixedDelta*GI}setFixedDelta(e){return this.fixedDelta=e*o9e,this}getElapsed(){return this.elapsed*GI}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},VM={MEDIUM:2,LARGE:3,HUGE:5},u9e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,c9e=class extends Vh{constructor({blendFunction:e=Pr.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:i=.025,resolutionScale:r=.5,intensity:n=1,width:s=Al.AUTO_SIZE,height:a=Al.AUTO_SIZE,kernelSize:o=VM.LARGE}={}){super("BloomEffect",u9e,{blendFunction:e,uniforms:new Map([["map",new wt(null)],["intensity",new wt(n)]])}),this.renderTarget=new Tr(1,1,{minFilter:Ji,magFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new s9e({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new mz({resolutionScale:r,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",u=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,i){let r=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,r),this.blurPass.render(e,r,r)):this.blurPass.render(e,t,r)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(e,t,i){this.blurPass.initialize(e,t,i),i!==void 0&&(this.renderTarget.texture.type=i,e.outputEncoding===$i&&(this.renderTarget.texture.encoding=$i))}},h9e="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",d9e=class extends Vh{constructor({blendFunction:e=Pr.NORMAL,brightness:t=0,contrast:i=0}={}){super("BrightnessContrastEffect",h9e,{blendFunction:e,uniforms:new Map([["brightness",new wt(t)],["contrast",new wt(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},f9e="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",p9e=class extends Vh{constructor(e=Pr.NORMAL){super("ColorAverageEffect",f9e,{blendFunction:e})}},m9e="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",g9e="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",v9e=class extends Vh{constructor({blendFunction:e=Pr.NORMAL,offset:t=new Ie(.001,5e-4)}={}){super("ChromaticAberrationEffect",m9e,{vertexShader:g9e,blendFunction:e,attributes:Ih.CONVOLUTION,uniforms:new Map([["offset",new wt(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},y9e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,x9e=class extends Vh{constructor(e,{blendFunction:t=Pr.NORMAL,worldFocusDistance:i,worldFocusRange:r,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=Al.AUTO_SIZE,height:u=Al.AUTO_SIZE}={}){super("DepthOfFieldEffect",y9e,{blendFunction:t,attributes:Ih.DEPTH,uniforms:new Map([["nearColorBuffer",new wt(null)],["farColorBuffer",new wt(null)],["nearCoCBuffer",new wt(null)],["scale",new wt(1)]])}),this.camera=e,this.renderTarget=new Tr(1,1,{minFilter:Ji,magFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Ou(new m8e(e));let c=this.cocMaterial;c.focusDistance=n,c.focusRange=a,i!==void 0&&(c.worldFocusDistance=i),r!==void 0&&(c.worldFocusRange=r),this.blurPass=new mz({kernelSize:VM.MEDIUM,width:l,height:u});let h=this.blurPass.getResolution();h.addEventListener("change",f=>this.setSize(h.getBaseWidth(),h.getBaseHeight())),this.maskPass=new Ou(new P8e(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=Kie.MULTIPLY,d.colorChannel=Xie.GREEN,this.bokehNearBasePass=new Ou(new MS(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Ou(new MS(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Ou(new MS(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Ou(new MS(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of t)i.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,i=t.position.distanceTo(e);return aN(-i,t.near,t.far)}setDepthTexture(e,t=mf){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,i){let r=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,r),this.bokehFarFillPass.render(e,r,this.renderTargetFar),this.bokehNearBasePass.render(e,t,r),this.bokehNearFillPass.render(e,r,this.renderTargetNear)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let r=i.width,n=i.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(r,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(r,n))}initialize(e,t,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(r=>r.initialize(e,t,i)),this.blurPass.initialize(e,t,yo),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,e.outputEncoding===$i&&(this.renderTarget.texture.encoding=$i,this.renderTargetNear.texture.encoding=$i,this.renderTargetFar.texture.encoding=$i,this.renderTargetMasked.texture.encoding=$i))}};new q;new Pt;var b9e="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",_9e=class extends Vh{constructor({blendFunction:e=Pr.NORMAL,hue:t=0,saturation:i=0}={}){super("HueSaturationEffect",b9e,{blendFunction:e,uniforms:new Map([["hue",new wt(new q)],["saturation",new wt(i)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),i=Math.cos(e);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new mi;var w9e=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,E9e=class extends Vh{constructor({blendFunction:e=Pr.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",w9e,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},S9e="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",T9e=class extends Vh{constructor(e=30){super("PixelationEffect",S9e,{uniforms:new Map([["active",new wt(!1)],["d",new wt(new Ie)]])}),this.resolution=new Ie,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new q;new q;var e7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",t7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",C9e="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",A9e="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",hg={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},$ie=class extends Vh{constructor({preset:e=hg.MEDIUM,edgeDetectionMode:t=jM.COLOR,predicationMode:i=w8e.DISABLED}={}){super("SMAAEffect",C9e,{vertexShader:A9e,blendFunction:Pr.NORMAL,attributes:Ih.CONVOLUTION|Ih.DEPTH,uniforms:new Map([["weightMap",new wt(null)]])});let r,n;arguments.length>1&&(r=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Tr(1,1,{minFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new pz(!0,!1,!1),this.clearPass.overrideClearColor=new mi(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Ou(new E8e),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new Ou(new O8e);let s=new QJ;s.onLoad=()=>{let a=new jn(r);a.name="SMAA.Search",a.magFilter=ur,a.minFilter=ur,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new jn(n);o.name="SMAA.Area",o.magFilter=Ji,o.minFilter=Ji,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),r!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(r=new Image,n=new Image,r.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),r.src=e7,n.src=t7),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(e){case hg.LOW:t.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case hg.MEDIUM:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case hg.HIGH:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case hg.ULTRA:t.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(e,t=mf){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,i){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return e7}static get areaImageDataURL(){return t7}},M9e=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,PS={DEFAULT:0,ESKIL:1},P9e=class extends Vh{constructor({blendFunction:e=Pr.NORMAL,technique:t=PS.DEFAULT,eskil:i=!1,offset:r=.5,darkness:n=.5}={}){super("VignetteEffect",M9e,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new wt(r)],["darkness",new wt(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===PS.ESKIL}set eskil(e){this.technique=e?PS.ESKIL:PS.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},gf=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Pr.NORMAL}},D9e=class extends gf{constructor(){super(c9e),this.blendFunction=Pr.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},I9e=class extends gf{constructor(){super(d9e)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},O9e=class extends gf{constructor(){super(v9e),this.effect.offset=new Ie(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},R9e=class extends gf{constructor(){super(p9e)}},L9e=class extends gf{constructor(){super(_9e),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},N9e=class extends gf{constructor(){super(E9e),this.blendFunction=Pr.OVERLAY}},k9e=class extends gf{constructor(){super(P9e)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},B9e=class extends gf{constructor(e){super(x9e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!e.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},z9e=class extends gf{constructor(){super(T9e)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},F9e=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,U9e=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,j9e=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,V9e=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,uN=class extends Cr{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new wt(null)},blending:Rs,depthWrite:!1,depthTest:!1,vertexShader:j9e,fragmentShader:V9e})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},H9e=class extends Qo{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new uN,this.resolutionVector=new Ie,this.resolveMaterial=new Cr({name:"TAAResolveMaterial",uniforms:{inputBuffer:new wt(null),historyBuffer:new wt(null),velocityBuffer:new wt(null),depthBuffer:new wt(null),resolution:new wt(new Ie)},blending:Rs,depthWrite:!1,depthTest:!1,vertexShader:F9e,fragmentShader:U9e}),this.historyRenderTarget=new Tr(1024,1024,{minFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Tr(1024,1024,{minFilter:Ji,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let i=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(i),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},W9e=class extends Qo{constructor(e,t,i){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new QW(e,t,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new uN,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new uN,this.depthPass=new QW(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,i){let r=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,i),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=r}},i7=new Ol,G9e=new Cr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),cN=class extends Qo{constructor(e,t,i){super("OpaquePass",t??i7,i),this.MRTCompatible=!0,this.originalMaterials=[],this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??i7}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.length=0,this.scene.traverse(r=>{r.layers.isEnabled(3)&&r instanceof Ko&&(this.originalMaterials.push([r,r.material]),r.material=G9e)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:t;e.setRenderTarget(i),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach(r=>{r[0].material=r[1]})}},q9e=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:i=!1,multisampling:r=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new lN,this.depthTexture=null,this.timer=new l9e,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,i,n,r,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,i,n,r,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,i,n,r,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,i=this.multisampling;i>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let i=e.getSize(new Ie),r=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===yo&&e.outputEncoding===$i&&(this.inputBuffer.texture[0].encoding=$i,this.outputBuffer.texture[0].encoding=$i,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(i.width,i.height,!1);for(let s of this.passes)s.initialize(e,r,n)}}replaceRenderer(e,t=!0){let i=this.renderer,r=i.domElement.parentNode;return this.setRenderer(e),t&&r!==null&&(r.removeChild(i.domElement),r.appendChild(e.domElement)),i}createDepthTexture(){let e=this.depthTexture=new Oy(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=Yg,e.type=Ig):e.type=qd,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,i,r,n,s){let a=this.renderer,o=a===null?new Ie:a.getDrawingBufferSize(new Ie),l={minFilter:Ji,magFilter:Ji,wrapS:Mn,wrapT:Mn,stencilBuffer:t,depthBuffer:e},u;return r>0?(u=new Tr(o.width,o.height,l),u.samples=r):(n?(u=new TJ(o.width,o.height,2,l),u.texture[1].type=lf):u=new Tr(o.width,o.height,l),u.depthTexture=new Oy(2048,2048),u.depthTexture.type=$r),i===yo&&a!==null&&a.outputEncoding===$i&&(Array.isArray(u.texture)?u.texture.forEach(c=>c.encoding=$i):u.texture.encoding=$i),Array.isArray(u.texture)?u.texture.forEach((c,h)=>{c.name=`EffectComposer.Buffer ${n} ${h}`,c.generateMipmaps=!1}):(u.texture.name=`EffectComposer.Buffer ${n}`,u.texture.generateMipmaps=!1),u.name=s,u}addPass(e,t){var o;let i=this.passes,r=this.renderer,n=r.getDrawingBufferSize(new Ie),s=((o=r.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(r),e.setSize(n.width,n.height),e.initialize(r,s,a),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?i.splice(t,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of i)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,i=t.indexOf(e);if(i!==-1&&t.splice(i,1).length>0){if(this.depthTexture!==null){let r=(n,s)=>n||s.needsDepthTexture;t.reduce(r,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&i===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,i=this.copyPass,r=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,u,c,h;e===void 0&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(t,r,n,e,o):d.render(t,s,a,e,o),d.needsSwap&&(o&&(i.renderToScreen=d.renderToScreen,l=t.getContext(),u=t.state.buffers.stencil,u.setFunc(l.NOTEQUAL,1,4294967295),i.render(t,r,n,e,o),u.setFunc(l.EQUAL,1,4294967295)),c=r,h=s,r=n,s=a,n=c,a=h),d instanceof a9e?o=!0:d instanceof N8e&&(o=!1))}setSize(e,t,i){let r=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=r.getSize(new Ie);e=s.width,t=s.height}r.setSize(e,t,i);let n=r.getDrawingBufferSize(new Ie);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Y9e=new Cr({name:"CombineMaterial",uniforms:{inputBufferA:new wt(null),inputBufferB:new wt(null)},blending:Rs,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),X9e=class extends Qo{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=Y9e,this.helperPass=new cN(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new cN(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new $ie({preset:hg.LOW,edgeDetectionMode:jM.COLOR});this.effectPass=new EA(this.camera,t),this.rt=new Tr(10,10,{minFilter:Ji,magFilter:Ji,wrapS:Mn,wrapT:Mn,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,i){this.rt.depthTexture=t.depthTexture;let r=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(r),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},K9e=`#define GLSLIFY 1
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,$9e=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Z9e=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,Q9e=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,J9e=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,eHe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,vx=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],tHe=new Cr({vertexShader:K9e,fragmentShader:$9e}),n0=new Cr({vertexShader:J9e,fragmentShader:eHe,uniforms:{texture_ao_lrez:new wt(null),texture_depth_lrez:new wt(null),texture_depth_hrez:new wt(null),near:new wt(null),far:new wt(null)}}),iHe=class extends Qo{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,r=1024;this.gBuffer=new Tr(i,r,{type:sw?lf:$r,depthTexture:new Oy(i,r),minFilter:Ji,magFilter:Ji}),this.depthBufferHighRes=new Tr(i,r,{depthTexture:new Oy(i,r)}),this.aoBuffer=new Tr(i,r,{minFilter:Ji,magFilter:Ji}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(vx.length*2);for(let a=0;a<vx.length;a++){let o=a*2;n[o+0]=vx[a][0],n[o+1]=vx[a][1]}this.blueNoiseInDiskTexture=new Wo(n,vx.length,1,AC,$r),this.blueNoiseInDiskTexture.wrapS=Gd,this.blueNoiseInDiskTexture.wrapT=Gd,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Cr({vertexShader:Z9e,fragmentShader:Q9e,uniforms:{near:new wt(null),far:new wt(null),fov:new wt(null),proj_info:new wt(new Pi),is_ortho:new wt(!1),resolution:new wt(new Ie),radius_of_influence:new wt(8),radius_in_screen_space:new wt(1),exponent:new wt(1),ao_color:new wt(new q),bias:new wt(.5),texture_depth:new wt(null),texture_normals:new wt(null),texture_blue_noise:new wt(null),texture_blue_noise_in_disk:new wt(this.blueNoiseInDiskTexture),frame_index:new wt(0),fog_enabled:new wt(!1),fog_near:new wt(1),fog_far:new wt(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Tr(i,r,{minFilter:Ji,magFilter:Ji,wrapS:Mn,wrapT:Mn,depthBuffer:!1,type:$r});let s=new $ie({preset:hg.ULTRA,edgeDetectionMode:jM.COLOR});this.effectPass=new EA(this.camera,s)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let i=this._runHalfRes?.5:1,r=e*i,n=t*i;this.gBuffer.setSize(r,n),this.aoBuffer.setSize(r,n),this.hbaoMaterial.uniforms.resolution.value.set(r,n),this.aaBuffer.setSize(r,n),this.effectPass.setSize(r,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,n0.uniforms.texture_depth_hrez.value=e,n0.needsUpdate=!0}render(e,t,i){this.splineScene.overrideMaterial=tHe;let r=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=r,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let u=this.splineCamera.perspCamera.fov*(Math.PI/180),c=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(u*.5)*2),h=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let u=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),c=this.hbaoMaterial.uniforms.radius_of_influence.value*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=c,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=n0,n0.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,n0.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,n0.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},rHe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,nHe=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,sHe=class extends Ou{constructor(){super(new Cr({vertexShader:rHe,fragmentShader:nHe,uniforms:{tInput:new wt(null),tMap:new wt(null),uResolution:new wt(new Ie),uSize:new wt(new Ie),uCoords:new wt(new Ie),uScale:new wt(1),uSceneColor:new wt(new mi(16711680)),uDPR:new wt(1),uCurrent:new wt(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},aHe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oHe=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,lHe=[],uHe=class extends Ou{constructor(){super(new Cr({vertexShader:aHe,fragmentShader:oHe,uniforms:{toScene:new wt(null),fromScene:new wt(null),uResolution:new wt(new Ie),uDPR:new wt(1),mixRatio:new wt(0),threshold:new wt(.1),useTexture:new wt(0),tMixTexture:{value:lHe[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},cHe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hHe=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,dHe=class extends Ou{constructor(){super(new Cr({vertexShader:cHe,fragmentShader:hHe,uniforms:{inputBuffer:new wt(null),blurredInputBuffer:new wt(null),overlay:new wt(null),uResolution:new wt(new Ie),uDPR:new wt(1),blurIntensity:new wt(0)}})),this._blurEnabled=!1,this.blurTarget=new Tr(1,1,{minFilter:Ji,magFilter:Ji,wrapS:Mn,wrapT:Mn}),this.blurPass=new mz({width:window.innerWidth,height:window.innerHeight,kernelSize:VM.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,i=1){this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=i,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let i=t.data.backgroundBlur,r=i.radius;this._blurEnabled=i.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=r/3}}render(e,t,i,r,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,r,n)),super.render(e,t,i,r,n)}},fHe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,pHe=`
uniform sampler2D tInput;
uniform sampler2D tOverlayImage;
varying vec2 vUv;
uniform vec2 uResolution;
uniform vec2 uRightBottom;
uniform vec2 uImageSize;
uniform float uScale;
uniform float uDPR;

vec3 blendNormal(vec3 base, vec3 blend) {
	return blend;
}

vec3 blendNormal(vec3 base, vec3 blend, float opacity) {
	return (blendNormal(base, blend) * opacity + base * (1.0 - opacity));
}

vec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {
	vec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);
	if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {
		return vec4(0.0);
	}
	return texture2D(image, uv);
}

void main() {
    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);
	vec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);
    vec4 background = texture2D(tInput, screenUV);
    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);
    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));
}
`,mHe=class extends Ou{constructor(){super(new Cr({vertexShader:fHe,fragmentShader:pHe,uniforms:{tInput:new wt(null),tOverlayImage:new wt(null),uResolution:new wt(new Ie),uImageSize:new wt(new Ie),uRightBottom:new wt(new Ie(20,20)),uScale:new wt(.25),uDPR:new wt(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function r7(e,t){return t&&t.enabled&&e.push(t.effect),e}var gHe=e=>Object.values(Pr).includes(e)?e:Pr.NORMAL,vHe=class extends qa{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=aA.defaultData,this._scene=new Ol,this._camera=new go,this.effects=new Map,this.blueNoiseTexture=new Wo,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new BIe,this.renderer=e,this.debug=!1,this.effects.set("bloom",new D9e),this.effects.set("chromaticAberration",new O9e),this.effects.set("vignette",new k9e),this.effects.set("noise",new N9e),this.effects.set("colorAverage",new R9e),this.effects.set("hueSaturation",new L9e),this.effects.set("brightnessContrast",new I9e),this.effects.set("depthOfField",new B9e),this.effects.set("pixelation",new z9e),this.effectComposer=new q9e(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new cN(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new W9e(this.scene,this.camera,this.renderer),this.aoPass=new iHe(this.scene,this.camera),this.taaPass=new H9e,this.taaPass.renderToScreen=!1,this.helperPass=new X9e(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new sHe,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new dHe,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new mHe,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new uHe,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let i=this.effectComposer.passes[t];if(i.enabled===!0&&!e&&this._renderToScreen){i.renderToScreen=!0,e=!0;continue}i.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new Wo(e,128,128),this.blueNoiseTexture.wrapS=Gd,this.blueNoiseTexture.wrapT=Gd,this.blueNoiseTexture.minFilter=ur,this.blueNoiseTexture.magFilter=ur,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,i,r,n,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=i,this.aoPass.aoColor=r,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t,i;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let r=[this.effects.get("pixelation")].reduce(r7,[]);r.length>0&&(this.uvEffectPass=new EA(this.camera,...r),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(r7,[]);if(n.length>0&&(this.effectPass=new EA(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&((i=this.effects.get("depthOfField"))==null?void 0:i.enabled)&&window!==void 0)){let s=this.renderer.viewportWidth,a=this.renderer.viewportHeight;this.renderer.setSize(s-1,a-1),this.renderer.setSize(s,a)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new Ie;this.renderer.getDrawingBufferSize(e),this._rt=new Tr(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Gd,wrapT:Gd}),this._rt.samples=0,this._savePass=new lN(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new lN(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=e!==null,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...i}=e,r=!1;t!==this.postprocessingState.enabled&&(r=!0);for(let n of Object.entries(i)){let s=n[1],a=this.effects.get(n[0]);if(a){a.enabled!==s.enabled&&(r=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=gHe(l):a[o]=l}}this.postprocessingState=e,r&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,i,r){e instanceof Pi?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,i,r),this.effectComposer.outputBuffer.scissor.set(e,t,i,r));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,i,r)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,i,r){e instanceof Pi?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,i,r),this.effectComposer.outputBuffer.viewport.set(e,t,i,r))}resize(e,t,i){if(this.effectComposer.setSize(e,t,i),this._rt){let r=this.renderer.getPixelRatio();this._rt.setSize(e*r,t*r)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},yHe=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,xHe=Qi.lights_fragment_begin,bHe=Qi.shadowmask_pars_fragment,n7=null,_He=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},wHe=(e="medium")=>{if(n7===e)return!1;n7=e;let t=_He(e);Qi.shadowmap_pars_fragment=yHe(t);let i=xHe.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Qi.lights_fragment_begin=i;let r=bHe.slice();return r=r.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Qi.shadowmask_pars_fragment=r,!0},EHe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
	
void main()
{
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <morphtarget_vertex>
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,SHe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,qI=new Cr({vertexShader:EHe,fragmentShader:SHe,uniforms:{depthContrast:{value:1}}}),s7=new jn,a7=new Ie,THe=class extends LJ{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new Ie,this.dummyCamera=new go,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;n&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.pipeline=new vHe(this,(e==null?void 0:e.needsDOFResize)??!1),this.autoClear=!1;let t=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=tB,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let r=this.getContext();if(r&&"drawingBufferColorSpace"in r)try{r.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,s,a=!0)=>{var o,l;(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,i(n,s,a),(o=this.normalRenderTarget)==null||o.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Tr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Ji,magFilter:Ji,wrapS:Mn,wrapT:Mn,depthBuffer:!1}))}_resizeTransmission(e,t){var i,r;(i=this.transmissionRenderTarget)==null||i.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(r=this.aoRenderTarget)==null||r.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return xi.transmissionLod.value===1}set hdTransmission(e){xi.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Tr(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:Dy,magFilter:Ji,wrapS:Mn,wrapT:Mn,depthBuffer:!1}),this.transmissionDepthTarget=new Tr(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:ur,magFilter:ur,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Tr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:ur,magFilter:ur,type:$r,depthTexture:new Oy(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),t.traverseEntity(r=>{r.layers.isEnabled(8)&&(r.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),i instanceof go?qI.uniforms.depthContrast.value=(i.far-i.near)/1e4:qI.uniforms.depthContrast.value=1,t.overrideMaterial=qI,this.render(t,i),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?vN:null,i.layers.enable(0),i.layers.enable(3),t.traverseEntity(r=>{r.layers.isEnabled(8)&&(r.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,i=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let r=t.height,n=t.width,s=this.viewportWidth/this.viewportHeight;n<r?n=r*s:r=n/s,this.dummyCamera.setViewplaneSize(n,r);for(let a=0;a<i;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:i=this.sceneHelpers,sceneHelpersOnTop:r=this.sceneHelpersOnTop,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){var d;let a=e instanceof Ez?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((f,m)=>{xi.penumbraSize.value[m]=f}),xi.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?xi.resolution.value.set(this.resolution.x,this.resolution.y):xi.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(xi.normalRenderTarget.value=s,xi.normalRenderTargetDepth.value=s7):l.needsNormal()&&(this.createNormalRenderTarget(),xi.normalRenderTarget.value=this.normalRenderTarget.texture,xi.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let u=a.data.ao,c=u.occlusion;if(c&&(this.createAORenderTarget(),xi.aoRenderTarget.value=this.aoRenderTarget.texture),xi.aoEnabled.value=c,this.pipeline.setAmbientOcclusionParams(u.occlusion,u.radius,u.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,u.aoFullRes&&!sw),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((d=a.uiCanvas)==null?void 0:d.enabled)&&a.uiCanvas.texture&&a.uiCanvas.texture.image.width>0){let f=this.getSize(a7),m=this.getPixelRatio();(a.uiCanvas.width!==this.viewportWidth||a.uiCanvas.height!==this.viewportHeight||a.uiCanvas.dpr!==m)&&a.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},m),a.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=a.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(f.x,f.y,m),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let f=this.getSize(a7),m=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(f.x,f.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=m}let h=!1;if(n!==void 0)xi.transmissionRenderTarget.value=n,xi.transmissionRenderTargetDepth.value=s7,this.pipeline.setTransmissionPassEnabled(!1);else{let f=l.needsTransmission();f&&(this.transmissionRenderTarget===void 0&&(h=!0),this.createTransmissionRenderTarget(),xi.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,xi.aspectRatio.value=pje(this.viewportWidth,this.viewportHeight),xi.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(f)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=a,this.pipeline.camera=t,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!i&&!r&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),l.shapeBlendIntances.forEach(f=>{f.onBeforeShadowPass(this)}),a.overrideMaterial=l.wireframeState?vN:null,this.pipeline.render(),xi.frameIndex.value=(xi.frameIndex.value+1)%16,t instanceof go&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let r=this.pipeline.sceneTransitionPass.uniforms;r.uDPR.value=window.devicePixelRatio,r.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,i,r,n,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(r=this.normalRenderTarget)==null||r.dispose(),(s=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose()}},Zie=class extends lw(JIe){constructor(e,t=15,i=10066329){super(e,t,i),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){uw(this.object,Zie.geometryHelper,e,t)}},Qie=class extends lw(QIe){constructor(e,t=15,i=6710886){super(e,t,i),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){uw(this.object,Qie.geometryHelper,e,t)}},hN=class extends lw(ZIe){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){uw(this.object,hN.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=hN._vector,t=this.object.distance?this.object.distance:1e3,i=t*Math.tan(this.object.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let r=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(r);else this.cone.material.color.set(r)}}},Jie=hN;Jie._vector=new q;var ere=class extends Xd{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new dn(new Nh(1,1),new uf({transparent:!0,opacity:0,side:po})),this.add(this.caretMesh),this.selectionMesh=new dn(new Nh(1,1),new uf({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:po})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e;return((e=this.object)==null?void 0:e.AD)??0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=-this.caretHeight*.5,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(this.object===void 0)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(this.object===void 0)return;let e=this.object,t=e.parent;t!==null&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),t!==null?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let i of this.children)i.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let i=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,i&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e,t={}){if(this.object===void 0)return;this.caretIndex=e;let i=this.object.wrappedText,[r,n]=SA(i,e),[s,a]=e>0?SA(i,e-1):[null,null];(e>0&&i.length?i[s].charAt(a):null)===`
`&&(r++,n=0),this.current.start=e,this.current.end=void 0;let[o,l]=YI(this.object,r,n),{AD:u,descender:c}=this.object,h=c+u*.5,{width:d,height:f,depth:m}=this.object.geometry.userData.parameters,g=typeof d=="string"?0:d,y=typeof f=="string"?0:f;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(o-g*.5,l+h+y*.5,m),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(this.object===void 0)return;let i=this.object.wrappedText;this.current.start=e,this.current.end=t;let r=[],n=[],s=CHe(i,e,t),{lineHeight:a,AD:o,descender:l}=this.object,u=l+o*.5-a*.5;for(let[y,x,w]of s)if(x!==w){let[b,C]=YI(this.object,y,x),[A,E]=YI(this.object,y,w);C+=u,E+=u,E+=a;let _=r.length/3;r.push(b,C,0),r.push(A,C,0),r.push(A,E,0),r.push(b,E,0),n.push(_+0,_+1,_+2),n.push(_+2,_+3,_+0)}let c=new ai;c.setIndex(n),c.setAttribute("position",new Vt(r,3));let{width:h,height:d,depth:f}=this.object.geometry.userData.parameters,m=typeof h=="string"?0:h,g=typeof d=="string"?0:d;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=c,this.selectionMesh.position.x=-m*.5,this.selectionMesh.position.y=g*.5,this.selectionMesh.position.z=f,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t,i="previous"){if(this.object===void 0||this.object.font===void 0)return;let r=this.object.wrappedText,n=r.length,s=this.object.lineHeight,a=n*s,{height:o,verticalAlign:l}=this.object.geometry.userData.parameters,u=typeof o=="string"?0:o,c=0;l===3?c=u-a:l===2&&(c=u*.5-a*.5);let h=Math.min(Math.floor(Math.max(Math.min(-t-c,a),0)/s),n-1),d=this.object.charCoords[h],f=this.object.charWidths[h],m=0,g=!1;if(i==="previous"){for(let y=0;y<d.length;y++)if(d[y][0]+f[y]*.5-e>0){m=y,g=!0;break}}else if(i==="closest"){let y=1/0;for(let x=0;x<d.length;x++){let w=d[x][0]+f[x]*.5,b=Math.abs(w-e);b<y&&(y=b,m=x,g=!0)}}else for(let y=0;y<d.length;y++){let x=d[y][0],w=d[y][0]+f[y];if(e>=x&&e<w){m=y,g=!0;break}}return g||(m=d.length),{index:this.getGlobalIndexFromLineAndCharIndexes(r,h,m),lineIndex:h,characterIndex:m}}getGlobalIndexFromLineAndCharIndexes(e,t,i){return e.slice(0,t).reduce((r,n)=>r+=n.length,0)+i}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function YI(e,t,i){let{charCoords:r,charWidths:n,initialOffsetY:s,lineHeight:a}=e;if(r[t]&&r[t].length===0||r.length===0){let c=0,{horizontalAlign:h}=e.data.geometry,d=e.wrappedText,{width:f}=e.geometry.userData.parameters;return d.length===1&&d[0].length===0&&(h===3?c=f*.5:h===2&&(c=f)),[c,s-a*t]}let o=r[t];if(o===void 0||o.length===0)return[0,0];let[l,u]=o[Math.min(i,o.length-1)];return i>=o.length&&(l+=n[t][i-1]),[l,u]}function SA(e,t){var r;let i=0;for(let n=0;n<e.length;n++){let s=e[n],a=t-i;if(a<=s.length)return[n,a];i+=s.length}return[Math.max(0,e.length-1),((r=e[e.length-1])==null?void 0:r.length)??0]}function CHe(e,t,i){let[r,n]=SA(e,t),[s,a]=SA(e,i),o=[];n>=e[r].length&&(r++,n=0);for(let l=r;l<=s;l++){let u=e[l],c=l===r?n:0,h=l===s?a:u.length;o.push([l,c,h])}return o}function AHe(e,t){let i=za.fromHex(3223857),r=.8;for(let n of e.layers){if(n.data.type==="light"||n.data.type==="displace"||n.data.type==="fresnel"||n.data.type==="matcap"||n.data.type==="texture"||n.data.type==="toon"||n.data.type==="outline"||n.data.type==="transmission"||n.data.type==="noise")continue;let s=typeof n.data.alpha=="string"?Number(t.getVariable(n.data.alpha)):n.data.alpha;if(n.data.type==="color"&&s>.3){i=MHe(n.data.color,t),r=s;break}else if((n.data.type==="depth"||n.data.type==="gradient")&&s>.3){let a=PHe(n.data);i={r:a[0],g:a[1],b:a[2]},r=typeof n.data.alpha=="string"?1:n.data.alpha;break}}return{...i,a:r}}function MHe(e,t){return typeof e=="string"?t.data.colors[e]:e}function PHe(e){return e.colors[0]}function DHe(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var tre=class extends fz(kIe,Zie){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.top=1250,r.bottom=-1250,r.right=1250,r.left=-1250,r.near=-1e4,r.far=2500;let n=new FC(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof FC&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let i=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&DHe(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),i&&this.update()}},o7=new q,l7=new q,u7=new Si,ire=class extends fz(OIe,Jie){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.fov=Xt.RAD2DEG*2*this.angle,r.aspect=1,r.near=100,r.far=2500;let n=new FC(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof FC&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),l7.setFromMatrixPosition(this.matrixWorld),u7.setFromRotationMatrix(this.matrixWorld),o7.copy(this.up).applyQuaternion(u7).negate().multiplyScalar(this.distance),this.target.position.copy(l7).add(o7),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function IHe(e){let t=(e[0][0]+e[1][1])/2,i=(e[0][0]-e[1][1])/2,r=(e[1][0]+e[0][1])/2,n=(e[1][0]-e[0][1])/2,s=Math.sqrt(t*t+n*n),a=Math.sqrt(i*i+r*r),o=s+a,l=s-a,u=Math.atan2(r,i),c=Math.atan2(n,t),h=(c-u)/2,d=(c+u)/2,f=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]],m=[[o,0],[0,l]],g=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]];return f[0][0]*=-1,f[0][1]*=-1,g[0][0]*=-1,g[1][0]*=-1,[f,m,g]}function PT(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function c7(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function OHe(e){let[t,i,r]=IHe(e),n=PT(t,c7(r)),s=PT(PT(r,i),c7(r)),a=Math.atan2(n[1][0],n[0][0]),o=[s[0][0],s[1][1]],l=[s[0][1]/s[1][1],s[1][0]/s[0][0]];return{rotation:a,scale:o,shear:l}}function RHe({rotation:e,scale:t,shear:i}){let r=Math.cos(e),n=Math.sin(e),s=[[r,-n],[n,r]],a=[[t[0],i[0]*t[1]],[i[1]*t[0],t[1]]],o=PT(s,a);return[o[0][0],o[1][0],o[0][1],o[1][1]]}var Or;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function i(E,_=e.identity()){for(let P=0,I=E.length;P<I;P++)_[P]=E[P];return _}e.copy=i;function r(E,_,P,I,D,k){return e.setAbcdef(e.identity(),E,_,P,I,D,k)}e.create=r;function n(E,_,P,I,D,k,B){return E[0]=_,E[1]=I,E[2]=k,E[3]=P,E[4]=D,E[5]=B,E}e.setAbcdef=n;function s(E,_){let[P,I,D,k,B,z]=o(E),[W,$,Z,G,V,J]=o(_),U=W*P+$*D,ie=W*I+$*k,se=Z*P+G*D,ee=Z*I+G*k,ve=V*P+J*D+B,_e=V*I+J*k+z;return e.create(U,ie,se,ee,ve,_e)}e.append=s;function a(E,_){let[P,I,D,k,B,z]=o(E),[W,$,Z,G,V,J]=o(_),U=P,ie=I,se=D,ee=k;(W!==1||$!==0||Z!==0||G!==1)&&(U=P*W+I*Z,ie=P*$+I*G,se=D*W+k*Z,ee=D*$+k*G);let ve=B*W+z*Z+V,_e=B*$+z*G+J;return e.create(U,ie,se,ee,ve,_e)}e.prepend=a;function o(E){return[E[0],E[3],E[1],E[4],E[2],E[5]]}e.getAbcdef=o;function l(E){let[_,P,I,D,k,B]=e.getAbcdef(E),z=_*D-P*I,W=D/z,$=-P/z,Z=-I/z,G=_/z,V=(I*B-D*k)/z,J=-(_*B-P*k)/z;return e.create(W,$,Z,G,V,J)}e.invert=l;function u([E,_],P){let[I,D,k,B,z,W]=e.getAbcdef(P);return[I*E+k*_+z,D*E+B*_+W]}e.apply=u;function c(E,_){let[P,I,D,k,B,z]=e.getAbcdef(_),W=1/(P*k+D*-I),[$,Z]=E;return[k*W*$+-D*W*Z+(z*D-B*k)*W,P*W*Z+-I*W*$+(-z*P+B*I)*W]}e.applyInverse=c;function h(E,_,P=_){let[I,D,k,B,z,W]=e.getAbcdef(E);return e.setAbcdef(E,I*_,D*P,k*_,B*P,z*_,W*P),E}e.scale=h;function d(E,_){let P=Math.cos(_),I=Math.sin(_),[D,k,B,z,W,$]=e.getAbcdef(E);return e.setAbcdef(E,D*P-k*I,D*I+k*P,B*P-z*I,B*I+z*P,W*P-$*I,W*I+$*P),E}e.rotate=d;function f(E,_,P){let[I,D]=P,k=e.translate(E,-I,-D);return k=e.rotate(k,_),k=e.translate(k,I,D),k}e.rotateAround=f;function m(E,_,P){let[I,D,k,B,z,W]=e.getAbcdef(E);return e.setAbcdef(E,I,D,k,B,z+_,W+P),E}e.translate=m;function g(E,_,P){let[I,D,k,B]=e.getAbcdef(E);return e.setAbcdef(E,I,D,k,B,_,P),E}e.setTranslate=g;function y(E,_,P){let[I,D,k,B]=e.getAbcdef(E);return e.setAbcdef(E,I,D,k,B,_,P),E}e.setPosition=y;function x(E){let[_,P,I,D]=e.getAbcdef(E),k=Math.sqrt(_*_+P*P),B=Math.sqrt(I*I+D*D);return[k,B]}e.getScale=x;function w(E){let[,,,,_,P]=e.getAbcdef(E);return[_,P]}e.getPosition=w;function b(E,_){return e.decompose(E,_).rotation}e.getRotation=b;function C(E,_){let[P,I,D,k,B,z]=e.getAbcdef(E),{rotation:W,scale:$,shear:Z}=OHe([[P,D],[I,k]]);return{position:[B+(_[0]*P+_[1]*D)-_[0],z+(_[0]*I+_[1]*k)-_[1]],scale:$,rotation:W,shear:Z,pivot:_}}e.decompose=C;function A(E,_,P,I,D=[0,0]){let[k,B]=E,[z,W]=I,[$,Z,G,V]=RHe({rotation:P,scale:_,shear:D}),J=k-(z*$+W*G)+z,U=B-(z*Z+W*V)+W;return e.create($,Z,G,V,J,U)}e.compose=A})(Or||(Or={}));var LHe=Math.PI/180;function NHe(e,t,i,r,n,s){let a=e-i,o=t-r;return a*a/(n*n)+o*o/(s*s)<=1}function kHe(e){return e*LHe}var Ta=class{constructor(e,t,i){this.uuid=e,this.data=t,this.localMatrix=Or.identity(),this.worldMatrix=Or.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new dN,this._recursiveBBox=new dN,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=FM(),this.dpr=i.dpr??1,this.dataPatched=t}project(e,t){let i=this.worldMatrix;return t&&(i=Or.append(t.worldMatrix,i)),Or.applyInverse(e,i)}intersects(e,t,i,r=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],i),r)}intersectsInLocalSpace(e,t,i=!1){let{min:r,max:n}=i?this.recursiveBBox:this.singleBBox;return e>=r[0]&&e<=n[0]&&t>=r[1]&&t<=n[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=Or.compose(this.position,this.scale,kHe(this.rotation),Ng.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,i){let r=this.parent;t&&r!==null&&r!==void 0&&r.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=Or.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=Or.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return Ng.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),e.shear!==void 0&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,i){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let r=e,n=sn(e.path,["states","*"]);if(n!==null){if(e.type===0){let[s]=n;if((this==null?void 0:this.stateSelection)===s){let a={...e.props};if(delete a.name,Object.values(e.props).some(o=>o===void 0)){let o=this.data;if(o!==void 0){let l=$s.zoom(o,e.path.slice(2));if(l)for(let u in e.props)e.props[u]===void 0&&u in l&&(a[u]=l[u])}}r={...e,props:a,path:e.path.slice(2)}}}}else if(e.type===0){let s=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(s!==void 0){if(e.props.name!==void 0&&s.name){let{name:o,...l}=s;s=l}let a=$s.removeOverridden(e.path,e.props,s);r={...e,props:a}}}this.updateByPatchedOpBase(r,Eg.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i)}changeSelectedState(e,t,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)Eg.toOps(this.data,r.data).forEach(n=>{let s=$C.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(s,this.data,t)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=Eg.patch(this.data,r),Eg.toOps(this.data,r).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,t)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,i){this.dataPatched=t,this.updateByPatchedOp(e,t,i)}updateByPatchedOp(e,t,i){e.path.length===0&&e.type===0&&this.updateState(e.props,i),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Ta(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let i=t.indexOf(this)+1;return t[i]?t[i]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Ta&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},gc=class extends Ta{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.context=i,this.children=[]}add(e){e.parent&&e.parent instanceof gc&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let i of this.children)i instanceof gc?i.traverse(e):t=e(i)}intersectsChildrenHelper(e,t,i,r,n){for(let s of this.children)if(s.intersects(e,t,i,!1)&&(n.push(s),r)||s instanceof gc&&s.intersectsChildrenHelper(e,t,i,r,n))return!0;return!1}intersectsChildren(e,t,i,r=!1,n=[],s=!1){return this.intersectsChildrenHelper(e,t,i,r,n),n}intersectsChildrenHelperReverse(e,t,i,r,n){for(let s of this.children)if(s instanceof gc&&s.intersectsChildrenHelperReverse(e,t,i,r,n)||s.intersects(e,t,i,!1)&&(n.push(s),r))return!0;return!1}intersectsChildrenReverse(e,t,i,r=!1,n=[],s=!1){return this.intersectsChildrenHelperReverse(e,t,i,r,n),n}updateWorldMatrix(e,t,i){if(super.updateWorldMatrix(e,t,i),i&&this.children)for(let r of this.children)r.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(i=>{i.uuid===e&&(t=i)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new gc(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}},$p=class extends gc{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.updateState(t,i)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new $p(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}};function BHe(e,t){let[[i,r],[n,s]]=e,[[a,o],[l,u]]=t,c=(i-n)*(o-u)-(r-s)*(a-l);if(c===0)return!1;let h=((i-a)*(o-u)-(r-o)*(a-l))/c,d=-((i-n)*(r-o)-(r-s)*(i-a))/c;return h>=0&&h<=1&&d>=0&&d<=1}var rre=[[-1,1],[-1,-1],[1,-1],[1,1]],h7=(e,t,i)=>{let r=e.getCenter(),n=e.getHalfSize(),s=Or.append(t,e.worldMatrix);n[0]===0&&n[1]===0?i.push(Or.apply(r,s)):rre.forEach(a=>{let o=[a[0]*n[0]+r[0],a[1]*n[1]+r[1]];i.push(Or.apply(o,s))})},dN=class{constructor(){this.matrix=Or.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),Or.copy(e.worldMatrix,this.matrix);let i=Or.invert(e.worldMatrix);this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t,i=!1){let r=[];i===!0&&e instanceof gc?e.traverse(n=>{n.visible&&h7(n,t,r)}):h7(e,t,r),this.setFromPoints(r)}setFromSize(e,t,i){this.makeEmpty(),Or.copy(i,this.matrix),this.expandBySize(e,t,i)}expandBySize(e,t,i){[Or.apply([0,0],i),Or.apply([0,t],i),Or.apply([e,t],i),Or.apply([e,0],i)].forEach(r=>this.expandByPoint(r))}getCenter(){let[e,t]=this.min,[i,r]=this.getHalfSize();return Or.apply([e+i,t+r],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),i=this.getCenter(),[r,n,s,a]=Or.getAbcdef(this.matrix),o=Or.create(r,n,s,a,i[0],i[1]);this.vertices=rre.map(([l,u])=>Or.apply([l*e,u*t],o))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let i=this.matrix;return t&&(i=Or.append(t.worldMatrix,i)),Or.applyInverse(e,i)}intersects(e,t,i){return this.intersectsInLocalSpace(...this.project([e,t],i))}intersectsInLocalSpace(e,t){let{min:i,max:r}=this;return e>=i[0]&&e<=r[0]&&t>=i[1]&&t<=r[1]}containsPoint(e){let[t,i]=e,[r,n]=this.min,[s,a]=this.max;return t>=r&&t<=s&&i>=n&&i<=a}intersectsBBox2D(e){for(let t=0,i=this.edges.length;t<i;t++){let r=this.edges[t];for(let n=0,s=e.edges.length;n<s;n++){let a=e.edges[n];if(BHe(r,a))return!0}}for(let t=0,i=e.vertices.length;t<i;t++){let r=e.vertices[t];if(this.containsPoint(r))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],Or.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new dN;return e.copy(this),e}},nre,zHe=new Promise(e=>{nre=e}),d7=!1,DS;function FHe(){if(d7)return;if(DS)return DS;async function e(){let t=await Ll(()=>import("./ui-Ds7EeOeb.js"),[]);nre(t.default??t),d7=!0}return DS=e(),DS}function f7(e){let t=!1;return e.scene.objects.traverse((i,r)=>{(r.type==="Mesh"&&r.geometry.type==="UIGeometry"||r.type==="Page"&&r.uiFrame!==void 0)&&(t=!0)}),t}var ki,XI;async function UHe(e){let t=await zHe;ki||(XI||(XI=t({locateFile:()=>e})),ki=await XI)}var p7=Or.identity(),sre=class{constructor(e,t=1){this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=Qr.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=Qr.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let i=e.getBoundingClientRect();e.width=i.width*t,e.height=i.height*t}catch{console.log(e.width,t)}this._currentM3Transform=p7,this._currentTransform=new Float32Array(p7)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await UHe(this.wasmURL),this._surface=ki.MakeWebGLCanvasSurface(this.canvas),this.ctx=(e=this._surface)==null?void 0:e.getCanvas(),this._paint=new ki.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(ki.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(ki.PaintStyle.Stroke),(t=this.ctx)==null||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let i=await(await fetch(e)).arrayBuffer();this.registerFont(i,t)}registerFont(e,t){if(this._fonts.has(t))return;let i=ki.FontMgr.FromData(e);if(i)this._fonts.set(t,i);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(IS(e),ki.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(IS(e),ki.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;(e=this.ctx)==null||e.clear(ki.TRANSPARENT)}save(){var e;(e=this.ctx)==null||e.save()}restore(){var e;(e=this.ctx)==null||e.restore()}beginPath(){var e;(e=this._currentPath)==null||e.delete(),this._currentPath=new ki.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,i,r,n=0,s=0,a=0,o=0){var u,c;let l=ki.XYWHRect(e,t,i,r);if(n===0&&s===0&&o===0&&a===0)(u=this.ctx)==null||u.clipRect(l,ki.ClipOp.Intersect,!0);else{let h=ki.RRectXY(l,n,n);h[4]=h[5]=n,h[6]=h[7]=s,h[8]=h[9]=a,h[10]=h[11]=o,(c=this.ctx)==null||c.clipRRect(h,ki.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=Or.invert(this.currentTransform);this.ctx.concat(e);let t=Or.translate(Or.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,i=!0){var r,n,s,a;if(this.ctx&&this._currentPath){let o,l=!1;if(i&&this._hasDropShadow()){let u=e.copy();u.setColor(IS(this._dropShadowColor));let c;this._dropShadowBlur>0&&(c=ki.MaskFilter.MakeBlur(ki.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((r=this.camera)==null?void 0:r.scale)??1),!1),u.setMaskFilter(c)),this.ctx.save(),this.ctx.clipPath(this._currentPath,ki.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(u),this.ctx.restore(),u.delete(),c==null||c.delete()}if(this._backgroundBlur>0&&i){this.ctx.save(),this.ctx.clipPath(this._currentPath,ki.ClipOp.Intersect,!0);let u=ki.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,ki.TileMode.Clamp,null),c=e.copy();c.setImageFilter(u),c.setAlphaf(1);let h=this._currentPath.computeTightBounds();this.ctx.saveLayer(c,h,null,ki.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),c.delete(),u.delete(),l=!0}if(this._layerBlur>0){let u=e.copy();o=ki.MaskFilter.MakeBlur(ki.BlurStyle.Normal,this._layerBlur*this.dpr*(((n=this.camera)==null?void 0:n.scale)??1),!1),u.setMaskFilter(o),t(u),u.delete(),o.delete(),l=!0}if(l||t(e),i&&this._hasInnerShadow()){let u=new ki.Paint;u.setAntiAlias(!0),u.setStyle(ki.PaintStyle.Fill),u.setColor(IS(this._innerShadowColor));let c;this._innerShadowBlur>0&&(c=ki.MaskFilter.MakeBlur(ki.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((s=this.camera)==null?void 0:s.scale)??1),!1),u.setMaskFilter(c));let h=this._currentPath.computeTightBounds(),[d,f,m,g]=h,y=m-d,x=g-f;this.ctx.save(),this.ctx.clipPath(this._currentPath,ki.ClipOp.Intersect,!0),this.ctx.saveLayer(u,h,null,ki.SaveLayerInitWithPrevious),(a=this.ctx)==null||a.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(ki.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+y+Math.abs(this._innerShadowOffsetX*2),2e3+x+Math.abs(this._innerShadowOffsetY*2)),u),u.setBlendMode(ki.BlendMode.Clear),this.ctx.drawPath(this._currentPath,u),this.ctx.restore(),this.ctx.restore(),u.delete(),c==null||c.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let i=this.ctx,r=this._currentPath;this._applyEffectsToPaint(e,n=>{let s=!1;!t&&this._strokeMode!=="center"&&(i.save(),i.clipPath(r,this._strokeMode==="outside"?ki.ClipOp.Difference:ki.ClipOp.Intersect,!0),s=!0),i.drawPath(r,n),s&&i.restore()},t)}}_hasDropShadow(){var e;return((e=this._dropShadowColor)==null?void 0:e.a)>0}_hasInnerShadow(){var e;return((e=this._innerShadowColor)==null?void 0:e.a)>0}path(e){var t;(t=this._currentPath)==null||t.addPath(ki.Path.MakeFromSVGString(e))}ellipse(e,t,i,r,n,s,a,o){var u;if(!m7([e,t,i,r])||!this._currentPath)return;if(i<0||r<0)throw Error("radii cannot be negative");let l=ki.XYWHRect(e-i,t-r,i*2,r*2);(u=this._currentPath)==null||u.addOval(l)}rect(e,t,i,r,n=0,s=0,a=0,o=0){var u,c;let l=ki.XYWHRect(e,t,i,r);if(m7(l))if(n===0&&s===0&&o===0&&a===0)(u=this._currentPath)==null||u.addRect(l);else{let h=ki.RRectXY(l,n,n);h[4]=h[5]=n,h[6]=h[7]=s,h[8]=h[9]=a,h[10]=h[11]=o,(c=this._currentPath)==null||c.addRRect(h)}}getHorizontalAlign(e){switch(e){case 2:return ki.TextAlign.Right;case 3:return ki.TextAlign.Center;case 4:return ki.TextAlign.Justify;case 1:default:return ki.TextAlign.Left}}drawTextInner(e,t,i,[r,n,s,a],o,l,u=!0){let c=0,{ctx:h}=this;if(!h)return c;let d=l.copy(),f=l.copy();return f.setAlphaf(0),this._applyEffectsToPaint(d,m=>{t.pushPaintStyle(i,m,f),t.addText(e);let g=t.build();g.layout(s);let y=n;o===2?y+=(a-g.getHeight())/2:o===3&&(y+=a-g.getHeight()),h.drawParagraph(g,r,y),c=g.getHeight(),t.reset(),g.delete()},u),d.delete(),f.delete(),c}drawText(e,t){let i=0,r=this._fonts.get(t.font),{ctx:n,_paintFill:s,_paintStroke:a}=this;if(r&&n){let o=new ki.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new ki.ParagraphStyle({textStyle:o,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),u=ki.XYWHRect(t.x,t.y,t.width,t.height),c=ki.ParagraphBuilder.Make(l,r);s&&(i=this.drawTextInner(e,c,o,u,t.verticalAlign,s,!0)),a&&(i=this.drawTextInner(e,c,o,u,t.verticalAlign,a,!1)),c.delete()}return{height:i}}render(){var e;(e=this._surface)==null||e.flush()}moveTo(e,t){var i;(i=this._currentPath)==null||i.moveTo(e,t)}lineTo(e,t){var i;(i=this._currentPath)==null||i.lineTo(e,t)}bezierCurveTo(e,t,i,r,n,s){var a;(a=this._currentPath)==null||a.cubicTo(e,t,i,r,n,s)}quadraticCurveTo(e,t,i,r){var n;(n=this._currentPath)==null||n.quadTo(e,t,i,r)}setTransform(e,t=!1){var n,s,a,o,l;if(!this.ctx)return;let i=this.ctx.getTotalMatrix(),r=Or.invert(i);if(r&&this.ctx.concat(r),(n=this.ctx)==null||n.scale(this.dpr,this.dpr),((s=this.camera)==null?void 0:s.enabled)&&((a=this.ctx)==null||a.concat(this.camera.worldMatrix),t)){let u=Or.getScale(this.camera.worldMatrix);(o=this.ctx)==null||o.scale(1/u[0],1/u[1])}(l=this.ctx)==null||l.concat(e),this.currentTransform=e}transform(e){var t;(t=this.ctx)==null||t.concat(e)}setSize(e,t){var i;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=ki.MakeWebGLCanvasSurface(this.canvas),this.ctx=(i=this._surface)==null?void 0:i.getCanvas()))}};function m7(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function IS({r:e,g:t,b:i,a:r}){return ki.Color4f(e,t,i,r)}var g7=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=Qr.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},v7=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},jHe=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=Qr.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},VHe=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=Qr.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},ya=class extends Ta{constructor(t,i,r){super(t,i,r),this.uuid=t,this.data=i,this.autoClose=!0,this.fill=new jHe(t+"-fill",i.fill,r),this.stroke=new VHe(t+"-stroke",i.stroke,r),this.dropShadow=new g7(t+"-dropShadow",i.dropShadow,r),this.innerShadow=new g7(t+"-innerShadow",i.innerShadow,r),this.backgroundBlur=new v7(t+"-backgroundBlur",i.backgroundBlur,r),this.layerBlur=new v7(t+"-layerBlur",i.layerBlur,r)}applyFillStroke(t){t.fillColor=this.fill.enabled?this.fill.color:Qr.transparent,t.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Qr.transparent,t.strokeMode=this.stroke.mode,t.lineWidth=this.stroke.thickness}applyFilters(t){this.layerBlur.enabled?t.layerBlur=this.layerBlur.radius*5:t.layerBlur=0,this.backgroundBlur.enabled?t.backgroundBlur=this.backgroundBlur.radius*5:t.backgroundBlur=0,this.dropShadow.enabled?(t.dropShadowBlur=this.dropShadow.blurRadius*5,t.dropShadowColor=this.dropShadow.color,t.dropShadowOffsetX=this.dropShadow.offset[0],t.dropShadowOffsetY=this.dropShadow.offset[1]):t.dropShadowColor=Qr.transparent,this.innerShadow.enabled?(t.innerShadowSpread=this.innerShadow.spread,t.innerShadowBlur=this.innerShadow.blurRadius*5,t.innerShadowColor=this.innerShadow.color,t.innerShadowOffsetX=this.innerShadow.offset[0],t.innerShadowOffsetY=this.innerShadow.offset[1]):t.innerShadowColor=Qr.transparent}innerDraw(t){}draw(t){!this.visible||(t.save(),this.applyTransforms(t),this.applyFilters(t),this.applyFillStroke(t),t.beginPath(),this.innerDraw(t),this.autoClose&&t.closePath(),this.fill.enabled&&t.fill(),this.stroke.enabled&&t.stroke(),t.restore())}updateByPatchedOp(t,i,r){super.updateByPatchedOp(t,i,r),t.type===0&&(sn(t.path,["fill"])?this.fill.update(t.props):sn(t.path,["stroke"])?this.stroke.update(t.props):sn(t.path,["dropShadow"])?this.dropShadow.update(t.props):sn(t.path,["innerShadow"])?this.innerShadow.update(t.props):sn(t.path,["layerBlur"])?this.layerBlur.update(t.props):sn(t.path,["backgroundBlur"])?this.backgroundBlur.update(t.props):this.resetBBoxNeedsUpdate())}updateState(t,i){super.updateState(t,i),t.fill!==void 0&&this.fill.update(t.fill),t.stroke!==void 0&&this.stroke.update(t.stroke),t.dropShadow!==void 0&&this.dropShadow.update(t.dropShadow),t.innerShadow!==void 0&&this.innerShadow.update(t.innerShadow),t.layerBlur!==void 0&&this.layerBlur.update(t.layerBlur),t.backgroundBlur!==void 0&&this.backgroundBlur.update(t.backgroundBlur)}clone(t){let i=new ya(this.uuid,this.data,t);return i.parent=void 0,i}},gz=class extends ya{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,i)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return NHe(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new gz(this.uuid,this.data,e);return t.parent=void 0,t}},dw=class extends ya{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,i)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new dw(this.uuid,this.data,e);return t.parent=void 0,t}},vz=class extends ya{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,i)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Qr.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Qr.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var s;(s=this._fontHolder)!=null&&s.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,i=this.data.text.textValue.toString(),r=t===2?i.toUpperCase():t===3?i.toLowerCase():i,{height:n}=e.drawText(r,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new vz(this.uuid,this.data,e);return t.parent=void 0,t}},are=class extends ya{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,i)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(r=>TA.extremas(r)),t=[1/0,1/0],i=[-1/0,-1/0];for(let r=0,n=e.length;r<n;r++){let s=e[r];s[0][0]<t[0]&&(t[0]=s[0][0]),s[0][1]<t[1]&&(t[1]=s[0][1]),s[1][0]>i[0]&&(i[0]=s[1][0]),s[1][1]>i[1]&&(i[1]=s[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[i[0],i[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let i=1,r=this.data.points.length;i<r;i++){let n=this.data.points[i].data,s=this.data.points[i-1].data,a={start:s.position,cp1:s.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(a)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let i={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(i)}}getCenter(){let[e,t]=this.extremasBBox.min,[i,r]=this.getHalfSize();return[e+i,t+r]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let r=0,n=this.data.points.length;r<n;r++){let s=this.data.points[r].data;if(r===0){let[a,o]=s.position;e.moveTo(a,o)}else{let a=this.data.points[r-1].data,[o,l]=a.controlNext.position,[u,c]=s.controlPrevious.position,[h,d]=s.position,f={start:a.position,cp1:a.controlNext.position,cp2:s.controlPrevious.position,end:s.position};TA.derive(f),e.bezierCurveTo(o,l,u,c,h,d)}}let t=this.data.points[0].data,i=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[r,n]=i.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(r,n,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new are(this.uuid,this.data,e);return t.parent=void 0,t}},TA;(e=>{function t(a){let o=a.start,l=a.cp1,u=a.cp2,c=a.end,h=[3*(l[0]-o[0]),3*(l[1]-o[1])],d=[3*(u[0]-l[0]),3*(u[1]-l[1])],f=[3*(c[0]-u[0]),3*(c[1]-u[1])],m={start:h,cp:d,end:f};return a.derivative=m,m.derivative=fN.derive(m),m}e.derive=t;function i(a,o,l,u=!1){let c=a-2*o+l;if(c!==0){let h=-Math.sqrt(Math.abs(o*o-a*l)),d=-a+o,f=-(h+d)/c,m=-(-h+d)/c;return[f,m]}else if(o!==l&&c===0)return[(2*o-l)/(2*(o-l))];return[]}function r(a){let o=a.derivative??e.derive(a),l=o.start,u=o.cp,c=o.end;return[i(l[0],u[0],c[0]),i(l[1],u[1],c[1])]}e.droot=r;function n(a){let[o,l]=e.droot(a),u=[a.start[0],a.end[0]],c=[a.start[1],a.end[1]];for(let h of o)u.push(e.compute(a,Math.min(1,Math.max(0,h)))[0]);for(let h of l)c.push(e.compute(a,Math.min(1,Math.max(0,h)))[1]);return u.sort((h,d)=>h-d),c.sort((h,d)=>h-d),[[u[0],c[0]],[u[u.length-1],c[c.length-1]]]}e.extremas=n;function s(a,o){if(o===0)return[...a.start];if(o===1)return[...a.end];let l=1-o,u=l*l,c=o*o,h=u*l,d=u*o*3,f=l*c*3,m=o*c;return[h*a.start[0]+d*a.cp1[0]+f*a.cp2[0]+m*a.end[0],h*a.start[1]+d*a.cp1[1]+f*a.cp2[1]+m*a.end[1]]}e.compute=s})(TA||(TA={}));var fN;(e=>{function t(n){let s=n.start,a=n.cp,o=n.end,l=[2*(a[0]-s[0]),2*(a[1]-s[1])],u=[2*(o[0]-a[0]),2*(o[1]-a[1])],c={start:l,end:u};return c.derivative=pN.derive(c),n.derivative=c,c}e.derive=t;function i(n){let s=n.derivative??e.derive(n),a=s.start,o=s.end;return[a[0]!==o[0]?a[0]/(a[0]-o[0]):0,a[1]!==o[1]?a[1]/(a[1]-o[1]):0]}e.droot=i;function r(n,s){if(s===0)return[...n.start];if(s===1)return[...n.end];let a=1-s,o=a*a,l=s*s,u=o,c=a*s*2,h=l;return[u*n.start[0]+c*n.cp[0]+h*n.end[0],u*n.start[1]+c*n.cp[1]+h*n.end[1]]}e.compute=r})(fN||(fN={}));var pN;(e=>{function t(r){let n=r.start,s=r.end,a=[s[0]-n[0],s[1]-n[1]];return r.derivative=a,r.derivative}e.derive=t;function i(r,n){if(n===0)return[...r.start];if(n===1)return[...r.end];let s=r.start,a=r.end;return[s[0]+(a[0]-s[0])*n,s[1]+(a[1]-s[1])*n]}e.compute=i})(pN||(pN={}));var Oh=class extends gc{constructor(e,t,i){super(e,t,i),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new dw(e+"-background",__.defaultData,i),this.background.parent=this,this.updateState(t,i)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),(e=this.background)==null||e.updateLocalMatrix()}updateWorldMatrix(e,t,i){var r;super.updateWorldMatrix(e,t,i),(r=this.background)==null||r.updateWorldMatrix(e,t,i)}draw(e){if(!this.visible)return;e.save();let t=this.width,i=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=i,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,i,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.type===0&&(sn(e.path,["fill"])?this.fill.update(e.props):sn(e.path,["stroke"])?this.stroke.update(e.props):sn(e.path,["dropShadow"])?this.dropShadow.update(e.props):sn(e.path,["innerShadow"])?this.innerShadow.update(e.props):sn(e.path,["layerBlur"])?this.layerBlur.update(e.props):sn(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new Oh(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}},HHe=nm(uJ(),1),HM=class extends ya{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,i),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new HM(this.uuid,this.data,e);return t.parent=void 0,t}};function WHe(e,t=1,i=1){if(t<=0||i<=0)return e;let r=(0,HHe.parseSVG)(e).map(n=>{let s={...n};return"x"in s&&(s.x=s.x*t),"y"in s&&(s.y=s.y*i),"x1"in s&&(s.x1=s.x1*t),"x2"in s&&(s.x2=s.x2*t),"y1"in s&&(s.y1=s.y1*i),"y2"in s&&(s.y2=s.y2*i),"rx"in s&&(s.rx=s.rx*t),"ry"in s&&(s.ry=s.ry*i),s});return GHe(r)}function GHe(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],i;return e.map(r=>{let n=[];t.forEach(a=>{if(a in r){let o=r[a]*1;n.length&&o>=0&&n.push(","),n.push(o)}});let s=(i===r.code?n[0]<0?"":",":r.code)+n.join("");return i=r.code,s}).join("")}function qHe(e,t,i){switch(t.type){case"ellipse2d":return new gz(e,t,i);case"rectangle2d":return new dw(e,t,i);case"text2d":return new vz(e,t,i);case"vector2d":return new are(e,t,i);case"path2d":return new HM(e,t,i);case"frame2d":return new Oh(e,t,i);case"group2d":default:return new $p(e,t,i)}}var ore=class{constructor(e,t,i){this.uuid=e,this.data=t,this.group=new $p(ore.GROUP_ID,{...mA.defaultData},i),this.createChildrenObjects(t.objects,this.group,i)}createObject(e,t,i,r,n,s){let a=qHe(e,t,s);a&&(r.add(a),r.children.splice(n,0,r.children.pop()),a.updateWorldMatrix(),i.length>0&&(a instanceof $p||a instanceof Oh)&&this.createChildrenObjects(i,a,s))}createChildrenObjects(e,t,i){let r=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,r,i),r+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,i,r){let n=this.find(e);if(n)try{n.updateByOp(t,i,{shared:r})}catch(s){console.error(s)}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let i=e.parent===null?this.group:this.find(e.parent);i!==void 0&&i instanceof gc&&(this.createObject(e.id,e.data,e.children,i,e.localIndex,t),i.requestRender())}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i!==void 0&&i.parent!==void 0&&i.parent instanceof gc){let r=i.parent;i.resetBBoxNeedsUpdate(),r==null||r.remove(i),r==null||r.requestRender()}}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i!==void 0){let r=i.parent,n=e.parent===null?this:this.find(e.parent);if(n instanceof gc||n===this){n.add(i);let s=e.localIndex;n.children.splice(s,0,n.children.pop()),i.updateWorldMatrix(!0,!1,!0),r==null||r.requestRender(),i.requestRender()}i.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,i,r=!1,n=[]){return this.group.intersectsChildren(e,t,i,r,n,!0)}intersectsChildrenReverse(e,t,i,r=!1,n=[]){return this.group.intersectsChildrenReverse(e,t,i,r,n,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let i=[],r=t;for(;r!==this.group;){let n=r;r=r.parent;let s=r.children.indexOf(n);i.splice(0,0,s)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let r=this.getWithSortKey(i.id);r!==void 0&&t.push(r)}return t.sort((i,r)=>jee(i.sortKey,r.sortKey)),t.map(i=>i.entity)}},yz=ore;yz.GROUP_ID="scene2d";function lre({constraints:e,newParentWidth:t,newParentHeight:i,initialParentWidth:r,initialParentHeight:n,objectInitialWidth:s,objectInitialHeight:a,objectInitialPosition:o}){let{horizontalConstraint:l,verticalConstraint:u}=e,c=t-r,h=i-n,d=s,f=a,m=o[0],g=o[1];if(l!==0){if(l===1)m+=c;else if(l===3)m+=c/2;else if(l===2)d=Math.max(1,d+c);else if(l===4){let y=t/r;d*=y,m*=y}}if(u!==0){if(u===1)g+=h;else if(u===3)g+=h/2;else if(u===2)f=Math.max(1,f+h);else if(u===4){let y=i/n;f*=y,g*=y}}return{width:d,height:f,position:[m,g]}}nm(uJ(),1);var YHe=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,XHe=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,KHe=new _M(-1,1,1,-1,0,1),$He=class extends ai{constructor(){super(),this.setAttribute("position",new Vt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Vt([0,2,0,0,2,0],2))}},ZHe=new $He,QHe=class{constructor(e){this._mesh=new dn(ZHe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,KHe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},ure=new Cr({defines:{},uniforms:{tDiffuse:new wt(null)},vertexShader:YHe,fragmentShader:XHe}),JHe=new QHe(ure),KI=null,$I=null,eWe=()=>(KI===null&&(KI=document.createElement("canvas")),KI),tWe=e=>($I===null&&($I=new sre(e)),$I),iWe=Or.identity(),cre=class{constructor(e,t,i,r){this.uuid=e,this.width=t,this.height=i,this.context=r,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let n=this.width,s=this.height,a=this.dpr;this.renderer.dpr=this.isScreenSpace?a:Math.floor(2048/Math.max(n,s)),this.renderer.setSize(n,s)},this.onFrameOverrideObjectEvent=n=>{var s,a;if(((s=n.target)==null?void 0:s.uuid)!==void 0){let o=(a=this.frameRoot)==null?void 0:a.find(n.target.uuid);o&&o.dispatchEvent({...n,target:o})}},this.scene2d=new yz(Xt.generateUUID(),BL.defaultData,{dpr:window.devicePixelRatio,shared:r.shared}),this.canvas=eWe(),this.renderer=tWe(this.canvas),this.promise=this.init(),this.renderTarget=new Tr(1,1,{type:lf,stencilBuffer:!1,depthBuffer:!1}),r.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=r.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new WDe(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof sre&&(this.renderer.wasmURL=Rie.skiaWasmUrl),await this.renderer.init()}render(e){var t,i;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(t=this.frameOverride)==null||t.draw(this.renderer),this.renderer.render(),ure.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let r=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),JHe.render(e),e.setRenderTarget(r),(i=this.textureHolder)==null||i.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,i,r){this.scene2d.updateEntityByOp(e,t,i,r),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=(e==null?void 0:e.width)??this.width,i=(e==null?void 0:e.height)??this.height;this.frameOverride.width=t,this.frameOverride.height=i,this.frameOverride.localMatrix=iWe,this.isScreenSpace&&(this.frameOverride.fill.color=Qr.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:i},hre({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e,t=window.devicePixelRatio){var o,l;let i=Math.max(1,(e==null?void 0:e.width)??this.width),r=Math.max(1,(e==null?void 0:e.height)??this.height);this.dpr=t,this.width=i,this.height=r,this._innerApplySize();let n=1,s=512,a=512;(i*t<s||r*t<a)&&(n=Math.max(s/(i*t),a/(r*t))),this.renderTarget.setSize(i*t*n,r*t*n),(o=this._canvasTexture)==null||o.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),(l=this.frameOverride)==null||l.requestRender()}applyFrame(e){var i,r;let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof Oh)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(i=this.frame)==null||i.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(n=>{n.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(n=>{n.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(r=this.frame)==null||r.requestRender(),t}get frame(){return this.frameOverride}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return(e=this.textureHolder)==null?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,i;(e=this.frameOverride)==null||e.removeEventListener("render",this.onRenderRequestedDownstream),(t=this.frameOverride)==null||t.traverse(r=>{r.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(i=this.frameOverride)==null||i.traverse(r=>{r.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function hre({objectOverride:e,objectRoot:t,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s}){if(e instanceof Oh&&t instanceof Oh||e instanceof $p&&t instanceof $p)for(let a=0,o=e.children.length;a<o;a++){let l=e.children[a],u=t.children[a];l&&u&&l.uuid===u.uuid&&nWe({objectOverride:l,objectRoot:u,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s})}}function rWe(e){if(mN(e))return[e.width,e.height];if(e instanceof HM){let[t,i]=e.getHalfSize();return[t*2,i*2]}else if(e instanceof $p){let[t,i]=e.recursiveBBox.getHalfSize();return[t*2,i*2]}return[0,0]}function nWe({objectOverride:e,objectRoot:t,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s}){let[a,o]=rWe(t),{width:l,height:u,position:c}=lre({constraints:e.data,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:t.position});if(e.position=c,e.data={...e.data,position:c},e.states)for(let h in e.states)sWe({stateId:h,objectOverride:e,objectRoot:t,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s});if(mN(e)||e instanceof $p)mN(e)&&(e.width=l,e.height=u,e.data={...e.data,width:l,height:u}),hre({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:u,initialParentWidth:a,initialParentHeight:o});else if(e instanceof HM){let h=t,d=a!==0?l/a:1,f=o!==0?u/o:1;e.path=WHe(h.path,d,f),e.data={...e.data,path:e.path}}}function sWe({stateId:e,objectOverride:t,objectRoot:i,newParentWidth:r,newParentHeight:n,initialParentWidth:s,initialParentHeight:a}){var u,c;let o=(u=t.states)==null?void 0:u[e],l=(c=i.states)==null?void 0:c[e];if(o&&l){let{width:h,height:d,position:f}=lre({constraints:t.data,newParentWidth:r,newParentHeight:n,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:Ng.isResizeable(l)?l.width:0,objectInitialHeight:Ng.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:f}),Ng.isResizeable(o)&&Object.assign(t.states[e],{width:h,height:d})}}function mN(e){return e instanceof dw||e instanceof Oh||e instanceof gz||e instanceof vz}var va=class extends XB(Ol){constructor(t,i,r){super(),this.data=i,this.bgColor=new Wa(1,1,1,1),this.fog=null,this.backupFog=new NJ(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new mi,this.penumbraSizeArrayCache=null,this.super_Entity(t,i),this.personalCamera=new go(m1,{...y_.defaultData,...i.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new DIe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),i.uiScene?this.uiScene=new yz((Array.isArray(t)?t[0]:t)+"-ui",i.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):i.uiFrame&&this.createUICanvas(i.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var t;return(t=this.uiCanvas)==null?void 0:t.frame}createUICanvas(t,i){this.uiCanvas=new cre(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,i),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var r,n;(r=this.uiCanvas)==null||r.applyFrame(t),(n=this.uiCanvas)==null||n.applySize()})}updateVisible(){}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(t,i){t.color!==void 0&&(this.ambientLight.color=Go(t.color,i)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.enabled!==void 0&&(t.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(t){this.isActive=!0,t.fog=this.fog,this.traverseEntity(i=>{i instanceof Qg&&i.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(t=>{if(t instanceof y1)if(Array.isArray(t.material))for(let i of t.material)i.needsUpdate=!0;else t.material.needsUpdate=!0,t.material.dispose()})}updateShadow(t){t.softShadowQuality!==void 0&&this.isActive&&wHe(t.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(t,i){if(t.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Go(t.color,i),this.backupFog.near=t.near,this.backupFog.far=t.far}updateAo(t,i){t.aoColor!==void 0&&(this.aoColor=Go(t.aoColor,i))}updateByOp(t,i,r,n){let s=this.data.uiFrame;super.updateByOp(t,i,r,n);let a=i;sn(t.path,["fog"])?this.updateFog(a.fog,r.shared):sn(t.path,["ao"])?this.updateAo(a.ao,r.shared):sn(t.path,["ambient"])?this.updateAmbientLight(a.ambient,r.shared):sn(t.path,["shadow"])?this.updateShadow(a.shadow):t.type===0&&t.path.length===0&&(t.props.uiFrame!==void 0||s!==a.uiFrame)&&this.updateUIFrame(t.props.uiFrame,r)}updateUIFrame(t,i){t?(this.uiCanvas||this.createUICanvas(t,i),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(t)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(t,i){this.updateState_Entity(t,i),t.backgroundColor!==void 0&&this.setBackgroundColor(Go(t.backgroundColor,i.shared)),t.fog!==void 0&&this.updateFog(t.fog,i.shared),t.ambient!==void 0&&this.updateAmbientLight(t.ambient,i.shared),t.ao!==void 0&&this.updateAo(t.ao,i.shared),t.shadow!==void 0&&this.updateShadow(t.shadow)}createFrame(t,i){}raycast(t,i){super.raycast(t,i)}switchActiveCamera(t){t&&t.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1)}get playCamera(){var t;return((t=this.scene)==null?void 0:t.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let t=0,i=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof tre&&r.visible&&t<3&&(this.penumbraSizeArrayCache[t]=r.data.penumbraSize??.5,t+=1),r instanceof ire&&r.visible&&t<2&&(this.penumbraSizeArrayCache[3+i]=r.data.penumbraSize??.5,i+=1)})}raycastWithClones(t){let i=[],r=n=>{for(let s of n.children){let a=s.cloner;wr.is(s)&&(s.visible||a!=null&&a.object.data.visible)&&((mc(s)||sN(s)&&this.scene.enableHelpers&&s.objectHelper.visible)&&(t.intersectObject(s,!1,i),gN(s,t,i,!0)),r(s))}};return r(this),i}updateEntity2DByOp(t,i,r,n){var s;(s=this.uiCanvas)==null||s.updateEntity2DByOp(t,i,r,n)}},aWe=class extends fz(LIe,Qie){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.fov=90,r.aspect=1,r.near=100,r.far=2500;let n=new q(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),s=new q(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z),a=new xs(n,s),o=new UC(a,new mi(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof UC){let i=this.shadow.camera,r=new q(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),n=new q(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);t.box.set(r,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},oWe=class extends Os{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?iz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},xz=class extends Os{constructor(e,t,i){super(e,t,i),this._shapeId=null,this._context=i}updateState(e,t){super.updateState(e,t),this.updateShape(),this.refreshAttachedCloners(t)}updateShape(){var r;let e={...this.data.geometry.extrusion.shape};for(let n in e)typeof e[n]=="string"&&(e[n]=this._context.shared.getVariable(e[n],[this.uuid,"geometry","extrusion","shape",n]));let t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let s=this._context.scene.find(n);s!=null&&s.data&&(s.attachedPaths.add(this),t=(r=s.geometry.userData)==null?void 0:r.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=tz;break;case"Ellipse":n=ez;break;case"Polygon":n=Kte;break;case"Star":n=$te;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let i=this.geometry;t&&i.inputs&&(i.inputs.shapeData=t,i.build())}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?iz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},bz=class extends dz{constructor(e,t,i){super(e,t,i),this.data=t}},gy=class extends x1(Xd,cw){constructor(e,t,i){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,i)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let i=hA.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(i){let r,n;for(let s of wp.rootOverrideProps)e[s]===void 0?(r===void 0&&(r={...e}),r[s]=i.data[s]):(n===void 0&&(n={}),n[s]=e[s],r===void 0&&(r={...e}),r[s]=Fp.apply(i.data[s],e[s]));return this.overrideData=n,r}else return{...Zs.defaultData,...e,...Dh(Zs.defaultData,wp.rootOverrideProps)}}updateByOp(e,t,i,r){let n;if(this.isInstanceRoot&&!r){if(t=this.transformAssignData(t,i),e.type===0&&e.path.length===0&&this.component)for(let s of wp.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&wp.rootOverrideProps.includes(e.path[0])){let s=e.path[0];n===void 0&&(n={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(n??e,t,i,r)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let i=e.scene.find(t.component)??null,r=!1;if(i!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(wr.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),_z(s),n+=1;else break;this.children.splice(0,n)}r=!0}if(i){let n={};dre(e,[this.uuid],t.overrides,this,i,i,0,r,n);for(let s of this.children)if(wr.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{let l=o.dataPatched;if(o instanceof Os&&l.bones&&l.boneInverses){let u=o.dataPatched;if(u.bones&&u.boneInverses){let c=u.bones.map(f=>e.scene.find(n[f])),h=u.boneInverses.map(f=>new Pt().fromArray(f)),d=new uB(c,h);o.bind(d,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function _z(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let i of e.children)wr.is(i)&&_z(i)}}function y7(e,t,i,r){return e.component===t&&NB(e.identity,r)?e.overrideData===i?2:1:0}function dre(e,t,i,r,n,s,a,o,l){if(a>50)return!1;if(r.component!==n){if(r.component){let c=r.component.instances.indexOf(r);c>=0&&r.component.instances.splice(c,1)}n.instances.find(c=>c===r)||n.instances.push(r),r.component=n}n instanceof gy&&n.isInstanceRoot&&n.expandInstanceChildren(e);let u=0;for(let c of n.children)if(wr.is(c)){let h=[...t,...typeof c.identity=="string"?[c.identity]:c.identity],d=oA.resolve(i,h,1);d!=null&&!(d instanceof Ls)&&(Object.setPrototypeOf(d,Ls.prototype),console.error("wrong prototype"));let f=null,m;if(!o){let g=r.children[u];if(f=wr.is(g)?g:null,f!==null){let y=y7(f,c,d,h);m=y>=1?f.stateSelection:void 0,y!==2&&(f=null)}if(f===null&&(f=e.scene.findInstance(h)??null,f!==null)){let y=y7(f,c,d,h);if(m=y>=1?f.stateSelection:void 0,y!==2)f=null;else{let x=f.parent.children.indexOf(f);f.parent.children.splice(x,1),r.children.splice(u,0,f),f.parent===r?x<=u&&console.error("not possible"):(f.parent=r,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),e.pendingDeletes.delete(f))}}}if(f===null){let g=d?Fp.apply(c.data,d):c.data;Kg.is(g.type)&&(g={...g,type:"Empty"}),f=Sp.createEntity(h,g,e),f.overrideData=d,r.add(f),r.children.splice(r.children.length-1,1),r.children.splice(u,0,f),f.updateState(f.data,e),m&&f.changeSelectedState(m,e),e.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let g=f.identity[f.identity.length-1];l[g]=f.uuid}u+=1,dre(e,t,i,f,c,s,a+1,o,l)}if(!o){let c=u;for(;;){let h=r.children[u];if(wr.is(h))e.pendingDeletes.add(h);else break;u+=1}r.children.splice(c,u-c)}return!0}var lWe=class extends x1(kJ,cw){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},fo=class extends Os{constructor(t,i,r){super(t,i,r),this.onBeforeRender=n=>{this.uiCanvas.render(n)},this.uiCanvas=new cre(t+"-canvas",i.geometry.width,i.geometry.height,r),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)})}updateByPatchedOpGeometry(t,i,r){super.updateByPatchedOpGeometry(t,i,r),t.type===0&&(t.props.frame!==void 0&&this.applyFrame(t.props.frame,r.shared),(t.props.width!==void 0||t.props.height!==void 0)&&this.applySize(t.props,r.shared))}applySize(t,i){let r=(t==null?void 0:t.width)??this.dataPatched.geometry.width,n=(t==null?void 0:t.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:n}),this.applyGeometryParametersFromFrame(i)}applyFrame(t,i){this.uiCanvas.applyFrame(t),this.applyGeometryParametersFromFrame(i),this.applyMaterialParametersFromFrame({shared:i})}applyGeometryParametersFromFrame(t){var r;let i=this.frame;i&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:i.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:i.cornerRadius,cornerType:0})}),(r=this.localGeometry)==null||r.dispose(),this.localGeometry=T_(this.dataPatched.geometry,t,this.data.flatShading,this))}applyMaterialParametersFromFrame(t){let i=this.frame;if(i){let r=i.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,t,!0)}}updateEntity2DByOp(t,i,r,n){this.uiCanvas.updateEntity2DByOp(t,i,r,n),t===this.frameId&&i.type===0&&(i.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(n):sn(i.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:n}))}get frame(){return this.uiCanvas.frame}get frameId(){var t;return(t=this.frame)==null?void 0:t.uuid}removeInteractionGeometry(t){super.removeInteractionGeometry(t),this.applySize({},t)}updateGeometryInteractions(t,i){super.updateGeometryInteractions(t,i),this.applySize({width:t.width,height:t.height},i)}},uWe=class{constructor(e,t,i){this.variables=[],this.currentTextureIndex=0;let r=$r,n=new Ol,s=new sm;s.position.z=1;let a={passThruTexture:{value:null}},o=c(d(),a),l=new dn(new Nh(2,2),o);n.add(l),this.setDataType=function(f){return r=f,this},this.addVariable=function(f,m,g){let y=this.createShaderMaterial(m),x={name:f,initialValueTexture:g,material:y,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:ur,magFilter:ur};return this.variables.push(x),x},this.setVariableDependencies=function(f,m){f.dependencies=m},this.init=function(){if(i.capabilities.isWebGL2===!1&&i.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(i.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let f=0;f<this.variables.length;f++){let m=this.variables[f];m.renderTargets[0]=this.createRenderTarget(e,t,m.wrapS,m.wrapT,m.minFilter,m.magFilter),m.renderTargets[1]=this.createRenderTarget(e,t,m.wrapS,m.wrapT,m.minFilter,m.magFilter),this.renderTexture(m.initialValueTexture,m.renderTargets[0]),this.renderTexture(m.initialValueTexture,m.renderTargets[1]);let g=m.material,y=g.uniforms;if(m.dependencies!==null)for(let x=0;x<m.dependencies.length;x++){let w=m.dependencies[x];if(w.name!==m.name){let b=!1;for(let C=0;C<this.variables.length;C++)if(w.name===this.variables[C].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+m.name+", dependency="+w.name}y[w.name]={value:null},g.fragmentShader=`
uniform sampler2D `+w.name+`;
`+g.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let f=this.currentTextureIndex,m=this.currentTextureIndex===0?1:0;for(let g=0,y=this.variables.length;g<y;g++){let x=this.variables[g];if(x.dependencies!==null){let w=x.material.uniforms;for(let b=0,C=x.dependencies.length;b<C;b++){let A=x.dependencies[b];w[A.name].value=A.renderTargets[f].texture}}this.doRenderTarget(x.material,x.renderTargets[m])}this.currentTextureIndex=m},this.getCurrentRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let f=this.variables;for(let m=0;m<f.length;m++){let g=f[m];g.initialValueTexture&&g.initialValueTexture.dispose();let y=g.renderTargets;for(let x=0;x<y.length;x++)y[x].dispose()}};function u(f){f.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=u;function c(f,m){m=m||{};let g=new Cr({uniforms:m,vertexShader:h(),fragmentShader:f});return u(g),g}this.createShaderMaterial=c,this.createRenderTarget=function(f,m,g,y,x,w){return f=f||e,m=m||t,g=g||Mn,y=y||Mn,x=x||ur,w=w||ur,new Tr(f,m,{wrapS:g,wrapT:y,minFilter:x,magFilter:w,format:On,type:r,depthBuffer:!1})},this.createTexture=function(){let f=new Float32Array(e*t*4),m=new Wo(f,e,t,On,$r);return m.needsUpdate=!0,m},this.renderTexture=function(f,m){a.passThruTexture.value=f,this.doRenderTarget(o,m),a.passThruTexture.value=null},this.doRenderTarget=function(f,m){let g=i.getRenderTarget(),y=i.xr.enabled,x=i.shadowMap.autoUpdate,w=i.outputEncoding,b=i.toneMapping;i.xr.enabled=!1,i.shadowMap.autoUpdate=!1,i.outputEncoding=Pc,i.toneMapping=Ph,l.material=f,i.setRenderTarget(m),i.render(n,s),l.material=o,i.xr.enabled=y,i.shadowMap.autoUpdate=x,i.outputEncoding=w,i.toneMapping=b,i.setRenderTarget(g)};function h(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function d(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},Ia=new Fa,OS=new q,cWe=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,i=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let s=1;t&&(s=t.getX(n)+t.getX(n+1)+t.getX(n+2)),Ia.a.fromBufferAttribute(e,n),Ia.b.fromBufferAttribute(e,n+1),Ia.c.fromBufferAttribute(e,n+2),s*=Ia.getArea(),i[n/3]=s}this.distribution=new Float32Array(e.count/3);let r=0;for(let n=0;n<i.length;n++)r+=i[n],this.distribution[n]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,i){let r=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*r);return this.sampleFace(n,e,t,i)}binarySearch(e){let t=this.distribution,i=0,r=t.length-1,n=-1;for(;i<=r;){let s=Math.ceil((i+r)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?r=s-1:i=s+1}return n}sampleFace(e,t,i,r){let n=this.randomFunction(),s=this.randomFunction();return n+s>1&&(n=1-n,s=1-s),Ia.a.fromBufferAttribute(this.positionAttribute,e*3),Ia.b.fromBufferAttribute(this.positionAttribute,e*3+1),Ia.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(Ia.a,n).addScaledVector(Ia.b,s).addScaledVector(Ia.c,1-(n+s)),i!==void 0&&Ia.getNormal(i),r!==void 0&&this.colorAttribute!==void 0&&(Ia.a.fromBufferAttribute(this.colorAttribute,e*3),Ia.b.fromBufferAttribute(this.colorAttribute,e*3+1),Ia.c.fromBufferAttribute(this.colorAttribute,e*3+2),OS.set(0,0,0).addScaledVector(Ia.a,n).addScaledVector(Ia.b,s).addScaledVector(Ia.c,1-(n+s)),r.r=OS.x,r.g=OS.y,r.b=OS.z),this}};function hWe(e){let t=new Float32Array(e*e*2);for(let i=0;i<e;i++)for(let r=0;r<e;r++){let n=i*e+r;t[n*2+0]=i/(e-1),t[n*2+1]=r/(e-1)}return t}function dWe(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function fWe(e,t){let i=new dn(e.geometry,e.material),r=[],n=[],s=new q,a=new q;i.geometry.index!==null&&(i.geometry=i.geometry.toNonIndexed());let o=new cWe(i).build();for(let c=0;c<t;c++)o.sample(s,a),r.push(s.x,s.y,s.z),n.push(a.x,a.y,a.z);let l=new Float32Array(r),u=new Float32Array(n);return{positions:l,normals:u}}function x7(e,t){let i=e,r=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)r[4*s]=i[3*s],r[4*s+1]=i[3*s+1],r[4*s+2]=i[3*s+2],r[4*s+3]=0;let n=new Wo(r,t,t,On,$r);return n.needsUpdate=!0,n}function pWe({size:e}){let t=new Float32Array(4*e*e);for(let r=0;r<e*e;r++)t[4*r]=r,t[4*r+1]=0,t[4*r+2]=0,t[4*r+3]=0;let i=new Wo(t,e,e,On,$r);return i.needsUpdate=!0,i}function mWe(e){let t=new Float32Array(4*e*e);for(let r=0;r<e*e;r++)t[4*r]=0,t[4*r+1]=0,t[4*r+2]=0,t[4*r+3]=0;let i=new Wo(t,e,e,On,$r);return i.needsUpdate=!0,i}var gWe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,vWe=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,yWe=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,xWe=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,bWe=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,_We=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+vWe+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${yWe}
      // ATTRACTION
      ${xWe}  
      // VORTEX
      ${bWe}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,fre=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,wWe=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,EWe=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,SWe=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${wWe}
  ${fre}
`,TWe=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,CWe=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+fre+`  
  ${EWe}

`,AWe=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,MWe=class extends Cr{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],Xs.startContext(Xs.globalContext),this.lightLayer=new uh(0,"",{...ma.defaultData("light","phong"),visible:!1},new az,{},t.shared),Xs.endContext(Xs.globalContext),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new hie;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(sje),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(aje),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(SWe),e.addFragmentParsCode(CWe),e.addVertexFinalCode(TWe({easeSize:this.easeSize})),e.addFragmentFinalCode(AWe({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},ZI=class{constructor(e,t,i,r){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=i,this.textureSize=dWe(t);let n=1;this.targetMesh=(r==null?void 0:r.type)==="Mesh"&&r?r:this.getMesh(i,n);let{positions:s,dataTexture:a,dataTextureNormals:o}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(i,n));this.positionsTexture=a,this.positionsAttribute=s,this.directionsTexture=o}createPositions(e,t){let{positions:i,normals:r}=fWe(t,e*e),n=x7(i,e),s=x7(r,e);return{dataTexture:n,positions:i,dataTextureNormals:s}}getMesh(e,t){let i=null;switch(e){case"SphereEmitterShape":{i=new ay(t*.5,32,32);break}case"TorusEmitterShape":{i=new qJ(t*.5,.3,15,40);break}case"ConeEmitterShape":{i=new fB(t,t,15);break}case"BoxEmitterShape":{i=new Dc(t,t,t);break}case"PlaneEmitterShape":{i=new Nh(t,t),i.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{i=new ay(t,32,32);break}default:{i=new ay(t,32,32);break}}return new dn(i,new uf({color:16711680}))}applyToShader(e,t){this.size=new q().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function _0(e){let t={...e},i=tA.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let r={...i.shape,...t.shape},n={...i.renderMaterial,...t.renderMaterial};return{...i,...t,shape:r,renderMaterial:n}}var PWe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,QI=10,DWe=class extends qr{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new PIe,this.currentWorldPosition=new q,this.systemQuaternion=new Si,this.worldGravity=new q(0,0,0),this.directionAxis=new q(0,0,0),this.colliderV3=new q(0,0,0),this.colliderQuaternion=new Si(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let i=t.data;this.material=new MWe(i.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:i.renderMaterial.color},uColor2:{value:i.renderMaterial.color2},uPosition:{value:new q(0,0,0)},uEmissionData:{value:new q(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new q(0,0,0)},uWorldQuaternion:{value:new Pi(0,0,0,1)},uRandScaleFactor:{value:i.randomScale??0},uRandRotationFactor:{value:i.randomRotation??0},uRotation:{value:i.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:i.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,i.renderMaterial.texture),this.init(i)}setTexture(e,t){let i=t.data;if(typeof t=="string"){let r=this.shared.image(t),n=new jn(r.img);n.needsUpdate=!0,e.uTexture.value=n;return}if(typeof i!="string"){let r=new Image;r.onload=()=>{let a=new jn(r);a.needsUpdate=!0,e.uTexture.value=a};let n=new Blob([i],{type:"image/*"}),s=URL.createObjectURL(n);r.src=s}}updateGeometryAttributes(e,t){var r;let i=hWe(t);!((r=this.emitterShape)!=null&&r.positionsAttribute)||e.geometry.setAttribute("ref",new o_(i,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var a;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let i=1e3/t,r=this.targetFPS/i,n=this.previousRatio+(r-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let s=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=s,this.material.uniforms.uPosition.value=(a=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:a.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(_0({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let i=e.data.size;this.colliderV3.fromArray(i),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let i=(r,n)=>{let s=[...this.system.data.shape.size];s[r]=n,this.updateParticleState({shape:{...this.system.data.shape,size:s}})};t[2]==="shape_size_0"&&i(0,e),t[2]==="shape_size_1"&&i(1,e),t[2]==="shape_size_2"&&i(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/QI),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){var t,i,r;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(_0(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/QI),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),((t=e.renderMaterial)==null?void 0:t.size)!==void 0){let n=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(n)}if(((i=e.renderMaterial)==null?void 0:i.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let n=e.shape.size??this.system.data.shape.size,s=[Number(this.shared.getVariable(n[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(n[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(n[2],[this.uuid,"particles","shape_size_2"]))],a={..._0(this.system.data).shape,size:s};(r=this.emitterShape)==null||r.applyToShader(this.positionSimRT.material.uniforms,a)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let n=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(n),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*Xt.DEG2RAD,Number(e[1])*Xt.DEG2RAD,Number(e[2])*Xt.DEG2RAD],i=new Ks(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(i).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:i,colliderEntityId:r,shape:n,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:u}=e;return t!==void 0||i!==void 0||r||r===null||a!==void 0||n!==void 0||o!==void 0||s!==void 0||l!==void 0||u!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let i=new uWe(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),r=this.updateSimulationDefinition(e),n=i.addVariable("uCurrentPosition",r+gWe,this.emitterShape.positionsTexture),s=i.addVariable("uCurrentVelocity",r+_We,this.emitterShape.directionsTexture),a=i.addVariable("uCurrentEmissionRate",PWe,mWe(this.emitterShape.textureSize));i.setVariableDependencies(n,[n,s,a]),i.setVariableDependencies(s,[n,s,a]),i.setVariableDependencies(a,[n,s,a]);let o=pWe({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new q(0,0,0)},uWorldQuaternion:{value:new Pi(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new q(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let u=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(u),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let c=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),h={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Pi(0,0,0,1)},uColliderPos:{value:new q(0,0,0)},uColliderSize:{value:new q(0,0,0)},uForceIntensity:{value:c?c.forceIntensity:0},uForceDamping:{value:c?c.forceDambing:0},uColliderQuaternion:{value:new Pi(0,0,0,1)},uColliderQuaternionInvert:{value:new Pi(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/QI}};s.material.uniforms=h;let d={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=d;let f=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],m={..._0(this.system.data).shape,size:f};this.emitterShape.applyToShader(n.material.uniforms,m),i.init(),this.gpuCompute=i,this.positionSimRT=n,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),i=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),r=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,i,r]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let i=this.system.getColliderData(e.colliderEntityId);switch(i==null?void 0:i.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let r=i==null?void 0:i.colliderType;r==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),r==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(i==null?void 0:i.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[i,r]of Object.entries(this.simFeaturesDefinition))r&&(t+=`#define ${i}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let i=new q(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let r=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===e.fromMeshId&&(r=n)}),r?new ZI(i,t,e.type,r):new ZI(i,t,"SphereEmitterShape")}else return new ZI(i,t,e.type)}createPrimaryEmitter(e){let t,i=e*e;return t=new VDe(new Nh(1,1,1),this.material,i),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:i=0}){return Math.ceil(e*(t+i))}dispose(){var e,t,i;!this.gpuCompute||((t=(e=this.rootObject)==null?void 0:e.parent)==null||t.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(i=this.emitterShape)==null||i.dispose())}GoEmitSomeParticles(e,t){let i=e-this.lastEmitTime,r=1/t;if(i>=r){let n=Math.max(1,Math.floor(i/r));return this.lastEmitTime=e,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(_0(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},Tb=class extends Ko{constructor(e,t,i){super(e,t),this.type="ParticleSystem",this.geometry=new ai,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=r=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(r))},this.context=i,this.data={...t,..._0(t)},this.geometry.setAttribute("position",new Vt([],3)),this.material=new uf({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new DWe(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let i=this.actualTime/1e3;this.emitter.update(i,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(i=>i.identity===e);return t?t.data:null}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),sn(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...xa.drop(e,1).props}}),sn(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...xa.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){var t;if(this.currentLoopTime=0,e){this.timeoutId=window.setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(t=this.emitter)==null||t.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,(e=this.emitter)==null||e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,(e=this.emitter)==null||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function IWe(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}var JI=IWe();function OWe(e,t,i){var n;JI!==void 0&&(((n=t==null?void 0:t.geometry)==null?void 0:n.subdivisions)??0)>JI&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=JI);let r;return t.geometry.type==="TextGeometry"?new dz(e,t,i):t.geometry.type==="InputGeometry"?new bz(e,t,i):(t.geometry.type==="SubdivGeometry"?r=new C_(e,t,i):t.geometry.type==="PathGeometry"?r=new xz(e,t,i):t.geometry.type==="VectorGeometry"?r=new oWe(e,t,i):t.geometry.type==="BooleanGeometry"?r=new Qg(e,t,i):t.geometry.type==="ShapeBlendGeometry"?r=new Jg(e,t,i):t.geometry.type==="UIGeometry"?r=new fo(e,t,i):r=new Os(e,t,i),r)}function wz(e,t,i){return console.assert(t.type!==void 0),t.type==="Mesh"?OWe(e,t,i):t.type==="Empty"?new my(e,t):t.type==="Particle"?new Tb(e,t,i):t.type==="ParticleCollider"?new Sb(e,t,i):t.type==="Splat"?new my(e,t):t.type==="Bone"?new lWe(e,t):t.type==="Page"?new va(e,t,i):t.type==="PointLight"?new aWe(e,t,i):t.type==="SpotLight"?new ire(e,t,i):t.type==="DirectionalLight"?new tre(e,t,i):t.type==="Component"||t.type==="Instance"?new gy(e,t,i):Kg.is(t.type)?new go(e,t):(console.error(t),new my(e,t))}Sp.createEntity=wz;function RWe(e,t,i){let r=wz(e.identity,t,i),n=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,u=e.overrideData,c=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(r));for(let d of Object.keys(r))e[d]=r[d];e.children=[...e.children,...n],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=c,e.overrideData=u,e.updateState(e.data,i),h&&e.changeSelectedState(h,i),e.resetBBoxNeedsUpdate()}Sp.changeEntityProptotype=RWe;Sp.Cloner=Nu;function LWe(e,t,i,r){e.updateByOp(t,i,r,!1)}var dg=5,Cb=new ai;Cb.setAttribute("position",new gi(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var DT=class extends xIe{constructor(e){super({...e,depthTest:!1,depthWrite:!1,glslVersion:R3,vertexShader:`
				precision highp float;
				in vec3 position;
				void main() {
					gl_Position = vec4(position, 1);
				}
			`})}customProgramCacheKey(){return""}};function NWe(){return{shapeInput:()=>`
			const float posRowCoord = ${.5/dg};  // vec4: px py pz opType
			const float quatRowCoord = ${1.5/dg};  // vec4: qx qy qz qw
			const float param1RowCoord = ${2.5/dg};// vec4: type param1 param2 param3
			const float param2RowCoord = ${3.5/dg};// vec4: blendRange roundness scale param4
			const float colorRowCoord = ${4.5/dg}; // vec4: r g b a
			uniform sampler2D shapesDataTexture;
			vec4 shapePos(float iin) { 
				vec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));
				return r;
			}
			vec4 shapeQuat(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));
				return r;
			}
			vec4 shapeParams1(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));
				return r;
			}
			vec4 shapeParams2(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));
				return r;
			}
			vec4 shapeColor(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));
				return r;
			}
		`,getxyzi:`
			// this code must complement lookup
			float xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);
			float yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);
			float zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;
		`,lookup:`
			uniform sampler2D potentialPassTexture;
			uniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)
			
			// box or marching cube lookup value in value texture, integer box coord inputs
			// this code must complement codebits.getxyzi
			vec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc
				vec2 uv = vec2(
					mod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,
					floor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION
				); 
				uv /= Z_LAYERS_PER_ROW;
				return texture(rt, uv);
			}
		`,getpart:`
			float getpart(inout float a, float b) {
				float t = floor(a/b);
				float r = a - t*b;
				a = t;
				return r;
			}
		`,triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])}}var IT=new sm,kWe=class{constructor(){this.pyramidPassScene=new Ol,this.pyramidPassMaterial=new DT({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);let e=`
			precision highp float;
			precision highp sampler2D;
			layout(location = 0) out vec4 pc_FragColor;
			uniform sampler2D inputTexture;
			uniform float inputWidth;
			uniform float inputHeight;
			uniform float inputShiftX;
			uniform float outputShiftX;
			const vec2 half_unit_coord = vec2(0.5);
			const vec4 one = vec4(1.0);
			void main() {
				vec2 inputSize = vec2(inputWidth, inputHeight);
				vec2 input_pixel_uv = 1. / inputSize;
				vec2 coord = gl_FragCoord.xy - half_unit_coord;
				coord.x -= outputShiftX;
				coord = coord * 2. + half_unit_coord;
				coord.x += inputShiftX;

				// sample bottom left corner
				vec2 input_uv = coord / inputSize;
				float bl = texture(inputTexture, input_uv).r;

				// sample bottom right corner
				input_uv.x += input_pixel_uv.x;
				float br = texture(inputTexture, input_uv).r;

				// sample top right corner
				input_uv.y += input_pixel_uv.y;
				float tr = texture(inputTexture, input_uv).r;

				// sample top left corner
				input_uv.x -= input_pixel_uv.x;
				float tl = texture(inputTexture, input_uv).r;

				pc_FragColor.a = bl;
				pc_FragColor.b = pc_FragColor.a + br;
				pc_FragColor.g = pc_FragColor.b + tr;
				pc_FragColor.r = pc_FragColor.g + tl; 
			}
		`;this.pyramidPassMaterial.fragmentShader=e,this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let t=new dn(Cb,this.pyramidPassMaterial);t.frustumCulled=!1,this.pyramidPassScene.add(t)}renderPyramid(e,t,i,r,n){new yB().min.setScalar(0);let s=t.length-1,a=new Pi;i.getViewport(a),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let o=s-1;for(let u=o;u>=0;u--){let c=u%2===o%2?n[0]:n[1],h=u===o?r:u%2===o%2?n[1]:n[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(h.texture)?h.texture[1]:h.texture,this.pyramidPassUniforms.inputWidth.value=h.width,this.pyramidPassUniforms.inputHeight.value=h.height,i.setRenderTarget(c);let d=t[u],f=i.getPixelRatio();i.setViewport(this.pyramidPassUniforms.outputShiftX.value/f,0,d/f,d/f),u===2&&e%2!==0&&i.setViewport(this.pyramidPassUniforms.outputShiftX.value/f,0,3/f,3/f),i.render(this.pyramidPassScene,IT);let m=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=m,u<o&&(this.pyramidPassUniforms.outputShiftX.value+=t[u+1])}i.setViewport(a);let l=t.length%2===0?0:1;return i.readRenderTargetPixelsAsync(n[l],n[l].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then(()=>this.pyramidTopLevelReadPixelBuffer[0])}},sc=24,La=96,Qc=NWe(),Ed=2,pre=class extends Os{constructor(e,t,i){super(e,t,i),this.data=t,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new Ol,this.potentialPassScene=new Ol,this.voxelPassScene=new Ol,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new ai,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new dn(Cb,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let r=new Wo(Qc.triTable,16,256,xT,$r);r.needsUpdate=!0;let n=new Wo(Qc.numTrisTable,256,1,xT,$r);n.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:n}},this.voxelMesh=new dn(Cb,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new dn(Cb,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:r},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=s=>{if(jWe.call(this),this.npart===0){this.geometry.drawRange.count=0;return}let a=this.material.root;if(!a.shadersPatchedForShapeBlend)this.patchVertexShaderForShapeBlend(a),a.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;else if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new Cr({vertexShader:a.vertexShader,fragmentShader:`
						#include <packing>
						void main()
						{
							gl_FragColor = packDepthToRGBA(gl_FragCoord.z);
						}
					`,uniforms:a.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new Cr({vertexShader:a.vertexShader,fragmentShader:`
					#include <common>
					#include <packing>
					uniform vec3 referencePosition;
					uniform float nearDistance;
					uniform float farDistance;
					// World-space position
					varying vec3 vWPosition;
					void main()
					{
						float dist = length(vWPosition - referencePosition);
						dist = (dist - nearDistance) / (farDistance - nearDistance);
						dist = saturate(dist);
						// Required by Three.js for this to work
						gl_FragColor = packDepthToRGBA( dist );
					}`,uniforms:{nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new q},opacity:{value:0},...a.uniforms},defines:this.material.defines});let u=this.customDistanceMaterial;u.referencePosition=new q,u.nearDistance=0,u.farDistance=0,u.opacity=1,u.isMeshDistanceMaterial=!0}if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let u=this.pyramidLevelSizes.length%2===0?0:1,c=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[u].texture,this.marchPassUniforms.pyramidTexture2Size.value=new Ie(this.pyramidRenderTarget[u].width,this.pyramidRenderTarget[u].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[c].texture,this.marchPassUniforms.pyramidTexture1Size.value=new Ie(this.pyramidRenderTarget[c].width,this.pyramidRenderTarget[c].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let o=s.shadowMap.enabled;s.shadowMap.enabled=!1;let l=s.getRenderTarget();s.setRenderTarget(this.spatialPassRenderTarget),s.render(this.spatialscene,IT),s.setRenderTarget(this.potentialPassRenderTarget),s.render(this.potentialPassScene,IT),s.setRenderTarget(this.voxelPassRenderTarget),s.render(this.voxelPassScene,IT),pre.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,s,this.voxelPassRenderTarget,this.pyramidRenderTarget).then(u=>{this.material.wireframe&&(u*3>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new ai,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new gi(new Float32Array(u*3*2),3)),(u*3>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=Math.floor(u*1.2)*3),this.drawRangeNeedsForceUpdate=!1}),s.shadowMap.enabled=o,s.setRenderTarget(l)}}set npart(e){e!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=e,this.spatialn=Math.ceil(e/(4*sc)))}get npart(){return this._npart}set resolutionLevel(e){let t=Math.min(8,Math.max(5,e));if(t!==this._resolutionLevel){switch(this._resolutionLevel=t,this.resolution=Math.pow(2,t),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=31*8*Ed,this.bboxOffset=8*Ed*-1/2;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=63*4*Ed,this.bboxOffset=4*Ed*-1/2;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=127*2*Ed,this.bboxOffset=2*Ed*-1/2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=255*Ed,this.bboxOffset=Ed*-1/2;break}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let i=this.pyramidLevelSizes.length-2;i>=0;i--)(this.pyramidLevelSizes.length-2)%2===i%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[i]:this.pyramidTexture2Width+=this.pyramidLevelSizes[i];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let e=this._spatialPassRenderTargets[this.resolutionLevel];return e||(e=new Tr(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:On,type:$r,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:ur,magFilter:ur}),this._spatialPassRenderTargets[this.resolutionLevel]=e),e}get potentialPassRenderTarget(){let e=this._potentialPassRenderTargets[this.resolutionLevel];return e||(e=new Tr(this.basePyramidSize,this.basePyramidSize,{format:On,type:$r,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:ur,magFilter:ur}),this._potentialPassRenderTargets[this.resolutionLevel]=e),e}get voxelPassRenderTarget(){let e=this._voxelPassRenderTargets[this.resolutionLevel];return e||(e=new TJ(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:ur,magFilter:ur}),e.texture[0].format=On,e.texture[0].type=$r,e.texture[1].format=xT,e.texture[1].type=$r,this._voxelPassRenderTargets[this.resolutionLevel]=e),e}get pyramidRenderTarget(){let e=this._pyramidRenderTargets[this.resolutionLevel];if(!e){let t=new Tr(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:On,type:$r,stencilBuffer:!1,depthBuffer:!1,magFilter:ur,minFilter:ur}),i=new Tr(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:On,type:$r,stencilBuffer:!1,depthBuffer:!1,magFilter:ur,minFilter:ur});e=[t,i],this._pyramidRenderTargets[this.resolutionLevel]=e}return e}updateState(e,t){let i=this.material;super.updateState(e,t),i!==this.material&&(this.needsRebuild=!0),e.geometry&&(this.resolutionLevel=e.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),e.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new gi(new Float32Array(this.geometry.drawRange.count*3),3)):!e.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let e=`
			precision highp float;
			out vec4 pc_FragColor;
			const float spatialDivisions = ${this.spatialDivisions}.;
			uniform float span;
			uniform float npart;
			uniform float spatialn;
			${Qc.shapeInput()}

			vec3 low, high;     // range of current div; subset of -1 .. 1 with span border

			// lookup one element/channel's worth of spheres for current division
			// stating with low sphere number lowi
			// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)
			float spatialKey(float lowi) {
				float t = 0.;
				for (float ii = ${sc-1}.; ii >= 0.; ii--) {
					float i = ii + lowi;
					float iin = (i + 0.5) / ${La}.;
					vec4 shape = shapePos(iin);
					vec3 d = shape.xyz;
					float op = shape.w;
	
					t *= 2.;
					t += (
						low.x < d.x && d.x < high.x &&
						low.y < d.y && d.y < high.y &&
						low.z < d.z && d.z < high.z &&
						i < npart || op == -2. // always include if op is -2, which is the intersection operation
					) ? 1. : 0.;
				}
				return t;
			}

			${Qc.getpart}

			void main() {               // spatialial fragment shader
				// find active div
				vec3 div;                               // which div is current
				// out holds x=> x, lowi faster moving and y=> z, y faster moving
				float yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving
				div.y = getpart(yz, spatialDivisions);
				div.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart

				float lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving
				float lowi = getpart(lx, spatialn) * ${4*sc}.;
				div.x = lx;

				low = div / spatialDivisions * 2. - 1. - span;
				high = (div+1.) / spatialDivisions * 2. - 1. + span;

				// find active range of spheres
				pc_FragColor.x = spatialKey(lowi);
				pc_FragColor.y = spatialKey(lowi+${sc}.);
				pc_FragColor.z = spatialKey(lowi+${2*sc}.);
				pc_FragColor.w = spatialKey(lowi+${3*sc}.);
			}
		`;return new DT({name:"Spatial Pass",fragmentShader:e,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let e=`
			precision highp float;
			out vec4 pc_FragColor;

			${Qc.shapeInput()}
			uniform sampler2D spatialPassTexture;

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;

			uniform float npart;
			uniform float spatialn;
			const float spatialDivisions = ${this.spatialDivisions}.;
			const float spatialDivisions2 = spatialDivisions * spatialDivisions;
			const float spatialDivisionsSub1 = spatialDivisions - 1.;

			${Qc.getpart}

			vec3 packRGBAToVec3(vec4 color) {
				uint r = uint(color.r * 255.);
				uint g = uint(color.g * 255.);
				uint combined = (r << 8) | g; 
				return vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535
			}

			void applyQuaternionToVector(in vec4 q, inout vec3 v) {
				v += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);
			}

			/**
			 * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)
			 */

			// branchless version of "Smooth Union, Subtraction and Intersection - bound, bound, bound" in above reference
			float smoothOperation(float op, float sdf, float d, float k) {
			  //        union: op =  1 => signSubtract =  1, signIntersection =  1
			  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1
				// intersection: op = -2 => signSubtract = -1, signIntersection = -1

				float signSubtract = clamp(op, -1., 1.);
				float signIntersection = 2. * (op - signSubtract) + 1.;
				float h = clamp(
					0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,
					0.0,
					1.0
				);
				return mix(sdf, signSubtract * signIntersection * d, h) - 
							 signSubtract * k * h * (1.0 - h);
			}

			float sdSphere( vec3 p, float s )
			{
				return length(p)-s;
			}

			float sdEllipsoid( vec3 p, vec3 r )
			{
				float k0 = length(p/r);
				float k1 = length(p/(r*r));
				return k0*(k0-1.0)/k1;
			}

			float sdBox( vec3 p, vec3 b )
			{
				vec3 q = abs(p) - b;
				return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
			}

			float sdTorus( vec3 p, vec2 t )
			{
				vec2 q = vec2(length(p.xy)-t.x,p.z);
				return length(q)-t.y;
			}

			float sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)
			{
				p.x = abs(p.x);
				float k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);
				return sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;
			}

			float dot2( in vec2 v ) { return dot(v,v); }
			float sdCappedCone( vec3 p, float h, float r1, float r2 )
			{
				vec2 q = vec2( length(p.xz), p.y );
				vec2 k1 = vec2(r2,h);
				vec2 k2 = vec2(r2-r1,2.0*h);
				vec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);
				vec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );
				float s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;
				return s*sqrt( min(dot2(ca),dot2(cb)) );
			}

			float sdCappedCylinder( vec3 p, float h, float r )
			{
				vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);
				return min(max(d.x,d.y),0.0) + length(max(d,0.0));
			}

			float maxBlend = 0.0;
			// compute potential from A (=24) spheres, using the bit flags in 'activeKey'
			// to avoid lookup/compute for inactive spheres
			// return field potential, side effect updates track,
			// compute and return +ve and -ve values separately
			void fillSpatialInner(
				float ii,
				float activeKey,
				vec3 corner,
				inout float sdf,
				inout float colorDivisor,
				inout vec4 trackColor
			) {
				for (float i = 0.; i < ${sc}.; i++) {
					if (activeKey < 1.) break; // activeKey exhausted, no more active spheres
					activeKey *= 0.5;
					if (fract(activeKey) < 0.5) continue;

					float iin = (i + ii + 0.5) * ${1/La};
					vec4 shape = shapePos(iin);
					vec4 quat = shapeQuat(iin);
					vec4 params1 = shapeParams1(iin);
					vec4 params2 = shapeParams2(iin);

					vec3 p = corner - shape.xyz;
					applyQuaternionToVector(quat, p);
					p /= params2.z; // scale
					float d; // d in -1..1 coordinates
					switch (int(params1.x)) {
						case 0: d = sdSphere(p, params1.y); break;
						case 1: d = sdEllipsoid(p, params1.yzw); break;
						case 2: d = sdBox(p, params1.yzw); break;
						case 3: d = sdCappedCylinder(p, params1.y, params1.z); break;
						case 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;
						case 5: d = sdTorus(p, params1.yz); break;
						case 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;
					}
					d -= params2.y; // rounded edge
					d *= params2.z; // scale

					float k = params2.x;
					float op = shape.w;

					sdf = smoothOperation(shape.w, sdf, d, k);

					float isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise
					float colorCull = smoothstep(maxBlend, 0., -d);
					float cullFactor = mix(1.0, colorCull, isNegativeOne);
					trackColor *= cullFactor;
					colorDivisor *= cullFactor;

					maxBlend = max(maxBlend, k);

					k += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k
					float nearness = smoothstep(k, 0., d);

					vec4 color = shapeColor(iin);
					nearness *= float(color.a >= 0.);

					colorDivisor += nearness;
					trackColor += color * nearness;
				}
			}

			vec3 div;
			// compute potential from all spheres; collect +ve and =ve values separately
			// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values
			// TODO check if extra vec3 output useful, not really used at present
			float fillSpatial(vec3 corner, inout vec4 trackColor) {
				float sdf = 1e3; // hack: initialize to large value
				float colorDivisor = 0.;
				// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving
				float divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);
				for (float ii = 0.; ii < spatialn; ii++) {
					float i = ii * ${4*sc}.;

					vec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));
					fillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${sc}., activeKey.y, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${2*sc}., activeKey.z, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${3*sc}., activeKey.w, corner, sdf, colorDivisor, trackColor);
				}

				trackColor /= colorDivisor;
				return mix(sdf, 0.0, step(1e20 - 0.1, sdf));
			}

			void main() {
				${Qc.getxyzi}    // get xi yi zi from 2d position

				vec3 xyzi = vec3(xi,yi,zi);
				vec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords

				div = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);

				vec4 c = vec4(0.);
				float t = fillSpatial(corner, c);

				pc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture
			}
		`;return new DT({name:"PotentialPass",fragmentShader:e,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let e=`
			precision highp float;
			layout(location = 0) out vec4 pc_FragColor;
			layout(location = 1) out vec4 numTris;

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; 
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;
			uniform sampler2D numTrisTable; // 256 x 1

			float keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {
				return (float(f000 < 0.) * 1.) +
							 (float(f100 < 0.) * 2.) +
							 (float(f010 < 0.) * 8.) +
							 (float(f110 < 0.) * 4.) +
							 (float(f001 < 0.) * 16.) +
							 (float(f101 < 0.) * 32.) +
							 (float(f011 < 0.) * 128.) +
							 (float(f111 < 0.) * 64.);
			}

			${Qc.lookup}

			vec3 compNormi(float xi, float yi, float zi) {
				float dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;
				float dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;
				float dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;
				// if we allow (common) 0,0,0 case through then NaN can spread
				// eg r = vec4(compNorm i(???), 1.) will pollute r.w
				if (dx == 0.0 && dy == 0.0 && dz == 0.0) {
					return vec3(0.199, 0.299, 0.399);
				}
				return normalize(vec3(dx, dy, dz));
			}

			void main() {
				${Qc.getxyzi}    // get xi yi zi from 2d

				vec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel

				if (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {
					pc_FragColor = vec4(normal, 0.);
					numTris = vec4(0.);
					return;
				}

				float
					f000 = look(xi, yi, zi, potentialPassTexture).r,
					f100 = look(xi+1., yi, zi, potentialPassTexture).r,
					f010 = look(xi, yi+1., zi, potentialPassTexture).r,
					f110 = look(xi+1., yi+1., zi, potentialPassTexture).r,
					f001 = look(xi, yi, zi+1., potentialPassTexture).r,
					f101 = look(xi+1., yi, zi+1., potentialPassTexture).r,
					f011 = look(xi, yi+1., zi+1., potentialPassTexture).r,
					f111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;
				float key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);

				pc_FragColor = vec4(normal, key);

				numTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));
			}
		`;return new DT({name:"VoxelPass",fragmentShader:e,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(e){let t=`
		#ifdef SHAPEBLEND 
			precision highp sampler2D;

			uniform float isol;

			uniform sampler2D triTable;     // 256 x 16
			uniform sampler2D pyramidTexture1;
			uniform vec2 pyramidTexture1Size;
			uniform sampler2D pyramidTexture2;
			uniform vec2 pyramidTexture2Size;

			const vec2 halfPixelOffset = vec2(0.5, 0.5);

			const vec2 rShift = vec2(0., 1.);
			const vec2 gShift = vec2(1., 1.);
			const vec2 bShift = vec2(1., 0.);

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;

			const float scale_factor = ${Ed}.;

			#if SHAPEBLEND == 5
				const float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);
				const float scale = 8. * scale_factor;
				const vec3 originOffset = vec3(16.);
			#elif SHAPEBLEND == 7
				const float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); 
				const float scale = 2. * scale_factor;
				const vec3 originOffset = vec3(64.);
			#elif SHAPEBLEND == 8
				const float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);
				const float scale = scale_factor;
				const vec3 originOffset = vec3(128.);
			#else
				const float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);
				const float scale = 4. * scale_factor;
				const vec3 originOffset = vec3(32.);
			#endif

			${Qc.lookup}

			const vec3 offsets[24] = vec3[](
				vec3(0., 0., 0.), vec3(1., 0., 0.),
				vec3(1., 0., 0.), vec3(1., 1., 0.),
				vec3(0., 1., 0.), vec3(1., 1., 0.),
				vec3(0., 0., 0.), vec3(0., 1., 0.),
				vec3(0., 0., 1.), vec3(1., 0., 1.),
				vec3(1., 0., 1.), vec3(1., 1., 1.),
				vec3(0., 1., 1.), vec3(1., 1., 1.),
				vec3(0., 0., 1.), vec3(0., 1., 1.),
				vec3(0., 0., 0.), vec3(0., 0., 1.),
				vec3(1., 0., 0.), vec3(1., 0., 1.),
				vec3(1., 1., 0.), vec3(1., 1., 1.),
				vec3(0., 1., 0.), vec3(0., 1., 1.)
			);

			vec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {
				vec2 xyShifted = xy;
				xyShifted.x += levelOriginX;
				return (xyShifted + halfPixelOffset) / pyramidTexture1Size;
			}

			vec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {
				vec2 xyShifted = xy;
				xyShifted.x += levelOriginX;
				return (xyShifted + halfPixelOffset) / pyramidTexture2Size;
			}

			vec4 unpackVec3ToRGBA(vec3 vec) {
				uint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding
				float g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255
				float r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; 
		
				return vec4(r, g, vec.y, vec.z);
			}

			out vec4 marchColor;
			// end of marchvertPre
		#endif
		`,i=`
		#ifdef SHAPEBLEND
			float triIndex = floor(float(gl_VertexID/3));
			float vertexIndex = float(gl_VertexID);
			
			// Initial pyramid lookup
			float levelOriginX1 = pyramidTexture1Size.x - 2.;
			float levelOriginX2 = pyramidTexture2Size.x - 1.;
			vec2 xy = vec2(0.);
			vec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));
			
			// Early exit check
			if (triIndex >= lookUp.r) return;
			
			// Optimize loop variables
			float start = 0.;
			vec4 triIndexVec = vec4(triIndex);
			
			// Main position computation loop
			for (int i = 0; i < LOOP;) {
				// Compute boundaries
				vec4 ends = lookUp + vec4(start);
				vec4 starts = vec4(ends.gba, start);
				vec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * 
											vec4(lessThan(triIndexVec, ends));
				
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
				
				// Update loop variables
				start = dot(check, starts);
				levelOriginX2 -= levelShiftX[i];
				
				// Update lookup
				lookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));
				i++;

				ends = lookUp + vec4(start);
				starts = vec4(ends.gba, start);
				check = vec4(greaterThanEqual(triIndexVec, starts)) * 
											vec4(lessThan(triIndexVec, ends));
				
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
				
				// Update loop variables
				start = dot(check, starts);
				levelOriginX1 -= levelShiftX[i];
				
				// Update lookup
				lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));

				i++;
			}

			#if HALF == 1
				vec4 ends = lookUp + vec4(start);
				vec4 starts = vec4(ends.gba, start);
				vec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));
			
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
			
				// Update loop variables
				start = dot(check, starts);
			#endif
			
			// Compute final coordinates
			vec3 gridPos;
			gridPos.x = mod(xy.x, VOXEL_RESOLUTION);
			gridPos.y = mod(xy.y, VOXEL_RESOLUTION);
			gridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + 
									floor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;
			
			// Vertex key computation
			vertexIndex -= start * 3.;
			float vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32
			
			// Voxel lookup and edge computation
			vec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);
			float key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256
			
			// Edge lookup and offset computation
			float edgeNum = texture(triTable, vec2(vk, key)).x;
			int edgeIndex = int(edgeNum) * 2;
			
			// Compute edge positions
			vec3 p1 = gridPos + offsets[edgeIndex];
			vec3 p2 = gridPos + offsets[edgeIndex + 1];
			
			// Compute potentials and normals
			vec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);
			vec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);
			
			// Final position and normal computation
			float mu = potential1.r / (potential1.r - potential2.r);

			marchColor = mix(
				unpackVec3ToRGBA(potential1.gba),
				unpackVec3ToRGBA(potential2.gba),
				mu
			);

			transformed = p1 + (p2 - p1) * mu;
			transformed -= originOffset;
			transformed *= scale;
			vec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);
			vec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);
			objectNormal = normalize(mix(data1.xyz, data2.xyz, mu));
			transformedNormal = normalMatrix * objectNormal;
			#ifndef FLAT_SHADED
				vNormal = transformedNormal;
			#endif
		#endif
		`;e.vertexShader=t+e.vertexShader.replace("#include <project_vertex>",i+`
#include <project_vertex>`);let r=e.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!r)return;let n=`
		#ifdef SHAPEBLEND_C
			#if SHAPEBLEND_C == 1
				${r[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a")}
			#else
				${r[0]}
			#endif
		#else
			${r[0]}
		#endif
		`;e.fragmentShader=`in vec4 marchColor;
`+e.fragmentShader.replace(r[0],n),Object.assign(e.uniforms,this.marchPassUniforms)}initDebugPass(e){console.log("fboToDebug.width",e.width,e.height),this.geometry=new Nh(e.width,e.height),this.geometry.userData={parameters:{width:4,height:4}};let t={inputTexture:{value:Array.isArray(e.texture)?e.texture[1]:e.texture},pyramidTextureSize:{value:void 0}},i=r=>{r.vertexShader=`
				precision highp float;

				varying vec2 vUv;

				void main() {
						gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
						vUv = uv;
				}
			`,r.fragmentShader=`
				layout(location = 1) out vec4 gVelocity;

				precision highp float;
				
				uniform sampler2D inputTexture;
				varying vec2 vUv;

				uniform vec2 pyramidTextureSize;

				void main() {
						// Sample the input texture using UV coordinates
						gl_FragColor = texture(inputTexture, vUv);
						gVelocity = vec4(0.0);
				}
			`,t.pyramidTextureSize.value=new Ie(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(r.uniforms,t)};this.material.shapeBlendhack=i,this.material.root.shapeBlendhack=i}},Jg=pre;Jg.streamCompaction=new kWe;var BWe=new Pt,zWe=new Pt,s0=new Si,Gf=new q,RS=new q,FWe=new Si;function UWe(e,t=0){let i=this.children.length;for(;i--;){let r=this.children[i];$g.is(r)&&mre.call(r,e,t+1)}}function mre(e,t=0){if(e(this,t)!==!0){let i=this.children.length;for(;i--;){let r=this.children[i];$g.is(r)&&mre.call(r,e,t+1)}}}function jWe(){if(this.shapesDataTexture.value===void 0){let a=new Wo(new Float32Array(4*La*dg),La,dg,On,$r);this.shapesDataTexture.value=a}let e=this.shapesDataTexture.value,t=e.image.data;e.needsUpdate=!0;let i=0,r=this.data.geometry.blendRange,n=BWe.copy(this.matrixWorld).invert(),s=0;UWe.call(this,a=>{var x;if(a.visible===!1)return!0;let o;if(a instanceof Nu||a instanceof Sb||a instanceof Tb)return;a instanceof Va?o=a.object:o=a;let l=(x=a.data)==null?void 0:x.cloner;if(wr.is(a)&&l&&!l.hideBase&&l.type!=="radial"&&l.disabled!==!0||!(o instanceof Os))return;let u=o.geometry.userData.parameters,c=u.shapeBlendNode;if(c===void 0)return;if(zWe.multiplyMatrices(n,a.matrixWorld).decompose(RS,s0,Gf),u.type==="TorusGeometry"&&u.arc!==360){let w=u.arc*Math.PI/180;w=w/4,s0.multiply(FWe.set(0,0,Math.sin(w),Math.cos(w)))}let h=c.overrideGlobalBlend?c.blendRange:r;h=h/this.bboxSize*2,t[s*4]=(RS.x-this.bboxOffset)/this.bboxSize*2,t[s*4+1]=(RS.y-this.bboxOffset)/this.bboxSize*2,t[s*4+2]=(RS.z-this.bboxOffset)/this.bboxSize*2,t[s*4+3]=c.operation===0?1:c.operation===2?-1:-2,t[La*4+s*4]=-s0.x,t[La*4+s*4+1]=-s0.y,t[La*4+s*4+2]=-s0.z,t[La*4+s*4+3]=s0.w;let d=new Float32Array(4),f=0;if(u.type==="SphereGeometry")u.width===u.height&&u.width===u.depth?d[0]=0:d[0]=1,d[1]=u.width/this.bboxSize,d[2]=u.height/this.bboxSize,d[3]=u.depth/this.bboxSize,i=Math.max(i,d[1]*Gf.x+h,d[2]*Gf.x+h,d[3]*Gf.x+h);else if(u.type==="CubeGeometry"){f=u.cornerRadius;let w=u.width,b=u.height,C=u.depth;d[0]=2,d[1]=(w-2*f)/this.bboxSize,d[2]=(b-2*f)/this.bboxSize,d[3]=(C-2*f)/this.bboxSize,i=Math.max(i,Math.sqrt(w**2+b**2+C**2)/this.bboxSize*Gf.x+h)}else if(u.type==="CylinderGeometry"){f=u.cornerRadius;let w=u.height,b=u.radiusBottom,C=u.radiusTop;if(C>=b){let A=Math.atan2(C-b,w),E=(Math.PI/2-A)/2;C-=f/Math.tan(E),b-=f*Math.tan(E)}else if(b>C){let A=Math.atan2(b-C,w),E=(Math.PI/2-A)/2;C-=f*Math.tan(E),b-=f/Math.tan(E)}d[1]=(u.height-2*f)/this.bboxSize,b===C?(d[0]=3,d[2]=b/this.bboxSize*2):(d[0]=4,d[2]=b/this.bboxSize*2,d[3]=C/this.bboxSize*2),i=Math.max(i,d[1]*4*Gf.x+h)}else if(u.type==="TorusGeometry"){if(d[0]=5,d[1]=(u.width-u.depth)/this.bboxSize,d[2]=u.depth/this.bboxSize,u.arc!==360){d[0]=6,d[3]=d[1],t[La*12+s*4+3]=d[2];let w=2*Math.atan2(d[2]/2,d[1]),b=u.arc*Math.PI/180/2-w;d[1]=Math.sin(b),d[2]=Math.cos(b)}i=Math.max(i,u.width*Gf.x/this.bboxSize+h)}t.set(d,La*8+s*4),t[La*12+s*4]=h,t[La*12+s*4+1]=f/this.bboxSize*2,t[La*12+s*4+2]=Gf.x;let m=o.material,g=m.uniforms.nodeU0.node.value,y=m.uniforms.nodeU1.value;c.operation!==0&&!c.useColor&&(y=-1),t[La*16+s*4]=g.r,t[La*16+s*4+1]=g.g,t[La*16+s*4+2]=g.b,t[La*16+s*4+3]=y,y<1&&this.material.defines.SHAPEBLEND_C===1&&(this.material.transparent=!0),s++}),this.npart=s,this.spatialPassUniforms.span.value=i*1.4}var gre=512;function b7(e,t){let i=!1,r=e.layers.mask&gre,n=t.getLayersOfType("transmission"),s=t.getLayersOfType("outline");return s.length>0&&(e.layers.set(8),n.length>0&&e.layers.enable(3),i=!0,hz(e),cz(e)),n.length===0&&s.length===0&&e.layers.set(0),r&&e.layers.set(9),e instanceof y1&&e.needsAO&&e.layers.enable(5),i}function _7(e,t){if(!t.layers)return!1;let i=e.layers.mask&gre,r=!1,n=t.getLayersOfType("transmission").filter(a=>a.data.visible),s=t.getLayersOfType("outline").filter(a=>a.data.visible);return n.length>0&&(e.layers.set(3),s.length>0&&e.layers.enable(8),r=!0),n.length===0&&s.length===0&&e.layers.set(0),i&&e.layers.set(9),e.needsAO&&e.layers.enable(5),r}function VWe(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof y1)if(Array.isArray(i.material))for(let r=0;r<i.material.length;r++)b7(i,i.material[r])&&(t=!0);else b7(i,i.material)&&(t=!0)}),t}function HWe(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof y1)if(Array.isArray(i.material))for(let r=0;r<i.material.length;r++)_7(i,i.material[r])&&(t=!0);else _7(i,i.material)&&(t=!0)}),t}var WWe=new tee,GWe=new Pt,qWe=new n1;function gN(e,t,i,r=!1){let n=e.cloner;if(n)for(let s of n.children){let a=GWe.copy(s.matrixWorld).invert(),o=qWe.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let u=WWe;u.set(o.origin,o.direction),u.near=t.near,u.far=t.far;let c=u.intersectObject(e,!1);c.length>0&&i.push({...c[0],object:r?s:e})}}var YWe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((i,r)=>{let n=[r,i],s=i;for(;this._constraints.has(s);){if(s=this._constraints.get(s),n.includes(s)){console.warn(`circular dependency detected: ${n.join(" -> ")}`);break}t.has(s)||n.push(s)}for(let a=n.length-2;a>=0;a--)if(!t.has(n[a])){let o=e.find(n[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${n[a]}`),t.add(n[a])}})}findDependency(e,t){let i=e;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===t)return!0;return!1}},XWe="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",Cp=class{};jx(Cp,"DepthMapRange",65536),jx(Cp,"MemoryPageSize",65536),jx(Cp,"BytesPerFloat",4),jx(Cp,"BytesPerInt",4);function KWe(e){let t,i,r,n,s,a,o,l,u,c,h,d,f,m,g,y;function x(k){let B=new Float64Array(c,a,16);for(let W=0;W<16;W++)B[W]=k[W];let z;if(r>1){t.exports.sortIndexes(n,s,u,a,o,l,d.DepthMapRange,r);let W=new Uint32Array(r);z=W.buffer,W.set(new Uint32Array(c,l,r))}else if(r===1){let W=new Uint32Array(r);W[0]=new Uint32Array(c,n,i)[0],z=W.buffer}else z=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:z},[z])}function w(k,B,z){let W=new Float32Array(c,s,i*3);r=0;let $=new Uint32Array(c,n,i);for(let Z=0;Z<z.length-1;Z++){let G=B[Z],V=k[Z].elements,J=G.filter(ie=>ie.enabled&&ie.mode==="Include").map(ie=>ie.type==="Box"?E(ie):I(ie)),U=G.filter(ie=>ie.enabled&&ie.mode==="Exclude").map(ie=>ie.type==="Box"?E(ie):I(ie));for(let ie=z[Z];ie<z[Z+1];ie++){let se=f[ie*3],ee=f[ie*3+1],ve=f[ie*3+2];if((J.length===0||C(se,ee,ve,J))&&(U.length===0||!C(se,ee,ve,U))){let _e=1/(V[3]*se+V[7]*ee+V[11]*ve+V[15]);W[r*3]=(V[0]*se+V[4]*ee+V[8]*ve+V[12])*_e,W[r*3+1]=(V[1]*se+V[5]*ee+V[9]*ve+V[13])*_e,W[r*3+2]=(V[2]*se+V[6]*ee+V[10]*ve+V[14])*_e,$[r]=ie,r++}}}}function b(k,B){let z=[],W=B.filter(G=>G.enabled&&G.mode==="Include").map(G=>G.type==="Box"?E(G):I(G)),$=B.filter(G=>G.enabled&&G.mode==="Exclude").map(G=>G.type==="Box"?E(G):I(G)),Z=k.length;for(let G=0;G<Z;G+=3){let V=k[G],J=k[G+1],U=k[G+2];(W.length===0||C(V,J,U,W))&&($.length===0||!C(V,J,U,$))||z.push(G/3)}return z}function C(k,B,z,W,$){return W[$==="Intersect"?"every":"some"](Z=>{let G=A(k,B,z,Z.invRotationMatrix,Z.cropCenter);return Array.isArray(Z)?P(G.x,G.y,G.z,Z):D(G.x,G.y,G.z,Z)})}function A(k,B,z,W,$){let Z=k-$[0],G=B-$[1],V=z-$[2],J=1/(W[3]*Z+W[7]*G+W[11]*V+W[15]);return{x:(W[0]*Z+W[4]*G+W[8]*V+W[12])*J+$[0],y:(W[1]*Z+W[5]*G+W[9]*V+W[13])*J+$[1],z:(W[2]*Z+W[6]*G+W[10]*V+W[14])*J+$[2]}}function E(k){let B=k.cropSize[0]/2,z=k.cropSize[1]/2,W=k.cropSize[2]/2,$=[k.cropCenter[0]-B,k.cropCenter[1]-z,k.cropCenter[2]-W,k.cropCenter[0]+B,k.cropCenter[1]+z,k.cropCenter[2]+W],Z=_(k.cropRotation);return Object.assign($,{invRotationMatrix:Z,cropCenter:k.cropCenter})}function _(k){let B=[],z=k[0]*Math.PI/180,W=k[1]*Math.PI/180,$=k[2]*Math.PI/180,Z=Math.cos(z),G=Math.sin(z),V=Math.cos(W),J=Math.sin(W),U=Math.cos($),ie=Math.sin($),se=Z*U,ee=Z*ie,ve=G*U,_e=G*ie;return B[0]=V*U,B[1]=-V*ie,B[2]=J,B[4]=ee+ve*J,B[5]=se-_e*J,B[6]=-G*V,B[8]=_e-se*J,B[9]=ve+ee*J,B[10]=Z*V,B[12]=0,B[13]=0,B[14]=0,B[3]=0,B[7]=0,B[11]=0,B[15]=1,B}function P(k,B,z,W){return k>=W[0]&&k<=W[3]&&B>=W[1]&&B<=W[4]&&z>=W[2]&&z<=W[5]}function I(k){let B=2/k.cropSize[0],z=2/k.cropSize[1],W=2/k.cropSize[2],$=_(k.cropRotation);return{invRadiusX:B,invRadiusY:z,invRadiusZ:W,cropCenter:k.cropCenter,invRotationMatrix:$}}function D(k,B,z,W){let $=(k-W.cropCenter[0])*W.invRadiusX,Z=(B-W.cropCenter[1])*W.invRadiusY,G=(z-W.cropCenter[2])*W.invRadiusZ;return $*$+Z*Z+G*G<=1}e.onmessage=k=>{if(k.data.getCroppedIndexes){let B=new Uint32Array(b(new Float32Array(k.data.positions),k.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:B},[B])}else if(k.data.positions)h=k.data.positions,f=new Float32Array(h),g=k.data.meshMatrixWorlds,y=k.data.cropsArray,m=k.data.meshIndexIntervals,w(g,y,m),e.postMessage({sortSetupComplete:!0});else if(k.data.sort||k.data.newMatrixWorlds||k.data.newCropsArray)(k.data.newMatrixWorlds||k.data.newCropsArray)&&(y=k.data.newCropsArray||y,g=k.data.newMatrixWorlds||g,w(g,y,m)),x(k.data.sort.view,k.data.sort.cameraPosition);else if(k.data.init){d=k.data.init.Constants,i=k.data.init.splatCount;let B=d.BytesPerInt,z=d.BytesPerFloat*3,W=new Uint8Array(k.data.init.sorterWasmBytes),$=B+z,Z=i*$,G=i*d.BytesPerInt*2+d.DepthMapRange*d.BytesPerInt*2,V=d.MemoryPageSize*32,J=Z+G+V,U=Math.floor(J/d.MemoryPageSize)+1,ie={module:{},env:{memory:new WebAssembly.Memory({initial:U*2,maximum:U*3,shared:!0})}};WebAssembly.compile(W).then(se=>WebAssembly.instantiate(se,ie)).then(se=>{t=se,n=0,s=i*B,a=s+i*z,u=a+16*d.BytesPerFloat*2,o=u+i*d.BytesPerInt,l=o+d.DepthMapRange*d.BytesPerInt,c=ie.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function $We(e){let t=new Worker(URL.createObjectURL(new Blob(["(",KWe.toString(),")(self)"],{type:"application/javascript"}))),i=atob(XWe),r=new Uint8Array(i.length);for(let n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return t.postMessage({init:{sorterWasmBytes:r.buffer,splatCount:e,Constants:{BytesPerFloat:Cp.BytesPerFloat,BytesPerInt:Cp.BytesPerInt,DepthMapRange:Cp.DepthMapRange,MemoryPageSize:Cp.MemoryPageSize}}}),t}var eO=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(i){return e[0]=i,t[0]}}(),ZWe=function(e,t,i,r){return e+(t<<8)+(i<<16)+(r<<24)},LS=new Ie;function w7(e){let t=!1;return e.scene.objects.traverse((i,r)=>{if(r.visible===!1)return!0;r.type==="Splat"&&(t=!0)}),t}var OT=class extends dn{constructor(e,t,i,r,n=!1,s=1,a,o){super(i,r),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=i,this.material=r,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,i=!1,r=1,n,s){let a=OT.buildGeomtery(t),o=OT.buildMaterial(n);return new OT(e,t,a,o,i,r,n,s)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,i=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,r={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new Ie},viewport:{type:"v2",value:new Ie},basisViewport:{type:"v2",value:new Ie},debugColor:{type:"v3",value:new mi},covariancesTextureSize:{type:"v2",value:new Ie(1024,1024)},centersColorsTextureSize:{type:"v2",value:new Ie(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Cr({uniforms:r,vertexShader:t,fragmentShader:i,transparent:!0,alphaTest:1,blending:Dg,depthTest:!0,depthWrite:!1,side:po})}static buildGeomtery(e){let t=new ai;t.setIndex([0,1,2,0,2,3]);let i=new Float32Array(4*3),r=new gi(i,3);t.setAttribute("position",r),r.setXYZ(0,-1,-1,0),r.setXYZ(1,-1,1,0),r.setXYZ(2,1,1,0),r.setXYZ(3,1,-1,0),r.needsUpdate=!0;let n=new JJ().copy(t),s=new Uint32Array(e),a=new o_(s,1,!1);return a.setUsage(ACe),n.setAttribute("splatIndex",a),n.instanceCount=e,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(r=>r.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,i=0;for(let r of this.splatBuffers){let n=r.nsplats;this.colors.subarray(e,e+n*4).set(r.colorsA),e+=n*4,this.centers.subarray(t,t+n*3).set(r.decoded.xyz.denormDequant().data),t+=n*3,this.covariances.subarray(i,i+n*6).set(new Float32Array(r.precomputedCovarianceBufferData)),i+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new Ie(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let i=new Ie(4096,1024);for(;i.x*i.y*4<e*4;)i.y*=2;let r,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let c=0;c<this.covariances.length;c++)n[c]=nOe.toHalfFloat(this.covariances[c]);r=new Wo(n,t.x,t.y,AC,lf)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),r=new Wo(n,t.x,t.y,AC,$r);r.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=r,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(i.x*i.y*4);for(let c=0;c<e;c++){let h=c*4,d=c*3,f=c*4;s[f]=ZWe(this.colors[h],this.colors[h+1],this.colors[h+2],this.colors[h+3]),s[f+1]=eO(this.centers[d]),s[f+2]=eO(this.centers[d+1]),s[f+3]=eO(this.centers[d+2])}let a=new Wo(s,i.x,i.y,mJ,qd);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(i);let o=256*4,l=new Float32Array(256*16);for(let c=0;c<this.meshMatrixWorlds.length;c++)l.set(this.meshMatrixWorlds[c].elements,c*16);let u=new Wo(l,o,1,On,$r);u.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=u,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:r,size:t},centerColors:{data:s,texture:a,size:i},meshMatrixWorlds:{data:l,texture:u}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,i,r){this.splatCount>0&&(LS.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(LS),this.material.uniforms.basisViewport.value.set(2/LS.x,2/LS.y),this.material.uniforms.focal.value.set(t,i),this.material.uniforms.orthoZoom.value=r,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},vre,QWe=new Promise(e=>{vre=e}),E7=!1,NS;function JWe(){if(E7)return;if(NS)return NS;async function e(){let t=await Ll(()=>import("./gaussian-splat-compression-BblNKJdU.js"),[]);vre(t),E7=!0}return NS=e(),NS}var yre;QWe.then(e=>yre=e);var e7e=class{constructor(e={}){jx(this,"updateView",function(){let t=new Pt,i=[],r=new q(0,0,-1),n=new q(0,0,-1),s=new q,a=new q;return function(o=!1,l){let u=this.updateMatrixWorldsInWorkerIfNeeded(),c=this.cropsChanged();if(!o){n.set(0,0,-1).applyQuaternion(l.quaternion);let d=!1,f=!1;if(n.dot(r)<=.95&&(d=!0),a.copy(l.position).sub(s).length()>=1&&(f=!0),!d&&!f&&!u&&!c&&!this.needsInitialRender)return}this.needsInitialRender=!1,s.copy(l.position),r.copy(n),t.copy(l.matrixWorld).invert(),t.premultiply(this.dummyPerspectiveMatrix),i[0]=l.position.x,i[1]=l.position.y,i[2]=l.position.z;let h={sort:{view:t.elements,cameraPosition:i,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...u?{newMatrixWorlds:this.meshMatrixWorlds}:{},...c?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=h:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(h))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new Pt().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let i=new Ie;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(e.getSize(i),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*i.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*i.y*.45,this.splatMesh.updateUniforms(i,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new q().fromArray(e.position)),e.orientation&&(e.orientation=new Si().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(s=>{s.data.type==="Splat"&&t.push(s)}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(s=>s.matrixWorld),this.meshMatrixWorldsOld=t.map(s=>s.matrixWorld.clone()),this.cropsArray=t.map(s=>s.data.crops.map(a=>a.data));let i=t.map(s=>new yre.GSplineBuffer(new Uint8Array(s.data.buffer).buffer)),r=0,n=[0];for(let s of i)r+=s.getSplatCount(),n.push(r);return this.setupSplatMesh(i,r,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(r),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,i)=>t.equals(this.meshMatrixWorldsOld[i]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,i)=>{var r;t.data.crops.forEach((n,s)=>{this.cropsArray[i][s]===void 0?(e=!0,this.cropsArray[i][s]=n.data):Object.entries(n.data).forEach(([a,o])=>{var l;Array.isArray(o)&&o.some((u,c)=>u!==this.cropsArray[i][s][a][c])?(e=!0,this.cropsArray[i][s][a]=o):o!==((l=this.cropsArray[i][s])==null?void 0:l[a])&&(e=!0,this.cropsArray[i][s][a]=o)})}),t.data.crops.length!==((r=this.cropsArray[i])==null?void 0:r.length)&&(this.cropsArray[i].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,i=new q,r=new Si,n=!1,s=1,a,o){this.splatMesh=OT.buildMesh(e,t,n,s,a,o),this.splatMesh.position.copy(i),this.splatMesh.quaternion.copy(r),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(l,u,c)=>this.update(l,c)}setupSortWorker(e){this.sortWorker=$We(e),this.sortWorker.onmessage=t=>{var i;t.data.sortDone?(this.sortRunning=!1,(i=this.splatMesh)==null||i.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){this.splatMesh!==null&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},vN=new uf;vN.wireframe=!0;var S7=new q,Ez=class extends Ol{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.shapeBlendIntances=[],this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new YWe,this.invisibleObjects=new my("jflkdsafjasdifjaslk",{...SL.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new va("fdasfa",{...jy.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=HWe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=VWe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),i=this.entityIdentityToEntity[t];i&&(e.uuid=i.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof va&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let i=[],r=t;for(;r!==this;){let n=r;r=r.parent;let s=r.children.indexOf(n);i.splice(0,0,s)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let r=this.getWithSortKey(i.id);r!==void 0&&t.push(r)}return t.sort((i,r)=>jee(i.sortKey,r.sortKey)),t.map(i=>i.entity)}nonExistOrDescendantOf(e,t){let i=this.find(e);if(i===void 0)return!0;for(;i;){if(i.uuid===t)return!0;i=i.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===m1)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof va&&t.uiScene){let i=t.uiScene.find(e);if(i)return i}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof va&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(i=>{t===void 0&&i instanceof fo&&(t=i.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof va&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var i;if(e.path.length===0&&e.type===7){let r=e.parent===null?this:this.find(e.parent);if(r===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,r,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),mc(n)&&$d(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r===void 0)throw new Error("unexpected");r.traverseEntity(s=>{s instanceof Jg&&(this.shapeBlendIntances=this.shapeBlendIntances.filter(a=>a!==s))}),this.markToExpandCloner(r),r.resetBBoxNeedsUpdate(),this.unregisterObject(r);let n=r.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(r),this.markPenumbraSizeDirty(),r.parent.remove(r),$d(r.parent)&&(r.parent.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),mc(r)&&(r.freeBooleanPointer(),n instanceof Qg&&n.invalidateDownstreamBooleanData().recomputeBoolean()),r instanceof xz&&r.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),this.pathConstraints.removeDependencies(r.uuid),r.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(r);let n=r.parent;this.markNeedsRecomputeInstancesForAncessors(n),(i=r.cloner)==null||i.resetOnMove(),this.markToExpandCloner(r);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(r),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(r),r.invalidateClonerTransform(r),r.updateVisible(this),r.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;s.children.splice(a,0,s.children.pop()),mc(r)&&(r.invalidateUpstreamBooleanData(),$d(r.parent)?r.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof Qg&&n.invalidateDownstreamBooleanData().recomputeBoolean()),r.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let i of this.children)i instanceof va&&(i.visible=i.uuid===e,i.visible&&(this.activePage=i,this.activePage.onActive(this)));this.activePage!==((t=this.splatViewer)==null?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,i,r){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{LWe(n,t,i,{scene:this,shared:r}),n instanceof Os&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}updateEntity2DByOp(e,t,i,r,n,s=[]){e.updateEntityByOp(t,i,r,n),this.traverseEntity(a=>{(a instanceof fo||a instanceof va)&&(s.includes(a.frameId??"")||a.frameId===t)&&a.updateEntity2DByOp(t,i,r,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let i=Object.entries(t.data.lib.components).map((r,n)=>({data:r[1].asset.data,children:r[1].asset.children,id:r[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(i,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(r=>{r instanceof go&&r.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){wr.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{wr.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,i,r,n,s,a){if(e){let o=r.find(e);o&&o!==r&&n.forInstancesRec(l=>{l.data=v_(l.data,u=>{let c=u.events.data(a.id),h=l.goUp(s);if(h){let d=[...Uee(h.identity),e].join("-"),f=this.entityIdentityToEntity[d];if(f){let m=f.uuid,g=$s.zoom(c,t);g[i]=m}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,i,r,n,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",i,r,n,s):a.data.type==="Animation"?this.relativeizeInner(a.data.object,[...t,a.id],"object",i,r,n,s):a.data.type==="Conditional"&&(this.rewriteActions(a.data.ifActions,[...t,a.id,"ifActions"],i,r,n,s),this.rewriteActions(a.data.elseActions,[...t,a.id,"elseActions"],i,r,n,s))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof gy&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,i)=>{t.data.events.forEach(r=>{if(r.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(s=>{s.data=v_(s.data,a=>{s.isInstanceRoot||(a.events.delete(r.id),n=!0)}).data}),n===!1)for(let s of uA.list)this.rewriteActions(r.data.gameActions[s],["gameActions",s],e,t,i,r)}else r.data.type==="Conditional"?(r.data.condition.type==="Distance"?(this.relativeizeInner(r.data.condition.fromObject,["condition"],"fromObject",e,t,i,r),this.relativeizeInner(r.data.condition.toObject,["condition"],"toObject",e,t,i,r)):r.data.condition.type==="State"?this.relativeizeInner(r.data.condition.object,["condition"],"object",e,t,i,r):r.data.condition.type==="Comparison"&&(r.data.condition.lOperand.type==="Property"&&this.relativeizeInner(r.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,i,r),r.data.condition.rOperand.type==="Property"&&this.relativeizeInner(r.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,i,r)),this.rewriteActions(r.data.inActions,["inActions"],e,t,i,r),this.rewriteActions(r.data.outActions,["outActions"],e,t,i,r)):"actions"in r.data&&this.rewriteActions(r.data.actions,["actions"],e,t,i,r)})}),!0})}expandInstances(e,t,i){let r=new Set;this.traverseEntity(n=>{if(n instanceof gy&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:r}),t||n.resetBBoxNeedsUpdate(),i&&n.traverseEntity(s=>{i.addClip(s)}),!0});for(let n of r)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),_z(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(i=>{i instanceof gy&&i.isInstanceRoot&&(i.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let i=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[i]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[i]),t.dispose()})}clearScene(){for(let e of this.children)wr.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let i=[],r=n=>{for(let s of n.children){let a=s.cloner;if(wr.is(s)&&!s.raycastLock&&(s.visible||a!=null&&a.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let u=s.matrixWorld.clone().invert();l.point.applyMatrix4(u),i.push(l)}}else(mc(s)||sN(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,i),gN(s,e,i)),r(s)}};return r(this.activePage),i}raycastWithClones(e){let t=[],i=r=>{for(let n of r.children){let s=n.cloner;wr.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((mc(n)||sN(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),gN(n,e,t,!0)),i(n))}};return i(this),t}forEachEntity(e){for(let t of this.children)wr.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)wr.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)wr.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(i=>{if(i instanceof Os&&i.data.type==="Mesh"&&(i.data.geometry.type==="TextGeometry"||i.data.geometry.type==="InputGeometry")&&i.data.geometry.font===e){let r=i.geometry,n=i.data.geometry;r.updateFont(e,t).then(()=>{r.update(n);let s=i.invalidateDownstreamBooleanData();$d(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)$g.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)wr.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,i){let r=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,r,i),r+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,i,r,n,s){var l;let a={scene:this,shared:s},o=wz(e,t,a);return o instanceof Jg&&this.shapeBlendIntances.push(o),o&&(this.entityByUuid[e]=o,r.add(o),r.children.splice(n,0,r.children.pop()),i.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,o,s)),o.updateState(t,a),o instanceof Os&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(this),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(u=>{let c=u.dataPatched;if(u instanceof Os&&c.bones&&c.boneInverses){let h=c.bones.map(m=>this.find(m)),d=c.boneInverses.map(m=>new Pt().fromArray(m)),f=new uB(h,d);u.bind(f,u.bindMatrix)}else u.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let r=0,n=e.length;r<n;++r){let{id:s,recursive:a}=e[r],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let i=new xs;return i.setFromPoints(t),i.getCenter(S7),S7}copyMatrixWorld(e,t){if(e===null){t.identity();return}let i=this.find(e);i?t.copy(i.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var r;if(e===null){t.identity();return}let i=(r=this.find(e))==null?void 0:r.parent;i?t.copy(i.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof Ko)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)t.material[i]instanceof Kp&&e(t.material[i]);else t.material instanceof Kp&&e(t.material)})}updateViewPlaneSize(e,t,i=!1){this.traverseConcreteEntity(r=>{r instanceof go&&r.setViewplaneSize(e,t,i)})}initializeSplatViewer(){this.splatViewer=new e7e({scene:this}),this.reloadSplats()}reloadSplats(){var e;(e=this.splatViewer)==null||e.loadSplat()}},RT=(e,t)=>{let i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},t7e=(e,t)=>{let i=t.x-e.x,r=t.y-e.y;return r7e(Math.atan2(r,i))},i7e=(e,t,i)=>{let r={x:0,y:0};return i=yN(i),r.x=e.x-t*Math.cos(i),r.y=e.y-t*Math.sin(i),r},yN=e=>e*(Math.PI/180),r7e=e=>e*(180/Math.PI),n7e=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,tO=new Map,T7=e=>{tO.has(e)&&clearTimeout(tO.get(e)),tO.set(e,setTimeout(e,100))},CA=(e,t,i)=>{let r=t.split(/[ ,]+/g),n;for(let s=0;s<r.length;s+=1)n=r[s],e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent&&e.attachEvent(n,i)},C7=(e,t,i)=>{let r=t.split(/[ ,]+/g),n;for(let s=0;s<r.length;s+=1)n=r[s],e.removeEventListener?e.removeEventListener(n,i):e.detachEvent&&e.detachEvent(n,i)},xre=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),A7=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},xN=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},Sz=(e,t,i)=>{let r=bre(e);for(let n in r)if(r.hasOwnProperty(n))if(typeof t=="string")r[n]=t+" "+i;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+i+", ";r[n]=s.slice(0,-2)}return r},s7e=(e,t)=>{let i=bre(e);for(let r in i)i.hasOwnProperty(r)&&(i[r]=t);return i},bre=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},iO=(e,t)=>{for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},a7e=(e,t)=>{let i={};for(let r in e)e.hasOwnProperty(r)&&t.hasOwnProperty(r)?i[r]=t[r]:e.hasOwnProperty(r)&&(i[r]=e[r]);return i},bN=(e,t)=>{if(e.length)for(let i=0,r=e.length;i<r;i+=1)t(e[i]);else t(e)},o7e=(e,t,i)=>({x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)});typeof window<"u"&&(_re="ontouchstart"in window,wre=!!window.PointerEvent,Ere=!!window.MSPointerEvent);var _re,wre,Ere,yx={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},K0,A_={};wre?K0=yx.pointer:Ere?K0=yx.MSPointer:_re?(K0=yx.touch,A_=yx.mouse):K0=yx.mouse;function fv(){}fv.prototype.on=function(e,t){var i=this,r=e.split(/[ ,]+/g),n;i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]=i._handlers_[n]||[],i._handlers_[n].push(t);return i};fv.prototype.off=function(e,t){var i=this;return i._handlers_=i._handlers_||{},e===void 0?i._handlers_={}:t===void 0?i._handlers_[e]=null:i._handlers_[e]&&i._handlers_[e].indexOf(t)>=0&&i._handlers_[e].splice(i._handlers_[e].indexOf(t),1),i};fv.prototype.trigger=function(e,t){var i=this,r=e.split(/[ ,]+/g),n;i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]&&i._handlers_[n].length&&i._handlers_[n].forEach(function(a){a.call(i,{type:n,target:i},t)})};fv.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=a7e(t.options,e))};fv.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){typeof i["on"+t]=="function"?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},CA(e,K0[t],i._domHandlers_[t]),A_[t]&&CA(e,A_[t],i._domHandlers_[t]),i};fv.prototype.unbindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},C7(e,K0[t],i._domHandlers_[t]),A_[t]&&C7(e,A_[t],i._domHandlers_[t]),delete i._domHandlers_[t],this};var Tz=fv;function ta(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=ta.id,ta.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}ta.prototype=new Tz;ta.constructor=ta;ta.id=0;ta.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};ta.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=s7e("borderRadius","50%"),i=Sz("transition","opacity",e),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},iO(r.el,i),this.options.shape==="circle"&&iO(r.back,t),iO(r.front,t),this.applyStyles(r),this};ta.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this};ta.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};ta.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};ta.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};ta.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};ta.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=i,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let i=t.options.restJoystick,r={};r.x=i===!0||i.x!==!1?0:t.instance.frontPosition.x,r.y=i===!0||i.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,r)}return t};ta.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var r=i.options.fadeTime+"ms",n={};n.front=Sz("transition",["top","left"],r);var s={front:{}};s.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(n),i.applyStyles(s),i.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(i),i.restCallback()},i.options.fadeTime)};ta.prototype.restCallback=function(){var e=this,t={};t.front=Sz("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};ta.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};ta.prototype.computeDirection=function(e){var t=e.angle.radian,i=Math.PI/4,r=Math.PI/2,n,s,a;if(t>i&&t<i*3&&!e.lockX?n="up":t>-i&&t<=i&&!e.lockY?n="left":t>-i*3&&t<=-i&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-r&&t<r?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var u={};this.direction={x:s,y:a,angle:n},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(u[l]=!0);if(u.x&&u.y&&u.angle)return e;(!u.x||!u.y)&&this.trigger("plain",e),u.x||this.trigger("plain:"+s,e),u.y||this.trigger("plain:"+a,e),u.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var l7e=ta;function bs(e,t){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=e,i.id=bs.id,bs.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(t),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let r=getComputedStyle(i.options.zone.parentElement);return r&&r.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}bs.prototype=new Tz;bs.constructor=bs;bs.id=0;bs.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(i){if(i===void 0)return t[0];for(var r=0,n=t.length;r<n;r+=1)if(t[r].identifier===i)return t[r];return!1}};bs.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};bs.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var i=e.createNipple(t.position,e.manager.getIdentifier());i.add(),e.idles.push(i)}};bs.prototype.createNipple=function(e,t){var i=this,r=i.manager.scroll,n={},s=i.options,a={x:i.parentIsFlex?r.x:r.x+i.box.left,y:i.parentIsFlex?r.y:r.y+i.box.top};if(e.x&&e.y)n={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),n=e,e={x:l.left+r.x,y:l.top+r.y}}var u=new l7e(i,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(xN(u.ui.el,n),xN(u.ui.front,u.frontPosition)),i.nipples.push(u),i.trigger("added "+u.identifier+":added",u),i.manager.trigger("added "+u.identifier+":added",u),i.bindNipple(u),u};bs.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};bs.prototype.bindNipple=function(e){var t=this,i,r=function(n,s){i=n.type+" "+s.id+":"+n.type,t.trigger(i,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",r),e.on("dir:up dir:right dir:down dir:left",r),e.on("plain:up plain:right plain:down plain:left",r)};bs.prototype.pressureFn=function(e,t,i){var r=this,n=0;clearInterval(r.pressureIntervals[i]),r.pressureIntervals[i]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==n&&(t.trigger("pressure",s),r.trigger("pressure "+t.identifier+":pressure",s),n=s)}).bind(r),100)};bs.prototype.onstart=function(e){var t=this,i=t.options,r=e;e=xre(e),t.updateBox();var n=function(s){t.actives.length<i.maxNumberOfNipples?t.processOnStart(s):r.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(r.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(s))};return bN(e,n),t.manager.bindDocument(),!1};bs.prototype.processOnStart=function(e){var t=this,i=t.options,r,n=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(n,a);o.identifier!==n&&t.manager.removeIdentifier(o.identifier),o.identifier=n;var l=function(c){c.trigger("start",c),t.trigger("start "+c.id+":start",c),c.show(),s>0&&t.pressureFn(e,c,c.identifier),t.processOnMove(e)};if((r=t.idles.indexOf(o))>=0&&t.idles.splice(r,1),t.actives.push(o),t.ids.push(o.identifier),i.mode!=="semi")l(o);else{var u=RT(a,o.position);if(u<=i.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};bs.prototype.getOrCreate=function(e,t){var i=this,r=i.options,n;return/(semi|static)/.test(r.mode)?(n=i.idles[0],n?(i.idles.splice(0,1),n):r.mode==="semi"?i.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=i.createNipple(t,e),n)};bs.prototype.processOnMove=function(e){var t=this,i=t.options,r=t.manager.getIdentifier(e),n=t.nipples.get(r),s=t.manager.scroll;if(!n7e(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+r),t.manager.removeIdentifier(r);return}if(i.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=r;var o=n.options.size/2,l={x:e.pageX,y:e.pageY};i.lockX&&(l.y=n.position.y),i.lockY&&(l.x=n.position.x);var u=RT(l,n.position),c=t7e(l,n.position),h=yN(c),d=u/o,f={distance:u,position:l},m,g;if(n.options.shape==="circle"?(m=Math.min(u,o),g=i7e(n.position,m,c)):(g=o7e(l,n.position,o),m=RT(g,n.position)),i.follow){if(u>o){let b=l.x-g.x,C=l.y-g.y;n.position.x+=b,n.position.y+=C,n.el.style.top=n.position.y-(t.box.top+s.y)+"px",n.el.style.left=n.position.x-(t.box.left+s.x)+"px",u=RT(l,n.position)}}else l=g,u=m;var y=l.x-n.position.x,x=l.y-n.position.y;n.frontPosition={x:y,y:x},i.dataOnly||xN(n.ui.front,n.frontPosition);var w={identifier:n.identifier,position:l,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:u,angle:{radian:h,degree:c},vector:{x:y/o,y:-x/o},raw:f,instance:n,lockX:i.lockX,lockY:i.lockY};w=n.computeDirection(w),w.angle={radian:yN(180-c),degree:180-c},n.trigger("move",w),t.trigger("move "+n.id+":move",w)};bs.prototype.processOnEnd=function(e){var t=this,i=t.options,r=t.manager.getIdentifier(e),n=t.nipples.get(r),s=t.manager.removeIdentifier(n.identifier);!n||(i.dataOnly||n.hide(function(){i.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(i.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[s.id]=s.identifier))};bs.prototype.onDestroyed=function(e,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.manager.removeIdentifier(t.identifier),i.manager.unbindDocument()};bs.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(i){i.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var u7e=bs;function Ca(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=A7(),t.config(e),t.prepareCollections();var i=function(){var n;t.collections.forEach(function(s){s.forEach(function(a){n=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;CA(window,"resize",function(){T7(i)});var r=function(){t.scroll=A7()};return CA(window,"scroll",function(){T7(r)}),t.collections}Ca.prototype=new Tz;Ca.constructor=Ca;Ca.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(r){return i=r.get(t),!i}),i}};Ca.prototype.create=function(e){return this.createCollection(e)};Ca.prototype.createCollection=function(e){var t=this,i=new u7e(t,e);return t.bindCollection(i),t.collections.push(i),i};Ca.prototype.bindCollection=function(e){var t=this,i,r=function(n,s){i=n.type+" "+s.id+":"+n.type,t.trigger(i,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",r),e.on("dir:up dir:right dir:down dir:left",r),e.on("plain:up plain:right plain:down plain:left",r)};Ca.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};Ca.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};Ca.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};Ca.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t};Ca.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};Ca.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};Ca.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};Ca.prototype.onAny=function(e,t){var i=this,r,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=xre(t);var s=function(o,l,u){u.ids.indexOf(l)>=0&&(u[n](o),o._found_=!0)},a=function(o){r=i.getIdentifier(o),bN(i.collections,s.bind(null,o,r)),o._found_||i.removeIdentifier(r)};return bN(t,a),!1};Ca.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};Ca.prototype.onDestroyed=function(e,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)};var c7e=Ca,M7=new c7e,h7e={create:function(e){return M7.create(e)},factory:M7},Sre=new Map,Ab=new Map,Tg=class{constructor(e,t,i,r){this.data=t;let{audio:n,volume:s,delay:a,loop:o}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?r.getAudio(n).src:n.data;this.audioPlayer=new Zx({src:l,volume:s,delay:a,loop:o}),Ab.has(i.uuid)?Ab.get(i.uuid).push(this):Ab.set(i.uuid,[this]),Sre.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},_N=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=Sre.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=Ab.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...Ab.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Tre=class{constructor(e,t,i,r,n){if(this.data=t,this.shared=r,this.condition=n,t.interaction==="play")this.interaction=new Tg(e,t,i,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new _N(t);else throw new Error("Missing property")}dispatchBasic(){if(bn(this.shared,this.condition)===!1)return!1;this.interaction instanceof Tg?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(bn(this.shared,this.condition)===!1)return!1;this.interaction instanceof Tg?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(bn(this.shared,this.condition)===!1)return!1;this.interaction instanceof Tg&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},Cre=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e);return}this.particleSystem.start()}stop(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e);return}this.particleSystem.stop()}freeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e);return}this.particleSystem.froze()}unFreeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e);return}this.particleSystem.unFroze()}reset(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(bn(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(bn(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(e){if(bn(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},d7e="text/plain",f7e="us-ascii",P7=(e,t)=>t.some(i=>i instanceof RegExp?i.test(e):i===e),p7e=(e,{stripHash:t})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:r,data:n,hash:s}=i.groups,a=r.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),u=[...a.map(c=>{let[h,d=""]=c.split("=").map(f=>f.trim());return h==="charset"&&(d=d.toLowerCase(),d===f7e)?"":`${h}${d?`=${d}`:""}`}).filter(Boolean)];return o&&u.push("base64"),(u.length>0||l&&l!==d7e)&&u.unshift(l),`data:${u.join(";")},${o?n.trim():n}${s?`#${s}`:""}`};function m7e(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return p7e(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let r=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&r.protocol==="https:"&&(r.protocol="http:"),t.forceHttps&&r.protocol==="http:"&&(r.protocol="https:"),t.stripAuthentication&&(r.username="",r.password=""),t.stripHash?r.hash="":t.stripTextFragment&&(r.hash=r.hash.replace(/#?:~:text.*?$/i,"")),r.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let u=s.exec(r.pathname);if(!u)break;let c=u[0],h=u.index,d=r.pathname.slice(a,h);o+=d.replace(/\/{2,}/g,"/"),o+=c,a=h+c.length}let l=r.pathname.slice(a,r.pathname.length);o+=l.replace(/\/{2,}/g,"/"),r.pathname=o}if(r.pathname)try{r.pathname=decodeURI(r.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=r.pathname.split("/"),a=s[s.length-1];P7(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),r.pathname=s.slice(1).join("/")+"/")}if(r.hostname&&(r.hostname=r.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(r.hostname)&&(r.hostname=r.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...r.searchParams.keys()])P7(s,t.removeQueryParameters)&&r.searchParams.delete(s);if(t.removeQueryParameters===!0&&(r.search=""),t.sortQueryParameters){r.searchParams.sort();try{r.search=decodeURIComponent(r.search)}catch{}}t.removeTrailingSlash&&(r.pathname=r.pathname.replace(/\/$/,""));let n=e;return e=r.toString(),!t.removeSingleSlash&&r.pathname==="/"&&!n.endsWith("/")&&r.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||r.pathname==="/")&&r.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var g7e=class{constructor({url:e,context:t},i,r,n){if(this.controlsManager=i,this.shared=r,this.condition=n,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:m7e(e,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=t??"tab"}dispatch(){var e;if(bn(this.shared,this.condition)===!1)return!1;sw?window.location.assign(this.url):(this.context==="tab"||Fee&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.controlsManager.orbitControls)==null||e.onPointerUp(wi[0]),Oze())}},Are=class{constructor(e,t,i,r,n){this.data=e,this.page=t,this.controlsManager=i,this.shared=r,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=s=>{var u,c;this.timeoutIdQueue.shift();let a=this.page.scene.find(s);if(a===void 0)return;let o=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=o?(u=a.dataPatched.physics)==null?void 0:u.fusedBody:!0;if(a.cloner){for(let h of a.cloner.children)l?(h.playModeVisible=!1,h.rigidBody&&((c=a.dataPatched.physics)==null?void 0:c.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(h.rigidBody.collider(0).handle),o.removeRigidBody(h.rigidBody),h.rigidBody=void 0),h.bvhGeometry&&(h.bvhGeometry=void 0)):this.clone===void 0||this.clone===h?(h.playModeVisible=!1,h.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(h.rigidBody.collider(0).handle),o.removeRigidBody(h.rigidBody),h.rigidBody=void 0)):h.playModeVisible===void 0&&(h.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(a.visible=!1,a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0))}else a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0),a.visible=!1;o===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(h=>h.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(h=>h.rigidBody!==void 0),a.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(bn(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(bn(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},Mre=class{constructor(e,t,i,r,n){this.data=e,this.page=t,this.shared=i,this.eventManager=r,this.condition=n,this.shared=i}dispatch(){if(bn(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),kz(this.page,this.shared,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Pre={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},Cz={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},v7e=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],AA={CSS:{},springs:{}};function xc(e,t,i){return Math.min(Math.max(e,t),i)}function Mb(e,t){return e.indexOf(t)>-1}function rO(e,t){return e.apply(null,t)}var Ci={arr:function(e){return Array.isArray(e)},obj:function(e){return Mb(Object.prototype.toString.call(e),"Object")},pth:function(e){return Ci.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||Ci.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return Ci.hex(e)||Ci.rgb(e)||Ci.hsl(e)},key:function(e){return!Pre.hasOwnProperty(e)&&!Cz.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function Dre(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(i){return parseFloat(i)}):[]}function Ire(e,t){var i=Dre(e),r=xc(Ci.und(i[0])?1:i[0],.1,100),n=xc(Ci.und(i[1])?100:i[1],.1,100),s=xc(Ci.und(i[2])?10:i[2],.1,100),a=xc(Ci.und(i[3])?0:i[3],.1,100),o=Math.sqrt(n/r),l=s/(2*Math.sqrt(n*r)),u=l<1?o*Math.sqrt(1-l*l):0,c=1,h=l<1?(l*o+-a)/u:-a+o;function d(m){var g=t?t*m/1e3:m;return l<1?g=Math.exp(-g*l*o)*(c*Math.cos(u*g)+h*Math.sin(u*g)):g=(c+h*g)*Math.exp(-g*o),m===0||m===1?m:1-g}function f(){var m=AA.springs[e];if(m)return m;for(var g=1/6,y=0,x=0;;)if(y+=g,d(y)===1){if(x++,x>=16)break}else x=0;var w=y*g*1e3;return AA.springs[e]=w,w}return t?d:f}function y7e(e){return e===void 0&&(e=10),function(t){return Math.ceil(xc(t,1e-6,1)*e)*(1/e)}}var x7e=function(){var e=11,t=1/(e-1);function i(c,h){return 1-3*h+3*c}function r(c,h){return 3*h-6*c}function n(c){return 3*c}function s(c,h,d){return((i(h,d)*c+r(h,d))*c+n(h))*c}function a(c,h,d){return 3*i(h,d)*c*c+2*r(h,d)*c+n(h)}function o(c,h,d,f,m){var g,y,x=0;do y=h+(d-h)/2,g=s(y,f,m)-c,g>0?d=y:h=y;while(Math.abs(g)>1e-7&&++x<10);return y}function l(c,h,d,f){for(var m=0;m<4;++m){var g=a(h,d,f);if(g===0)return h;var y=s(h,d,f)-c;h-=y/g}return h}function u(c,h,d,f){if(!(0<=c&&c<=1&&0<=d&&d<=1))return;var m=new Float32Array(e);if(c!==h||d!==f)for(var g=0;g<e;++g)m[g]=s(g*t,c,d);function y(x){for(var w=0,b=1,C=e-1;b!==C&&m[b]<=x;++b)w+=t;--b;var A=(x-m[b])/(m[b+1]-m[b]),E=w+A*t,_=a(E,c,d);return _>=.001?l(x,E,c,d):_===0?E:o(x,w,w+t,c,d)}return function(x){return c===h&&d===f||x===0||x===1?x:s(y(x),h,f)}}return u}(),Ore=function(){var e={linear:function(){return function(r){return r}}},t={Sine:function(){return function(r){return 1-Math.cos(r*Math.PI/2)}},Circ:function(){return function(r){return 1-Math.sqrt(1-r*r)}},Back:function(){return function(r){return r*r*(3*r-2)}},Bounce:function(){return function(r){for(var n,s=4;r<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-r,2)}},Elastic:function(r,n){r===void 0&&(r=1),n===void 0&&(n=.5);var s=xc(r,1,10),a=xc(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(r,n){t[r]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(r){var n=t[r];e["easeIn"+r]=n,e["easeOut"+r]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+r]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function Az(e,t){if(Ci.fnc(e))return e;var i=e.split("(")[0],r=Ore[i],n=Dre(e);switch(i){case"spring":return Ire(e,t);case"cubicBezier":return rO(x7e,n);case"steps":return rO(y7e,n);default:return rO(r,n)}}function Rre(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function WM(e,t){for(var i=e.length,r=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<i;s++)if(s in e){var a=e[s];t.call(r,a,s,e)&&n.push(a)}return n}function GM(e){return e.reduce(function(t,i){return t.concat(Ci.arr(i)?GM(i):i)},[])}function D7(e){return Ci.arr(e)?e:(Ci.str(e)&&(e=Rre(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function Mz(e,t){return e.some(function(i){return i===t})}function Pz(e){var t={};for(var i in e)t[i]=e[i];return t}function wN(e,t){var i=Pz(e);for(var r in e)i[r]=t.hasOwnProperty(r)?t[r]:e[r];return i}function qM(e,t){var i=Pz(e);for(var r in t)i[r]=Ci.und(e[r])?t[r]:e[r];return i}function b7e(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function _7e(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=e.replace(t,function(o,l,u,c){return l+l+u+u+c+c}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),n=parseInt(r[1],16),s=parseInt(r[2],16),a=parseInt(r[3],16);return"rgba("+n+","+s+","+a+",1)"}function w7e(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),i=parseInt(t[1],10)/360,r=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(d,f,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?d+(f-d)*6*m:m<1/2?f:m<2/3?d+(f-d)*(2/3-m)*6:d}var o,l,u;if(r==0)o=l=u=n;else{var c=n<.5?n*(1+r):n+r-n*r,h=2*n-c;o=a(h,c,i+1/3),l=a(h,c,i),u=a(h,c,i-1/3)}return"rgba("+o*255+","+l*255+","+u*255+","+s+")"}function E7e(e){if(Ci.rgb(e))return b7e(e);if(Ci.hex(e))return _7e(e);if(Ci.hsl(e))return w7e(e)}function tf(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function S7e(e){if(Mb(e,"translate")||e==="perspective")return"px";if(Mb(e,"rotate")||Mb(e,"skew"))return"deg"}function EN(e,t){return Ci.fnc(e)?e(t.target,t.id,t.total):e}function Eh(e,t){return e.getAttribute(t)}function Dz(e,t,i){var r=tf(t);if(Mz([i,"deg","rad","turn"],r))return t;var n=AA.CSS[t+i];if(!Ci.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+i;var l=s/a.offsetWidth;o.removeChild(a);var u=l*parseFloat(t);return AA.CSS[t+i]=u,u}function Lre(e,t,i){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return i?Dz(e,n,i):n}}function Iz(e,t){if(Ci.dom(e)&&!Ci.inp(e)&&(Eh(e,t)||Ci.svg(e)&&e[t]))return"attribute";if(Ci.dom(e)&&Mz(v7e,t))return"transform";if(Ci.dom(e)&&t!=="transform"&&Lre(e,t))return"css";if(e[t]!=null)return"object"}function Nre(e){if(Ci.dom(e)){for(var t=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,r=new Map,n;n=i.exec(t);)r.set(n[1],n[2]);return r}}function T7e(e,t,i,r){var n=Mb(t,"scale")?1:0+S7e(t),s=Nre(e).get(t)||n;return i&&(i.transforms.list.set(t,s),i.transforms.last=t),r?Dz(e,s,r):s}function Oz(e,t,i,r){switch(Iz(e,t)){case"transform":return T7e(e,t,r,i);case"css":return Lre(e,t,i);case"attribute":return Eh(e,t);default:return e[t]||0}}function Rz(e,t){var i=/^(\*=|\+=|-=)/.exec(e);if(!i)return e;var r=tf(e)||0,n=parseFloat(t),s=parseFloat(e.replace(i[0],""));switch(i[0][0]){case"+":return n+s+r;case"-":return n-s+r;case"*":return n*s+r}}function kre(e,t){if(Ci.col(e))return E7e(e);if(/\s/g.test(e))return e;var i=tf(e),r=i?e.substr(0,e.length-i.length):e;return t?r+t:r}function Lz(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function C7e(e){return Math.PI*2*Eh(e,"r")}function A7e(e){return Eh(e,"width")*2+Eh(e,"height")*2}function M7e(e){return Lz({x:Eh(e,"x1"),y:Eh(e,"y1")},{x:Eh(e,"x2"),y:Eh(e,"y2")})}function Bre(e){for(var t=e.points,i=0,r,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(i+=Lz(r,s)),r=s}return i}function P7e(e){var t=e.points;return Bre(e)+Lz(t.getItem(t.numberOfItems-1),t.getItem(0))}function zre(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return C7e(e);case"rect":return A7e(e);case"line":return M7e(e);case"polyline":return Bre(e);case"polygon":return P7e(e)}}function D7e(e){var t=zre(e);return e.setAttribute("stroke-dasharray",t),t}function I7e(e){for(var t=e.parentNode;Ci.svg(t)&&Ci.svg(t.parentNode);)t=t.parentNode;return t}function Fre(e,t){var i=t||{},r=i.el||I7e(e),n=r.getBoundingClientRect(),s=Eh(r,"viewBox"),a=n.width,o=n.height,l=i.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:r,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function O7e(e,t){var i=Ci.str(e)?Rre(e)[0]:e,r=t||100;return function(n){return{property:n,el:i,svg:Fre(i),totalLength:zre(i)*(r/100)}}}function R7e(e,t){function i(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var r=Fre(e.el,e.svg),n=i(),s=i(-1),a=i(1);switch(e.property){case"x":return(n.x-r.x)*r.w;case"y":return(n.y-r.y)*r.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function I7(e,t){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=kre(Ci.pth(e)?e.totalLength:e,t)+"";return{original:r,numbers:r.match(i)?r.match(i).map(Number):[0],strings:Ci.str(e)||t?r.split(i):[]}}function Ure(e){var t=e?GM(Ci.arr(e)?e.map(D7):D7(e)):[];return WM(t,function(i,r,n){return n.indexOf(i)===r})}function jre(e){var t=Ure(e);return t.map(function(i,r){return{target:i,id:r,total:t.length,transforms:{list:Nre(i)}}})}function L7e(e,t){var i=Pz(t);if(/^spring/.test(i.easing)&&(i.duration=Ire(i.easing)),Ci.arr(e)){var r=e.length,n=r===2&&!Ci.obj(e[0]);n?e={value:e}:Ci.fnc(t.duration)||(i.duration=t.duration/r)}var s=Ci.arr(e)?e:[e];return s.map(function(a,o){var l=Ci.obj(a)&&!Ci.pth(a)?a:{value:a};return Ci.und(l.delay)&&(l.delay=o?0:t.delay),Ci.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return qM(a,i)})}function N7e(e){for(var t=WM(GM(e.map(function(s){return Object.keys(s)})),function(s){return Ci.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),i={},r=function(s){var a=t[s];i[a]=e.map(function(o){var l={};for(var u in o)Ci.key(u)?u==a&&(l.value=o[u]):l[u]=o[u];return l})},n=0;n<t.length;n++)r(n);return i}function k7e(e,t){var i=[],r=t.keyframes;r&&(t=qM(N7e(r),t));for(var n in t)Ci.key(n)&&i.push({name:n,tweens:L7e(t[n],e)});return i}function B7e(e,t){var i={};for(var r in e){var n=EN(e[r],t);Ci.arr(n)&&(n=n.map(function(s){return EN(s,t)}),n.length===1&&(n=n[0])),i[r]=n}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function z7e(e,t){var i;return e.tweens.map(function(r){var n=B7e(r,t),s=n.value,a=Ci.arr(s)?s[1]:s,o=tf(a),l=Oz(t.target,e.name,o,t),u=i?i.to.original:l,c=Ci.arr(s)?s[0]:u,h=tf(c)||tf(l),d=o||h;return Ci.und(a)&&(a=u),n.from=I7(c,d),n.to=I7(Rz(a,c),d),n.start=i?i.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=Az(n.easing,n.duration),n.isPath=Ci.pth(s),n.isColor=Ci.col(n.from.original),n.isColor&&(n.round=1),i=n,n})}var Vre={css:function(e,t,i){return e.style[t]=i},attribute:function(e,t,i){return e.setAttribute(t,i)},object:function(e,t,i){return e[t]=i},transform:function(e,t,i,r,n){if(r.list.set(t,i),t===r.last||n){var s="";r.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function Hre(e,t){var i=jre(e);i.forEach(function(r){for(var n in t){var s=EN(t[n],r),a=r.target,o=tf(s),l=Oz(a,n,o,r),u=o||tf(l),c=Rz(kre(s,u),l),h=Iz(a,n);Vre[h](a,n,c,r.transforms,!0)}})}function F7e(e,t){var i=Iz(e.target,t.name);if(i){var r=z7e(t,e),n=r[r.length-1];return{type:i,property:t.name,animatable:e,tweens:r,duration:n.end,delay:r[0].delay,endDelay:n.endDelay}}}function U7e(e,t){return WM(GM(e.map(function(i){return t.map(function(r){return F7e(i,r)})})),function(i){return!Ci.und(i)})}function Wre(e,t){var i=e.length,r=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=i?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return r(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,n.delay=i?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return r(s)+a+o+s.delay})):t.delay,n.endDelay=i?n.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return r(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,n}var O7=0;function j7e(e){var t=wN(Pre,e),i=wN(Cz,e),r=k7e(i,e),n=jre(e.targets),s=U7e(n,r),a=Wre(s,i),o=O7;return O7++,qM(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var Fu=[],R7=[],LT,V7e=function(){function e(){LT=requestAnimationFrame(t)}function t(i){var r=Fu.length;if(r){for(var n=0;n<r;){var s=Fu[n];s.paused?(Fu.splice(n,1),r-=1):(s.tick(i),n++)}e()}else LT=cancelAnimationFrame(LT)}return e}();function H7e(e){document.hidden?(Fu.forEach(function(t){return t.pause(e.timeStamp)}),R7=Fu.slice(0),ys.running=Fu=[]):R7.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",H7e);function ys(e){e===void 0&&(e={});var t=0,i=0,r=0,n,s,a=0,o=null;function l(E){var _=window.Promise&&new Promise(function(P){return o=P});return E.finished=_,_}var u=j7e(e);l(u);function c(){var E=u.direction;E!=="alternate"&&(u.direction=E!=="normal"?"normal":"reverse"),u.reversed=!u.reversed,s.forEach(function(_){(_.loop===1||_.loop%2===0)&&(_.reversed=u.reversed)})}function h(){u.direction="normal",u.reversed=!1,s.forEach(function(E){return E.reversed=!1})}function d(E){return u.reversed?u.duration-E:E}function f(){t=0,i=d(u.currentTime)*(1/ys.speed)}function m(E,_,P=!1){_&&(u.reversed?_.seek(_.duration*_.loop-(E-_.timelineOffset-_.pingPongDelayCorrection),P):_.seek(E-_.timelineOffset-_.startOnceDelay-_.pingPongDelayCorrection,P))}function g(E,_=!1){if(u.reversed)for(var P=a;P--;)m(E,s[P],_);else for(var I=0;I<a;I++)m(E,s[I],_)}function y(E){var De,we,Le,Te,ke,Xe,et,Ze,st,_t;var _=0,P=u.animations,I=P.length;for(u.direction!=="alternate"&&((De=u.parent)==null?void 0:De.direction)==="alternate"?((we=u.parent)==null?void 0:we.rewind)===!1&&u.reversePlayback===!0&&u.rewind===!1&&((Le=u.parent)!=null&&Le.reversed&&u.direction==="alternate"?E=u.duration-u.delay+u.endDelay-E:E=u.duration+u.delay-u.endDelay-E):C(!1,(Te=u.parent)==null?void 0:Te.rewind,u.rewind,(ke=u.parent)==null?void 0:ke.reversePlayback,u.reversePlayback)&&((Xe=u.parent)!=null&&Xe.reversed&&u.direction==="alternate"?E=u.duration-u.delay+u.endDelay-E:E=u.duration+u.delay-u.endDelay-E);_<I;){var D=P[_],k=D.animatable,B=D.tweens,z=B.length-1,W=B[z];z&&(W=WM(B,function(ue){return E<ue.end})[0]||W);let St;(et=u.parent)!=null&&et.reversed&&u.direction==="alternate"?St=xc(E-W.start-W.endDelay,0,W.duration)/W.duration:St=xc(E-W.start-W.delay,0,W.duration)/W.duration;for(var $=isNaN(St)?1:W.easing(St),Z=W.to.strings,G=W.round,V=[],J=W.to.numbers.length,U=void 0,ie=0;ie<J;ie++){var se=void 0;let ue,Ee;u.direction!=="alternate"?((Ze=u.parent)==null?void 0:Ze.rewind)===!1&&u.reversePlayback===!0&&u.rewind===!1?(ue=W.to.numbers[ie],Ee=W.from.numbers[ie]||0):(Ee=W.to.numbers[ie],ue=W.from.numbers[ie]||0):C(!0,(st=u.parent)==null?void 0:st.rewind,u.rewind,(_t=u.parent)==null?void 0:_t.reversePlayback,u.reversePlayback)?(ue=W.to.numbers[ie],Ee=W.from.numbers[ie]||0):(Ee=W.to.numbers[ie],ue=W.from.numbers[ie]||0),W.isPath?se=R7e(W.value,$*Ee):se=ue+$*(Ee-ue),G&&(W.isColor&&ie>2||(se=Math.round(se*G)/G)),V.push(se)}var ee=Z.length;if(!ee)U=V[0];else{U=Z[0];for(var ve=0;ve<ee;ve++){Z[ve];var _e=Z[ve+1],he=V[ve];isNaN(he)||(_e?U+=he+_e:U+=he+" ")}}Vre[D.type](k.target,D.property,U,k.transforms),D.currentValue=U,_++}}function x(E){u[E]&&!u.passThrough&&u[E](u)}function w(){u.remaining&&u.remaining!==!0&&u.remaining--}let b={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function C(E,_,P,I,D){return b[E<<4|_<<3|P<<2|I<<1|D]}function A(E,_=!1){var B;var P=u.duration;let I=u.delay,D=P-u.endDelay;(B=u.parent)!=null&&B.reversed&&u.direction==="alternate"&&(I=u.endDelay,D=P-u.delay);var k=d(E);if(u.progress=xc(k/P*100,0,100),_||(u.reversePlayback=k<u.currentTime),a&&g(k,_),!u.began&&u.currentTime>=0&&(u.began=!0,x("begin")),!u.loopBegan&&u.currentTime>0&&(u.loopBegan=!0,x("loopBegin")),(u.reversed||k>=0)&&k<=I&&u.currentTime!==0&&(y(0),x("change")),(k>=D&&u.currentTime!==P+u.pingPongDelayCorrection||!P)&&(y(P),x("change")),k>I&&k<D?(u.changeBegan||(u.changeBegan=!0,u.changeCompleted=!1,x("changeBegin")),y(k),x("change")):u.changeBegan?(u.changeCompleted=!0,u.changeBegan=!1,x("change"),a&&x("timelineChangeComplete")):u.began&&k>D&&x("changeComplete"),u.currentTime=xc(k,0,P+u.pingPongDelayCorrection),u.began&&x("update"),E>=P)if(w(),!u.remaining)u.paused=!0,u.completed||(u.completed=!0,x("loopComplete"),x("complete"),!u.passThrough&&"Promise"in window&&(o(),l(u)));else{a?t+=u.duration/ys.speed:t+=u.duration;for(let z of s)z.setStartTime(0),z.remaining=z.loop;x("loopComplete"),u.loopBegan=!1,u.direction==="alternate"?c():a&&h()}}return u.reset=function(){var E=u.direction;u.passThrough=!1,u.currentTime=0,u.progress=0,u.paused=!0,u.began=!1,u.loopBegan=!1,u.changeBegan=!1,u.completed=!1,u.changeCompleted=!1,u.reversePlayback=!1,u.reversed=E==="reverse",u.remaining=u.loop,s=u.children,a=s.length;for(var _=a;_--;)u.children[_].reset();y(u.reversed?u.duration:0)},u.setStartTime=function(E){t=E},u.set=function(E,_){return Hre(E,_),u},u.tick=function(E){r=E,t||(t=r),A((r+(i-t))*ys.speed)},u.seek=function(E,_=!1){A(E-t,_)},u.pause=function(E){u.paused=!0,a&&(n=E??performance.now())},u.play=function(E){!u.paused||(u.completed&&u.reset(),u.paused=!1,Fu.push(u),a&&n!==void 0&&(t+=(E??performance.now())-n),LT||V7e())},u.reverse=function(){c(),u.completed=!u.reversed,f()},u.restart=function(){u.reset(),u.play()},u.reset(),u.autoplay&&u.play(),u}function L7(e,t){for(var i=t.length;i--;)Mz(e,t[i].animatable.target)&&t.splice(i,1)}function W7e(e){for(var t=Ure(e),i=Fu.length;i--;){var r=Fu[i],n=r.animations,s=r.children;L7(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;L7(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&r.pause()}}function G7e(e,t){t===void 0&&(t={});var i=t.direction||"normal",r=t.easing?Az(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",u=a==="last",c=Ci.arr(e),h=parseFloat(c?e[0]:e),d=c?parseFloat(e[1]):0,f=tf(c?e[1]:e)||0,m=t.start||0+(c?h:0),g=[],y=0;return function(x,w,b){if(o&&(a=0),l&&(a=(b-1)/2),u&&(a=b-1),!g.length){for(var C=0;C<b;C++){if(!n)g.push(Math.abs(a-C));else{var A=l?(n[0]-1)/2:a%n[0],E=l?(n[1]-1)/2:Math.floor(a/n[0]),_=C%n[0],P=Math.floor(C/n[0]),I=A-_,D=E-P,k=Math.sqrt(I*I+D*D);s==="x"&&(k=-I),s==="y"&&(k=-D),g.push(k)}y=Math.max.apply(Math,g)}r&&(g=g.map(function(z){return r(z/y)*y})),i==="reverse"&&(g=g.map(function(z){return s?z<0?z*-1:-z:Math.abs(y-z)}))}var B=c?(d-h)/y:h;return m+B*(Math.round(g[w]*100)/100)+f}}function q7e(e){e===void 0&&(e={});var t=ys(e);return t.duration=0,t.add=function(i,r){var n=Fu.indexOf(t),s=t.children;n>-1&&Fu.splice(n,1);function a(d){d.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=qM(i,wN(Cz,e));l.targets=l.targets||e.targets;var u=t.duration;l.autoplay=!1,l.timelineOffset=Ci.und(r)?u:Rz(r,u),a(t);var c=ys(l);a(c),s.push(c),c.parent=t;var h=Wre(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,c.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}ys.version="3.2.0";ys.speed=1;ys.running=Fu;ys.remove=W7e;ys.get=Oz;ys.set=Hre;ys.convertPx=Dz;ys.path=O7e;ys.setDashoffset=D7e;ys.stagger=G7e;ys.timeline=q7e;ys.easing=Az;ys.penner=Ore;ys.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var Gre=ys,N7=new q,k7=new q,B7=new Si;function Y7e(e,t,i,r){if(r===0)return i.copy(e);if(r===1)return i.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return i.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let c=1-r;return i.w=c*e.w+r*t.w,i.x=c*e.x+r*t.x,i.y=c*e.y+r*t.y,i.z=c*e.z+r*t.z,i.normalize(),i}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-r)*o)/a,u=Math.sin(r*o)/a;return i.w=e.w*l+t.w*u,i.x=e.x*l+t.x*u,i.y=e.y*l+t.y*u,i.z=e.z*l+t.z*u,i}function Ba(e,t,i,r,n,s){let a=i[e]!==void 0?i[e]:void 0,o=r[e];if(o==null)return;let l=a!=null?typeof a=="string"?Number(n.getVariable(a)??0):a:t[e],u=typeof o=="string"?Number(n.getVariable(o)??0):o;if(l!==u)return{update:c=>{let h=Xt.lerp(l,u,c);s?t[e]=Math.trunc(h):t[e]=h},start:()=>{t[e]=l},end:()=>{t[e]=u}}}function Nz(e,t,i,r,n,s){let a=i[e]?i[e]:void 0,o=r[e];if(!o)return;let l=t[e],u=[...a??l].map(h=>typeof h=="string"?Number(n.getVariable(h)??0):h),c=[...o].map(h=>typeof h=="string"?Number(n.getVariable(h)??0):h);if(!(u.length!==c.length||NB(u,c)))return{update:h=>{u.forEach((d,f)=>{let m=Xt.lerp(d,c[f],h);t[e][f]=s?Math.trunc(m):m})},start:()=>{Object.assign(t[e],u)},end:()=>{Object.assign(t[e],c)}}}function MA(e,t,i){return t.forEach((r,n)=>{e.setComponent(n,typeof r=="string"?Number(i.getVariable(r)??0):r)}),e}function z7(e,t,i,r,n){let s=i[e]?i[e]:void 0,a=r[e];if(!a)return;let o=t[e],l=s?MA(new q,s,n):o.clone(),u=MA(new q,a,n);if(!l.equals(u))return{update:c=>{o.lerpVectors(l,u,c)},start:()=>{o.copy(l)},end:()=>{o.copy(u)}}}function F7(e,t,i){return t.forEach((r,n)=>{e.setComponent(n,typeof r=="string"?Number(i.getVariable(r)??0):r)}),e}function PA(e,t,i,r,n){let s=i[e]?i[e]:void 0,a=r[e];if(!a)return;let o=t[e],l=!(o instanceof Ie),u=o instanceof Ie?o:new Ie().fromArray(o),c=s?F7(new Ie,s,n):u.clone(),h=F7(new Ie,a,n);if(!c.equals(h))return{update:d=>{u.lerpVectors(c,h,d),l&&(t[e]=u.toArray())},start:()=>{u.copy(c),l&&(t[e]=u.toArray())},end:()=>{u.copy(h),l&&(t[e]=u.toArray())}}}function X7e(e,t,i,r){let n=i[e]?i[e]:void 0,s=r[e];if(!s)return;let a=t[e],o=n?new Pt().fromArray(n):a.clone(),l=new q,u=new Si,c=new q;o.decompose(l,u,c);let h=new Pt().fromArray(s),d=new q,f=new Si,m=new q;if(h.decompose(d,f,m),!o.equals(h))return{update:g=>{B7.slerpQuaternions(u,f,g),N7.lerpVectors(l,d,g),k7.lerpVectors(c,m,g),a.compose(N7,B7,k7)},start:()=>{a.compose(l,u,c)},end:()=>{a.compose(d,f,m)}}}function K7e(e,t,i,r,n){let s=i[e]?i[e]:void 0,a=r[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?n.getColor(s).clone():new mi().setRGB(s.r,s.g,s.b):o.clone(),u=typeof a=="string"?n.getColor(a).clone():new mi().setRGB(a.r,a.g,a.b);if(l.equals(u))return;let c=o.clone();return{update:h=>{var d,f;c.lerpColors(l,u,h),(f=(d=t[e])==null?void 0:d.copy)==null||f.call(d,c)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function kS(e,t,i,r,n){let s=i[e]?i[e]:void 0,a=r[e];if(!a)return;let o=t[e],l=new Wa(o.r,o.g,o.b,o.a),u=s?typeof s=="string"?n.getColor(s).clone():new Wa(s.r,s.g,s.b,s.a):l.clone(),c=typeof a=="string"?n.getColor(a).clone():new Wa(a.r,a.g,a.b,a.a);if(!u.equals(c))return{update:h=>{l.lerpColors(u,c,h);let d=Xt.lerp(u.a,c.a,h);l.a=d,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(u)},end:()=>{l.copy(c)}}}function om(e,t,i,r,n){if(typeof t[e]=="number")return Ba(e,t,i??{},r,n);if(Array.isArray(t[e]))return Nz(e,t,i??{},r,n)}function $7e(e,t,i,r){var o,l,u,c;let n=[],s=e.cameraType==="OrthographicCamera"?(o=t.orthographic)==null?void 0:o.zoom:(l=t.perspective)==null?void 0:l.zoom,a=e.cameraType==="OrthographicCamera"?(u=i.orthographic)==null?void 0:u.zoom:(c=i.perspective)==null?void 0:c.zoom;if(a!==void 0){let h=s??e.zoom,d=a;h!==d&&n.push({update:f=>{e.zoom=Xt.lerp(h,d,f),e.updateProjectionMatrix()},start:()=>{e.zoom=h,e.updateProjectionMatrix()},end:()=>{e.zoom=d,e.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let h=Ba("targetOffset",e,t,i,r);h&&n.push(h)}return n}function Z7e(e,t,i,r){if(i.scaleBaked===void 0)return;let n=(t.scaleBaked??e.data.geometry.scaleBaked).map(o=>typeof o=="string"?Number(r.getVariable(o)??0):o),s=i.scaleBaked.map(o=>typeof o=="string"?Number(r.getVariable(o)??0):o);if(Lg.isEqual(n,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[Xt.lerp(n[0],s[0],o),Xt.lerp(n[1],s[1],o),Xt.lerp(n[2],s[2],o)]},r),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},r),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},r),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),a}function Q7e(e,t,i,r){if(!i.extrusion)return;let n=e.extrusion,s=t.extrusion??{},a=i.extrusion,o=[];return wte.forEach(l=>{let u=om(l,n,s,a,r);u&&o.push(u)}),o}function J7e(e,t,i,r){let n=[];if(!("geometry"in i))return n;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=i.geometry;if(e instanceof C_){let l=Z7e(e,a,o,r);l&&n.push(...l)}else{let l={};if(Object.assign(l,Dh(s,uI),Dh(a,uI)),uI.forEach(u=>{let c=om(u,l,a,o,r);c&&n.push(c)}),e instanceof xz){Object.assign(l,{extrusion:{...s.extrusion}});let u=Q7e(l,a,o,r);u&&n.push(...u)}n.length&&n.push({update:u=>{e.updateGeometryInteractions(l,r),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:u=>{e.updateGeometryInteractions(l,r),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:u=>{e.updateGeometryInteractions(l,r),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return n}function eGe(e,t,i,r){let n=[];if(i.intensity!==void 0){let s=Ba("intensity",e,t,i,r);s&&n.push(s)}if(i.color!==void 0){let s=K7e("color",e,t,i,r);s&&n.push(s)}return n}function tGe(e,t,i,r){let n=[];if(Array.isArray(e.material)){if(!("materials"in i&&i.materials))return n;let s="materials"in t&&t.materials?t.materials:[],a=i.materials;e.material.forEach((o,l)=>{if(!a[l])return;let u=s[l]??{},c=a[l];typeof u=="string"||typeof c=="string"||n.push(...U7(o,u,c,r))})}else{if(!("material"in i&&i.material))return n;let s="material"in t&&t.material?t.material:{},a=i.material;if(typeof s=="string"||typeof a=="string")return n;n.push(...U7(e.material,s,a,r))}return n}function U7(e,t,i,r){var a;let n=[],s=X0(i,r)||!!t.layers&&X0(t,r);n.push(cGe(e,s));for(let o of e.layers){let l=(a=t.layers)==null?void 0:a.data(o.uuid),u=i.layers.data(o.uuid);if(!u||o.type!=="light"&&(!(o.visible??!0)||!(u.visible??!0)))continue;let c=o.getNames().filter(h=>!xte.some(d=>h.includes(d)));for(let h of c)try{let d=o.getValue(h),f;if(h==="colors")f=lGe(o,l,u,h);else if(Array.isArray(d))h==="steps"&&(f=oGe(o,l,u,h));else if(typeof d=="number")f=iGe(o,l,u,h,r);else{if(typeof d=="boolean")continue;d instanceof Ie?f=rGe(o,l,u,h):d instanceof q?f=nGe(o,l,u,h,r):d instanceof Wa?f=aGe(o,l,u,h,r):d instanceof mi?f=sGe(o,l,u,h,r):"isTexture"in d&&(f=uGe(o,l,u,h))}f&&(Array.isArray(f)?n.push(...f):n.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${h}`,d)}}return n}function iGe(e,t,i,r,n){if(!e.hasValue(r)||!(r in i))return;let s=t?t[r]:e.getValue(r),a=i[r],o=typeof s=="string"?Number(n.getVariable(s)??0):s,l=typeof a=="string"?Number(n.getVariable(a)??0):a;if(o!==l)return{update:u=>{e.setValue(r,Xt.lerp(o,l,u))},start:()=>{e.setValue(r,o)},end:()=>{e.setValue(r,l)}}}function rGe(e,t,i,r){if(!e.hasValue(r)||!(r in i))return;let n=e.getValue(r),s=t?new Ie().fromArray(t[r]):n.clone(),a=new Ie().fromArray(i[r]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function nGe(e,t,i,r,n){if(!e.hasValue(r)||!(r in i))return;let s=e.getValue(r),a=t?t[r]:void 0,o=i[r],l=a?MA(new q,a,n):s.clone(),u=MA(new q,o,n);if(!l.equals(u))return{update:c=>{s.lerpVectors(l,u,c)},start:()=>{s.copy(l)},end:()=>{s.copy(u)}}}function sGe(e,t,i,r,n){if(!e.hasValue(r)||!(r in i))return;let s=t?t[r]:void 0,a=i[r],o=e.getValue(r),l=s?typeof s=="string"?n.getColor(s).clone():new mi().setRGB(s.r,s.g,s.b):o.clone(),u=typeof a=="string"?n.getColor(a).clone():new mi().setRGB(a.r,a.g,a.b);if(l.equals(u))return;let c=o.clone();return{update:h=>{e.getValue(r)!==c&&e.setValue(r,c),c.lerpColors(l,u,h)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function aGe(e,t,i,r,n){if(!e.hasValue(r)||!(r in i))return;let s=t?t[r]:void 0,a=i[r],o=e.getValue(r),l=s?typeof s=="string"?n.getColor(s).clone():new mi().setRGB(s.r,s.g,s.b):o.clone(),u=typeof a=="string"?n.getColor(a).clone():new Wa(a.r,a.g,a.b,a.a);if(l.equals(u))return;let c=o.clone();return{update:h=>{e.getValue(r)!==c&&e.setValue(r,c),c.lerpColors(l,u,h)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function oGe(e,t,i,r="steps"){if(!e.hasValue(r)||!(r in i))return;let n=[],s=e.getValue(r),a=t?t[r]:s,o=i[r];return NB(a,o)||n.push({update:l=>{let u=[...s];for(let c=0;c<s.length;++c){let h=a[c],d=o[c];u[c]=Xt.lerp(h,d,l)}e.setValue(r,u)},start:()=>{e.setValue(r,a)},end:()=>{e.setValue(r,o)}}),n.length?n:void 0}function lGe(e,t,i,r="colors"){if(!e.hasValue(r)||!(r in i))return;let n=[],s=e.getValue(r),a=t?t[r]:s.map(l=>l.toArray()),o=i[r];for(let l=0;l<s.length;++l){let u=[...a[l]],c=[...o[l]];eA.isEqual(u,c)||n.push({update:h=>{s[l].fromArray(eA.lerp(u,c,h))},start:()=>{s[l].fromArray(u)},end:()=>{s[l].fromArray(c)}})}return n.length?n:void 0}function uGe(e,t,i,r="texture"){var y,x;if(!e.hasValue(r)||!(r in i))return;let n=e.getNode("rotation"),s=((y=t==null?void 0:t[r])==null?void 0:y.rotation)??0,a=((x=i[r])==null?void 0:x.rotation)??0;if(n&&s!==a)return{update:w=>{n.value=Xt.lerp(s,a,w)*Xt.DEG2RAD},start:()=>{n.value=s*Xt.DEG2RAD},end:()=>{n.value=a*Xt.DEG2RAD}};let o=e.getNode("mat");if(!o)return;let l=t?t[r]:o,u=i[r],c=[...l.repeat],h=[...l.offset],d=[...u.repeat],f=[...u.offset],m=l.rotation??0,g=u.rotation??0;if(!Kd.isEqual(c,d)||!Kd.isEqual(h,f)||m!==g)return{update:w=>{o.repeat=Kd.lerp(c,d,w),o.offset=Kd.lerp(h,f,w),o.rotation=Xt.lerp(m,g,w),o.updateMatrix()},start:()=>{o.repeat=[...c],o.offset=[...h],o.rotation=m,o.updateMatrix()},end:()=>{o.repeat=[...d],o.offset=[...f],o.rotation=g,o.updateMatrix()}}}function cGe(e,t){return{update:()=>{e.transparent=t}}}var nO=new q,j7=new Ks;function hGe(e,t,i,r,n){var m,g,y,x,w,b;let s=[],a,o,l,u,c,h,d,f;if(e instanceof Ta?(a=PA("position",e,t,i,n),a&&s.push(a),l=Ba("rotation",e,t,i,n),l&&s.push(l),u=PA("shear",e,t,i,n),u&&s.push(u)):(f={slide:((m=t.pathSnapping)==null?void 0:m.slide)??((g=e.updatedPathSnapping)==null?void 0:g.slide)??((y=e.dataPatched.pathSnapping)==null?void 0:y.slide)??0,offset:((x=t.pathSnapping)==null?void 0:x.offset)??((w=e.updatedPathSnapping)==null?void 0:w.offset)??((b=e.dataPatched.pathSnapping)==null?void 0:b.offset)??0},h=Ba("slide",f,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping,n),h&&s.push(h),d=Ba("offset",f,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping,n),d&&s.push(d),!h&&!d&&(a=z7("position",e,t,i,n),a&&s.push(a),o=z7("scale",e,t,i,n),o&&s.push(o),l=dGe(e,t,i,r,n),l&&s.push(l),c=X7e("hiddenMatrix",e,t,i),c&&s.push(c))),a||o||l||c||h||d){let C=e instanceof Ta?()=>{e.updateWorldMatrix(!0,!1,!0),e.resetBBoxNeedsUpdate()}:()=>{var A;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(A=e.parent)!=null&&A.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),mc(e)&&$d(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,f))};s.push({update:C,start:C,end:C})}return s}function dGe(e,t,i,r,n){var c;let s=t!=null&&t.rotation?t.rotation.map(h=>(typeof h=="string"?Number(n.getVariable(h)??0):h)*Xt.DEG2RAD):void 0,a=(c=i.rotation)==null?void 0:c.map(h=>(typeof h=="string"?Number(n.getVariable(h)??0):h)*Xt.DEG2RAD);if(!a)return;let o=s?new q().fromArray(s):new q().setFromEuler(e.rotation),l=new q().fromArray(a);if(o.equals(l))return;let u=nO.subVectors(l,o);if(r&&u.toArray().every(h=>Math.abs(h)<2*Math.PI)){let h=new Si().setFromEuler(j7.setFromVector3(o)),d=new Si().setFromEuler(j7.setFromVector3(l));return{update:f=>{Y7e(h,d,e.quaternion,f)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:h=>{nO.lerpVectors(o,l,h),e.rotation.setFromVector3(nO)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}function fGe(e,t,i,r){let n=[];if(!("cloner"in i)||!e.cloner)return n;let s=e.cloner,a="cloner"in t?t.cloner:{},o=i.cloner;fte.forEach(f=>{let m;f==="count"?m=Ba("count",s.parameters,a,o,r,!0):m=om(f,s.parameters,a??{},o,r),m&&n.push(m)});let l=pGe(s,a,o,r);l!=null&&l.length&&n.push(...l);let u=mGe(s,a,o,r);u!=null&&u.length&&n.push(...u);let c=gGe(s,a,o,r);c!=null&&c.length&&n.push(...c);let h=vGe(s,a,o,r);h!=null&&h.length&&n.push(...h);let d=yGe(s,a,o,r);return d!=null&&d.length&&n.push(...d),n.length&&n.push({update:()=>{s.update()}}),n}function pGe(e,t,i,r){if(e.parameters.type!=="radial")return;let n=t.radial,s=i.radial;if(!s)return;let a=e.parameters.radial,o=[];return pte.forEach(l=>{let u=om(l,a,n??{},s,r);u&&o.push(u)}),o}function mGe(e,t,i,r){if(e.parameters.type!=="linear")return;let n=t.linear,s=i.linear;if(!s)return;let a=[],o=e.parameters.linear;return mte.forEach(l=>{let u=om(l,o,n??{},s,r);u&&a.push(u)}),a}function gGe(e,t,i,r){if(e.parameters.type!=="grid")return;let n=t.grid,s=i.grid;if(!s)return;let a=[],o=e.parameters.grid;return gte.forEach(l=>{let u;l==="count"?u=Nz(l,o,n??{},s,r,!0):u=om(l,o,n??{},s,r),u&&a.push(u)}),a}function vGe(e,t,i,r){if(e.parameters.type!=="toObject")return;let n=t.toObject,s=i.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return vte.forEach(l=>{let u;l==="count"?u=Ba(l,o,n??{},s,r,!0):u=om(l,o,n??{},s,r),u&&a.push(u)}),a}function yGe(e,t,i,r){if(!e.parameters.randomness)return;let n=t.randomnessObject,s=i.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return yte.forEach(l=>{let u=om(l,o,n??{},s,r);u&&a.push(u)}),a}function xGe(e,t){return{update:()=>{e instanceof ya&&(e.fill.enabled=t)}}}function bGe(e,t){return{update:()=>{e instanceof ya&&(e.stroke.enabled=t)}}}function _Ge(e,t){return{update:()=>{e instanceof ya&&(e.dropShadow.enabled=t)}}}function wGe(e,t){return{update:()=>{e instanceof ya&&(e.innerShadow.enabled=t)}}}function EGe(e,t){return{update:()=>{e instanceof ya&&(e.backgroundBlur.enabled=t)}}}function SGe(e,t){return{update:()=>{e instanceof ya&&(e.layerBlur.enabled=t)}}}function TGe(e,t,i,r,n){let s=[],a,o,l,u,c,h,d,f,m,g,y,x,w,b,C;if("width"in e&&(a=Ba("width",e,t,i,n),a&&s.push(a)),"height"in e&&(o=Ba("height",e,t,i,n),o&&s.push(o)),e instanceof ya||e instanceof Oh){let A={...t.fill},E={...i.fill};A.enabled!==void 0&&A.enabled!==E.enabled&&(s.push(xGe(e,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}})),l=kS("color",e.fill,A,E,n),l&&s.push(l)}if(e instanceof ya){let A={...t.stroke},E={...i.stroke};(A.enabled||E.enabled)&&(s.push(bGe(e,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}})),u=kS("color",e.stroke,A,E,n),u&&s.push(u),c=Ba("thickness",e.stroke,A,E,n),c&&s.push(c)}if(e instanceof ya){let A={...t.dropShadow},E={...i.dropShadow};(A.enabled||E.enabled)&&(s.push(_Ge(e,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}})),h=kS("color",e.dropShadow,A,E,n),h&&s.push(h),d=Ba("blurRadius",e.dropShadow,A,E,n),d&&s.push(d),m=Ba("spread",e.dropShadow,A,E,n),m&&s.push(m),f=PA("offset",e.dropShadow,A,E,n),f&&s.push(f)}if(e instanceof ya){let A={...t.innerShadow},E={...i.innerShadow};(A.enabled||E.enabled)&&(s.push(wGe(e,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}})),g=kS("color",e.innerShadow,A,E,n),g&&s.push(g),y=Ba("blurRadius",e.innerShadow,A,E,n),y&&s.push(y),w=Ba("spread",e.innerShadow,A,E,n),w&&s.push(w),x=PA("offset",e.innerShadow,A,E,n),x&&s.push(x)}if(e instanceof ya||e instanceof Oh){let A={...t.backgroundBlur},E={...i.backgroundBlur};(A.enabled||E.enabled)&&(s.push(EGe(e,!0)),A.enabled||Object.assign(A,{enabled:!0,radius:0}),E.enabled||Object.assign(E,{enabled:!0,radius:0})),b=Ba("radius",e.backgroundBlur,A,E,n),b&&s.push(b)}if(e instanceof ya){let A={...t.layerBlur},E={...i.layerBlur};(A.enabled||E.enabled)&&(s.push(SGe(e,!0)),A.enabled||Object.assign(A,{enabled:!0,radius:0}),E.enabled||Object.assign(E,{enabled:!0,radius:0})),C=Ba("radius",e.layerBlur,A,E,n),C&&s.push(C)}if(e instanceof Oh||e instanceof dw){let A=Nz("cornerRadius",e,t,i,n);A&&s.push(A)}return s}function V7(e,t,i,r,n){let s=[];return e.data.visible&&s.push(...hGe(e,t,i,n,r)),e instanceof Ta?s.push(...TGe(e,t,i,n,r)):(e.data.visible&&s.push(...fGe(e,t,i,r)),mc(e)?(e instanceof Os&&e.data.visible&&s.push(...J7e(e,t,i,r)),e.data.visible&&s.push(...tGe(e,t,i,r))):c8e(e)?e.data.visible&&s.push(...eGe(e,t,i,r)):u8e(e)&&s.push(...$7e(e,t,i,r))),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,a)})},end:a=>{s.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,a)})}}:void 0}var H7=new q;function kz(e,t,i=!1){var s;let r=[],n=a=>{let o=a.data;delete a.states,a.currentState=null,a.reversibleToState=null,a.currentTransitionEvent=null;for(let l of o.states){let u={...l.data};a.states||(a.states={}),a.states[l.id]=Eg.patch(o,u)}G7(e.scene,a,null,t,o.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),W7(e)};e.scene.traverse2D(n),e.traverseChildren(a=>{var c,h,d,f,m,g;if(i&&((c=a.rigidBody)==null||c.setTranslation(a.position0,!0),(h=a.rigidBody)==null||h.setRotation(a.rotation0,!0),(d=a.rigidBody)==null||d.setLinvel(H7,!0),(f=a.rigidBody)==null||f.setAngvel(H7,!0)),!wr.is(a))return;let o=a.uuid,l=a.data;if(delete a.states,a.uuid===m1)return;let u=!1;r.some(y=>{var x;return(x=e.scene.find(o))==null?void 0:x.isDescendantOf(y)})?u=!0:((m=l.physics)==null?void 0:m.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&r.push(o),a.data=l,a.currentState=null,a.reversibleToState=null,a.currentTransitionEvent=null;for(let y of l.states){let x={...y.data};e.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||u)&&(y.data.position!==void 0&&delete x.position,y.data.rotation!==void 0&&delete x.rotation,y.data.hiddenMatrix!==void 0&&delete x.hiddenMatrix),a.states||(a.states={}),a.states[y.id]=bg.patch(l,x)}G7(e.scene,a,null,t,l.events.find(y=>y.data.type==="Follow"||y.data.type==="LookAt")!==void 0),a instanceof fo&&a.frame&&(a.frame.traverse(y=>n(y)),(g=a.uiCanvas)==null||g.applySize())}),W7(e),e.frame&&(e.frame.traverse(a=>n(a)),(s=e.uiCanvas)==null||s.applySize())}function W7(e){e.traverseEntity(t=>{for(let i of t.data.events){let r=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":r.push(...i.data.actions);break;case"GameControl":for(let n of Object.values(i.data.gameActions))r.push(...n);break;case"DragDrop":r.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":r.push(...i.data.inActions,...i.data.outActions);break}for(let n of r)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=e.scene.find(n.data.object);s&&(s.visible=!1)}}})}function G7(e,t,i,r,n=!1){if(t instanceof Os&&!(t instanceof Jg)&&t.removeInteractionGeometry(r),t instanceof Ta?t.changeSelectedState(i,{shared:r},n):t.changeSelectedState(i,{scene:e,shared:r},n),t instanceof Os&&t.updateGeometryGroupsIfNeeded(),t instanceof go&&t.updateCameraState(t.dataPatched,{scene:e,shared:r}),!(t instanceof Ta)){if(t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}}function qre(e){let t;if(e.easing===5){let{control1:i,control2:r}=e;t=`cubicBezier(
			${i[0]}, ${i[1]}, ${r[0]}, ${r[1]}
		)`}else if(e.easing===6){let{mass:i,stiffness:r,damping:n,velocity:s}=e;t=`spring( ${i}, ${r}, ${n}, ${s} )`}else{let i;switch(e.easing){case 0:i=np.linear;break;case 1:i=np.ease;break;case 2:i=np.easeIn;break;case 3:i=np.easeOut;break;case 4:i=np.easeInOut;break;default:i=np.linear}let[r,n,s,a]=i;t=`cubicBezier( ${r}, ${n}, ${s}, ${a} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function SN(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var CGe={type:"beginState"},AGe={type:"completeState",isfromEntity:!1},q7=class{constructor(e,t,i,r,n,s){if(this.object=e,this.data=r,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object instanceof Ta||this.object.traverseEntity(o=>{o!==this.object&&o instanceof go&&o.dispatchEvent(CGe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object instanceof Ta||this.object.traverseEntity(o=>{o!==this.object&&o instanceof go&&o.dispatchEvent(AGe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=V7(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=NT(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=NT(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(i===void 0)throw new Error("Missing property");{let a=NT(this.object,i);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...SN(r),...qre(r),change:this.onChange},this.callback=V7(this.object,t===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Yre=class extends qa{constructor(e,t,i,r,n){var a;if(super(),this.eventType=e,this.data=t,this.page=i,this.shared=r,this.condition=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var o;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((o=this.timeline)==null||o.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let s=this.page.scene.find(t.object)??((a=this.page.uiCanvas)==null?void 0:a.find(t.object))??this.page.scene.find2DInUIObjects(t.object);if(!s)throw new Error("Missing property");if(!s.states)throw new Error("Missing property");if(this.object=s,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return((e=this.timeline)==null?void 0:e.paused)===!1}get changeBegan(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=NT(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&V9(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:i=!1}={}){var r,n,s,a;try{let o=SN(this.data.tweens[0].data);i&&typeof o.loop=="number"&&o.loop--,(r=this.timeline)==null||r.pause(),this.timeline=Gre.timeline({autoplay:!1,...o,...o.loop===!0||o.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(u=>u==null?void 0:u.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let u=l===-1?0:l;for(let c=u;c<this.data.tweens.length-1;c++){let h=this.data.tweens[c],d=this.data.tweens[c+1],f;c===u&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.changeBegan)===!0)?(f=void 0,this.object instanceof go&&(this.object.wasMovedByUser=!1)):f=h.data.state===void 0?this.currentState:h.data.state;let m=new q7(this.object,f,d.data.state===void 0?this.currentState:d.data.state,d.data,this.shared,this.data.allowSlerp??!1);l!==-1&&c===u&&Object.assign(m.params,{startOnceDelay:0}),this.tweens[c]=m,this.timeline.add(m.params,this.timeline.duration+(c===u?o.delay:0))}this.timeline.duration+=o.endDelay}else{let u=l===-1?this.data.tweens.length-1:l+1;for(let c=u;c>0;c--){let h=this.data.tweens[c],d=this.data.tweens[c-1],f;c===u&&(this.object.wasMovedByUser===!0||((s=this.object.previousAction)==null?void 0:s.changeBegan)===!0)?(f=void 0,this.object instanceof go&&(this.object.wasMovedByUser=!1)):f=h.data.state===void 0?this.currentState:h.data.state;let m=new q7(this.object,f,d.data.state===void 0?this.currentState:d.data.state,h.data,this.shared,this.data.allowSlerp??!1);l!==-1&&c===u&&Object.assign(m.params,{startOnceDelay:0}),this.tweens[c-1]=m,this.timeline.add(m.params,this.timeline.duration+(c===u?o.endDelay:0))}this.timeline.duration+=o.delay}}catch(o){o instanceof Error&&console.error(o.message)}((a=this.object.previousAction)==null?void 0:a.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(bn(this.shared,this.condition)===!1||V9(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=SN(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay+e)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Ta?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(bn(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(bn(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function NT(e,t){var n;let i,r;if(typeof t=="string"?(i=t,r=(n=e.states)==null?void 0:n[i]):t===null&&(i=null,r=e.data),!(i===void 0||r===void 0))return{id:i,data:r}}var MGe={type:"beginState"},Y7={type:"completeState",isfromEntity:!1},X7={type:"requestRender"},Xre=class extends qa{constructor(e,t,i,r){super(),this.data=e,this.page=t,this.shared=i,this.condition=r,this.toggleIsForward=!1,this.posStart=new q,this.posEnd=new q,this.qStart=new Si,this.qEnd=new Si,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let i={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=Gre({targets:i,t:1,...qre(this.data),update:()=>{i.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(MGe));let r=this.page.activeCamera;r.position.lerpVectors(this.posStart,this.posEnd,i.t),r.quaternion.slerpQuaternions(this.qStart,this.qEnd,i.t),r.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*i.t,r.wasMovedBySwitchCameraAction=!0,r.updateMatrix(),r.updateMatrixWorld(),r.updateProjectionMatrix(),r.dispatchEvent(X7),i.t===1&&r.dispatchEvent(Y7)}})}switchCamera(e){let t=this.page.activeCamera,i=this.page.scene.find(e);if(!i||!i.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(i),t.dispatchEvent({type:"cameraChange",camera:i})}play(){if(bn(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,i;if(bn(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{this.playing?((t=this.animation)==null||t.pause(),this.toggleIsForward=e??!this.toggleIsForward,this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var r,n;this.toggleIsForward=e??!this.toggleIsForward,this.data.animate?((r=this.animation)==null||r.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(Y7),this.page.activeCamera.dispatchEvent(X7))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function Kre(e){let t=e==null?void 0:e.tracks.filter(i=>i.ValueTypeName==="vector"||i.ValueTypeName==="quaternion").map(i=>i.times.length);if(t!=null&&t.length){let i=ize(t);return i&&i>2?i:2}return 2}var $re=class extends qa{constructor(e,t,i,r,n){var l,u,c;super(),this.data=e,this.page=t,this.animationControls=i,this.shared=r,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let s=e.object,a=t.scene.find(e.object);a&&Array.isArray(a.identity)&&(s=a.identity[0]),this.data={...e,object:s};let o=this.animationControls.clipIdToAction[e.clipId+"/"+s];if(this.duration=((l=o==null?void 0:o.getClip())==null?void 0:l.duration)??1,this.data.crop2){let h=Kre(o==null?void 0:o.getClip());this.leftFrameTime=this.data.crop2[0]/(h-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(h-1)*this.duration}else{let h=(c=(u=o==null?void 0:o.getClip())==null?void 0:u.tracks[0])==null?void 0:c.times.length;h&&h>1?(this.leftFrameTime=this.data.crop[0]/h*this.duration,this.rightFrameTime=this.data.crop[1]/h*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){if(bn(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([r,n])=>{let s=r.split("/")[1];this.threeAnimAction!==n&&s===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((i=this.threeAnimAction)==null||i.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=Xt.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(bn(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let r=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,s])=>{let a=n.split("/")[1];this.threeAnimAction!==s&&a===r&&s.isRunning()&&(t?s.fadeOut(.2):s.stop())}),t&&((i=this.threeAnimAction)==null||i.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},Zre=class{constructor(e,t,i,r,n){this.data=e,this.page=t,this.eventManager=i,this.shared=r,this.condition=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(bn(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target||t.data.uiScene))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),kz(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},Qre=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=bn(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=Jte(this.data.expression,this.shared,ja.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},Jre=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r,this.timeoutId=null}dispatchInner(){if(bn(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},PGe=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r}dispatch(){if(bn(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{var i;this.shared.getVariable(e);let t=(i=this.shared.data.variables.data(e))==null?void 0:i.value;t!==void 0&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(iN(e))})}dispose(){}},DGe=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r}dispatch(){var e;if(bn(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&((e=this.shared.getUserAPI(this.data.userAPIId))==null||e.callUserAPI(this.shared))}dispose(){}};function bn(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let i=Jte(t.expression,e,"boolean");return t.negate?!i:!!i}function Ns(e,t,i,r,n,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},o=l=>({id:u,data:c})=>{try{c.type==="Audio"?ro[e.type].includes("Audio")&&a.Audio.push(new Tre(u,c,s,r,l)):c.type==="Video"&&!(s instanceof Ta)?ro[e.type].includes("Video")&&a.Video.push(new tne(u,c,s,r,l)):c.type==="Particles"?ro[e.type].includes("Particles")&&a.Particles.push(new Cre(c,i,r,l)):c.type==="Link"?ro[e.type].includes("Link")&&a.Link.push(new g7e(c,n.controlsManager,r,l)):c.type==="Create"?ro[e.type].includes("Create")&&a.Create.push(new ine(c,i,n.controlsManager,r,l)):c.type==="Destroy"?ro[e.type].includes("Destroy")&&a.Destroy.push(new Are(c,i,n.controlsManager,r,l)):c.type==="Reset"?ro[e.type].includes("Reset")&&a.Reset.push(new Mre(c,i,r,n,l)):c.type==="Transition"?ro[e.type].includes("Transition")&&a.Transition.push(new Yre(e.type,c,i,r,l)):c.type==="SwitchCamera"?ro[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new Xre(c,i,r,l)):c.type==="SceneTransition"?ro[e.type].includes("SceneTransition")&&a.SceneTransition.push(new Zre(c,i,n,r,l)):c.type==="Animation"?ro[e.type].includes("Animation")&&a.Animation.push(new $re(c,i,n.animationControls,r,l)):c.type==="SetVariable"?ro[e.type].includes("SetVariable")&&a.SetVariable.push(new Qre(c,i,r,l)):c.type==="DynamicVariablePlay"?ro[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new Jre(c,i,r,l)):c.type==="Conditional"?ro[e.type].includes("Conditional")&&(c.ifActions.forEach(o({expression:c.condition,negate:!1})),c.elseActions.forEach(o({expression:c.condition,negate:!0}))):c.type==="ClearLocalStorage"?ro[e.type].includes("ClearLocalStorage")&&a.ClearLocalStorage.push(new PGe(c,i,r,l)):c.type==="UserAPI"&&ro[e.type].includes("UserAPI")&&a.UserAPI.push(new DGe(c,i,r,l))}catch{}};return t.forEach(o()),a}function Ea(e){Object.values(e).forEach(t=>{t.forEach(i=>{(i instanceof Tre||i instanceof tne||i instanceof Cre||i instanceof $re||i instanceof Yre||i instanceof ine||i instanceof Are||i instanceof Xre||i instanceof Zre||i instanceof Mre||i instanceof Qre||i instanceof Jre)&&i.dispose()})})}function IGe(e,t){let i;if("material"in e){let r=e.material;Array.isArray(r)?i=e.material[0].layers.find(n=>n.uuid===t):i=e.material.layers.find(n=>n.uuid===t)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var ene=new Map,Pb=new Map,vy=class{constructor(e,t,i){this.data=t,this.delay=0,this.status="stopped";let{layerId:r,loop:n,volume:s,delay:a}=t;if(this.object=i,r===void 0)throw new Error("Missing property");let o=IGe(i,r);o&&(this.videoElement=o,this.videoElement.loop=n===1/0,sw&&(this.videoElement.autoplay=!0),s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),Pb.has(i.uuid)?Pb.get(i.uuid).push(this):Pb.set(i.uuid,[this]),ene.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(r=>{}).catch(r=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},TN=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=ene.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=Pb.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let e=[...Pb.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},tne=class{constructor(e,t,i,r,n){if(this.data=t,this.shared=r,this.condition=n,t.interaction==="play")this.interaction=new vy(e,t,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new TN(t);else throw new Error("Missing property")}dispatchBasic(){if(bn(this.shared,this.condition)===!1)return!1;this.interaction instanceof vy?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(bn(this.shared,this.condition)===!1)return!1;this.interaction instanceof vy?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},K7=(()=>{let e,t,i,r;function n(o){!e&&!$7()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),o&&(t=o,r=o.requestRender)}function s(o){let l=i?o-i:0,u=t.sharedGameControlGlobals.createdObjects,c=t.sharedGameControlGlobals.nCreatedPerAction,h=u.length,d=0;for(;d<h;){let f=u[d];f.userData.createdTime===void 0&&(f.userData.createdTime=o),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&o-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&c[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),r()),d++):(c[f.userData.actionId]>f.userData.quantity&&c[f.userData.actionId]--,u.splice(d,1),f.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&f.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(f.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody)):(f.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(m=>m.bvhGeometry!==void 0)),h--,r())}e=d>0?requestAnimationFrame(s):void 0,i=d>0?o:void 0}function a(){$7()?e&&(cancelAnimationFrame(e),e=void 0,i=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),n})();function $7(){return!!document&&document.hidden}var Z7=new Si,OGe=new q,RGe=new q,ine=class{constructor(e,t,i,r,n){this.data=e,this.page=t,this.controlsManager=i,this.shared=r,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=Xt.generateUUID(),this.dispatch=()=>{if(bn(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(bn(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=bze(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let a=new Va(this.object);if(a.playModeVisible=!0,a.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,u=this.page.scene.find(l);u&&(u.updateMatrixWorldSVD(),a.hiddenMatrix.copy(u.matrixWorldRigid))}a.scale.copy(this.object.scale),a.position.fromArray(this.data.position),a.rotation.fromArray(this.data.rotation),a.updateMatrix(),this.page.add(a);let o=this.controlsManager.sharedGameControlGlobals;o.createdObjects.push(a),o.nCreatedPerAction[this.uniqueId]===void 0?o.nCreatedPerAction[this.uniqueId]=1:o.nCreatedPerAction[this.uniqueId]++,a.updateWorldMatrix(!0,!0),a.traverseObject(this.traverseObjectCB),K7(),this.controlsManager.requestRender()},this.traverseObjectCB=a=>{var c,h,d,f;a.hasNonUniformScale&&a.updateMatrixWorldSVD();let o;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(a instanceof Nu)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;o=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof Va)o=a.object;else if(o=a,(c=o.dataPatched.cloner)==null?void 0:c.hideBase)return!0}else{if(a instanceof Nu)return;a instanceof Va?o=a.object:o=a}this.data.destroy==="Time"?a.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(a.userData.quantity=this.data.destroyAfterQuantity,a.userData.actionId=this.uniqueId);let l=new q().fromArray(this.data.velocity),u=o.dataPatched;if(!(u.physics.enabled==="visibility"?!u.visible:!u.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(a,o,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((h=a.rigidBody)==null||h.collider(0).setActiveEvents(1),a.userData.hasCollisionDestroy=!0),a.matrixWorld.decompose(OGe,Z7,RGe),l.applyQuaternion(Z7),this.data.velocity.some(m=>m!==0)&&this.data.dynamic&&((d=a.rigidBody)==null||d.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in a.object&&this.controlsManager.addBoundsTree(a),this.data.velocity.some(m=>m!==0)&&this.data.dynamic&&(a.userData.velocity=l)),((f=o.dataPatched.physics)==null?void 0:f.fusedBody)===!0))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");K7(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},rne=200,sO=.02,aO=.3,LGe=65;new q;var Q7=new q,J7=new q,NGe=new q,Ro=new q,fl=new q,qf=new q,oO=new Pt,eG=new Pt,kGe=new Pt;new Pt;var ac=new Si,Sd=new Si,Jc=new Ks(0,0,0,"YXZ"),BGe=new q(1,0,0),oc=new q(0,1,0),zGe=new q(0,0,1),tG=new q(1,1,1);new Rl;var FGe=1,UGe=.025,jGe=16e-6,iG=12,VGe=20,da=new zu,_u=new xs,HGe={type:"requestRender"},WGe={type:"updateMatrix"},rG=Math.PI/6,CN=class extends qa{constructor(e,t,i,r,n,s,a,o,l){var m;super(),this.object=e,this.domElement=t,this.data=i,this.gloabalPhysics=r,this.controlsManager=n,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new Pt,this.target0=new q,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=rne,this.euler0=new Ks(0,0,0,"YXZ"),this.position0Cam=new q,this.quat0Cam=new Si,this.scale0Cam=new q,this.hiddenMatrix0Cam=new Pt,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new zu(new q(0,-40,0),new q(0,40,0)),matrix:new Pt,position:new q,rotation:new Si},this.euler=new Ks(0,0,0,"YXZ"),this.eulerDelta=new q,this.lastPosition=new q,this.lastCameraQuaternion=new Si,this.lastCameraPosition=new q,this.PI_2=Math.PI/2,this.prevMouse=new Ie,this.velocityTarget=new q,this.velocity=new q,this.directionXZ=new q,this.rotVelocityStick=new q,this.rotVelocityTarget=new q,this.rotVelocity=new q,this.rotDirection=new q,this.nonColliderRotOffset=new Pt,this.nonColliderPosOffset=new Pt,this.firstPointerId=-1,this.rot=new q,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new Pt,this.objectToTarget=new q,this.objectToTarget0=new q,this.objectToCamXZ=new q,this.objectToCamXZ0=new q,this.targetToCamera=new q,this.targetToCamera0=new q,this.cameraPolarAxis0=new q,this.targetPos=new q,this.targetQuat=new Si,this.lerpFactorPos=new q().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Si,this.objXZQuatInv=new Si,this.objXZRotMat=new Pt,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new q,this.pushedVelocity=new q,this.groundYRotation=0,this.objectRealQuat=new Si,this.colliderWorldQuat=new Si,this.groundNormal=new q,this.groundTilt=new Si,this.groundTiltInv=new Si,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new q,this.quaternion=new Si,this.scale=new q,this.initialAction=!0,this.onPointerDown=g=>{var y;!(g.target===this.domElement||g.target instanceof HTMLElement&&g.target.tagName==="SPLINE-VIEWER"&&((y=g.target.shadowRoot)!=null&&y.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=g.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!Jl&&!A9&&this.domElement.requestPointerLock(),this.prevMouse.set(g.clientX,g.clientY))},this.onPointerUp=g=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),g.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=g=>{if(g.pointerId!==this.firstPointerId)return;let y=g.clientX-this.prevMouse.x,x=g.clientY-this.prevMouse.y;this.prevMouse.set(g.clientX,g.clientY),g.pointerType==="mouse"&&this.rotBy!=="keys"&&(A9&&Dze<15.5&&!Jl?(this.eulerDelta.y=-y*this.mouseOrbitSensitivity,this.eulerDelta.x=-x*this.mouseOrbitSensitivity):(this.eulerDelta.y=-g.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-g.movementY*this.mouseOrbitSensitivity)),g.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-y*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-x*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=g=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?CN.isLocked=!0:CN.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let g in this.movementState)this.movementState[g]=0},this.onKeyDown=g=>{!(g.target instanceof HTMLInputElement)&&(g.code==="ArrowLeft"||g.code==="ArrowUp"||g.code==="ArrowRight"||g.code==="ArrowDown"||g.code==="Space")&&g.preventDefault();for(let y of this.keyAssignments)if(g.key.toUpperCase()===y[1]||g.key===y[1]){this.movementState[y[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=g=>{for(let y of this.keyAssignments)if(g.key.toUpperCase()===y[1]||g.key===y[1]||g.code.slice(3,g.code.length).toUpperCase()===y[1]){this.movementState[y[0]]=0;break}},this.copyVRGamePadValues=(g,y)=>{for(let x=2;x<4;x++){let w=g.axes[x];y===0?x===2?this.movementState.movePosX=w:this.movementState.movePosZ=w:(g.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,x===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(w)>=.3&&(this.vrEulerYOffset+=w<0?1:-1),this.movementState.rotPosY=w):this.moveMode==="fly"&&(this.movementState.moveNegY=w))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let u=this.euler0.clone(),c=u.y;if(this.objectRealQuat.copy(this.quaternion),u.y=0,this.quaternion.setFromEuler(u),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),u.set(0,c,0),this.quaternion.setFromEuler(u),this.rot.setFromEuler(u),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((m=this.camera)==null?void 0:m.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let g=new q(0,0,-1).applyQuaternion(this.camera.quaternion),y=new q().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(y),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let x,w;Math.abs(g.y)<1e-6?(y.y=0,g.y=0,w=y.projectOnVector(g)):y.y/g.y>0?w=g.multiplyScalar(y.y/g.y):w=g.multiplyScalar(y.length()),this.targetToCamera0.copy(w).negate(),x=this.camera.position.clone().add(w),this.objectToTarget0.subVectors(x,this.position);let b=new Ks().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-b.x,b.x=0,b.z=0,b.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(b)}if(this.object instanceof go&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*FGe,this.speedOrbit=(i.speedRotate??100)*UGe,this.mouseOrbitSensitivity=(i.speedRotate??100)*jGe,this.keyAssignments=i.keyAssignments.map(g=>{let y=[g[0],g[1]];return y[1]==="▲"?y[1]="ArrowUp":y[1]==="◀"?y[1]="ArrowLeft":y[1]==="▼"?y[1]="ArrowDown":y[1]==="▶"?y[1]="ArrowRight":y[1]==="⇧"?y[1]="Shift":y[1]==="↵"?y[1]="Enter":y[1]==="Space"?y[1]=" ":y[1]==="⌘"?y[1]="Meta":y[1]==="Ctrl"?y[1]="Control":y[1]==="Esc"&&(y[1]="Escape"),y}),i.rotBy==="mouse"){let g;g=this.keyAssignments.findIndex(y=>y[0]==="rotNegX"),g!==-1&&(this.keyAssignments[g][1]=""),g=this.keyAssignments.findIndex(y=>y[0]==="rotPosX"),g!==-1&&(this.keyAssignments[g][1]=""),g=this.keyAssignments.findIndex(y=>y[0]==="rotPosY"),g!==-1&&(this.keyAssignments[g][1]=""),g=this.keyAssignments.findIndex(y=>y[0]==="rotNegY"),g!==-1&&(this.keyAssignments[g][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??Fy.defaultData.gravity)*iG,this.usePhysics=this.gloabalPhysics.usePhysics??Fy.defaultData.usePhysics,this.jumpPower=i.jumpPower*VGe,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??cA.defaultDataThirdPerson.orientWith,this.slopeThresh=LGe*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*sO/this.pixelsPerMeter,this.stepThresh=i.collider.height*aO/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*sO/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*aO/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*sO/this.pixelsPerMeter,this.stepThresh=i.collider.height*aO/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let h=new q().fromArray(i.collider.position),d=new Si().setFromEuler(new Ks().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(h).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(h,d,tG),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=i.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=i.runMultiplier??2;let f=i.navmesh.destinationHelperRadius*2;if(f>0){let g=new oi;g.push({fi:0,data:{...ma.defaultData("light","phong"),alpha:0},id:"layer1"}),g.push({fi:0,data:{...ma.defaultData("color"),color:i.navmesh.destinationHelperColor,alpha:i.navmesh.destinationHelperColor.a},id:"layer2"});let y=new oz({layers:g},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new dn(Ite.create({parameters:{width:f,height:f/10,hollow:.7}}),y),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new Ks().setFromQuaternion(this.quaternion,"YXZ"),i=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,i,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof go?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},uA.list.forEach(i=>{this.actions[i]=Ns({...e,disabled:!1,type:"GameControl"},e.gameActions[i],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Ea(this.actions.idle),Ea(this.actions.move),Ea(this.actions.run),Ea(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Ro.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,i){var o,l,u,c,h,d,f,m,g;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let r=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=r*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let y=fl.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*iG),1)*(this.gravity>0?1:-1):this.velocity.y)*r,0).divideScalar(this.pixelsPerMeter),x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,y,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(x){this.onObject=!0,this.groundNormal.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=x.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let w=x.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===w&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(Ro,Sd,fl),this.groundVelocity.subVectors(Ro,b.prevT),this.object.getWorldPosition(fl).add(this.collider.position).sub(Ro),this.groundYRotation=Jc.setFromQuaternion(Sd).y-b.prevR.y,qf.copy(fl).applyAxisAngle(oc,this.groundYRotation),this.groundVelocity.add(qf.sub(fl)).divideScalar(r);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let y=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let x=Ro.subVectors(this.path[1],this.position),w=fl.subVectors(this.path[1],this.path[0]);x.dot(w)<0?this.path.shift():(this.directionXZ.x=w.x,this.directionXZ.z=w.z),y.opacity=y.userData.opacity0}else y.opacity-=.05*y.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=NGe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let y=fl.copy(a);y.y=0,a.set(0,a.y,y.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let y=Ro;this.camera.getWorldDirection(y);let x=qf.copy(oc).multiplyScalar(y.dot(oc));y.sub(x);let w=fl.copy(this.directionXZ);w.x*=-1,this.rot.y=y.angleTo(w)*(y.cross(w).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Jc.setFromVector3(this.rot),this.moveMode==="walk"&&(Jc.x=0),a.applyEuler(Jc),s&&(Sd.setFromUnitVectors(oc,this.groundNormal),a.applyQuaternion(Sd)),i){let y=Jc.set(0,this.vrEulerYOffset*rG,0);i.applyEuler(y),a.x+=i.x,a.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*r}if(this.usePhysics===!0){let y=fl;this.pushedVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim){let w=qf.setFromMatrixPosition(x.matrixWorld).sub(x.prevT).divideScalar(r).divideScalar(this.pixelsPerMeter),b=x.rigidBody.collider(0).castCollider(w,this.object.rigidBody.collider(0),Ro.copy(a).divideScalar(this.pixelsPerMeter),r,!1);w.multiplyScalar(this.pixelsPerMeter);let C=wr.is(x)?x:x.object;if(b!==null&&this.lastHitObj!==C){let A;x instanceof Va&&(A=x);let E=this.sharedGameControlGlobals.entityToCollisionEvents[C.uuid];if(E)for(let _ of E)_.data.target==="character"&&(_.dispatch(A),C.dispatchEvent(MN));this.lastHitObj=C}if(b!==null){this.pushedVelocity.copy(w),y.copy(b.normal1).applyQuaternion(x.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let x=y.dot(a);x<0&&a.addScaledVector(y,-x),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(r),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*r,this.euler.y+=this.rotVelocity.y*r+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*r),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(oc,this.euler.y-this.euler0.y);let y=fl.copy(this.objectToCamXZ).normalize(),x=qf.copy(a).multiplyScalar(r);x.y=0;let w=x.sub(Ro.copy(y).multiplyScalar(x.dot(y))).cross(y).y;this.euler.y-=Math.atan2(w,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*r+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=Xt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=Xt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=Xt.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Jc.copy(t),Jc.y=0):(Jc.copy(this.euler),Jc.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Jc)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*rG),ac.setFromAxisAngle(BGe,this.rot.x),Sd.setFromAxisAngle(oc,this.rot.y),Sd.multiply(ac),ac.setFromAxisAngle(zGe,this.rot.z),Sd.multiply(ac),this.quaternion.copy(Sd),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let y=fl.copy(a).multiplyScalar(r/this.pixelsPerMeter),x=null;this.didHit=!1;let w=new q;for(let b=0;b<5;b++){let C=y.length(),A=qf.copy(y).normalize();if(x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(w),this.colliderWorldQuat,A,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,C,!1,24,void 0,void 0,this.object.rigidBody),x!==null){this.didHit=!0;let E=this.sharedGameControlGlobals.colliderToEntity.get(x.collider.handle);if(E!==this.lastHitObj&&b===0){this.lastHitObj=E;let D=this.sharedGameControlGlobals.entityToCollisionEvents[E==null?void 0:E.uuid];if(D){for(let k of D)if(k.data.target==="character"){let B=((c=this.sharedGameControlGlobals.rapierWorld)==null?void 0:c.getCollider(x.collider.handle))._parent,z;if(E.cloner){for(let W of E.cloner.children)if(W.rigidBody===B){z=W;break}}k.dispatch(z),E.dispatchEvent(MN)}}}let _=Q7.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat),P=J7.copy(A).multiplyScalar(x.toi).dot(_),I=x.toi;if(I===0&&(this.position.y+=this.offset*this.pixelsPerMeter),P>this.offset&&(I=x.toi*(P-this.offset)/P,w.addScaledVector(A,I)),y.copy(A).multiplyScalar(C-I),Math.acos(-_.y)>this.slopeThresh){let D=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(w),k=qf.copy(x.witness2).applyQuaternion(this.colliderWorldQuat);k.y=0;let B=D.add(k);B.y+=this.stepThresh;let z=this.sharedGameControlGlobals.rapierWorld.castShape(B,this.colliderWorldQuat,y,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);z!==null&&z.toi===0&&(_.y=0,_.normalize())}y.addScaledVector(_,-y.dot(_))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),w.add(y);break}}this.position.addScaledVector(w,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(Ro.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(ac.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let y=this.onObject?1:5,x=a.multiplyScalar(r/y);for(let w=0;w<y;w++)this.position.add(x),this.collisionAdjustment(r/y)}else this.position.addScaledVector(a,r);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let y=this.objectToTarget.add(this.position),x=this.targetToCamera.add(y);oO.lookAt(x,y,oc).setPosition(x),oO.decompose(this.targetPos,this.targetQuat,Ro),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=Xt.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=Xt.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(WGe),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((g=(m=this.navMeshPathDest)==null?void 0:m.material)==null?void 0:g.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(HGe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=ac.setFromAxisAngle(oc,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?Xt.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=Xt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=Xt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=Ro.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(e);let r=Sd.setFromAxisAngle(i,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(r)}groundTiltAdjustment(e){oc.angleTo(e)*180/Math.PI<15||oc.angleTo(e)*180/Math.PI>85?ac.identity():ac.setFromUnitVectors(oc,e),this.groundTilt.slerp(ac,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var n;let t=J7.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=oO.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Ro,ac,fl).compose(Ro,ac,tG);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;_u.makeEmpty(),s.updateMatrixWorldSVD();let a=s.matrixWorldRigid,o=eG.copy(a).invert(),l=kGe.copy(eG).multiply(i);da.copy(this.collider.segment),da.start.applyMatrix4(l),da.end.applyMatrix4(l);let u=Q7.copy(this.position).applyMatrix4(o);_u.expandByPoint(da.start),_u.expandByPoint(da.end),_u.min.addScalar(-this.collider.radius),_u.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(c){return c.distanceToPoint(da.end)},intersectsBounds:c=>c.intersectsBox(_u),intersectsTriangle:c=>{let h=Ro,d=fl,f=c.closestPointToSegment(da,h,d);if(f<this.collider.radius){let m=this.collider.radius-f,g=d.sub(h).normalize(),y=qf.copy(u);y.addScaledVector(g,m);let x=y.applyMatrix4(a).sub(this.position);t.add(x),da.start.addScaledVector(g,m),da.end.addScaledVector(g,m)}}})}),_u.makeEmpty(),da.copy(this.collider.segment),da.start.applyMatrix4(i),da.end.applyMatrix4(i),_u.expandByPoint(da.start),_u.expandByPoint(da.end),_u.min.addScalar(-this.collider.radius),_u.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(da.end)},intersectsBounds:s=>s.intersectsBox(_u),intersectsTriangle:s=>{let a=Ro,o=fl,l=s.closestPointToSegment(da,a,o);if(l<this.collider.radius){let u=this.collider.radius-l,c=o.sub(a).normalize();this.alignToGround&&this.groundTiltAdjustment(c),t.addScaledVector(c,u),da.start.addScaledVector(c,u),da.end.addScaledVector(c,u)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let r=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(r),this.position.add(t)}},nne=CN;nne.isLocked=!1;var GGe=nm(lJ());function sne(e){let t=e.elements,i=t[0]**2+t[1]**2+t[2]**2,r=t[4]**2+t[5]**2+t[6]**2,n=t[8]**2+t[9]**2+t[10]**2,s=t[0]**2+t[4]**2+t[8]**2,a=t[1]**2+t[5]**2+t[9]**2,o=t[2]**2+t[6]**2+t[10]**2,l=1e-8;return i<l||r<l||n<l||s<l||a<l||o<l}function Fd(e,t){let i=new ai;if(t&&sne(t))return i.setAttribute("position",new Vt([],3)),i.setIndex([]),i;if(!e.getAttribute("position"))return i.setAttribute("position",new Vt([],3)),i.setIndex([]),i;let{positions:r,triIndices:n}=UM(e.getAttribute("position"),e.getIndex());return i.setAttribute("position",new Vt(r,3)),i.setIndex(n),t&&i.applyMatrix4(t),i}var qGe=new Pt,YGe=new Pt,eh=[[0,0,0],[0,0,0],[0,0,0]];function ane(e){let t=e.elements;eh[0][0]=t[0],eh[0][1]=t[4],eh[0][2]=t[8],eh[1][0]=t[1],eh[1][1]=t[5],eh[1][2]=t[9],eh[2][0]=t[2],eh[2][1]=t[6],eh[2][2]=t[10];let{u:i,v:r}=(0,GGe.SVD)(eh),n=qGe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=YGe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var XGe=class extends tee{constructor(){super(),this.layers.enable(3),this.layers.enable(8),this.layers.enable(9)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,i=[]){return e.forEach(r=>{r.visible&&this.intersectObject(r,t,i)}),i}createRaycastLineHelper(){let e=new am({color:65280,linewidth:10}),t=new q(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new q(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),r=this.camera.far-this.camera.near,n=new q().addVectors(t,i.multiplyScalar(r)),s=new ai;return s.setFromPoints([t,n]),new RC(s,e)}},one=e=>e instanceof my||e instanceof gy;function KGe(e,t){return e.distance-t.distance}function lne(e,t,i){if(!(!zd(t)||!t.visible)){mc(t)&&t.raycast(e,i);for(let r of t.children)lne(e,r,i)}}function kT(e,t,i,r=!1){if(!r&&!i.some(s=>DA(e,s)!==void 0))return[];let n=[];return t.children.forEach(s=>lne(e,s,n)),n.sort(KGe),n}function AN(e){let t=[];if(e.length){let i=e[0].object;zd(i)&&t.push(i);let r=i.parent;for(;r;)one(r)&&t.push(r),r=r.parent}return t}function Ud(e,t,i,r){let n=e.frame;if(n){let s=t[0]*n.width,a=(1-t[1])*n.height;for(let o of i){let l=o===n.uuid?n:n.find(o);if(l!=null&&l.intersects(s,a))return r(l),!0}}return!1}function DA(e,t){if(mc(t)){if(t.visible){let i=[];return t.raycast(e,i),i.length?i[0]:void 0}}else if(one(t))return une(e,t)}function une(e,t){if(!(!zd(t)||!t.visible)){if(mc(t)){let i=[];if(t.raycast(e,i),i.length)return i[0]}for(let i of t.children){let r=une(e,i);if(r)return r}}}function $Ge(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width*2-1,y:-((t-(i.top+window.scrollY))/i.height)*2+1}}function ZGe(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width,y:1-(t-(i.top+window.scrollY))/i.height}}var QGe=class{constructor(e,t,i,r,n,s,a,o){this.renderer=e,this.publish=t,this.scene=i,this.getCamera=r,this.sharedAssets=n,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new XGe,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var r;let{pageX:t,pageY:i}=((r=e.touches)==null?void 0:r.length)>0?e.touches[0]:e;this.pointerWorld=$Ge(t,i,this._domRect),this.pointerScreen=ZGe(t,i,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},xo=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},Bz=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],cne=e=>{var t;return(t=Bz.find(([i,r])=>r===e))==null?void 0:t[0]},fw=e=>{var t;return(t=Bz.find(([i])=>i===e))==null?void 0:t[1]},JGe=(e,t)=>{let i=cne(e);if(i){let r=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(r,"target",{writable:!1,value:t}),r}},eqe=class extends xo{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var r;if(!e.eventName||!e.target||e.eventName==="Scroll")return;let t=(r=this.splineEvents[cne(e.eventName)])==null?void 0:r[e.target.uuid];if(!t)return;e.eventName==="Scroll"&&e.deltaY!==void 0&&Object.assign(t,{deltaY:e.deltaY});let{domElement:i}=this.eventContext;i.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(t=>{var i,r;if((i=t.data)!=null&&i.events.length){for(let[n,s]of Bz)if(t.data.events.some(a=>a.data.type===s&&!a.data.disabled)){this.objectsPerEvents.has(n)?(r=this.objectsPerEvents.get(n))==null||r.push(t):this.objectsPerEvents.set(n,[t]);let a={id:t.uuid,name:t.name},o=JGe(s,a),l=this.splineEvents[n];l?l[t.uuid]=o:this.splineEvents[n]={[t.uuid]:o}}}}),this.objectsPerEvents.forEach(t=>{t.forEach(i=>{i.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},tqe=class{constructor(e,t,i,r,n,s){if(this.id=e,this.data=t,this.object=i,this.entered=!1,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=Ns(t,t.actions,r,n,s,i)}disconnect(){Ea(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.SwitchCamera.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},iqe=class extends xo{constructor(e,t,i){super(e),this.eventManager=t,this.useForRaycastProperty=i,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=r=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(r);let{raycaster:n,page:s}=this.eventContext,a=kT(n,s,[],!0);this.sceneInterects=a,a.length&&(this.eventContext.sharedAssets.raycastProperty={x:a[0].point.x,y:a[0].point.y,z:a[0].point.z,objX:a[0].object.matrixWorld.elements[12],objY:a[0].object.matrixWorld.elements[13],objZ:a[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{(n.data.type==="MouseDown"||n.data.type==="MousePress")&&(this.onCanvasRaycast(r),n.dispatch())})},this.onCanvasMouseUp=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{n.data.type==="MouseUp"?(this.onCanvasRaycast(r),n.dispatch()):n.data.type==="MousePress"&&n.dispatchRelease()})},this.onMouseDown=r=>{wi.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{wi.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{wi.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{wi.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:n,reverse:s})=>{var o,l,u,c;if(!r||!n)return;let a=fw(r);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(n.dispatchEvent({type:"beginEvent",eventName:a}),(l=(o=this.eventsPerObjects[a])==null?void 0:o[n.uuid])==null||l.forEach(h=>{h.dispatchUserEvent(s)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(n.dispatchEvent({type:"beginEvent",eventName:a}),(c=(u=this.eventsPerObjects[a])==null?void 0:u[n.uuid])==null||c.forEach(h=>{h.dispatchUserEvent()})))}}connect(){var n,s,a,o,l,u;let{page:e,sharedAssets:t,domElement:i}=this.eventContext,r=(c,h)=>{var f,m;if(!((f=c.data)!=null&&f.events.length))return;let d=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let g of d){let y=this.eventsPerObjects[g];if(c.data.events.filter(({data:x})=>x.type===g&&x.disabled!==!0).forEach(({id:x,data:w})=>{try{let b=new tqe(x,w,c,e,t,this.eventManager);b.actions.Video.length&&(this.hasVideoAction=!0),(w.type==="MouseDown"||w.type==="MouseUp"||w.type==="MousePress")&&(w.mode==="Canvas"||w.mode==="Window")?this.canvasMouseEvents.push(b):(y[c.uuid]?y[c.uuid].some(C=>C.id===b.id)||y[c.uuid].push(b):y[c.uuid]=[b],c instanceof Jg&&c.traverseChildren(C=>{var A;if(!C.visible)return!0;C instanceof Os&&((A=C.data.geometry.shapeBlendNode)==null?void 0:A.operation)!==2&&(y[C.uuid]?y[C.uuid].push(b):y[C.uuid]=[b])}))}catch{}}),((m=y[c.uuid])==null?void 0:m.length)&&(this.objectsPerTypes[g].push(c instanceof Ta&&(g==="MouseDown"||g==="MouseUp"||g==="MousePress")?h:c),c instanceof Jg)){let x=this.objectsPerTypes[g];c.traverseChildren(w=>{if(!w.visible)return!0;w instanceof Os&&x.indexOf(w)===-1&&x.push(w)})}}};e.traverseEntity(c=>{var h;(c instanceof fo||c instanceof va)&&((h=c.frame)==null||h.traverse(d=>{r(d,c)})),r(c)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),i.addEventListener("pointerdown",this.onCanvasMouseDown),i.addEventListener("pointerup",this.onCanvasMouseUp),((n=this.objectsPerTypes.MouseDown)!=null&&n.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown)),(s=this.objectsPerTypes.MouseUp)!=null&&s.length&&(this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),(a=this.objectsPerTypes.MousePress)!=null&&a.length&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMousePressRelease)),(o=this.objectsPerTypes.KeyDown)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(l=this.objectsPerTypes.KeyUp)!=null&&l.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(u=this.objectsPerTypes.KeyPress)!=null&&u.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([c,h])=>{h.forEach(d=>{d.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(i=>{i.forEach(r=>{r.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,i])=>{i.forEach(r=>{r.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){var o,l,u,c;let{stopRaycast:t,raycaster:i,page:r,pointerScreen:n}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter(h=>!(h instanceof Ta));if(!(!s.length&&!this.useForRaycastProperty)&&!(r.uiCanvas&&Ud(r,[n.x,n.y],Object.keys(this.eventsPerObjects[e]),h=>{this.handleObjectMouseEventDispatch(h,e)}))){if(t||this.useForRaycastProperty){let h;if(this.sceneInterects===null?h=kT(i,r,a,this.useForRaycastProperty):(h=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&h.length&&(this.eventContext.sharedAssets.raycastProperty={x:h[0].point.x,y:h[0].point.y,z:h[0].point.z,objX:h[0].object.matrixWorld.elements[12],objY:h[0].object.matrixWorld.elements[13],objZ:h[0].object.matrixWorld.elements[14]}),t){let d=[((l=(o=h[0])==null?void 0:o.uv)==null?void 0:l.x)??0,((c=(u=h[0])==null?void 0:u.uv)==null?void 0:c.y)??0];AN(h).forEach(f=>{f instanceof fo&&Ud(f,d,Object.keys(this.eventsPerObjects[e]),m=>{this.handleObjectMouseEventDispatch(m,e)}),this.eventsPerObjects[e][f.uuid]&&this.handleObjectMouseEventDispatch(f,e)})}}t||a.forEach(h=>{var f,m;let d=DA(i,h);d&&(this.handleObjectMouseEventDispatch(h,e),h instanceof fo&&Ud(h,[((f=d==null?void 0:d.uv)==null?void 0:f.x)??0,((m=d==null?void 0:d.uv)==null?void 0:m.y)??0],Object.keys(this.eventsPerObjects[e]),g=>{this.handleObjectMouseEventDispatch(g,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",i=this.objectsPerTypes[t],r=i.filter(s=>!(s instanceof Ta)),n=[];if(i.length){if(!e){let{stopRaycast:s,raycaster:a,page:o,pointerScreen:l}=this.eventContext,u=!1;if(o.uiCanvas&&(u=Ud(o,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),c=>{n.push(c)})),s&&!u){let c=kT(a,o,r);n=AN(c),c.forEach(h=>{var d,f;h.object instanceof fo&&Ud(h.object,[((d=h==null?void 0:h.uv)==null?void 0:d.x)??0,((f=h==null?void 0:h.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),m=>{n.push(m)})})}else r.forEach(c=>{var d,f;let h=DA(a,c);h&&(n.push(c),c instanceof fo&&Ud(c,[((d=h==null?void 0:h.uv)==null?void 0:d.x)??0,((f=h==null?void 0:h.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),m=>{n.push(m)}))})}this._prevObjects.length&&this._prevObjects.forEach(s=>{n.includes(s)||this.handleObjectMouseEventDispatchRelease(s,t)}),n.length&&n.forEach(s=>{this.handleObjectMouseEventDispatch(s,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var i,r;e.dispatchEvent({type:"beginEvent",eventName:t}),(r=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||r.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var i,r;e.dispatchEvent({type:"beginEvent",eventName:t}),(r=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||r.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,i=!1){this.objectsPerTypes[t].forEach(r=>{let n=this.eventsPerObjects[t][r.uuid];n.some(({data:s})=>"key"in s&&s.key===e.key)&&r.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(i?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,i=!1){this.objectsPerTypes[t].forEach(r=>{this.eventsPerObjects[t][r.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(i)})})}},rqe=new q,nqe=new q,hne=class{constructor(e,t,i,r,n){this.actionsIn=Ns(e,e.inActions,i,r,n,t),this.actionsOut=Ns(e,e.outActions,i,r,n,t)}disconnect(){Ea(this.actionsIn),Ea(this.actionsOut)}},sqe=class extends hne{constructor(e,t,i,r,n,s){super(t,i,r,n,s),this.id=e,this.data=t,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let d of this.objects)if(!d.visible)return;let u=rqe.setFromMatrixPosition(this.objects[0].matrixWorld),c=nqe.setFromMatrixPosition(this.objects[1].matrixWorld),h=u.distanceTo(c)<=this.distance?"in":"out";if(this.stage!==h){this.stage=h;let d=h==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(f=>f.dispatchConditional()),d.Particles.forEach(f=>f.dispatchConditional()),d.Video.forEach(f=>f.dispatchConditional()),d.Link.forEach(f=>f.dispatch()),d.Create.forEach(f=>f.dispatch()),d.Destroy.forEach(f=>f.dispatch()),d.Reset.forEach(f=>f.dispatch()),d.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),d.Transition.forEach(f=>f.play()),d.Animation.forEach(f=>f.play()),d.SwitchCamera.forEach(f=>f.play()),d.SceneTransition.forEach(f=>f.dispatch()),d.SetVariable.forEach(f=>f.checkConditions()),d.SetVariable.forEach(f=>f.dispatch()),d.DynamicVariablePlay.forEach(f=>f.dispatch()),d.ClearLocalStorage.forEach(f=>f.dispatch()),d.UserAPI.forEach(f=>f.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let u of[o,l]){if(!u)throw new Error("Missing property");let c=r.find(u);if(!c)throw new Error("Missing property");this.objects.push(c)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},aqe=class extends hne{constructor(e,t,i,r,n,s){var l;super(t,i,r,n,s),this.id=e,this.data=t,this.object=i,this.onBegin=({target:u,state:c})=>{this.toState!==c&&(this.actionsOut.Audio.forEach(h=>h.dispatchConditional()),this.actionsOut.Particles.forEach(h=>h.dispatchConditional()),this.actionsOut.Video.forEach(h=>h.dispatchConditional()),this.actionsOut.Link.forEach(h=>h.dispatch()),this.actionsOut.Create.forEach(h=>h.dispatch()),this.actionsOut.Destroy.forEach(h=>h.dispatch()),this.actionsOut.Reset.forEach(h=>h.dispatch()),this.actionsIn.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(h=>h.play()),this.actionsOut.Animation.forEach(h=>h.play()),this.actionsIn.SwitchCamera.forEach(h=>h.pause()),this.actionsOut.SwitchCamera.forEach(h=>h.play()),this.actionsOut.SceneTransition.forEach(h=>h.dispatch()),this.actionsOut.SetVariable.forEach(h=>h.checkConditions()),this.actionsOut.SetVariable.forEach(h=>h.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(h=>h.dispatch()),this.actionsOut.ClearLocalStorage.forEach(h=>h.dispatch()),this.actionsOut.UserAPI.forEach(h=>h.dispatch()))},this.onComplete=({target:u,state:c})=>{this.toState===c&&(this.actionsIn.Audio.forEach(h=>h.dispatchConditional()),this.actionsIn.Particles.forEach(h=>h.dispatchConditional()),this.actionsIn.Video.forEach(h=>h.dispatchConditional()),this.actionsIn.Link.forEach(h=>h.dispatch()),this.actionsIn.Create.forEach(h=>h.dispatch()),this.actionsIn.Destroy.forEach(h=>h.dispatch()),this.actionsIn.Reset.forEach(h=>h.dispatch()),this.actionsOut.Transition.forEach(h=>h.pause()),this.actionsOut.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(h=>h.play()),this.actionsIn.Animation.forEach(h=>h.play()),this.actionsOut.SwitchCamera.forEach(h=>h.pause()),this.actionsIn.SwitchCamera.forEach(h=>h.play()),this.actionsIn.SceneTransition.forEach(h=>h.dispatch()),this.actionsIn.SetVariable.forEach(h=>h.checkConditions()),this.actionsIn.SetVariable.forEach(h=>h.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(h=>h.dispatch()),this.actionsOut.ClearLocalStorage.forEach(h=>h.dispatch()),this.actionsOut.UserAPI.forEach(h=>h.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=r.find(a.object)??r.scene.find2D(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!((l=this.toObject.states)!=null&&l[a.state]))throw new Error("Missing property");this.toState=a.state}connect(){xg(this.actionsOut).forEach(e=>{var t;(t=this.actionsOut[e])!=null&&t.length&&this.toObject.addEventListener("beginState",this.onBegin)}),xg(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),xg(this.actionsOut).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),xg(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},oqe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(i=>{var r;if((r=i.data)!=null&&r.events.length){for(let{id:n,data:s}of i.data.events)if(!s.disabled&&s.type==="Conditional")try{let a;s.condition.type==="Comparison"||(s.condition.type==="Distance"?a=new sqe(n,s,i,e,t,this.eventManager):s.condition.type==="State"&&(a=new aqe(n,s,i,e,t,this.eventManager))),a&&(this.eventsPerConditions[s.condition.type].push(a),(a.actionsIn.Video.length||a.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(i=>i.forEach(r=>r.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},xx=new q,Yf=new q,Wm=new q,nG=new bl,lqe=.01,Vr=new q,Hs=new q,sG=new q,Cg=new Si,lO=new Ks,uqe=new Pt,uO=new Is,a0=new q,th=new q,cO=.2;function hO(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var cqe=function(){let e=new Pt;return(t,i,r)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(i),t.reference==="global"&&hO(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?hO(n.position,t.limits):t.reference==="local"&&(Cg.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(Cg),hO(n.position,t.limits),Cg.invert(),n.position.applyQuaternion(Cg),n.position.add(t.position0)),e.multiply(r??n.matrixWorld).decompose(Vr,n.quaternion,Hs),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof Ko&&$d(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),hqe=class{constructor(e,t,i,r,n,s,a){this.object=e,this.id=t,this.data=i,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Ns(i,i.dragDropActions.drag,r,n,s,this.object),this.actionsDrop=Ns(i,i.dragDropActions.drop,r,n,s,this.object);let o=[];this.data.objects.forEach(l=>{let u=r.find(l);!u||u.data.visible!==!1&&(o.push(u),a[u.uuid]&&a[u.uuid].forEach(c=>{let h=r.find(c);!h||h.data.visible!==!1&&o.push(h)}))}),this.data.dropDestinations.forEach(l=>{let u=r.find(l);!u||u.data.visible!==!1&&(this.dropDestIds.push(u.uuid),a[u.uuid]&&a[u.uuid].forEach(c=>{let h=r.find(c);!h||h.data.visible!==!1&&this.dropDestIds.push(h.uuid)}))}),this.dragItems=o.map(l=>(this.data.planeMode==="locked"&&(l.userData.lockedPlane=!0),l.userData.worldPosition0=new q().setFromMatrixPosition(l.matrixWorld),{obj:l,fromPosition:new q().setFromMatrixPosition(l.matrixWorld),pointStart:new q,pointEnd:new q,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new q().copy(l.position),quat0:new Si().copy(l.quaternion),snapped:!1,orientationMatrix:new Pt,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Ea(this.actionsDrag),Ea(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},dqe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=i=>{var a;if(wi.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:r,page:n}=this.eventContext,s=n.raycastWithClones(r);if(this.lastDropDestination=null,s.length===0){this.activeEvent=null;return}for(let o of this.events){let l=0;for(let{obj:u,pointEnd:c,pointStart:h}of o.dragItems){if(u===s[0].object||u===s[0].object.object||wr.is(u)&&u.isAncestorOf(s[0].object.uuid)){if(o.activeIdx=l,o.activeDragItem.reset=!1,o.activeDragItem.currentDampingFactor=o.data.dampingFactor,o.activeDragItem.snapped=!1,o.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){o.activeDragItem.obj.rigidBody&&o.activeDragItem.obj.rigidBody.setBodyType(2,!0);let d=o.activeDragItem.obj;u.hasNonUniformScale&&u.updateMatrixWorldSVD(),(d.hasNonUniformScale?d.matrixWorldRigid:d.matrixWorld).decompose(Vr,Cg,Hs),lO.setFromQuaternion(Cg),d.prevR===void 0?(d.prevR=lO.clone(),d.prevT=Vr.clone()):(d.prevR.copy(lO),d.prevT.copy(Vr)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(o.activeDragItem.obj)}this.calcPlaneIntersectPos(u,h,o.data.plane,o.data.referenceFrame),c.copy(h),(this.eventManager.controlsManager.usePhysics&&((a=u.data.physics)==null?void 0:a.rigidBody)==="dynamic"||o.data.drop===!1||o.data.resetOnSnapFail===!1)&&o.activeDragItem.fromPosition.setFromMatrixPosition(o.activeDragItem.obj.matrixWorld),this.activeEvent=o,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}l++}}this.activeEvent=null},this.onPointerMove=i=>{var a,o,l,u;if(wi.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:r,page:n}=this.eventContext,s=n.raycastWithClones(r);if(wi.length===0){let c=!1;for(let h of this.events){for(let{obj:d}of h.dragItems)if(d===((a=s[0])==null?void 0:a.object)||d===((l=(o=s[0])==null?void 0:o.object)==null?void 0:l.object)||wr.is(d)&&d.isAncestorOf((u=s[0])==null?void 0:u.object.uuid)){switch(c=!0,h.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(c)break}c||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let c=this.activeEvent.activeDragItem;c.snapped=!1;let h;if(this.activeEvent.data.drop&&(h=s.filter(d=>c.obj!==d.object&&!c.obj.isAncestorOf(d.object.uuid)&&!(d.object instanceof my)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===d.object.uuid||n.scene.find(f).isAncestorOf(d.object.uuid))))[0]),h){let d=sG.copy(h.face.normal).applyMatrix3(uO.getNormalMatrix(h.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")c.fromPosition.setFromMatrixPosition(h.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(c.fromPosition.copy(h.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Vr.copy(d).applyMatrix3(uO.setFromMatrix4(c.obj.matrixWorld).transpose());let f=c.obj;Vr.x>cO?Hs.x=-f.recursiveBBox.min.x:Vr.x<-.2&&(Hs.x=-f.recursiveBBox.max.x),Vr.y>cO?Hs.y=-f.recursiveBBox.min.y:Vr.y<-.2&&(Hs.y=-f.recursiveBBox.max.y),Vr.z>cO?Hs.z=-f.recursiveBBox.min.z:Vr.z<-.2&&(Hs.z=-f.recursiveBBox.max.z),Hs.applyMatrix3(uO.invert())}else Hs.copy(d).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);c.fromPosition.add(Hs)}this.activeEvent.data.autoOrient&&(Vr.set(0,1,0).cross(d),Vr.length()<1e-4&&Vr.set(-1,0,0).cross(d),Hs.crossVectors(sG,Vr),c.orientationMatrix.makeBasis(Vr,Hs,d)),c.pointStart.copy(c.fromPosition),c.pointEnd.copy(c.pointStart),c.currentDampingFactor=this.activeEvent.snapDampingFactor,c.snapped=!0,this.lastDropDestination!==h.object&&(this.lastDropDestination=h.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else c.orientationMatrix.makeRotationFromQuaternion(c.quat0),this.lastDropDestination=null,c.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(c.obj,c.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(d=>{d.stop(),d.object.currentState!==null&&d.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(d=>{d.stop()}),this.activeEvent.actionsDrop.Audio.forEach(d=>{d.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(d=>{d.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(d=>{d.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(d=>d.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(d=>d.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(d=>d.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(d=>d.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(d=>d.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(d=>{d.play()}),this.activeEvent.actionsDrag.Animation.forEach(d=>{d.play()}),this.activeEvent.actionsDrag.Audio.forEach(d=>{d.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(d=>{d.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(d=>{d.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(d=>{d.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(d=>{d.stop(),d.object.currentState!==null&&d.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(d=>{d.stop()}))},500),this.updateDragItem(c),c.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=i=>{var r;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let n=((r=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:r.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!n)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&n&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(s=>{s.stop(),s.object.currentState!==null&&s.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(s=>{s.stop()}),this.activeEvent.actionsDrag.Audio.forEach(s=>{s.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(s=>{s.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(s=>s.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(s=>s.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(s=>s.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(s=>s.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(s=>s.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity(i=>{i.component&&(e[i.component.uuid]?e[i.component.uuid].push(i.uuid):e[i.component.uuid]=[i.uuid])}),this.eventContext.page.traverseEntity(i=>{var r;(r=i.data)==null||r.events.filter(n=>n.data.type==="DragDrop"&&!n.data.disabled).forEach(n=>{this.events.push(new hqe(i,n.id,n.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,i,r){let{getCamera:n,raycaster:s}=this.eventContext;n().getWorldDirection(Yf),Yf.negate();let a=Cg.identity();switch(r==="parent"?uqe.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Vr,a,Hs):r==="local"&&e.matrixWorld.decompose(Vr,a,Hs),i){case"x":Vr.set(1,0,0).applyQuaternion(a),a0.copy(Yf).cross(Vr),th.copy(Vr).cross(a0);break;case"y":Vr.set(0,1,0).applyQuaternion(a),a0.copy(Yf).cross(Vr),th.copy(Vr).cross(a0);break;case"z":Vr.set(0,0,1).applyQuaternion(a),a0.copy(Yf).cross(Vr),th.copy(Vr).cross(a0);break;case"xy":th.set(0,0,1).applyQuaternion(a);break;case"yz":th.set(1,0,0).applyQuaternion(a);break;case"xz":th.set(0,1,0).applyQuaternion(a);break;case"adaptive":Yf.angleTo(Hs.set(0,1,0))>Math.PI/6?(Vr.crossVectors(Hs.set(0,1,0),Yf),th.crossVectors(Vr,Hs)):th.set(0,1,0);break;default:th.copy(Yf);break}Wm.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:Wm;if(nG.setFromNormalAndCoplanarPoint(th,o),!!s.ray.intersectPlane(nG,t)&&(i==="x"||i==="y"||i==="z")){let l=Hs.subVectors(t,o).dot(Vr);t.copy(o).addScaledVector(Vr,l)}}updateDragItem(e,t=!1){var i,r;Wm.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?xx.subVectors(e.fromPosition,Wm).divideScalar(e.currentDampingFactor):e.reset==="original"?(xx.subVectors(e.obj.userData.worldPosition0,Wm).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):xx.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Wm).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?xx.length()<lqe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&cqe(e,xx.add(Wm),(i=this.activeEvent)!=null&&i.data.drop&&((r=this.activeEvent)!=null&&r.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},o0=new q,dO=new q,Td=new q,Cd=new q,aG=new bl,fqe=.01,pqe={type:"requestRender"},mqe=function(){let e=new q,t=new q;return(i,r,n)=>n>0?(e.subVectors(i,r),e.length()<=n?i:t.copy(r).add(e.normalize().multiplyScalar(n))):r}(),oG=function(){let e=new Pt;return(t,i)=>{t.position.copy(i),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof Ko&&$d(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),gqe=class{constructor(e,t,i,r,n,s){this.data=e,this.id=t,this.object=i,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new q,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...nL.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Ns(e,e.actions,r,n,s,i)}},vqe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(wi.length>1)){this.eventContext.updateRaycaster(i);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=i=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=i=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(r=>{var s,a;let n=(s=r.data)==null?void 0:s.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((a=r.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new gqe(n.data,n.id,r,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:i}=this.eventContext;this.domEventsNeeded.clear(),Jl&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events)if(r.target!==void 0){let n=r.target,s=this.onTargetChange(r);this.pairOfEventListeners.push([n,s]),n.addEventListener("requestRender",s)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Jl&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,r]of this.pairOfEventListeners)i.removeEventListener("requestRender",r);for(let i of this.events)i.paused=!0,i.isReset=!1,Ea(i.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var a;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:r,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(Td),e.isReset)Cd.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Cd);else{let{getCamera:o,raycaster:l}=this.eventContext;if(i==="custom"?(o().getWorldDirection(dO),dO.negate(),o0.copy(dO)):i==="xy"?o0.set(0,0,1):i==="xz"?o0.set(0,1,0):i==="yz"&&o0.set(1,0,0),aG.setFromNormalAndCoplanarPoint(o0,Td),!l.ray.intersectPlane(aG,Cd))return}if(!e.isReset){if(Cd.distanceTo(e.worldPosition0)>r&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Cd.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Cd.x=Td.x),e.data.enabledTranslation[1]===!1&&(Cd.y=Td.y),e.data.enabledTranslation[2]===!1&&(Cd.z=Td.z);let s=mqe(Td,Cd,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=o0.subVectors(s,Td).divideScalar(e.currentDampingFactor);Td.add(o),t&&oG(e.object,Td),e.paused=o.length()<fqe}else oG(e.object,s),e.paused=!0;(a=e.object)==null||a.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(pqe)}},bx=new q,BS=new q,_x=new Pt,l0=new Si,Xf=new Si,wx=new q,Ex=new q,Gm=new q,Ad=new q,fO=new bl,yqe=1e-6,xqe={type:"requestRender"},bqe={type:"changeRotation"},lG=function(){let e=new Pt;return function(t,i){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),i.premultiply(ane(e).invert()),t.rotation.setFromRotationMatrix(i),t.updateMatrix(),t instanceof Ko&&$d(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),_qe=class{constructor(e,t,i,r){this.id=t,this.object=i,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Si,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...sL.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},wqe=class extends xo{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(wi.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let t of this.events)t.target===void 0&&this.updateSingleEvent(t)}},this.onMouseEnter=e=>{for(let t of this.events)t.target===void 0&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)t.target===void 0&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let t=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(t)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>({eventName:t,target:i})=>{if(!t||!i)return;let r=fw(t);r&&r==="LookAt"&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(r=>{var s,a;let n=(s=r.data)==null?void 0:s.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((a=r.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new _qe(n.data,n.id,r,e))}),!this.events.length)return;let{domElement:t,eventElement:i}=this.eventContext;this.domEventsNeeded.clear(),Jl&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?i.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events){if(r.target!==void 0){let a=this.onTargetChange(r),o=r.target;this.pairOfEventListeners.push([o,a]),o.addEventListener("requestRender",a)}let n=this.createUserEventListener(r),s=r.object;this.pairOfUserEventListeners.push([s,n]),s.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Jl&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[i,r]of this.pairOfEventListeners)i.removeEventListener("requestRender",r);for(let[i,r]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",r);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var d;let{tilt:t,axis:i,distance:r,plane:n,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:u}=this.eventContext,{object:c,target:h}=e;if(c.getWorldPosition(wx),!e.isReset)if(e.target)e.target.getWorldPosition(Ex);else{if(n==="custom"?(l().getWorldDirection(BS),BS.negate(),fO.setFromNormalAndCoplanarPoint(BS,wx)):(n==="xy"?bx.set(0,0,1):n==="xz"?bx.set(0,1,0):n==="yz"&&bx.set(1,0,0),fO.setFromNormalAndCoplanarPoint(bx,wx)),!u.ray.intersectPlane(fO,Ex))return;r>0&&(n==="custom"||n===void 0)&&Ex.addScaledVector(BS,r)}if(e.isReset||(h?t==="target"?Gm.copy(h.up).applyMatrix4(_x.extractRotation(h.matrixWorld)).normalize():a.some(f=>f===!1)?(i==="x"?(Ad.set(0,0,1),a[2]===!1&&Ad.set(0,1,0)):i==="y"?(Ad.set(1,0,0),a[0]===!1&&Ad.set(0,0,1)):(Ad.set(0,1,0),a[1]===!1&&Ad.set(1,0,0)),Gm.copy(Ad).applyQuaternion(e.worldQuaternion0).normalize()):Gm.set(0,1,0):n==="custom"?Gm.set(0,1,0):Gm.copy(bx)),e.isReset)Xf.copy(e.worldQuaternion0);else if(wx.distanceTo(Ex)>s&&o&&h)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Xf.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;Eqe(_x,Ex,wx,Gm,i,Ad),Xf.setFromRotationMatrix(_x),l0.setFromUnitVectors(Ad.applyQuaternion(Xf),Gm),a.some(f=>f===!1)&&t!=="target"&&Xf.premultiply(l0).normalize()}e.currentDampingFactor>1?(c.updateWorldMatrix(!0,!1),l0.setFromRotationMatrix(ane(c.matrixWorld)),l0.slerp(Xf,1/e.currentDampingFactor),lG(c,_x.makeRotationFromQuaternion(l0)),e.paused=8*(1-l0.dot(Xf))<yqe):(lG(c,_x.makeRotationFromQuaternion(Xf)),e.paused=!0),(d=e.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),c.dispatchEvent(xqe),c.dispatchEvent(bqe)}},wu=new q,Vs=new q,hs=new q;function Eqe(e,t,i,r,n,s){let a=e.elements;hs.subVectors(t,i),hs.lengthSq()===0&&(hs.z=1),hs.normalize(),Vs.crossVectors(r,hs),Vs.lengthSq()===0&&(Math.abs(r.z)===1?hs.x+=1e-4:hs.z+=1e-4,hs.normalize(),Vs.crossVectors(r,hs)),Vs.normalize(),wu.crossVectors(hs,Vs),n==="x"?s.z===1?[Vs,wu,hs]=[hs,Vs,wu]:(Vs.negate(),[Vs,hs]=[hs,Vs]):n==="y"?s.x===1?[Vs,wu,hs]=[wu,hs,Vs]:(Vs.negate(),[wu,hs]=[hs,wu]):s.x===1&&(Vs.negate(),[Vs,wu]=[wu,Vs]),a[0]=Vs.x,a[4]=wu.x,a[8]=hs.x,a[1]=Vs.y,a[5]=wu.y,a[9]=hs.y,a[2]=Vs.z,a[6]=wu.z,a[10]=hs.z}var Sqe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.entered=!1,this.actions=Ns(t,t.actions,r,n,s,i)}disconnect(){Ea(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},Tqe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=i=>{wi.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseHoverEvent())},this.onMouseUp=i=>{wi.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=i=>{wi.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:i,target:r,reverse:n})=>{var a;if(!i||!r)return;let s=fw(i);s&&s==="MouseHover"&&(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(a=this.eventsPerObjects[r.uuid])==null||a.forEach(o=>o.dispatchUserEvent(n)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,i=(n,s)=>{var a,o;if(!(!n.visible||!((a=n.data)!=null&&a.events.length))){for(let{id:l,data:u}of n.data.events)if(!u.disabled&&u.type==="MouseHover")try{let c=new Sqe(l,u,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(c):this.eventsPerObjects[n.uuid]=[c]}catch{}(o=this.eventsPerObjects[n.uuid])!=null&&o.length&&this.objects.push(n instanceof Ta?s:n)}};if(e.traverseEntity(n=>{var s;(n instanceof fo||n instanceof va)&&((s=n.frame)==null||s.traverse(a=>{i(a,n)})),i(n)}),!this.objects.length)return;let{domElement:r}=this.eventContext;this.domEventsNeeded.clear(),Jl&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(n=>{n.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),Jl&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(i=>{i.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:i,raycaster:r,page:n,pointerScreen:s}=this.eventContext,a=!1;if(n.uiCanvas&&(a=Ud(n,[s.x,s.y],Object.keys(this.eventsPerObjects),o=>{t.push(o)})),i&&!a){let o=kT(r,n,this.objects);t=AN(o),o.forEach(l=>{var u,c;l.object instanceof fo&&Ud(l.object,[((u=l==null?void 0:l.uv)==null?void 0:u.x)??0,((c=l==null?void 0:l.uv)==null?void 0:c.y)??0],Object.keys(this.eventsPerObjects),h=>{t.push(h)})})}else this.objects.forEach(o=>{var u,c;let l=DA(r,o);l&&(t.push(o),o instanceof fo&&Ud(o,[((u=l==null?void 0:l.uv)==null?void 0:u.x)??0,((c=l==null?void 0:l.uv)==null?void 0:c.y)??0],Object.keys(this.eventsPerObjects),h=>{t.push(h)}))})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var r;t.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(r=this.eventsPerObjects[i.uuid])==null||r.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(i=>{var r;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(r=this.eventsPerObjects[i.uuid])==null||r.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},Cqe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.scrollCounter=0,this.actions=Ns(t,t.actions,r,n,s,i)}connect(){this.scrollCounter=0}disconnect(){Ea(this.actions)}dispatch(e){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(r=>r.seek(i)),this.actions.Animation.forEach(r=>r.seek(t)),this.actions.Create.forEach(r=>r.dispatchThrottled()),this.actions.SetVariable.forEach(r=>r.checkConditions()),this.actions.SetVariable.forEach(r=>r.dispatch()),this.actions.DynamicVariablePlay.forEach(r=>r.dispatch()),this.actions.ClearLocalStorage.forEach(r=>r.dispatch()),this.actions.UserAPI.forEach(r=>r.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},Aqe=class{constructor(e,t,i,r,n,s,a){this.id=e,this.data=t,this.object=i,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=Ns(t,t.actions,r,n,a,i)}getStickyParentElement(){let e=this.domElement;for(;e;){if(window.getComputedStyle(e).position==="sticky")return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e==null?void 0:e.parentElement,i=this.domElement.getBoundingClientRect(),r={top:i.top,bottom:i.bottom,left:i.left,right:i.right,width:i.width,height:i.height};if(t){let u=t.getBoundingClientRect(),c=window.getComputedStyle(e),h=parseFloat(c.marginTop)+parseFloat(c.marginBottom),d=parseFloat(c.top),f=parseFloat(c.bottom),m=u.height-h;if(!isNaN(d))i.top===d?(r.top+=u.top-d,r.bottom+=u.top-d):i.top<0&&(r.top-=m-i.height,r.bottom-=m-i.height);else if(!isNaN(f)){let g=document.body.clientHeight??window.innerHeight,y=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);i.bottom===g-f?(r.top+=u.top-i.height+f+y,r.bottom+=u.top-i.height+f+y):i.bottom<g-f&&(r.top-=m-i.height,r.bottom-=m-i.height)}}let n=document.body,s=document.documentElement,a=window.pageYOffset||s.scrollTop||n.scrollTop,o=s.clientTop||n.clientTop||0,l=Math.round(r.top+a-o);if(this.data.startFrom==="enter"){let u=window.innerHeight,c=r.height,h=this.data.enterAnchor,d=h==="top"?u:h==="bottom"?u-c:u-c*.5;this.scrollStart=l-d}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=r,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Ea(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let i=this.scrollEnd-this.scrollStart,r=Math.min(1,Math.max(0,(t-this.scrollStart)/i));this.actions.Transition.forEach(n=>n.seek(r)),this.actions.Animation.forEach(n=>n.seek(r)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch()),this.actions.ClearLocalStorage.forEach(n=>n.dispatch()),this.actions.UserAPI.forEach(n=>n.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},Mqe=class extends xo{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([i,r])=>{r.forEach(n=>n.handleResize())})},this.onScroll=i=>{if(!this.isInview)return;let r={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:r}),s.forEach(a=>a.dispatch(r))})},this.onWheel=i=>{!this.isInview||i.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([r,n])=>{r.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:i.deltaY}),n.forEach(s=>s.dispatch(i.deltaY))})},this.onUserEvent=({eventName:i,target:r,reverse:n})=>{var a;if(!i||!r)return;let s=fw(i);s&&s==="Scroll"&&(r.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(a=this.wheelEventsPerObject.get(r))==null||a.forEach(o=>{o.dispatchUserEvent(n)}))}}connect(){let{page:e,sharedAssets:t,domElement:i,isExport:r}=this.eventContext,n=s=>{var a,o,l;if((a=s.data)!=null&&a.events.length){for(let{id:u,data:c}of s.data.events)if(!c.disabled&&c.type==="Scroll")if(c.trigger==="load"||!r){let h=new Cqe(u,c,s,e,t,this.managers);this.wheelEventsPerObject.has(s)?(o=this.wheelEventsPerObject.get(s))==null||o.push(h):this.wheelEventsPerObject.set(s,[h])}else{let h=new Aqe(u,c,s,e,t,i,this.managers);this.scrollEventsPerObject.has(s)?(l=this.scrollEventsPerObject.get(s))==null||l.push(h):this.scrollEventsPerObject.set(s,[h])}}};e.traverseEntity(s=>{var a;(s instanceof fo||s instanceof va)&&((a=s.frame)==null||a.traverse(o=>{n(o)})),n(s)}),this.intersectionObserver=new IntersectionObserver(s=>{let a=s[0];a&&(this.isInview=a.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([s,a])=>{a.forEach(o=>o.connect()),s.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([s,a])=>{a.forEach(o=>o.connect()),s.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(s=>s.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(s=>s.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},Pqe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.actions=Ns(t,t.actions,r,n,s,i)}disconnect(){Ea(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof Tg?t.interaction.audioPlayer.play():t.interaction instanceof _N&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let i=t.interaction.data.triggerAfter??"autoplay";i===e&&(t.interaction instanceof vy?t.interaction.play(i==="autoplay"):t.interaction instanceof TN&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof Tg?t.interaction.audioPlayer.play():t.interaction instanceof _N&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof vy?t.interaction.play():t.interaction instanceof TN&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},Dqe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:i,isExport:r}=this.eventContext,n=r?document:i;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,a])=>{s.dispatchEvent({type:"beginEvent",eventName:"Start"}),a.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof Tg&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof vy&&s.interaction.play(a==="autoplay")}),n.actions.Particles.forEach(s=>{s.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:i,target:r,reverse:n})=>{var a,o;if(!i||!r)return;let s=fw(i);s&&s==="Start"&&(r instanceof Ta||r.dispatchEvent({type:"beginEvent",eventName:"Start"}),(a=this.eventsPerObject.get(r))==null||a.forEach(l=>{l.dispatchUserEvent(n)}),(o=this.eventsAfterPerObject.get(r))==null||o.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,i=r=>{var n,s,a,o,l;if((n=r.data)!=null&&n.events.length)for(let{id:u,data:c}of r.data.events){if(c.disabled||c.type!=="Start")continue;let h=new Pqe(u,c,r,t,e,this.eventManager);(h.actions.Transition.length||h.actions.Animation.length||h.actions.SwitchCamera.length||h.actions.Create.length||h.actions.Destroy.length||h.actions.SceneTransition.length||h.actions.Reset.length||h.actions.SetVariable.length||h.actions.DynamicVariablePlay.length||h.actions.ClearLocalStorage.length||h.actions.UserAPI.length)&&(this.eventsPerObject.has(r)?(s=this.eventsPerObject.get(r))==null||s.push(h):this.eventsPerObject.set(r,[h])),h.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(h):this.eventsAfterPerObject.set(r,[h])),h.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(o=this.eventsAfterPerObject.get(r))==null||o.push(h):this.eventsAfterPerObject.set(r,[h])),h.actions.Particles.length&&(this.eventsAfterPerObject.has(r)?(l=this.eventsAfterPerObject.get(r))==null||l.push(h):this.eventsAfterPerObject.set(r,[h]))}};if(t.traverseEntity(r=>{var n;(r instanceof fo||r instanceof va)&&((n=r.frame)==null||n.traverse(s=>{i(s)})),i(r)}),[...this.eventsAfterPerObject.values()].some(r=>r.length)){if(this.eventManager.activateCount===0){let{domElement:r,isExport:n}=this.eventContext,s=n?document:r;s.addEventListener("pointerdown",this.onMouseDown,{once:!0}),s.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),s.addEventListener("pointerdown",this.onAny),s.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,o])=>{a.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([r,n])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(s=>s.dispatch()),r.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.removeEventListener("pointerdown",this.onMouseDown),i.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),i.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([r,n])=>{r.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(i=>i.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},Iqe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.initialDisabled=!1,this.actions=Ns(t,t.actions,r,n,s,i),this.target=t.target}disconnect(){Ea(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()))}},Oqe=class extends xo{constructor(e,t,i,r,n){super(e),this.sharedVariables=t,this.eventManager=i,this.needsMouse=r,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=s=>{let a=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let o=new Date,l=[],u=[];for(let d=0;d<this.propertiesToWatch.length;d++){let{objectId:f,property:m,prevValue:g}=this.propertiesToWatch[d],y=this.eventContext.scene.find(f),x=oL.propertyPaths[m];if(x[0]==="width"||x[0]==="height"||x[0]==="depth")y=y.geometry.userData.parameters[x[0]];else for(let w=0;w<x.length;w++)y=y[x[w]];g===null?this.propertiesToWatch[d].prevValue=y instanceof q?y.clone():y:(y instanceof q?!y.equals(g):g!==y)&&(u.push({objId:f,property:m}),y instanceof q?this.propertiesToWatch[d].prevValue.copy(y):this.propertiesToWatch[d].prevValue=y)}for(let d=0;d<this.variablesToWatch.length;d++){let{id:f,prevValue:m}=this.variablesToWatch[d],g=a.getVariable(f);g!==m&&(l.push(f),this.variablesToWatch[d].prevValue=g)}for(let d=0;d<this.dynamicVars.length;d++){let{id:f,expectedTime:m,last:g,data:y,timerSeconds:x,startValue:w}=this.dynamicVars[d],b=1e3;if((y.dynamicVariableType==="timer"||y.dynamicVariableType==="stopwatch")&&y.format==="number3decimal"?b=1:y.dynamicVariableType==="counter"?b=y.updateInterval:y.dynamicVariableType==="random"&&(b=y.isStatic?1/0:y.updateInterval),m===-1){this.dynamicVars[d].last=s,this.dynamicVars[d].expectedTime=s+b;continue}if(!((a.getDynamicVariablePlayState(f)==="Stopped"||a.getDynamicVariablePlayState(f)==="Restarted")&&(this.dynamicVars[d].last=s,this.dynamicVars[d].expectedTime=s+b,y.dynamicVariableType==="counter"&&a.getVariable(f)!==w&&(a.updateVariable(f,w),this.eventManager.requestRender()),(y.dynamicVariableType==="timer"||y.dynamicVariableType==="stopwatch")&&this.dynamicVars[d].timerSeconds!==w&&(this.dynamicVars[d].timerSeconds=w,a.updateVariable(f,Mu.getFormattedTimerTime(w,y)),this.eventManager.requestRender()),a.getDynamicVariablePlayState(f)==="Restarted"&&a.setDynamicVariablePlayState(f,"Playing"),a.getDynamicVariablePlayState(f)==="Stopped"))){if(a.getDynamicVariablePlayState(f)==="Paused"){this.dynamicVars[d].deltaToExpectedTime===void 0&&(this.dynamicVars[d].deltaToExpectedTime=Math.max(this.dynamicVars[d].expectedTime-s,0)),this.dynamicVars[d].last=s-(b-this.dynamicVars[d].deltaToExpectedTime),this.dynamicVars[d].expectedTime=s+this.dynamicVars[d].deltaToExpectedTime;continue}else this.dynamicVars[d].deltaToExpectedTime=void 0;if(s>=m)if(this.dynamicVars[d].last=s,this.dynamicVars[d].expectedTime+=b,y.dynamicVariableType==="random"){let C=y.min+Math.random()*(y.max-y.min),A=y.decimals;C=Math.round(C*Math.pow(10,A))/Math.pow(10,A),a.updateVariable(f,C),l.push(f),this.eventManager.requestRender()}else if(y.dynamicVariableType==="counter"){let C=a.getVariable(f),A=a.getDynamicVariableToggleIsForward(f)??!0,E=a.getVariable(f)+y.increment*(A?1:-1);y.hasEnd&&(E=y.increment>0?Xt.clamp(E,w,y.endValue):Xt.clamp(E,y.endValue,w),E===w&&a.setDynamicVariableToggleIsForward(f,void 0),y.repeat?E===y.endValue&&(E=w):(E===w||E===y.endValue)&&a.setDynamicVariablePlayState(f,"Paused")),E!==C&&(l.push(f),a.updateVariable(f,E),this.eventManager.requestRender())}else if(y.dynamicVariableType==="time"){let C=a.getVariable(f),A=wW(o,y);if(typeof C=="object"&&"textValue"in C&&typeof A=="object"&&"textValue"in A){if(Array.isArray(C.textValue)&&Array.isArray(A.textValue)){if(C.textValue.every((E,_)=>E===A.textValue[_]))continue}else if(C.textValue===A.textValue)continue}else if(C===A)continue;a.updateVariable(f,A),l.push(f),this.eventManager.requestRender()}else{let C=ja.isTextValue(y.endValue)?uG(y.endValue.textValue):y.endValue,A=a.getDynamicVariableToggleIsForward(f)??!0,E=x+(s-g)/1e3*(y.dynamicVariableType==="timer"?-1:1)*(A?1:-1);E=Math.max(E,0),y.hasEnd&&(E=y.dynamicVariableType==="stopwatch"?Xt.clamp(E,w,C):Xt.clamp(E,C,w),E===w&&a.setDynamicVariableToggleIsForward(f,void 0),y.repeat?Math.abs(E-C)<(y.format==="number3decimal"?1e-4:.1)&&(E=w):(Math.abs(E-w)<(y.format==="number3decimal"?1e-4:.1)||Math.abs(E-C)<(y.format==="number3decimal"?1e-4:.1))&&a.setDynamicVariablePlayState(f,"Paused")),E!==x&&(l.push(f),this.dynamicVars[d].timerSeconds=E,a.updateVariable(f,Mu.getFormattedTimerTime(E,y)),this.eventManager.requestRender())}}}let c=!1;a.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=a.mouseProperty,c=!0);let h=!1;a.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=a.raycastProperty,h=!0),this.events.forEach(d=>{(l.includes(d.data.variableId)||u.find(f=>f.objId===d.data.objectId&&f.property===d.data.property)||d.data.variableId==="mouseProperty"&&c||d.data.variableId==="raycastProperty"&&h)&&(d.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(t=>{var i;(i=t.data)==null||i.events.filter(r=>r.data.type==="VariableChange"&&!r.data.disabled).forEach(r=>{this.events.push(new Rqe(r.id,r.data,t,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(t=>t.data.variableId==="objectProperty"&&t.data.objectId!==null).map(t=>({objectId:t.data.objectId,property:t.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:t,data:i})=>{if(!("dynamicVariableType"in i)){this.events.find(n=>n.data.variableId===t)&&this.variablesToWatch.push({id:t,prevValue:e.getVariable(t)});return}let r;if(i.dynamicVariableType==="timer"||i.dynamicVariableType==="stopwatch"){let n;if(ja.isTextValue(i.value)&&Array.isArray(i.value.textValue)){let s=i.value.textValue;s.length===3?n=s[2]+s[1]*60+s[0]*3600:n=s[1]+s[0]*60}else n=i.value;r=n,this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:i,timerSeconds:n,startValue:r})}else i.dynamicVariableType==="time"&&e.updateVariable(t,wW(new Date,i)),i.dynamicVariableType==="counter"&&(r=ja.isTextValue(i.value)?uG(i.value.textValue):i.value),this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:i,startValue:r})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},Rqe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.actions=Ns(t,t.actions,r,n,s,i)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispose(){Ea(this.actions)}};function uG(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var Lqe="https://unpkg.com/@splinetool/runtime@1.9.81/build/",Nqe="https://unpkg.com/@splinetool/navmesh-wasm@1.9.81/build/",kqe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${Lqe}' + 'navmesh.js'),
		fetch('${Nqe}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,Bqe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,zqe=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,Fqe=.001,Uqe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},dne,vr,Oa;Nze.then(e=>{dne=e,vr=new e.Vec3,Oa=new e.Vec3});var jqe=new q,Vqe=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=i=>{if(wi.length!==1)return;let{raycaster:r,page:n}=this.eventContext;this.eventContext.updateRaycaster(i);let s=n.raycastWithClones(r);if(s.length!==0){if(this.gameControl){let a=jqe.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,r)=>n=>{var d,f,m,g,y,x,w;let s;if(n instanceof Nu)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof Va)s=n.object;else if(s=n,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((f=s.dataPatched.cloner)==null?void 0:f.hideBase)&&((m=s.dataPatched.physics)==null?void 0:m.fusedBody)!==!0)return!0;if(r&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&((g=a.physics)==null?void 0:g.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let o=IA(a),l=s.userData.hasDestroy,u=s.userData.hasDrag,c=!1,h=!1;for(let b of a.events)b.data.disabled!==!0&&(b.data.type==="GameControl"?c=!0:b.data.type==="Follow"&&(h=!0));if(c||o||h||l||u)return!0;if(this.usePhysics&&((y=a.physics)==null?void 0:y.rigidBody)==="dynamic"){if(this.usePhysics&&((x=a.physics)!=null&&x.fusedBody))return!0}else if("geometry"in n&&n.geometry&&i.push(Fd(n.geometry,n.matrixWorld)),this.usePhysics&&((w=a.physics)==null?void 0:w.fusedBody))return n.traverseObject((b,C)=>{var _,P;if(C===0)return;let A;if(b instanceof Nu)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;A=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof Va)A=b.object;else if(A=b,(_=b.dataPatched.cloner)==null?void 0:_.hideBase)return!0;let E=A.dataPatched;if(!E.visible&&((P=E.physics)==null?void 0:P.enabled)!==!0)return!0;"geometry"in b&&b.geometry&&i.push(Fd(b.geometry,b.matrixWorld))}),!0},this.traverseNoPhysics=(i,r)=>n=>{let s;if(n instanceof Nu)return;n instanceof Va?s=n.object:s=n;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(r&&!s.userData.navmesh)return;let o=n.geometry,l=s.userData.hasDestroy===!0,u=s.userData.hasDrag===!0;if(IA(a)||l||u||s.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return!0;o&&i.push(Fd(o,n.matrixWorld))},this.navmeshWasm=dne,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?kqe:Bqe)+zqe])),this._worker=new Worker(this._workerURL)}init(e,t,i){this.gameControl=t,this.eventContext=i,this.setDefaultQueryExtent(new q().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,e,r=>{this.buildFromNavmeshData(r.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,i){t.objects.forEach(l=>{var c;let u=e.scene.find(l);u.traverseEntity(h=>{h.userData.navmesh=!0}),(c=u.cloner)==null||c.traverseObject(h=>{h.userData.navmesh=!0})});let r=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(r,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var c;let u=e.scene.find(l);u.traverseEntity(h=>{h.userData.navmesh=void 0}),(c=u.cloner)==null||c.traverseObject(h=>{h.userData.navmesh=void 0})}),r.length===0)return!1;let s=Sg(r),{positions:a,triIndices:o}=UM(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...Uqe,...t}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let e,t,i=this.navMesh.getDebugNavMesh(),r=i.getTriangleCount(),n=new Uint32Array(r*3),s=new Float32Array(r*3*3);for(e=0;e<r*3;e++)n[e]=e;for(e=0;e<r;e++)for(t=0;t<3;t++){let o=i.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new ai;return a.setIndex(new gi(n,1)),a.setAttribute("position",new gi(s,3)),a}getClosestPoint(e){return vr.x=e.x,vr.y=e.y,vr.z=e.z,this.navMesh.getClosestPoint(vr)}getClosestPointToRef(e,t){vr.x=e.x,vr.y=e.y,vr.z=e.z;let i=this.navMesh.getClosestPoint(vr);t.set(i.x,i.y,i.z)}getRandomPointAround(e,t){return vr.x=e.x,vr.y=e.y,vr.z=e.z,this.navMesh.getRandomPointAround(vr,t)}getRandomPointAroundToRef(e,t,i){vr.x=e.x,vr.y=e.y,vr.z=e.z;let r=this.navMesh.getRandomPointAround(vr,t);i.set(r.x,r.y,r.z)}moveAlong(e,t){return vr.x=e.x,vr.y=e.y,vr.z=e.z,Oa.x=t.x,Oa.y=t.y,Oa.z=t.z,this.navMesh.moveAlong(vr,Oa)}moveAlongToRef(e,t,i){return vr.x=e.x,vr.y=e.y,vr.z=e.z,Oa.x=t.x,Oa.y=t.y,Oa.z=t.z,this.navMesh.moveAlong(vr,Oa)}computePath(e,t){let i=this.getClosestPoint(t);if(Oa.x=i.x,Oa.y=i.y,Oa.z=i.z,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)+Math.pow(t.z-i.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let r=this.navMesh.computePath(vr,Oa),n=r.getPointCount(),s=[];for(let a=0;a<n;a++){let o=r.getPoint(a);s.push(new q(o.x,o.y,o.z))}return s}createCrowd(e,t){return new Hqe(this,e,t)}setDefaultQueryExtent(e){vr.x=e.x,vr.y=e.y,vr.z=e.z,this.navMesh.setDefaultQueryExtent(vr)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(t),r=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,t);r.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=r.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(r.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),i=new Uint8Array(e.size);return i.set(t),this.navMesh.freeNavmeshData(e),i}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,i){return vr.x=e.x,vr.y=e.y,vr.z=e.z,this.navMesh.addCylinderObstacle(vr,t,i)}addBoxObstacle(e,t,i){return vr.x=e.x,vr.y=e.y,vr.z=e.z,Oa.x=t.x,Oa.y=t.y,Oa.z=t.z,this.navMesh.addBoxObstacle(vr,Oa,i)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},Hqe=class{constructor(e,t,i){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,i){let r=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;r.radius=t.radius,r.height=t.height,r.maxAcceleration=t.maxAcceleration,r.maxSpeed=t.maxSpeed,r.collisionQueryRange=t.collisionQueryRange,r.pathOptimizationRange=t.pathOptimizationRange,r.separationWeight=t.separationWeight,r.updateFlags=7,r.obstacleAvoidanceType=0,r.queryFilterType=0,r.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),r);return this.transforms.push(i),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new q(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let i=this.crowd.getAgentPosition(e);t.set(i.x,i.y,i.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let i=this.crowd.getAgentVelocity(e);t.set(i.x,i.y,i.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let i=this.crowd.getAgentNextTargetPath(e);t.set(i.x,i.y,i.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let i=this.agents.indexOf(e);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let i=this.crowd.getAgentParameters(e);t.radius!==void 0&&(i.radius=t.radius),t.height!==void 0&&(i.height=t.height),t.maxAcceleration!==void 0&&(i.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(i.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(i.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(i.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,i)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=Fqe)return;let t=1/60,i=10;{let r=Math.floor(e/t);r>i&&(r=i),r<1&&(r=1);let n=e/r;for(let s=0;s<r;s++)this.crowd.update(n)}for(let r=0;r<this.agents.length;r++){let n=this.agents[r],s=this.getAgentPosition(n);if(this.transforms[r].copy(s),this._agentDestinationArmed[r]){let a=s.x-this._agentDestination[r].x,o=s.z-this._agentDestination[r].z,l=this.reachRadii[r],u=this._agentDestination[r].y-this.reachRadii[r],c=this._agentDestination[r].y+this.reachRadii[r],h=a*a+o*o;s.y>u&&s.y<c&&h<l*l&&(this.onReachTarget(n,this._agentDestination[r]),this._agentDestinationArmed[r]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,i=this.crowd.getCorners(e),r=i.getPointCount(),n=[];for(t=0;t<r;t++){let s=i.getPoint(t);n.push(new q(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function Wqe(e){let t=!1;return e.scene.objects.forEach(i=>{i.data.type==="Page"&&!t&&i.data.publish.gameControlObject&&x_.traverseModuleInstances(e,i.id,(r,n,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var Gqe={type:"change"},cG={type:"changeZoom"},qqe={type:"changePan"},qm={type:"start"},Ym={type:"end",changed:!0},Yqe={type:"end",changed:!1},pO=new Si,hG=new Ie,Xqe=2*Math.PI,Kqe=1e-8,$qe=.01,mO=new q,zS=new Ie,gO=new q,FS=new Si,dG=new Pt,Zqe={type:"requestRender"},fne=class extends qa{constructor(e,t,i={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,vu.DOLLY_ROTATE,vu.PAN],this.offset=new q,this.eye=new q,this.lastPosition=new q,this.lastQuaternion=new Si,this.current=new Ie,this.overShoot=new Ie,this.overRatio=new Ie,this.spherical=new F8,this.sphericalDelta=new F8,this.panOffset=new q,this.panLeftV=new q,this.panUpV=new q,this.panV=new q,this.rotateStart=new Ie,this.rotateEnd=new Ie,this.rotateDelta=new Ie,this.panStart=new Ie,this.panEnd=new Ie,this.panDelta=new Ie,this.dollyStart=new Ie,this.dollyEnd=new Ie,this.dollyDelta=new Ie,this.rotationRangeFactor=new Ie,this.panRangeFactor=new Ie,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=r=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=r.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(gO,FS,mO),this.offset.copy(gO).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(pO.copy(FS).invert()),this.panOffset.applyQuaternion(pO),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(FS),this.panOffset.applyQuaternion(FS)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),gO.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(dG.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(dG));let r=this.spherical.phi%Xqe;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(qr.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),r>0&&r>Math.PI||r<0&&r>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>$qe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>Kqe?(this.dispatchEvent(Gqe),this.object.dispatchEvent(Zqe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=r=>{this.enabled!==!1&&(r.pointerType==="touch"||r.pointerType==="pen"&&Jl?this.onPointerDownTouch(r):this.onPointerDownMouse(r),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(qm),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),r.stopPropagation(),r.pointerType==="touch"||r.pointerType==="pen"&&Jl||this.domElement.setPointerCapture(r.pointerId)))},this.onPointerLeave=r=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,mO.subVectors(this.position0,this.target0),this.spherical.setFromVector3(mO),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=r},this.onPointerEnter=r=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?zS.set(r.clientX-this.domElement.clientWidth/2,r.clientY-this.domElement.clientHeight/2):zS.set(r.clientX-this.pointerLeaveEvent.clientX,r.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(zS).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(hG,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(r.clientX,r.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(zS).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(r.clientX,r.clientY)),this.update()},this.onPointerMove=r=>{this.enabled!==!1&&(this.checkRaycastLock()||(r.pointerType==="touch"||r.pointerType==="pen"&&Jl?this.onPointerMoveTouch(r):this.onPointerMoveMouse(r),r.stopPropagation()))},this.onPointerUp=r=>{this.isPointerDown=!1,wi.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),wi.length>1&&r.preventDefault(),this.hasChange?this.dispatchEvent(Ym):this.dispatchEvent(Yqe),this.state=-1,r&&(r.stopPropagation(),r.pointerType==="touch"||r.pointerType==="pen"&&Jl||this.domElement.releasePointerCapture(r.pointerId))},this.onPointerDownMouse=r=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[r.button]:n=this.mouseButtonsPlay[r.button],n){case 0:if(r.altKey===!0&&!r.shiftKey&&!$E(r)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2;break;case 3:if($E(r)||r.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}break;case 5:if($E(r)||r.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=r=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(r);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(r);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(r);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=r=>{switch(wi.length>1&&r.preventDefault(),this.touches[wi.length-1]){case vu.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case vu.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case vu.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case vu.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=r=>{switch(wi.length>1&&r.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(r),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(r),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(r),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(r),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=p_(()=>this.dispatchEvent(Ym),33),this.onMouseWheel=r=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&r.preventDefault(),this.dispatchEvent(qm),this.handleMouseWheel(r),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=r=>{if(r.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!sw)if(r.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(qm),r.scale>this.prevScale?this.dollyIn(this.getZoomScale()):r.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=r.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(Ym)},this.onContextMenu=r=>{r.preventDefault()},this.onTouchEnd=r=>{r.preventDefault()},this.onKeyDown=r=>{this.enabled!==!1&&(this.key=r.key,r.key===" "&&this.dispatchEvent(qm))},this.onKeyUp=r=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&r.key==="Alt"&&this.onPointerUp(wi[0]),r.key===" "&&this.dispatchEvent(Ym))},this.onPointerHover=r=>{r.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(r,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(r,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=r=>{r.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/this.maxZoom,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let r=this.object.getTarget().applyQuaternion(pO.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+r.y,this.maxV=e.panVerticalOffset.max+r.y,this.minH=-e.panHorizontalOffset.min+r.x,this.maxH=e.panHorizontalOffset.max+r.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=ih(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=ih(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=ih(ih(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=ih(ih(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=vu.ROTATE),e.panTouches===1&&(this.touches[0]=vu.PAN),e.orbitTouches===2&&(this.touches[1]=vu.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=vu.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=vu.ROTATE),e.panTouches===3&&(this.touches[2]=vu.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,i,r,n,s,a,o){this.overShoot.set(0,0);let l,u,c;e instanceof q?(l=e.x,u=e.y,this.current.set(this.target.x,this.target.y),c=!0):(l=e.theta,u=e.phi,this.current.set(ih(this.spherical.theta),ih(this.spherical.phi)),c=!1),i===0&&(this.current.x+=l,this.current.y+=u),(t===3||t===2)&&(!c&&this.isThetaFlipped?this.current.x>r&&this.current.x<0?this.overShoot.x=r-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>r?this.overShoot.x=r-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),c||(this.overShoot.x=ih(this.overShoot.x),this.overShoot.y=ih(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=fG(Math.abs(this.overRatio.x)),this.overRatio.y=fG(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),u*this.overShoot.y<0&&!this.phiIsFree&&(u*=1-this.overRatio.y)):i===2&&(!c&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||c&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(u=this.overShoot.y*.05),c?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):c?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,u+=this.overShoot.y),e instanceof q?(e.x=l,e.y=u):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=u))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let r=this.object.position;this.panV.copy(r).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/i.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(qqe)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(cG)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(cG)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(qm),this.dollyOut(e),this.dispatchEvent(Ym)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(qm),this.dollyIn(e),this.dispatchEvent(Ym)}setZoom(e){if(this.dispatchEvent(qm),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(Ym)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(hG,-this.object.angleOffsetFromUp);let i=this.domElement,r=this.useWindowEvents?window.innerHeight:i.clientHeight,n=2*Math.PI*this.rotateDelta.x/r,s=2*Math.PI*this.rotateDelta.y/r;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(Pze===!1&&$E(e)===!1&&Ize(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(wi.length===2){let e=.5*(wi[0].pageX+wi[1].pageX),t=.5*(wi[0].pageY+wi[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(wi[0].pageX,wi[0].pageY)}handleTouchStartPan(){if(wi.length===2){let e=.5*(wi[0].pageX+wi[1].pageX),t=.5*(wi[0].pageY+wi[1].pageY);this.panStart.set(e,t)}else this.panStart.set(wi[0].pageX,wi[0].pageY)}handleTouchStartDolly(){let e=wi[0].pageX-wi[1].pageX,t=wi[0].pageY-wi[1].pageY,i=Math.sqrt(e*e+t*t);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(wi.length===2){let i=nI(e),r=.5*(e.pageX+i.x),n=.5*(e.pageY+i.y);this.rotateEnd.set(r,n)}else{if(e.pointerId!==wi[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(wi.length===2){let t=nI(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this.panEnd.set(i,r)}else{if(e.pointerId!==wi[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=nI(e),i=e.pageX-t.x,r=e.pageY-t.y,n=Math.sqrt(i*i+r*r);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function ih(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function fG(e){return 1-Math.pow(1-e,4)}var pG=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.page=r,this.currentIntersectedObjects=[],this.actions=Ns(t,t.actions,r,n,s,i),this.target=t.target,this.triggeringObjects=[];for(let a of t.triggeringObjects){let o=r.scene.find(a);o&&this.triggeringObjects.push(o)}}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){Ea(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}},Mr;Bze.then(e=>Mr=e);var Ts=new q,lc=new Si,Kf=new q,vO=new Ks(0,0,0,"YXZ"),mG=new Ks(0,0,0,"XYZ"),uc=new q,yO=new q,xO=new q(1,1,1),u0=new Si,US=new Pt,gG=new Pt,Qqe={type:"updateMatrix"},vG=new Si,bO=new Rl,MN={type:"beginEvent",eventName:"Collision"},Jqe={type:"beginEvent",eventName:"Trigger"};function eYe(e){if(x_.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((i,r)=>{if(r.events){if(Array.isArray(r.events)){for(let n of r.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(r.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var IA=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),tYe=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==Mr.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[i,r,n]=this.rigidBodyToMesh.get(t.handle);if(Ts.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),lc.copy(t.rotation()),i.matrixWorld.compose(Ts,lc,r),i.hasNonUniformScale&&i.matrixWorld.multiply(i.shearScale),i.dispatchEvent(Qqe),n){let s=i.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(i.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of i.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,i,r)=>{var a,o,l,u;if(r===!1)return;let n,s;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(i)):this.sensorToTriggerEvent[i]&&(n=this.sensorToTriggerEvent[i],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let c=this.sharedGameControlGlobals.createdObjects.length-1;c>=0;c--){let h=this.sharedGameControlGlobals.createdObjects[c];if(h.userData.hasCollisionDestroy&&(((a=h.rigidBody)==null?void 0:a.collider(0).handle)===t||((o=h.rigidBody)==null?void 0:o.collider(0).handle)===i)){this.sharedGameControlGlobals.createdObjects.splice(c,1),h.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(h.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let c=this.sharedGameControlGlobals.colliderToEntity.get(i),h=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,c,i)}else if(((u=this.gameControl)==null?void 0:u.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(i)){let c=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,c,t)}else{let c=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(h!==void 0)for(let m of h)m.data.target==="scene"&&this.dispatchCollisionEvent(m,c,t);let d=this.sharedGameControlGlobals.colliderToEntity.get(i),f=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(f!==void 0)for(let m of f)m.data.target==="scene"&&this.dispatchCollisionEvent(m,d,i)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=rne,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var i,r;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let s=(r=(i=n.data.actions)==null?void 0:i.find(a=>a.data.type==="Destroy"))==null?void 0:r.data;if(s)for(let a of s.objects){let o=this.page.scene.find(a);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let i of t.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let r of i.data.objects){let n=this.page.scene.find(r);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var u,c;let i,r=t instanceof Sb,n=t instanceof Tb;if(t instanceof Nu||r||n)return;t instanceof Va?i=t.object:i=t;let s=i.dataPatched;if(((u=s.physics)==null?void 0:u.enabled)==="visibility"?!s.visible:!((c=s.physics)!=null&&c.enabled))return!0;let a=t.geometry,o=i.userData.hasDestroy===!0,l=i.userData.hasDrag===!0;if(IA(s)||o||l||i.dataPatched.events.some(h=>h.data.disabled!==!0&&(h.data.type==="GameControl"||h.data.type==="Follow")))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;a&&e.push(Fd(a,t.matrixWorld))}),e.length>0){let t=Sg(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new wb(t)}}addRigidBody(e,t,i){if(sne(e.matrixWorld))return;let r=[],n="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&r.push(Fd(n,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,r);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(r.length>0){let a,o=!i.fromCreate&&s.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;o?(a=Mr.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(a=Mr.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=Mr.RigidBodyDesc.fixed();let l=Sg(r);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Ts,lc,Kf),e.position0=Ts.clone().divideScalar(this.pixelsPerMeter),e.rotation0=lc.clone(),Ts.divideScalar(this.pixelsPerMeter),a.setTranslation(Ts.x,Ts.y,Ts.z).setRotation(lc),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Kf.x/this.pixelsPerMeter,Kf.y/this.pixelsPerMeter,Kf.z/this.pixelsPerMeter);let u=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(u.handle,[e,Kf.clone(),s.physics.fusedBody]);let c=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(u,s.physics,l,t,c)}catch{try{this.addCollider(u,s.physics,l,t,!1)}catch(h){console.error(h)}}e.rigidBody=u}}addBoundsTree(e){var i,r;let t=[];if(((i=e.geometry)==null?void 0:i.getAttribute("position"))!==void 0&&((r=e.geometry)==null?void 0:r.getAttribute("position").count)>0&&t.push(Fd(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(n=>n.updateMatrixWorld(!0)),t.length>0){let n=Sg(t,!1);e.bvhGeometry=n,n.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new wb(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,i,r,n=!0){var o,l;if((i==null?void 0:i.getAttribute("position").count)===0||((o=i==null?void 0:i.getIndex())==null?void 0:o.count)===0)return;let s;i&&(t.colliderType==="trimesh"?s=Mr.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):s=Mr.ColliderDesc.convexMesh(i.getAttribute("position").array,n?i.getIndex().array:void 0)),s.setFrictionCombineRule(Mr.CoefficientCombineRule.Average).setRestitutionCombineRule(Mr.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,r),(l=this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid])!=null&&l.some(u=>u.target==="scene")&&a.setActiveEvents(Mr.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(i,r)=>{var o;if(r===0)return;let n;if(i instanceof Nu)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;n=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof Va)n=i.object;else if(n=i,(o=n.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;r===1?e.hasNonUniformScale?i.matrixWorld.multiplyMatrices(e.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let a=i.geometry;(a==null?void 0:a.getAttribute("position"))!==void 0&&t.push(Fd(a,i.matrixWorld))}}activate(e){var d,f;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,i=!1,r=5,n=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,u=null;if(l)for(let m of l.data.events){if(m.data.disabled||m.data.type!=="GameControl")continue;let g=l;for(;this.usePhysics&&((d=g=g.parent)==null?void 0:d.parent)!==null;)(f=g.data.physics)==null||f.fusedBody;m.data.collisionEnabled&&(this.needsCollisionDetection=!0),u===null&&(u=m.data)}if(this.page.traverseEntity(m=>{for(let g of m.dataPatched.events)if(g.data.disabled===!1&&g.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&u&&(l.data.visible===!0||l.data.physics.enabled===!0)){i=i||u.camera===t.uuid||l.uuid===t.uuid;let m=new nne(l,this.renderer.domElement,u,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&u.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=m,r=u.joystickPosLoc,n=u.joystickRotLoc,s=u.jumpTouchButtonLoc,a=u.rotByTouch,Jl&&u.touchControl&&(this.joystickToGameControls[r]="pos",u.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let m=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new Vqe(this.usePhysics,this.isExport);let g;m.collider.type==="sphere"?g=m.collider.radius*2:g=m.collider.height,g=Math.floor(g/m.navmesh.ch-1),this.navigationMeshWrapper.init({...m.navmesh,walkableHeight:g},this.gameControl,this.eventContext)}}if(i===!1){let{enableRotate:m,enablePan:g,enableZoom:y,autoRotate:x,hoverRotatePanMode:w}=this.eventManager.publish.orbitControls;(m||g||y||x||w!==0)&&(this.orbitControls=new fne(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let c=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((m,g)=>{let y=document.body.appendChild(document.createElement("div")),[x,w,b]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[g],C=(c-5*x)/4+x,A={},E=m==="jmp",_=E?0:x;g<10?(g<5?A.top=_/2:A.bottom=_/2,A.left=_/2+g%5*C):g===10?(A.left=_/2,A.top=h/2):(A.right=_/2,A.top=h/2),A.top?A.top-=w[1]:A.bottom+=w[1],A.left?A.left+=w[0]:A.right-=w[0];for(let D in A)A[D]+="px";if(E){let D=y.appendChild(document.createElement("div"));Object.assign(D.style,A,{position:"absolute",width:x+"px",height:x+"px",backgroundColor:`rgba(255,255,255,${b==="show"?.4:0})`,zIndex:"9999",borderRadius:x+"px",border:b==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let k=x/16*16*.4;b==="show"&&(D.innerHTML=`
						<svg width="${k}" height="${x*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),D.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),D.addEventListener("touchend",B=>B.preventDefault()),this.joysticks[g]=[void 0,y];return}let P={zone:y,mode:"static",position:A,size:x};b==="hide"&&(P.restOpacity=0);let I=h7e.create(P);I.on("move",(D,k)=>{let B=this.gameControl;m==="pos"?k.force<.2?B.moveForce=0:(B.movementState.movePosZ=Math.sin(-k.angle.radian),B.movementState.movePosX=Math.cos(-k.angle.radian),k.force>1.2?B.movementState.run=1:B.movementState.run=0,k.force<.3?B.moveForce=(k.force-.2)/.1:B.moveForce=1):m==="rot"&&(k.force<.2?B.rotForce=0:(B.movementState.rotPosX=k.vector.y,B.movementState.rotPosY=-k.vector.x,k.force<.3?B.rotForce=(k.force-.2)/.1:B.rotForce=1)),this.requestRender()}),I.on("end",(D,k)=>{let B=this.gameControl;m==="pos"?(B.movementState.movePosZ=0,B.movementState.movePosX=0,B.moveForce=1):m==="rot"&&(B.movementState.rotPosX=0,B.movementState.rotPosY=0,B.rotForce=1)}),this.joysticks[g]=[I,y]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(m=>m.initialDisabled=!1)},80)}initPhysics(){var a;(a=this.sharedGameControlGlobals.rapierWorld)==null||a.free(),this.sharedGameControlGlobals.rapierWorld=new Mr.World(new Mr.Vector3(0,this.gravity,0)),this.events=new Mr.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var x,w,b,C;let l;if(o instanceof Nu)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof Va)l=o.object;else{if(o instanceof Tb||o instanceof Sb)return;if(l=o,((x=l.dataPatched.cloner)==null?void 0:x.disabled)===!1&&((w=l.dataPatched.cloner)==null?void 0:w.hideBase)&&((b=l.dataPatched.physics)==null?void 0:b.fusedBody)!==!0)return!0}let u=l.dataPatched,c;for(let A of u.events)A.data.disabled!==!0&&A.data.type==="GameControl"&&(c=A.data);if(!u.physics||(u.physics.enabled==="visibility"?!u.visible:!u.physics.enabled))return!0;o.updateMatrixWorldSVD();let h=IA(u),d=!1,f=l.userData.hasDestroy,m=l.userData.hasDrag,g=!1;for(let A of u.events)if(A.data.disabled!==!0){if(A.data.type==="Collision"){d=!0;let E=new Iqe(A.id,A.data,l,this.page,this.sharedAssets,this.eventManager);E.initialDisabled=!0,this.collisionEvents.push(E),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(_=>_.id!==A.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(E):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[E]}else if(A.data.type==="Follow"){g=!0;let E=A.data.target;o.traverseVisible(_=>{_.userData.isFollowingObj=E})}}u.physics.rigidBody==="dynamic"&&u.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let y=o.geometry;if(c!==void 0){let A=Mr.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(Ts,lc,Kf),o.position0=Ts.clone().divideScalar(this.pixelsPerMeter),o.rotation0=lc.clone(),Ts.divideScalar(this.pixelsPerMeter),A.setTranslation(Ts.x,Ts.y,Ts.z).setRotation(lc);let E=this.sharedGameControlGlobals.rapierWorld.createRigidBody(A);o.rigidBody=E;let _;c.collider.type==="sphere"?_=Mr.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?_=Mr.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):_=Mr.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),_.setFrictionCombineRule(Mr.CoefficientCombineRule.Average).setRestitutionCombineRule(Mr.CoefficientCombineRule.Average).setDensity(u.physics.density).setFriction(u.physics.friction).setRestitution(u.physics.restitution);let P=this.sharedGameControlGlobals.rapierWorld.createCollider(_,E);this.sharedGameControlGlobals.colliderToEntity.set(P.handle,l),Ts.fromArray(c.collider.position).multiply(Kf.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),P.setTranslationWrtParent(Ts);let I=new Si().setFromEuler(new Ks().setFromVector3(new q().fromArray(c.collider.rotation)));P.setRotationWrtParent(I),P.setActiveEvents(Mr.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else u.physics.rigidBody==="dynamic"||h||g||f||m||d?(this.addRigidBody(o,l,{hasFollow:g,hasTransformAnim:h,hasDrag:m}),this.generateSensorColliderDescs(l,u.physics.fusedBody)):(y&&e.push(Fd(y,o.matrixWorld)),u.physics.fusedBody&&o.traverseObject((A,E)=>{var D;if(E===0)return;let _;if(A instanceof Nu)if(A.objectForSample){if(A.objectForSample.dataPatched.physics.fusedBody)return;_=A.object}else return A.object.dataPatched.physics.fusedBody===!0&&A.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(A instanceof Tb||A instanceof Sb)return;if(A instanceof Va)_=A.object;else if(_=A,(D=_.dataPatched.cloner)==null?void 0:D.hideBase)return!0}let P=_.dataPatched;if(P.physics.enabled==="visibility"?!P.visible:!P.physics.enabled)return!0;let I=A.geometry;(I==null?void 0:I.getAttribute("position"))!==void 0&&e.push(Fd(I,A.matrixWorld))}),this.generateSensorColliderDescs(l,u.physics.fusedBody,t));if(((C=u.physics)==null?void 0:C.fusedBody)===!0||c)return!0}),e.length===0)return;let i=Sg(e);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let r=Mr.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(r),s=Mr.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(Mr.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Mr.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[o,l]of t){let u=this.sharedGameControlGlobals.rapierWorld.createCollider(o,n);this.sensorToTriggerEvent[u.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let i=new pG(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),r=new Pt().compose(uc.fromArray(t.data.position),u0.setFromEuler(mG.fromArray(t.data.rotation)),xO);if(t.data.triggerZone==="box"){let n=new xs;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,r,e,i])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,r,e,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,i,r;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let s=n;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(i=this.gameControl)==null||i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,s])=>{n==null||n.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(r=this.navigationMeshWrapper)==null||r.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,i){if(!this.isEnabled)return!0;let r=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(r=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,r=!1):this.initializationCounter===2&&this.gameControl&&(r=!this.gameControl.update(e,t,i)&&r),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(e===0)r=this.stepPhysics()&&r;else{let s=e/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=n&&o<l&&(r=this.stepPhysics()&&r,this.accumulator-=n,o++,!(performance.now()-a>n*1e3)););this.accumulator=this.accumulator%n}}return r}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Ts,lc,Kf),vO.setFromQuaternion(lc);let i=t;i.prevR===void 0?(i.prevR=vO.clone(),i.prevT=Ts.clone()):(i.prevR.copy(vO),i.prevT.copy(Ts)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(Ts.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(lc))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,i){var s;let r=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(i))._parent,n;if(t.cloner){for(let a of t.cloner.children)if(a.rigidBody===r){n=a;break}}e.dispatch(n),t.dispatchEvent(MN)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,i){let r=gG.copy(e.matrixWorld).invert();e.traverseEntity((n,s)=>{if(t===!1&&s===1)return!0;for(let a of n.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new pG(a.id,a.data,n,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=Mr.ColliderDesc.cuboid(...a.data.size.map(u=>u/(2*this.pixelsPerMeter))):l=Mr.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(Mr.ActiveEvents.COLLISION_EVENTS),uc.fromArray(a.data.position),u0.setFromEuler(mG.fromArray(a.data.rotation)),US.compose(uc,u0,xO).premultiply(n.matrixWorld),i?(US.decompose(uc,u0,yO),l.setActiveCollisionTypes(Mr.ActiveCollisionTypes.KINEMATIC_FIXED|Mr.ActiveCollisionTypes.DYNAMIC_FIXED)):(US.premultiply(r).decompose(uc,u0,yO),e.rigidBody.bodyType()===Mr.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Mr.RigidBodyType.Fixed?l.setActiveCollisionTypes(Mr.ActiveCollisionTypes.KINEMATIC_FIXED|Mr.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(Mr.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Mr.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),uc.divideScalar(this.pixelsPerMeter),l.setTranslation(uc.x,uc.y,uc.z),l.setRotation(u0),i)i.push([l,o]);else{let u=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[u.handle]=o}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[i,r,n,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(n===o||s.isValidTriggeringObject(wr.is(o)?o:o.object)===!1)continue;let l=gG.copy(n.matrixWorld).decompose(uc,vG,yO).compose(uc,vG,xO).multiply(r),u=US.copy(o.matrixWorld).invert().multiply(l);i instanceof xs?e=o.bvhGeometry.boundsTree.intersectsBox(i,u):(bO.radius=i,bO.center.setFromMatrixPosition(u),e=o.bvhGeometry.boundsTree.intersectsSphere(bO)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),n.dispatchEvent(Jqe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(c=>c!==o)}}}};function iYe(e){let t=this._clip.duration,i=this._clip.start??0,r=this.loop,n=this.time+e,s=this._loopCount,a=r===iB;if(e===0)return s===-1?n:a&&(s&1)===1?t-(n-i):n;if(r===gJ){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=t||n<i){let o=Math.floor((n-i)/(t-i));n-=(t-i)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(n=e>0?t:i,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return t-(n-i)}return n}var yG=!1,rYe=class{constructor(e,t,i,r){this.scene=e,this.requestRender=t,this.updateDisplayProgress=i,this.animationInspectorState=r,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(n.identity)?o+=n.identity[0]:o+=n.uuid,this.clipIdToAction[o])return;let l=U3.parse(JSON.parse(s[2]));n.animations[a]=l;let u=this.mixer.clipAction(l,n);yG===!1&&(Object.getPrototypeOf(u)._updateTime=iYe,yG=!0),u.clampWhenFinished=!0,this.clipIdToAction[o]=u})},this.mixer=new $Ie(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let i=this.scene.find(t);if(!i)return;let r=i.animations.find(s=>s.uuid===e);if(!r)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(r),delete this.clipIdToAction[e],i.animations=i.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=vJ}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,i=this.clipIdToAction[t];if(i)return e&&(e.repeat>=0&&(i.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(i.loop=iB)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return Kre(this.activeClip??void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let i=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[t].paused=!0)}},_O=new WeakMap,nYe=class extends tw{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){let n=new j3(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{this.decodeDracoFile(s,t).catch(r)},i,r)}decodeDracoFile(e,t,i,r){let n={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let i=JSON.stringify(t);if(_O.has(e)){let o=_O.get(e);if(o.key===i)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(r=o,new Promise((l,u)=>{r._callbacks[n]={resolve:l,reject:u},r.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{r&&n&&this._releaseTask(r,n)}),_O.set(e,{key:i,promise:a}),a}_createGeometry(e){let t=new ai;e.index&&t.setIndex(new gi(e.index.array,1));for(let i=0;i<e.attributes.length;i++){let r=e.attributes[i],n=r.name,s=r.array,a=r.itemSize;t.setAttribute(n,new gi(s,a))}return t}_loadLibrary(e,t){let i=new j3(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,n)=>{i.load(e,r,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{let r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);let n=sYe.toString(),s=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(n){let s=n.data;switch(s.type){case"decode":r._callbacks[s.id].resolve(s);break;case"error":r._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,n){return r._taskLoad>n._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function sYe(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(c){e.onModuleLoaded=function(h){c({draco:h})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,u=o.taskConfig;t.then(c=>{let h=c.draco,d=new h.Decoder,f=new h.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let m=i(h,d,f,u),g=m.attributes.map(y=>y.array.buffer);m.index&&g.push(m.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:m},g)}catch(m){console.error(m),self.postMessage({type:"error",id:o.id,error:m.message})}finally{h.destroy(f),h.destroy(d)}});break}};function i(a,o,l,u){let c=u.attributeIDs,h=u.attributeTypes,d,f,m=o.GetEncodedGeometryType(l);if(m===a.TRIANGULAR_MESH)d=new a.Mesh,f=o.DecodeBufferToMesh(l,d);else if(m===a.POINT_CLOUD)d=new a.PointCloud,f=o.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let g={index:null,attributes:[]};for(let y in c){let x=self[h[y]],w,b;if(u.useUniqueIDs)b=c[y],w=o.GetAttributeByUniqueId(d,b);else{if(b=o.GetAttributeId(d,a[c[y]]),b===-1)continue;w=o.GetAttribute(d,b)}g.attributes.push(n(a,o,d,y,x,w))}return m===a.TRIANGULAR_MESH&&(g.index=r(a,o,d)),a.destroy(d),g}function r(a,o,l){let u=l.num_faces()*3,c=u*4,h=a._malloc(c);o.GetTrianglesUInt32Array(l,c,h);let d=new Uint32Array(a.HEAPF32.buffer,h,u).slice();return a._free(h),{array:d,itemSize:1}}function n(a,o,l,u,c,h){let d=h.num_components(),f=l.num_points()*d,m=f*c.BYTES_PER_ELEMENT,g=s(a,c),y=a._malloc(m);o.GetAttributeDataArrayForAllPoints(l,h,g,m,y);let x=new c(a.HEAPF32.buffer,y,f).slice();return a._free(y),{name:u,array:x,itemSize:d}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var Ap;function aYe(){return Ap||(Ap=new nYe,Ap.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),Ap.decoderPending}async function oYe(e){if(Ap){let t={attributeIDs:Ap.defaultAttributeIDs,attributeTypes:Ap.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await Ap.decodeGeometry(new Int8Array(e).buffer,t)}catch(r){console.error(r)}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([r,n])=>({name:r,itemSize:n.itemSize,array:n.array}))}}return null}async function lYe(e,t){let[i,r]=ete(iL.deserialize(new Uint8Array(e)));return Tte(i),r.result().data}function uYe(e){let t=[];return e.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&r.geometry.data.draco!==void 0&&t.push(r)}),t}async function cYe(e){for(let t of e){let i=await oYe(t.geometry.data.draco);if(i){let r=t.geometry.data;i.index&&(r.index={array:i.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};i.attributes.forEach(({name:s,array:a,itemSize:o})=>{n[s]={array:a,itemSize:o,type:"Float32Array",normalized:!1}}),r.attributes=n,r.draco=void 0}}}var hYe=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],i=new Date().getTime();if(this._clickCount>0){let r=t[0]-this._lastPosition[0],n=t[1]-this._lastPosition[1];Math.sqrt(r*r+n*n)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=i-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=i},this._onMouseUp=e=>{}}start(e,t=500,i=2){this._target&&this.stop(),this.reset(),this._delay=t,this._distance=i,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},dYe=class{constructor(e,t,i,r,n,s,a,o){this.eventId=e,this.id=t,this.data=i,this.dataEvent=r,this.object=n,this.stage=!1,this.actions=Ns(r,i.actions,s,a,o,n)}disconnect(){Ea(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},fYe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(i,r)=>{this.breakpoints.forEach(n=>{let s=aL.deviceToSize(n.data.size),a=n.dataEvent.orientation==="horizontal"?i:r,o;switch(n.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}n.stage!==o&&(n.stage=o,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(i=>{for(let r of i){let{width:n,height:s}=r.contentRect;this.resize(n,s)}})}connect(){let{page:e,sharedAssets:t,domElement:i}=this.eventContext;this.onResizeObserver.observe(i);let r=n=>{var s;if(!(!n.visible||!((s=n.data)!=null&&s.events.length)))for(let{data:a,id:o}of n.data.events)a.disabled||a.type==="Resize"&&a.breakpoints.forEach(({data:l,id:u})=>{try{let c=new dYe(o,u,l,a,n,e,t,this.eventManager);this.breakpoints.push(c)}catch{}})};e.traverseEntity(n=>{var s;(n instanceof fo||n instanceof va)&&((s=n.frame)==null||s.traverse(a=>{r(a)})),r(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},pYe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=({userAPIId:i})=>{this.events.forEach(r=>{r.data.userAPIId===i&&r.dispatchSuccess()})},this.onError=({userAPIId:i})=>{this.events.forEach(r=>{r.data.userAPIId===i&&r.dispatchError()})},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="API"&&!i.data.disabled).forEach(i=>{this.events.push(new mYe(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(([e,t])=>{t.on("success",this.onSuccess),t.on("error",this.onError),t.autostart&&t.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(([e,t])=>{t.off("success",this.onSuccess),t.off("error",this.onError)})}},mYe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.successActions=Ns(t,t.successActions,r,n,s,i),this.errorActions=Ns(t,t.errorActions,r,n,s,i)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},gYe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=({userWebhookId:i})=>{this.events.forEach(r=>{r.data.userWebhookId===i&&r.dispatch()})},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="WEBHOOK"&&!i.data.disabled).forEach(i=>{this.events.push(new vYe(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(([e,t])=>{t.connect(),t.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(([e,t])=>{t.off("message",this.onMessage),t.disconnect()})}},vYe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.actions=Ns(t,t.actions,r,n,s,i)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}};function yYe(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}var xYe=new q(0,0,1),xG=new q,bG=new q,_G=new Is,bYe=class{constructor(e,t,i,r,n){this.containerScene=e,this.raycaster=t,this.sharedAssets=i,this.requestRender=r,this.onExit=n,this.htmlInput=null,this.virtualInput=null,this.helper=new ere,this.doubleClickHandler=new hYe,this.isDragging=!1,this.plane=new bl,this.caretInterval=0,this.planeIntersection=new q,this.projected=new Ie,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var a;let s=(a=this.virtualInput)==null?void 0:a.data;if(this.virtualInput!==void 0&&s){let o=s.material,l=typeof o=="string"?this.sharedAssets.data.materials[o]:o,u=AHe(l,this.sharedAssets);this.helper.setCaretColor(u)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=s=>{if(!this.htmlInput||!this.virtualInput)return;let a=this.helper,o=(s==null?void 0:s.key)==="ArrowLeft"||(s==null?void 0:s.key)==="ArrowRight",l=(s==null?void 0:s.key)==="ArrowUp"||(s==null?void 0:s.key)==="ArrowDown";this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(a.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:o,verticalKeyMove:l}),this.startAnimateTextCursor()):a.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=yYe(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),(e=this.htmlInput)==null||e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var s,a;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let e=this.doubleClickHandler.clickCount,{index:t,lineIndex:i,characterIndex:r}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,e>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};(a=(s=this.virtualInput)==null?void 0:s.wrappedText)!=null&&a.length&&this.virtualInput.wrappedText[i][Math.max(0,r-1)]===`
`&&(t--,r--),this._lastIndex=t,this._isFirstDragMove=!0;let n=this.checkClickedObject();if(e===1){if(n===null)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=t,this.isDragging=!0,this.setInputSelection(t)}else n===this.virtualInput&&(e===2?this.selectClosestWord(i,r):e>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){var t;if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){let i=(t=this.data)==null?void 0:t.geometry.text;this.htmlInput.value=typeof i=="string"?"":(i==null?void 0:i.textValue.toString())??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var n;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let e=this.selectionOnDragStart,{index:t,lineIndex:i,characterIndex:r}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};i!==void 0&&r!==void 0&&((n=this.virtualInput)==null?void 0:n.wrappedText[i][r-1])===`
`&&t--,this.htmlInput.setSelectionRange(Math.min(e,t),Math.max(e,t))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof bz)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let i=this.virtualInput.wrappedText,r=i[e],n=t+1,s=t;r[t]!==" "&&(n=this.findNextCharOccurence(r,t,"forward"," "),s=this.findNextCharOccurence(r,t,"backward"," "),s>0&&s++,n>=r.length-1&&e===i.length-1&&n++);let a=this.helper,o=a.getGlobalIndexFromLineAndCharIndexes(i,e,s),l=a.getGlobalIndexFromLineAndCharIndexes(i,e,n);this.setInputSelection(o,l)}findNextCharOccurence(e,t,i,r=" "){let n=Math.max(0,e.length-1),s=i==="forward"?n:0,a=i==="forward"?1:-1,o=Math.max(Math.min(t,n),0);for(;o!==s;)if(o+=a,e.charAt(o)===r)return o;return s}getPointOnPlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;if(!(!this.virtualInput||!e)&&this.raycaster.ray.intersectsPlane(this.plane)){this.planeIntersection===null&&(this.planeIntersection=new q);let i=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(i){this.planeIntersection.copy(this.virtualInput.worldToLocal(i));let r=typeof e.geometry.width=="number"?e.geometry.width:1,n=typeof e.geometry.height=="number"?e.geometry.height:1;this.projected.set(i.x+r*.5,i.y-n*.5)}}}updatePlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&(_G.getNormalMatrix(this.virtualInput.matrixWorld),xG.copy(xYe).applyMatrix3(_G).normalize(),this.virtualInput.localToWorld(bG.set(0,0,e.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(xG,bG))}setInputSelection(e,t=e){var i;(i=this.htmlInput)==null||i.setSelectionRange(e,t),setTimeout(()=>{var r;(r=this.htmlInput)==null||r.focus()})}updateTextInputStyles(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&this.htmlInput&&(this.htmlInput.style.fontSize=e.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=e.geometry.letterSpacing*e.geometry.fontSize+"px",this.htmlInput.style.lineHeight=e.geometry.fontSize*e.geometry.lineHeight+"px",this.htmlInput.style.width=e.geometry.width+"px",this.htmlInput.style.height=e.geometry.height+"px",this.htmlInput.style.textAlign=_Ye(e.geometry.horizontalAlign))}};function _Ye(e){return e===4?"justify":e===2?"right":e===3?"center":"left"}var pne=(e,t)=>{if(typeof e=="string"){let i=t.data(e);if(i)return pne(i.value,t)}return ja.getDisplayedValue(e)};function wG(e,t){let i=e.text,r="";if(typeof i=="string"){let n=t.variables.data(r);n&&(r=pne(n.value,t.variables))}else r=i.textValue.toString();return r}var wYe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new Ol,this.helper=new ere,this._onMouseDownFocusIn=i=>{if(wi.length>1)return;this.eventContext.updateRaycaster(i);let r=null;if(this.eventContext.raycaster){for(let n of this._textInputs)if(this.eventContext.raycaster.intersectObject(n,!0).length>0){r=n;break}}this.focusOnTextInput(r),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(i),this._onMouseDown(i)},this.onExit=()=>{let{virtualInput:i}=this.textInputManager;if(i===null)return;let r=this.textInputManager.htmlInput;this.helper.hide(),r==null||r.setSelectionRange(r.value.length,r.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDown,!1),n.removeEventListener("pointerup",this._onMouseUp,!1),n.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),n.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=i=>{this.eventContext.updateRaycaster(i),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=i=>{this.eventContext.updateRaycaster(i),this.textInputManager.handleMouseMove()},this._onTextEdit=i=>{let{htmlInput:r,virtualInput:n,helper:s}=this.textInputManager;if(!r||!n)return;let a=r.value;n.textGeometry.setText(a).then(()=>{this.eventContext.requestRender()});let o=n.data;s.update();let l=o.geometry.text;if(typeof l=="string"){let u=l;this.eventContext.sharedAssets.updateVariable(u,{textValue:a})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=i=>{this.textInputManager.handleCaretUpdate(i)},this._onKeyPress=i=>{i.key==="Escape"&&this.onExit()},this.textInputManager=new bYe(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity(r=>{r instanceof bz&&e.push(r)}),this._textInputs=e,e.length===0)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let i=this.textInputManager.createInput();document.body.appendChild(i),i.style.display="none",i.addEventListener("keyup",this._onCaretUpdate),i.addEventListener("keydown",this._onCaretUpdate),i.addEventListener("beforeinput",this._onCaretUpdate),i.addEventListener("paste",this._onCaretUpdate),i.addEventListener("cut",this._onCaretUpdate),i.addEventListener("select",this._onCaretUpdate),i.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),e==null||e.removeEventListener("keyup",this._onCaretUpdate),e==null||e.removeEventListener("keydown",this._onCaretUpdate),e==null||e.removeEventListener("beforeinput",this._onCaretUpdate),e==null||e.removeEventListener("paste",this._onCaretUpdate),e==null||e.removeEventListener("cut",this._onCaretUpdate),e==null||e.removeEventListener("select",this._onCaretUpdate),e==null||e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(i=>{let r=wG(i.data.geometry,this.eventContext.sharedAssets.data);i.textGeometry.setText(r)}),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||e===null)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let i=wG(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=i,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:r}=this.eventContext;r.removeEventListener("pointerdown",this._onMouseDownFocusIn),r.addEventListener("pointerdown",this._onMouseDown,!1),r.addEventListener("pointerup",this._onMouseUp,!1),r.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},EYe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=({value:i,frequencies:r})=>{this.events.forEach(n=>{n.dispatch()})}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="AIAssistantListener"&&!i.data.disabled).forEach(i=>{this.events.push(new SYe(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){var e;(e=this.openAIRealtime)==null||e.off("voice",this.onVoice)}},SYe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.actions=Ns(t,t.actions,r,n,s,i)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},TYe=class extends xo{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=({description:i,direction:r})=>{let n=this.events.find(s=>s.data.description===i);n&&(r==="backward"?n.dispatchReverse():n.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="AIAssistantTrigger"&&!i.data.disabled).forEach(i=>{this.events.push(new CYe(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){var e;(e=this.openAIRealtime)==null||e.off("trigger_event",this.onTriggerEvent)}},CYe=class{constructor(e,t,i,r,n,s){this.id=e,this.data=t,this.object=i,this.actions=Ns(t,t.actions,r,n,s,i)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispatchReverse(){let e=this.actions;e.Transition.forEach(t=>t.reverseFromCurrent()),e.Particles.forEach(t=>t.reverseFromCurrent()),e.Animation.forEach(t=>t.reverseFromCurrent()),e.SwitchCamera.forEach(t=>t.reverseFromCurrent()),e.Create.forEach(t=>t.dispatchStop())}},AYe=class{constructor(e,t,i,r,n){this.publish=e,this.controlsManager=t,this.animationControls=i,this.eventContext=r,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=s=>{let a=window.parent!==window,o=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(s.touches.length>1||this.preventTouchScroll||a===!1&&o===!1)&&s.preventDefault()},this.onMouseWheelPreventScroll=s=>{this.preventScroll&&s.preventDefault()},this.onMouseMove=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:s.buttons>0}},this.onMouseDown=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!0}},this.onMouseUp=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!1}},this.getMousePosition=s=>{var u;let{domRect:a}=this.eventContext,{pageX:o,pageY:l}=((u=s.touches)==null?void 0:u.length)>0?s.touches[0]:s;return{x:o-(a.left+window.scrollX),y:l-(a.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=r.requestRender}activate(e=!1){var r;if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new eqe(this.eventContext),VariableChange:new Oqe(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new pYe(this.eventContext,this),WEBHOOK:new gYe(this.eventContext,this),AIAssistantListener:new EYe(this.eventContext,this),AIAssistantTrigger:new TYe(this.eventContext,this),Conditional:new oqe(this.eventContext,this),Start:new Dqe(this.eventContext,this),Basic:new iqe(this.eventContext,this,this.needsRaycast),MouseHover:new Tqe(this.eventContext,this),Scroll:new Mqe(this.eventContext,this),Follow:new vqe(this.eventContext,this),DragDrop:new dqe(this.eventContext,this),LookAt:new wqe(this.eventContext),Resize:new fYe(this.eventContext,this),Textfields:new wYe(this.eventContext,this)};let{page:t,domElement:i}=this.eventContext;this.hideCursor&&(i.style.cursor="none"),t.traverseEntity(n=>{n.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(n=>n.connect()),i.addEventListener("wheel",this.onMouseWheelPreventScroll),i.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,e||((r=this.eventContext.sharedAssets.openAIRealtime)==null||r.connect())}deactivate(e=!1){var r,n;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:t,domElement:i}=this.eventContext;i.style.cursor="",Object.values(this.handlers).forEach(s=>s.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity(s=>{s.removeEventListener("requestRender",this.requestRender),s.destroyedInAction=!1}),i.removeEventListener("touchmove",this.onTouchMovePreventScroll),i.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),e||((n=this.eventContext.sharedAssets.openAIRealtime)==null||n.disconnect())}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.activate(this),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=i=>{if(i.data.type==="Conditional"&&(i.data.ifActions.forEach(t),i.data.elseActions.forEach(t)),i.data.type==="Conditional"||i.data.type==="SetVariable")for(let r of i.data.type==="Conditional"?i.data.condition:i.data.expression)"id"in r&&Array.isArray(r.id)&&(r.id[0]==="mouse"&&(this.needsMouse=!0),r.id[0]==="raycast"&&(this.needsRaycast=!0));i.data.type==="DynamicVariablePlay"&&i.data.variableId!==""&&(i.data.mode==="Play"||i.data.mode==="PlayPause"||i.data.mode==="Toggle")&&e.setDynamicVariablePlayState(i.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(i=>{var r;if((r=i.data)!=null&&r.events.length)for(let n of i.data.events)if(n.data.type==="VariableChange"&&(n.data.variableId==="mouseProperty"&&(this.needsMouse=!0),n.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),n.data.type==="Conditional")for(let s of["inActions","outActions"])n.data[s].forEach(t);else if(n.data.type==="DragDrop")for(let s of["drag","drop"])n.data.dragDropActions[s].forEach(t);else if(n.data.type==="GameControl")for(let s of["idle","move","jump","run"])n.data.gameActions[s].forEach(t);else if(n.data.type==="Resize")for(let s of n.data.breakpoints)s.data.actions.forEach(t);else n.data.type==="LookAt"||n.data.type==="API"||n.data.actions.forEach(t)})}},MYe=class{constructor(e,t,i,r,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new Ie().copy(i),this._editorSize=new Ie().copy(r),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,i=this._editorSize.y;this._aspect=e/t,t<=i&&(this._camera.zoom*=i/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,i=this._editorSize.y,r=this._fov;if(e&&t>i){let n=PYe(t,1080,2160,1,15)/100;r*=t/i,r*=1-n}this._camera.aspect=this._aspect,this._camera.fov=r,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function PYe(e,t,i,r,n){return(e-t)/(i-t)*(n-r)+r}var DYe=class{get sharedAssets(){return this.shared}constructor(e,t={},i=!0){this.shared=new uz(e.shared,t,!0,i),this.scene=new Ez(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof va&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof Os&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},IYe=class{constructor({x:e=10,y:t=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function OYe(e){let t;if(e.index)for(let i=0;i<e.index.array.length;i+=3)t=e.index.array[i],e.index.array[i]=e.index.array[i+2],e.index.array[i+2]=t}function Db(e){return e instanceof C_?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function RYe(e,t){let i={};return e.traverseEntity(r=>{var l;if(!r.visible||!(r instanceof Ko)||r.type!=="Mesh"||Array.isArray(r.material)||r.states&&Object.keys(r.states).length)return;let n=r.parent;for(;n;){if(n instanceof Ko&&r.states&&Object.keys(r.states).length)return;n=n.parent}let s=r.material.uuid,a=t.shared.materials[s];if(a){if(!ba.isMergable(a))return}else{let u=(l=t.scene.objects.get(r.uuid))==null?void 0:l.data;if(u&&"material"in u&&typeof u.material!="string"){if(!ba.isMergable(u.material))return;s=ba.getHash(u.material)}}i[s]||(i[s]={});let o=i[s][Db(r)];if(o){if(o.push(r),r.cloner)for(let u of r.cloner.children)o.push(u)}else if(i[s][Db(r)]=[r],r.cloner)for(let u of r.cloner.children)i[s][Db(r)].push(u)}),i}function LYe(e){let t=0;return Object.values(e).forEach(i=>{Object.values(i).forEach(r=>{let n=r.length;n>t&&(t=n)})}),t}function NYe(e,t){let i=RYe(t,e),r=LYe(i),n=new Array(r),s=0,a=new Array(r),o=0,l=new Array(r),u=0,c=new Array(r),h=0;for(let[d,f]of Object.entries(i))for(let m of Object.values(f)){if(o=0,u=0,m.forEach(y=>{y instanceof Ko&&(a[o++]=y.geometry.clone(),l[u++]=y)}),u<2)continue;for(let y=0;y<u;y++)l[y].updateWorldMatrix(!0,!1),a[y].applyMatrix4(l[y].matrixWorld),l[y].matrixWorld.determinant()<0&&OYe(a[y]);let g=Sg(a.slice(0,o),!1);if(g){let y;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),y=new dn(g,l[0].material);break}default:{y=new dn(g,l[0].material);break}}y.castShadow=l[0].castShadow,y.receiveShadow=l[0].receiveShadow,t.add(y);let x=w=>{h=0;for(let b of w)b.children&&x(b.children),b instanceof Ko&&(Array.isArray(b.material)||i[b.material.uuid]&&i[b.material.uuid][Db(b)]&&i[b.material.uuid][Db(b)].length>1||(c[h++]=b));for(let b=0;b<h;b++)t.attach(c[b])};for(let w=0;w<u;w++){let b=l[w];x(b.children),n[s++]=b}}}for(let d=0;d<s;d++)n[d].removeFromParent()}var kYe=nm(LTe(),1),BYe=new Ie;function zYe(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var FYe=class{constructor(e,{renderOnDemand:t,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=r=>{var n,s,a,o,l,u,c,h,d,f,m,g,y;if(this.time=r,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(a=this._perfs)==null||a.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(u=this._eventManager.handlers)!=null&&u.Conditional.hasVideoAction)&&(this._skipRender=!1),(c=this._animationControls)==null||c.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(h=this._scene)==null||h.traverseVisibleEntity(x=>{x.type==="ParticleSystem"&&(x.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(d=this._eventManager)!=null&&d.isEnabled&&(((f=this._eventManager.handlers)==null?void 0:f.Follow).onAnimationFrameDamping(),((m=this._eventManager.handlers)==null?void 0:m.LookAt).onAnimationFrameDamping(),((g=this._eventManager.handlers)==null?void 0:g.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let x=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=x,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(y=this._perfs)==null||y.end()},this._resize=r=>{var n,s,a,o,l,u,c,h,d,f;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=BYe.set(this._viewportWidth,this._viewportHeight)),r){let m=this._viewportWidth,g=this._viewportHeight;this._renderer.setSize(m-1,g-1,!1),this._renderer.setSize(m,g,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=(n=this._scene)==null?void 0:n.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((a=(s=this._frameView)==null?void 0:s.frameSize)==null?void 0:a.x)??this._viewportWidth,((l=(o=this._frameView)==null?void 0:o.frameSize)==null?void 0:l.y)??this._viewportHeight,((u=this._frameView)==null?void 0:u.enableResponsive)??!1),this._camera){let m=Object.values(((h=this._data)==null?void 0:h.frames)??{})[0].preset??"fullscreen";(d=this._frameView)==null||d.setCamera(this._camera),(f=this._frameView)==null||f.updateCamera(m!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=p_(this._resize,10),this._onScroll=r=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new IYe({x:10,y:10})),Rze(e)}async load(e,t,i){zYe(e),this.disposed=!1;let r=await(await fetch(e,i)).arrayBuffer();await this.start(r,{variables:t})}async start(e,{interactive:t=!0,variables:i}={}){var l,u,c,h;if(this.disposed)return;let r=await lYe(e);this._data=r;let n=uYe(r);r.version&&(0,kYe.default)(r.version,"1.9.81")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([n.length&&aYe(),qW(r)&&B6e(),VVe(r)&&R6e(),x_.physicsEnabled(r.scene.objects)&&zze(),jW(r)&&yVe(),w7(r)&&JWe(),gVe(r)&&mVe(),f7(r)&&FHe(),Wqe(r)&&kze()].filter(Boolean)),n.length&&await cYe(n),(l=this._eventManager)==null||l.deactivate(),(u=this._controls)==null||u.deactivate(),(c=this._scene)==null||c.dispose();let s=new DYe(r);if(s.resetPersonalCameraFromDocumentData(),this._scene=s.scene,this._sharedAssetsManager=s.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let d=performance.now();NYe(r,s.scene);let f=performance.now();console.log("Merged geometries in ",f-d," ms")}qW(r)&&this._scene.traverse(d=>{$d(d)&&d.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var d;this._requestRenderAutoMode(),(d=this._scene)==null||d.traverse(f=>{f instanceof Nu&&f.pendingMediaLoad&&f.update()})}),(h=this._scene)==null||h.traverse(d=>{d.type==="ParticleSystem"&&(d.wakeUp(),d.data.autoPlay?d.start():d.stop())});let a=Object.keys(r.shared.fonts).map(d=>this._sharedAssetsManager.getFont(d).loadingPromise);if(Promise.all(a).then(()=>{s.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),jW(r)&&eYe(r)&&await Promise.all(a),f7(r)){let d=[];this._scene.traverseEntity(f=>{(f instanceof fo||f instanceof va)&&f.uiCanvas&&d.push(f.uiCanvas)}),await Promise.all(d.map(f=>f.promise))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),kz(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new THe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=r.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),r.shared.images.SplineWatermark)){let d=this._sharedAssetsManager.getImage("SplineWatermark");await d.loadPromise;let f=d.getTexture(1001);this._renderer.pipeline.setWatermark(f)}w7(r)&&this._scene.initializeSplatViewer(),r.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(r.scene.blueNoiseTextureData);let o=Object.values(r.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(o.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=o.size[0],this._viewportHeight=o.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new MYe(this._renderer,this._camera,new Ie(this._viewportWidth,this._viewportHeight),new Ie(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(o.allowResponsive??!1)&&o.preset==="fullscreen"),t){let d=new QGe(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,o);this._scene.updateMatrixWorld(!0),this._controls=new tYe(d),this._animationControls=new rYe(this._scene,this._requestRenderAutoMode),this._eventManager=new AYe(r.scene.publish,this._controls,this._animationControls,d,r.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),i!==void 0&&this.setVariables(i),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var d;(d=this._renderer)==null||d.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[i,r]of t)this.setVariable(i,r)}}setVariable(e,t){var r;let i=this._getVariableByName(e);if(i&&!("dynamicVariableType"in i.data)){let n=t;typeof i.data.value=="number"?n=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof i.data.value=="boolean"?n=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof i.data.value!="string"&&i.data.value.textValue!==void 0&&(n=t.toString());let s=typeof n=="string"?{textValue:n}:n;(r=this._sharedAssetsManager)==null||r.updateVariable(i.id,s),this.requestRender(),this._requestRenderAutoMode()}else i===void 0?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in i.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let i=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(i)}}_getVariableValue(e){return typeof e!="string"&&ja.isTextValue(e)?ja.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(i=>i.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(i=>{if(i.uuid!==m1&&!this._scene.isInvisibleObjects(i)&&!(i instanceof va)){let r=this._createProxyObject(i);r&&e.push(r)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEvent(e)}emitEventReverse(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,i;((t=this._controls)==null?void 0:t.orbitControls)instanceof fne&&((i=this._controls)==null||i.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var a;let{r:t,g:i,b:r,a:n}={r:0,g:0,b:0,a:1},s=new Wa(t,i,r,n);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(a=this._scene)==null||a.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,i,r,n,s,a;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(o=>{K8.unsubscribe(o)}),this._variablesCache.clear(),(r=this._renderer)==null||r.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(a=this._controls)==null||a.deactivate(),this.dt=0,Lze(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,i;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,i;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(s=>{s instanceof va&&(t=s.name)});let i={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof va||e instanceof Ez||(n=e.parent)==null?void 0:n.uuid,emitEvent(s){e.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){e.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},r=K8(i,(s,a)=>{var o;typeof e[s]!="object"&&((o=Object.getOwnPropertyDescriptor(e,s))!=null&&o.writable)&&(e[s]=a),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,r),r}setUIWasmUrl(e){Rie.skiaWasmUrl=e}},jS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},PN={},UYe={get exports(){return PN},set exports(e){PN=e}},Sx={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EG;function jYe(){if(EG)return Sx;EG=1;var e=ci,t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var c,h={},d=null,f=null;u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(c in l)r.call(l,c)&&!s.hasOwnProperty(c)&&(h[c]=l[c]);if(o&&o.defaultProps)for(c in l=o.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:t,type:o,key:d,ref:f,props:h,_owner:n.current}}return Sx.Fragment=i,Sx.jsx=a,Sx.jsxs=a,Sx}(function(e){e.exports=jYe()})(UYe);const DN=PN.jsx;var VYe="Expected a function",SG=NaN,HYe="[object Symbol]",WYe=/^\s+|\s+$/g,GYe=/^[-+]0x[0-9a-f]+$/i,qYe=/^0b[01]+$/i,YYe=/^0o[0-7]+$/i,XYe=parseInt,KYe=typeof jS=="object"&&jS&&jS.Object===Object&&jS,$Ye=typeof self=="object"&&self&&self.Object===Object&&self,ZYe=KYe||$Ye||Function("return this")(),QYe=Object.prototype,JYe=QYe.toString,eXe=Math.max,tXe=Math.min,wO=function(){return ZYe.Date.now()};function iXe(e,t,i){var r,n,s,a,o,l,u=0,c=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(VYe);t=TG(t)||0,IN(i)&&(c=!!i.leading,h="maxWait"in i,s=h?eXe(TG(i.maxWait)||0,t):s,d="trailing"in i?!!i.trailing:d);function f(E){var _=r,P=n;return r=n=void 0,u=E,a=e.apply(P,_),a}function m(E){return u=E,o=setTimeout(x,t),c?f(E):a}function g(E){var _=E-l,P=E-u,I=t-_;return h?tXe(I,s-P):I}function y(E){var _=E-l,P=E-u;return l===void 0||_>=t||_<0||h&&P>=s}function x(){var E=wO();if(y(E))return w(E);o=setTimeout(x,g(E))}function w(E){return o=void 0,d&&r?f(E):(r=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),u=0,r=l=n=o=void 0}function C(){return o===void 0?a:w(wO())}function A(){var E=wO(),_=y(E);if(r=arguments,n=this,l=E,_){if(o===void 0)return m(l);if(h)return o=setTimeout(x,t),f(l)}return o===void 0&&(o=setTimeout(x,t)),a}return A.cancel=b,A.flush=C,A}function IN(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function rXe(e){return!!e&&typeof e=="object"}function nXe(e){return typeof e=="symbol"||rXe(e)&&JYe.call(e)==HYe}function TG(e){if(typeof e=="number")return e;if(nXe(e))return SG;if(IN(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=IN(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(WYe,"");var i=qYe.test(e);return i||YYe.test(e)?XYe(e.slice(2),i?2:8):GYe.test(e)?SG:+e}var sXe=iXe;function aXe(e){return t=>{e.forEach(i=>{typeof i=="function"?i(t):i!=null&&(i.current=t)})}}const oXe=[],lXe={width:"100%",height:"100%"},uXe=de.forwardRef(function({className:e,children:t,debounceTime:i=300,ignoreDimensions:r=oXe,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const u=de.useRef(null),c=de.useRef(0),[h,d]=de.useState({width:0,height:0,top:0,left:0}),f=de.useMemo(()=>{const m=Array.isArray(r)?r:[r];return sXe(g=>{d(y=>Object.keys(y).filter(x=>y[x]!==g[x]).every(x=>m.includes(x))?y:g)},i,{leading:s})},[i,s,r]);return de.useEffect(()=>{const m=a||window.ResizeObserver,g=new m(y=>{y.forEach(x=>{const{left:w,top:b,width:C,height:A}=(x==null?void 0:x.contentRect)??{};c.current=window.requestAnimationFrame(()=>{f({width:C,height:A,top:b,left:w})})})});return u.current&&g.observe(u.current),()=>{window.cancelAnimationFrame(c.current),g.disconnect(),f.cancel()}},[f,a]),DN("div",{style:{...lXe,...n},ref:aXe([l,u]),className:e,...o,children:t({...h,ref:u.current,resize:f})})}),mne=de.forwardRef(({scene:e,style:t,onMouseDown:i,onMouseUp:r,onMouseHover:n,onKeyDown:s,onKeyUp:a,onStart:o,onLookAt:l,onFollow:u,onWheel:c,onLoad:h,renderOnDemand:d=!0,...f},m)=>{const g=de.useRef(null),[y,x]=de.useState(!0);return de.useEffect(()=>{x(!0);let w;const b=[{name:"mouseDown",cb:i},{name:"mouseUp",cb:r},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:u},{name:"scroll",cb:c}];if(g.current){w=new FYe(g.current,{renderOnDemand:d});async function C(){await w.load(e);for(let A of b)A.cb&&w.addEventListener(A.name,A.cb);x(!1),h==null||h(w)}C()}return()=>{for(let C of b)C.cb&&w.removeEventListener(C.name,C.cb);w.dispose()}},[e]),DN(uXe,{ref:m,parentSizeStyles:t,debounceTime:50,...f,children:()=>DN("canvas",{ref:g,style:{display:y?"none":"block"}})})}),cXe=Object.freeze(Object.defineProperty({__proto__:null,default:mne},Symbol.toStringTag,{value:"Module"}));function hXe(e,t){const i={};return(e[e.length-1]===""?[...e,""]:e).join((i.padRight?" ":"")+","+(i.padLeft===!1?"":" ")).trim()}const dXe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,fXe=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,pXe={};function CG(e,t){return(pXe.jsx?fXe:dXe).test(e)}const mXe=/[ \t\n\f\r]/g;function gXe(e){return typeof e=="object"?e.type==="text"?AG(e.value):!1:AG(e)}function AG(e){return e.replace(mXe,"")===""}class pw{constructor(t,i,r){this.normal=i,this.property=t,r&&(this.space=r)}}pw.prototype.normal={};pw.prototype.property={};pw.prototype.space=void 0;function gne(e,t){const i={},r={};for(const n of e)Object.assign(i,n.property),Object.assign(r,n.normal);return new pw(i,r,t)}function ON(e){return e.toLowerCase()}class kl{constructor(t,i){this.attribute=i,this.property=t}}kl.prototype.attribute="";kl.prototype.booleanish=!1;kl.prototype.boolean=!1;kl.prototype.commaOrSpaceSeparated=!1;kl.prototype.commaSeparated=!1;kl.prototype.defined=!1;kl.prototype.mustUseProperty=!1;kl.prototype.number=!1;kl.prototype.overloadedBoolean=!1;kl.prototype.property="";kl.prototype.spaceSeparated=!1;kl.prototype.space=void 0;let vXe=0;const sr=pv(),Cs=pv(),vne=pv(),Ft=pv(),vn=pv(),yy=pv(),Xl=pv();function pv(){return 2**++vXe}const RN=Object.freeze(Object.defineProperty({__proto__:null,boolean:sr,booleanish:Cs,commaOrSpaceSeparated:Xl,commaSeparated:yy,number:Ft,overloadedBoolean:vne,spaceSeparated:vn},Symbol.toStringTag,{value:"Module"})),EO=Object.keys(RN);class zz extends kl{constructor(t,i,r,n){let s=-1;if(super(t,i),MG(this,"space",n),typeof r=="number")for(;++s<EO.length;){const a=EO[s];MG(this,EO[s],(r&RN[a])===RN[a])}}}zz.prototype.defined=!0;function MG(e,t,i){i&&(e[t]=i)}function b1(e){const t={},i={};for(const[r,n]of Object.entries(e.properties)){const s=new zz(r,e.transform(e.attributes||{},r),n,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),t[r]=s,i[ON(r)]=r,i[ON(s.attribute)]=r}return new pw(t,i,e.space)}const yne=b1({properties:{ariaActiveDescendant:null,ariaAtomic:Cs,ariaAutoComplete:null,ariaBusy:Cs,ariaChecked:Cs,ariaColCount:Ft,ariaColIndex:Ft,ariaColSpan:Ft,ariaControls:vn,ariaCurrent:null,ariaDescribedBy:vn,ariaDetails:null,ariaDisabled:Cs,ariaDropEffect:vn,ariaErrorMessage:null,ariaExpanded:Cs,ariaFlowTo:vn,ariaGrabbed:Cs,ariaHasPopup:null,ariaHidden:Cs,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:vn,ariaLevel:Ft,ariaLive:null,ariaModal:Cs,ariaMultiLine:Cs,ariaMultiSelectable:Cs,ariaOrientation:null,ariaOwns:vn,ariaPlaceholder:null,ariaPosInSet:Ft,ariaPressed:Cs,ariaReadOnly:Cs,ariaRelevant:null,ariaRequired:Cs,ariaRoleDescription:vn,ariaRowCount:Ft,ariaRowIndex:Ft,ariaRowSpan:Ft,ariaSelected:Cs,ariaSetSize:Ft,ariaSort:null,ariaValueMax:Ft,ariaValueMin:Ft,ariaValueNow:Ft,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function xne(e,t){return t in e?e[t]:t}function bne(e,t){return xne(e,t.toLowerCase())}const yXe=b1({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:yy,acceptCharset:vn,accessKey:vn,action:null,allow:null,allowFullScreen:sr,allowPaymentRequest:sr,allowUserMedia:sr,alt:null,as:null,async:sr,autoCapitalize:null,autoComplete:vn,autoFocus:sr,autoPlay:sr,blocking:vn,capture:null,charSet:null,checked:sr,cite:null,className:vn,cols:Ft,colSpan:null,content:null,contentEditable:Cs,controls:sr,controlsList:vn,coords:Ft|yy,crossOrigin:null,data:null,dateTime:null,decoding:null,default:sr,defer:sr,dir:null,dirName:null,disabled:sr,download:vne,draggable:Cs,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:sr,formTarget:null,headers:vn,height:Ft,hidden:sr,high:Ft,href:null,hrefLang:null,htmlFor:vn,httpEquiv:vn,id:null,imageSizes:null,imageSrcSet:null,inert:sr,inputMode:null,integrity:null,is:null,isMap:sr,itemId:null,itemProp:vn,itemRef:vn,itemScope:sr,itemType:vn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:sr,low:Ft,manifest:null,max:null,maxLength:Ft,media:null,method:null,min:null,minLength:Ft,multiple:sr,muted:sr,name:null,nonce:null,noModule:sr,noValidate:sr,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:sr,optimum:Ft,pattern:null,ping:vn,placeholder:null,playsInline:sr,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:sr,referrerPolicy:null,rel:vn,required:sr,reversed:sr,rows:Ft,rowSpan:Ft,sandbox:vn,scope:null,scoped:sr,seamless:sr,selected:sr,shadowRootClonable:sr,shadowRootDelegatesFocus:sr,shadowRootMode:null,shape:null,size:Ft,sizes:null,slot:null,span:Ft,spellCheck:Cs,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ft,step:null,style:null,tabIndex:Ft,target:null,title:null,translate:null,type:null,typeMustMatch:sr,useMap:null,value:Cs,width:Ft,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:vn,axis:null,background:null,bgColor:null,border:Ft,borderColor:null,bottomMargin:Ft,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:sr,declare:sr,event:null,face:null,frame:null,frameBorder:null,hSpace:Ft,leftMargin:Ft,link:null,longDesc:null,lowSrc:null,marginHeight:Ft,marginWidth:Ft,noResize:sr,noHref:sr,noShade:sr,noWrap:sr,object:null,profile:null,prompt:null,rev:null,rightMargin:Ft,rules:null,scheme:null,scrolling:Cs,standby:null,summary:null,text:null,topMargin:Ft,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ft,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:sr,disableRemotePlayback:sr,prefix:null,property:null,results:Ft,security:null,unselectable:null},space:"html",transform:bne}),xXe=b1({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Xl,accentHeight:Ft,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ft,amplitude:Ft,arabicForm:null,ascent:Ft,attributeName:null,attributeType:null,azimuth:Ft,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ft,by:null,calcMode:null,capHeight:Ft,className:vn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ft,diffuseConstant:Ft,direction:null,display:null,dur:null,divisor:Ft,dominantBaseline:null,download:sr,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ft,enableBackground:null,end:null,event:null,exponent:Ft,externalResourcesRequired:null,fill:null,fillOpacity:Ft,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:yy,g2:yy,glyphName:yy,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ft,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ft,horizOriginX:Ft,horizOriginY:Ft,id:null,ideographic:Ft,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ft,k:Ft,k1:Ft,k2:Ft,k3:Ft,k4:Ft,kernelMatrix:Xl,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ft,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ft,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ft,overlineThickness:Ft,paintOrder:null,panose1:null,path:null,pathLength:Ft,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:vn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ft,pointsAtY:Ft,pointsAtZ:Ft,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Xl,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Xl,rev:Xl,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Xl,requiredFeatures:Xl,requiredFonts:Xl,requiredFormats:Xl,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ft,specularExponent:Ft,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ft,strikethroughThickness:Ft,string:null,stroke:null,strokeDashArray:Xl,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ft,strokeOpacity:Ft,strokeWidth:null,style:null,surfaceScale:Ft,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Xl,tabIndex:Ft,tableValues:null,target:null,targetX:Ft,targetY:Ft,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Xl,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ft,underlineThickness:Ft,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ft,values:null,vAlphabetic:Ft,vMathematical:Ft,vectorEffect:null,vHanging:Ft,vIdeographic:Ft,version:null,vertAdvY:Ft,vertOriginX:Ft,vertOriginY:Ft,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ft,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:xne}),_ne=b1({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),wne=b1({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:bne}),Ene=b1({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),bXe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},_Xe=/[A-Z]/g,PG=/-[a-z]/g,wXe=/^data[-\w.:]+$/i;function EXe(e,t){const i=ON(t);let r=t,n=kl;if(i in e.normal)return e.property[e.normal[i]];if(i.length>4&&i.slice(0,4)==="data"&&wXe.test(t)){if(t.charAt(4)==="-"){const s=t.slice(5).replace(PG,TXe);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=t.slice(4);if(!PG.test(s)){let a=s.replace(_Xe,SXe);a.charAt(0)!=="-"&&(a="-"+a),t="data"+a}}n=zz}return new n(r,t)}function SXe(e){return"-"+e.toLowerCase()}function TXe(e){return e.charAt(1).toUpperCase()}const CXe=gne([yne,yXe,_ne,wne,Ene],"html"),Fz=gne([yne,xXe,_ne,wne,Ene],"svg");function AXe(e){return e.join(" ").trim()}var Uz={},DG=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,MXe=/\n/g,PXe=/^\s*/,DXe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,IXe=/^:\s*/,OXe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,RXe=/^[;\s]*/,LXe=/^\s+|\s+$/g,NXe=`
`,IG="/",OG="*",fg="",kXe="comment",BXe="declaration",zXe=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var i=1,r=1;function n(m){var g=m.match(MXe);g&&(i+=g.length);var y=m.lastIndexOf(NXe);r=~y?m.length-y:r+m.length}function s(){var m={line:i,column:r};return function(g){return g.position=new a(m),u(),g}}function a(m){this.start=m,this.end={line:i,column:r},this.source=t.source}a.prototype.content=e;function o(m){var g=new Error(t.source+":"+i+":"+r+": "+m);if(g.reason=m,g.filename=t.source,g.line=i,g.column=r,g.source=e,!t.silent)throw g}function l(m){var g=m.exec(e);if(g){var y=g[0];return n(y),e=e.slice(y.length),g}}function u(){l(PXe)}function c(m){var g;for(m=m||[];g=h();)g!==!1&&m.push(g);return m}function h(){var m=s();if(!(IG!=e.charAt(0)||OG!=e.charAt(1))){for(var g=2;fg!=e.charAt(g)&&(OG!=e.charAt(g)||IG!=e.charAt(g+1));)++g;if(g+=2,fg===e.charAt(g-1))return o("End of comment missing");var y=e.slice(2,g-2);return r+=2,n(y),e=e.slice(g),r+=2,m({type:kXe,comment:y})}}function d(){var m=s(),g=l(DXe);if(g){if(h(),!l(IXe))return o("property missing ':'");var y=l(OXe),x=m({type:BXe,property:RG(g[0].replace(DG,fg)),value:y?RG(y[0].replace(DG,fg)):fg});return l(RXe),x}}function f(){var m=[];c(m);for(var g;g=d();)g!==!1&&(m.push(g),c(m));return m}return u(),f()};function RG(e){return e?e.replace(LXe,fg):fg}var FXe=Nr&&Nr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Uz,"__esModule",{value:!0});Uz.default=jXe;var UXe=FXe(zXe);function jXe(e,t){var i=null;if(!e||typeof e!="string")return i;var r=(0,UXe.default)(e),n=typeof t=="function";return r.forEach(function(s){if(s.type==="declaration"){var a=s.property,o=s.value;n?t(a,o,s):o&&(i=i||{},i[a]=o)}}),i}var YM={};Object.defineProperty(YM,"__esModule",{value:!0});YM.camelCase=void 0;var VXe=/^--[a-zA-Z0-9_-]+$/,HXe=/-([a-z])/g,WXe=/^[^-]+$/,GXe=/^-(webkit|moz|ms|o|khtml)-/,qXe=/^-(ms)-/,YXe=function(e){return!e||WXe.test(e)||VXe.test(e)},XXe=function(e,t){return t.toUpperCase()},LG=function(e,t){return"".concat(t,"-")},KXe=function(e,t){return t===void 0&&(t={}),YXe(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(qXe,LG):e=e.replace(GXe,LG),e.replace(HXe,XXe))};YM.camelCase=KXe;var $Xe=Nr&&Nr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ZXe=$Xe(Uz),QXe=YM;function LN(e,t){var i={};return!e||typeof e!="string"||(0,ZXe.default)(e,function(r,n){r&&n&&(i[(0,QXe.camelCase)(r,t)]=n)}),i}LN.default=LN;var JXe=LN;const eKe=O_(JXe),Sne=Tne("end"),jz=Tne("start");function Tne(e){return t;function t(i){const r=i&&i.position&&i.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function tKe(e){const t=jz(e),i=Sne(e);if(t&&i)return{start:t,end:i}}function Ib(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?NG(e.position):"start"in e||"end"in e?NG(e):"line"in e||"column"in e?NN(e):""}function NN(e){return kG(e&&e.line)+":"+kG(e&&e.column)}function NG(e){return NN(e&&e.start)+"-"+NN(e&&e.end)}function kG(e){return e&&typeof e=="number"?e:1}class bo extends Error{constructor(t,i,r){super(),typeof i=="string"&&(r=i,i=void 0);let n="",s={},a=!1;if(i&&("line"in i&&"column"in i?s={place:i}:"start"in i&&"end"in i?s={place:i}:"type"in i?s={ancestors:[i],place:i.position}:s={...i}),typeof t=="string"?n=t:!s.cause&&t&&(a=!0,n=t.message,s.cause=t),!s.ruleId&&!s.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?s.ruleId=r:(s.source=r.slice(0,l),s.ruleId=r.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=n,this.line=o?o.line:void 0,this.name=Ib(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}}bo.prototype.file="";bo.prototype.name="";bo.prototype.reason="";bo.prototype.message="";bo.prototype.stack="";bo.prototype.column=void 0;bo.prototype.line=void 0;bo.prototype.ancestors=void 0;bo.prototype.cause=void 0;bo.prototype.fatal=void 0;bo.prototype.place=void 0;bo.prototype.ruleId=void 0;bo.prototype.source=void 0;const Vz={}.hasOwnProperty,iKe=new Map,rKe=/[A-Z]/g,nKe=new Set(["table","tbody","thead","tfoot","tr"]),sKe=new Set(["td","th"]),Cne="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function aKe(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const i=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=pKe(i,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=fKe(i,t.jsx,t.jsxs)}const n={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:i,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Fz:CXe,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},s=Ane(n,e,void 0);return s&&typeof s!="string"?s:n.create(e,n.Fragment,{children:s||void 0},void 0)}function Ane(e,t,i){if(t.type==="element")return oKe(e,t,i);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return lKe(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return cKe(e,t,i);if(t.type==="mdxjsEsm")return uKe(e,t);if(t.type==="root")return hKe(e,t,i);if(t.type==="text")return dKe(e,t)}function oKe(e,t,i){const r=e.schema;let n=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=Fz,e.schema=n),e.ancestors.push(t);const s=Pne(e,t.tagName,!1),a=mKe(e,t);let o=Wz(e,t);return nKe.has(t.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!gXe(l):!0})),Mne(e,a,s,t),Hz(a,o),e.ancestors.pop(),e.schema=r,e.create(t,s,a,i)}function lKe(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}M_(e,t.position)}function uKe(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);M_(e,t.position)}function cKe(e,t,i){const r=e.schema;let n=r;t.name==="svg"&&r.space==="html"&&(n=Fz,e.schema=n),e.ancestors.push(t);const s=t.name===null?e.Fragment:Pne(e,t.name,!0),a=gKe(e,t),o=Wz(e,t);return Mne(e,a,s,t),Hz(a,o),e.ancestors.pop(),e.schema=r,e.create(t,s,a,i)}function hKe(e,t,i){const r={};return Hz(r,Wz(e,t)),e.create(t,e.Fragment,r,i)}function dKe(e,t){return t.value}function Mne(e,t,i,r){typeof i!="string"&&i!==e.Fragment&&e.passNode&&(t.node=r)}function Hz(e,t){if(t.length>0){const i=t.length>1?t:t[0];i&&(e.children=i)}}function fKe(e,t,i){return r;function r(n,s,a,o){const u=Array.isArray(a.children)?i:t;return o?u(s,a,o):u(s,a)}}function pKe(e,t){return i;function i(r,n,s,a){const o=Array.isArray(s.children),l=jz(r);return t(n,s,a,o,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function mKe(e,t){const i={};let r,n;for(n in t.properties)if(n!=="children"&&Vz.call(t.properties,n)){const s=vKe(e,n,t.properties[n]);if(s){const[a,o]=s;e.tableCellAlignToStyle&&a==="align"&&typeof o=="string"&&sKe.has(t.tagName)?r=o:i[a]=o}}if(r){const s=i.style||(i.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return i}function gKe(e,t){const i={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const s=r.data.estree.body[0];s.type;const a=s.expression;a.type;const o=a.properties[0];o.type,Object.assign(i,e.evaluater.evaluateExpression(o.argument))}else M_(e,t.position);else{const n=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const o=r.value.data.estree.body[0];o.type,s=e.evaluater.evaluateExpression(o.expression)}else M_(e,t.position);else s=r.value===null?!0:r.value;i[n]=s}return i}function Wz(e,t){const i=[];let r=-1;const n=e.passKeys?new Map:iKe;for(;++r<t.children.length;){const s=t.children[r];let a;if(e.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const u=n.get(l)||0;a=l+"-"+u,n.set(l,u+1)}}const o=Ane(e,s,a);o!==void 0&&i.push(o)}return i}function vKe(e,t,i){const r=EXe(e.schema,t);if(!(i==null||typeof i=="number"&&Number.isNaN(i))){if(Array.isArray(i)&&(i=r.commaSeparated?hXe(i):AXe(i)),r.property==="style"){let n=typeof i=="object"?i:yKe(e,String(i));return e.stylePropertyNameCase==="css"&&(n=xKe(n)),["style",n]}return[e.elementAttributeNameCase==="react"&&r.space?bXe[r.property]||r.property:r.attribute,i]}}function yKe(e,t){try{return eKe(t,{reactCompat:!0})}catch(i){if(e.ignoreInvalidStyle)return{};const r=i,n=new bo("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=Cne+"#cannot-parse-style-attribute",n}}function Pne(e,t,i){let r;if(!i)r={type:"Literal",value:t};else if(t.includes(".")){const n=t.split(".");let s=-1,a;for(;++s<n.length;){const o=CG(n[s])?{type:"Identifier",name:n[s]}:{type:"Literal",value:n[s]};a=a?{type:"MemberExpression",object:a,property:o,computed:!!(s&&o.type==="Literal"),optional:!1}:o}r=a}else r=CG(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const n=r.value;return Vz.call(e.components,n)?e.components[n]:n}if(e.evaluater)return e.evaluater.evaluateExpression(r);M_(e)}function M_(e,t){const i=new bo("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=Cne+"#cannot-handle-mdx-estrees-without-createevaluater",i}function xKe(e){const t={};let i;for(i in e)Vz.call(e,i)&&(t[bKe(i)]=e[i]);return t}function bKe(e){let t=e.replace(rKe,_Ke);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function _Ke(e){return"-"+e.toLowerCase()}const SO={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},wKe={};function Gz(e,t){const i=wKe,r=typeof i.includeImageAlt=="boolean"?i.includeImageAlt:!0,n=typeof i.includeHtml=="boolean"?i.includeHtml:!0;return Dne(e,r,n)}function Dne(e,t,i){if(EKe(e)){if("value"in e)return e.type==="html"&&!i?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return BG(e.children,t,i)}return Array.isArray(e)?BG(e,t,i):""}function BG(e,t,i){const r=[];let n=-1;for(;++n<e.length;)r[n]=Dne(e[n],t,i);return r.join("")}function EKe(e){return!!(e&&typeof e=="object")}const zG=document.createElement("i");function qz(e){const t="&"+e+";";zG.innerHTML=t;const i=zG.textContent;return i.charCodeAt(i.length-1)===59&&e!=="semi"||i===t?!1:i}function tu(e,t,i,r){const n=e.length;let s=0,a;if(t<0?t=-t>n?0:n+t:t=t>n?n:t,i=i>0?i:0,r.length<1e4)a=Array.from(r),a.unshift(t,i),e.splice(...a);else for(i&&e.splice(t,i);s<r.length;)a=r.slice(s,s+1e4),a.unshift(t,0),e.splice(...a),s+=1e4,t+=1e4}function Ru(e,t){return e.length>0?(tu(e,e.length,0,t),e):t}const FG={}.hasOwnProperty;function Ine(e){const t={};let i=-1;for(;++i<e.length;)SKe(t,e[i]);return t}function SKe(e,t){let i;for(i in t){const n=(FG.call(e,i)?e[i]:void 0)||(e[i]={}),s=t[i];let a;if(s)for(a in s){FG.call(n,a)||(n[a]=[]);const o=s[a];TKe(n[a],Array.isArray(o)?o:o?[o]:[])}}}function TKe(e,t){let i=-1;const r=[];for(;++i<t.length;)(t[i].add==="after"?e:r).push(t[i]);tu(e,0,0,r)}function One(e,t){const i=Number.parseInt(e,t);return i<9||i===11||i>13&&i<32||i>126&&i<160||i>55295&&i<57344||i>64975&&i<65008||(i&65535)===65535||(i&65535)===65534||i>1114111?"�":String.fromCodePoint(i)}function Ec(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Vo=lm(/[A-Za-z]/),mo=lm(/[\dA-Za-z]/),CKe=lm(/[#-'*+\--9=?A-Z^-~]/);function OA(e){return e!==null&&(e<32||e===127)}const kN=lm(/\d/),AKe=lm(/[\dA-Fa-f]/),MKe=lm(/[!-/:-@[-`{-~]/);function Ti(e){return e!==null&&e<-2}function fn(e){return e!==null&&(e<0||e===32)}function Er(e){return e===-2||e===-1||e===32}const XM=lm(new RegExp("\\p{P}|\\p{S}","u")),ev=lm(/\s/);function lm(e){return t;function t(i){return i!==null&&i>-1&&e.test(String.fromCharCode(i))}}function _1(e){const t=[];let i=-1,r=0,n=0;for(;++i<e.length;){const s=e.charCodeAt(i);let a="";if(s===37&&mo(e.charCodeAt(i+1))&&mo(e.charCodeAt(i+2)))n=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const o=e.charCodeAt(i+1);s<56320&&o>56319&&o<57344?(a=String.fromCharCode(s,o),n=1):a="�"}else a=String.fromCharCode(s);a&&(t.push(e.slice(r,i),encodeURIComponent(a)),r=i+n+1,a=""),n&&(i+=n,n=0)}return t.join("")+e.slice(r)}function Rr(e,t,i,r){const n=r?r-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(l){return Er(l)?(e.enter(i),o(l)):t(l)}function o(l){return Er(l)&&s++<n?(e.consume(l),o):(e.exit(i),t(l))}}const PKe={tokenize:DKe};function DKe(e){const t=e.attempt(this.parser.constructs.contentInitial,r,n);let i;return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Rr(e,t,"linePrefix")}function n(o){return e.enter("paragraph"),s(o)}function s(o){const l=e.enter("chunkText",{contentType:"text",previous:i});return i&&(i.next=l),i=l,a(o)}function a(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return Ti(o)?(e.consume(o),e.exit("chunkText"),s):(e.consume(o),a)}}const IKe={tokenize:OKe},UG={tokenize:RKe};function OKe(e){const t=this,i=[];let r=0,n,s,a;return o;function o(b){if(r<i.length){const C=i[r];return t.containerState=C[1],e.attempt(C[0].continuation,l,u)(b)}return u(b)}function l(b){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,n&&w();const C=t.events.length;let A=C,E;for(;A--;)if(t.events[A][0]==="exit"&&t.events[A][1].type==="chunkFlow"){E=t.events[A][1].end;break}x(r);let _=C;for(;_<t.events.length;)t.events[_][1].end={...E},_++;return tu(t.events,A+1,0,t.events.slice(C)),t.events.length=_,u(b)}return o(b)}function u(b){if(r===i.length){if(!n)return d(b);if(n.currentConstruct&&n.currentConstruct.concrete)return m(b);t.interrupt=!!(n.currentConstruct&&!n._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(UG,c,h)(b)}function c(b){return n&&w(),x(r),d(b)}function h(b){return t.parser.lazy[t.now().line]=r!==i.length,a=t.now().offset,m(b)}function d(b){return t.containerState={},e.attempt(UG,f,m)(b)}function f(b){return r++,i.push([t.currentConstruct,t.containerState]),d(b)}function m(b){if(b===null){n&&w(),x(0),e.consume(b);return}return n=n||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:n,contentType:"flow",previous:s}),g(b)}function g(b){if(b===null){y(e.exit("chunkFlow"),!0),x(0),e.consume(b);return}return Ti(b)?(e.consume(b),y(e.exit("chunkFlow")),r=0,t.interrupt=void 0,o):(e.consume(b),g)}function y(b,C){const A=t.sliceStream(b);if(C&&A.push(null),b.previous=s,s&&(s.next=b),s=b,n.defineSkip(b.start),n.write(A),t.parser.lazy[b.start.line]){let E=n.events.length;for(;E--;)if(n.events[E][1].start.offset<a&&(!n.events[E][1].end||n.events[E][1].end.offset>a))return;const _=t.events.length;let P=_,I,D;for(;P--;)if(t.events[P][0]==="exit"&&t.events[P][1].type==="chunkFlow"){if(I){D=t.events[P][1].end;break}I=!0}for(x(r),E=_;E<t.events.length;)t.events[E][1].end={...D},E++;tu(t.events,P+1,0,t.events.slice(_)),t.events.length=E}}function x(b){let C=i.length;for(;C-- >b;){const A=i[C];t.containerState=A[1],A[0].exit.call(t,e)}i.length=b}function w(){n.write([null]),s=void 0,n=void 0,t.containerState._closeFlow=void 0}}function RKe(e,t,i){return Rr(e,e.attempt(this.parser.constructs.document,t,i),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Gy(e){if(e===null||fn(e)||ev(e))return 1;if(XM(e))return 2}function KM(e,t,i){const r=[];let n=-1;for(;++n<e.length;){const s=e[n].resolveAll;s&&!r.includes(s)&&(t=s(t,i),r.push(s))}return t}const BN={name:"attention",resolveAll:LKe,tokenize:NKe};function LKe(e,t){let i=-1,r,n,s,a,o,l,u,c;for(;++i<e.length;)if(e[i][0]==="enter"&&e[i][1].type==="attentionSequence"&&e[i][1]._close){for(r=i;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[i][1]).charCodeAt(0)){if((e[r][1]._close||e[i][1]._open)&&(e[i][1].end.offset-e[i][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[i][1].end.offset-e[i][1].start.offset)%3))continue;l=e[r][1].end.offset-e[r][1].start.offset>1&&e[i][1].end.offset-e[i][1].start.offset>1?2:1;const h={...e[r][1].end},d={...e[i][1].start};jG(h,-l),jG(d,l),a={type:l>1?"strongSequence":"emphasisSequence",start:h,end:{...e[r][1].end}},o={type:l>1?"strongSequence":"emphasisSequence",start:{...e[i][1].start},end:d},s={type:l>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[i][1].start}},n={type:l>1?"strong":"emphasis",start:{...a.start},end:{...o.end}},e[r][1].end={...a.start},e[i][1].start={...o.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Ru(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=Ru(u,[["enter",n,t],["enter",a,t],["exit",a,t],["enter",s,t]]),u=Ru(u,KM(t.parser.constructs.insideSpan.null,e.slice(r+1,i),t)),u=Ru(u,[["exit",s,t],["enter",o,t],["exit",o,t],["exit",n,t]]),e[i][1].end.offset-e[i][1].start.offset?(c=2,u=Ru(u,[["enter",e[i][1],t],["exit",e[i][1],t]])):c=0,tu(e,r-1,i-r+3,u),i=r+u.length-c-2;break}}for(i=-1;++i<e.length;)e[i][1].type==="attentionSequence"&&(e[i][1].type="data");return e}function NKe(e,t){const i=this.parser.constructs.attentionMarkers.null,r=this.previous,n=Gy(r);let s;return a;function a(l){return s=l,e.enter("attentionSequence"),o(l)}function o(l){if(l===s)return e.consume(l),o;const u=e.exit("attentionSequence"),c=Gy(l),h=!c||c===2&&n||i.includes(l),d=!n||n===2&&c||i.includes(r);return u._open=!!(s===42?h:h&&(n||!d)),u._close=!!(s===42?d:d&&(c||!h)),t(l)}}function jG(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const kKe={name:"autolink",tokenize:BKe};function BKe(e,t,i){let r=0;return n;function n(f){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(f),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(f){return Vo(f)?(e.consume(f),a):f===64?i(f):u(f)}function a(f){return f===43||f===45||f===46||mo(f)?(r=1,o(f)):u(f)}function o(f){return f===58?(e.consume(f),r=0,l):(f===43||f===45||f===46||mo(f))&&r++<32?(e.consume(f),o):(r=0,u(f))}function l(f){return f===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(f),e.exit("autolinkMarker"),e.exit("autolink"),t):f===null||f===32||f===60||OA(f)?i(f):(e.consume(f),l)}function u(f){return f===64?(e.consume(f),c):CKe(f)?(e.consume(f),u):i(f)}function c(f){return mo(f)?h(f):i(f)}function h(f){return f===46?(e.consume(f),r=0,c):f===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(f),e.exit("autolinkMarker"),e.exit("autolink"),t):d(f)}function d(f){if((f===45||mo(f))&&r++<63){const m=f===45?d:h;return e.consume(f),m}return i(f)}}const mw={partial:!0,tokenize:zKe};function zKe(e,t,i){return r;function r(s){return Er(s)?Rr(e,n,"linePrefix")(s):n(s)}function n(s){return s===null||Ti(s)?t(s):i(s)}}const Rne={continuation:{tokenize:UKe},exit:jKe,name:"blockQuote",tokenize:FKe};function FKe(e,t,i){const r=this;return n;function n(a){if(a===62){const o=r.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),s}return i(a)}function s(a){return Er(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function UKe(e,t,i){const r=this;return n;function n(a){return Er(a)?Rr(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return e.attempt(Rne,t,i)(a)}}function jKe(e){e.exit("blockQuote")}const Lne={name:"characterEscape",tokenize:VKe};function VKe(e,t,i){return r;function r(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),n}function n(s){return MKe(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):i(s)}}const Nne={name:"characterReference",tokenize:HKe};function HKe(e,t,i){const r=this;let n=0,s,a;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),l}function l(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),s=31,a=mo,c(h))}function u(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,a=AKe,c):(e.enter("characterReferenceValue"),s=7,a=kN,c(h))}function c(h){if(h===59&&n){const d=e.exit("characterReferenceValue");return a===mo&&!qz(r.sliceSerialize(d))?i(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(h)&&n++<s?(e.consume(h),c):i(h)}}const VG={partial:!0,tokenize:GKe},HG={concrete:!0,name:"codeFenced",tokenize:WKe};function WKe(e,t,i){const r=this,n={partial:!0,tokenize:A};let s=0,a=0,o;return l;function l(E){return u(E)}function u(E){const _=r.events[r.events.length-1];return s=_&&_[1].type==="linePrefix"?_[2].sliceSerialize(_[1],!0).length:0,o=E,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),c(E)}function c(E){return E===o?(a++,e.consume(E),c):a<3?i(E):(e.exit("codeFencedFenceSequence"),Er(E)?Rr(e,h,"whitespace")(E):h(E))}function h(E){return E===null||Ti(E)?(e.exit("codeFencedFence"),r.interrupt?t(E):e.check(VG,g,C)(E)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),d(E))}function d(E){return E===null||Ti(E)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(E)):Er(E)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Rr(e,f,"whitespace")(E)):E===96&&E===o?i(E):(e.consume(E),d)}function f(E){return E===null||Ti(E)?h(E):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),m(E))}function m(E){return E===null||Ti(E)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(E)):E===96&&E===o?i(E):(e.consume(E),m)}function g(E){return e.attempt(n,C,y)(E)}function y(E){return e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),x}function x(E){return s>0&&Er(E)?Rr(e,w,"linePrefix",s+1)(E):w(E)}function w(E){return E===null||Ti(E)?e.check(VG,g,C)(E):(e.enter("codeFlowValue"),b(E))}function b(E){return E===null||Ti(E)?(e.exit("codeFlowValue"),w(E)):(e.consume(E),b)}function C(E){return e.exit("codeFenced"),t(E)}function A(E,_,P){let I=0;return D;function D($){return E.enter("lineEnding"),E.consume($),E.exit("lineEnding"),k}function k($){return E.enter("codeFencedFence"),Er($)?Rr(E,B,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):B($)}function B($){return $===o?(E.enter("codeFencedFenceSequence"),z($)):P($)}function z($){return $===o?(I++,E.consume($),z):I>=a?(E.exit("codeFencedFenceSequence"),Er($)?Rr(E,W,"whitespace")($):W($)):P($)}function W($){return $===null||Ti($)?(E.exit("codeFencedFence"),_($)):P($)}}}function GKe(e,t,i){const r=this;return n;function n(a){return a===null?i(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s)}function s(a){return r.parser.lazy[r.now().line]?i(a):t(a)}}const TO={name:"codeIndented",tokenize:YKe},qKe={partial:!0,tokenize:XKe};function YKe(e,t,i){const r=this;return n;function n(u){return e.enter("codeIndented"),Rr(e,s,"linePrefix",5)(u)}function s(u){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?a(u):i(u)}function a(u){return u===null?l(u):Ti(u)?e.attempt(qKe,a,l)(u):(e.enter("codeFlowValue"),o(u))}function o(u){return u===null||Ti(u)?(e.exit("codeFlowValue"),a(u)):(e.consume(u),o)}function l(u){return e.exit("codeIndented"),t(u)}}function XKe(e,t,i){const r=this;return n;function n(a){return r.parser.lazy[r.now().line]?i(a):Ti(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n):Rr(e,s,"linePrefix",5)(a)}function s(a){const o=r.events[r.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):Ti(a)?n(a):i(a)}}const KKe={name:"codeText",previous:ZKe,resolve:$Ke,tokenize:QKe};function $Ke(e){let t=e.length-4,i=3,r,n;if((e[i][1].type==="lineEnding"||e[i][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=i;++r<t;)if(e[r][1].type==="codeTextData"){e[i][1].type="codeTextPadding",e[t][1].type="codeTextPadding",i+=2,t-=2;break}}for(r=i-1,t++;++r<=t;)n===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(n=r):(r===t||e[r][1].type==="lineEnding")&&(e[n][1].type="codeTextData",r!==n+2&&(e[n][1].end=e[r-1][1].end,e.splice(n+2,r-n-2),t-=r-n-2,r=n+2),n=void 0);return e}function ZKe(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function QKe(e,t,i){let r=0,n,s;return a;function a(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),r++,o):(e.exit("codeTextSequence"),l(h))}function l(h){return h===null?i(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),l):h===96?(s=e.enter("codeTextSequence"),n=0,c(h)):Ti(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),l):(e.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||Ti(h)?(e.exit("codeTextData"),l(h)):(e.consume(h),u)}function c(h){return h===96?(e.consume(h),n++,c):n===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(s.type="codeTextData",u(h))}}class JKe{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,i){const r=i??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,i,r){const n=i||0;this.setCursor(Math.trunc(t));const s=this.right.splice(this.right.length-n,Number.POSITIVE_INFINITY);return r&&Tx(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Tx(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Tx(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const i=this.left.splice(t,Number.POSITIVE_INFINITY);Tx(this.right,i.reverse())}else{const i=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Tx(this.left,i.reverse())}}}function Tx(e,t){let i=0;if(t.length<1e4)e.push(...t);else for(;i<t.length;)e.push(...t.slice(i,i+1e4)),i+=1e4}function kne(e){const t={};let i=-1,r,n,s,a,o,l,u;const c=new JKe(e);for(;++i<c.length;){for(;i in t;)i=t[i];if(r=c.get(i),i&&r[1].type==="chunkFlow"&&c.get(i-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,e$e(c,i)),i=t[i],u=!0);else if(r[1]._container){for(s=i,n=void 0;s--;)if(a=c.get(s),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(n&&(c.get(n)[1].type="lineEndingBlank"),a[1].type="lineEnding",n=s);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;n&&(r[1].end={...c.get(n)[1].start},o=c.slice(n,i),o.unshift(r),c.splice(n,i-n+1,o))}}return tu(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!u}function e$e(e,t){const i=e.get(t)[1],r=e.get(t)[2];let n=t-1;const s=[];let a=i._tokenizer;a||(a=r.parser[i.contentType](i.start),i._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,l=[],u={};let c,h,d=-1,f=i,m=0,g=0;const y=[g];for(;f;){for(;e.get(++n)[1]!==f;);s.push(n),f._tokenizer||(c=r.sliceStream(f),f.next||c.push(null),h&&a.defineSkip(f.start),f._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(c),f._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),h=f,f=f.next}for(f=i;++d<o.length;)o[d][0]==="exit"&&o[d-1][0]==="enter"&&o[d][1].type===o[d-1][1].type&&o[d][1].start.line!==o[d][1].end.line&&(g=d+1,y.push(g),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(a.events=[],f?(f._tokenizer=void 0,f.previous=void 0):y.pop(),d=y.length;d--;){const x=o.slice(y[d],y[d+1]),w=s.pop();l.push([w,w+x.length-1]),e.splice(w,2,x)}for(l.reverse(),d=-1;++d<l.length;)u[m+l[d][0]]=m+l[d][1],m+=l[d][1]-l[d][0]-1;return u}const t$e={resolve:r$e,tokenize:n$e},i$e={partial:!0,tokenize:s$e};function r$e(e){return kne(e),e}function n$e(e,t){let i;return r;function r(o){return e.enter("content"),i=e.enter("chunkContent",{contentType:"content"}),n(o)}function n(o){return o===null?s(o):Ti(o)?e.check(i$e,a,s)(o):(e.consume(o),n)}function s(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function a(o){return e.consume(o),e.exit("chunkContent"),i.next=e.enter("chunkContent",{contentType:"content",previous:i}),i=i.next,n}}function s$e(e,t,i){const r=this;return n;function n(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),Rr(e,s,"linePrefix")}function s(a){if(a===null||Ti(a))return i(a);const o=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):e.interrupt(r.parser.constructs.flow,i,t)(a)}}function Bne(e,t,i,r,n,s,a,o,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return h;function h(x){return x===60?(e.enter(r),e.enter(n),e.enter(s),e.consume(x),e.exit(s),d):x===null||x===32||x===41||OA(x)?i(x):(e.enter(r),e.enter(a),e.enter(o),e.enter("chunkString",{contentType:"string"}),g(x))}function d(x){return x===62?(e.enter(s),e.consume(x),e.exit(s),e.exit(n),e.exit(r),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),f(x))}function f(x){return x===62?(e.exit("chunkString"),e.exit(o),d(x)):x===null||x===60||Ti(x)?i(x):(e.consume(x),x===92?m:f)}function m(x){return x===60||x===62||x===92?(e.consume(x),f):f(x)}function g(x){return!c&&(x===null||x===41||fn(x))?(e.exit("chunkString"),e.exit(o),e.exit(a),e.exit(r),t(x)):c<u&&x===40?(e.consume(x),c++,g):x===41?(e.consume(x),c--,g):x===null||x===32||x===40||OA(x)?i(x):(e.consume(x),x===92?y:g)}function y(x){return x===40||x===41||x===92?(e.consume(x),g):g(x)}}function zne(e,t,i,r,n,s){const a=this;let o=0,l;return u;function u(f){return e.enter(r),e.enter(n),e.consume(f),e.exit(n),e.enter(s),c}function c(f){return o>999||f===null||f===91||f===93&&!l||f===94&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?i(f):f===93?(e.exit(s),e.enter(n),e.consume(f),e.exit(n),e.exit(r),t):Ti(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),h(f))}function h(f){return f===null||f===91||f===93||Ti(f)||o++>999?(e.exit("chunkString"),c(f)):(e.consume(f),l||(l=!Er(f)),f===92?d:h)}function d(f){return f===91||f===92||f===93?(e.consume(f),o++,h):h(f)}}function Fne(e,t,i,r,n,s){let a;return o;function o(d){return d===34||d===39||d===40?(e.enter(r),e.enter(n),e.consume(d),e.exit(n),a=d===40?41:d,l):i(d)}function l(d){return d===a?(e.enter(n),e.consume(d),e.exit(n),e.exit(r),t):(e.enter(s),u(d))}function u(d){return d===a?(e.exit(s),l(a)):d===null?i(d):Ti(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),Rr(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(d))}function c(d){return d===a||d===null||Ti(d)?(e.exit("chunkString"),u(d)):(e.consume(d),d===92?h:c)}function h(d){return d===a||d===92?(e.consume(d),c):c(d)}}function Ob(e,t){let i;return r;function r(n){return Ti(n)?(e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),i=!0,r):Er(n)?Rr(e,r,i?"linePrefix":"lineSuffix")(n):t(n)}}const a$e={name:"definition",tokenize:l$e},o$e={partial:!0,tokenize:u$e};function l$e(e,t,i){const r=this;let n;return s;function s(f){return e.enter("definition"),a(f)}function a(f){return zne.call(r,e,o,i,"definitionLabel","definitionLabelMarker","definitionLabelString")(f)}function o(f){return n=Ec(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),f===58?(e.enter("definitionMarker"),e.consume(f),e.exit("definitionMarker"),l):i(f)}function l(f){return fn(f)?Ob(e,u)(f):u(f)}function u(f){return Bne(e,c,i,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(f)}function c(f){return e.attempt(o$e,h,h)(f)}function h(f){return Er(f)?Rr(e,d,"whitespace")(f):d(f)}function d(f){return f===null||Ti(f)?(e.exit("definition"),r.parser.defined.push(n),t(f)):i(f)}}function u$e(e,t,i){return r;function r(o){return fn(o)?Ob(e,n)(o):i(o)}function n(o){return Fne(e,s,i,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function s(o){return Er(o)?Rr(e,a,"whitespace")(o):a(o)}function a(o){return o===null||Ti(o)?t(o):i(o)}}const c$e={name:"hardBreakEscape",tokenize:h$e};function h$e(e,t,i){return r;function r(s){return e.enter("hardBreakEscape"),e.consume(s),n}function n(s){return Ti(s)?(e.exit("hardBreakEscape"),t(s)):i(s)}}const d$e={name:"headingAtx",resolve:f$e,tokenize:p$e};function f$e(e,t){let i=e.length-2,r=3,n,s;return e[r][1].type==="whitespace"&&(r+=2),i-2>r&&e[i][1].type==="whitespace"&&(i-=2),e[i][1].type==="atxHeadingSequence"&&(r===i-1||i-4>r&&e[i-2][1].type==="whitespace")&&(i-=r+1===i?2:4),i>r&&(n={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},s={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},tu(e,r,i-r+1,[["enter",n,t],["enter",s,t],["exit",s,t],["exit",n,t]])),e}function p$e(e,t,i){let r=0;return n;function n(c){return e.enter("atxHeading"),s(c)}function s(c){return e.enter("atxHeadingSequence"),a(c)}function a(c){return c===35&&r++<6?(e.consume(c),a):c===null||fn(c)?(e.exit("atxHeadingSequence"),o(c)):i(c)}function o(c){return c===35?(e.enter("atxHeadingSequence"),l(c)):c===null||Ti(c)?(e.exit("atxHeading"),t(c)):Er(c)?Rr(e,o,"whitespace")(c):(e.enter("atxHeadingText"),u(c))}function l(c){return c===35?(e.consume(c),l):(e.exit("atxHeadingSequence"),o(c))}function u(c){return c===null||c===35||fn(c)?(e.exit("atxHeadingText"),o(c)):(e.consume(c),u)}}const m$e=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],WG=["pre","script","style","textarea"],g$e={concrete:!0,name:"htmlFlow",resolveTo:x$e,tokenize:b$e},v$e={partial:!0,tokenize:w$e},y$e={partial:!0,tokenize:_$e};function x$e(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function b$e(e,t,i){const r=this;let n,s,a,o,l;return u;function u(ee){return c(ee)}function c(ee){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(ee),h}function h(ee){return ee===33?(e.consume(ee),d):ee===47?(e.consume(ee),s=!0,g):ee===63?(e.consume(ee),n=3,r.interrupt?t:U):Vo(ee)?(e.consume(ee),a=String.fromCharCode(ee),y):i(ee)}function d(ee){return ee===45?(e.consume(ee),n=2,f):ee===91?(e.consume(ee),n=5,o=0,m):Vo(ee)?(e.consume(ee),n=4,r.interrupt?t:U):i(ee)}function f(ee){return ee===45?(e.consume(ee),r.interrupt?t:U):i(ee)}function m(ee){const ve="CDATA[";return ee===ve.charCodeAt(o++)?(e.consume(ee),o===ve.length?r.interrupt?t:B:m):i(ee)}function g(ee){return Vo(ee)?(e.consume(ee),a=String.fromCharCode(ee),y):i(ee)}function y(ee){if(ee===null||ee===47||ee===62||fn(ee)){const ve=ee===47,_e=a.toLowerCase();return!ve&&!s&&WG.includes(_e)?(n=1,r.interrupt?t(ee):B(ee)):m$e.includes(a.toLowerCase())?(n=6,ve?(e.consume(ee),x):r.interrupt?t(ee):B(ee)):(n=7,r.interrupt&&!r.parser.lazy[r.now().line]?i(ee):s?w(ee):b(ee))}return ee===45||mo(ee)?(e.consume(ee),a+=String.fromCharCode(ee),y):i(ee)}function x(ee){return ee===62?(e.consume(ee),r.interrupt?t:B):i(ee)}function w(ee){return Er(ee)?(e.consume(ee),w):D(ee)}function b(ee){return ee===47?(e.consume(ee),D):ee===58||ee===95||Vo(ee)?(e.consume(ee),C):Er(ee)?(e.consume(ee),b):D(ee)}function C(ee){return ee===45||ee===46||ee===58||ee===95||mo(ee)?(e.consume(ee),C):A(ee)}function A(ee){return ee===61?(e.consume(ee),E):Er(ee)?(e.consume(ee),A):b(ee)}function E(ee){return ee===null||ee===60||ee===61||ee===62||ee===96?i(ee):ee===34||ee===39?(e.consume(ee),l=ee,_):Er(ee)?(e.consume(ee),E):P(ee)}function _(ee){return ee===l?(e.consume(ee),l=null,I):ee===null||Ti(ee)?i(ee):(e.consume(ee),_)}function P(ee){return ee===null||ee===34||ee===39||ee===47||ee===60||ee===61||ee===62||ee===96||fn(ee)?A(ee):(e.consume(ee),P)}function I(ee){return ee===47||ee===62||Er(ee)?b(ee):i(ee)}function D(ee){return ee===62?(e.consume(ee),k):i(ee)}function k(ee){return ee===null||Ti(ee)?B(ee):Er(ee)?(e.consume(ee),k):i(ee)}function B(ee){return ee===45&&n===2?(e.consume(ee),Z):ee===60&&n===1?(e.consume(ee),G):ee===62&&n===4?(e.consume(ee),ie):ee===63&&n===3?(e.consume(ee),U):ee===93&&n===5?(e.consume(ee),J):Ti(ee)&&(n===6||n===7)?(e.exit("htmlFlowData"),e.check(v$e,se,z)(ee)):ee===null||Ti(ee)?(e.exit("htmlFlowData"),z(ee)):(e.consume(ee),B)}function z(ee){return e.check(y$e,W,se)(ee)}function W(ee){return e.enter("lineEnding"),e.consume(ee),e.exit("lineEnding"),$}function $(ee){return ee===null||Ti(ee)?z(ee):(e.enter("htmlFlowData"),B(ee))}function Z(ee){return ee===45?(e.consume(ee),U):B(ee)}function G(ee){return ee===47?(e.consume(ee),a="",V):B(ee)}function V(ee){if(ee===62){const ve=a.toLowerCase();return WG.includes(ve)?(e.consume(ee),ie):B(ee)}return Vo(ee)&&a.length<8?(e.consume(ee),a+=String.fromCharCode(ee),V):B(ee)}function J(ee){return ee===93?(e.consume(ee),U):B(ee)}function U(ee){return ee===62?(e.consume(ee),ie):ee===45&&n===2?(e.consume(ee),U):B(ee)}function ie(ee){return ee===null||Ti(ee)?(e.exit("htmlFlowData"),se(ee)):(e.consume(ee),ie)}function se(ee){return e.exit("htmlFlow"),t(ee)}}function _$e(e,t,i){const r=this;return n;function n(a){return Ti(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s):i(a)}function s(a){return r.parser.lazy[r.now().line]?i(a):t(a)}}function w$e(e,t,i){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),e.attempt(mw,t,i)}}const E$e={name:"htmlText",tokenize:S$e};function S$e(e,t,i){const r=this;let n,s,a;return o;function o(U){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(U),l}function l(U){return U===33?(e.consume(U),u):U===47?(e.consume(U),A):U===63?(e.consume(U),b):Vo(U)?(e.consume(U),P):i(U)}function u(U){return U===45?(e.consume(U),c):U===91?(e.consume(U),s=0,m):Vo(U)?(e.consume(U),w):i(U)}function c(U){return U===45?(e.consume(U),f):i(U)}function h(U){return U===null?i(U):U===45?(e.consume(U),d):Ti(U)?(a=h,G(U)):(e.consume(U),h)}function d(U){return U===45?(e.consume(U),f):h(U)}function f(U){return U===62?Z(U):U===45?d(U):h(U)}function m(U){const ie="CDATA[";return U===ie.charCodeAt(s++)?(e.consume(U),s===ie.length?g:m):i(U)}function g(U){return U===null?i(U):U===93?(e.consume(U),y):Ti(U)?(a=g,G(U)):(e.consume(U),g)}function y(U){return U===93?(e.consume(U),x):g(U)}function x(U){return U===62?Z(U):U===93?(e.consume(U),x):g(U)}function w(U){return U===null||U===62?Z(U):Ti(U)?(a=w,G(U)):(e.consume(U),w)}function b(U){return U===null?i(U):U===63?(e.consume(U),C):Ti(U)?(a=b,G(U)):(e.consume(U),b)}function C(U){return U===62?Z(U):b(U)}function A(U){return Vo(U)?(e.consume(U),E):i(U)}function E(U){return U===45||mo(U)?(e.consume(U),E):_(U)}function _(U){return Ti(U)?(a=_,G(U)):Er(U)?(e.consume(U),_):Z(U)}function P(U){return U===45||mo(U)?(e.consume(U),P):U===47||U===62||fn(U)?I(U):i(U)}function I(U){return U===47?(e.consume(U),Z):U===58||U===95||Vo(U)?(e.consume(U),D):Ti(U)?(a=I,G(U)):Er(U)?(e.consume(U),I):Z(U)}function D(U){return U===45||U===46||U===58||U===95||mo(U)?(e.consume(U),D):k(U)}function k(U){return U===61?(e.consume(U),B):Ti(U)?(a=k,G(U)):Er(U)?(e.consume(U),k):I(U)}function B(U){return U===null||U===60||U===61||U===62||U===96?i(U):U===34||U===39?(e.consume(U),n=U,z):Ti(U)?(a=B,G(U)):Er(U)?(e.consume(U),B):(e.consume(U),W)}function z(U){return U===n?(e.consume(U),n=void 0,$):U===null?i(U):Ti(U)?(a=z,G(U)):(e.consume(U),z)}function W(U){return U===null||U===34||U===39||U===60||U===61||U===96?i(U):U===47||U===62||fn(U)?I(U):(e.consume(U),W)}function $(U){return U===47||U===62||fn(U)?I(U):i(U)}function Z(U){return U===62?(e.consume(U),e.exit("htmlTextData"),e.exit("htmlText"),t):i(U)}function G(U){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(U),e.exit("lineEnding"),V}function V(U){return Er(U)?Rr(e,J,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(U):J(U)}function J(U){return e.enter("htmlTextData"),a(U)}}const Yz={name:"labelEnd",resolveAll:M$e,resolveTo:P$e,tokenize:D$e},T$e={tokenize:I$e},C$e={tokenize:O$e},A$e={tokenize:R$e};function M$e(e){let t=-1;const i=[];for(;++t<e.length;){const r=e[t][1];if(i.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const n=r.type==="labelImage"?4:2;r.type="data",t+=n}}return e.length!==i.length&&tu(e,0,e.length,i),e}function P$e(e,t){let i=e.length,r=0,n,s,a,o;for(;i--;)if(n=e[i][1],s){if(n.type==="link"||n.type==="labelLink"&&n._inactive)break;e[i][0]==="enter"&&n.type==="labelLink"&&(n._inactive=!0)}else if(a){if(e[i][0]==="enter"&&(n.type==="labelImage"||n.type==="labelLink")&&!n._balanced&&(s=i,n.type!=="labelLink")){r=2;break}}else n.type==="labelEnd"&&(a=i);const l={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[s][1].start},end:{...e[a][1].end}},c={type:"labelText",start:{...e[s+r+2][1].end},end:{...e[a-2][1].start}};return o=[["enter",l,t],["enter",u,t]],o=Ru(o,e.slice(s+1,s+r+3)),o=Ru(o,[["enter",c,t]]),o=Ru(o,KM(t.parser.constructs.insideSpan.null,e.slice(s+r+4,a-3),t)),o=Ru(o,[["exit",c,t],e[a-2],e[a-1],["exit",u,t]]),o=Ru(o,e.slice(a+1)),o=Ru(o,[["exit",l,t]]),tu(e,s,e.length,o),e}function D$e(e,t,i){const r=this;let n=r.events.length,s,a;for(;n--;)if((r.events[n][1].type==="labelImage"||r.events[n][1].type==="labelLink")&&!r.events[n][1]._balanced){s=r.events[n][1];break}return o;function o(d){return s?s._inactive?h(d):(a=r.parser.defined.includes(Ec(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelEnd"),l):i(d)}function l(d){return d===40?e.attempt(T$e,c,a?c:h)(d):d===91?e.attempt(C$e,c,a?u:h)(d):a?c(d):h(d)}function u(d){return e.attempt(A$e,c,h)(d)}function c(d){return t(d)}function h(d){return s._balanced=!0,i(d)}}function I$e(e,t,i){return r;function r(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),n}function n(h){return fn(h)?Ob(e,s)(h):s(h)}function s(h){return h===41?c(h):Bne(e,a,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function a(h){return fn(h)?Ob(e,l)(h):c(h)}function o(h){return i(h)}function l(h){return h===34||h===39||h===40?Fne(e,u,i,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):c(h)}function u(h){return fn(h)?Ob(e,c)(h):c(h)}function c(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):i(h)}}function O$e(e,t,i){const r=this;return n;function n(o){return zne.call(r,e,s,a,"reference","referenceMarker","referenceString")(o)}function s(o){return r.parser.defined.includes(Ec(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(o):i(o)}function a(o){return i(o)}}function R$e(e,t,i){return r;function r(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),n}function n(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),t):i(s)}}const L$e={name:"labelStartImage",resolveAll:Yz.resolveAll,tokenize:N$e};function N$e(e,t,i){const r=this;return n;function n(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),s}function s(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),a):i(o)}function a(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?i(o):t(o)}}const k$e={name:"labelStartLink",resolveAll:Yz.resolveAll,tokenize:B$e};function B$e(e,t,i){const r=this;return n;function n(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?i(a):t(a)}}const CO={name:"lineEnding",tokenize:z$e};function z$e(e,t){return i;function i(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Rr(e,t,"linePrefix")}}const BT={name:"thematicBreak",tokenize:F$e};function F$e(e,t,i){let r=0,n;return s;function s(u){return e.enter("thematicBreak"),a(u)}function a(u){return n=u,o(u)}function o(u){return u===n?(e.enter("thematicBreakSequence"),l(u)):r>=3&&(u===null||Ti(u))?(e.exit("thematicBreak"),t(u)):i(u)}function l(u){return u===n?(e.consume(u),r++,l):(e.exit("thematicBreakSequence"),Er(u)?Rr(e,o,"whitespace")(u):o(u))}}const ml={continuation:{tokenize:H$e},exit:G$e,name:"list",tokenize:V$e},U$e={partial:!0,tokenize:q$e},j$e={partial:!0,tokenize:W$e};function V$e(e,t,i){const r=this,n=r.events[r.events.length-1];let s=n&&n[1].type==="linePrefix"?n[2].sliceSerialize(n[1],!0).length:0,a=0;return o;function o(f){const m=r.containerState.type||(f===42||f===43||f===45?"listUnordered":"listOrdered");if(m==="listUnordered"?!r.containerState.marker||f===r.containerState.marker:kN(f)){if(r.containerState.type||(r.containerState.type=m,e.enter(m,{_container:!0})),m==="listUnordered")return e.enter("listItemPrefix"),f===42||f===45?e.check(BT,i,u)(f):u(f);if(!r.interrupt||f===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(f)}return i(f)}function l(f){return kN(f)&&++a<10?(e.consume(f),l):(!r.interrupt||a<2)&&(r.containerState.marker?f===r.containerState.marker:f===41||f===46)?(e.exit("listItemValue"),u(f)):i(f)}function u(f){return e.enter("listItemMarker"),e.consume(f),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||f,e.check(mw,r.interrupt?i:c,e.attempt(U$e,d,h))}function c(f){return r.containerState.initialBlankLine=!0,s++,d(f)}function h(f){return Er(f)?(e.enter("listItemPrefixWhitespace"),e.consume(f),e.exit("listItemPrefixWhitespace"),d):i(f)}function d(f){return r.containerState.size=s+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(f)}}function H$e(e,t,i){const r=this;return r.containerState._closeFlow=void 0,e.check(mw,n,s);function n(o){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Rr(e,t,"listItemIndent",r.containerState.size+1)(o)}function s(o){return r.containerState.furtherBlankLines||!Er(o)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(o)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(j$e,t,a)(o))}function a(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,Rr(e,e.attempt(ml,t,i),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function W$e(e,t,i){const r=this;return Rr(e,n,"listItemIndent",r.containerState.size+1);function n(s){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?t(s):i(s)}}function G$e(e){e.exit(this.containerState.type)}function q$e(e,t,i){const r=this;return Rr(e,n,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function n(s){const a=r.events[r.events.length-1];return!Er(s)&&a&&a[1].type==="listItemPrefixWhitespace"?t(s):i(s)}}const GG={name:"setextUnderline",resolveTo:Y$e,tokenize:X$e};function Y$e(e,t){let i=e.length,r,n,s;for(;i--;)if(e[i][0]==="enter"){if(e[i][1].type==="content"){r=i;break}e[i][1].type==="paragraph"&&(n=i)}else e[i][1].type==="content"&&e.splice(i,1),!s&&e[i][1].type==="definition"&&(s=i);const a={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[n][1].type="setextHeadingText",s?(e.splice(n,0,["enter",a,t]),e.splice(s+1,0,["exit",e[r][1],t]),e[r][1].end={...e[s][1].end}):e[r][1]=a,e.push(["exit",a,t]),e}function X$e(e,t,i){const r=this;let n;return s;function s(u){let c=r.events.length,h;for(;c--;)if(r.events[c][1].type!=="lineEnding"&&r.events[c][1].type!=="linePrefix"&&r.events[c][1].type!=="content"){h=r.events[c][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(e.enter("setextHeadingLine"),n=u,a(u)):i(u)}function a(u){return e.enter("setextHeadingLineSequence"),o(u)}function o(u){return u===n?(e.consume(u),o):(e.exit("setextHeadingLineSequence"),Er(u)?Rr(e,l,"lineSuffix")(u):l(u))}function l(u){return u===null||Ti(u)?(e.exit("setextHeadingLine"),t(u)):i(u)}}const K$e={tokenize:$$e};function $$e(e){const t=this,i=e.attempt(mw,r,e.attempt(this.parser.constructs.flowInitial,n,Rr(e,e.attempt(this.parser.constructs.flow,n,e.attempt(t$e,n)),"linePrefix")));return i;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),t.currentConstruct=void 0,i}function n(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),t.currentConstruct=void 0,i}}const Z$e={resolveAll:jne()},Q$e=Une("string"),J$e=Une("text");function Une(e){return{resolveAll:jne(e==="text"?eZe:void 0),tokenize:t};function t(i){const r=this,n=this.parser.constructs[e],s=i.attempt(n,a,o);return a;function a(c){return u(c)?s(c):o(c)}function o(c){if(c===null){i.consume(c);return}return i.enter("data"),i.consume(c),l}function l(c){return u(c)?(i.exit("data"),s(c)):(i.consume(c),l)}function u(c){if(c===null)return!0;const h=n[c];let d=-1;if(h)for(;++d<h.length;){const f=h[d];if(!f.previous||f.previous.call(r,r.previous))return!0}return!1}}}function jne(e){return t;function t(i,r){let n=-1,s;for(;++n<=i.length;)s===void 0?i[n]&&i[n][1].type==="data"&&(s=n,n++):(!i[n]||i[n][1].type!=="data")&&(n!==s+2&&(i[s][1].end=i[n-1][1].end,i.splice(s+2,n-s-2),n=s+2),s=void 0);return e?e(i,r):i}}function eZe(e,t){let i=0;for(;++i<=e.length;)if((i===e.length||e[i][1].type==="lineEnding")&&e[i-1][1].type==="data"){const r=e[i-1][1],n=t.sliceStream(r);let s=n.length,a=-1,o=0,l;for(;s--;){const u=n[s];if(typeof u=="string"){for(a=u.length;u.charCodeAt(a-1)===32;)o++,a--;if(a)break;a=-1}else if(u===-2)l=!0,o++;else if(u!==-1){s++;break}}if(t._contentTypeTextTrailing&&i===e.length&&(o=0),o){const u={type:i===e.length||l||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?a:r.start._bufferIndex+a,_index:r.start._index+s,line:r.end.line,column:r.end.column-o,offset:r.end.offset-o},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(i,0,["enter",u,t],["exit",u,t]),i+=2)}i++}return e}const tZe={42:ml,43:ml,45:ml,48:ml,49:ml,50:ml,51:ml,52:ml,53:ml,54:ml,55:ml,56:ml,57:ml,62:Rne},iZe={91:a$e},rZe={[-2]:TO,[-1]:TO,32:TO},nZe={35:d$e,42:BT,45:[GG,BT],60:g$e,61:GG,95:BT,96:HG,126:HG},sZe={38:Nne,92:Lne},aZe={[-5]:CO,[-4]:CO,[-3]:CO,33:L$e,38:Nne,42:BN,60:[kKe,E$e],91:k$e,92:[c$e,Lne],93:Yz,95:BN,96:KKe},oZe={null:[BN,Z$e]},lZe={null:[42,95]},uZe={null:[]},cZe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:lZe,contentInitial:iZe,disable:uZe,document:tZe,flow:nZe,flowInitial:rZe,insideSpan:oZe,string:sZe,text:aZe},Symbol.toStringTag,{value:"Module"}));function hZe(e,t,i){let r={_bufferIndex:-1,_index:0,line:i&&i.line||1,column:i&&i.column||1,offset:i&&i.offset||0};const n={},s=[];let a=[],o=[];const l={attempt:_(A),check:_(E),consume:w,enter:b,exit:C,interrupt:_(E,{interrupt:!0})},u={code:null,containerState:{},defineSkip:g,events:[],now:m,parser:e,previous:null,sliceSerialize:d,sliceStream:f,write:h};let c=t.tokenize.call(u,l);return t.resolveAll&&s.push(t),u;function h(k){return a=Ru(a,k),y(),a[a.length-1]!==null?[]:(P(t,0),u.events=KM(s,u.events,u),u.events)}function d(k,B){return fZe(f(k),B)}function f(k){return dZe(a,k)}function m(){const{_bufferIndex:k,_index:B,line:z,column:W,offset:$}=r;return{_bufferIndex:k,_index:B,line:z,column:W,offset:$}}function g(k){n[k.line]=k.column,D()}function y(){let k;for(;r._index<a.length;){const B=a[r._index];if(typeof B=="string")for(k=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===k&&r._bufferIndex<B.length;)x(B.charCodeAt(r._bufferIndex));else x(B)}}function x(k){c=c(k)}function w(k){Ti(k)?(r.line++,r.column=1,r.offset+=k===-3?2:1,D()):k!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=k}function b(k,B){const z=B||{};return z.type=k,z.start=m(),u.events.push(["enter",z,u]),o.push(z),z}function C(k){const B=o.pop();return B.end=m(),u.events.push(["exit",B,u]),B}function A(k,B){P(k,B.from)}function E(k,B){B.restore()}function _(k,B){return z;function z(W,$,Z){let G,V,J,U;return Array.isArray(W)?se(W):"tokenize"in W?se([W]):ie(W);function ie(he){return De;function De(we){const Le=we!==null&&he[we],Te=we!==null&&he.null,ke=[...Array.isArray(Le)?Le:Le?[Le]:[],...Array.isArray(Te)?Te:Te?[Te]:[]];return se(ke)(we)}}function se(he){return G=he,V=0,he.length===0?Z:ee(he[V])}function ee(he){return De;function De(we){return U=I(),J=he,he.partial||(u.currentConstruct=he),he.name&&u.parser.constructs.disable.null.includes(he.name)?_e():he.tokenize.call(B?Object.assign(Object.create(u),B):u,l,ve,_e)(we)}}function ve(he){return k(J,U),$}function _e(he){return U.restore(),++V<G.length?ee(G[V]):Z}}}function P(k,B){k.resolveAll&&!s.includes(k)&&s.push(k),k.resolve&&tu(u.events,B,u.events.length-B,k.resolve(u.events.slice(B),u)),k.resolveTo&&(u.events=k.resolveTo(u.events,u))}function I(){const k=m(),B=u.previous,z=u.currentConstruct,W=u.events.length,$=Array.from(o);return{from:W,restore:Z};function Z(){r=k,u.previous=B,u.currentConstruct=z,u.events.length=W,o=$,D()}}function D(){r.line in n&&r.column<2&&(r.column=n[r.line],r.offset+=n[r.line]-1)}}function dZe(e,t){const i=t.start._index,r=t.start._bufferIndex,n=t.end._index,s=t.end._bufferIndex;let a;if(i===n)a=[e[i].slice(r,s)];else{if(a=e.slice(i,n),r>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(r):a.shift()}s>0&&a.push(e[n].slice(0,s))}return a}function fZe(e,t){let i=-1;const r=[];let n;for(;++i<e.length;){const s=e[i];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&n)continue;a=" ";break}default:a=String.fromCharCode(s)}n=s===-2,r.push(a)}return r.join("")}function pZe(e){const r={constructs:Ine([cZe,...(e||{}).extensions||[]]),content:n(PKe),defined:[],document:n(IKe),flow:n(K$e),lazy:{},string:n(Q$e),text:n(J$e)};return r;function n(s){return a;function a(o){return hZe(r,s,o)}}}function mZe(e){for(;!kne(e););return e}const qG=/[\0\t\n\r]/g;function gZe(){let e=1,t="",i=!0,r;return n;function n(s,a,o){const l=[];let u,c,h,d,f;for(s=t+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),h=0,t="",i&&(s.charCodeAt(0)===65279&&h++,i=void 0);h<s.length;){if(qG.lastIndex=h,u=qG.exec(s),d=u&&u.index!==void 0?u.index:s.length,f=s.charCodeAt(d),!u){t=s.slice(h);break}if(f===10&&h===d&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),h<d&&(l.push(s.slice(h,d)),e+=d-h),f){case 0:{l.push(65533),e++;break}case 9:{for(c=Math.ceil(e/4)*4,l.push(-2);e++<c;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:r=!0,e=1}h=d+1}return o&&(r&&l.push(-5),t&&l.push(t),l.push(null)),l}}const vZe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function yZe(e){return e.replace(vZe,xZe)}function xZe(e,t,i){if(t)return t;if(i.charCodeAt(0)===35){const n=i.charCodeAt(1),s=n===120||n===88;return One(i.slice(s?2:1),s?16:10)}return qz(i)||e}const Vne={}.hasOwnProperty;function bZe(e,t,i){return typeof t!="string"&&(i=t,t=void 0),_Ze(i)(mZe(pZe(i).document().write(gZe()(e,t,!0))))}function _Ze(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(Ee),autolinkProtocol:I,autolinkEmail:I,atxHeading:s(st),blockQuote:s(Te),characterEscape:I,characterReference:I,codeFenced:s(ke),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(ke,a),codeText:s(Xe,a),codeTextData:I,data:I,codeFlowValue:I,definition:s(et),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(Ze),hardBreakEscape:s(_t),hardBreakTrailing:s(_t),htmlFlow:s(St,a),htmlFlowData:I,htmlText:s(St,a),htmlTextData:I,image:s(ue),label:a,link:s(Ee),listItem:s(Ge),listItemValue:d,listOrdered:s(Ae,h),listUnordered:s(Ae),paragraph:s(ae),reference:ee,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(st),strong:s(te),thematicBreak:s(Re)},exit:{atxHeading:l(),atxHeadingSequence:A,autolink:l(),autolinkEmail:Le,autolinkProtocol:we,blockQuote:l(),characterEscapeValue:D,characterReferenceMarkerHexadecimal:_e,characterReferenceMarkerNumeric:_e,characterReferenceValue:he,characterReference:De,codeFenced:l(y),codeFencedFence:g,codeFencedFenceInfo:f,codeFencedFenceMeta:m,codeFlowValue:D,codeIndented:l(x),codeText:l($),codeTextData:D,data:D,definition:l(),definitionDestinationString:C,definitionLabelString:w,definitionTitleString:b,emphasis:l(),hardBreakEscape:l(B),hardBreakTrailing:l(B),htmlFlow:l(z),htmlFlowData:D,htmlText:l(W),htmlTextData:D,image:l(G),label:J,labelText:V,lineEnding:k,link:l(Z),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:ve,resourceDestinationString:U,resourceTitleString:ie,resource:se,setextHeading:l(P),setextHeadingLineSequence:_,setextHeadingText:E,strong:l(),thematicBreak:l()}};Hne(t,(e||{}).mdastExtensions||[]);const i={};return r;function r(Y){let Me={type:"root",children:[]};const Ke={stack:[Me],tokenStack:[],config:t,enter:o,exit:u,buffer:a,resume:c,data:i},ot=[];let qe=-1;for(;++qe<Y.length;)if(Y[qe][1].type==="listOrdered"||Y[qe][1].type==="listUnordered")if(Y[qe][0]==="enter")ot.push(qe);else{const It=ot.pop();qe=n(Y,It,qe)}for(qe=-1;++qe<Y.length;){const It=t[Y[qe][0]];Vne.call(It,Y[qe][1].type)&&It[Y[qe][1].type].call(Object.assign({sliceSerialize:Y[qe][2].sliceSerialize},Ke),Y[qe][1])}if(Ke.tokenStack.length>0){const It=Ke.tokenStack[Ke.tokenStack.length-1];(It[1]||YG).call(Ke,void 0,It[0])}for(Me.position={start:$f(Y.length>0?Y[0][1].start:{line:1,column:1,offset:0}),end:$f(Y.length>0?Y[Y.length-2][1].end:{line:1,column:1,offset:0})},qe=-1;++qe<t.transforms.length;)Me=t.transforms[qe](Me)||Me;return Me}function n(Y,Me,Ke){let ot=Me-1,qe=-1,It=!1,Ot,Dt,kt,Qe;for(;++ot<=Ke;){const mt=Y[ot];switch(mt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{mt[0]==="enter"?qe++:qe--,Qe=void 0;break}case"lineEndingBlank":{mt[0]==="enter"&&(Ot&&!Qe&&!qe&&!kt&&(kt=ot),Qe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Qe=void 0}if(!qe&&mt[0]==="enter"&&mt[1].type==="listItemPrefix"||qe===-1&&mt[0]==="exit"&&(mt[1].type==="listUnordered"||mt[1].type==="listOrdered")){if(Ot){let Ht=ot;for(Dt=void 0;Ht--;){const Wt=Y[Ht];if(Wt[1].type==="lineEnding"||Wt[1].type==="lineEndingBlank"){if(Wt[0]==="exit")continue;Dt&&(Y[Dt][1].type="lineEndingBlank",It=!0),Wt[1].type="lineEnding",Dt=Ht}else if(!(Wt[1].type==="linePrefix"||Wt[1].type==="blockQuotePrefix"||Wt[1].type==="blockQuotePrefixWhitespace"||Wt[1].type==="blockQuoteMarker"||Wt[1].type==="listItemIndent"))break}kt&&(!Dt||kt<Dt)&&(Ot._spread=!0),Ot.end=Object.assign({},Dt?Y[Dt][1].start:mt[1].end),Y.splice(Dt||ot,0,["exit",Ot,mt[2]]),ot++,Ke++}if(mt[1].type==="listItemPrefix"){const Ht={type:"listItem",_spread:!1,start:Object.assign({},mt[1].start),end:void 0};Ot=Ht,Y.splice(ot,0,["enter",Ht,mt[2]]),ot++,Ke++,kt=void 0,Qe=!0}}}return Y[Me][1]._spread=It,Ke}function s(Y,Me){return Ke;function Ke(ot){o.call(this,Y(ot),ot),Me&&Me.call(this,ot)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(Y,Me,Ke){this.stack[this.stack.length-1].children.push(Y),this.stack.push(Y),this.tokenStack.push([Me,Ke||void 0]),Y.position={start:$f(Me.start),end:void 0}}function l(Y){return Me;function Me(Ke){Y&&Y.call(this,Ke),u.call(this,Ke)}}function u(Y,Me){const Ke=this.stack.pop(),ot=this.tokenStack.pop();if(ot)ot[0].type!==Y.type&&(Me?Me.call(this,Y,ot[0]):(ot[1]||YG).call(this,Y,ot[0]));else throw new Error("Cannot close `"+Y.type+"` ("+Ib({start:Y.start,end:Y.end})+"): it’s not open");Ke.position.end=$f(Y.end)}function c(){return Gz(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function d(Y){if(this.data.expectingFirstListItemValue){const Me=this.stack[this.stack.length-2];Me.start=Number.parseInt(this.sliceSerialize(Y),10),this.data.expectingFirstListItemValue=void 0}}function f(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.lang=Y}function m(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.meta=Y}function g(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function y(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.value=Y.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.value=Y.replace(/(\r?\n|\r)$/g,"")}function w(Y){const Me=this.resume(),Ke=this.stack[this.stack.length-1];Ke.label=Me,Ke.identifier=Ec(this.sliceSerialize(Y)).toLowerCase()}function b(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.title=Y}function C(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.url=Y}function A(Y){const Me=this.stack[this.stack.length-1];if(!Me.depth){const Ke=this.sliceSerialize(Y).length;Me.depth=Ke}}function E(){this.data.setextHeadingSlurpLineEnding=!0}function _(Y){const Me=this.stack[this.stack.length-1];Me.depth=this.sliceSerialize(Y).codePointAt(0)===61?1:2}function P(){this.data.setextHeadingSlurpLineEnding=void 0}function I(Y){const Ke=this.stack[this.stack.length-1].children;let ot=Ke[Ke.length-1];(!ot||ot.type!=="text")&&(ot=Ne(),ot.position={start:$f(Y.start),end:void 0},Ke.push(ot)),this.stack.push(ot)}function D(Y){const Me=this.stack.pop();Me.value+=this.sliceSerialize(Y),Me.position.end=$f(Y.end)}function k(Y){const Me=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ke=Me.children[Me.children.length-1];Ke.position.end=$f(Y.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Me.type)&&(I.call(this,Y),D.call(this,Y))}function B(){this.data.atHardBreak=!0}function z(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.value=Y}function W(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.value=Y}function $(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.value=Y}function Z(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const Me=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=Me,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function G(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const Me=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=Me,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function V(Y){const Me=this.sliceSerialize(Y),Ke=this.stack[this.stack.length-2];Ke.label=yZe(Me),Ke.identifier=Ec(Me).toLowerCase()}function J(){const Y=this.stack[this.stack.length-1],Me=this.resume(),Ke=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ke.type==="link"){const ot=Y.children;Ke.children=ot}else Ke.alt=Me}function U(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.url=Y}function ie(){const Y=this.resume(),Me=this.stack[this.stack.length-1];Me.title=Y}function se(){this.data.inReference=void 0}function ee(){this.data.referenceType="collapsed"}function ve(Y){const Me=this.resume(),Ke=this.stack[this.stack.length-1];Ke.label=Me,Ke.identifier=Ec(this.sliceSerialize(Y)).toLowerCase(),this.data.referenceType="full"}function _e(Y){this.data.characterReferenceType=Y.type}function he(Y){const Me=this.sliceSerialize(Y),Ke=this.data.characterReferenceType;let ot;Ke?(ot=One(Me,Ke==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ot=qz(Me);const qe=this.stack[this.stack.length-1];qe.value+=ot}function De(Y){const Me=this.stack.pop();Me.position.end=$f(Y.end)}function we(Y){D.call(this,Y);const Me=this.stack[this.stack.length-1];Me.url=this.sliceSerialize(Y)}function Le(Y){D.call(this,Y);const Me=this.stack[this.stack.length-1];Me.url="mailto:"+this.sliceSerialize(Y)}function Te(){return{type:"blockquote",children:[]}}function ke(){return{type:"code",lang:null,meta:null,value:""}}function Xe(){return{type:"inlineCode",value:""}}function et(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ze(){return{type:"emphasis",children:[]}}function st(){return{type:"heading",depth:0,children:[]}}function _t(){return{type:"break"}}function St(){return{type:"html",value:""}}function ue(){return{type:"image",title:null,url:"",alt:null}}function Ee(){return{type:"link",title:null,url:"",children:[]}}function Ae(Y){return{type:"list",ordered:Y.type==="listOrdered",start:null,spread:Y._spread,children:[]}}function Ge(Y){return{type:"listItem",spread:Y._spread,checked:null,children:[]}}function ae(){return{type:"paragraph",children:[]}}function te(){return{type:"strong",children:[]}}function Ne(){return{type:"text",value:""}}function Re(){return{type:"thematicBreak"}}}function $f(e){return{line:e.line,column:e.column,offset:e.offset}}function Hne(e,t){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?Hne(e,r):wZe(e,r)}}function wZe(e,t){let i;for(i in t)if(Vne.call(t,i))switch(i){case"canContainEols":{const r=t[i];r&&e[i].push(...r);break}case"transforms":{const r=t[i];r&&e[i].push(...r);break}case"enter":case"exit":{const r=t[i];r&&Object.assign(e[i],r);break}}}function YG(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Ib({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Ib({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Ib({start:t.start,end:t.end})+") is still open")}function EZe(e){const t=this;t.parser=i;function i(r){return bZe(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function SZe(e,t){const i={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,i),e.applyData(t,i)}function TZe(e,t){const i={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,i),[e.applyData(t,i),{type:"text",value:`
`}]}function CZe(e,t){const i=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let n={type:"element",tagName:"code",properties:r,children:[{type:"text",value:i}]};return t.meta&&(n.data={meta:t.meta}),e.patch(t,n),n=e.applyData(t,n),n={type:"element",tagName:"pre",properties:{},children:[n]},e.patch(t,n),n}function AZe(e,t){const i={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function MZe(e,t){const i={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function PZe(e,t){const i=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),n=_1(r.toLowerCase()),s=e.footnoteOrder.indexOf(r);let a,o=e.footnoteCounts.get(r);o===void 0?(o=0,e.footnoteOrder.push(r),a=e.footnoteOrder.length):a=s+1,o+=1,e.footnoteCounts.set(r,o);const l={type:"element",tagName:"a",properties:{href:"#"+i+"fn-"+n,id:i+"fnref-"+n+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,u),e.applyData(t,u)}function DZe(e,t){const i={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function IZe(e,t){if(e.options.allowDangerousHtml){const i={type:"raw",value:t.value};return e.patch(t,i),e.applyData(t,i)}}function Wne(e,t){const i=t.referenceType;let r="]";if(i==="collapsed"?r+="[]":i==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const n=e.all(t),s=n[0];s&&s.type==="text"?s.value="["+s.value:n.unshift({type:"text",value:"["});const a=n[n.length-1];return a&&a.type==="text"?a.value+=r:n.push({type:"text",value:r}),n}function OZe(e,t){const i=String(t.identifier).toUpperCase(),r=e.definitionById.get(i);if(!r)return Wne(e,t);const n={src:_1(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(n.title=r.title);const s={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,s),e.applyData(t,s)}function RZe(e,t){const i={src:_1(t.url)};t.alt!==null&&t.alt!==void 0&&(i.alt=t.alt),t.title!==null&&t.title!==void 0&&(i.title=t.title);const r={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,r),e.applyData(t,r)}function LZe(e,t){const i={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,i);const r={type:"element",tagName:"code",properties:{},children:[i]};return e.patch(t,r),e.applyData(t,r)}function NZe(e,t){const i=String(t.identifier).toUpperCase(),r=e.definitionById.get(i);if(!r)return Wne(e,t);const n={href:_1(r.url||"")};r.title!==null&&r.title!==void 0&&(n.title=r.title);const s={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,s),e.applyData(t,s)}function kZe(e,t){const i={href:_1(t.url)};t.title!==null&&t.title!==void 0&&(i.title=t.title);const r={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function BZe(e,t,i){const r=e.all(t),n=i?zZe(i):Gne(t),s={},a=[];if(typeof t.checked=="boolean"){const c=r[0];let h;c&&c.type==="element"&&c.tagName==="p"?h=c:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<r.length;){const c=r[o];(n||o!==0||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!n?a.push(...c.children):a.push(c)}const l=r[r.length-1];l&&(n||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:a};return e.patch(t,u),e.applyData(t,u)}function zZe(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const i=e.children;let r=-1;for(;!t&&++r<i.length;)t=Gne(i[r])}return t}function Gne(e){const t=e.spread;return t??e.children.length>1}function FZe(e,t){const i={},r=e.all(t);let n=-1;for(typeof t.start=="number"&&t.start!==1&&(i.start=t.start);++n<r.length;){const a=r[n];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){i.className=["contains-task-list"];break}}const s={type:"element",tagName:t.ordered?"ol":"ul",properties:i,children:e.wrap(r,!0)};return e.patch(t,s),e.applyData(t,s)}function UZe(e,t){const i={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function jZe(e,t){const i={type:"root",children:e.wrap(e.all(t))};return e.patch(t,i),e.applyData(t,i)}function VZe(e,t){const i={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function HZe(e,t){const i=e.all(t),r=i.shift(),n=[];if(r){const a={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],a),n.push(a)}if(i.length>0){const a={type:"element",tagName:"tbody",properties:{},children:e.wrap(i,!0)},o=jz(t.children[1]),l=Sne(t.children[t.children.length-1]);o&&l&&(a.position={start:o,end:l}),n.push(a)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(n,!0)};return e.patch(t,s),e.applyData(t,s)}function WZe(e,t,i){const r=i?i.children:void 0,s=(r?r.indexOf(t):1)===0?"th":"td",a=i&&i.type==="table"?i.align:void 0,o=a?a.length:t.children.length;let l=-1;const u=[];for(;++l<o;){const h=t.children[l],d={},f=a?a[l]:void 0;f&&(d.align=f);let m={type:"element",tagName:s,properties:d,children:[]};h&&(m.children=e.all(h),e.patch(h,m),m=e.applyData(h,m)),u.push(m)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,c),e.applyData(t,c)}function GZe(e,t){const i={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}const XG=9,KG=32;function qZe(e){const t=String(e),i=/\r?\n|\r/g;let r=i.exec(t),n=0;const s=[];for(;r;)s.push($G(t.slice(n,r.index),n>0,!0),r[0]),n=r.index+r[0].length,r=i.exec(t);return s.push($G(t.slice(n),n>0,!1)),s.join("")}function $G(e,t,i){let r=0,n=e.length;if(t){let s=e.codePointAt(r);for(;s===XG||s===KG;)r++,s=e.codePointAt(r)}if(i){let s=e.codePointAt(n-1);for(;s===XG||s===KG;)n--,s=e.codePointAt(n-1)}return n>r?e.slice(r,n):""}function YZe(e,t){const i={type:"text",value:qZe(String(t.value))};return e.patch(t,i),e.applyData(t,i)}function XZe(e,t){const i={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,i),e.applyData(t,i)}const KZe={blockquote:SZe,break:TZe,code:CZe,delete:AZe,emphasis:MZe,footnoteReference:PZe,heading:DZe,html:IZe,imageReference:OZe,image:RZe,inlineCode:LZe,linkReference:NZe,link:kZe,listItem:BZe,list:FZe,paragraph:UZe,root:jZe,strong:VZe,table:HZe,tableCell:GZe,tableRow:WZe,text:YZe,thematicBreak:XZe,toml:VS,yaml:VS,definition:VS,footnoteDefinition:VS};function VS(){}const qne=-1,$M=0,Rb=1,RA=2,Xz=3,Kz=4,$z=5,Zz=6,Yne=7,Xne=8,ZG=typeof self=="object"?self:globalThis,$Ze=(e,t)=>{const i=(n,s)=>(e.set(s,n),n),r=n=>{if(e.has(n))return e.get(n);const[s,a]=t[n];switch(s){case $M:case qne:return i(a,n);case Rb:{const o=i([],n);for(const l of a)o.push(r(l));return o}case RA:{const o=i({},n);for(const[l,u]of a)o[r(l)]=r(u);return o}case Xz:return i(new Date(a),n);case Kz:{const{source:o,flags:l}=a;return i(new RegExp(o,l),n)}case $z:{const o=i(new Map,n);for(const[l,u]of a)o.set(r(l),r(u));return o}case Zz:{const o=i(new Set,n);for(const l of a)o.add(r(l));return o}case Yne:{const{name:o,message:l}=a;return i(new ZG[o](l),n)}case Xne:return i(BigInt(a),n);case"BigInt":return i(Object(BigInt(a)),n);case"ArrayBuffer":return i(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:o}=new Uint8Array(a);return i(new DataView(o),a)}}return i(new ZG[s](a),n)};return r},QG=e=>$Ze(new Map,e)(0),c0="",{toString:ZZe}={},{keys:QZe}=Object,Cx=e=>{const t=typeof e;if(t!=="object"||!e)return[$M,t];const i=ZZe.call(e).slice(8,-1);switch(i){case"Array":return[Rb,c0];case"Object":return[RA,c0];case"Date":return[Xz,c0];case"RegExp":return[Kz,c0];case"Map":return[$z,c0];case"Set":return[Zz,c0];case"DataView":return[Rb,i]}return i.includes("Array")?[Rb,i]:i.includes("Error")?[Yne,i]:[RA,i]},HS=([e,t])=>e===$M&&(t==="function"||t==="symbol"),JZe=(e,t,i,r)=>{const n=(a,o)=>{const l=r.push(a)-1;return i.set(o,l),l},s=a=>{if(i.has(a))return i.get(a);let[o,l]=Cx(a);switch(o){case $M:{let c=a;switch(l){case"bigint":o=Xne,c=a.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return n([qne],a)}return n([o,c],a)}case Rb:{if(l){let d=a;return l==="DataView"?d=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(d=new Uint8Array(a)),n([l,[...d]],a)}const c=[],h=n([o,c],a);for(const d of a)c.push(s(d));return h}case RA:{if(l)switch(l){case"BigInt":return n([l,a.toString()],a);case"Boolean":case"Number":case"String":return n([l,a.valueOf()],a)}if(t&&"toJSON"in a)return s(a.toJSON());const c=[],h=n([o,c],a);for(const d of QZe(a))(e||!HS(Cx(a[d])))&&c.push([s(d),s(a[d])]);return h}case Xz:return n([o,a.toISOString()],a);case Kz:{const{source:c,flags:h}=a;return n([o,{source:c,flags:h}],a)}case $z:{const c=[],h=n([o,c],a);for(const[d,f]of a)(e||!(HS(Cx(d))||HS(Cx(f))))&&c.push([s(d),s(f)]);return h}case Zz:{const c=[],h=n([o,c],a);for(const d of a)(e||!HS(Cx(d)))&&c.push(s(d));return h}}const{message:u}=a;return n([o,{name:l,message:u}],a)};return s},JG=(e,{json:t,lossy:i}={})=>{const r=[];return JZe(!(t||i),!!t,new Map,r)(e),r},LA=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?QG(JG(e,t)):structuredClone(e):(e,t)=>QG(JG(e,t));function eQe(e,t){const i=[{type:"text",value:"↩"}];return t>1&&i.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),i}function tQe(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function iQe(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=e.options.footnoteBackContent||eQe,r=e.options.footnoteBackLabel||tQe,n=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[l]);if(!u)continue;const c=e.all(u),h=String(u.identifier).toUpperCase(),d=_1(h.toLowerCase());let f=0;const m=[],g=e.footnoteCounts.get(h);for(;g!==void 0&&++f<=g;){m.length>0&&m.push({type:"text",value:" "});let w=typeof i=="string"?i:i(l,f);typeof w=="string"&&(w={type:"text",value:w}),m.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+d+(f>1?"-"+f:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,f),className:["data-footnote-backref"]},children:Array.isArray(w)?w:[w]})}const y=c[c.length-1];if(y&&y.type==="element"&&y.tagName==="p"){const w=y.children[y.children.length-1];w&&w.type==="text"?w.value+=" ":y.children.push({type:"text",value:" "}),y.children.push(...m)}else c.push(...m);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+d},children:e.wrap(c,!0)};e.patch(u,x),o.push(x)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...LA(a),id:"footnote-label"},children:[{type:"text",value:n}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const gw=function(e){if(e==null)return aQe;if(typeof e=="function")return ZM(e);if(typeof e=="object")return Array.isArray(e)?rQe(e):nQe(e);if(typeof e=="string")return sQe(e);throw new Error("Expected function, string, or object as test")};function rQe(e){const t=[];let i=-1;for(;++i<e.length;)t[i]=gw(e[i]);return ZM(r);function r(...n){let s=-1;for(;++s<t.length;)if(t[s].apply(this,n))return!0;return!1}}function nQe(e){const t=e;return ZM(i);function i(r){const n=r;let s;for(s in e)if(n[s]!==t[s])return!1;return!0}}function sQe(e){return ZM(t);function t(i){return i&&i.type===e}}function ZM(e){return t;function t(i,r,n){return!!(oQe(i)&&e.call(this,i,typeof r=="number"?r:void 0,n||void 0))}}function aQe(){return!0}function oQe(e){return e!==null&&typeof e=="object"&&"type"in e}const Kne=[],lQe=!0,zN=!1,uQe="skip";function $ne(e,t,i,r){let n;typeof t=="function"&&typeof i!="function"?(r=i,i=t):n=t;const s=gw(n),a=r?-1:1;o(e,void 0,[])();function o(l,u,c){const h=l&&typeof l=="object"?l:{};if(typeof h.type=="string"){const f=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(d,"name",{value:"node ("+(l.type+(f?"<"+f+">":""))+")"})}return d;function d(){let f=Kne,m,g,y;if((!t||s(l,u,c[c.length-1]||void 0))&&(f=cQe(i(l,c)),f[0]===zN))return f;if("children"in l&&l.children){const x=l;if(x.children&&f[0]!==uQe)for(g=(r?x.children.length:-1)+a,y=c.concat(x);g>-1&&g<x.children.length;){const w=x.children[g];if(m=o(w,g,y)(),m[0]===zN)return m;g=typeof m[1]=="number"?m[1]:g+a}}return f}}}function cQe(e){return Array.isArray(e)?e:typeof e=="number"?[lQe,e]:e==null?Kne:[e]}function QM(e,t,i,r){let n,s,a;typeof t=="function"&&typeof i!="function"?(s=void 0,a=t,n=i):(s=t,a=i,n=r),$ne(e,s,o,n);function o(l,u){const c=u[u.length-1],h=c?c.children.indexOf(l):void 0;return a(l,h,c)}}const FN={}.hasOwnProperty,hQe={};function dQe(e,t){const i=t||hQe,r=new Map,n=new Map,s=new Map,a={...KZe,...i.handlers},o={all:u,applyData:pQe,definitionById:r,footnoteById:n,footnoteCounts:s,footnoteOrder:[],handlers:a,one:l,options:i,patch:fQe,wrap:gQe};return QM(e,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const h=c.type==="definition"?r:n,d=String(c.identifier).toUpperCase();h.has(d)||h.set(d,c)}}),o;function l(c,h){const d=c.type,f=o.handlers[d];if(FN.call(o.handlers,d)&&f)return f(o,c,h);if(o.options.passThrough&&o.options.passThrough.includes(d)){if("children"in c){const{children:g,...y}=c,x=LA(y);return x.children=o.all(c),x}return LA(c)}return(o.options.unknownHandler||mQe)(o,c,h)}function u(c){const h=[];if("children"in c){const d=c.children;let f=-1;for(;++f<d.length;){const m=o.one(d[f],c);if(m){if(f&&d[f-1].type==="break"&&(!Array.isArray(m)&&m.type==="text"&&(m.value=eq(m.value)),!Array.isArray(m)&&m.type==="element")){const g=m.children[0];g&&g.type==="text"&&(g.value=eq(g.value))}Array.isArray(m)?h.push(...m):h.push(m)}}}return h}}function fQe(e,t){e.position&&(t.position=tKe(e))}function pQe(e,t){let i=t;if(e&&e.data){const r=e.data.hName,n=e.data.hChildren,s=e.data.hProperties;if(typeof r=="string")if(i.type==="element")i.tagName=r;else{const a="children"in i?i.children:[i];i={type:"element",tagName:r,properties:{},children:a}}i.type==="element"&&s&&Object.assign(i.properties,LA(s)),"children"in i&&i.children&&n!==null&&n!==void 0&&(i.children=n)}return i}function mQe(e,t){const i=t.data||{},r="value"in t&&!(FN.call(i,"hProperties")||FN.call(i,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function gQe(e,t){const i=[];let r=-1;for(t&&i.push({type:"text",value:`
`});++r<e.length;)r&&i.push({type:"text",value:`
`}),i.push(e[r]);return t&&e.length>0&&i.push({type:"text",value:`
`}),i}function eq(e){let t=0,i=e.charCodeAt(t);for(;i===9||i===32;)t++,i=e.charCodeAt(t);return e.slice(t)}function tq(e,t){const i=dQe(e,t),r=i.one(e,void 0),n=iQe(i),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return n&&s.children.push({type:"text",value:`
`},n),s}function vQe(e,t){return e&&"run"in e?async function(i,r){const n=tq(i,{file:r,...t});await e.run(n,r)}:function(i,r){return tq(i,{file:r,...e||t})}}function iq(e){if(e)throw e}var zT=Object.prototype.hasOwnProperty,Zne=Object.prototype.toString,rq=Object.defineProperty,nq=Object.getOwnPropertyDescriptor,sq=function(t){return typeof Array.isArray=="function"?Array.isArray(t):Zne.call(t)==="[object Array]"},aq=function(t){if(!t||Zne.call(t)!=="[object Object]")return!1;var i=zT.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&zT.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!i&&!r)return!1;var n;for(n in t);return typeof n>"u"||zT.call(t,n)},oq=function(t,i){rq&&i.name==="__proto__"?rq(t,i.name,{enumerable:!0,configurable:!0,value:i.newValue,writable:!0}):t[i.name]=i.newValue},lq=function(t,i){if(i==="__proto__")if(zT.call(t,i)){if(nq)return nq(t,i).value}else return;return t[i]},yQe=function e(){var t,i,r,n,s,a,o=arguments[0],l=1,u=arguments.length,c=!1;for(typeof o=="boolean"&&(c=o,o=arguments[1]||{},l=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});l<u;++l)if(t=arguments[l],t!=null)for(i in t)r=lq(o,i),n=lq(t,i),o!==n&&(c&&n&&(aq(n)||(s=sq(n)))?(s?(s=!1,a=r&&sq(r)?r:[]):a=r&&aq(r)?r:{},oq(o,{name:i,newValue:e(c,a,n)})):typeof n<"u"&&oq(o,{name:i,newValue:n}));return o};const AO=O_(yQe);function UN(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function xQe(){const e=[],t={run:i,use:r};return t;function i(...n){let s=-1;const a=n.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...n);function o(l,...u){const c=e[++s];let h=-1;if(l){a(l);return}for(;++h<n.length;)(u[h]===null||u[h]===void 0)&&(u[h]=n[h]);n=u,c?bQe(c,o)(...u):a(null,...u)}}function r(n){if(typeof n!="function")throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}}function bQe(e,t){let i;return r;function r(...a){const o=e.length>a.length;let l;o&&a.push(n);try{l=e.apply(this,a)}catch(u){const c=u;if(o&&i)throw c;return n(c)}o||(l&&l.then&&typeof l.then=="function"?l.then(s,n):l instanceof Error?n(l):s(l))}function n(a,...o){i||(i=!0,t(a,...o))}function s(a){n(null,a)}}const oh={basename:_Qe,dirname:wQe,extname:EQe,join:SQe,sep:"/"};function _Qe(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');vw(e);let i=0,r=-1,n=e.length,s;if(t===void 0||t.length===0||t.length>e.length){for(;n--;)if(e.codePointAt(n)===47){if(s){i=n+1;break}}else r<0&&(s=!0,r=n+1);return r<0?"":e.slice(i,r)}if(t===e)return"";let a=-1,o=t.length-1;for(;n--;)if(e.codePointAt(n)===47){if(s){i=n+1;break}}else a<0&&(s=!0,a=n+1),o>-1&&(e.codePointAt(n)===t.codePointAt(o--)?o<0&&(r=n):(o=-1,r=a));return i===r?r=a:r<0&&(r=e.length),e.slice(i,r)}function wQe(e){if(vw(e),e.length===0)return".";let t=-1,i=e.length,r;for(;--i;)if(e.codePointAt(i)===47){if(r){t=i;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function EQe(e){vw(e);let t=e.length,i=-1,r=0,n=-1,s=0,a;for(;t--;){const o=e.codePointAt(t);if(o===47){if(a){r=t+1;break}continue}i<0&&(a=!0,i=t+1),o===46?n<0?n=t:s!==1&&(s=1):n>-1&&(s=-1)}return n<0||i<0||s===0||s===1&&n===i-1&&n===r+1?"":e.slice(n,i)}function SQe(...e){let t=-1,i;for(;++t<e.length;)vw(e[t]),e[t]&&(i=i===void 0?e[t]:i+"/"+e[t]);return i===void 0?".":TQe(i)}function TQe(e){vw(e);const t=e.codePointAt(0)===47;let i=CQe(e,!t);return i.length===0&&!t&&(i="."),i.length>0&&e.codePointAt(e.length-1)===47&&(i+="/"),t?"/"+i:i}function CQe(e,t){let i="",r=0,n=-1,s=0,a=-1,o,l;for(;++a<=e.length;){if(a<e.length)o=e.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(i.length<2||r!==2||i.codePointAt(i.length-1)!==46||i.codePointAt(i.length-2)!==46){if(i.length>2){if(l=i.lastIndexOf("/"),l!==i.length-1){l<0?(i="",r=0):(i=i.slice(0,l),r=i.length-1-i.lastIndexOf("/")),n=a,s=0;continue}}else if(i.length>0){i="",r=0,n=a,s=0;continue}}t&&(i=i.length>0?i+"/..":"..",r=2)}else i.length>0?i+="/"+e.slice(n+1,a):i=e.slice(n+1,a),r=a-n-1;n=a,s=0}else o===46&&s>-1?s++:s=-1}return i}function vw(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const AQe={cwd:MQe};function MQe(){return"/"}function jN(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function PQe(e){if(typeof e=="string")e=new URL(e);else if(!jN(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return DQe(e)}function DQe(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let i=-1;for(;++i<t.length;)if(t.codePointAt(i)===37&&t.codePointAt(i+1)===50){const r=t.codePointAt(i+2);if(r===70||r===102){const n=new TypeError("File URL path must not include encoded / characters");throw n.code="ERR_INVALID_FILE_URL_PATH",n}}return decodeURIComponent(t)}const MO=["history","path","basename","stem","extname","dirname"];class Qne{constructor(t){let i;t?jN(t)?i={path:t}:typeof t=="string"||IQe(t)?i={value:t}:i=t:i={},this.cwd="cwd"in i?"":AQe.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<MO.length;){const s=MO[r];s in i&&i[s]!==void 0&&i[s]!==null&&(this[s]=s==="history"?[...i[s]]:i[s])}let n;for(n in i)MO.includes(n)||(this[n]=i[n])}get basename(){return typeof this.path=="string"?oh.basename(this.path):void 0}set basename(t){DO(t,"basename"),PO(t,"basename"),this.path=oh.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?oh.dirname(this.path):void 0}set dirname(t){uq(this.basename,"dirname"),this.path=oh.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?oh.extname(this.path):void 0}set extname(t){if(PO(t,"extname"),uq(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=oh.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){jN(t)&&(t=PQe(t)),DO(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?oh.basename(this.path,this.extname):void 0}set stem(t){DO(t,"stem"),PO(t,"stem"),this.path=oh.join(this.dirname||"",t+(this.extname||""))}fail(t,i,r){const n=this.message(t,i,r);throw n.fatal=!0,n}info(t,i,r){const n=this.message(t,i,r);return n.fatal=void 0,n}message(t,i,r){const n=new bo(t,i,r);return this.path&&(n.name=this.path+":"+n.name,n.file=this.path),n.fatal=!1,this.messages.push(n),n}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function PO(e,t){if(e&&e.includes(oh.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+oh.sep+"`")}function DO(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function uq(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function IQe(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const OQe=function(e){const r=this.constructor.prototype,n=r[e],s=function(){return n.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},RQe={}.hasOwnProperty;class Qz extends OQe{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=xQe()}copy(){const t=new Qz;let i=-1;for(;++i<this.attachers.length;){const r=this.attachers[i];t.use(...r)}return t.data(AO(!0,{},this.namespace)),t}data(t,i){return typeof t=="string"?arguments.length===2?(RO("data",this.frozen),this.namespace[t]=i,this):RQe.call(this.namespace,t)&&this.namespace[t]||void 0:t?(RO("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[i,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const n=i.call(t,...r);typeof n=="function"&&this.transformers.use(n)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const i=WS(t),r=this.parser||this.Parser;return IO("parse",r),r(String(i),i)}process(t,i){const r=this;return this.freeze(),IO("process",this.parser||this.Parser),OO("process",this.compiler||this.Compiler),i?n(void 0,i):new Promise(n);function n(s,a){const o=WS(t),l=r.parse(o);r.run(l,o,function(c,h,d){if(c||!h||!d)return u(c);const f=h,m=r.stringify(f,d);kQe(m)?d.value=m:d.result=m,u(c,d)});function u(c,h){c||!h?a(c):s?s(h):i(void 0,h)}}}processSync(t){let i=!1,r;return this.freeze(),IO("processSync",this.parser||this.Parser),OO("processSync",this.compiler||this.Compiler),this.process(t,n),hq("processSync","process",i),r;function n(s,a){i=!0,iq(s),r=a}}run(t,i,r){cq(t),this.freeze();const n=this.transformers;return!r&&typeof i=="function"&&(r=i,i=void 0),r?s(void 0,r):new Promise(s);function s(a,o){const l=WS(i);n.run(t,l,u);function u(c,h,d){const f=h||t;c?o(c):a?a(f):r(void 0,f,d)}}}runSync(t,i){let r=!1,n;return this.run(t,i,s),hq("runSync","run",r),n;function s(a,o){iq(a),n=o,r=!0}}stringify(t,i){this.freeze();const r=WS(i),n=this.compiler||this.Compiler;return OO("stringify",n),cq(t),n(t,r)}use(t,...i){const r=this.attachers,n=this.namespace;if(RO("use",this.frozen),t!=null)if(typeof t=="function")l(t,i);else if(typeof t=="object")Array.isArray(t)?o(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function s(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[c,...h]=u;l(c,h)}else a(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function a(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(u.plugins),u.settings&&(n.settings=AO(!0,n.settings,u.settings))}function o(u){let c=-1;if(u!=null)if(Array.isArray(u))for(;++c<u.length;){const h=u[c];s(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,c){let h=-1,d=-1;for(;++h<r.length;)if(r[h][0]===u){d=h;break}if(d===-1)r.push([u,...c]);else if(c.length>0){let[f,...m]=c;const g=r[d][1];UN(g)&&UN(f)&&(f=AO(!0,g,f)),r[d]=[u,f,...m]}}}}const LQe=new Qz().freeze();function IO(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function OO(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function RO(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function cq(e){if(!UN(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function hq(e,t,i){if(!i)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function WS(e){return NQe(e)?e:new Qne(e)}function NQe(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function kQe(e){return typeof e=="string"||BQe(e)}function BQe(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const zQe="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",dq=[],fq={allowDangerousHtml:!0},FQe=/^(https?|ircs?|mailto|xmpp)$/i,UQe=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function jQe(e){const t=VQe(e),i=HQe(e);return WQe(t.runSync(t.parse(i),i),e)}function VQe(e){const t=e.rehypePlugins||dq,i=e.remarkPlugins||dq,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...fq}:fq;return LQe().use(EZe).use(i).use(vQe,r).use(t)}function HQe(e){const t=e.children||"",i=new Qne;return typeof t=="string"&&(i.value=t),i}function WQe(e,t){const i=t.allowedElements,r=t.allowElement,n=t.components,s=t.disallowedElements,a=t.skipHtml,o=t.unwrapDisallowed,l=t.urlTransform||GQe;for(const c of UQe)Object.hasOwn(t,c.from)&&(""+c.from+(c.to?"use `"+c.to+"` instead":"remove it")+zQe+c.id,void 0);return QM(e,u),aKe(e,{Fragment:j.Fragment,components:n,ignoreInvalidStyle:!0,jsx:j.jsx,jsxs:j.jsxs,passKeys:!0,passNode:!0});function u(c,h,d){if(c.type==="raw"&&d&&typeof h=="number")return a?d.children.splice(h,1):d.children[h]={type:"text",value:c.value},h;if(c.type==="element"){let f;for(f in SO)if(Object.hasOwn(SO,f)&&Object.hasOwn(c.properties,f)){const m=c.properties[f],g=SO[f];(g===null||g.includes(c.tagName))&&(c.properties[f]=l(String(m||""),f,c))}}if(c.type==="element"){let f=i?!i.includes(c.tagName):s?s.includes(c.tagName):!1;if(!f&&r&&typeof h=="number"&&(f=!r(c,h,d)),f&&d&&typeof h=="number")return o&&c.children?d.children.splice(h,1,...c.children):d.children.splice(h,1),h}}}function GQe(e){const t=e.indexOf(":"),i=e.indexOf("?"),r=e.indexOf("#"),n=e.indexOf("/");return t===-1||n!==-1&&t>n||i!==-1&&t>i||r!==-1&&t>r||FQe.test(e.slice(0,t))?e:""}function pq(e,t){const i=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,n=i.indexOf(t);for(;n!==-1;)r++,n=i.indexOf(t,n+t.length);return r}function qQe(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function YQe(e,t,i){const n=gw((i||{}).ignore||[]),s=XQe(t);let a=-1;for(;++a<s.length;)$ne(e,"text",o);function o(u,c){let h=-1,d;for(;++h<c.length;){const f=c[h],m=d?d.children:void 0;if(n(f,m?m.indexOf(f):void 0,d))return;d=f}if(d)return l(u,c)}function l(u,c){const h=c[c.length-1],d=s[a][0],f=s[a][1];let m=0;const y=h.children.indexOf(u);let x=!1,w=[];d.lastIndex=0;let b=d.exec(u.value);for(;b;){const C=b.index,A={index:b.index,input:b.input,stack:[...c,u]};let E=f(...b,A);if(typeof E=="string"&&(E=E.length>0?{type:"text",value:E}:void 0),E===!1?d.lastIndex=C+1:(m!==C&&w.push({type:"text",value:u.value.slice(m,C)}),Array.isArray(E)?w.push(...E):E&&w.push(E),m=C+b[0].length,x=!0),!d.global)break;b=d.exec(u.value)}return x?(m<u.value.length&&w.push({type:"text",value:u.value.slice(m)}),h.children.splice(y,1,...w)):w=[u],y+w.length}}function XQe(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const i=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<i.length;){const n=i[r];t.push([KQe(n[0]),$Qe(n[1])])}return t}function KQe(e){return typeof e=="string"?new RegExp(qQe(e),"g"):e}function $Qe(e){return typeof e=="function"?e:function(){return e}}const LO="phrasing",NO=["autolink","link","image","label"];function ZQe(){return{transforms:[nJe],enter:{literalAutolink:JQe,literalAutolinkEmail:kO,literalAutolinkHttp:kO,literalAutolinkWww:kO},exit:{literalAutolink:rJe,literalAutolinkEmail:iJe,literalAutolinkHttp:eJe,literalAutolinkWww:tJe}}}function QQe(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:LO,notInConstruct:NO},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:LO,notInConstruct:NO},{character:":",before:"[ps]",after:"\\/",inConstruct:LO,notInConstruct:NO}]}}function JQe(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function kO(e){this.config.enter.autolinkProtocol.call(this,e)}function eJe(e){this.config.exit.autolinkProtocol.call(this,e)}function tJe(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function iJe(e){this.config.exit.autolinkEmail.call(this,e)}function rJe(e){this.exit(e)}function nJe(e){YQe(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,sJe],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),aJe]],{ignore:["link","linkReference"]})}function sJe(e,t,i,r,n){let s="";if(!Jne(n)||(/^w/i.test(t)&&(i=t+i,t="",s="http://"),!oJe(i)))return!1;const a=lJe(i+r);if(!a[0])return!1;const o={type:"link",title:null,url:s+t+a[0],children:[{type:"text",value:t+a[0]}]};return a[1]?[o,{type:"text",value:a[1]}]:o}function aJe(e,t,i,r){return!Jne(r,!0)||/[-\d_]$/.test(i)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+i,children:[{type:"text",value:t+"@"+i}]}}function oJe(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function lJe(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let i=t[0],r=i.indexOf(")");const n=pq(e,"(");let s=pq(e,")");for(;r!==-1&&n>s;)e+=i.slice(0,r+1),i=i.slice(r+1),r=i.indexOf(")"),s++;return[e,i]}function Jne(e,t){const i=e.input.charCodeAt(e.index-1);return(e.index===0||ev(i)||XM(i))&&(!t||i!==47)}ese.peek=vJe;function uJe(){this.buffer()}function cJe(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function hJe(){this.buffer()}function dJe(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function fJe(e){const t=this.resume(),i=this.stack[this.stack.length-1];i.type,i.identifier=Ec(this.sliceSerialize(e)).toLowerCase(),i.label=t}function pJe(e){this.exit(e)}function mJe(e){const t=this.resume(),i=this.stack[this.stack.length-1];i.type,i.identifier=Ec(this.sliceSerialize(e)).toLowerCase(),i.label=t}function gJe(e){this.exit(e)}function vJe(){return"["}function ese(e,t,i,r){const n=i.createTracker(r);let s=n.move("[^");const a=i.enter("footnoteReference"),o=i.enter("reference");return s+=n.move(i.safe(i.associationId(e),{after:"]",before:s})),o(),a(),s+=n.move("]"),s}function yJe(){return{enter:{gfmFootnoteCallString:uJe,gfmFootnoteCall:cJe,gfmFootnoteDefinitionLabelString:hJe,gfmFootnoteDefinition:dJe},exit:{gfmFootnoteCallString:fJe,gfmFootnoteCall:pJe,gfmFootnoteDefinitionLabelString:mJe,gfmFootnoteDefinition:gJe}}}function xJe(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:i,footnoteReference:ese},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function i(r,n,s,a){const o=s.createTracker(a);let l=o.move("[^");const u=s.enter("footnoteDefinition"),c=s.enter("label");return l+=o.move(s.safe(s.associationId(r),{before:l,after:"]"})),c(),l+=o.move("]:"),r.children&&r.children.length>0&&(o.shift(4),l+=o.move((t?`
`:" ")+s.indentLines(s.containerFlow(r,o.current()),t?tse:bJe))),u(),l}}function bJe(e,t,i){return t===0?e:tse(e,t,i)}function tse(e,t,i){return(i?"":"    ")+e}const _Je=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];ise.peek=CJe;function wJe(){return{canContainEols:["delete"],enter:{strikethrough:SJe},exit:{strikethrough:TJe}}}function EJe(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:_Je}],handlers:{delete:ise}}}function SJe(e){this.enter({type:"delete",children:[]},e)}function TJe(e){this.exit(e)}function ise(e,t,i,r){const n=i.createTracker(r),s=i.enter("strikethrough");let a=n.move("~~");return a+=i.containerPhrasing(e,{...n.current(),before:a,after:"~"}),a+=n.move("~~"),s(),a}function CJe(){return"~"}function AJe(e){return e.length}function MJe(e,t){const i=t||{},r=(i.align||[]).concat(),n=i.stringLength||AJe,s=[],a=[],o=[],l=[];let u=0,c=-1;for(;++c<e.length;){const g=[],y=[];let x=-1;for(e[c].length>u&&(u=e[c].length);++x<e[c].length;){const w=PJe(e[c][x]);if(i.alignDelimiters!==!1){const b=n(w);y[x]=b,(l[x]===void 0||b>l[x])&&(l[x]=b)}g.push(w)}a[c]=g,o[c]=y}let h=-1;if(typeof r=="object"&&"length"in r)for(;++h<u;)s[h]=mq(r[h]);else{const g=mq(r);for(;++h<u;)s[h]=g}h=-1;const d=[],f=[];for(;++h<u;){const g=s[h];let y="",x="";g===99?(y=":",x=":"):g===108?y=":":g===114&&(x=":");let w=i.alignDelimiters===!1?1:Math.max(1,l[h]-y.length-x.length);const b=y+"-".repeat(w)+x;i.alignDelimiters!==!1&&(w=y.length+w+x.length,w>l[h]&&(l[h]=w),f[h]=w),d[h]=b}a.splice(1,0,d),o.splice(1,0,f),c=-1;const m=[];for(;++c<a.length;){const g=a[c],y=o[c];h=-1;const x=[];for(;++h<u;){const w=g[h]||"";let b="",C="";if(i.alignDelimiters!==!1){const A=l[h]-(y[h]||0),E=s[h];E===114?b=" ".repeat(A):E===99?A%2?(b=" ".repeat(A/2+.5),C=" ".repeat(A/2-.5)):(b=" ".repeat(A/2),C=b):C=" ".repeat(A)}i.delimiterStart!==!1&&!h&&x.push("|"),i.padding!==!1&&!(i.alignDelimiters===!1&&w==="")&&(i.delimiterStart!==!1||h)&&x.push(" "),i.alignDelimiters!==!1&&x.push(b),x.push(w),i.alignDelimiters!==!1&&x.push(C),i.padding!==!1&&x.push(" "),(i.delimiterEnd!==!1||h!==u-1)&&x.push("|")}m.push(i.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return m.join(`
`)}function PJe(e){return e==null?"":String(e)}function mq(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function DJe(e,t,i,r){const n=i.enter("blockquote"),s=i.createTracker(r);s.move("> "),s.shift(2);const a=i.indentLines(i.containerFlow(e,s.current()),IJe);return n(),a}function IJe(e,t,i){return">"+(i?"":" ")+e}function OJe(e,t){return gq(e,t.inConstruct,!0)&&!gq(e,t.notInConstruct,!1)}function gq(e,t,i){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return i;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function vq(e,t,i,r){let n=-1;for(;++n<i.unsafe.length;)if(i.unsafe[n].character===`
`&&OJe(i.stack,i.unsafe[n]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function RJe(e,t){const i=String(e);let r=i.indexOf(t),n=r,s=0,a=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===n?++s>a&&(a=s):s=1,n=r+t.length,r=i.indexOf(t,n);return a}function LJe(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function NJe(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function kJe(e,t,i,r){const n=NJe(i),s=e.value||"",a=n==="`"?"GraveAccent":"Tilde";if(LJe(e,i)){const h=i.enter("codeIndented"),d=i.indentLines(s,BJe);return h(),d}const o=i.createTracker(r),l=n.repeat(Math.max(RJe(s,n)+1,3)),u=i.enter("codeFenced");let c=o.move(l);if(e.lang){const h=i.enter(`codeFencedLang${a}`);c+=o.move(i.safe(e.lang,{before:c,after:" ",encode:["`"],...o.current()})),h()}if(e.lang&&e.meta){const h=i.enter(`codeFencedMeta${a}`);c+=o.move(" "),c+=o.move(i.safe(e.meta,{before:c,after:`
`,encode:["`"],...o.current()})),h()}return c+=o.move(`
`),s&&(c+=o.move(s+`
`)),c+=o.move(l),u(),c}function BJe(e,t,i){return(i?"":"    ")+e}function Jz(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function zJe(e,t,i,r){const n=Jz(i),s=n==='"'?"Quote":"Apostrophe",a=i.enter("definition");let o=i.enter("label");const l=i.createTracker(r);let u=l.move("[");return u+=l.move(i.safe(i.associationId(e),{before:u,after:"]",...l.current()})),u+=l.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=i.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(i.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(o=i.enter("destinationRaw"),u+=l.move(i.safe(e.url,{before:u,after:e.title?" ":`
`,...l.current()}))),o(),e.title&&(o=i.enter(`title${s}`),u+=l.move(" "+n),u+=l.move(i.safe(e.title,{before:u,after:n,...l.current()})),u+=l.move(n),o()),a(),u}function FJe(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function P_(e){return"&#x"+e.toString(16).toUpperCase()+";"}function NA(e,t,i){const r=Gy(e),n=Gy(t);return r===void 0?n===void 0?i==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:n===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?n===void 0?{inside:!1,outside:!1}:n===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:n===void 0?{inside:!1,outside:!1}:n===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}rse.peek=UJe;function rse(e,t,i,r){const n=FJe(i),s=i.enter("emphasis"),a=i.createTracker(r),o=a.move(n);let l=a.move(i.containerPhrasing(e,{after:n,before:o,...a.current()}));const u=l.charCodeAt(0),c=NA(r.before.charCodeAt(r.before.length-1),u,n);c.inside&&(l=P_(u)+l.slice(1));const h=l.charCodeAt(l.length-1),d=NA(r.after.charCodeAt(0),h,n);d.inside&&(l=l.slice(0,-1)+P_(h));const f=a.move(n);return s(),i.attentionEncodeSurroundingInfo={after:d.outside,before:c.outside},o+l+f}function UJe(e,t,i){return i.options.emphasis||"*"}function jJe(e,t){let i=!1;return QM(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return i=!0,zN}),!!((!e.depth||e.depth<3)&&Gz(e)&&(t.options.setext||i))}function VJe(e,t,i,r){const n=Math.max(Math.min(6,e.depth||1),1),s=i.createTracker(r);if(jJe(e,i)){const c=i.enter("headingSetext"),h=i.enter("phrasing"),d=i.containerPhrasing(e,{...s.current(),before:`
`,after:`
`});return h(),c(),d+`
`+(n===1?"=":"-").repeat(d.length-(Math.max(d.lastIndexOf("\r"),d.lastIndexOf(`
`))+1))}const a="#".repeat(n),o=i.enter("headingAtx"),l=i.enter("phrasing");s.move(a+" ");let u=i.containerPhrasing(e,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(u)&&(u=P_(u.charCodeAt(0))+u.slice(1)),u=u?a+" "+u:a,i.options.closeAtx&&(u+=" "+a),l(),o(),u}nse.peek=HJe;function nse(e){return e.value||""}function HJe(){return"<"}sse.peek=WJe;function sse(e,t,i,r){const n=Jz(i),s=n==='"'?"Quote":"Apostrophe",a=i.enter("image");let o=i.enter("label");const l=i.createTracker(r);let u=l.move("![");return u+=l.move(i.safe(e.alt,{before:u,after:"]",...l.current()})),u+=l.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=i.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(i.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(o=i.enter("destinationRaw"),u+=l.move(i.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),o(),e.title&&(o=i.enter(`title${s}`),u+=l.move(" "+n),u+=l.move(i.safe(e.title,{before:u,after:n,...l.current()})),u+=l.move(n),o()),u+=l.move(")"),a(),u}function WJe(){return"!"}ase.peek=GJe;function ase(e,t,i,r){const n=e.referenceType,s=i.enter("imageReference");let a=i.enter("label");const o=i.createTracker(r);let l=o.move("![");const u=i.safe(e.alt,{before:l,after:"]",...o.current()});l+=o.move(u+"]["),a();const c=i.stack;i.stack=[],a=i.enter("reference");const h=i.safe(i.associationId(e),{before:l,after:"]",...o.current()});return a(),i.stack=c,s(),n==="full"||!u||u!==h?l+=o.move(h+"]"):n==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function GJe(){return"!"}ose.peek=qJe;function ose(e,t,i){let r=e.value||"",n="`",s=-1;for(;new RegExp("(^|[^`])"+n+"([^`]|$)").test(r);)n+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<i.unsafe.length;){const a=i.unsafe[s],o=i.compilePattern(a);let l;if(a.atBreak)for(;l=o.exec(r);){let u=l.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(l.index+1)}}return n+r+n}function qJe(){return"`"}function lse(e,t){const i=Gz(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(i===e.url||"mailto:"+i===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}use.peek=YJe;function use(e,t,i,r){const n=Jz(i),s=n==='"'?"Quote":"Apostrophe",a=i.createTracker(r);let o,l;if(lse(e,i)){const c=i.stack;i.stack=[],o=i.enter("autolink");let h=a.move("<");return h+=a.move(i.containerPhrasing(e,{before:h,after:">",...a.current()})),h+=a.move(">"),o(),i.stack=c,h}o=i.enter("link"),l=i.enter("label");let u=a.move("[");return u+=a.move(i.containerPhrasing(e,{before:u,after:"](",...a.current()})),u+=a.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=i.enter("destinationLiteral"),u+=a.move("<"),u+=a.move(i.safe(e.url,{before:u,after:">",...a.current()})),u+=a.move(">")):(l=i.enter("destinationRaw"),u+=a.move(i.safe(e.url,{before:u,after:e.title?" ":")",...a.current()}))),l(),e.title&&(l=i.enter(`title${s}`),u+=a.move(" "+n),u+=a.move(i.safe(e.title,{before:u,after:n,...a.current()})),u+=a.move(n),l()),u+=a.move(")"),o(),u}function YJe(e,t,i){return lse(e,i)?"<":"["}cse.peek=XJe;function cse(e,t,i,r){const n=e.referenceType,s=i.enter("linkReference");let a=i.enter("label");const o=i.createTracker(r);let l=o.move("[");const u=i.containerPhrasing(e,{before:l,after:"]",...o.current()});l+=o.move(u+"]["),a();const c=i.stack;i.stack=[],a=i.enter("reference");const h=i.safe(i.associationId(e),{before:l,after:"]",...o.current()});return a(),i.stack=c,s(),n==="full"||!u||u!==h?l+=o.move(h+"]"):n==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function XJe(){return"["}function eF(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function KJe(e){const t=eF(e),i=e.options.bulletOther;if(!i)return t==="*"?"-":"*";if(i!=="*"&&i!=="+"&&i!=="-")throw new Error("Cannot serialize items with `"+i+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(i===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+i+"`) to be different");return i}function $Je(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function hse(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function ZJe(e,t,i,r){const n=i.enter("list"),s=i.bulletCurrent;let a=e.ordered?$Je(i):eF(i);const o=e.ordered?a==="."?")":".":KJe(i);let l=t&&i.bulletLastUsed?a===i.bulletLastUsed:!1;if(!e.ordered){const c=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&c&&(!c.children||!c.children[0])&&i.stack[i.stack.length-1]==="list"&&i.stack[i.stack.length-2]==="listItem"&&i.stack[i.stack.length-3]==="list"&&i.stack[i.stack.length-4]==="listItem"&&i.indexStack[i.indexStack.length-1]===0&&i.indexStack[i.indexStack.length-2]===0&&i.indexStack[i.indexStack.length-3]===0&&(l=!0),hse(i)===a&&c){let h=-1;for(;++h<e.children.length;){const d=e.children[h];if(d&&d.type==="listItem"&&d.children&&d.children[0]&&d.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=o),i.bulletCurrent=a;const u=i.containerFlow(e,r);return i.bulletLastUsed=a,i.bulletCurrent=s,n(),u}function QJe(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function JJe(e,t,i,r){const n=QJe(i);let s=i.bulletCurrent||eF(i);t&&t.type==="list"&&t.ordered&&(s=(typeof t.start=="number"&&t.start>-1?t.start:1)+(i.options.incrementListMarker===!1?0:t.children.indexOf(e))+s);let a=s.length+1;(n==="tab"||n==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);const o=i.createTracker(r);o.move(s+" ".repeat(a-s.length)),o.shift(a);const l=i.enter("listItem"),u=i.indentLines(i.containerFlow(e,o.current()),c);return l(),u;function c(h,d,f){return d?(f?"":" ".repeat(a))+h:(f?s:s+" ".repeat(a-s.length))+h}}function eet(e,t,i,r){const n=i.enter("paragraph"),s=i.enter("phrasing"),a=i.containerPhrasing(e,r);return s(),n(),a}const tet=gw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function iet(e,t,i,r){return(e.children.some(function(a){return tet(a)})?i.containerPhrasing:i.containerFlow).call(i,e,r)}function ret(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}dse.peek=net;function dse(e,t,i,r){const n=ret(i),s=i.enter("strong"),a=i.createTracker(r),o=a.move(n+n);let l=a.move(i.containerPhrasing(e,{after:n,before:o,...a.current()}));const u=l.charCodeAt(0),c=NA(r.before.charCodeAt(r.before.length-1),u,n);c.inside&&(l=P_(u)+l.slice(1));const h=l.charCodeAt(l.length-1),d=NA(r.after.charCodeAt(0),h,n);d.inside&&(l=l.slice(0,-1)+P_(h));const f=a.move(n+n);return s(),i.attentionEncodeSurroundingInfo={after:d.outside,before:c.outside},o+l+f}function net(e,t,i){return i.options.strong||"*"}function set(e,t,i,r){return i.safe(e.value,r)}function aet(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function oet(e,t,i){const r=(hse(i)+(i.options.ruleSpaces?" ":"")).repeat(aet(i));return i.options.ruleSpaces?r.slice(0,-1):r}const fse={blockquote:DJe,break:vq,code:kJe,definition:zJe,emphasis:rse,hardBreak:vq,heading:VJe,html:nse,image:sse,imageReference:ase,inlineCode:ose,link:use,linkReference:cse,list:ZJe,listItem:JJe,paragraph:eet,root:iet,strong:dse,text:set,thematicBreak:oet};function uet(){return{enter:{table:cet,tableData:yq,tableHeader:yq,tableRow:det},exit:{codeText:fet,table:het,tableData:BO,tableHeader:BO,tableRow:BO}}}function cet(e){const t=e._align;this.enter({type:"table",align:t.map(function(i){return i==="none"?null:i}),children:[]},e),this.data.inTable=!0}function het(e){this.exit(e),this.data.inTable=void 0}function det(e){this.enter({type:"tableRow",children:[]},e)}function BO(e){this.exit(e)}function yq(e){this.enter({type:"tableCell",children:[]},e)}function fet(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,pet));const i=this.stack[this.stack.length-1];i.type,i.value=t,this.exit(e)}function pet(e,t){return t==="|"?t:e}function met(e){const t=e||{},i=t.tableCellPadding,r=t.tablePipeAlign,n=t.stringLength,s=i?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:d,table:a,tableCell:l,tableRow:o}};function a(f,m,g,y){return u(c(f,g,y),f.align)}function o(f,m,g,y){const x=h(f,g,y),w=u([x]);return w.slice(0,w.indexOf(`
`))}function l(f,m,g,y){const x=g.enter("tableCell"),w=g.enter("phrasing"),b=g.containerPhrasing(f,{...y,before:s,after:s});return w(),x(),b}function u(f,m){return MJe(f,{align:m,alignDelimiters:r,padding:i,stringLength:n})}function c(f,m,g){const y=f.children;let x=-1;const w=[],b=m.enter("table");for(;++x<y.length;)w[x]=h(y[x],m,g);return b(),w}function h(f,m,g){const y=f.children;let x=-1;const w=[],b=m.enter("tableRow");for(;++x<y.length;)w[x]=l(y[x],f,m,g);return b(),w}function d(f,m,g){let y=fse.inlineCode(f,m,g);return g.stack.includes("tableCell")&&(y=y.replace(/\|/g,"\\$&")),y}}function get(){return{exit:{taskListCheckValueChecked:xq,taskListCheckValueUnchecked:xq,paragraph:yet}}}function vet(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:xet}}}function xq(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function yet(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const i=this.stack[this.stack.length-1];i.type;const r=i.children[0];if(r&&r.type==="text"){const n=t.children;let s=-1,a;for(;++s<n.length;){const o=n[s];if(o.type==="paragraph"){a=o;break}}a===i&&(r.value=r.value.slice(1),r.value.length===0?i.children.shift():i.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,i.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function xet(e,t,i,r){const n=e.children[0],s=typeof e.checked=="boolean"&&n&&n.type==="paragraph",a="["+(e.checked?"x":" ")+"] ",o=i.createTracker(r);s&&o.move(a);let l=fse.listItem(e,t,i,{...r,...o.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),l;function u(c){return c+a}}function bet(){return[ZQe(),yJe(),wJe(),uet(),get()]}function _et(e){return{extensions:[QQe(),xJe(e),EJe(),met(e),vet()]}}const wet={tokenize:Pet,partial:!0},pse={tokenize:Det,partial:!0},mse={tokenize:Iet,partial:!0},gse={tokenize:Oet,partial:!0},Eet={tokenize:Ret,partial:!0},vse={name:"wwwAutolink",tokenize:Aet,previous:xse},yse={name:"protocolAutolink",tokenize:Met,previous:bse},vf={name:"emailAutolink",tokenize:Cet,previous:_se},Hh={};function Tet(){return{text:Hh}}let Xm=48;for(;Xm<123;)Hh[Xm]=vf,Xm++,Xm===58?Xm=65:Xm===91&&(Xm=97);Hh[43]=vf;Hh[45]=vf;Hh[46]=vf;Hh[95]=vf;Hh[72]=[vf,yse];Hh[104]=[vf,yse];Hh[87]=[vf,vse];Hh[119]=[vf,vse];function Cet(e,t,i){const r=this;let n,s;return a;function a(h){return!VN(h)||!_se.call(r,r.previous)||tF(r.events)?i(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(h))}function o(h){return VN(h)?(e.consume(h),o):h===64?(e.consume(h),l):i(h)}function l(h){return h===46?e.check(Eet,c,u)(h):h===45||h===95||mo(h)?(s=!0,e.consume(h),l):c(h)}function u(h){return e.consume(h),n=!0,l}function c(h){return s&&n&&Vo(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):i(h)}}function Aet(e,t,i){const r=this;return n;function n(a){return a!==87&&a!==119||!xse.call(r,r.previous)||tF(r.events)?i(a):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(wet,e.attempt(pse,e.attempt(mse,s),i),i)(a))}function s(a){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(a)}}function Met(e,t,i){const r=this;let n="",s=!1;return a;function a(h){return(h===72||h===104)&&bse.call(r,r.previous)&&!tF(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),n+=String.fromCodePoint(h),e.consume(h),o):i(h)}function o(h){if(Vo(h)&&n.length<5)return n+=String.fromCodePoint(h),e.consume(h),o;if(h===58){const d=n.toLowerCase();if(d==="http"||d==="https")return e.consume(h),l}return i(h)}function l(h){return h===47?(e.consume(h),s?u:(s=!0,l)):i(h)}function u(h){return h===null||OA(h)||fn(h)||ev(h)||XM(h)?i(h):e.attempt(pse,e.attempt(mse,c),i)(h)}function c(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function Pet(e,t,i){let r=0;return n;function n(a){return(a===87||a===119)&&r<3?(r++,e.consume(a),n):a===46&&r===3?(e.consume(a),s):i(a)}function s(a){return a===null?i(a):t(a)}}function Det(e,t,i){let r,n,s;return a;function a(u){return u===46||u===95?e.check(gse,l,o)(u):u===null||fn(u)||ev(u)||u!==45&&XM(u)?l(u):(s=!0,e.consume(u),a)}function o(u){return u===95?r=!0:(n=r,r=void 0),e.consume(u),a}function l(u){return n||r||!s?i(u):t(u)}}function Iet(e,t){let i=0,r=0;return n;function n(a){return a===40?(i++,e.consume(a),n):a===41&&r<i?s(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?e.check(gse,t,s)(a):a===null||fn(a)||ev(a)?t(a):(e.consume(a),n)}function s(a){return a===41&&r++,e.consume(a),n}}function Oet(e,t,i){return r;function r(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),r):o===38?(e.consume(o),s):o===93?(e.consume(o),n):o===60||o===null||fn(o)||ev(o)?t(o):i(o)}function n(o){return o===null||o===40||o===91||fn(o)||ev(o)?t(o):r(o)}function s(o){return Vo(o)?a(o):i(o)}function a(o){return o===59?(e.consume(o),r):Vo(o)?(e.consume(o),a):i(o)}}function Ret(e,t,i){return r;function r(s){return e.consume(s),n}function n(s){return mo(s)?i(s):t(s)}}function xse(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||fn(e)}function bse(e){return!Vo(e)}function _se(e){return!(e===47||VN(e))}function VN(e){return e===43||e===45||e===46||e===95||mo(e)}function tF(e){let t=e.length,i=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){i=!0;break}if(r._gfmAutolinkLiteralWalkedInto){i=!1;break}}return e.length>0&&!i&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),i}const Let={tokenize:Vet,partial:!0};function Net(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:Fet,continuation:{tokenize:Uet},exit:jet}},text:{91:{name:"gfmFootnoteCall",tokenize:zet},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:ket,resolveTo:Bet}}}}function ket(e,t,i){const r=this;let n=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a;for(;n--;){const l=r.events[n][1];if(l.type==="labelImage"){a=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return o;function o(l){if(!a||!a._balanced)return i(l);const u=Ec(r.sliceSerialize({start:a.end,end:r.now()}));return u.codePointAt(0)!==94||!s.includes(u.slice(1))?i(l):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(l),e.exit("gfmFootnoteCallLabelMarker"),t(l))}}function Bet(e,t){let i=e.length;for(;i--;)if(e[i][1].type==="labelImage"&&e[i][0]==="enter"){e[i][1];break}e[i+1][1].type="data",e[i+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[i+3][1].start),end:Object.assign({},e[e.length-1][1].end)},n={type:"gfmFootnoteCallMarker",start:Object.assign({},e[i+3][1].end),end:Object.assign({},e[i+3][1].end)};n.end.column++,n.end.offset++,n.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},n.end),end:Object.assign({},e[e.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},o=[e[i+1],e[i+2],["enter",r,t],e[i+3],e[i+4],["enter",n,t],["exit",n,t],["enter",s,t],["enter",a,t],["exit",a,t],["exit",s,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(i,e.length-i+1,...o),e}function zet(e,t,i){const r=this,n=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,a;return o;function o(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),l}function l(h){return h!==94?i(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(h){if(s>999||h===93&&!a||h===null||h===91||fn(h))return i(h);if(h===93){e.exit("chunkString");const d=e.exit("gfmFootnoteCallString");return n.includes(Ec(r.sliceSerialize(d)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):i(h)}return fn(h)||(a=!0),s++,e.consume(h),h===92?c:u}function c(h){return h===91||h===92||h===93?(e.consume(h),s++,u):u(h)}}function Fet(e,t,i){const r=this,n=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,a=0,o;return l;function l(m){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(m),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(m){return m===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(m),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",c):i(m)}function c(m){if(a>999||m===93&&!o||m===null||m===91||fn(m))return i(m);if(m===93){e.exit("chunkString");const g=e.exit("gfmFootnoteDefinitionLabelString");return s=Ec(r.sliceSerialize(g)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(m),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),d}return fn(m)||(o=!0),a++,e.consume(m),m===92?h:c}function h(m){return m===91||m===92||m===93?(e.consume(m),a++,c):c(m)}function d(m){return m===58?(e.enter("definitionMarker"),e.consume(m),e.exit("definitionMarker"),n.includes(s)||n.push(s),Rr(e,f,"gfmFootnoteDefinitionWhitespace")):i(m)}function f(m){return t(m)}}function Uet(e,t,i){return e.check(mw,t,e.attempt(Let,t,i))}function jet(e){e.exit("gfmFootnoteDefinition")}function Vet(e,t,i){const r=this;return Rr(e,n,"gfmFootnoteDefinitionIndent",5);function n(s){const a=r.events[r.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?t(s):i(s)}}function Het(e){let i=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:n};return i==null&&(i=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function n(a,o){let l=-1;for(;++l<a.length;)if(a[l][0]==="enter"&&a[l][1].type==="strikethroughSequenceTemporary"&&a[l][1]._close){let u=l;for(;u--;)if(a[u][0]==="exit"&&a[u][1].type==="strikethroughSequenceTemporary"&&a[u][1]._open&&a[l][1].end.offset-a[l][1].start.offset===a[u][1].end.offset-a[u][1].start.offset){a[l][1].type="strikethroughSequence",a[u][1].type="strikethroughSequence";const c={type:"strikethrough",start:Object.assign({},a[u][1].start),end:Object.assign({},a[l][1].end)},h={type:"strikethroughText",start:Object.assign({},a[u][1].end),end:Object.assign({},a[l][1].start)},d=[["enter",c,o],["enter",a[u][1],o],["exit",a[u][1],o],["enter",h,o]],f=o.parser.constructs.insideSpan.null;f&&tu(d,d.length,0,KM(f,a.slice(u+1,l),o)),tu(d,d.length,0,[["exit",h,o],["enter",a[l][1],o],["exit",a[l][1],o],["exit",c,o]]),tu(a,u-1,l-u+3,d),l=u+d.length-2;break}}for(l=-1;++l<a.length;)a[l][1].type==="strikethroughSequenceTemporary"&&(a[l][1].type="data");return a}function s(a,o,l){const u=this.previous,c=this.events;let h=0;return d;function d(m){return u===126&&c[c.length-1][1].type!=="characterEscape"?l(m):(a.enter("strikethroughSequenceTemporary"),f(m))}function f(m){const g=Gy(u);if(m===126)return h>1?l(m):(a.consume(m),h++,f);if(h<2&&!i)return l(m);const y=a.exit("strikethroughSequenceTemporary"),x=Gy(m);return y._open=!x||x===2&&!!g,y._close=!g||g===2&&!!x,o(m)}}}class Wet{constructor(){this.map=[]}add(t,i,r){Get(this,t,i,r)}consume(t){if(this.map.sort(function(s,a){return s[0]-a[0]}),this.map.length===0)return;let i=this.map.length;const r=[];for(;i>0;)i-=1,r.push(t.slice(this.map[i][0]+this.map[i][1]),this.map[i][2]),t.length=this.map[i][0];r.push(t.slice()),t.length=0;let n=r.pop();for(;n;){for(const s of n)t.push(s);n=r.pop()}this.map.length=0}}function Get(e,t,i,r){let n=0;if(!(i===0&&r.length===0)){for(;n<e.map.length;){if(e.map[n][0]===t){e.map[n][1]+=i,e.map[n][2].push(...r);return}n+=1}e.map.push([t,i,r])}}function qet(e,t){let i=!1;const r=[];for(;t<e.length;){const n=e[t];if(i){if(n[0]==="enter")n[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(n[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(n[1].type==="tableDelimiterRow")break}else n[0]==="enter"&&n[1].type==="tableDelimiterRow"&&(i=!0);t+=1}return r}function Yet(){return{flow:{null:{name:"table",tokenize:Xet,resolveAll:Ket}}}}function Xet(e,t,i){const r=this;let n=0,s=0,a;return o;function o(D){let k=r.events.length-1;for(;k>-1;){const W=r.events[k][1].type;if(W==="lineEnding"||W==="linePrefix")k--;else break}const B=k>-1?r.events[k][1].type:null,z=B==="tableHead"||B==="tableRow"?E:l;return z===E&&r.parser.lazy[r.now().line]?i(D):z(D)}function l(D){return e.enter("tableHead"),e.enter("tableRow"),u(D)}function u(D){return D===124||(a=!0,s+=1),c(D)}function c(D){return D===null?i(D):Ti(D)?s>1?(s=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),f):i(D):Er(D)?Rr(e,c,"whitespace")(D):(s+=1,a&&(a=!1,n+=1),D===124?(e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),a=!0,c):(e.enter("data"),h(D)))}function h(D){return D===null||D===124||fn(D)?(e.exit("data"),c(D)):(e.consume(D),D===92?d:h)}function d(D){return D===92||D===124?(e.consume(D),h):h(D)}function f(D){return r.interrupt=!1,r.parser.lazy[r.now().line]?i(D):(e.enter("tableDelimiterRow"),a=!1,Er(D)?Rr(e,m,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):m(D))}function m(D){return D===45||D===58?y(D):D===124?(a=!0,e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),g):A(D)}function g(D){return Er(D)?Rr(e,y,"whitespace")(D):y(D)}function y(D){return D===58?(s+=1,a=!0,e.enter("tableDelimiterMarker"),e.consume(D),e.exit("tableDelimiterMarker"),x):D===45?(s+=1,x(D)):D===null||Ti(D)?C(D):A(D)}function x(D){return D===45?(e.enter("tableDelimiterFiller"),w(D)):A(D)}function w(D){return D===45?(e.consume(D),w):D===58?(a=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(D),e.exit("tableDelimiterMarker"),b):(e.exit("tableDelimiterFiller"),b(D))}function b(D){return Er(D)?Rr(e,C,"whitespace")(D):C(D)}function C(D){return D===124?m(D):D===null||Ti(D)?!a||n!==s?A(D):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(D)):A(D)}function A(D){return i(D)}function E(D){return e.enter("tableRow"),_(D)}function _(D){return D===124?(e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),_):D===null||Ti(D)?(e.exit("tableRow"),t(D)):Er(D)?Rr(e,_,"whitespace")(D):(e.enter("data"),P(D))}function P(D){return D===null||D===124||fn(D)?(e.exit("data"),_(D)):(e.consume(D),D===92?I:P)}function I(D){return D===92||D===124?(e.consume(D),P):P(D)}}function Ket(e,t){let i=-1,r=!0,n=0,s=[0,0,0,0],a=[0,0,0,0],o=!1,l=0,u,c,h;const d=new Wet;for(;++i<e.length;){const f=e[i],m=f[1];f[0]==="enter"?m.type==="tableHead"?(o=!1,l!==0&&(bq(d,t,l,u,c),c=void 0,l=0),u={type:"table",start:Object.assign({},m.start),end:Object.assign({},m.end)},d.add(i,0,[["enter",u,t]])):m.type==="tableRow"||m.type==="tableDelimiterRow"?(r=!0,h=void 0,s=[0,0,0,0],a=[0,i+1,0,0],o&&(o=!1,c={type:"tableBody",start:Object.assign({},m.start),end:Object.assign({},m.end)},d.add(i,0,[["enter",c,t]])),n=m.type==="tableDelimiterRow"?2:c?3:1):n&&(m.type==="data"||m.type==="tableDelimiterMarker"||m.type==="tableDelimiterFiller")?(r=!1,a[2]===0&&(s[1]!==0&&(a[0]=a[1],h=GS(d,t,s,n,void 0,h),s=[0,0,0,0]),a[2]=i)):m.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(a[0]=a[1],h=GS(d,t,s,n,void 0,h)),s=a,a=[s[1],i,0,0])):m.type==="tableHead"?(o=!0,l=i):m.type==="tableRow"||m.type==="tableDelimiterRow"?(l=i,s[1]!==0?(a[0]=a[1],h=GS(d,t,s,n,i,h)):a[1]!==0&&(h=GS(d,t,a,n,i,h)),n=0):n&&(m.type==="data"||m.type==="tableDelimiterMarker"||m.type==="tableDelimiterFiller")&&(a[3]=i)}for(l!==0&&bq(d,t,l,u,c),d.consume(t.events),i=-1;++i<t.events.length;){const f=t.events[i];f[0]==="enter"&&f[1].type==="table"&&(f[1]._align=qet(t.events,i))}return e}function GS(e,t,i,r,n,s){const a=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",o="tableContent";i[0]!==0&&(s.end=Object.assign({},w0(t.events,i[0])),e.add(i[0],0,[["exit",s,t]]));const l=w0(t.events,i[1]);if(s={type:a,start:Object.assign({},l),end:Object.assign({},l)},e.add(i[1],0,[["enter",s,t]]),i[2]!==0){const u=w0(t.events,i[2]),c=w0(t.events,i[3]),h={type:o,start:Object.assign({},u),end:Object.assign({},c)};if(e.add(i[2],0,[["enter",h,t]]),r!==2){const d=t.events[i[2]],f=t.events[i[3]];if(d[1].end=Object.assign({},f[1].end),d[1].type="chunkText",d[1].contentType="text",i[3]>i[2]+1){const m=i[2]+1,g=i[3]-i[2]-1;e.add(m,g,[])}}e.add(i[3]+1,0,[["exit",h,t]])}return n!==void 0&&(s.end=Object.assign({},w0(t.events,n)),e.add(n,0,[["exit",s,t]]),s=void 0),s}function bq(e,t,i,r,n){const s=[],a=w0(t.events,i);n&&(n.end=Object.assign({},a),s.push(["exit",n,t])),r.end=Object.assign({},a),s.push(["exit",r,t]),e.add(i+1,0,s)}function w0(e,t){const i=e[t],r=i[0]==="enter"?"start":"end";return i[1][r]}const $et={name:"tasklistCheck",tokenize:Qet};function Zet(){return{text:{91:$et}}}function Qet(e,t,i){const r=this;return n;function n(l){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?i(l):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(l),e.exit("taskListCheckMarker"),s)}function s(l){return fn(l)?(e.enter("taskListCheckValueUnchecked"),e.consume(l),e.exit("taskListCheckValueUnchecked"),a):l===88||l===120?(e.enter("taskListCheckValueChecked"),e.consume(l),e.exit("taskListCheckValueChecked"),a):i(l)}function a(l){return l===93?(e.enter("taskListCheckMarker"),e.consume(l),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):i(l)}function o(l){return Ti(l)?t(l):Er(l)?e.check({tokenize:Jet},t,i)(l):i(l)}}function Jet(e,t,i){return Rr(e,r,"whitespace");function r(n){return n===null?i(n):t(n)}}function ett(e){return Ine([Tet(),Net(),Het(e),Yet(),Zet()])}const ttt={};function itt(e){const t=this,i=e||ttt,r=t.data(),n=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),a=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);n.push(ett(i)),s.push(bet()),a.push(_et(i))}const _q=function(e,t,i){const r=gw(i);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof t=="number"){if(t<0||t===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(t=e.children.indexOf(t),t<0)throw new Error("Expected child node or index");for(;++t<e.children.length;)if(r(e.children[t],t,e))return e.children[t]},mv=function(e){if(e==null)return stt;if(typeof e=="string")return ntt(e);if(typeof e=="object")return rtt(e);if(typeof e=="function")return iF(e);throw new Error("Expected function, string, or array as `test`")};function rtt(e){const t=[];let i=-1;for(;++i<e.length;)t[i]=mv(e[i]);return iF(r);function r(...n){let s=-1;for(;++s<t.length;)if(t[s].apply(this,n))return!0;return!1}}function ntt(e){return iF(t);function t(i){return i.tagName===e}}function iF(e){return t;function t(i,r,n){return!!(att(i)&&e.call(this,i,typeof r=="number"?r:void 0,n||void 0))}}function stt(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="element"&&"tagName"in e&&typeof e.tagName=="string")}function att(e){return e!==null&&typeof e=="object"&&"type"in e&&"tagName"in e}const wq=/\n/g,Eq=/[\t ]+/g,HN=mv("br"),Sq=mv(ptt),ott=mv("p"),Tq=mv("tr"),ltt=mv(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",ftt,mtt]),wse=mv(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function utt(e,t){const i=t||{},r="children"in e?e.children:[],n=wse(e),s=Tse(e,{whitespace:i.whitespace||"normal"}),a=[];(e.type==="text"||e.type==="comment")&&a.push(...Sse(e,{breakBefore:!0,breakAfter:!0}));let o=-1;for(;++o<r.length;)a.push(...Ese(r[o],e,{whitespace:s,breakBefore:o?void 0:n,breakAfter:o<r.length-1?HN(r[o+1]):n}));const l=[];let u;for(o=-1;++o<a.length;){const c=a[o];typeof c=="number"?u!==void 0&&c>u&&(u=c):c&&(u!==void 0&&u>-1&&l.push(`
`.repeat(u)||" "),u=-1,l.push(c))}return l.join("")}function Ese(e,t,i){return e.type==="element"?ctt(e,t,i):e.type==="text"?i.whitespace==="normal"?Sse(e,i):htt(e):[]}function ctt(e,t,i){const r=Tse(e,i),n=e.children||[];let s=-1,a=[];if(ltt(e))return a;let o,l;for(HN(e)||Tq(e)&&_q(t,e,Tq)?l=`
`:ott(e)?(o=2,l=2):wse(e)&&(o=1,l=1);++s<n.length;)a=a.concat(Ese(n[s],e,{whitespace:r,breakBefore:s?void 0:o,breakAfter:s<n.length-1?HN(n[s+1]):l}));return Sq(e)&&_q(t,e,Sq)&&a.push("	"),o&&a.unshift(o),l&&a.push(l),a}function Sse(e,t){const i=String(e.value),r=[],n=[];let s=0;for(;s<=i.length;){wq.lastIndex=s;const l=wq.exec(i),u=l&&"index"in l?l.index:i.length;r.push(dtt(i.slice(s,u).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),s===0?t.breakBefore:!0,u===i.length?t.breakAfter:!0)),s=u+1}let a=-1,o;for(;++a<r.length;)r[a].charCodeAt(r[a].length-1)===8203||a<r.length-1&&r[a+1].charCodeAt(0)===8203?(n.push(r[a]),o=void 0):r[a]?(typeof o=="number"&&n.push(o),n.push(r[a]),o=0):(a===0||a===r.length-1)&&n.push(0);return n}function htt(e){return[String(e.value)]}function dtt(e,t,i){const r=[];let n=0,s;for(;n<e.length;){Eq.lastIndex=n;const a=Eq.exec(e);s=a?a.index:e.length,!n&&!s&&a&&!t&&r.push(""),n!==s&&r.push(e.slice(n,s)),n=a?s+a[0].length:s}return n!==s&&!i&&r.push(""),r.join(" ")}function Tse(e,t){if(e.type==="element"){const i=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return i.wrap?"pre-wrap":"pre";case"td":case"th":return i.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}}return t.whitespace}function ftt(e){return!!(e.properties||{}).hidden}function ptt(e){return e.tagName==="td"||e.tagName==="th"}function mtt(e){return e.tagName==="dialog"&&!(e.properties||{}).open}function gtt(e){const t=e.regex,i=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),r="decltype\\(auto\\)",n="[a-zA-Z_]\\w*::",a="(?!struct)("+r+"|"+t.optional(n)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",o={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},c={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},h={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},i,e.C_BLOCK_COMMENT_MODE]},d={className:"title",begin:t.optional(n)+e.IDENT_RE,relevance:0},f=t.optional(n)+e.IDENT_RE+"\\s*\\(",m=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],g=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],y=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],x=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],C={type:g,keyword:m,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:y},A={className:"function.dispatch",relevance:0,keywords:{_hint:x},begin:t.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,e.IDENT_RE,t.lookahead(/(<[^<>]+>|)\s*\(/))},E=[A,h,o,i,e.C_BLOCK_COMMENT_MODE,c,u],_={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:C,contains:E.concat([{begin:/\(/,end:/\)/,keywords:C,contains:E.concat(["self"]),relevance:0}]),relevance:0},P={className:"function",begin:"("+a+"[\\*&\\s]+)+"+f,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:C,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:r,keywords:C,relevance:0},{begin:f,returnBegin:!0,contains:[d],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[u,c]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:C,relevance:0,contains:[i,e.C_BLOCK_COMMENT_MODE,u,c,o,{begin:/\(/,end:/\)/,keywords:C,relevance:0,contains:["self",i,e.C_BLOCK_COMMENT_MODE,u,c,o]}]},o,i,e.C_BLOCK_COMMENT_MODE,h]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:C,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(_,P,A,E,[h,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:C,contains:["self",o]},{begin:e.IDENT_RE+"::",keywords:C},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function vtt(e){const t={type:["boolean","byte","word","String"],built_in:["KeyboardController","MouseController","SoftwareSerial","EthernetServer","EthernetClient","LiquidCrystal","RobotControl","GSMVoiceCall","EthernetUDP","EsploraTFT","HttpClient","RobotMotor","WiFiClient","GSMScanner","FileSystem","Scheduler","GSMServer","YunClient","YunServer","IPAddress","GSMClient","GSMModem","Keyboard","Ethernet","Console","GSMBand","Esplora","Stepper","Process","WiFiUDP","GSM_SMS","Mailbox","USBHost","Firmata","PImage","Client","Server","GSMPIN","FileIO","Bridge","Serial","EEPROM","Stream","Mouse","Audio","Servo","File","Task","GPRS","WiFi","Wire","TFT","GSM","SPI","SD"],_hints:["setup","loop","runShellCommandAsynchronously","analogWriteResolution","retrieveCallingNumber","printFirmwareVersion","analogReadResolution","sendDigitalPortPair","noListenOnLocalhost","readJoystickButton","setFirmwareVersion","readJoystickSwitch","scrollDisplayRight","getVoiceCallStatus","scrollDisplayLeft","writeMicroseconds","delayMicroseconds","beginTransmission","getSignalStrength","runAsynchronously","getAsynchronously","listenOnLocalhost","getCurrentCarrier","readAccelerometer","messageAvailable","sendDigitalPorts","lineFollowConfig","countryNameWrite","runShellCommand","readStringUntil","rewindDirectory","readTemperature","setClockDivider","readLightSensor","endTransmission","analogReference","detachInterrupt","countryNameRead","attachInterrupt","encryptionType","readBytesUntil","robotNameWrite","readMicrophone","robotNameRead","cityNameWrite","userNameWrite","readJoystickY","readJoystickX","mouseReleased","openNextFile","scanNetworks","noInterrupts","digitalWrite","beginSpeaker","mousePressed","isActionDone","mouseDragged","displayLogos","noAutoscroll","addParameter","remoteNumber","getModifiers","keyboardRead","userNameRead","waitContinue","processInput","parseCommand","printVersion","readNetworks","writeMessage","blinkVersion","cityNameRead","readMessage","setDataMode","parsePacket","isListening","setBitOrder","beginPacket","isDirectory","motorsWrite","drawCompass","digitalRead","clearScreen","serialEvent","rightToLeft","setTextSize","leftToRight","requestFrom","keyReleased","compassRead","analogWrite","interrupts","WiFiServer","disconnect","playMelody","parseFloat","autoscroll","getPINUsed","setPINUsed","setTimeout","sendAnalog","readSlider","analogRead","beginWrite","createChar","motorsStop","keyPressed","tempoWrite","readButton","subnetMask","debugPrint","macAddress","writeGreen","randomSeed","attachGPRS","readString","sendString","remotePort","releaseAll","mouseMoved","background","getXChange","getYChange","answerCall","getResult","voiceCall","endPacket","constrain","getSocket","writeJSON","getButton","available","connected","findUntil","readBytes","exitValue","readGreen","writeBlue","startLoop","IPAddress","isPressed","sendSysex","pauseMode","gatewayIP","setCursor","getOemKey","tuneWrite","noDisplay","loadImage","switchPIN","onRequest","onReceive","changePIN","playFile","noBuffer","parseInt","overflow","checkPIN","knobRead","beginTFT","bitClear","updateIR","bitWrite","position","writeRGB","highByte","writeRed","setSpeed","readBlue","noStroke","remoteIP","transfer","shutdown","hangCall","beginSMS","endWrite","attached","maintain","noCursor","checkReg","checkPUK","shiftOut","isValid","shiftIn","pulseIn","connect","println","localIP","pinMode","getIMEI","display","noBlink","process","getBand","running","beginSD","drawBMP","lowByte","setBand","release","bitRead","prepare","pointTo","readRed","setMode","noFill","remove","listen","stroke","detach","attach","noTone","exists","buffer","height","bitSet","circle","config","cursor","random","IRread","setDNS","endSMS","getKey","micros","millis","begin","print","write","ready","flush","width","isPIN","blink","clear","press","mkdir","rmdir","close","point","yield","image","BSSID","click","delay","read","text","move","peek","beep","rect","line","open","seek","fill","size","turn","stop","home","find","step","tone","sqrt","RSSI","SSID","end","bit","tan","cos","sin","pow","map","abs","max","min","get","run","put"],literal:["DIGITAL_MESSAGE","FIRMATA_STRING","ANALOG_MESSAGE","REPORT_DIGITAL","REPORT_ANALOG","INPUT_PULLUP","SET_PIN_MODE","INTERNAL2V56","SYSTEM_RESET","LED_BUILTIN","INTERNAL1V1","SYSEX_START","INTERNAL","EXTERNAL","DEFAULT","OUTPUT","INPUT","HIGH","LOW"]},i=gtt(e),r=i.keywords;return r.type=[...r.type,...t.type],r.literal=[...r.literal,...t.literal],r.built_in=[...r.built_in,...t.built_in],r._hints=t._hints,i.name="Arduino",i.aliases=["ino"],i.supersetOf="cpp",i}function ytt(e){const t=e.regex,i={},r={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[i]}]};Object.assign(i,{className:"variable",variants:[{begin:t.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},r]});const n={className:"subst",begin:/\$\(/,end:/\)/,contains:[e.BACKSLASH_ESCAPE]},s=e.inherit(e.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),a={begin:/<<-?\s*(?=\w+)/,starts:{contains:[e.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},o={className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,i,n]};n.contains.push(o);const l={match:/\\"/},u={className:"string",begin:/'/,end:/'/},c={match:/\\'/},h={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},e.NUMBER_MODE,i]},d=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],f=e.SHEBANG({binary:`(${d.join("|")})`,relevance:10}),m={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:!0,contains:[e.inherit(e.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},g=["if","then","else","elif","fi","time","for","while","until","in","do","done","case","esac","coproc","function","select"],y=["true","false"],x={match:/(\/[a-z._-]+)+/},w=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],b=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias"],C=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],A=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:g,literal:y,built_in:[...w,...b,"set","shopt",...C,...A]},contains:[f,e.SHEBANG(),m,h,s,a,x,o,l,u,c,i]}}function xtt(e){const t=e.regex,i=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),r="decltype\\(auto\\)",n="[a-zA-Z_]\\w*::",a="("+r+"|"+t.optional(n)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",o={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},c={className:"number",variants:[{match:/\b(0b[01']+)/},{match:/(-?)\b([\d']+(\.[\d']*)?|\.[\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)/},{match:/(-?)\b(0[xX][a-fA-F0-9]+(?:'[a-fA-F0-9]+)*(?:\.[a-fA-F0-9]*(?:'[a-fA-F0-9]*)*)?(?:[pP][-+]?[0-9]+)?(l|L)?(u|U)?)/},{match:/(-?)\b\d+(?:'\d+)*(?:\.\d*(?:'\d*)*)?(?:[eE][-+]?\d+)?/}],relevance:0},h={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},i,e.C_BLOCK_COMMENT_MODE]},d={className:"title",begin:t.optional(n)+e.IDENT_RE,relevance:0},f=t.optional(n)+e.IDENT_RE+"\\s*\\(",y={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},x=[h,o,i,e.C_BLOCK_COMMENT_MODE,c,u],w={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:y,contains:x.concat([{begin:/\(/,end:/\)/,keywords:y,contains:x.concat(["self"]),relevance:0}]),relevance:0},b={begin:"("+a+"[\\*&\\s]+)+"+f,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:y,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:r,keywords:y,relevance:0},{begin:f,returnBegin:!0,contains:[e.inherit(d,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:y,relevance:0,contains:[i,e.C_BLOCK_COMMENT_MODE,u,c,o,{begin:/\(/,end:/\)/,keywords:y,relevance:0,contains:["self",i,e.C_BLOCK_COMMENT_MODE,u,c,o]}]},o,i,e.C_BLOCK_COMMENT_MODE,h]};return{name:"C",aliases:["h"],keywords:y,disableAutodetect:!0,illegal:"</",contains:[].concat(w,b,x,[h,{begin:e.IDENT_RE+"::",keywords:y},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},e.TITLE_MODE]}]),exports:{preprocessor:h,strings:u,keywords:y}}}function btt(e){const t=e.regex,i=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),r="decltype\\(auto\\)",n="[a-zA-Z_]\\w*::",a="(?!struct)("+r+"|"+t.optional(n)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",o={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},c={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},h={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},i,e.C_BLOCK_COMMENT_MODE]},d={className:"title",begin:t.optional(n)+e.IDENT_RE,relevance:0},f=t.optional(n)+e.IDENT_RE+"\\s*\\(",m=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],g=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],y=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],x=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],C={type:g,keyword:m,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:y},A={className:"function.dispatch",relevance:0,keywords:{_hint:x},begin:t.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,e.IDENT_RE,t.lookahead(/(<[^<>]+>|)\s*\(/))},E=[A,h,o,i,e.C_BLOCK_COMMENT_MODE,c,u],_={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:C,contains:E.concat([{begin:/\(/,end:/\)/,keywords:C,contains:E.concat(["self"]),relevance:0}]),relevance:0},P={className:"function",begin:"("+a+"[\\*&\\s]+)+"+f,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:C,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:r,keywords:C,relevance:0},{begin:f,returnBegin:!0,contains:[d],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[u,c]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:C,relevance:0,contains:[i,e.C_BLOCK_COMMENT_MODE,u,c,o,{begin:/\(/,end:/\)/,keywords:C,relevance:0,contains:["self",i,e.C_BLOCK_COMMENT_MODE,u,c,o]}]},o,i,e.C_BLOCK_COMMENT_MODE,h]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:C,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(_,P,A,E,[h,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:C,contains:["self",o]},{begin:e.IDENT_RE+"::",keywords:C},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function _tt(e){const t=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],i=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],r=["default","false","null","true"],n=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],s=["add","alias","and","ascending","args","async","await","by","descending","dynamic","equals","file","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","record","remove","required","scoped","select","set","unmanaged","value|0","var","when","where","with","yield"],a={keyword:n.concat(s),built_in:t,literal:r},o=e.inherit(e.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),l={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},u={className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},c={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},h=e.inherit(c,{illegal:/\n/}),d={className:"subst",begin:/\{/,end:/\}/,keywords:a},f=e.inherit(d,{illegal:/\n/}),m={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},e.BACKSLASH_ESCAPE,f]},g={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},d]},y=e.inherit(g,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},f]});d.contains=[g,m,c,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,l,e.C_BLOCK_COMMENT_MODE],f.contains=[y,m,h,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,l,e.inherit(e.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const x={variants:[u,g,m,c,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},w={begin:"<",end:">",contains:[{beginKeywords:"in out"},o]},b=e.IDENT_RE+"(<"+e.IDENT_RE+"(\\s*,\\s*"+e.IDENT_RE+")*>)?(\\[\\])?",C={begin:"@"+e.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:a,illegal:/::/,contains:[e.COMMENT("///","$",{returnBegin:!0,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},x,l,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},o,w,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[o,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[o,w,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:!0,end:"\\]",excludeEnd:!0,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+b+"\\s+)+"+e.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,end:/\s*[{;=]/,excludeEnd:!0,keywords:a,contains:[{beginKeywords:i.join(" "),relevance:0},{begin:e.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,contains:[e.TITLE_MODE,w],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:a,relevance:0,contains:[x,l,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},C]}}const wtt=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),Ett=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],Stt=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],Ttt=[...Ett,...Stt],Ctt=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),Att=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),Mtt=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),Ptt=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function Dtt(e){const t=e.regex,i=wtt(e),r={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},n="and or not only",s=/@-?\w[\w]*(-\w+)*/,a="[a-zA-Z-][a-zA-Z0-9_-]*",o=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:!0,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[i.BLOCK_COMMENT,r,i.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+a,relevance:0},i.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+Att.join("|")+")"},{begin:":(:)?("+Mtt.join("|")+")"}]},i.CSS_VARIABLE,{className:"attribute",begin:"\\b("+Ptt.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[i.BLOCK_COMMENT,i.HEXCOLOR,i.IMPORTANT,i.CSS_NUMBER_MODE,...o,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...o,{className:"string",begin:/[^)]/,endsWithParent:!0,excludeEnd:!0}]},i.FUNCTION_DISPATCH]},{begin:t.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:s},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:n,attribute:Ctt.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...o,i.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+Ttt.join("|")+")\\b"}]}}function Itt(e){const t=e.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:t.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:t.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}function Ott(e){const s={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:s,illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[e.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:s,illegal:/["']/}]}]}}function Rtt(e){const t=e.regex,i=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:!0,disableAutodetect:!1,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[e.HASH_COMMENT_MODE,e.QUOTE_STRING_MODE,e.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:!0,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:!0},{scope:"symbol",begin:t.concat(i,t.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}function Ltt(e){const t=e.regex,i={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:e.NUMBER_RE}]},r=e.COMMENT();r.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const n={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},s={className:"literal",begin:/\bon|off|true|false|yes|no\b/},a={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},o={begin:/\[/,end:/\]/,contains:[r,s,n,a,i,"self"],relevance:0},l=/[A-Za-z0-9_-]+/,u=/"(\\"|[^"])*"/,c=/'[^']*'/,h=t.either(l,u,c),d=t.concat(h,"(\\s*\\.\\s*",h,")*",t.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:!0,illegal:/\S/,contains:[r,{className:"section",begin:/\[+/,end:/\]+/},{begin:d,className:"attr",starts:{end:/$/,contains:[r,o,s,n,a,i]}}]}}var E0="[0-9](_*[0-9])*",qS=`\\.(${E0})`,YS="[0-9a-fA-F](_*[0-9a-fA-F])*",Cq={className:"number",variants:[{begin:`(\\b(${E0})((${qS})|\\.)?|(${qS}))[eE][+-]?(${E0})[fFdD]?\\b`},{begin:`\\b(${E0})((${qS})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${qS})[fFdD]?\\b`},{begin:`\\b(${E0})[fFdD]\\b`},{begin:`\\b0[xX]((${YS})\\.?|(${YS})?\\.(${YS}))[pP][+-]?(${E0})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${YS})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function Cse(e,t,i){return i===-1?"":e.replace(t,r=>Cse(e,t,i-1))}function Ntt(e){const t=e.regex,i="[À-ʸa-zA-Z_$][À-ʸa-zA-Z_$0-9]*",r=i+Cse("(?:<"+i+"~~~(?:\\s*,\\s*"+i+"~~~)*>)?",/~~~/g,2),l={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto","when"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},u={className:"meta",begin:"@"+i,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},c={className:"params",begin:/\(/,end:/\)/,keywords:l,relevance:0,contains:[e.C_BLOCK_COMMENT_MODE],endsParent:!0};return{name:"Java",aliases:["jsp"],keywords:l,illegal:/<\/|#/,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[e.BACKSLASH_ESCAPE]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,i],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[t.concat(/(?!else)/,i),/\s+/,i,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,i],className:{1:"keyword",3:"title.class"},contains:[c,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+r+"\\s+)",e.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:l,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:l,relevance:0,contains:[u,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,Cq,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},Cq,u]}}const Aq="[A-Za-z$_][0-9A-Za-z$_]*",ktt=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],Btt=["true","false","null","undefined","NaN","Infinity"],Ase=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],Mse=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],Pse=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],ztt=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],Ftt=[].concat(Pse,Ase,Mse);function Utt(e){const t=e.regex,i=(V,{after:J})=>{const U="</"+V[0].slice(1);return V.input.indexOf(U,J)!==-1},r=Aq,n={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,a={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(V,J)=>{const U=V[0].length+V.index,ie=V.input[U];if(ie==="<"||ie===","){J.ignoreMatch();return}ie===">"&&(i(V,{after:U})||J.ignoreMatch());let se;const ee=V.input.substring(U);if(se=ee.match(/^\s*=/)){J.ignoreMatch();return}if((se=ee.match(/^\s+extends\s+/))&&se.index===0){J.ignoreMatch();return}}},o={$pattern:Aq,keyword:ktt,literal:Btt,built_in:Ftt,"variable.language":ztt},l="[0-9](_?[0-9])*",u=`\\.(${l})`,c="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",h={className:"number",variants:[{begin:`(\\b(${c})((${u})|\\.)?|(${u}))[eE][+-]?(${l})\\b`},{begin:`\\b(${c})\\b((${u})\\b|\\.)?|(${u})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},d={className:"subst",begin:"\\$\\{",end:"\\}",keywords:o,contains:[]},f={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,d],subLanguage:"xml"}},m={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,d],subLanguage:"css"}},g={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,d],subLanguage:"graphql"}},y={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,d]},w={className:"comment",variants:[e.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:r+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]},b=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,f,m,g,y,{match:/\$\d+/},h];d.contains=b.concat({begin:/\{/,end:/\}/,keywords:o,contains:["self"].concat(b)});const C=[].concat(w,d.contains),A=C.concat([{begin:/(\s*)\(/,end:/\)/,keywords:o,contains:["self"].concat(C)}]),E={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:A},_={variants:[{match:[/class/,/\s+/,r,/\s+/,/extends/,/\s+/,t.concat(r,"(",t.concat(/\./,r),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,r],scope:{1:"keyword",3:"title.class"}}]},P={relevance:0,match:t.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...Ase,...Mse]}},I={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},D={variants:[{match:[/function/,/\s+/,r,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[E],illegal:/%/},k={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function B(V){return t.concat("(?!",V.join("|"),")")}const z={match:t.concat(/\b/,B([...Pse,"super","import"].map(V=>`${V}\\s*\\(`)),r,t.lookahead(/\s*\(/)),className:"title.function",relevance:0},W={begin:t.concat(/\./,t.lookahead(t.concat(r,/(?![0-9A-Za-z$_(])/))),end:r,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},$={match:[/get|set/,/\s+/,r,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},E]},Z="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+e.UNDERSCORE_IDENT_RE+")\\s*=>",G={match:[/const|var|let/,/\s+/,r,/\s*/,/=\s*/,/(async\s*)?/,t.lookahead(Z)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[E]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:o,exports:{PARAMS_CONTAINS:A,CLASS_REFERENCE:P},illegal:/#(?![$_A-z])/,contains:[e.SHEBANG({label:"shebang",binary:"node",relevance:5}),I,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,f,m,g,y,w,{match:/\$\d+/},h,P,{scope:"attr",match:r+t.lookahead(":"),relevance:0},G,{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[w,e.REGEXP_MODE,{className:"function",begin:Z,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:A}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:n.begin,end:n.end},{match:s},{begin:a.begin,"on:begin":a.isTrulyOpeningTag,end:a.end}],subLanguage:"xml",contains:[{begin:a.begin,end:a.end,skip:!0,contains:["self"]}]}]},D,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+e.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[E,e.inherit(e.TITLE_MODE,{begin:r,className:"title.function"})]},{match:/\.\.\./,relevance:0},W,{match:"\\$"+r,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[E]},z,k,_,$,{match:/\$[(.]/}]}}function jtt(e){const t={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},i={match:/[{}[\],:]/,className:"punctuation",relevance:0},r=["true","false","null"],n={scope:"literal",beginKeywords:r.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:r},contains:[t,i,e.QUOTE_STRING_MODE,n,e.C_NUMBER_MODE,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}var S0="[0-9](_*[0-9])*",XS=`\\.(${S0})`,KS="[0-9a-fA-F](_*[0-9a-fA-F])*",Vtt={className:"number",variants:[{begin:`(\\b(${S0})((${XS})|\\.)?|(${XS}))[eE][+-]?(${S0})[fFdD]?\\b`},{begin:`\\b(${S0})((${XS})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${XS})[fFdD]?\\b`},{begin:`\\b(${S0})[fFdD]\\b`},{begin:`\\b0[xX]((${KS})\\.?|(${KS})?\\.(${KS}))[pP][+-]?(${S0})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${KS})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function Htt(e){const t={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},i={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},r={className:"symbol",begin:e.UNDERSCORE_IDENT_RE+"@"},n={className:"subst",begin:/\$\{/,end:/\}/,contains:[e.C_NUMBER_MODE]},s={className:"variable",begin:"\\$"+e.UNDERSCORE_IDENT_RE},a={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[s,n]},{begin:"'",end:"'",illegal:/\n/,contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,s,n]}]};n.contains.push(a);const o={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+e.UNDERSCORE_IDENT_RE+")?"},l={className:"meta",begin:"@"+e.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[e.inherit(a,{className:"string"}),"self"]}]},u=Vtt,c=e.COMMENT("/\\*","\\*/",{contains:[e.C_BLOCK_COMMENT_MODE]}),h={variants:[{className:"type",begin:e.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},d=h;return d.variants[1].contains=[h],h.variants[1].contains=[d],{name:"Kotlin",aliases:["kt","kts"],keywords:t,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),e.C_LINE_COMMENT_MODE,c,i,r,o,l,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:!0,excludeEnd:!0,keywords:t,relevance:5,contains:[{begin:e.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,relevance:0,contains:[e.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:t,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:!0,contains:[h,e.C_LINE_COMMENT_MODE,c],relevance:0},e.C_LINE_COMMENT_MODE,c,o,l,a,e.C_NUMBER_MODE]},c]},{begin:[/class|interface|trait/,/\s+/,e.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:!0,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},e.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:!0,returnEnd:!0},o,l]},a,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},u]}}const Wtt=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),Gtt=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],qtt=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],Ytt=[...Gtt,...qtt],Xtt=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),Dse=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),Ise=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),Ktt=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse(),$tt=Dse.concat(Ise).sort().reverse();function Ztt(e){const t=Wtt(e),i=$tt,r="and or not only",n="[\\w-]+",s="("+n+"|@\\{"+n+"\\})",a=[],o=[],l=function(b){return{className:"string",begin:"~?"+b+".*?"+b}},u=function(b,C,A){return{className:b,begin:C,relevance:A}},c={$pattern:/[a-z-]+/,keyword:r,attribute:Xtt.join(" ")},h={begin:"\\(",end:"\\)",contains:o,keywords:c,relevance:0};o.push(e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,l("'"),l('"'),t.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:!0}},t.HEXCOLOR,h,u("variable","@@?"+n,10),u("variable","@\\{"+n+"\\}"),u("built_in","~?`[^`]*?`"),{className:"attribute",begin:n+"\\s*:",end:":",returnBegin:!0,excludeEnd:!0},t.IMPORTANT,{beginKeywords:"and not"},t.FUNCTION_DISPATCH);const d=o.concat({begin:/\{/,end:/\}/,contains:a}),f={beginKeywords:"when",endsWithParent:!0,contains:[{beginKeywords:"and not"}].concat(o)},m={begin:s+"\\s*:",returnBegin:!0,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},t.CSS_VARIABLE,{className:"attribute",begin:"\\b("+Ktt.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:!0,illegal:"[<=$]",relevance:0,contains:o}}]},g={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:c,returnEnd:!0,contains:o,relevance:0}},y={className:"variable",variants:[{begin:"@"+n+"\\s*:",relevance:15},{begin:"@"+n}],starts:{end:"[;}]",returnEnd:!0,contains:d}},x={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:s,end:/\{/}],returnBegin:!0,returnEnd:!0,illegal:`[<='$"]`,relevance:0,contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,f,u("keyword","all\\b"),u("variable","@\\{"+n+"\\}"),{begin:"\\b("+Ytt.join("|")+")\\b",className:"selector-tag"},t.CSS_NUMBER_MODE,u("selector-tag",s,0),u("selector-id","#"+s),u("selector-class","\\."+s,0),u("selector-tag","&",0),t.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+Dse.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+Ise.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:d},{begin:"!important"},t.FUNCTION_DISPATCH]},w={begin:n+`:(:)?(${i.join("|")})`,returnBegin:!0,contains:[x]};return a.push(e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,g,y,w,m,x,f,t.FUNCTION_DISPATCH),{name:"Less",case_insensitive:!0,illegal:`[=>'/<($"]`,contains:a}}function Qtt(e){const t="\\[=*\\[",i="\\]=*\\]",r={begin:t,end:i,contains:["self"]},n=[e.COMMENT("--(?!"+t+")","$"),e.COMMENT("--"+t,i,{contains:[r],relevance:10})];return{name:"Lua",aliases:["pluto"],keywords:{$pattern:e.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:n.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[e.inherit(e.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:!0,contains:n}].concat(n)},e.C_NUMBER_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{className:"string",begin:t,end:i,contains:[r],relevance:5}])}}function Jtt(e){const t={className:"variable",variants:[{begin:"\\$\\("+e.UNDERSCORE_IDENT_RE+"\\)",contains:[e.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},i={className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,t]},r={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[t,i]},n={begin:"^"+e.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},s={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},a={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[t]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[e.HASH_COMMENT_MODE,t,i,r,n,s,a]}}function eit(e){const t=e.regex,i={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},r={begin:"^[-\\*]{3,}",end:"$"},n={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},s={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},a={begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]},o=/[A-Za-z][A-Za-z0-9+.-]*/,l={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:t.concat(/\[.+?\]\(/,o,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:!0,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}]},u={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},c={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},h=e.inherit(u,{contains:[]}),d=e.inherit(c,{contains:[]});u.contains.push(d),c.contains.push(h);let f=[i,l];return[u,c,h,d].forEach(x=>{x.contains=x.contains.concat(f)}),f=f.concat(u,c),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:f},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:f}]}]},i,s,u,c,{className:"quote",begin:"^>\\s+",contains:f,end:"$"},n,r,l,a,{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}function tit(e){const t={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},i=/[a-zA-Z@][a-zA-Z0-9_]*/,o={"variable.language":["this","super"],$pattern:i,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},l={$pattern:i,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:o,illegal:"</",contains:[t,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.C_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(e.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+l.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:!0,keywords:l,contains:[e.UNDERSCORE_TITLE_MODE]},{begin:"\\."+e.UNDERSCORE_IDENT_RE,relevance:0}]}}function iit(e){const t=e.regex,i=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","class","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","field","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","method","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],r=/[dualxmsipngr]{0,12}/,n={$pattern:/[\w.]+/,keyword:i.join(" ")},s={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:n},a={begin:/->\{/,end:/\}/},o={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},l={scope:"variable",variants:[{begin:/\$\d/},{begin:t.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[o]},u={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},c=[e.BACKSLASH_ESCAPE,s,l],h=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],d=(g,y,x="\\1")=>{const w=x==="\\1"?x:t.concat(x,y);return t.concat(t.concat("(?:",g,")"),y,/(?:\\.|[^\\\/])*?/,w,/(?:\\.|[^\\\/])*?/,x,r)},f=(g,y,x)=>t.concat(t.concat("(?:",g,")"),y,/(?:\\.|[^\\\/])*?/,x,r),m=[l,e.HASH_COMMENT_MODE,e.COMMENT(/^=\w/,/=cut/,{endsWithParent:!0}),a,{className:"string",contains:c,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},u,{begin:"(\\/\\/|"+e.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[e.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:d("s|tr|y",t.either(...h,{capture:!0}))},{begin:d("s|tr|y","\\(","\\)")},{begin:d("s|tr|y","\\[","\\]")},{begin:d("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:f("(?:m|qr)?",/\//,/\//)},{begin:f("m|qr",t.either(...h,{capture:!0}),/\1/)},{begin:f("m|qr",/\(/,/\)/)},{begin:f("m|qr",/\[/,/\]/)},{begin:f("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE,o]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE,o,u]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return s.contains=m,a.contains=m,{name:"Perl",aliases:["pl","pm"],keywords:n,contains:m}}function rit(e){const t=e.regex,i=/(?![A-Za-z0-9])(?![$])/,r=t.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,i),n=t.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,i),s=t.concat(/[A-Z]+/,i),a={scope:"variable",match:"\\$+"+r},o={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},l={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},u=e.inherit(e.APOS_STRING_MODE,{illegal:null}),c=e.inherit(e.QUOTE_STRING_MODE,{illegal:null,contains:e.QUOTE_STRING_MODE.contains.concat(l)}),h={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:e.QUOTE_STRING_MODE.contains.concat(l),"on:begin":(W,$)=>{$.data._beginMatch=W[1]||W[2]},"on:end":(W,$)=>{$.data._beginMatch!==W[1]&&$.ignoreMatch()}},d=e.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),f=`[ 	
]`,m={scope:"string",variants:[c,u,h,d]},g={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},y=["false","null","true"],x=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],w=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],C={keyword:x,literal:(W=>{const $=[];return W.forEach(Z=>{$.push(Z),Z.toLowerCase()===Z?$.push(Z.toUpperCase()):$.push(Z.toLowerCase())}),$})(y),built_in:w},A=W=>W.map($=>$.replace(/\|\d+$/,"")),E={variants:[{match:[/new/,t.concat(f,"+"),t.concat("(?!",A(w).join("\\b|"),"\\b)"),n],scope:{1:"keyword",4:"title.class"}}]},_=t.concat(r,"\\b(?!\\()"),P={variants:[{match:[t.concat(/::/,t.lookahead(/(?!class\b)/)),_],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[n,t.concat(/::/,t.lookahead(/(?!class\b)/)),_],scope:{1:"title.class",3:"variable.constant"}},{match:[n,t.concat("::",t.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[n,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},I={scope:"attr",match:t.concat(r,t.lookahead(":"),t.lookahead(/(?!::)/))},D={relevance:0,begin:/\(/,end:/\)/,keywords:C,contains:[I,a,P,e.C_BLOCK_COMMENT_MODE,m,g,E]},k={relevance:0,match:[/\b/,t.concat("(?!fn\\b|function\\b|",A(x).join("\\b|"),"|",A(w).join("\\b|"),"\\b)"),r,t.concat(f,"*"),t.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[D]};D.contains.push(k);const B=[I,P,e.C_BLOCK_COMMENT_MODE,m,g,E],z={begin:t.concat(/#\[\s*\\?/,t.either(n,s)),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:y,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:y,keyword:["new","array"]},contains:["self",...B]},...B,{scope:"meta",variants:[{match:n},{match:s}]}]};return{case_insensitive:!1,keywords:C,contains:[z,e.HASH_COMMENT_MODE,e.COMMENT("//","$"),e.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:e.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:!0}]}},o,{scope:"variable.language",match:/\$this\b/},a,k,P,{match:[/const/,/\s/,r],scope:{1:"keyword",3:"variable.constant"}},E,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:!0,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},e.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:!0},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0,keywords:C,contains:["self",z,a,P,e.C_BLOCK_COMMENT_MODE,m,g]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:!0,contains:[{beginKeywords:"extends implements"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[e.inherit(e.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},e.UNDERSCORE_TITLE_MODE]},m,g]}}function nit(e){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},e.inherit(e.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),e.inherit(e.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]}]}}function sit(e){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:!0}}function ait(e){const t=e.regex,i=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),r=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],o={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:r,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},l={className:"meta",begin:/^(>>>|\.\.\.) /},u={className:"subst",begin:/\{/,end:/\}/,keywords:o,illegal:/#/},c={begin:/\{\{/,relevance:0},h={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,l],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,l],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,l,c,u]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,l,c,u]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[e.BACKSLASH_ESCAPE,c,u]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,c,u]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},d="[0-9](_?[0-9])*",f=`(\\b(${d}))?\\.(${d})|\\b(${d})\\.`,m=`\\b|${r.join("|")}`,g={className:"number",relevance:0,variants:[{begin:`(\\b(${d})|(${f}))[eE][+-]?(${d})[jJ]?(?=${m})`},{begin:`(${f})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${m})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${m})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${m})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${m})`},{begin:`\\b(${d})[jJ](?=${m})`}]},y={className:"comment",begin:t.lookahead(/# type:/),end:/$/,keywords:o,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},x={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:["self",l,g,h,e.HASH_COMMENT_MODE]}]};return u.contains=[h,g,l],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:o,illegal:/(<\/|\?)|=>/,contains:[l,g,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},h,y,e.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,i],scope:{1:"keyword",3:"title.function"},contains:[x]},{variants:[{match:[/\bclass/,/\s+/,i,/\s*/,/\(\s*/,i,/\s*\)/]},{match:[/\bclass/,/\s+/,i]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[g,x,h]}]}}function oit(e){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}function lit(e){const t=e.regex,i=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,r=t.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),n=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,s=t.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:i,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[e.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:t.lookahead(t.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:!0}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:i},{match:/`(?:\\.|[^`\\])+`/}],endsParent:!0}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),e.HASH_COMMENT_MODE,{scope:"string",contains:[e.BACKSLASH_ESCAPE],variants:[e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[n,r]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,r]},{scope:{1:"punctuation",2:"number"},match:[s,r]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,r]}]},{scope:{3:"operator"},match:[i,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:n},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:s},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}function uit(e){const t=e.regex,i="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",r=t.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),n=t.concat(r,/(::\w+)*/),a={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},o={className:"doctag",begin:"@[A-Za-z]+"},l={begin:"#<",end:">"},u=[e.COMMENT("#","$",{contains:[o]}),e.COMMENT("^=begin","^=end",{contains:[o],relevance:10}),e.COMMENT("^__END__",e.MATCH_NOTHING_RE)],c={className:"subst",begin:/#\{/,end:/\}/,keywords:a},h={className:"string",contains:[e.BACKSLASH_ESCAPE,c],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:t.concat(/<<[-~]?'?/,t.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[e.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[e.BACKSLASH_ESCAPE,c]})]}]},d="[1-9](_?[0-9])*|0",f="[0-9](_?[0-9])*",m={className:"number",relevance:0,variants:[{begin:`\\b(${d})(\\.(${f}))?([eE][+-]?(${f})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},g={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:!0,endsParent:!0,keywords:a}]},E=[h,{variants:[{match:[/class\s+/,n,/\s+<\s+/,n]},{match:[/\b(class|module)\s+/,n]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:a},{match:[/(include|extend)\s+/,n],scope:{2:"title.class"},keywords:a},{relevance:0,match:[n,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:r,scope:"title.class"},{match:[/def/,/\s+/,i],scope:{1:"keyword",3:"title.function"},contains:[g]},{begin:e.IDENT_RE+"::"},{className:"symbol",begin:e.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[h,{begin:i}],relevance:0},m,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|(?!=)/,end:/\|/,excludeBegin:!0,excludeEnd:!0,relevance:0,keywords:a},{begin:"("+e.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[e.BACKSLASH_ESCAPE,c],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(l,u),relevance:0}].concat(l,u);c.contains=E,g.contains=E;const D=[{begin:/^\s*=>/,starts:{end:"$",contains:E}},{className:"meta.prompt",begin:"^("+"[>?]>"+"|"+"[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]"+"|"+"(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>"+")(?=[ ])",starts:{end:"$",keywords:a,contains:E}}];return u.unshift(l),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:a,illegal:/\/\*/,contains:[e.SHEBANG({binary:"ruby"})].concat(D).concat(u).concat(E)}}function cit(e){const t=e.regex,i=/(r#)?/,r=t.concat(i,e.UNDERSCORE_IDENT_RE),n=t.concat(i,e.IDENT_RE),s={className:"title.function.invoke",relevance:0,begin:t.concat(/\b/,/(?!let|for|while|if|else|match\b)/,n,t.lookahead(/\s*\(/))},a="([ui](8|16|32|64|128|size)|f(32|64))?",o=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],l=["true","false","Some","None","Ok","Err"],u=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],c=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:e.IDENT_RE+"!?",type:c,keyword:o,literal:l,built_in:u},illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.COMMENT("/\\*","\\*/",{contains:["self"]}),e.inherit(e.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*(?!')/},{scope:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'/,end:/'/,contains:[{scope:"char.escape",match:/\\('|\w|x\w{2}|u\w{4}|U\w{8})/}]}]},{className:"number",variants:[{begin:"\\b0b([01_]+)"+a},{begin:"\\b0o([0-7_]+)"+a},{begin:"\\b0x([A-Fa-f0-9_]+)"+a},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+a}],relevance:0},{begin:[/fn/,/\s+/,r],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,r],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,r,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,r],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,r],className:{1:"keyword",3:"title.class"}},{begin:e.IDENT_RE+"::",keywords:{keyword:"Self",built_in:u,type:c}},{className:"punctuation",begin:"->"},s]}}const hit=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),dit=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],fit=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],pit=[...dit,...fit],mit=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),git=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),vit=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),yit=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function xit(e){const t=hit(e),i=vit,r=git,n="@[a-z-]+",s="and or not only",o={className:"variable",begin:"(\\$"+"[a-zA-Z-][a-zA-Z0-9_-]*"+")\\b",relevance:0};return{name:"SCSS",case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,t.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},t.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+pit.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+r.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+i.join("|")+")"},o,{begin:/\(/,end:/\)/,contains:[t.CSS_NUMBER_MODE]},t.CSS_VARIABLE,{className:"attribute",begin:"\\b("+yit.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[t.BLOCK_COMMENT,o,t.HEXCOLOR,t.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t.IMPORTANT,t.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:n,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:!0,keywords:{$pattern:/[a-z-]+/,keyword:s,attribute:mit.join(" ")},contains:[{begin:n,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},o,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t.HEXCOLOR,t.CSS_NUMBER_MODE]},t.FUNCTION_DISPATCH]}}function bit(e){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}function _it(e){const t=e.regex,i=e.COMMENT("--","$"),r={scope:"string",variants:[{begin:/'/,end:/'/,contains:[{match:/''/}]}]},n={begin:/"/,end:/"/,contains:[{match:/""/}]},s=["true","false","unknown"],a=["double precision","large object","with timezone","without timezone"],o=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],l=["add","asc","collation","desc","final","first","last","view"],u=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],c=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],h=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],d=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],f=c,m=[...u,...l].filter(A=>!c.includes(A)),g={scope:"variable",match:/@[a-z0-9][a-z0-9_]*/},y={scope:"operator",match:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},x={match:t.concat(/\b/,t.either(...f),/\s*\(/),relevance:0,keywords:{built_in:f}};function w(A){return t.concat(/\b/,t.either(...A.map(E=>E.replace(/\s+/,"\\s+"))),/\b/)}const b={scope:"keyword",match:w(d),relevance:0};function C(A,{exceptions:E,when:_}={}){const P=_;return E=E||[],A.map(I=>I.match(/\|\d+$/)||E.includes(I)?I:P(I)?`${I}|0`:I)}return{name:"SQL",case_insensitive:!0,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:C(m,{when:A=>A.length<3}),literal:s,type:o,built_in:h},contains:[{scope:"type",match:w(a)},b,x,g,r,n,e.C_NUMBER_MODE,e.C_BLOCK_COMMENT_MODE,i,y]}}function Ose(e){return e?typeof e=="string"?e:e.source:null}function Ax(e){return tn("(?=",e,")")}function tn(...e){return e.map(i=>Ose(i)).join("")}function wit(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function No(...e){return"("+(wit(e).capture?"":"?:")+e.map(r=>Ose(r)).join("|")+")"}const rF=e=>tn(/\b/,e,/\w$/.test(e)?/\b/:/\B/),Eit=["Protocol","Type"].map(rF),Mq=["init","self"].map(rF),Sit=["Any","Self"],zO=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],Pq=["false","nil","true"],Tit=["assignment","associativity","higherThan","left","lowerThan","none","right"],Cit=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],Dq=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],Rse=No(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),Lse=No(Rse,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),FO=tn(Rse,Lse,"*"),Nse=No(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),kA=No(Nse,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),sh=tn(Nse,kA,"*"),$S=tn(/[A-Z]/,kA,"*"),Ait=["attached","autoclosure",tn(/convention\(/,No("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",tn(/objc\(/,sh,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],Mit=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function Pit(e){const t={match:/\s+/,relevance:0},i=e.COMMENT("/\\*","\\*/",{contains:["self"]}),r=[e.C_LINE_COMMENT_MODE,i],n={match:[/\./,No(...Eit,...Mq)],className:{2:"keyword"}},s={match:tn(/\./,No(...zO)),relevance:0},a=zO.filter(_t=>typeof _t=="string").concat(["_|0"]),o=zO.filter(_t=>typeof _t!="string").concat(Sit).map(rF),l={variants:[{className:"keyword",match:No(...o,...Mq)}]},u={$pattern:No(/\b\w+/,/#\w+/),keyword:a.concat(Cit),literal:Pq},c=[n,s,l],h={match:tn(/\./,No(...Dq)),relevance:0},d={className:"built_in",match:tn(/\b/,No(...Dq),/(?=\()/)},f=[h,d],m={match:/->/,relevance:0},g={className:"operator",relevance:0,variants:[{match:FO},{match:`\\.(\\.|${Lse})+`}]},y=[m,g],x="([0-9]_*)+",w="([0-9a-fA-F]_*)+",b={className:"number",relevance:0,variants:[{match:`\\b(${x})(\\.(${x}))?([eE][+-]?(${x}))?\\b`},{match:`\\b0x(${w})(\\.(${w}))?([pP][+-]?(${x}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},C=(_t="")=>({className:"subst",variants:[{match:tn(/\\/,_t,/[0\\tnr"']/)},{match:tn(/\\/,_t,/u\{[0-9a-fA-F]{1,8}\}/)}]}),A=(_t="")=>({className:"subst",match:tn(/\\/,_t,/[\t ]*(?:[\r\n]|\r\n)/)}),E=(_t="")=>({className:"subst",label:"interpol",begin:tn(/\\/,_t,/\(/),end:/\)/}),_=(_t="")=>({begin:tn(_t,/"""/),end:tn(/"""/,_t),contains:[C(_t),A(_t),E(_t)]}),P=(_t="")=>({begin:tn(_t,/"/),end:tn(/"/,_t),contains:[C(_t),E(_t)]}),I={className:"string",variants:[_(),_("#"),_("##"),_("###"),P(),P("#"),P("##"),P("###")]},D=[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}],k={begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:D},B=_t=>{const St=tn(_t,/\//),ue=tn(/\//,_t);return{begin:St,end:ue,contains:[...D,{scope:"comment",begin:`#(?!.*${ue})`,end:/$/}]}},z={scope:"regexp",variants:[B("###"),B("##"),B("#"),k]},W={match:tn(/`/,sh,/`/)},$={className:"variable",match:/\$\d+/},Z={className:"variable",match:`\\$${kA}+`},G=[W,$,Z],V={match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:Mit,contains:[...y,b,I]}]}},J={scope:"keyword",match:tn(/@/,No(...Ait),Ax(No(/\(/,/\s+/)))},U={scope:"meta",match:tn(/@/,sh)},ie=[V,J,U],se={match:Ax(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:tn(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,kA,"+")},{className:"type",match:$S,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:tn(/\s+&\s+/,Ax($S)),relevance:0}]},ee={begin:/</,end:/>/,keywords:u,contains:[...r,...c,...ie,m,se]};se.contains.push(ee);const ve={match:tn(sh,/\s*:/),keywords:"_|0",relevance:0},_e={begin:/\(/,end:/\)/,relevance:0,keywords:u,contains:["self",ve,...r,z,...c,...f,...y,b,I,...G,...ie,se]},he={begin:/</,end:/>/,keywords:"repeat each",contains:[...r,se]},De={begin:No(Ax(tn(sh,/\s*:/)),Ax(tn(sh,/\s+/,sh,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:sh}]},we={begin:/\(/,end:/\)/,keywords:u,contains:[De,...r,...c,...y,b,I,...ie,se,_e],endsParent:!0,illegal:/["']/},Le={match:[/(func|macro)/,/\s+/,No(W.match,sh,FO)],className:{1:"keyword",3:"title.function"},contains:[he,we,t],illegal:[/\[/,/%/]},Te={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[he,we,t],illegal:/\[|%/},ke={match:[/operator/,/\s+/,FO],className:{1:"keyword",3:"title"}},Xe={begin:[/precedencegroup/,/\s+/,$S],className:{1:"keyword",3:"title"},contains:[se],keywords:[...Tit,...Pq],end:/}/},et={match:[/class\b/,/\s+/,/func\b/,/\s+/,/\b[A-Za-z_][A-Za-z0-9_]*\b/],scope:{1:"keyword",3:"keyword",5:"title.function"}},Ze={match:[/class\b/,/\s+/,/var\b/],scope:{1:"keyword",3:"keyword"}},st={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,sh,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:u,contains:[he,...c,{begin:/:/,end:/\{/,keywords:u,contains:[{scope:"title.class.inherited",match:$S},...c],relevance:0}]};for(const _t of I.variants){const St=_t.contains.find(Ee=>Ee.label==="interpol");St.keywords=u;const ue=[...c,...f,...y,b,I,...G];St.contains=[...ue,{begin:/\(/,end:/\)/,contains:["self",...ue]}]}return{name:"Swift",keywords:u,contains:[...r,Le,Te,et,Ze,st,ke,Xe,{beginKeywords:"import",end:/$/,contains:[...r],relevance:0},z,...c,...f,...y,b,I,...G,...ie,se,_e]}}const BA="[A-Za-z$_][0-9A-Za-z$_]*",kse=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],Bse=["true","false","null","undefined","NaN","Infinity"],zse=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],Fse=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],Use=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],jse=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],Vse=[].concat(Use,zse,Fse);function Dit(e){const t=e.regex,i=(V,{after:J})=>{const U="</"+V[0].slice(1);return V.input.indexOf(U,J)!==-1},r=BA,n={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,a={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(V,J)=>{const U=V[0].length+V.index,ie=V.input[U];if(ie==="<"||ie===","){J.ignoreMatch();return}ie===">"&&(i(V,{after:U})||J.ignoreMatch());let se;const ee=V.input.substring(U);if(se=ee.match(/^\s*=/)){J.ignoreMatch();return}if((se=ee.match(/^\s+extends\s+/))&&se.index===0){J.ignoreMatch();return}}},o={$pattern:BA,keyword:kse,literal:Bse,built_in:Vse,"variable.language":jse},l="[0-9](_?[0-9])*",u=`\\.(${l})`,c="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",h={className:"number",variants:[{begin:`(\\b(${c})((${u})|\\.)?|(${u}))[eE][+-]?(${l})\\b`},{begin:`\\b(${c})\\b((${u})\\b|\\.)?|(${u})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},d={className:"subst",begin:"\\$\\{",end:"\\}",keywords:o,contains:[]},f={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,d],subLanguage:"xml"}},m={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,d],subLanguage:"css"}},g={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,d],subLanguage:"graphql"}},y={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,d]},w={className:"comment",variants:[e.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:r+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]},b=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,f,m,g,y,{match:/\$\d+/},h];d.contains=b.concat({begin:/\{/,end:/\}/,keywords:o,contains:["self"].concat(b)});const C=[].concat(w,d.contains),A=C.concat([{begin:/(\s*)\(/,end:/\)/,keywords:o,contains:["self"].concat(C)}]),E={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:A},_={variants:[{match:[/class/,/\s+/,r,/\s+/,/extends/,/\s+/,t.concat(r,"(",t.concat(/\./,r),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,r],scope:{1:"keyword",3:"title.class"}}]},P={relevance:0,match:t.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...zse,...Fse]}},I={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},D={variants:[{match:[/function/,/\s+/,r,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[E],illegal:/%/},k={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function B(V){return t.concat("(?!",V.join("|"),")")}const z={match:t.concat(/\b/,B([...Use,"super","import"].map(V=>`${V}\\s*\\(`)),r,t.lookahead(/\s*\(/)),className:"title.function",relevance:0},W={begin:t.concat(/\./,t.lookahead(t.concat(r,/(?![0-9A-Za-z$_(])/))),end:r,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},$={match:[/get|set/,/\s+/,r,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},E]},Z="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+e.UNDERSCORE_IDENT_RE+")\\s*=>",G={match:[/const|var|let/,/\s+/,r,/\s*/,/=\s*/,/(async\s*)?/,t.lookahead(Z)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[E]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:o,exports:{PARAMS_CONTAINS:A,CLASS_REFERENCE:P},illegal:/#(?![$_A-z])/,contains:[e.SHEBANG({label:"shebang",binary:"node",relevance:5}),I,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,f,m,g,y,w,{match:/\$\d+/},h,P,{scope:"attr",match:r+t.lookahead(":"),relevance:0},G,{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[w,e.REGEXP_MODE,{className:"function",begin:Z,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:A}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:n.begin,end:n.end},{match:s},{begin:a.begin,"on:begin":a.isTrulyOpeningTag,end:a.end}],subLanguage:"xml",contains:[{begin:a.begin,end:a.end,skip:!0,contains:["self"]}]}]},D,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+e.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[E,e.inherit(e.TITLE_MODE,{begin:r,className:"title.function"})]},{match:/\.\.\./,relevance:0},W,{match:"\\$"+r,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[E]},z,k,_,$,{match:/\$[(.]/}]}}function Iit(e){const t=e.regex,i=Dit(e),r=BA,n=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],s={begin:[/namespace/,/\s+/,e.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},a={beginKeywords:"interface",end:/\{/,excludeEnd:!0,keywords:{keyword:"interface extends",built_in:n},contains:[i.exports.CLASS_REFERENCE]},o={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},l=["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"],u={$pattern:BA,keyword:kse.concat(l),literal:Bse,built_in:Vse.concat(n),"variable.language":jse},c={className:"meta",begin:"@"+r},h=(g,y,x)=>{const w=g.contains.findIndex(b=>b.label===y);if(w===-1)throw new Error("can not find mode to replace");g.contains.splice(w,1,x)};Object.assign(i.keywords,u),i.exports.PARAMS_CONTAINS.push(c);const d=i.contains.find(g=>g.scope==="attr"),f=Object.assign({},d,{match:t.concat(r,t.lookahead(/\s*\?:/))});i.exports.PARAMS_CONTAINS.push([i.exports.CLASS_REFERENCE,d,f]),i.contains=i.contains.concat([c,s,a,f]),h(i,"shebang",e.SHEBANG()),h(i,"use_strict",o);const m=i.contains.find(g=>g.label==="func.def");return m.relevance=0,Object.assign(i,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),i}function Oit(e){const t=e.regex,i={className:"string",begin:/"(""|[^/n])"C\b/},r={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},n=/\d{1,2}\/\d{1,2}\/\d{4}/,s=/\d{4}-\d{1,2}-\d{1,2}/,a=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,o=/\d{1,2}(:\d{1,2}){1,2}/,l={className:"literal",variants:[{begin:t.concat(/# */,t.either(s,n),/ *#/)},{begin:t.concat(/# */,o,/ *#/)},{begin:t.concat(/# */,a,/ *#/)},{begin:t.concat(/# */,t.either(s,n),/ +/,t.either(a,o),/ *#/)}]},u={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},c={className:"label",begin:/^\w+:/},h=e.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),d=e.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:!0,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[i,r,l,u,c,h,d,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[d]}]}}function Rit(e){e.regex;const t=e.COMMENT(/\(;/,/;\)/);t.contains.push("self");const i=e.COMMENT(/;;/,/$/),r=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],n={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},s={className:"variable",begin:/\$[\w_]+/},a={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},o={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},l={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},u={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:r},contains:[i,t,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},s,a,n,e.QUOTE_STRING_MODE,l,u,o]}}function Lit(e){const t=e.regex,i=t.concat(/[\p{L}_]/u,t.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),r=/[\p{L}0-9._:-]+/u,n={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},s={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},a=e.inherit(s,{begin:/\(/,end:/\)/}),o=e.inherit(e.APOS_STRING_MODE,{className:"string"}),l=e.inherit(e.QUOTE_STRING_MODE,{className:"string"}),u={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:r,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[n]},{begin:/'/,end:/'/,contains:[n]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[s,l,o,a,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[s,a,l,o]}]}]},e.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},n,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[l]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[u],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[u],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:t.concat(/</,t.lookahead(t.concat(i,t.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:i,relevance:0,starts:u}]},{className:"tag",begin:t.concat(/<\//,t.lookahead(t.concat(i,/>/))),contains:[{className:"name",begin:i,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}function Nit(e){const t="true false yes no null",i="[\\w#;/?:@&=+$,.~*'()[\\]]+",r={className:"attr",variants:[{begin:/[\w*@][\w*@ :()\./-]*:(?=[ \t]|$)/},{begin:/"[\w*@][\w*@ :()\./-]*":(?=[ \t]|$)/},{begin:/'[\w*@][\w*@ :()\./-]*':(?=[ \t]|$)/}]},n={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},s={className:"string",relevance:0,begin:/'/,end:/'/,contains:[{match:/''/,scope:"char.escape",relevance:0}]},a={className:"string",relevance:0,variants:[{begin:/"/,end:/"/},{begin:/\S+/}],contains:[e.BACKSLASH_ESCAPE,n]},o=e.inherit(a,{variants:[{begin:/'/,end:/'/,contains:[{begin:/''/,relevance:0}]},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),d={className:"number",begin:"\\b"+"[0-9]{4}(-[0-9][0-9]){0,2}"+"([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?"+"(\\.[0-9]*)?"+"([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?"+"\\b"},f={end:",",endsWithParent:!0,excludeEnd:!0,keywords:t,relevance:0},m={begin:/\{/,end:/\}/,contains:[f],illegal:"\\n",relevance:0},g={begin:"\\[",end:"\\]",contains:[f],illegal:"\\n",relevance:0},y=[r,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!\\w+!"+i},{className:"type",begin:"!<"+i+">"},{className:"type",begin:"!"+i},{className:"type",begin:"!!"+i},{className:"meta",begin:"&"+e.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+e.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},e.HASH_COMMENT_MODE,{beginKeywords:t,keywords:{literal:t}},d,{className:"number",begin:e.C_NUMBER_RE+"\\b",relevance:0},m,g,s,a],x=[...y];return x.pop(),x.push(o),f.contains=x,{name:"YAML",case_insensitive:!0,aliases:["yml"],contains:y}}const kit={arduino:vtt,bash:ytt,c:xtt,cpp:btt,csharp:_tt,css:Dtt,diff:Itt,go:Ott,graphql:Rtt,ini:Ltt,java:Ntt,javascript:Utt,json:jtt,kotlin:Htt,less:Ztt,lua:Qtt,makefile:Jtt,markdown:eit,objectivec:tit,perl:iit,php:rit,"php-template":nit,plaintext:sit,python:ait,"python-repl":oit,r:lit,ruby:uit,rust:cit,scss:xit,shell:bit,sql:_it,swift:Pit,typescript:Iit,vbnet:Oit,wasm:Rit,xml:Lit,yaml:Nit};function Hse(e){return e instanceof Map?e.clear=e.delete=e.set=function(){throw new Error("map is read-only")}:e instanceof Set&&(e.add=e.clear=e.delete=function(){throw new Error("set is read-only")}),Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{const i=e[t],r=typeof i;(r==="object"||r==="function")&&!Object.isFrozen(i)&&Hse(i)}),e}let Iq=class{constructor(t){t.data===void 0&&(t.data={}),this.data=t.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}};function Wse(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function Mp(e,...t){const i=Object.create(null);for(const r in e)i[r]=e[r];return t.forEach(function(r){for(const n in r)i[n]=r[n]}),i}const Bit="</span>",Oq=e=>!!e.scope,zit=(e,{prefix:t})=>{if(e.startsWith("language:"))return e.replace("language:","language-");if(e.includes(".")){const i=e.split(".");return[`${t}${i.shift()}`,...i.map((r,n)=>`${r}${"_".repeat(n+1)}`)].join(" ")}return`${t}${e}`};class Fit{constructor(t,i){this.buffer="",this.classPrefix=i.classPrefix,t.walk(this)}addText(t){this.buffer+=Wse(t)}openNode(t){if(!Oq(t))return;const i=zit(t.scope,{prefix:this.classPrefix});this.span(i)}closeNode(t){Oq(t)&&(this.buffer+=Bit)}value(){return this.buffer}span(t){this.buffer+=`<span class="${t}">`}}const Rq=(e={})=>{const t={children:[]};return Object.assign(t,e),t};class nF{constructor(){this.rootNode=Rq(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(t){this.top.children.push(t)}openNode(t){const i=Rq({scope:t});this.add(i),this.stack.push(i)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(t){return this.constructor._walk(t,this.rootNode)}static _walk(t,i){return typeof i=="string"?t.addText(i):i.children&&(t.openNode(i),i.children.forEach(r=>this._walk(t,r)),t.closeNode(i)),t}static _collapse(t){typeof t!="string"&&t.children&&(t.children.every(i=>typeof i=="string")?t.children=[t.children.join("")]:t.children.forEach(i=>{nF._collapse(i)}))}}class Uit extends nF{constructor(t){super(),this.options=t}addText(t){t!==""&&this.add(t)}startScope(t){this.openNode(t)}endScope(){this.closeNode()}__addSublanguage(t,i){const r=t.root;i&&(r.scope=`language:${i}`),this.add(r)}toHTML(){return new Fit(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function D_(e){return e?typeof e=="string"?e:e.source:null}function Gse(e){return gv("(?=",e,")")}function jit(e){return gv("(?:",e,")*")}function Vit(e){return gv("(?:",e,")?")}function gv(...e){return e.map(i=>D_(i)).join("")}function Hit(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function sF(...e){return"("+(Hit(e).capture?"":"?:")+e.map(r=>D_(r)).join("|")+")"}function qse(e){return new RegExp(e.toString()+"|").exec("").length-1}function Wit(e,t){const i=e&&e.exec(t);return i&&i.index===0}const Git=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function aF(e,{joinWith:t}){let i=0;return e.map(r=>{i+=1;const n=i;let s=D_(r),a="";for(;s.length>0;){const o=Git.exec(s);if(!o){a+=s;break}a+=s.substring(0,o.index),s=s.substring(o.index+o[0].length),o[0][0]==="\\"&&o[1]?a+="\\"+String(Number(o[1])+n):(a+=o[0],o[0]==="("&&i++)}return a}).map(r=>`(${r})`).join(t)}const qit=/\b\B/,Yse="[a-zA-Z]\\w*",oF="[a-zA-Z_]\\w*",Xse="\\b\\d+(\\.\\d+)?",Kse="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",$se="\\b(0b[01]+)",Yit="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",Xit=(e={})=>{const t=/^#![ ]*\//;return e.binary&&(e.begin=gv(t,/.*\b/,e.binary,/\b.*/)),Mp({scope:"meta",begin:t,end:/$/,relevance:0,"on:begin":(i,r)=>{i.index!==0&&r.ignoreMatch()}},e)},I_={begin:"\\\\[\\s\\S]",relevance:0},Kit={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[I_]},$it={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[I_]},Zit={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},JM=function(e,t,i={}){const r=Mp({scope:"comment",begin:e,end:t,contains:[]},i);r.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const n=sF("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return r.contains.push({begin:gv(/[ ]+/,"(",n,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),r},Qit=JM("//","$"),Jit=JM("/\\*","\\*/"),ert=JM("#","$"),trt={scope:"number",begin:Xse,relevance:0},irt={scope:"number",begin:Kse,relevance:0},rrt={scope:"number",begin:$se,relevance:0},nrt={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[I_,{begin:/\[/,end:/\]/,relevance:0,contains:[I_]}]},srt={scope:"title",begin:Yse,relevance:0},art={scope:"title",begin:oF,relevance:0},ort={begin:"\\.\\s*"+oF,relevance:0},lrt=function(e){return Object.assign(e,{"on:begin":(t,i)=>{i.data._beginMatch=t[1]},"on:end":(t,i)=>{i.data._beginMatch!==t[1]&&i.ignoreMatch()}})};var ZS=Object.freeze({__proto__:null,APOS_STRING_MODE:Kit,BACKSLASH_ESCAPE:I_,BINARY_NUMBER_MODE:rrt,BINARY_NUMBER_RE:$se,COMMENT:JM,C_BLOCK_COMMENT_MODE:Jit,C_LINE_COMMENT_MODE:Qit,C_NUMBER_MODE:irt,C_NUMBER_RE:Kse,END_SAME_AS_BEGIN:lrt,HASH_COMMENT_MODE:ert,IDENT_RE:Yse,MATCH_NOTHING_RE:qit,METHOD_GUARD:ort,NUMBER_MODE:trt,NUMBER_RE:Xse,PHRASAL_WORDS_MODE:Zit,QUOTE_STRING_MODE:$it,REGEXP_MODE:nrt,RE_STARTERS_RE:Yit,SHEBANG:Xit,TITLE_MODE:srt,UNDERSCORE_IDENT_RE:oF,UNDERSCORE_TITLE_MODE:art});function urt(e,t){e.input[e.index-1]==="."&&t.ignoreMatch()}function crt(e,t){e.className!==void 0&&(e.scope=e.className,delete e.className)}function hrt(e,t){t&&e.beginKeywords&&(e.begin="\\b("+e.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",e.__beforeBegin=urt,e.keywords=e.keywords||e.beginKeywords,delete e.beginKeywords,e.relevance===void 0&&(e.relevance=0))}function drt(e,t){Array.isArray(e.illegal)&&(e.illegal=sF(...e.illegal))}function frt(e,t){if(e.match){if(e.begin||e.end)throw new Error("begin & end are not supported with match");e.begin=e.match,delete e.match}}function prt(e,t){e.relevance===void 0&&(e.relevance=1)}const mrt=(e,t)=>{if(!e.beforeMatch)return;if(e.starts)throw new Error("beforeMatch cannot be used with starts");const i=Object.assign({},e);Object.keys(e).forEach(r=>{delete e[r]}),e.keywords=i.keywords,e.begin=gv(i.beforeMatch,Gse(i.begin)),e.starts={relevance:0,contains:[Object.assign(i,{endsParent:!0})]},e.relevance=0,delete i.beforeMatch},grt=["of","and","for","in","not","or","if","then","parent","list","value"],vrt="keyword";function Zse(e,t,i=vrt){const r=Object.create(null);return typeof e=="string"?n(i,e.split(" ")):Array.isArray(e)?n(i,e):Object.keys(e).forEach(function(s){Object.assign(r,Zse(e[s],t,s))}),r;function n(s,a){t&&(a=a.map(o=>o.toLowerCase())),a.forEach(function(o){const l=o.split("|");r[l[0]]=[s,yrt(l[0],l[1])]})}}function yrt(e,t){return t?Number(t):xrt(e)?0:1}function xrt(e){return grt.includes(e.toLowerCase())}const Lq={},Bg=e=>{console.error(e)},Nq=(e,...t)=>{console.log(`WARN: ${e}`,...t)},h0=(e,t)=>{Lq[`${e}/${t}`]||(console.log(`Deprecated as of ${e}. ${t}`),Lq[`${e}/${t}`]=!0)},zA=new Error;function Qse(e,t,{key:i}){let r=0;const n=e[i],s={},a={};for(let o=1;o<=t.length;o++)a[o+r]=n[o],s[o+r]=!0,r+=qse(t[o-1]);e[i]=a,e[i]._emit=s,e[i]._multi=!0}function brt(e){if(Array.isArray(e.begin)){if(e.skip||e.excludeBegin||e.returnBegin)throw Bg("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),zA;if(typeof e.beginScope!="object"||e.beginScope===null)throw Bg("beginScope must be object"),zA;Qse(e,e.begin,{key:"beginScope"}),e.begin=aF(e.begin,{joinWith:""})}}function _rt(e){if(Array.isArray(e.end)){if(e.skip||e.excludeEnd||e.returnEnd)throw Bg("skip, excludeEnd, returnEnd not compatible with endScope: {}"),zA;if(typeof e.endScope!="object"||e.endScope===null)throw Bg("endScope must be object"),zA;Qse(e,e.end,{key:"endScope"}),e.end=aF(e.end,{joinWith:""})}}function wrt(e){e.scope&&typeof e.scope=="object"&&e.scope!==null&&(e.beginScope=e.scope,delete e.scope)}function Ert(e){wrt(e),typeof e.beginScope=="string"&&(e.beginScope={_wrap:e.beginScope}),typeof e.endScope=="string"&&(e.endScope={_wrap:e.endScope}),brt(e),_rt(e)}function Srt(e){function t(a,o){return new RegExp(D_(a),"m"+(e.case_insensitive?"i":"")+(e.unicodeRegex?"u":"")+(o?"g":""))}class i{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(o,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,o]),this.matchAt+=qse(o)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const o=this.regexes.map(l=>l[1]);this.matcherRe=t(aF(o,{joinWith:"|"}),!0),this.lastIndex=0}exec(o){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(o);if(!l)return null;const u=l.findIndex((h,d)=>d>0&&h!==void 0),c=this.matchIndexes[u];return l.splice(0,u),Object.assign(l,c)}}class r{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(o){if(this.multiRegexes[o])return this.multiRegexes[o];const l=new i;return this.rules.slice(o).forEach(([u,c])=>l.addRule(u,c)),l.compile(),this.multiRegexes[o]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(o,l){this.rules.push([o,l]),l.type==="begin"&&this.count++}exec(o){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let u=l.exec(o);if(this.resumingScanAtSamePosition()&&!(u&&u.index===this.lastIndex)){const c=this.getMatcher(0);c.lastIndex=this.lastIndex+1,u=c.exec(o)}return u&&(this.regexIndex+=u.position+1,this.regexIndex===this.count&&this.considerAll()),u}}function n(a){const o=new r;return a.contains.forEach(l=>o.addRule(l.begin,{rule:l,type:"begin"})),a.terminatorEnd&&o.addRule(a.terminatorEnd,{type:"end"}),a.illegal&&o.addRule(a.illegal,{type:"illegal"}),o}function s(a,o){const l=a;if(a.isCompiled)return l;[crt,frt,Ert,mrt].forEach(c=>c(a,o)),e.compilerExtensions.forEach(c=>c(a,o)),a.__beforeBegin=null,[hrt,drt,prt].forEach(c=>c(a,o)),a.isCompiled=!0;let u=null;return typeof a.keywords=="object"&&a.keywords.$pattern&&(a.keywords=Object.assign({},a.keywords),u=a.keywords.$pattern,delete a.keywords.$pattern),u=u||/\w+/,a.keywords&&(a.keywords=Zse(a.keywords,e.case_insensitive)),l.keywordPatternRe=t(u,!0),o&&(a.begin||(a.begin=/\B|\b/),l.beginRe=t(l.begin),!a.end&&!a.endsWithParent&&(a.end=/\B|\b/),a.end&&(l.endRe=t(l.end)),l.terminatorEnd=D_(l.end)||"",a.endsWithParent&&o.terminatorEnd&&(l.terminatorEnd+=(a.end?"|":"")+o.terminatorEnd)),a.illegal&&(l.illegalRe=t(a.illegal)),a.contains||(a.contains=[]),a.contains=[].concat(...a.contains.map(function(c){return Trt(c==="self"?a:c)})),a.contains.forEach(function(c){s(c,l)}),a.starts&&s(a.starts,o),l.matcher=n(l),l}if(e.compilerExtensions||(e.compilerExtensions=[]),e.contains&&e.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return e.classNameAliases=Mp(e.classNameAliases||{}),s(e)}function Jse(e){return e?e.endsWithParent||Jse(e.starts):!1}function Trt(e){return e.variants&&!e.cachedVariants&&(e.cachedVariants=e.variants.map(function(t){return Mp(e,{variants:null},t)})),e.cachedVariants?e.cachedVariants:Jse(e)?Mp(e,{starts:e.starts?Mp(e.starts):null}):Object.isFrozen(e)?Mp(e):e}var Crt="11.11.1";class Art extends Error{constructor(t,i){super(t),this.name="HTMLInjectionError",this.html=i}}const UO=Wse,kq=Mp,Bq=Symbol("nomatch"),Mrt=7,eae=function(e){const t=Object.create(null),i=Object.create(null),r=[];let n=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",a={disableAutodetect:!0,name:"Plain text",contains:[]};let o={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:Uit};function l(Z){return o.noHighlightRe.test(Z)}function u(Z){let G=Z.className+" ";G+=Z.parentNode?Z.parentNode.className:"";const V=o.languageDetectRe.exec(G);if(V){const J=P(V[1]);return J||(Nq(s.replace("{}",V[1])),Nq("Falling back to no-highlight mode for this block.",Z)),J?V[1]:"no-highlight"}return G.split(/\s+/).find(J=>l(J)||P(J))}function c(Z,G,V){let J="",U="";typeof G=="object"?(J=Z,V=G.ignoreIllegals,U=G.language):(h0("10.7.0","highlight(lang, code, ...args) has been deprecated."),h0("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),U=Z,J=G),V===void 0&&(V=!0);const ie={code:J,language:U};W("before:highlight",ie);const se=ie.result?ie.result:h(ie.language,ie.code,V);return se.code=ie.code,W("after:highlight",se),se}function h(Z,G,V,J){const U=Object.create(null);function ie(Y,Me){return Y.keywords[Me]}function se(){if(!ue.keywords){Ae.addText(Ge);return}let Y=0;ue.keywordPatternRe.lastIndex=0;let Me=ue.keywordPatternRe.exec(Ge),Ke="";for(;Me;){Ke+=Ge.substring(Y,Me.index);const ot=st.case_insensitive?Me[0].toLowerCase():Me[0],qe=ie(ue,ot);if(qe){const[It,Ot]=qe;if(Ae.addText(Ke),Ke="",U[ot]=(U[ot]||0)+1,U[ot]<=Mrt&&(ae+=Ot),It.startsWith("_"))Ke+=Me[0];else{const Dt=st.classNameAliases[It]||It;_e(Me[0],Dt)}}else Ke+=Me[0];Y=ue.keywordPatternRe.lastIndex,Me=ue.keywordPatternRe.exec(Ge)}Ke+=Ge.substring(Y),Ae.addText(Ke)}function ee(){if(Ge==="")return;let Y=null;if(typeof ue.subLanguage=="string"){if(!t[ue.subLanguage]){Ae.addText(Ge);return}Y=h(ue.subLanguage,Ge,!0,Ee[ue.subLanguage]),Ee[ue.subLanguage]=Y._top}else Y=f(Ge,ue.subLanguage.length?ue.subLanguage:null);ue.relevance>0&&(ae+=Y.relevance),Ae.__addSublanguage(Y._emitter,Y.language)}function ve(){ue.subLanguage!=null?ee():se(),Ge=""}function _e(Y,Me){Y!==""&&(Ae.startScope(Me),Ae.addText(Y),Ae.endScope())}function he(Y,Me){let Ke=1;const ot=Me.length-1;for(;Ke<=ot;){if(!Y._emit[Ke]){Ke++;continue}const qe=st.classNameAliases[Y[Ke]]||Y[Ke],It=Me[Ke];qe?_e(It,qe):(Ge=It,se(),Ge=""),Ke++}}function De(Y,Me){return Y.scope&&typeof Y.scope=="string"&&Ae.openNode(st.classNameAliases[Y.scope]||Y.scope),Y.beginScope&&(Y.beginScope._wrap?(_e(Ge,st.classNameAliases[Y.beginScope._wrap]||Y.beginScope._wrap),Ge=""):Y.beginScope._multi&&(he(Y.beginScope,Me),Ge="")),ue=Object.create(Y,{parent:{value:ue}}),ue}function we(Y,Me,Ke){let ot=Wit(Y.endRe,Ke);if(ot){if(Y["on:end"]){const qe=new Iq(Y);Y["on:end"](Me,qe),qe.isMatchIgnored&&(ot=!1)}if(ot){for(;Y.endsParent&&Y.parent;)Y=Y.parent;return Y}}if(Y.endsWithParent)return we(Y.parent,Me,Ke)}function Le(Y){return ue.matcher.regexIndex===0?(Ge+=Y[0],1):(Re=!0,0)}function Te(Y){const Me=Y[0],Ke=Y.rule,ot=new Iq(Ke),qe=[Ke.__beforeBegin,Ke["on:begin"]];for(const It of qe)if(It&&(It(Y,ot),ot.isMatchIgnored))return Le(Me);return Ke.skip?Ge+=Me:(Ke.excludeBegin&&(Ge+=Me),ve(),!Ke.returnBegin&&!Ke.excludeBegin&&(Ge=Me)),De(Ke,Y),Ke.returnBegin?0:Me.length}function ke(Y){const Me=Y[0],Ke=G.substring(Y.index),ot=we(ue,Y,Ke);if(!ot)return Bq;const qe=ue;ue.endScope&&ue.endScope._wrap?(ve(),_e(Me,ue.endScope._wrap)):ue.endScope&&ue.endScope._multi?(ve(),he(ue.endScope,Y)):qe.skip?Ge+=Me:(qe.returnEnd||qe.excludeEnd||(Ge+=Me),ve(),qe.excludeEnd&&(Ge=Me));do ue.scope&&Ae.closeNode(),!ue.skip&&!ue.subLanguage&&(ae+=ue.relevance),ue=ue.parent;while(ue!==ot.parent);return ot.starts&&De(ot.starts,Y),qe.returnEnd?0:Me.length}function Xe(){const Y=[];for(let Me=ue;Me!==st;Me=Me.parent)Me.scope&&Y.unshift(Me.scope);Y.forEach(Me=>Ae.openNode(Me))}let et={};function Ze(Y,Me){const Ke=Me&&Me[0];if(Ge+=Y,Ke==null)return ve(),0;if(et.type==="begin"&&Me.type==="end"&&et.index===Me.index&&Ke===""){if(Ge+=G.slice(Me.index,Me.index+1),!n){const ot=new Error(`0 width match regex (${Z})`);throw ot.languageName=Z,ot.badRule=et.rule,ot}return 1}if(et=Me,Me.type==="begin")return Te(Me);if(Me.type==="illegal"&&!V){const ot=new Error('Illegal lexeme "'+Ke+'" for mode "'+(ue.scope||"<unnamed>")+'"');throw ot.mode=ue,ot}else if(Me.type==="end"){const ot=ke(Me);if(ot!==Bq)return ot}if(Me.type==="illegal"&&Ke==="")return Ge+=`
`,1;if(Ne>1e5&&Ne>Me.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Ge+=Ke,Ke.length}const st=P(Z);if(!st)throw Bg(s.replace("{}",Z)),new Error('Unknown language: "'+Z+'"');const _t=Srt(st);let St="",ue=J||_t;const Ee={},Ae=new o.__emitter(o);Xe();let Ge="",ae=0,te=0,Ne=0,Re=!1;try{if(st.__emitTokens)st.__emitTokens(G,Ae);else{for(ue.matcher.considerAll();;){Ne++,Re?Re=!1:ue.matcher.considerAll(),ue.matcher.lastIndex=te;const Y=ue.matcher.exec(G);if(!Y)break;const Me=G.substring(te,Y.index),Ke=Ze(Me,Y);te=Y.index+Ke}Ze(G.substring(te))}return Ae.finalize(),St=Ae.toHTML(),{language:Z,value:St,relevance:ae,illegal:!1,_emitter:Ae,_top:ue}}catch(Y){if(Y.message&&Y.message.includes("Illegal"))return{language:Z,value:UO(G),illegal:!0,relevance:0,_illegalBy:{message:Y.message,index:te,context:G.slice(te-100,te+100),mode:Y.mode,resultSoFar:St},_emitter:Ae};if(n)return{language:Z,value:UO(G),illegal:!1,relevance:0,errorRaised:Y,_emitter:Ae,_top:ue};throw Y}}function d(Z){const G={value:UO(Z),illegal:!1,relevance:0,_top:a,_emitter:new o.__emitter(o)};return G._emitter.addText(Z),G}function f(Z,G){G=G||o.languages||Object.keys(t);const V=d(Z),J=G.filter(P).filter(D).map(ve=>h(ve,Z,!1));J.unshift(V);const U=J.sort((ve,_e)=>{if(ve.relevance!==_e.relevance)return _e.relevance-ve.relevance;if(ve.language&&_e.language){if(P(ve.language).supersetOf===_e.language)return 1;if(P(_e.language).supersetOf===ve.language)return-1}return 0}),[ie,se]=U,ee=ie;return ee.secondBest=se,ee}function m(Z,G,V){const J=G&&i[G]||V;Z.classList.add("hljs"),Z.classList.add(`language-${J}`)}function g(Z){let G=null;const V=u(Z);if(l(V))return;if(W("before:highlightElement",{el:Z,language:V}),Z.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",Z);return}if(Z.children.length>0&&(o.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(Z)),o.throwUnescapedHTML))throw new Art("One of your code blocks includes unescaped HTML.",Z.innerHTML);G=Z;const J=G.textContent,U=V?c(J,{language:V,ignoreIllegals:!0}):f(J);Z.innerHTML=U.value,Z.dataset.highlighted="yes",m(Z,V,U.language),Z.result={language:U.language,re:U.relevance,relevance:U.relevance},U.secondBest&&(Z.secondBest={language:U.secondBest.language,relevance:U.secondBest.relevance}),W("after:highlightElement",{el:Z,result:U,text:J})}function y(Z){o=kq(o,Z)}const x=()=>{C(),h0("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function w(){C(),h0("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let b=!1;function C(){function Z(){C()}if(document.readyState==="loading"){b||window.addEventListener("DOMContentLoaded",Z,!1),b=!0;return}document.querySelectorAll(o.cssSelector).forEach(g)}function A(Z,G){let V=null;try{V=G(e)}catch(J){if(Bg("Language definition for '{}' could not be registered.".replace("{}",Z)),n)Bg(J);else throw J;V=a}V.name||(V.name=Z),t[Z]=V,V.rawDefinition=G.bind(null,e),V.aliases&&I(V.aliases,{languageName:Z})}function E(Z){delete t[Z];for(const G of Object.keys(i))i[G]===Z&&delete i[G]}function _(){return Object.keys(t)}function P(Z){return Z=(Z||"").toLowerCase(),t[Z]||t[i[Z]]}function I(Z,{languageName:G}){typeof Z=="string"&&(Z=[Z]),Z.forEach(V=>{i[V.toLowerCase()]=G})}function D(Z){const G=P(Z);return G&&!G.disableAutodetect}function k(Z){Z["before:highlightBlock"]&&!Z["before:highlightElement"]&&(Z["before:highlightElement"]=G=>{Z["before:highlightBlock"](Object.assign({block:G.el},G))}),Z["after:highlightBlock"]&&!Z["after:highlightElement"]&&(Z["after:highlightElement"]=G=>{Z["after:highlightBlock"](Object.assign({block:G.el},G))})}function B(Z){k(Z),r.push(Z)}function z(Z){const G=r.indexOf(Z);G!==-1&&r.splice(G,1)}function W(Z,G){const V=Z;r.forEach(function(J){J[V]&&J[V](G)})}function $(Z){return h0("10.7.0","highlightBlock will be removed entirely in v12.0"),h0("10.7.0","Please use highlightElement now."),g(Z)}Object.assign(e,{highlight:c,highlightAuto:f,highlightAll:C,highlightElement:g,highlightBlock:$,configure:y,initHighlighting:x,initHighlightingOnLoad:w,registerLanguage:A,unregisterLanguage:E,listLanguages:_,getLanguage:P,registerAliases:I,autoDetection:D,inherit:kq,addPlugin:B,removePlugin:z}),e.debugMode=function(){n=!1},e.safeMode=function(){n=!0},e.versionString=Crt,e.regex={concat:gv,lookahead:Gse,either:sF,optional:Vit,anyNumberOfTimes:jit};for(const Z in ZS)typeof ZS[Z]=="object"&&Hse(ZS[Z]);return Object.assign(e,ZS),e},qy=eae({});qy.newInstance=()=>eae({});var Prt=qy;qy.HighlightJS=qy;qy.default=qy;const Drt=O_(Prt),zq={},Irt="hljs-";function Ort(e){const t=Drt.newInstance();return e&&s(e),{highlight:i,highlightAuto:r,listLanguages:n,register:s,registerAlias:a,registered:o};function i(l,u,c){const h=c||zq,d=typeof h.prefix=="string"?h.prefix:Irt;if(!t.getLanguage(l))throw new Error("Unknown language: `"+l+"` is not registered");t.configure({__emitter:Rrt,classPrefix:d});const f=t.highlight(u,{ignoreIllegals:!0,language:l});if(f.errorRaised)throw new Error("Could not highlight with `Highlight.js`",{cause:f.errorRaised});const m=f._emitter.root,g=m.data;return g.language=f.language,g.relevance=f.relevance,m}function r(l,u){const h=(u||zq).subset||n();let d=-1,f=0,m;for(;++d<h.length;){const g=h[d];if(!t.getLanguage(g))continue;const y=i(g,l,u);y.data&&y.data.relevance!==void 0&&y.data.relevance>f&&(f=y.data.relevance,m=y)}return m||{type:"root",children:[],data:{language:void 0,relevance:f}}}function n(){return t.listLanguages()}function s(l,u){if(typeof l=="string")t.registerLanguage(l,u);else{let c;for(c in l)Object.hasOwn(l,c)&&t.registerLanguage(c,l[c])}}function a(l,u){if(typeof l=="string")t.registerAliases(typeof u=="string"?u:[...u],{languageName:l});else{let c;for(c in l)if(Object.hasOwn(l,c)){const h=l[c];t.registerAliases(typeof h=="string"?h:[...h],{languageName:c})}}}function o(l){return!!t.getLanguage(l)}}class Rrt{constructor(t){this.options=t,this.root={type:"root",children:[],data:{language:void 0,relevance:0}},this.stack=[this.root]}addText(t){if(t==="")return;const i=this.stack[this.stack.length-1],r=i.children[i.children.length-1];r&&r.type==="text"?r.value+=t:i.children.push({type:"text",value:t})}startScope(t){this.openNode(String(t))}endScope(){this.closeNode()}__addSublanguage(t,i){const r=this.stack[this.stack.length-1],n=t.root.children;i?r.children.push({type:"element",tagName:"span",properties:{className:[i]},children:n}):r.children.push(...n)}openNode(t){const i=this,r=t.split(".").map(function(a,o){return o?a+"_".repeat(o):i.options.classPrefix+a}),n=this.stack[this.stack.length-1],s={type:"element",tagName:"span",properties:{className:r},children:[]};n.children.push(s),this.stack.push(s)}closeNode(){this.stack.pop()}finalize(){}toHTML(){return""}}const Lrt={};function Nrt(e){const t=e||Lrt,i=t.aliases,r=t.detect||!1,n=t.languages||kit,s=t.plainText,a=t.prefix,o=t.subset;let l="hljs";const u=Ort(n);if(i&&u.registerAlias(i),a){const c=a.indexOf("-");l=c===-1?a:a.slice(0,c)}return function(c,h){QM(c,"element",function(d,f,m){if(d.tagName!=="code"||!m||m.type!=="element"||m.tagName!=="pre")return;const g=krt(d);if(g===!1||!g&&!r||g&&s&&s.includes(g))return;Array.isArray(d.properties.className)||(d.properties.className=[]),d.properties.className.includes(l)||d.properties.className.unshift(l);const y=utt(d,{whitespace:"pre"});let x;try{x=g?u.highlight(g,y,{prefix:a}):u.highlightAuto(y,{prefix:a,subset:o})}catch(w){const b=w;if(g&&/Unknown language/.test(b.message)){h.message("Cannot highlight as `"+g+"`, it’s not registered",{ancestors:[m,d],cause:b,place:d.position,ruleId:"missing-language",source:"rehype-highlight"});return}throw b}!g&&x.data&&x.data.language&&d.properties.className.push("language-"+x.data.language),x.children.length>0&&(d.children=x.children)})}}function krt(e){const t=e.properties.className;let i=-1;if(!Array.isArray(t))return;let r;for(;++i<t.length;){const n=String(t[i]);if(n==="no-highlight"||n==="nohighlight")return!1;!r&&n.slice(0,5)==="lang-"&&(r=n.slice(5)),!r&&n.slice(0,9)==="language-"&&(r=n.slice(9))}return r}function Fq(e){let t=e.replace(/\\n/g,`
`).replace(/\*\*/g,"**").replace(/\*/g,"*").trim();const i=[];return t=t.replace(/```([\s\S]*?)```/g,s=>(i.push(s),`__EXISTING_CODE_BLOCK_${i.length-1}__`)),t=t.replace(/^([A-Z][A-Z\s]+)$/gm,s=>`## ${s.trim()}`),t=t.replace(/^(\d+\.\s+)([A-Z][A-Z\s]+)$/gm,(s,a,o)=>`### ${a}${o}`),t=t.replace(/^(\s*)-\s+(.+)$/gm,(s,a,o)=>`${a}- ${o.trim()}`),t=t.split(/\n\n+/).map(s=>s.includes("__EXISTING_CODE_BLOCK_")?s:[/^import\s+[\w_.]+/m,/^from\s+[\w_.]+\s+import/m,/^def\s+\w+\s*\(/m,/^class\s+\w+/m,/^\s*for\s+\w+\s+in\s+/m,/^\s*if\s+.+:/m,/^\s*while\s+.+:/m,/^\s*with\s+.+:/m,/^\s*try:/m,/^\s*except\s+/m,/^\s*\w+\s*=\s*{/m,/^\s*\w+\s*=\s*\[/m,/^\s*print\(/m,/^ydl_opts\s*=/m].some(l=>l.test(s))?`\`\`\`python
${s}
\`\`\``:s).join(`

`),t=t.replace(/__EXISTING_CODE_BLOCK_(\d+)__/g,(s,a)=>i[parseInt(a)]),t}const tae=(window.location.hostname.includes("vercel.app"),"https://portfolio-backend-eta-ten.vercel.app/api");console.log("Mode:","production");console.log("Backend URL:",tae);const Brt=({content:e})=>{const[t,i]=de.useState(!1),r=()=>{navigator.clipboard.writeText(e).then(()=>{i(!0),setTimeout(()=>i(!1),2e3)}).catch(n=>{console.error("Failed to copy: ",n)})};return j.jsx("button",{onClick:r,className:"absolute right-2 top-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded px-2 py-1 text-xs flex items-center transition-colors z-10",title:"Copier le code",children:t?j.jsxs(j.Fragment,{children:[j.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:j.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Copié"]}):j.jsxs(j.Fragment,{children:[j.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:[j.jsx("path",{d:"M8 2a1 1 0 000 2h2a1 1 0 100-2H8z"}),j.jsx("path",{d:"M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11h2a1 1 0 110 2h-2v-2z"})]}),"Copier"]})})};function zrt(e,t,i){if(typeof i=="string"&&!i.includes("[object Object]"))return i;try{const r=new RegExp("```"+t+"\\n([\\s\\S]*?)```","g"),n=[...e.matchAll(r)];if(n.length>0&&n[0][1])return n[0][1].trim();const s=/```(?:\w*)\n([\s\S]*?)```/g,a=[...e.matchAll(s)];if(a.length>0&&a[0][1])return a[0][1].trim()}catch(r){console.error("Error extracting code:",r)}return String(i).replace(/\[object Object\]/g,"").replace(/,/g,"").trim()}const Frt=()=>j.jsx("div",{className:"w-full h-full",style:{pointerEvents:"none"},children:j.jsx(mne,{scene:"https://prod.spline.design/fxkQcgSmamcJ1nJr/scene.splinecode",style:{width:"100%",height:"100%"}})}),Urt=()=>{const e=de.useRef(null),t=de.useRef(null),i=de.useRef(null),r=de.useRef(null),[n,s]=de.useState(null),[a,o]=de.useState({text:"Bonjour ! Je suis Andriantahiry Nomena Hasina, développeur fullstack, cloud practitioner et spécialiste en automatisation. Comment puis-je vous aider aujourd'hui ?",isBot:!0,timestamp:new Date}),[l,u]=de.useState(""),[c,h]=de.useState(!1),[d,f]=de.useState(0),[m,g]=de.useState(!1),[y,x]=de.useState(""),[w,b]=de.useState([]);de.useEffect(()=>{a&&a.text&&x(Fq(a.text))},[a]);const C=async A=>{if(A.preventDefault(),A.stopPropagation(),!l.trim())return;s({text:l,isBot:!1,timestamp:new Date}),u(""),h(!0),setTimeout(()=>{var I;(I=r.current)==null||I.scrollIntoView({behavior:"smooth",block:"start"})},300);const _={role:"user",parts:[{text:l}]},P=[...w,_];try{const I=await fetch(`${tae}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:l,history:P})});if(!I.ok)throw new Error("Network response was not ok");const D=await I.json(),k={text:D.message,isBot:!0,timestamp:new Date},B={role:"model",parts:[{text:D.message}]};b([...P,B]),h(!1),o(k),f(z=>z+1),g(!1)}catch(I){console.error("Error:",I),h(!1),g(!0),o({text:"Je suis désolé, je rencontre des difficultés de connexion. Pourriez-vous réessayer dans quelques instants ?",isBot:!0,timestamp:new Date}),f(D=>D+1)}};return j.jsxs("div",{className:"py-16 px-4",id:"chatbot-section",ref:e,tabIndex:-1,style:{outline:"none"},children:[" ",j.jsxs("div",{className:"max-w-2xl mx-auto",children:[j.jsxs("h2",{ref:r,className:"text-3xl font-bold text-center mb-8 text-gray-800 dark:text-white",children:[" ","Assistant Virtuel",m&&j.jsx("span",{className:"text-xs ml-2 text-red-500",children:"(mode hors-ligne)"})]}),j.jsx("h4",{className:"text-center mb-8 text-gray-800 dark:text-white",children:"Modèle de Gemini light"}),j.jsx("div",{className:"h-72 mb-8 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-lg shadow-lg overflow-hidden flex items-center justify-center",children:j.jsx(Frt,{})}),j.jsx("div",{className:"mb-8",children:j.jsx(Jb,{mode:"wait",children:c?j.jsx(Ui.div,{className:"flex justify-center",children:j.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-2xl",children:j.jsxs("div",{className:"flex space-x-2",children:[j.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-300 animate-bounce",style:{animationDelay:"0ms"}}),j.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-300 animate-bounce",style:{animationDelay:"150ms"}}),j.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-300 animate-bounce",style:{animationDelay:"300ms"}})]})})}):j.jsx(Ui.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.4},className:"w-full flex justify-center",children:j.jsx("div",{className:"w-full bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:j.jsx("div",{className:"p-6",children:j.jsx("div",{className:"prose prose-lg prose-indigo dark:prose-invert max-w-none",children:j.jsx(jQe,{remarkPlugins:[itt],rehypePlugins:[Nrt],components:{h2:({node:A,...E})=>j.jsx("h2",{className:"text-2xl font-bold my-6 text-indigo-600 dark:text-indigo-400 tracking-wide",...E}),h3:({node:A,...E})=>j.jsx("h3",{className:"text-xl font-semibold my-4 text-gray-700 dark:text-gray-300",...E}),ul:({node:A,...E})=>j.jsx("ul",{className:"my-4 space-y-2 list-none",...E}),li:({node:A,...E})=>j.jsxs("li",{className:"flex items-start space-x-2 my-2",...E,children:[j.jsx("span",{className:"text-indigo-500 dark:text-indigo-400 mt-1",children:"•"}),j.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:E.children})]}),code:({node:A,inline:E,className:_,children:P,...I})=>{const D=/language-(\w+)/.exec(_||""),k=D?D[1]:"plaintext",B=P||"",z=D?zrt(y,k,String(B)):String(B);return!E&&D?j.jsxs("div",{className:"relative",children:[j.jsx(Brt,{content:z}),j.jsxs("pre",{className:"bg-gray-900 text-gray-200 p-4 rounded-lg mt-2 overflow-x-auto font-mono text-sm",children:[j.jsx("div",{className:"px-4 py-2 bg-gray-800 text-gray-400 text-xs",children:k}),j.jsx("code",{className:_,...I,children:P})]})]}):j.jsx("code",{className:_,...I,children:P})}},children:Fq(a.text)})})})})},`response-${d}`)})}),j.jsxs("form",{ref:t,onSubmit:C,className:"flex gap-2",children:[j.jsx("input",{ref:i,type:"text",value:l,onChange:A=>u(A.target.value),placeholder:"Tapez votre message ici...",className:"flex-1 p-4 rounded-full border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"}),j.jsx("button",{type:"submit",className:"px-6 py-4 bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-700 hover:to-violet-700 text-white font-medium rounded-full shadow-lg transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:c,children:j.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:j.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})]})]})},jrt=({threshold:e=.1,triggerOnce:t=!1,rootMargin:i="0px"}={})=>{const r=de.useRef(null),[n,s]=de.useState(!1),a=de.useRef(!1);return de.useEffect(()=>{const o=r.current;if(!o)return;const l=new IntersectionObserver(u=>{const[c]=u,h=c.isIntersecting;a.current&&t||(h?(s(!0),a.current=!0,t&&l.disconnect()):t||s(!1))},{threshold:e,rootMargin:i});return l.observe(o),()=>{o&&l.unobserve(o)}},[e,t,i]),[r,n]},Km=({children:e,delay:t=0,duration:i=.5,direction:r="up",threshold:n=.1,triggerOnce:s=!0,className:a="",distance:o=50,style:l={}})=>{const[u,c]=jrt({threshold:n,triggerOnce:s,rootMargin:"0px"}),d={hidden:(()=>{switch(r){case"up":return{opacity:0,y:o};case"down":return{opacity:0,y:-o};case"left":return{opacity:0,x:o};case"right":return{opacity:0,x:-o};case"none":return{opacity:0};default:return{opacity:0,y:o}}})(),visible:{opacity:1,x:0,y:0,transition:{duration:i,delay:t,ease:[.25,.1,.25,1]}}};return j.jsx(Ui.div,{ref:u,initial:"hidden",animate:c?"visible":"hidden",variants:d,className:a,style:l,children:e})},Vrt=()=>{const{scrollYProgress:e}=B1e(),t=p3(e,[0,.05],[1,0]);return de.useEffect(()=>{if(window.location.hash){const i=window.location.hash.substring(1),r=document.getElementById(i);r&&r.scrollIntoView({behavior:"smooth"})}},[]),j.jsxs("div",{className:"min-h-screen bg-background",children:[j.jsx(Kxe,{}),j.jsxs("main",{children:[j.jsxs("section",{id:"home",className:"relative h-screen",children:[j.jsx(Jxe,{}),j.jsx(Ui.div,{style:{opacity:t},className:"absolute inset-0 pointer-events-none"})]}),j.jsx("section",{id:"about",children:j.jsx(Km,{children:j.jsx(Ibe,{})})}),j.jsx("section",{id:"skills",children:j.jsx(Km,{delay:.1,children:j.jsx(Nbe,{})})}),j.jsx("section",{id:"interactive",children:j.jsx(Km,{delay:.2,direction:"right",children:j.jsx(nwe,{})})}),j.jsx("section",{id:"projects",children:j.jsx(Km,{delay:.1,direction:"left",children:j.jsx(u_e,{})})}),j.jsx("section",{id:"blog",children:j.jsx(Km,{delay:.2,children:j.jsx(B_e,{})})}),j.jsx("section",{id:"appointment",className:"bg-gray-dark dark:bg-dark p-5",children:j.jsx(Km,{delay:.1,direction:"up",children:j.jsx(_Te,{})})}),j.jsx("section",{id:"chatbot",children:j.jsx(Urt,{})}),j.jsx("section",{id:"contact",children:j.jsx(L_e,{})})]}),j.jsx(Km,{delay:.3,direction:"none",children:j.jsx(N_e,{})})]})};function d0(){const e=CK(),t=(e==null?void 0:e.status)||"500",i=(e==null?void 0:e.message)||"Something went wrong";return j.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 text-center",children:j.jsxs("div",{className:"w-full max-w-md mx-auto",children:[j.jsx(vZ,{className:"w-16 h-16 mx-auto mb-4 text-destructive"}),j.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Application Error"}),j.jsxs("div",{className:"p-4 mb-4 rounded-lg bg-muted",children:[j.jsx("p",{className:"text-lg font-semibold mb-1",children:t}),j.jsx("p",{className:"text-muted-foreground",children:i})]}),j.jsx("div",{className:"flex justify-center gap-4",children:j.jsx(Zn,{asChild:!0,variant:"default",children:j.jsxs(Ox,{to:"/",children:[j.jsx(jxe,{className:"w-4 h-4 mr-2"}),"Back to Home"]})})})]})})}const Hrt=()=>{const[e,t]=de.useState(!1);de.useEffect(()=>{const r=()=>{window.scrollY>300?t(!0):t(!1)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const i=()=>{window.scrollTo({top:0,behavior:"smooth"})};return j.jsx(Jb,{children:e&&j.jsx(Ui.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},onClick:i,className:"fixed bottom-8 right-8 bg-black dark:bg-white text-white dark:text-black w-12 h-12 rounded-full shadow-lg flex items-center justify-center z-50 hover:bg-gray-900 dark:hover:bg-gray-100 transition-colors","aria-label":"Retour en haut",whileHover:{y:-5},whileTap:{scale:.95},children:j.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6 text-white dark:text-black",children:j.jsx("path",{d:"m18 15-6-6-6 6"})})})})},Wrt=({allowedRoles:e})=>{const t=localStorage.getItem("authToken"),i=localStorage.getItem("userData");let r=null;if(i)try{const n=JSON.parse(i);r=n==null?void 0:n.role}catch(n){return console.error("Erreur parsing userData:",n),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),j.jsx(HP,{to:"/login",replace:!0})}return t?!r||!e.includes(r)?(console.warn(`Accès non autorisé pour le rôle: ${r}`),j.jsx(HP,{to:"/",replace:!0})):j.jsx(Pme,{}):j.jsx(HP,{to:"/login",replace:!0})},Grt=de.lazy(()=>Ll(()=>import("./BlogPage-DRi3BgR9.js"),[])),qrt=de.lazy(()=>Ll(()=>import("./BlogPostDetail-DZ7ZotB1.js"),__vite__mapDeps([0,1]))),Yrt=de.lazy(()=>Ll(()=>import("./AdminDashboard-CDDmRSvP.js"),__vite__mapDeps([2,1,3]))),Xrt=de.lazy(()=>Ll(()=>import("./CreateUserPage-Cp4Zz-Qi.js"),__vite__mapDeps([4,1]))),Krt=de.lazy(()=>Ll(()=>import("./LoginPage-BrDH7ymF.js"),__vite__mapDeps([5,1]))),$rt=({onComplete:e})=>((()=>{requestAnimationFrame(()=>{setTimeout(e,2e3)})})(),j.jsx(Ui.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black",initial:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:j.jsxs("div",{className:"text-center",children:[j.jsx(Ui.div,{className:"mx-auto mb-4 h-12 w-12 rounded-full border-4 border-white/20 border-t-white",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),j.jsx("p",{className:"text-white",children:"Chargement de votre expérience..."})]})}));function Zrt(){rv();const[e,t]=de.useState(!0),i=()=>j.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-black/50 backdrop-blur-sm",children:j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-white mx-auto mb-4"}),j.jsx("p",{className:"text-white",children:"Chargement..."})]})});return j.jsxs(j.Fragment,{children:[j.jsx(Jb,{mode:"wait",children:e&&j.jsx($rt,{onComplete:()=>t(!1)})}),!e&&j.jsxs(de.Suspense,{fallback:j.jsx(i,{}),children:[j.jsxs(Ime,{children:[j.jsx(Jf,{path:"/",element:j.jsx(Vrt,{}),errorElement:j.jsx(d0,{})}),j.jsx(Jf,{path:"/blog",element:j.jsx(Grt,{}),errorElement:j.jsx(d0,{})}),j.jsx(Jf,{path:"/blog/:slug",element:j.jsx(qrt,{}),errorElement:j.jsx(d0,{})}),j.jsx(Jf,{element:j.jsx(Wrt,{allowedRoles:["ADMIN","SUPERADMIN"]}),children:j.jsx(Jf,{path:"/admin",element:j.jsx(Yrt,{}),errorElement:j.jsx(d0,{})})}),j.jsx(Jf,{path:"/create-user",element:j.jsx(Xrt,{}),errorElement:j.jsx(d0,{})})," ",j.jsx(Jf,{path:"/login",element:j.jsx(Krt,{}),errorElement:j.jsx(d0,{})})," ",!1]}),!1,j.jsx(Hrt,{})]})]})}var iae={},e2={},t2={},lF={},jO={},VO={},rae={exports:{}};/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */(function(e){(function(t,i){e.exports=t.document?i(t,!0):function(r){if(!r.document)throw new Error("jQuery requires a window with a document");return i(r)}})(typeof window<"u"?window:Nr,function(t,i){var r=[],n=Object.getPrototypeOf,s=r.slice,a=r.flat?function(M){return r.flat.call(M)}:function(M){return r.concat.apply([],M)},o=r.push,l=r.indexOf,u={},c=u.toString,h=u.hasOwnProperty,d=h.toString,f=d.call(Object),m={},g=function(N){return typeof N=="function"&&typeof N.nodeType!="number"&&typeof N.item!="function"},y=function(N){return N!=null&&N===N.window},x=t.document,w={type:!0,src:!0,nonce:!0,noModule:!0};function b(M,N,H){H=H||x;var K,re,ne=H.createElement("script");if(ne.text=M,N)for(K in w)re=N[K]||N.getAttribute&&N.getAttribute(K),re&&ne.setAttribute(K,re);H.head.appendChild(ne).parentNode.removeChild(ne)}function C(M){return M==null?M+"":typeof M=="object"||typeof M=="function"?u[c.call(M)]||"object":typeof M}var A="3.7.1",E=/HTML$/i,_=function(M,N){return new _.fn.init(M,N)};_.fn=_.prototype={jquery:A,constructor:_,length:0,toArray:function(){return s.call(this)},get:function(M){return M==null?s.call(this):M<0?this[M+this.length]:this[M]},pushStack:function(M){var N=_.merge(this.constructor(),M);return N.prevObject=this,N},each:function(M){return _.each(this,M)},map:function(M){return this.pushStack(_.map(this,function(N,H){return M.call(N,H,N)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(_.grep(this,function(M,N){return(N+1)%2}))},odd:function(){return this.pushStack(_.grep(this,function(M,N){return N%2}))},eq:function(M){var N=this.length,H=+M+(M<0?N:0);return this.pushStack(H>=0&&H<N?[this[H]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:r.sort,splice:r.splice},_.extend=_.fn.extend=function(){var M,N,H,K,re,ne,ce=arguments[0]||{},Be=1,Pe=arguments.length,Ye=!1;for(typeof ce=="boolean"&&(Ye=ce,ce=arguments[Be]||{},Be++),typeof ce!="object"&&!g(ce)&&(ce={}),Be===Pe&&(ce=this,Be--);Be<Pe;Be++)if((M=arguments[Be])!=null)for(N in M)K=M[N],!(N==="__proto__"||ce===K)&&(Ye&&K&&(_.isPlainObject(K)||(re=Array.isArray(K)))?(H=ce[N],re&&!Array.isArray(H)?ne=[]:!re&&!_.isPlainObject(H)?ne={}:ne=H,re=!1,ce[N]=_.extend(Ye,ne,K)):K!==void 0&&(ce[N]=K));return ce},_.extend({expando:"jQuery"+(A+Math.random()).replace(/\D/g,""),isReady:!0,error:function(M){throw new Error(M)},noop:function(){},isPlainObject:function(M){var N,H;return!M||c.call(M)!=="[object Object]"?!1:(N=n(M),N?(H=h.call(N,"constructor")&&N.constructor,typeof H=="function"&&d.call(H)===f):!0)},isEmptyObject:function(M){var N;for(N in M)return!1;return!0},globalEval:function(M,N,H){b(M,{nonce:N&&N.nonce},H)},each:function(M,N){var H,K=0;if(P(M))for(H=M.length;K<H&&N.call(M[K],K,M[K])!==!1;K++);else for(K in M)if(N.call(M[K],K,M[K])===!1)break;return M},text:function(M){var N,H="",K=0,re=M.nodeType;if(!re)for(;N=M[K++];)H+=_.text(N);return re===1||re===11?M.textContent:re===9?M.documentElement.textContent:re===3||re===4?M.nodeValue:H},makeArray:function(M,N){var H=N||[];return M!=null&&(P(Object(M))?_.merge(H,typeof M=="string"?[M]:M):o.call(H,M)),H},inArray:function(M,N,H){return N==null?-1:l.call(N,M,H)},isXMLDoc:function(M){var N=M&&M.namespaceURI,H=M&&(M.ownerDocument||M).documentElement;return!E.test(N||H&&H.nodeName||"HTML")},merge:function(M,N){for(var H=+N.length,K=0,re=M.length;K<H;K++)M[re++]=N[K];return M.length=re,M},grep:function(M,N,H){for(var K,re=[],ne=0,ce=M.length,Be=!H;ne<ce;ne++)K=!N(M[ne],ne),K!==Be&&re.push(M[ne]);return re},map:function(M,N,H){var K,re,ne=0,ce=[];if(P(M))for(K=M.length;ne<K;ne++)re=N(M[ne],ne,H),re!=null&&ce.push(re);else for(ne in M)re=N(M[ne],ne,H),re!=null&&ce.push(re);return a(ce)},guid:1,support:m}),typeof Symbol=="function"&&(_.fn[Symbol.iterator]=r[Symbol.iterator]),_.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(M,N){u["[object "+N+"]"]=N.toLowerCase()});function P(M){var N=!!M&&"length"in M&&M.length,H=C(M);return g(M)||y(M)?!1:H==="array"||N===0||typeof N=="number"&&N>0&&N-1 in M}function I(M,N){return M.nodeName&&M.nodeName.toLowerCase()===N.toLowerCase()}var D=r.pop,k=r.sort,B=r.splice,z="[\\x20\\t\\r\\n\\f]",W=new RegExp("^"+z+"+|((?:^|[^\\\\])(?:\\\\.)*)"+z+"+$","g");_.contains=function(M,N){var H=N&&N.parentNode;return M===H||!!(H&&H.nodeType===1&&(M.contains?M.contains(H):M.compareDocumentPosition&&M.compareDocumentPosition(H)&16))};var $=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function Z(M,N){return N?M==="\0"?"�":M.slice(0,-1)+"\\"+M.charCodeAt(M.length-1).toString(16)+" ":"\\"+M}_.escapeSelector=function(M){return(M+"").replace($,Z)};var G=x,V=o;(function(){var M,N,H,K,re,ne=V,ce,Be,Pe,Ye,ft,bt=_.expando,at=0,Nt=0,Kt=Qh(),Hi=Qh(),Wi=Qh(),ns=Qh(),ln=function(Se,Ve){return Se===Ve&&(re=!0),0},nl="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",wo="(?:\\\\[\\da-fA-F]{1,6}"+z+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",ar="\\["+z+"*("+wo+")(?:"+z+"*([*^$|!~]?=)"+z+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+wo+"))|)"+z+"*\\]",Eo=":("+wo+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+ar+")*)|.*)\\)|)",Gi=new RegExp(z+"+","g"),jr=new RegExp("^"+z+"*,"+z+"*"),Fl=new RegExp("^"+z+"*([>+~]|"+z+")"+z+"*"),Bs=new RegExp(z+"|>"),Ka=new RegExp(Eo),uu=new RegExp("^"+wo+"$"),$a={ID:new RegExp("^#("+wo+")"),CLASS:new RegExp("^\\.("+wo+")"),TAG:new RegExp("^("+wo+"|[*])"),ATTR:new RegExp("^"+ar),PSEUDO:new RegExp("^"+Eo),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+z+"*(even|odd|(([+-]|)(\\d*)n|)"+z+"*(?:([+-]|)"+z+"*(\\d+)|))"+z+"*\\)|)","i"),bool:new RegExp("^(?:"+nl+")$","i"),needsContext:new RegExp("^"+z+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+z+"*((?:-\\d)?\\d*)"+z+"*\\)|)(?=[^-]|$)","i")},So=/^(?:input|select|textarea|button)$/i,sl=/^h\d$/i,oa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$h=/[+~]/,al=new RegExp("\\\\[\\da-fA-F]{1,6}"+z+"?|\\\\([^\\r\\n\\f])","g"),ol=function(Se,Ve){var it="0x"+Se.slice(1)-65536;return Ve||(it<0?String.fromCharCode(it+65536):String.fromCharCode(it>>10|55296,it&1023|56320))},un=function(){To()},cu=zs(function(Se){return Se.disabled===!0&&I(Se,"fieldset")},{dir:"parentNode",next:"legend"});function Zh(){try{return ce.activeElement}catch{}}try{ne.apply(r=s.call(G.childNodes),G.childNodes),r[G.childNodes.length].nodeType}catch{ne={apply:function(Ve,it){V.apply(Ve,s.call(it))},call:function(Ve){V.apply(Ve,s.call(arguments,1))}}}function ir(Se,Ve,it,ut){var be,je,Fe,vt,Tt,Jt,ii,Gt=Ve&&Ve.ownerDocument,er=Ve?Ve.nodeType:9;if(it=it||[],typeof Se!="string"||!Se||er!==1&&er!==9&&er!==11)return it;if(!ut&&(To(Ve),Ve=Ve||ce,Pe)){if(er!==11&&(Tt=oa.exec(Se)))if(be=Tt[1]){if(er===9)if(Fe=Ve.getElementById(be)){if(Fe.id===be)return ne.call(it,Fe),it}else return it;else if(Gt&&(Fe=Gt.getElementById(be))&&ir.contains(Ve,Fe)&&Fe.id===be)return ne.call(it,Fe),it}else{if(Tt[2])return ne.apply(it,Ve.getElementsByTagName(Se)),it;if((be=Tt[3])&&Ve.getElementsByClassName)return ne.apply(it,Ve.getElementsByClassName(be)),it}if(!ns[Se+" "]&&(!Ye||!Ye.test(Se))){if(ii=Se,Gt=Ve,er===1&&(Bs.test(Se)||Fl.test(Se))){for(Gt=$h.test(Se)&&ll(Ve.parentNode)||Ve,(Gt!=Ve||!m.scope)&&((vt=Ve.getAttribute("id"))?vt=_.escapeSelector(vt):Ve.setAttribute("id",vt=bt)),Jt=hu(Se),je=Jt.length;je--;)Jt[je]=(vt?"#"+vt:":scope")+" "+Co(Jt[je]);ii=Jt.join(",")}try{return ne.apply(it,Gt.querySelectorAll(ii)),it}catch{ns(Se,!0)}finally{vt===bt&&Ve.removeAttribute("id")}}}return id(Se.replace(W,"$1"),Ve,it,ut)}function Qh(){var Se=[];function Ve(it,ut){return Se.push(it+" ")>N.cacheLength&&delete Ve[Se.shift()],Ve[it+" "]=ut}return Ve}function _s(Se){return Se[bt]=!0,Se}function Bc(Se){var Ve=ce.createElement("fieldset");try{return!!Se(Ve)}catch{return!1}finally{Ve.parentNode&&Ve.parentNode.removeChild(Ve),Ve=null}}function Jh(Se){return function(Ve){return I(Ve,"input")&&Ve.type===Se}}function Ev(Se){return function(Ve){return(I(Ve,"input")||I(Ve,"button"))&&Ve.type===Se}}function ed(Se){return function(Ve){return"form"in Ve?Ve.parentNode&&Ve.disabled===!1?"label"in Ve?"label"in Ve.parentNode?Ve.parentNode.disabled===Se:Ve.disabled===Se:Ve.isDisabled===Se||Ve.isDisabled!==!Se&&cu(Ve)===Se:Ve.disabled===Se:"label"in Ve?Ve.disabled===Se:!1}}function Za(Se){return _s(function(Ve){return Ve=+Ve,_s(function(it,ut){for(var be,je=Se([],it.length,Ve),Fe=je.length;Fe--;)it[be=je[Fe]]&&(it[be]=!(ut[be]=it[be]))})})}function ll(Se){return Se&&typeof Se.getElementsByTagName<"u"&&Se}function To(Se){var Ve,it=Se?Se.ownerDocument||Se:G;return it==ce||it.nodeType!==9||!it.documentElement||(ce=it,Be=ce.documentElement,Pe=!_.isXMLDoc(ce),ft=Be.matches||Be.webkitMatchesSelector||Be.msMatchesSelector,Be.msMatchesSelector&&G!=ce&&(Ve=ce.defaultView)&&Ve.top!==Ve&&Ve.addEventListener("unload",un),m.getById=Bc(function(ut){return Be.appendChild(ut).id=_.expando,!ce.getElementsByName||!ce.getElementsByName(_.expando).length}),m.disconnectedMatch=Bc(function(ut){return ft.call(ut,"*")}),m.scope=Bc(function(){return ce.querySelectorAll(":scope")}),m.cssHas=Bc(function(){try{return ce.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),m.getById?(N.filter.ID=function(ut){var be=ut.replace(al,ol);return function(je){return je.getAttribute("id")===be}},N.find.ID=function(ut,be){if(typeof be.getElementById<"u"&&Pe){var je=be.getElementById(ut);return je?[je]:[]}}):(N.filter.ID=function(ut){var be=ut.replace(al,ol);return function(je){var Fe=typeof je.getAttributeNode<"u"&&je.getAttributeNode("id");return Fe&&Fe.value===be}},N.find.ID=function(ut,be){if(typeof be.getElementById<"u"&&Pe){var je,Fe,vt,Tt=be.getElementById(ut);if(Tt){if(je=Tt.getAttributeNode("id"),je&&je.value===ut)return[Tt];for(vt=be.getElementsByName(ut),Fe=0;Tt=vt[Fe++];)if(je=Tt.getAttributeNode("id"),je&&je.value===ut)return[Tt]}return[]}}),N.find.TAG=function(ut,be){return typeof be.getElementsByTagName<"u"?be.getElementsByTagName(ut):be.querySelectorAll(ut)},N.find.CLASS=function(ut,be){if(typeof be.getElementsByClassName<"u"&&Pe)return be.getElementsByClassName(ut)},Ye=[],Bc(function(ut){var be;Be.appendChild(ut).innerHTML="<a id='"+bt+"' href='' disabled='disabled'></a><select id='"+bt+"-\r\\' disabled='disabled'><option selected=''></option></select>",ut.querySelectorAll("[selected]").length||Ye.push("\\["+z+"*(?:value|"+nl+")"),ut.querySelectorAll("[id~="+bt+"-]").length||Ye.push("~="),ut.querySelectorAll("a#"+bt+"+*").length||Ye.push(".#.+[+~]"),ut.querySelectorAll(":checked").length||Ye.push(":checked"),be=ce.createElement("input"),be.setAttribute("type","hidden"),ut.appendChild(be).setAttribute("name","D"),Be.appendChild(ut).disabled=!0,ut.querySelectorAll(":disabled").length!==2&&Ye.push(":enabled",":disabled"),be=ce.createElement("input"),be.setAttribute("name",""),ut.appendChild(be),ut.querySelectorAll("[name='']").length||Ye.push("\\["+z+"*name"+z+"*="+z+`*(?:''|"")`)}),m.cssHas||Ye.push(":has"),Ye=Ye.length&&new RegExp(Ye.join("|")),ln=function(ut,be){if(ut===be)return re=!0,0;var je=!ut.compareDocumentPosition-!be.compareDocumentPosition;return je||(je=(ut.ownerDocument||ut)==(be.ownerDocument||be)?ut.compareDocumentPosition(be):1,je&1||!m.sortDetached&&be.compareDocumentPosition(ut)===je?ut===ce||ut.ownerDocument==G&&ir.contains(G,ut)?-1:be===ce||be.ownerDocument==G&&ir.contains(G,be)?1:K?l.call(K,ut)-l.call(K,be):0:je&4?-1:1)}),ce}ir.matches=function(Se,Ve){return ir(Se,null,null,Ve)},ir.matchesSelector=function(Se,Ve){if(To(Se),Pe&&!ns[Ve+" "]&&(!Ye||!Ye.test(Ve)))try{var it=ft.call(Se,Ve);if(it||m.disconnectedMatch||Se.document&&Se.document.nodeType!==11)return it}catch{ns(Ve,!0)}return ir(Ve,ce,null,[Se]).length>0},ir.contains=function(Se,Ve){return(Se.ownerDocument||Se)!=ce&&To(Se),_.contains(Se,Ve)},ir.attr=function(Se,Ve){(Se.ownerDocument||Se)!=ce&&To(Se);var it=N.attrHandle[Ve.toLowerCase()],ut=it&&h.call(N.attrHandle,Ve.toLowerCase())?it(Se,Ve,!Pe):void 0;return ut!==void 0?ut:Se.getAttribute(Ve)},ir.error=function(Se){throw new Error("Syntax error, unrecognized expression: "+Se)},_.uniqueSort=function(Se){var Ve,it=[],ut=0,be=0;if(re=!m.sortStable,K=!m.sortStable&&s.call(Se,0),k.call(Se,ln),re){for(;Ve=Se[be++];)Ve===Se[be]&&(ut=it.push(be));for(;ut--;)B.call(Se,it[ut],1)}return K=null,Se},_.fn.uniqueSort=function(){return this.pushStack(_.uniqueSort(s.apply(this)))},N=_.expr={cacheLength:50,createPseudo:_s,match:$a,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Se){return Se[1]=Se[1].replace(al,ol),Se[3]=(Se[3]||Se[4]||Se[5]||"").replace(al,ol),Se[2]==="~="&&(Se[3]=" "+Se[3]+" "),Se.slice(0,4)},CHILD:function(Se){return Se[1]=Se[1].toLowerCase(),Se[1].slice(0,3)==="nth"?(Se[3]||ir.error(Se[0]),Se[4]=+(Se[4]?Se[5]+(Se[6]||1):2*(Se[3]==="even"||Se[3]==="odd")),Se[5]=+(Se[7]+Se[8]||Se[3]==="odd")):Se[3]&&ir.error(Se[0]),Se},PSEUDO:function(Se){var Ve,it=!Se[6]&&Se[2];return $a.CHILD.test(Se[0])?null:(Se[3]?Se[2]=Se[4]||Se[5]||"":it&&Ka.test(it)&&(Ve=hu(it,!0))&&(Ve=it.indexOf(")",it.length-Ve)-it.length)&&(Se[0]=Se[0].slice(0,Ve),Se[2]=it.slice(0,Ve)),Se.slice(0,3))}},filter:{TAG:function(Se){var Ve=Se.replace(al,ol).toLowerCase();return Se==="*"?function(){return!0}:function(it){return I(it,Ve)}},CLASS:function(Se){var Ve=Kt[Se+" "];return Ve||(Ve=new RegExp("(^|"+z+")"+Se+"("+z+"|$)"))&&Kt(Se,function(it){return Ve.test(typeof it.className=="string"&&it.className||typeof it.getAttribute<"u"&&it.getAttribute("class")||"")})},ATTR:function(Se,Ve,it){return function(ut){var be=ir.attr(ut,Se);return be==null?Ve==="!=":Ve?(be+="",Ve==="="?be===it:Ve==="!="?be!==it:Ve==="^="?it&&be.indexOf(it)===0:Ve==="*="?it&&be.indexOf(it)>-1:Ve==="$="?it&&be.slice(-it.length)===it:Ve==="~="?(" "+be.replace(Gi," ")+" ").indexOf(it)>-1:Ve==="|="?be===it||be.slice(0,it.length+1)===it+"-":!1):!0}},CHILD:function(Se,Ve,it,ut,be){var je=Se.slice(0,3)!=="nth",Fe=Se.slice(-4)!=="last",vt=Ve==="of-type";return ut===1&&be===0?function(Tt){return!!Tt.parentNode}:function(Tt,Jt,ii){var Gt,er,si,Zi,ss,Nn=je!==Fe?"nextSibling":"previousSibling",as=Tt.parentNode,la=vt&&Tt.nodeName.toLowerCase(),Ul=!ii&&!vt,Ai=!1;if(as){if(je){for(;Nn;){for(si=Tt;si=si[Nn];)if(vt?I(si,la):si.nodeType===1)return!1;ss=Nn=Se==="only"&&!ss&&"nextSibling"}return!0}if(ss=[Fe?as.firstChild:as.lastChild],Fe&&Ul){for(er=as[bt]||(as[bt]={}),Gt=er[Se]||[],Zi=Gt[0]===at&&Gt[1],Ai=Zi&&Gt[2],si=Zi&&as.childNodes[Zi];si=++Zi&&si&&si[Nn]||(Ai=Zi=0)||ss.pop();)if(si.nodeType===1&&++Ai&&si===Tt){er[Se]=[at,Zi,Ai];break}}else if(Ul&&(er=Tt[bt]||(Tt[bt]={}),Gt=er[Se]||[],Zi=Gt[0]===at&&Gt[1],Ai=Zi),Ai===!1)for(;(si=++Zi&&si&&si[Nn]||(Ai=Zi=0)||ss.pop())&&!((vt?I(si,la):si.nodeType===1)&&++Ai&&(Ul&&(er=si[bt]||(si[bt]={}),er[Se]=[at,Ai]),si===Tt)););return Ai-=be,Ai===ut||Ai%ut===0&&Ai/ut>=0}}},PSEUDO:function(Se,Ve){var it,ut=N.pseudos[Se]||N.setFilters[Se.toLowerCase()]||ir.error("unsupported pseudo: "+Se);return ut[bt]?ut(Ve):ut.length>1?(it=[Se,Se,"",Ve],N.setFilters.hasOwnProperty(Se.toLowerCase())?_s(function(be,je){for(var Fe,vt=ut(be,Ve),Tt=vt.length;Tt--;)Fe=l.call(be,vt[Tt]),be[Fe]=!(je[Fe]=vt[Tt])}):function(be){return ut(be,0,it)}):ut}},pseudos:{not:_s(function(Se){var Ve=[],it=[],ut=td(Se.replace(W,"$1"));return ut[bt]?_s(function(be,je,Fe,vt){for(var Tt,Jt=ut(be,null,vt,[]),ii=be.length;ii--;)(Tt=Jt[ii])&&(be[ii]=!(je[ii]=Tt))}):function(be,je,Fe){return Ve[0]=be,ut(Ve,null,Fe,it),Ve[0]=null,!it.pop()}}),has:_s(function(Se){return function(Ve){return ir(Se,Ve).length>0}}),contains:_s(function(Se){return Se=Se.replace(al,ol),function(Ve){return(Ve.textContent||_.text(Ve)).indexOf(Se)>-1}}),lang:_s(function(Se){return uu.test(Se||"")||ir.error("unsupported lang: "+Se),Se=Se.replace(al,ol).toLowerCase(),function(Ve){var it;do if(it=Pe?Ve.lang:Ve.getAttribute("xml:lang")||Ve.getAttribute("lang"))return it=it.toLowerCase(),it===Se||it.indexOf(Se+"-")===0;while((Ve=Ve.parentNode)&&Ve.nodeType===1);return!1}}),target:function(Se){var Ve=t.location&&t.location.hash;return Ve&&Ve.slice(1)===Se.id},root:function(Se){return Se===Be},focus:function(Se){return Se===Zh()&&ce.hasFocus()&&!!(Se.type||Se.href||~Se.tabIndex)},enabled:ed(!1),disabled:ed(!0),checked:function(Se){return I(Se,"input")&&!!Se.checked||I(Se,"option")&&!!Se.selected},selected:function(Se){return Se.parentNode&&Se.parentNode.selectedIndex,Se.selected===!0},empty:function(Se){for(Se=Se.firstChild;Se;Se=Se.nextSibling)if(Se.nodeType<6)return!1;return!0},parent:function(Se){return!N.pseudos.empty(Se)},header:function(Se){return sl.test(Se.nodeName)},input:function(Se){return So.test(Se.nodeName)},button:function(Se){return I(Se,"input")&&Se.type==="button"||I(Se,"button")},text:function(Se){var Ve;return I(Se,"input")&&Se.type==="text"&&((Ve=Se.getAttribute("type"))==null||Ve.toLowerCase()==="text")},first:Za(function(){return[0]}),last:Za(function(Se,Ve){return[Ve-1]}),eq:Za(function(Se,Ve,it){return[it<0?it+Ve:it]}),even:Za(function(Se,Ve){for(var it=0;it<Ve;it+=2)Se.push(it);return Se}),odd:Za(function(Se,Ve){for(var it=1;it<Ve;it+=2)Se.push(it);return Se}),lt:Za(function(Se,Ve,it){var ut;for(it<0?ut=it+Ve:it>Ve?ut=Ve:ut=it;--ut>=0;)Se.push(ut);return Se}),gt:Za(function(Se,Ve,it){for(var ut=it<0?it+Ve:it;++ut<Ve;)Se.push(ut);return Se})}},N.pseudos.nth=N.pseudos.eq;for(M in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})N.pseudos[M]=Jh(M);for(M in{submit:!0,reset:!0})N.pseudos[M]=Ev(M);function _f(){}_f.prototype=N.filters=N.pseudos,N.setFilters=new _f;function hu(Se,Ve){var it,ut,be,je,Fe,vt,Tt,Jt=Hi[Se+" "];if(Jt)return Ve?0:Jt.slice(0);for(Fe=Se,vt=[],Tt=N.preFilter;Fe;){(!it||(ut=jr.exec(Fe)))&&(ut&&(Fe=Fe.slice(ut[0].length)||Fe),vt.push(be=[])),it=!1,(ut=Fl.exec(Fe))&&(it=ut.shift(),be.push({value:it,type:ut[0].replace(W," ")}),Fe=Fe.slice(it.length));for(je in N.filter)(ut=$a[je].exec(Fe))&&(!Tt[je]||(ut=Tt[je](ut)))&&(it=ut.shift(),be.push({value:it,type:je,matches:ut}),Fe=Fe.slice(it.length));if(!it)break}return Ve?Fe.length:Fe?ir.error(Se):Hi(Se,vt).slice(0)}function Co(Se){for(var Ve=0,it=Se.length,ut="";Ve<it;Ve++)ut+=Se[Ve].value;return ut}function zs(Se,Ve,it){var ut=Ve.dir,be=Ve.next,je=be||ut,Fe=it&&je==="parentNode",vt=Nt++;return Ve.first?function(Tt,Jt,ii){for(;Tt=Tt[ut];)if(Tt.nodeType===1||Fe)return Se(Tt,Jt,ii);return!1}:function(Tt,Jt,ii){var Gt,er,si=[at,vt];if(ii){for(;Tt=Tt[ut];)if((Tt.nodeType===1||Fe)&&Se(Tt,Jt,ii))return!0}else for(;Tt=Tt[ut];)if(Tt.nodeType===1||Fe)if(er=Tt[bt]||(Tt[bt]={}),be&&I(Tt,be))Tt=Tt[ut]||Tt;else{if((Gt=er[je])&&Gt[0]===at&&Gt[1]===vt)return si[2]=Gt[2];if(er[je]=si,si[2]=Se(Tt,Jt,ii))return!0}return!1}}function _m(Se){return Se.length>1?function(Ve,it,ut){for(var be=Se.length;be--;)if(!Se[be](Ve,it,ut))return!1;return!0}:Se[0]}function zc(Se,Ve,it){for(var ut=0,be=Ve.length;ut<be;ut++)ir(Se,Ve[ut],it);return it}function wf(Se,Ve,it,ut,be){for(var je,Fe=[],vt=0,Tt=Se.length,Jt=Ve!=null;vt<Tt;vt++)(je=Se[vt])&&(!it||it(je,ut,be))&&(Fe.push(je),Jt&&Ve.push(vt));return Fe}function ws(Se,Ve,it,ut,be,je){return ut&&!ut[bt]&&(ut=ws(ut)),be&&!be[bt]&&(be=ws(be,je)),_s(function(Fe,vt,Tt,Jt){var ii,Gt,er,si,Zi=[],ss=[],Nn=vt.length,as=Fe||zc(Ve||"*",Tt.nodeType?[Tt]:Tt,[]),la=Se&&(Fe||!Ve)?wf(as,Zi,Se,Tt,Jt):as;if(it?(si=be||(Fe?Se:Nn||ut)?[]:vt,it(la,si,Tt,Jt)):si=la,ut)for(ii=wf(si,ss),ut(ii,[],Tt,Jt),Gt=ii.length;Gt--;)(er=ii[Gt])&&(si[ss[Gt]]=!(la[ss[Gt]]=er));if(Fe){if(be||Se){if(be){for(ii=[],Gt=si.length;Gt--;)(er=si[Gt])&&ii.push(la[Gt]=er);be(null,si=[],ii,Jt)}for(Gt=si.length;Gt--;)(er=si[Gt])&&(ii=be?l.call(Fe,er):Zi[Gt])>-1&&(Fe[ii]=!(vt[ii]=er))}}else si=wf(si===vt?si.splice(Nn,si.length):si),be?be(null,vt,si,Jt):ne.apply(vt,si)})}function Es(Se){for(var Ve,it,ut,be=Se.length,je=N.relative[Se[0].type],Fe=je||N.relative[" "],vt=je?1:0,Tt=zs(function(Gt){return Gt===Ve},Fe,!0),Jt=zs(function(Gt){return l.call(Ve,Gt)>-1},Fe,!0),ii=[function(Gt,er,si){var Zi=!je&&(si||er!=H)||((Ve=er).nodeType?Tt(Gt,er,si):Jt(Gt,er,si));return Ve=null,Zi}];vt<be;vt++)if(it=N.relative[Se[vt].type])ii=[zs(_m(ii),it)];else{if(it=N.filter[Se[vt].type].apply(null,Se[vt].matches),it[bt]){for(ut=++vt;ut<be&&!N.relative[Se[ut].type];ut++);return ws(vt>1&&_m(ii),vt>1&&Co(Se.slice(0,vt-1).concat({value:Se[vt-2].type===" "?"*":""})).replace(W,"$1"),it,vt<ut&&Es(Se.slice(vt,ut)),ut<be&&Es(Se=Se.slice(ut)),ut<be&&Co(Se))}ii.push(it)}return _m(ii)}function wm(Se,Ve){var it=Ve.length>0,ut=Se.length>0,be=function(je,Fe,vt,Tt,Jt){var ii,Gt,er,si=0,Zi="0",ss=je&&[],Nn=[],as=H,la=je||ut&&N.find.TAG("*",Jt),Ul=at+=as==null?1:Math.random()||.1,Ai=la.length;for(Jt&&(H=Fe==ce||Fe||Jt);Zi!==Ai&&(ii=la[Zi])!=null;Zi++){if(ut&&ii){for(Gt=0,!Fe&&ii.ownerDocument!=ce&&(To(ii),vt=!Pe);er=Se[Gt++];)if(er(ii,Fe||ce,vt)){ne.call(Tt,ii);break}Jt&&(at=Ul)}it&&((ii=!er&&ii)&&si--,je&&ss.push(ii))}if(si+=Zi,it&&Zi!==si){for(Gt=0;er=Ve[Gt++];)er(ss,Nn,Fe,vt);if(je){if(si>0)for(;Zi--;)ss[Zi]||Nn[Zi]||(Nn[Zi]=D.call(Tt));Nn=wf(Nn)}ne.apply(Tt,Nn),Jt&&!je&&Nn.length>0&&si+Ve.length>1&&_.uniqueSort(Tt)}return Jt&&(at=Ul,H=as),ss};return it?_s(be):be}function td(Se,Ve){var it,ut=[],be=[],je=Wi[Se+" "];if(!je){for(Ve||(Ve=hu(Se)),it=Ve.length;it--;)je=Es(Ve[it]),je[bt]?ut.push(je):be.push(je);je=Wi(Se,wm(be,ut)),je.selector=Se}return je}function id(Se,Ve,it,ut){var be,je,Fe,vt,Tt,Jt=typeof Se=="function"&&Se,ii=!ut&&hu(Se=Jt.selector||Se);if(it=it||[],ii.length===1){if(je=ii[0]=ii[0].slice(0),je.length>2&&(Fe=je[0]).type==="ID"&&Ve.nodeType===9&&Pe&&N.relative[je[1].type]){if(Ve=(N.find.ID(Fe.matches[0].replace(al,ol),Ve)||[])[0],Ve)Jt&&(Ve=Ve.parentNode);else return it;Se=Se.slice(je.shift().value.length)}for(be=$a.needsContext.test(Se)?0:je.length;be--&&(Fe=je[be],!N.relative[vt=Fe.type]);)if((Tt=N.find[vt])&&(ut=Tt(Fe.matches[0].replace(al,ol),$h.test(je[0].type)&&ll(Ve.parentNode)||Ve))){if(je.splice(be,1),Se=ut.length&&Co(je),!Se)return ne.apply(it,ut),it;break}}return(Jt||td(Se,ii))(ut,Ve,!Pe,it,!Ve||$h.test(Se)&&ll(Ve.parentNode)||Ve),it}m.sortStable=bt.split("").sort(ln).join("")===bt,To(),m.sortDetached=Bc(function(Se){return Se.compareDocumentPosition(ce.createElement("fieldset"))&1}),_.find=ir,_.expr[":"]=_.expr.pseudos,_.unique=_.uniqueSort,ir.compile=td,ir.select=id,ir.setDocument=To,ir.tokenize=hu,ir.escape=_.escapeSelector,ir.getText=_.text,ir.isXML=_.isXMLDoc,ir.selectors=_.expr,ir.support=_.support,ir.uniqueSort=_.uniqueSort})();var J=function(M,N,H){for(var K=[],re=H!==void 0;(M=M[N])&&M.nodeType!==9;)if(M.nodeType===1){if(re&&_(M).is(H))break;K.push(M)}return K},U=function(M,N){for(var H=[];M;M=M.nextSibling)M.nodeType===1&&M!==N&&H.push(M);return H},ie=_.expr.match.needsContext,se=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function ee(M,N,H){return g(N)?_.grep(M,function(K,re){return!!N.call(K,re,K)!==H}):N.nodeType?_.grep(M,function(K){return K===N!==H}):typeof N!="string"?_.grep(M,function(K){return l.call(N,K)>-1!==H}):_.filter(N,M,H)}_.filter=function(M,N,H){var K=N[0];return H&&(M=":not("+M+")"),N.length===1&&K.nodeType===1?_.find.matchesSelector(K,M)?[K]:[]:_.find.matches(M,_.grep(N,function(re){return re.nodeType===1}))},_.fn.extend({find:function(M){var N,H,K=this.length,re=this;if(typeof M!="string")return this.pushStack(_(M).filter(function(){for(N=0;N<K;N++)if(_.contains(re[N],this))return!0}));for(H=this.pushStack([]),N=0;N<K;N++)_.find(M,re[N],H);return K>1?_.uniqueSort(H):H},filter:function(M){return this.pushStack(ee(this,M||[],!1))},not:function(M){return this.pushStack(ee(this,M||[],!0))},is:function(M){return!!ee(this,typeof M=="string"&&ie.test(M)?_(M):M||[],!1).length}});var ve,_e=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,he=_.fn.init=function(M,N,H){var K,re;if(!M)return this;if(H=H||ve,typeof M=="string")if(M[0]==="<"&&M[M.length-1]===">"&&M.length>=3?K=[null,M,null]:K=_e.exec(M),K&&(K[1]||!N))if(K[1]){if(N=N instanceof _?N[0]:N,_.merge(this,_.parseHTML(K[1],N&&N.nodeType?N.ownerDocument||N:x,!0)),se.test(K[1])&&_.isPlainObject(N))for(K in N)g(this[K])?this[K](N[K]):this.attr(K,N[K]);return this}else return re=x.getElementById(K[2]),re&&(this[0]=re,this.length=1),this;else return!N||N.jquery?(N||H).find(M):this.constructor(N).find(M);else{if(M.nodeType)return this[0]=M,this.length=1,this;if(g(M))return H.ready!==void 0?H.ready(M):M(_)}return _.makeArray(M,this)};he.prototype=_.fn,ve=_(x);var De=/^(?:parents|prev(?:Until|All))/,we={children:!0,contents:!0,next:!0,prev:!0};_.fn.extend({has:function(M){var N=_(M,this),H=N.length;return this.filter(function(){for(var K=0;K<H;K++)if(_.contains(this,N[K]))return!0})},closest:function(M,N){var H,K=0,re=this.length,ne=[],ce=typeof M!="string"&&_(M);if(!ie.test(M)){for(;K<re;K++)for(H=this[K];H&&H!==N;H=H.parentNode)if(H.nodeType<11&&(ce?ce.index(H)>-1:H.nodeType===1&&_.find.matchesSelector(H,M))){ne.push(H);break}}return this.pushStack(ne.length>1?_.uniqueSort(ne):ne)},index:function(M){return M?typeof M=="string"?l.call(_(M),this[0]):l.call(this,M.jquery?M[0]:M):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(M,N){return this.pushStack(_.uniqueSort(_.merge(this.get(),_(M,N))))},addBack:function(M){return this.add(M==null?this.prevObject:this.prevObject.filter(M))}});function Le(M,N){for(;(M=M[N])&&M.nodeType!==1;);return M}_.each({parent:function(M){var N=M.parentNode;return N&&N.nodeType!==11?N:null},parents:function(M){return J(M,"parentNode")},parentsUntil:function(M,N,H){return J(M,"parentNode",H)},next:function(M){return Le(M,"nextSibling")},prev:function(M){return Le(M,"previousSibling")},nextAll:function(M){return J(M,"nextSibling")},prevAll:function(M){return J(M,"previousSibling")},nextUntil:function(M,N,H){return J(M,"nextSibling",H)},prevUntil:function(M,N,H){return J(M,"previousSibling",H)},siblings:function(M){return U((M.parentNode||{}).firstChild,M)},children:function(M){return U(M.firstChild)},contents:function(M){return M.contentDocument!=null&&n(M.contentDocument)?M.contentDocument:(I(M,"template")&&(M=M.content||M),_.merge([],M.childNodes))}},function(M,N){_.fn[M]=function(H,K){var re=_.map(this,N,H);return M.slice(-5)!=="Until"&&(K=H),K&&typeof K=="string"&&(re=_.filter(K,re)),this.length>1&&(we[M]||_.uniqueSort(re),De.test(M)&&re.reverse()),this.pushStack(re)}});var Te=/[^\x20\t\r\n\f]+/g;function ke(M){var N={};return _.each(M.match(Te)||[],function(H,K){N[K]=!0}),N}_.Callbacks=function(M){M=typeof M=="string"?ke(M):_.extend({},M);var N,H,K,re,ne=[],ce=[],Be=-1,Pe=function(){for(re=re||M.once,K=N=!0;ce.length;Be=-1)for(H=ce.shift();++Be<ne.length;)ne[Be].apply(H[0],H[1])===!1&&M.stopOnFalse&&(Be=ne.length,H=!1);M.memory||(H=!1),N=!1,re&&(H?ne=[]:ne="")},Ye={add:function(){return ne&&(H&&!N&&(Be=ne.length-1,ce.push(H)),function ft(bt){_.each(bt,function(at,Nt){g(Nt)?(!M.unique||!Ye.has(Nt))&&ne.push(Nt):Nt&&Nt.length&&C(Nt)!=="string"&&ft(Nt)})}(arguments),H&&!N&&Pe()),this},remove:function(){return _.each(arguments,function(ft,bt){for(var at;(at=_.inArray(bt,ne,at))>-1;)ne.splice(at,1),at<=Be&&Be--}),this},has:function(ft){return ft?_.inArray(ft,ne)>-1:ne.length>0},empty:function(){return ne&&(ne=[]),this},disable:function(){return re=ce=[],ne=H="",this},disabled:function(){return!ne},lock:function(){return re=ce=[],!H&&!N&&(ne=H=""),this},locked:function(){return!!re},fireWith:function(ft,bt){return re||(bt=bt||[],bt=[ft,bt.slice?bt.slice():bt],ce.push(bt),N||Pe()),this},fire:function(){return Ye.fireWith(this,arguments),this},fired:function(){return!!K}};return Ye};function Xe(M){return M}function et(M){throw M}function Ze(M,N,H,K){var re;try{M&&g(re=M.promise)?re.call(M).done(N).fail(H):M&&g(re=M.then)?re.call(M,N,H):N.apply(void 0,[M].slice(K))}catch(ne){H.apply(void 0,[ne])}}_.extend({Deferred:function(M){var N=[["notify","progress",_.Callbacks("memory"),_.Callbacks("memory"),2],["resolve","done",_.Callbacks("once memory"),_.Callbacks("once memory"),0,"resolved"],["reject","fail",_.Callbacks("once memory"),_.Callbacks("once memory"),1,"rejected"]],H="pending",K={state:function(){return H},always:function(){return re.done(arguments).fail(arguments),this},catch:function(ne){return K.then(null,ne)},pipe:function(){var ne=arguments;return _.Deferred(function(ce){_.each(N,function(Be,Pe){var Ye=g(ne[Pe[4]])&&ne[Pe[4]];re[Pe[1]](function(){var ft=Ye&&Ye.apply(this,arguments);ft&&g(ft.promise)?ft.promise().progress(ce.notify).done(ce.resolve).fail(ce.reject):ce[Pe[0]+"With"](this,Ye?[ft]:arguments)})}),ne=null}).promise()},then:function(ne,ce,Be){var Pe=0;function Ye(ft,bt,at,Nt){return function(){var Kt=this,Hi=arguments,Wi=function(){var ln,nl;if(!(ft<Pe)){if(ln=at.apply(Kt,Hi),ln===bt.promise())throw new TypeError("Thenable self-resolution");nl=ln&&(typeof ln=="object"||typeof ln=="function")&&ln.then,g(nl)?Nt?nl.call(ln,Ye(Pe,bt,Xe,Nt),Ye(Pe,bt,et,Nt)):(Pe++,nl.call(ln,Ye(Pe,bt,Xe,Nt),Ye(Pe,bt,et,Nt),Ye(Pe,bt,Xe,bt.notifyWith))):(at!==Xe&&(Kt=void 0,Hi=[ln]),(Nt||bt.resolveWith)(Kt,Hi))}},ns=Nt?Wi:function(){try{Wi()}catch(ln){_.Deferred.exceptionHook&&_.Deferred.exceptionHook(ln,ns.error),ft+1>=Pe&&(at!==et&&(Kt=void 0,Hi=[ln]),bt.rejectWith(Kt,Hi))}};ft?ns():(_.Deferred.getErrorHook?ns.error=_.Deferred.getErrorHook():_.Deferred.getStackHook&&(ns.error=_.Deferred.getStackHook()),t.setTimeout(ns))}}return _.Deferred(function(ft){N[0][3].add(Ye(0,ft,g(Be)?Be:Xe,ft.notifyWith)),N[1][3].add(Ye(0,ft,g(ne)?ne:Xe)),N[2][3].add(Ye(0,ft,g(ce)?ce:et))}).promise()},promise:function(ne){return ne!=null?_.extend(ne,K):K}},re={};return _.each(N,function(ne,ce){var Be=ce[2],Pe=ce[5];K[ce[1]]=Be.add,Pe&&Be.add(function(){H=Pe},N[3-ne][2].disable,N[3-ne][3].disable,N[0][2].lock,N[0][3].lock),Be.add(ce[3].fire),re[ce[0]]=function(){return re[ce[0]+"With"](this===re?void 0:this,arguments),this},re[ce[0]+"With"]=Be.fireWith}),K.promise(re),M&&M.call(re,re),re},when:function(M){var N=arguments.length,H=N,K=Array(H),re=s.call(arguments),ne=_.Deferred(),ce=function(Be){return function(Pe){K[Be]=this,re[Be]=arguments.length>1?s.call(arguments):Pe,--N||ne.resolveWith(K,re)}};if(N<=1&&(Ze(M,ne.done(ce(H)).resolve,ne.reject,!N),ne.state()==="pending"||g(re[H]&&re[H].then)))return ne.then();for(;H--;)Ze(re[H],ce(H),ne.reject);return ne.promise()}});var st=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;_.Deferred.exceptionHook=function(M,N){t.console&&t.console.warn&&M&&st.test(M.name)&&t.console.warn("jQuery.Deferred exception: "+M.message,M.stack,N)},_.readyException=function(M){t.setTimeout(function(){throw M})};var _t=_.Deferred();_.fn.ready=function(M){return _t.then(M).catch(function(N){_.readyException(N)}),this},_.extend({isReady:!1,readyWait:1,ready:function(M){(M===!0?--_.readyWait:_.isReady)||(_.isReady=!0,!(M!==!0&&--_.readyWait>0)&&_t.resolveWith(x,[_]))}}),_.ready.then=_t.then;function St(){x.removeEventListener("DOMContentLoaded",St),t.removeEventListener("load",St),_.ready()}x.readyState==="complete"||x.readyState!=="loading"&&!x.documentElement.doScroll?t.setTimeout(_.ready):(x.addEventListener("DOMContentLoaded",St),t.addEventListener("load",St));var ue=function(M,N,H,K,re,ne,ce){var Be=0,Pe=M.length,Ye=H==null;if(C(H)==="object"){re=!0;for(Be in H)ue(M,N,Be,H[Be],!0,ne,ce)}else if(K!==void 0&&(re=!0,g(K)||(ce=!0),Ye&&(ce?(N.call(M,K),N=null):(Ye=N,N=function(ft,bt,at){return Ye.call(_(ft),at)})),N))for(;Be<Pe;Be++)N(M[Be],H,ce?K:K.call(M[Be],Be,N(M[Be],H)));return re?M:Ye?N.call(M):Pe?N(M[0],H):ne},Ee=/^-ms-/,Ae=/-([a-z])/g;function Ge(M,N){return N.toUpperCase()}function ae(M){return M.replace(Ee,"ms-").replace(Ae,Ge)}var te=function(M){return M.nodeType===1||M.nodeType===9||!+M.nodeType};function Ne(){this.expando=_.expando+Ne.uid++}Ne.uid=1,Ne.prototype={cache:function(M){var N=M[this.expando];return N||(N={},te(M)&&(M.nodeType?M[this.expando]=N:Object.defineProperty(M,this.expando,{value:N,configurable:!0}))),N},set:function(M,N,H){var K,re=this.cache(M);if(typeof N=="string")re[ae(N)]=H;else for(K in N)re[ae(K)]=N[K];return re},get:function(M,N){return N===void 0?this.cache(M):M[this.expando]&&M[this.expando][ae(N)]},access:function(M,N,H){return N===void 0||N&&typeof N=="string"&&H===void 0?this.get(M,N):(this.set(M,N,H),H!==void 0?H:N)},remove:function(M,N){var H,K=M[this.expando];if(K!==void 0){if(N!==void 0)for(Array.isArray(N)?N=N.map(ae):(N=ae(N),N=N in K?[N]:N.match(Te)||[]),H=N.length;H--;)delete K[N[H]];(N===void 0||_.isEmptyObject(K))&&(M.nodeType?M[this.expando]=void 0:delete M[this.expando])}},hasData:function(M){var N=M[this.expando];return N!==void 0&&!_.isEmptyObject(N)}};var Re=new Ne,Y=new Ne,Me=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ke=/[A-Z]/g;function ot(M){return M==="true"?!0:M==="false"?!1:M==="null"?null:M===+M+""?+M:Me.test(M)?JSON.parse(M):M}function qe(M,N,H){var K;if(H===void 0&&M.nodeType===1)if(K="data-"+N.replace(Ke,"-$&").toLowerCase(),H=M.getAttribute(K),typeof H=="string"){try{H=ot(H)}catch{}Y.set(M,N,H)}else H=void 0;return H}_.extend({hasData:function(M){return Y.hasData(M)||Re.hasData(M)},data:function(M,N,H){return Y.access(M,N,H)},removeData:function(M,N){Y.remove(M,N)},_data:function(M,N,H){return Re.access(M,N,H)},_removeData:function(M,N){Re.remove(M,N)}}),_.fn.extend({data:function(M,N){var H,K,re,ne=this[0],ce=ne&&ne.attributes;if(M===void 0){if(this.length&&(re=Y.get(ne),ne.nodeType===1&&!Re.get(ne,"hasDataAttrs"))){for(H=ce.length;H--;)ce[H]&&(K=ce[H].name,K.indexOf("data-")===0&&(K=ae(K.slice(5)),qe(ne,K,re[K])));Re.set(ne,"hasDataAttrs",!0)}return re}return typeof M=="object"?this.each(function(){Y.set(this,M)}):ue(this,function(Be){var Pe;if(ne&&Be===void 0)return Pe=Y.get(ne,M),Pe!==void 0||(Pe=qe(ne,M),Pe!==void 0)?Pe:void 0;this.each(function(){Y.set(this,M,Be)})},null,N,arguments.length>1,null,!0)},removeData:function(M){return this.each(function(){Y.remove(this,M)})}}),_.extend({queue:function(M,N,H){var K;if(M)return N=(N||"fx")+"queue",K=Re.get(M,N),H&&(!K||Array.isArray(H)?K=Re.access(M,N,_.makeArray(H)):K.push(H)),K||[]},dequeue:function(M,N){N=N||"fx";var H=_.queue(M,N),K=H.length,re=H.shift(),ne=_._queueHooks(M,N),ce=function(){_.dequeue(M,N)};re==="inprogress"&&(re=H.shift(),K--),re&&(N==="fx"&&H.unshift("inprogress"),delete ne.stop,re.call(M,ce,ne)),!K&&ne&&ne.empty.fire()},_queueHooks:function(M,N){var H=N+"queueHooks";return Re.get(M,H)||Re.access(M,H,{empty:_.Callbacks("once memory").add(function(){Re.remove(M,[N+"queue",H])})})}}),_.fn.extend({queue:function(M,N){var H=2;return typeof M!="string"&&(N=M,M="fx",H--),arguments.length<H?_.queue(this[0],M):N===void 0?this:this.each(function(){var K=_.queue(this,M,N);_._queueHooks(this,M),M==="fx"&&K[0]!=="inprogress"&&_.dequeue(this,M)})},dequeue:function(M){return this.each(function(){_.dequeue(this,M)})},clearQueue:function(M){return this.queue(M||"fx",[])},promise:function(M,N){var H,K=1,re=_.Deferred(),ne=this,ce=this.length,Be=function(){--K||re.resolveWith(ne,[ne])};for(typeof M!="string"&&(N=M,M=void 0),M=M||"fx";ce--;)H=Re.get(ne[ce],M+"queueHooks"),H&&H.empty&&(K++,H.empty.add(Be));return Be(),re.promise(N)}});var It=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ot=new RegExp("^(?:([+-])=|)("+It+")([a-z%]*)$","i"),Dt=["Top","Right","Bottom","Left"],kt=x.documentElement,Qe=function(M){return _.contains(M.ownerDocument,M)},mt={composed:!0};kt.getRootNode&&(Qe=function(M){return _.contains(M.ownerDocument,M)||M.getRootNode(mt)===M.ownerDocument});var Ht=function(M,N){return M=N||M,M.style.display==="none"||M.style.display===""&&Qe(M)&&_.css(M,"display")==="none"};function Wt(M,N,H,K){var re,ne,ce=20,Be=K?function(){return K.cur()}:function(){return _.css(M,N,"")},Pe=Be(),Ye=H&&H[3]||(_.cssNumber[N]?"":"px"),ft=M.nodeType&&(_.cssNumber[N]||Ye!=="px"&&+Pe)&&Ot.exec(_.css(M,N));if(ft&&ft[3]!==Ye){for(Pe=Pe/2,Ye=Ye||ft[3],ft=+Pe||1;ce--;)_.style(M,N,ft+Ye),(1-ne)*(1-(ne=Be()/Pe||.5))<=0&&(ce=0),ft=ft/ne;ft=ft*2,_.style(M,N,ft+Ye),H=H||[]}return H&&(ft=+ft||+Pe||0,re=H[1]?ft+(H[1]+1)*H[2]:+H[2],K&&(K.unit=Ye,K.start=ft,K.end=re)),re}var Ue={};function dt(M){var N,H=M.ownerDocument,K=M.nodeName,re=Ue[K];return re||(N=H.body.appendChild(H.createElement(K)),re=_.css(N,"display"),N.parentNode.removeChild(N),re==="none"&&(re="block"),Ue[K]=re,re)}function gt(M,N){for(var H,K,re=[],ne=0,ce=M.length;ne<ce;ne++)K=M[ne],K.style&&(H=K.style.display,N?(H==="none"&&(re[ne]=Re.get(K,"display")||null,re[ne]||(K.style.display="")),K.style.display===""&&Ht(K)&&(re[ne]=dt(K))):H!=="none"&&(re[ne]="none",Re.set(K,"display",H)));for(ne=0;ne<ce;ne++)re[ne]!=null&&(M[ne].style.display=re[ne]);return M}_.fn.extend({show:function(){return gt(this,!0)},hide:function(){return gt(this)},toggle:function(M){return typeof M=="boolean"?M?this.show():this.hide():this.each(function(){Ht(this)?_(this).show():_(this).hide()})}});var Bt=/^(?:checkbox|radio)$/i,ei=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,zi=/^$|^module$|\/(?:java|ecma)script/i;(function(){var M=x.createDocumentFragment(),N=M.appendChild(x.createElement("div")),H=x.createElement("input");H.setAttribute("type","radio"),H.setAttribute("checked","checked"),H.setAttribute("name","t"),N.appendChild(H),m.checkClone=N.cloneNode(!0).cloneNode(!0).lastChild.checked,N.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!N.cloneNode(!0).lastChild.defaultValue,N.innerHTML="<option></option>",m.option=!!N.lastChild})();var vi={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};vi.tbody=vi.tfoot=vi.colgroup=vi.caption=vi.thead,vi.th=vi.td,m.option||(vi.optgroup=vi.option=[1,"<select multiple='multiple'>","</select>"]);function Yi(M,N){var H;return typeof M.getElementsByTagName<"u"?H=M.getElementsByTagName(N||"*"):typeof M.querySelectorAll<"u"?H=M.querySelectorAll(N||"*"):H=[],N===void 0||N&&I(M,N)?_.merge([M],H):H}function wn(M,N){for(var H=0,K=M.length;H<K;H++)Re.set(M[H],"globalEval",!N||Re.get(N[H],"globalEval"))}var yr=/<|&#?\w+;/;function Rn(M,N,H,K,re){for(var ne,ce,Be,Pe,Ye,ft,bt=N.createDocumentFragment(),at=[],Nt=0,Kt=M.length;Nt<Kt;Nt++)if(ne=M[Nt],ne||ne===0)if(C(ne)==="object")_.merge(at,ne.nodeType?[ne]:ne);else if(!yr.test(ne))at.push(N.createTextNode(ne));else{for(ce=ce||bt.appendChild(N.createElement("div")),Be=(ei.exec(ne)||["",""])[1].toLowerCase(),Pe=vi[Be]||vi._default,ce.innerHTML=Pe[1]+_.htmlPrefilter(ne)+Pe[2],ft=Pe[0];ft--;)ce=ce.lastChild;_.merge(at,ce.childNodes),ce=bt.firstChild,ce.textContent=""}for(bt.textContent="",Nt=0;ne=at[Nt++];){if(K&&_.inArray(ne,K)>-1){re&&re.push(ne);continue}if(Ye=Qe(ne),ce=Yi(bt.appendChild(ne),"script"),Ye&&wn(ce),H)for(ft=0;ne=ce[ft++];)zi.test(ne.type||"")&&H.push(ne)}return bt}var Yr=/^([^.]*)(?:\.(.+)|)/;function Hn(){return!0}function Jo(){return!1}function Bl(M,N,H,K,re,ne){var ce,Be;if(typeof N=="object"){typeof H!="string"&&(K=K||H,H=void 0);for(Be in N)Bl(M,Be,H,K,N[Be],ne);return M}if(K==null&&re==null?(re=H,K=H=void 0):re==null&&(typeof H=="string"?(re=K,K=void 0):(re=K,K=H,H=void 0)),re===!1)re=Jo;else if(!re)return M;return ne===1&&(ce=re,re=function(Pe){return _().off(Pe),ce.apply(this,arguments)},re.guid=ce.guid||(ce.guid=_.guid++)),M.each(function(){_.event.add(this,N,re,K,H)})}_.event={global:{},add:function(M,N,H,K,re){var ne,ce,Be,Pe,Ye,ft,bt,at,Nt,Kt,Hi,Wi=Re.get(M);if(te(M))for(H.handler&&(ne=H,H=ne.handler,re=ne.selector),re&&_.find.matchesSelector(kt,re),H.guid||(H.guid=_.guid++),(Pe=Wi.events)||(Pe=Wi.events=Object.create(null)),(ce=Wi.handle)||(ce=Wi.handle=function(ns){return typeof _<"u"&&_.event.triggered!==ns.type?_.event.dispatch.apply(M,arguments):void 0}),N=(N||"").match(Te)||[""],Ye=N.length;Ye--;)Be=Yr.exec(N[Ye])||[],Nt=Hi=Be[1],Kt=(Be[2]||"").split(".").sort(),Nt&&(bt=_.event.special[Nt]||{},Nt=(re?bt.delegateType:bt.bindType)||Nt,bt=_.event.special[Nt]||{},ft=_.extend({type:Nt,origType:Hi,data:K,handler:H,guid:H.guid,selector:re,needsContext:re&&_.expr.match.needsContext.test(re),namespace:Kt.join(".")},ne),(at=Pe[Nt])||(at=Pe[Nt]=[],at.delegateCount=0,(!bt.setup||bt.setup.call(M,K,Kt,ce)===!1)&&M.addEventListener&&M.addEventListener(Nt,ce)),bt.add&&(bt.add.call(M,ft),ft.handler.guid||(ft.handler.guid=H.guid)),re?at.splice(at.delegateCount++,0,ft):at.push(ft),_.event.global[Nt]=!0)},remove:function(M,N,H,K,re){var ne,ce,Be,Pe,Ye,ft,bt,at,Nt,Kt,Hi,Wi=Re.hasData(M)&&Re.get(M);if(!(!Wi||!(Pe=Wi.events))){for(N=(N||"").match(Te)||[""],Ye=N.length;Ye--;){if(Be=Yr.exec(N[Ye])||[],Nt=Hi=Be[1],Kt=(Be[2]||"").split(".").sort(),!Nt){for(Nt in Pe)_.event.remove(M,Nt+N[Ye],H,K,!0);continue}for(bt=_.event.special[Nt]||{},Nt=(K?bt.delegateType:bt.bindType)||Nt,at=Pe[Nt]||[],Be=Be[2]&&new RegExp("(^|\\.)"+Kt.join("\\.(?:.*\\.|)")+"(\\.|$)"),ce=ne=at.length;ne--;)ft=at[ne],(re||Hi===ft.origType)&&(!H||H.guid===ft.guid)&&(!Be||Be.test(ft.namespace))&&(!K||K===ft.selector||K==="**"&&ft.selector)&&(at.splice(ne,1),ft.selector&&at.delegateCount--,bt.remove&&bt.remove.call(M,ft));ce&&!at.length&&((!bt.teardown||bt.teardown.call(M,Kt,Wi.handle)===!1)&&_.removeEvent(M,Nt,Wi.handle),delete Pe[Nt])}_.isEmptyObject(Pe)&&Re.remove(M,"handle events")}},dispatch:function(M){var N,H,K,re,ne,ce,Be=new Array(arguments.length),Pe=_.event.fix(M),Ye=(Re.get(this,"events")||Object.create(null))[Pe.type]||[],ft=_.event.special[Pe.type]||{};for(Be[0]=Pe,N=1;N<arguments.length;N++)Be[N]=arguments[N];if(Pe.delegateTarget=this,!(ft.preDispatch&&ft.preDispatch.call(this,Pe)===!1)){for(ce=_.event.handlers.call(this,Pe,Ye),N=0;(re=ce[N++])&&!Pe.isPropagationStopped();)for(Pe.currentTarget=re.elem,H=0;(ne=re.handlers[H++])&&!Pe.isImmediatePropagationStopped();)(!Pe.rnamespace||ne.namespace===!1||Pe.rnamespace.test(ne.namespace))&&(Pe.handleObj=ne,Pe.data=ne.data,K=((_.event.special[ne.origType]||{}).handle||ne.handler).apply(re.elem,Be),K!==void 0&&(Pe.result=K)===!1&&(Pe.preventDefault(),Pe.stopPropagation()));return ft.postDispatch&&ft.postDispatch.call(this,Pe),Pe.result}},handlers:function(M,N){var H,K,re,ne,ce,Be=[],Pe=N.delegateCount,Ye=M.target;if(Pe&&Ye.nodeType&&!(M.type==="click"&&M.button>=1)){for(;Ye!==this;Ye=Ye.parentNode||this)if(Ye.nodeType===1&&!(M.type==="click"&&Ye.disabled===!0)){for(ne=[],ce={},H=0;H<Pe;H++)K=N[H],re=K.selector+" ",ce[re]===void 0&&(ce[re]=K.needsContext?_(re,this).index(Ye)>-1:_.find(re,this,null,[Ye]).length),ce[re]&&ne.push(K);ne.length&&Be.push({elem:Ye,handlers:ne})}}return Ye=this,Pe<N.length&&Be.push({elem:Ye,handlers:N.slice(Pe)}),Be},addProp:function(M,N){Object.defineProperty(_.Event.prototype,M,{enumerable:!0,configurable:!0,get:g(N)?function(){if(this.originalEvent)return N(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[M]},set:function(H){Object.defineProperty(this,M,{enumerable:!0,configurable:!0,writable:!0,value:H})}})},fix:function(M){return M[_.expando]?M:new _.Event(M)},special:{load:{noBubble:!0},click:{setup:function(M){var N=this||M;return Bt.test(N.type)&&N.click&&I(N,"input")&&Ln(N,"click",!0),!1},trigger:function(M){var N=this||M;return Bt.test(N.type)&&N.click&&I(N,"input")&&Ln(N,"click"),!0},_default:function(M){var N=M.target;return Bt.test(N.type)&&N.click&&I(N,"input")&&Re.get(N,"click")||I(N,"a")}},beforeunload:{postDispatch:function(M){M.result!==void 0&&M.originalEvent&&(M.originalEvent.returnValue=M.result)}}}};function Ln(M,N,H){if(!H){Re.get(M,N)===void 0&&_.event.add(M,N,Hn);return}Re.set(M,N,!1),_.event.add(M,N,{namespace:!1,handler:function(K){var re,ne=Re.get(this,N);if(K.isTrigger&1&&this[N]){if(ne)(_.event.special[N]||{}).delegateType&&K.stopPropagation();else if(ne=s.call(arguments),Re.set(this,N,ne),this[N](),re=Re.get(this,N),Re.set(this,N,!1),ne!==re)return K.stopImmediatePropagation(),K.preventDefault(),re}else ne&&(Re.set(this,N,_.event.trigger(ne[0],ne.slice(1),this)),K.stopPropagation(),K.isImmediatePropagationStopped=Hn)}})}_.removeEvent=function(M,N,H){M.removeEventListener&&M.removeEventListener(N,H)},_.Event=function(M,N){if(!(this instanceof _.Event))return new _.Event(M,N);M&&M.type?(this.originalEvent=M,this.type=M.type,this.isDefaultPrevented=M.defaultPrevented||M.defaultPrevented===void 0&&M.returnValue===!1?Hn:Jo,this.target=M.target&&M.target.nodeType===3?M.target.parentNode:M.target,this.currentTarget=M.currentTarget,this.relatedTarget=M.relatedTarget):this.type=M,N&&_.extend(this,N),this.timeStamp=M&&M.timeStamp||Date.now(),this[_.expando]=!0},_.Event.prototype={constructor:_.Event,isDefaultPrevented:Jo,isPropagationStopped:Jo,isImmediatePropagationStopped:Jo,isSimulated:!1,preventDefault:function(){var M=this.originalEvent;this.isDefaultPrevented=Hn,M&&!this.isSimulated&&M.preventDefault()},stopPropagation:function(){var M=this.originalEvent;this.isPropagationStopped=Hn,M&&!this.isSimulated&&M.stopPropagation()},stopImmediatePropagation:function(){var M=this.originalEvent;this.isImmediatePropagationStopped=Hn,M&&!this.isSimulated&&M.stopImmediatePropagation(),this.stopPropagation()}},_.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},_.event.addProp),_.each({focus:"focusin",blur:"focusout"},function(M,N){function H(K){if(x.documentMode){var re=Re.get(this,"handle"),ne=_.event.fix(K);ne.type=K.type==="focusin"?"focus":"blur",ne.isSimulated=!0,re(K),ne.target===ne.currentTarget&&re(ne)}else _.event.simulate(N,K.target,_.event.fix(K))}_.event.special[M]={setup:function(){var K;if(Ln(this,M,!0),x.documentMode)K=Re.get(this,N),K||this.addEventListener(N,H),Re.set(this,N,(K||0)+1);else return!1},trigger:function(){return Ln(this,M),!0},teardown:function(){var K;if(x.documentMode)K=Re.get(this,N)-1,K?Re.set(this,N,K):(this.removeEventListener(N,H),Re.remove(this,N));else return!1},_default:function(K){return Re.get(K.target,M)},delegateType:N},_.event.special[N]={setup:function(){var K=this.ownerDocument||this.document||this,re=x.documentMode?this:K,ne=Re.get(re,N);ne||(x.documentMode?this.addEventListener(N,H):K.addEventListener(M,H,!0)),Re.set(re,N,(ne||0)+1)},teardown:function(){var K=this.ownerDocument||this.document||this,re=x.documentMode?this:K,ne=Re.get(re,N)-1;ne?Re.set(re,N,ne):(x.documentMode?this.removeEventListener(N,H):K.removeEventListener(M,H,!0),Re.remove(re,N))}}}),_.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(M,N){_.event.special[M]={delegateType:N,bindType:N,handle:function(H){var K,re=this,ne=H.relatedTarget,ce=H.handleObj;return(!ne||ne!==re&&!_.contains(re,ne))&&(H.type=ce.origType,K=ce.handler.apply(this,arguments),H.type=N),K}}}),_.fn.extend({on:function(M,N,H,K){return Bl(this,M,N,H,K)},one:function(M,N,H,K){return Bl(this,M,N,H,K,1)},off:function(M,N,H){var K,re;if(M&&M.preventDefault&&M.handleObj)return K=M.handleObj,_(M.delegateTarget).off(K.namespace?K.origType+"."+K.namespace:K.origType,K.selector,K.handler),this;if(typeof M=="object"){for(re in M)this.off(re,N,M[re]);return this}return(N===!1||typeof N=="function")&&(H=N,N=void 0),H===!1&&(H=Jo),this.each(function(){_.event.remove(this,M,H,N)})}});var me=/<script|<style|<link/i,lt=/checked\s*(?:[^=]|=\s*.checked.)/i,pt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function tt(M,N){return I(M,"table")&&I(N.nodeType!==11?N:N.firstChild,"tr")&&_(M).children("tbody")[0]||M}function xt(M){return M.type=(M.getAttribute("type")!==null)+"/"+M.type,M}function Qt(M){return(M.type||"").slice(0,5)==="true/"?M.type=M.type.slice(5):M.removeAttribute("type"),M}function hi(M,N){var H,K,re,ne,ce,Be,Pe;if(N.nodeType===1){if(Re.hasData(M)&&(ne=Re.get(M),Pe=ne.events,Pe)){Re.remove(N,"handle events");for(re in Pe)for(H=0,K=Pe[re].length;H<K;H++)_.event.add(N,re,Pe[re][H])}Y.hasData(M)&&(ce=Y.access(M),Be=_.extend({},ce),Y.set(N,Be))}}function ui(M,N){var H=N.nodeName.toLowerCase();H==="input"&&Bt.test(M.type)?N.checked=M.checked:(H==="input"||H==="textarea")&&(N.defaultValue=M.defaultValue)}function ri(M,N,H,K){N=a(N);var re,ne,ce,Be,Pe,Ye,ft=0,bt=M.length,at=bt-1,Nt=N[0],Kt=g(Nt);if(Kt||bt>1&&typeof Nt=="string"&&!m.checkClone&&lt.test(Nt))return M.each(function(Hi){var Wi=M.eq(Hi);Kt&&(N[0]=Nt.call(this,Hi,Wi.html())),ri(Wi,N,H,K)});if(bt&&(re=Rn(N,M[0].ownerDocument,!1,M,K),ne=re.firstChild,re.childNodes.length===1&&(re=ne),ne||K)){for(ce=_.map(Yi(re,"script"),xt),Be=ce.length;ft<bt;ft++)Pe=re,ft!==at&&(Pe=_.clone(Pe,!0,!0),Be&&_.merge(ce,Yi(Pe,"script"))),H.call(M[ft],Pe,ft);if(Be)for(Ye=ce[ce.length-1].ownerDocument,_.map(ce,Qt),ft=0;ft<Be;ft++)Pe=ce[ft],zi.test(Pe.type||"")&&!Re.access(Pe,"globalEval")&&_.contains(Ye,Pe)&&(Pe.src&&(Pe.type||"").toLowerCase()!=="module"?_._evalUrl&&!Pe.noModule&&_._evalUrl(Pe.src,{nonce:Pe.nonce||Pe.getAttribute("nonce")},Ye):b(Pe.textContent.replace(pt,""),Pe,Ye))}return M}function dr(M,N,H){for(var K,re=N?_.filter(N,M):M,ne=0;(K=re[ne])!=null;ne++)!H&&K.nodeType===1&&_.cleanData(Yi(K)),K.parentNode&&(H&&Qe(K)&&wn(Yi(K,"script")),K.parentNode.removeChild(K));return M}_.extend({htmlPrefilter:function(M){return M},clone:function(M,N,H){var K,re,ne,ce,Be=M.cloneNode(!0),Pe=Qe(M);if(!m.noCloneChecked&&(M.nodeType===1||M.nodeType===11)&&!_.isXMLDoc(M))for(ce=Yi(Be),ne=Yi(M),K=0,re=ne.length;K<re;K++)ui(ne[K],ce[K]);if(N)if(H)for(ne=ne||Yi(M),ce=ce||Yi(Be),K=0,re=ne.length;K<re;K++)hi(ne[K],ce[K]);else hi(M,Be);return ce=Yi(Be,"script"),ce.length>0&&wn(ce,!Pe&&Yi(M,"script")),Be},cleanData:function(M){for(var N,H,K,re=_.event.special,ne=0;(H=M[ne])!==void 0;ne++)if(te(H)){if(N=H[Re.expando]){if(N.events)for(K in N.events)re[K]?_.event.remove(H,K):_.removeEvent(H,K,N.handle);H[Re.expando]=void 0}H[Y.expando]&&(H[Y.expando]=void 0)}}}),_.fn.extend({detach:function(M){return dr(this,M,!0)},remove:function(M){return dr(this,M)},text:function(M){return ue(this,function(N){return N===void 0?_.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=N)})},null,M,arguments.length)},append:function(){return ri(this,arguments,function(M){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var N=tt(this,M);N.appendChild(M)}})},prepend:function(){return ri(this,arguments,function(M){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var N=tt(this,M);N.insertBefore(M,N.firstChild)}})},before:function(){return ri(this,arguments,function(M){this.parentNode&&this.parentNode.insertBefore(M,this)})},after:function(){return ri(this,arguments,function(M){this.parentNode&&this.parentNode.insertBefore(M,this.nextSibling)})},empty:function(){for(var M,N=0;(M=this[N])!=null;N++)M.nodeType===1&&(_.cleanData(Yi(M,!1)),M.textContent="");return this},clone:function(M,N){return M=M??!1,N=N??M,this.map(function(){return _.clone(this,M,N)})},html:function(M){return ue(this,function(N){var H=this[0]||{},K=0,re=this.length;if(N===void 0&&H.nodeType===1)return H.innerHTML;if(typeof N=="string"&&!me.test(N)&&!vi[(ei.exec(N)||["",""])[1].toLowerCase()]){N=_.htmlPrefilter(N);try{for(;K<re;K++)H=this[K]||{},H.nodeType===1&&(_.cleanData(Yi(H,!1)),H.innerHTML=N);H=0}catch{}}H&&this.empty().append(N)},null,M,arguments.length)},replaceWith:function(){var M=[];return ri(this,arguments,function(N){var H=this.parentNode;_.inArray(this,M)<0&&(_.cleanData(Yi(this)),H&&H.replaceChild(N,this))},M)}}),_.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(M,N){_.fn[M]=function(H){for(var K,re=[],ne=_(H),ce=ne.length-1,Be=0;Be<=ce;Be++)K=Be===ce?this:this.clone(!0),_(ne[Be])[N](K),o.apply(re,K.get());return this.pushStack(re)}});var Li=new RegExp("^("+It+")(?!px)[a-z%]+$","i"),Ni=/^--/,bi=function(M){var N=M.ownerDocument.defaultView;return(!N||!N.opener)&&(N=t),N.getComputedStyle(M)},on=function(M,N,H){var K,re,ne={};for(re in N)ne[re]=M.style[re],M.style[re]=N[re];K=H.call(M);for(re in N)M.style[re]=ne[re];return K},is=new RegExp(Dt.join("|"),"i");(function(){function M(){if(Ye){Pe.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Ye.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",kt.appendChild(Pe).appendChild(Ye);var ft=t.getComputedStyle(Ye);H=ft.top!=="1%",Be=N(ft.marginLeft)===12,Ye.style.right="60%",ne=N(ft.right)===36,K=N(ft.width)===36,Ye.style.position="absolute",re=N(Ye.offsetWidth/3)===12,kt.removeChild(Pe),Ye=null}}function N(ft){return Math.round(parseFloat(ft))}var H,K,re,ne,ce,Be,Pe=x.createElement("div"),Ye=x.createElement("div");Ye.style&&(Ye.style.backgroundClip="content-box",Ye.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle=Ye.style.backgroundClip==="content-box",_.extend(m,{boxSizingReliable:function(){return M(),K},pixelBoxStyles:function(){return M(),ne},pixelPosition:function(){return M(),H},reliableMarginLeft:function(){return M(),Be},scrollboxSize:function(){return M(),re},reliableTrDimensions:function(){var ft,bt,at,Nt;return ce==null&&(ft=x.createElement("table"),bt=x.createElement("tr"),at=x.createElement("div"),ft.style.cssText="position:absolute;left:-11111px;border-collapse:separate",bt.style.cssText="box-sizing:content-box;border:1px solid",bt.style.height="1px",at.style.height="9px",at.style.display="block",kt.appendChild(ft).appendChild(bt).appendChild(at),Nt=t.getComputedStyle(bt),ce=parseInt(Nt.height,10)+parseInt(Nt.borderTopWidth,10)+parseInt(Nt.borderBottomWidth,10)===bt.offsetHeight,kt.removeChild(ft)),ce}}))})();function Wn(M,N,H){var K,re,ne,ce,Be=Ni.test(N),Pe=M.style;return H=H||bi(M),H&&(ce=H.getPropertyValue(N)||H[N],Be&&ce&&(ce=ce.replace(W,"$1")||void 0),ce===""&&!Qe(M)&&(ce=_.style(M,N)),!m.pixelBoxStyles()&&Li.test(ce)&&is.test(N)&&(K=Pe.width,re=Pe.minWidth,ne=Pe.maxWidth,Pe.minWidth=Pe.maxWidth=Pe.width=ce,ce=H.width,Pe.width=K,Pe.minWidth=re,Pe.maxWidth=ne)),ce!==void 0?ce+"":ce}function Lr(M,N){return{get:function(){if(M()){delete this.get;return}return(this.get=N).apply(this,arguments)}}}var Xi=["Webkit","Moz","ms"],ia=x.createElement("div").style,Fi={};function Ya(M){for(var N=M[0].toUpperCase()+M.slice(1),H=Xi.length;H--;)if(M=Xi[H]+N,M in ia)return M}function ra(M){var N=_.cssProps[M]||Fi[M];return N||(M in ia?M:Fi[M]=Ya(M)||M)}var ks=/^(none|table(?!-c[ea]).+)/,Aa={position:"absolute",visibility:"hidden",display:"block"},le={letterSpacing:"0",fontWeight:"400"};function pe(M,N,H){var K=Ot.exec(N);return K?Math.max(0,K[2]-(H||0))+(K[3]||"px"):N}function Ce(M,N,H,K,re,ne){var ce=N==="width"?1:0,Be=0,Pe=0,Ye=0;if(H===(K?"border":"content"))return 0;for(;ce<4;ce+=2)H==="margin"&&(Ye+=_.css(M,H+Dt[ce],!0,re)),K?(H==="content"&&(Pe-=_.css(M,"padding"+Dt[ce],!0,re)),H!=="margin"&&(Pe-=_.css(M,"border"+Dt[ce]+"Width",!0,re))):(Pe+=_.css(M,"padding"+Dt[ce],!0,re),H!=="padding"?Pe+=_.css(M,"border"+Dt[ce]+"Width",!0,re):Be+=_.css(M,"border"+Dt[ce]+"Width",!0,re));return!K&&ne>=0&&(Pe+=Math.max(0,Math.ceil(M["offset"+N[0].toUpperCase()+N.slice(1)]-ne-Pe-Be-.5))||0),Pe+Ye}function ye(M,N,H){var K=bi(M),re=!m.boxSizingReliable()||H,ne=re&&_.css(M,"boxSizing",!1,K)==="border-box",ce=ne,Be=Wn(M,N,K),Pe="offset"+N[0].toUpperCase()+N.slice(1);if(Li.test(Be)){if(!H)return Be;Be="auto"}return(!m.boxSizingReliable()&&ne||!m.reliableTrDimensions()&&I(M,"tr")||Be==="auto"||!parseFloat(Be)&&_.css(M,"display",!1,K)==="inline")&&M.getClientRects().length&&(ne=_.css(M,"boxSizing",!1,K)==="border-box",ce=Pe in M,ce&&(Be=M[Pe])),Be=parseFloat(Be)||0,Be+Ce(M,N,H||(ne?"border":"content"),ce,K,Be)+"px"}_.extend({cssHooks:{opacity:{get:function(M,N){if(N){var H=Wn(M,"opacity");return H===""?"1":H}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(M,N,H,K){if(!(!M||M.nodeType===3||M.nodeType===8||!M.style)){var re,ne,ce,Be=ae(N),Pe=Ni.test(N),Ye=M.style;if(Pe||(N=ra(Be)),ce=_.cssHooks[N]||_.cssHooks[Be],H!==void 0){if(ne=typeof H,ne==="string"&&(re=Ot.exec(H))&&re[1]&&(H=Wt(M,N,re),ne="number"),H==null||H!==H)return;ne==="number"&&!Pe&&(H+=re&&re[3]||(_.cssNumber[Be]?"":"px")),!m.clearCloneStyle&&H===""&&N.indexOf("background")===0&&(Ye[N]="inherit"),(!ce||!("set"in ce)||(H=ce.set(M,H,K))!==void 0)&&(Pe?Ye.setProperty(N,H):Ye[N]=H)}else return ce&&"get"in ce&&(re=ce.get(M,!1,K))!==void 0?re:Ye[N]}},css:function(M,N,H,K){var re,ne,ce,Be=ae(N),Pe=Ni.test(N);return Pe||(N=ra(Be)),ce=_.cssHooks[N]||_.cssHooks[Be],ce&&"get"in ce&&(re=ce.get(M,!0,H)),re===void 0&&(re=Wn(M,N,K)),re==="normal"&&N in le&&(re=le[N]),H===""||H?(ne=parseFloat(re),H===!0||isFinite(ne)?ne||0:re):re}}),_.each(["height","width"],function(M,N){_.cssHooks[N]={get:function(H,K,re){if(K)return ks.test(_.css(H,"display"))&&(!H.getClientRects().length||!H.getBoundingClientRect().width)?on(H,Aa,function(){return ye(H,N,re)}):ye(H,N,re)},set:function(H,K,re){var ne,ce=bi(H),Be=!m.scrollboxSize()&&ce.position==="absolute",Pe=Be||re,Ye=Pe&&_.css(H,"boxSizing",!1,ce)==="border-box",ft=re?Ce(H,N,re,Ye,ce):0;return Ye&&Be&&(ft-=Math.ceil(H["offset"+N[0].toUpperCase()+N.slice(1)]-parseFloat(ce[N])-Ce(H,N,"border",!1,ce)-.5)),ft&&(ne=Ot.exec(K))&&(ne[3]||"px")!=="px"&&(H.style[N]=K,K=_.css(H,N)),pe(H,K,ft)}}}),_.cssHooks.marginLeft=Lr(m.reliableMarginLeft,function(M,N){if(N)return(parseFloat(Wn(M,"marginLeft"))||M.getBoundingClientRect().left-on(M,{marginLeft:0},function(){return M.getBoundingClientRect().left}))+"px"}),_.each({margin:"",padding:"",border:"Width"},function(M,N){_.cssHooks[M+N]={expand:function(H){for(var K=0,re={},ne=typeof H=="string"?H.split(" "):[H];K<4;K++)re[M+Dt[K]+N]=ne[K]||ne[K-2]||ne[0];return re}},M!=="margin"&&(_.cssHooks[M+N].set=pe)}),_.fn.extend({css:function(M,N){return ue(this,function(H,K,re){var ne,ce,Be={},Pe=0;if(Array.isArray(K)){for(ne=bi(H),ce=K.length;Pe<ce;Pe++)Be[K[Pe]]=_.css(H,K[Pe],!1,ne);return Be}return re!==void 0?_.style(H,K,re):_.css(H,K)},M,N,arguments.length>1)}});function We(M,N,H,K,re){return new We.prototype.init(M,N,H,K,re)}_.Tween=We,We.prototype={constructor:We,init:function(M,N,H,K,re,ne){this.elem=M,this.prop=H,this.easing=re||_.easing._default,this.options=N,this.start=this.now=this.cur(),this.end=K,this.unit=ne||(_.cssNumber[H]?"":"px")},cur:function(){var M=We.propHooks[this.prop];return M&&M.get?M.get(this):We.propHooks._default.get(this)},run:function(M){var N,H=We.propHooks[this.prop];return this.options.duration?this.pos=N=_.easing[this.easing](M,this.options.duration*M,0,1,this.options.duration):this.pos=N=M,this.now=(this.end-this.start)*N+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),H&&H.set?H.set(this):We.propHooks._default.set(this),this}},We.prototype.init.prototype=We.prototype,We.propHooks={_default:{get:function(M){var N;return M.elem.nodeType!==1||M.elem[M.prop]!=null&&M.elem.style[M.prop]==null?M.elem[M.prop]:(N=_.css(M.elem,M.prop,""),!N||N==="auto"?0:N)},set:function(M){_.fx.step[M.prop]?_.fx.step[M.prop](M):M.elem.nodeType===1&&(_.cssHooks[M.prop]||M.elem.style[ra(M.prop)]!=null)?_.style(M.elem,M.prop,M.now+M.unit):M.elem[M.prop]=M.now}}},We.propHooks.scrollTop=We.propHooks.scrollLeft={set:function(M){M.elem.nodeType&&M.elem.parentNode&&(M.elem[M.prop]=M.now)}},_.easing={linear:function(M){return M},swing:function(M){return .5-Math.cos(M*Math.PI)/2},_default:"swing"},_.fx=We.prototype.init,_.fx.step={};var Ct,En,Wu=/^(?:toggle|show|hide)$/,Di=/queueHooks$/;function Dr(){En&&(x.hidden===!1&&t.requestAnimationFrame?t.requestAnimationFrame(Dr):t.setTimeout(Dr,_.fx.interval),_.fx.tick())}function el(){return t.setTimeout(function(){Ct=void 0}),Ct=Date.now()}function _o(M,N){var H,K=0,re={height:M};for(N=N?1:0;K<4;K+=2-N)H=Dt[K],re["margin"+H]=re["padding"+H]=M;return N&&(re.opacity=re.width=M),re}function na(M,N,H){for(var K,re=(rs.tweeners[N]||[]).concat(rs.tweeners["*"]),ne=0,ce=re.length;ne<ce;ne++)if(K=re[ne].call(H,N,M))return K}function bv(M,N,H){var K,re,ne,ce,Be,Pe,Ye,ft,bt="width"in N||"height"in N,at=this,Nt={},Kt=M.style,Hi=M.nodeType&&Ht(M),Wi=Re.get(M,"fxshow");H.queue||(ce=_._queueHooks(M,"fx"),ce.unqueued==null&&(ce.unqueued=0,Be=ce.empty.fire,ce.empty.fire=function(){ce.unqueued||Be()}),ce.unqueued++,at.always(function(){at.always(function(){ce.unqueued--,_.queue(M,"fx").length||ce.empty.fire()})}));for(K in N)if(re=N[K],Wu.test(re)){if(delete N[K],ne=ne||re==="toggle",re===(Hi?"hide":"show"))if(re==="show"&&Wi&&Wi[K]!==void 0)Hi=!0;else continue;Nt[K]=Wi&&Wi[K]||_.style(M,K)}if(Pe=!_.isEmptyObject(N),!(!Pe&&_.isEmptyObject(Nt))){bt&&M.nodeType===1&&(H.overflow=[Kt.overflow,Kt.overflowX,Kt.overflowY],Ye=Wi&&Wi.display,Ye==null&&(Ye=Re.get(M,"display")),ft=_.css(M,"display"),ft==="none"&&(Ye?ft=Ye:(gt([M],!0),Ye=M.style.display||Ye,ft=_.css(M,"display"),gt([M]))),(ft==="inline"||ft==="inline-block"&&Ye!=null)&&_.css(M,"float")==="none"&&(Pe||(at.done(function(){Kt.display=Ye}),Ye==null&&(ft=Kt.display,Ye=ft==="none"?"":ft)),Kt.display="inline-block")),H.overflow&&(Kt.overflow="hidden",at.always(function(){Kt.overflow=H.overflow[0],Kt.overflowX=H.overflow[1],Kt.overflowY=H.overflow[2]})),Pe=!1;for(K in Nt)Pe||(Wi?"hidden"in Wi&&(Hi=Wi.hidden):Wi=Re.access(M,"fxshow",{display:Ye}),ne&&(Wi.hidden=!Hi),Hi&&gt([M],!0),at.done(function(){Hi||gt([M]),Re.remove(M,"fxshow");for(K in Nt)_.style(M,K,Nt[K])})),Pe=na(Hi?Wi[K]:0,K,at),K in Wi||(Wi[K]=Pe.start,Hi&&(Pe.end=Pe.start,Pe.start=0))}}function Nc(M,N){var H,K,re,ne,ce;for(H in M)if(K=ae(H),re=N[K],ne=M[H],Array.isArray(ne)&&(re=ne[1],ne=M[H]=ne[0]),H!==K&&(M[K]=ne,delete M[H]),ce=_.cssHooks[K],ce&&"expand"in ce){ne=ce.expand(ne),delete M[K];for(H in ne)H in M||(M[H]=ne[H],N[H]=re)}else N[K]=re}function rs(M,N,H){var K,re,ne=0,ce=rs.prefilters.length,Be=_.Deferred().always(function(){delete Pe.elem}),Pe=function(){if(re)return!1;for(var bt=Ct||el(),at=Math.max(0,Ye.startTime+Ye.duration-bt),Nt=at/Ye.duration||0,Kt=1-Nt,Hi=0,Wi=Ye.tweens.length;Hi<Wi;Hi++)Ye.tweens[Hi].run(Kt);return Be.notifyWith(M,[Ye,Kt,at]),Kt<1&&Wi?at:(Wi||Be.notifyWith(M,[Ye,1,0]),Be.resolveWith(M,[Ye]),!1)},Ye=Be.promise({elem:M,props:_.extend({},N),opts:_.extend(!0,{specialEasing:{},easing:_.easing._default},H),originalProperties:N,originalOptions:H,startTime:Ct||el(),duration:H.duration,tweens:[],createTween:function(bt,at){var Nt=_.Tween(M,Ye.opts,bt,at,Ye.opts.specialEasing[bt]||Ye.opts.easing);return Ye.tweens.push(Nt),Nt},stop:function(bt){var at=0,Nt=bt?Ye.tweens.length:0;if(re)return this;for(re=!0;at<Nt;at++)Ye.tweens[at].run(1);return bt?(Be.notifyWith(M,[Ye,1,0]),Be.resolveWith(M,[Ye,bt])):Be.rejectWith(M,[Ye,bt]),this}}),ft=Ye.props;for(Nc(ft,Ye.opts.specialEasing);ne<ce;ne++)if(K=rs.prefilters[ne].call(Ye,M,ft,Ye.opts),K)return g(K.stop)&&(_._queueHooks(Ye.elem,Ye.opts.queue).stop=K.stop.bind(K)),K;return _.map(ft,na,Ye),g(Ye.opts.start)&&Ye.opts.start.call(M,Ye),Ye.progress(Ye.opts.progress).done(Ye.opts.done,Ye.opts.complete).fail(Ye.opts.fail).always(Ye.opts.always),_.fx.timer(_.extend(Pe,{elem:M,anim:Ye,queue:Ye.opts.queue})),Ye}_.Animation=_.extend(rs,{tweeners:{"*":[function(M,N){var H=this.createTween(M,N);return Wt(H.elem,M,Ot.exec(N),H),H}]},tweener:function(M,N){g(M)?(N=M,M=["*"]):M=M.match(Te);for(var H,K=0,re=M.length;K<re;K++)H=M[K],rs.tweeners[H]=rs.tweeners[H]||[],rs.tweeners[H].unshift(N)},prefilters:[bv],prefilter:function(M,N){N?rs.prefilters.unshift(M):rs.prefilters.push(M)}}),_.speed=function(M,N,H){var K=M&&typeof M=="object"?_.extend({},M):{complete:H||!H&&N||g(M)&&M,duration:M,easing:H&&N||N&&!g(N)&&N};return _.fx.off?K.duration=0:typeof K.duration!="number"&&(K.duration in _.fx.speeds?K.duration=_.fx.speeds[K.duration]:K.duration=_.fx.speeds._default),(K.queue==null||K.queue===!0)&&(K.queue="fx"),K.old=K.complete,K.complete=function(){g(K.old)&&K.old.call(this),K.queue&&_.dequeue(this,K.queue)},K},_.fn.extend({fadeTo:function(M,N,H,K){return this.filter(Ht).css("opacity",0).show().end().animate({opacity:N},M,H,K)},animate:function(M,N,H,K){var re=_.isEmptyObject(M),ne=_.speed(N,H,K),ce=function(){var Be=rs(this,_.extend({},M),ne);(re||Re.get(this,"finish"))&&Be.stop(!0)};return ce.finish=ce,re||ne.queue===!1?this.each(ce):this.queue(ne.queue,ce)},stop:function(M,N,H){var K=function(re){var ne=re.stop;delete re.stop,ne(H)};return typeof M!="string"&&(H=N,N=M,M=void 0),N&&this.queue(M||"fx",[]),this.each(function(){var re=!0,ne=M!=null&&M+"queueHooks",ce=_.timers,Be=Re.get(this);if(ne)Be[ne]&&Be[ne].stop&&K(Be[ne]);else for(ne in Be)Be[ne]&&Be[ne].stop&&Di.test(ne)&&K(Be[ne]);for(ne=ce.length;ne--;)ce[ne].elem===this&&(M==null||ce[ne].queue===M)&&(ce[ne].anim.stop(H),re=!1,ce.splice(ne,1));(re||!H)&&_.dequeue(this,M)})},finish:function(M){return M!==!1&&(M=M||"fx"),this.each(function(){var N,H=Re.get(this),K=H[M+"queue"],re=H[M+"queueHooks"],ne=_.timers,ce=K?K.length:0;for(H.finish=!0,_.queue(this,M,[]),re&&re.stop&&re.stop.call(this,!0),N=ne.length;N--;)ne[N].elem===this&&ne[N].queue===M&&(ne[N].anim.stop(!0),ne.splice(N,1));for(N=0;N<ce;N++)K[N]&&K[N].finish&&K[N].finish.call(this);delete H.finish})}}),_.each(["toggle","show","hide"],function(M,N){var H=_.fn[N];_.fn[N]=function(K,re,ne){return K==null||typeof K=="boolean"?H.apply(this,arguments):this.animate(_o(N,!0),K,re,ne)}}),_.each({slideDown:_o("show"),slideUp:_o("hide"),slideToggle:_o("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(M,N){_.fn[M]=function(H,K,re){return this.animate(N,H,K,re)}}),_.timers=[],_.fx.tick=function(){var M,N=0,H=_.timers;for(Ct=Date.now();N<H.length;N++)M=H[N],!M()&&H[N]===M&&H.splice(N--,1);H.length||_.fx.stop(),Ct=void 0},_.fx.timer=function(M){_.timers.push(M),_.fx.start()},_.fx.interval=13,_.fx.start=function(){En||(En=!0,Dr())},_.fx.stop=function(){En=null},_.fx.speeds={slow:600,fast:200,_default:400},_.fn.delay=function(M,N){return M=_.fx&&_.fx.speeds[M]||M,N=N||"fx",this.queue(N,function(H,K){var re=t.setTimeout(H,M);K.stop=function(){t.clearTimeout(re)}})},function(){var M=x.createElement("input"),N=x.createElement("select"),H=N.appendChild(x.createElement("option"));M.type="checkbox",m.checkOn=M.value!=="",m.optSelected=H.selected,M=x.createElement("input"),M.value="t",M.type="radio",m.radioValue=M.value==="t"}();var pn,Ma=_.expr.attrHandle;_.fn.extend({attr:function(M,N){return ue(this,_.attr,M,N,arguments.length>1)},removeAttr:function(M){return this.each(function(){_.removeAttr(this,M)})}}),_.extend({attr:function(M,N,H){var K,re,ne=M.nodeType;if(!(ne===3||ne===8||ne===2)){if(typeof M.getAttribute>"u")return _.prop(M,N,H);if((ne!==1||!_.isXMLDoc(M))&&(re=_.attrHooks[N.toLowerCase()]||(_.expr.match.bool.test(N)?pn:void 0)),H!==void 0){if(H===null){_.removeAttr(M,N);return}return re&&"set"in re&&(K=re.set(M,H,N))!==void 0?K:(M.setAttribute(N,H+""),H)}return re&&"get"in re&&(K=re.get(M,N))!==null?K:(K=_.find.attr(M,N),K??void 0)}},attrHooks:{type:{set:function(M,N){if(!m.radioValue&&N==="radio"&&I(M,"input")){var H=M.value;return M.setAttribute("type",N),H&&(M.value=H),N}}}},removeAttr:function(M,N){var H,K=0,re=N&&N.match(Te);if(re&&M.nodeType===1)for(;H=re[K++];)M.removeAttribute(H)}}),pn={set:function(M,N,H){return N===!1?_.removeAttr(M,H):M.setAttribute(H,H),H}},_.each(_.expr.match.bool.source.match(/\w+/g),function(M,N){var H=Ma[N]||_.find.attr;Ma[N]=function(K,re,ne){var ce,Be,Pe=re.toLowerCase();return ne||(Be=Ma[Pe],Ma[Pe]=ce,ce=H(K,re,ne)!=null?Pe:null,Ma[Pe]=Be),ce}});var Gu=/^(?:input|select|textarea|button)$/i,tl=/^(?:a|area)$/i;_.fn.extend({prop:function(M,N){return ue(this,_.prop,M,N,arguments.length>1)},removeProp:function(M){return this.each(function(){delete this[_.propFix[M]||M]})}}),_.extend({prop:function(M,N,H){var K,re,ne=M.nodeType;if(!(ne===3||ne===8||ne===2))return(ne!==1||!_.isXMLDoc(M))&&(N=_.propFix[N]||N,re=_.propHooks[N]),H!==void 0?re&&"set"in re&&(K=re.set(M,H,N))!==void 0?K:M[N]=H:re&&"get"in re&&(K=re.get(M,N))!==null?K:M[N]},propHooks:{tabIndex:{get:function(M){var N=_.find.attr(M,"tabindex");return N?parseInt(N,10):Gu.test(M.nodeName)||tl.test(M.nodeName)&&M.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(_.propHooks.selected={get:function(M){var N=M.parentNode;return N&&N.parentNode&&N.parentNode.selectedIndex,null},set:function(M){var N=M.parentNode;N&&(N.selectedIndex,N.parentNode&&N.parentNode.selectedIndex)}}),_.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_.propFix[this.toLowerCase()]=this});function il(M){var N=M.match(Te)||[];return N.join(" ")}function Xa(M){return M.getAttribute&&M.getAttribute("class")||""}function Wh(M){return Array.isArray(M)?M:typeof M=="string"?M.match(Te)||[]:[]}_.fn.extend({addClass:function(M){var N,H,K,re,ne,ce;return g(M)?this.each(function(Be){_(this).addClass(M.call(this,Be,Xa(this)))}):(N=Wh(M),N.length?this.each(function(){if(K=Xa(this),H=this.nodeType===1&&" "+il(K)+" ",H){for(ne=0;ne<N.length;ne++)re=N[ne],H.indexOf(" "+re+" ")<0&&(H+=re+" ");ce=il(H),K!==ce&&this.setAttribute("class",ce)}}):this)},removeClass:function(M){var N,H,K,re,ne,ce;return g(M)?this.each(function(Be){_(this).removeClass(M.call(this,Be,Xa(this)))}):arguments.length?(N=Wh(M),N.length?this.each(function(){if(K=Xa(this),H=this.nodeType===1&&" "+il(K)+" ",H){for(ne=0;ne<N.length;ne++)for(re=N[ne];H.indexOf(" "+re+" ")>-1;)H=H.replace(" "+re+" "," ");ce=il(H),K!==ce&&this.setAttribute("class",ce)}}):this):this.attr("class","")},toggleClass:function(M,N){var H,K,re,ne,ce=typeof M,Be=ce==="string"||Array.isArray(M);return g(M)?this.each(function(Pe){_(this).toggleClass(M.call(this,Pe,Xa(this),N),N)}):typeof N=="boolean"&&Be?N?this.addClass(M):this.removeClass(M):(H=Wh(M),this.each(function(){if(Be)for(ne=_(this),re=0;re<H.length;re++)K=H[re],ne.hasClass(K)?ne.removeClass(K):ne.addClass(K);else(M===void 0||ce==="boolean")&&(K=Xa(this),K&&Re.set(this,"__className__",K),this.setAttribute&&this.setAttribute("class",K||M===!1?"":Re.get(this,"__className__")||""))}))},hasClass:function(M){var N,H,K=0;for(N=" "+M+" ";H=this[K++];)if(H.nodeType===1&&(" "+il(Xa(H))+" ").indexOf(N)>-1)return!0;return!1}});var xf=/\r/g;_.fn.extend({val:function(M){var N,H,K,re=this[0];return arguments.length?(K=g(M),this.each(function(ne){var ce;this.nodeType===1&&(K?ce=M.call(this,ne,_(this).val()):ce=M,ce==null?ce="":typeof ce=="number"?ce+="":Array.isArray(ce)&&(ce=_.map(ce,function(Be){return Be==null?"":Be+""})),N=_.valHooks[this.type]||_.valHooks[this.nodeName.toLowerCase()],(!N||!("set"in N)||N.set(this,ce,"value")===void 0)&&(this.value=ce))})):re?(N=_.valHooks[re.type]||_.valHooks[re.nodeName.toLowerCase()],N&&"get"in N&&(H=N.get(re,"value"))!==void 0?H:(H=re.value,typeof H=="string"?H.replace(xf,""):H??"")):void 0}}),_.extend({valHooks:{option:{get:function(M){var N=_.find.attr(M,"value");return N??il(_.text(M))}},select:{get:function(M){var N,H,K,re=M.options,ne=M.selectedIndex,ce=M.type==="select-one",Be=ce?null:[],Pe=ce?ne+1:re.length;for(ne<0?K=Pe:K=ce?ne:0;K<Pe;K++)if(H=re[K],(H.selected||K===ne)&&!H.disabled&&(!H.parentNode.disabled||!I(H.parentNode,"optgroup"))){if(N=_(H).val(),ce)return N;Be.push(N)}return Be},set:function(M,N){for(var H,K,re=M.options,ne=_.makeArray(N),ce=re.length;ce--;)K=re[ce],(K.selected=_.inArray(_.valHooks.option.get(K),ne)>-1)&&(H=!0);return H||(M.selectedIndex=-1),ne}}}}),_.each(["radio","checkbox"],function(){_.valHooks[this]={set:function(M,N){if(Array.isArray(N))return M.checked=_.inArray(_(M).val(),N)>-1}},m.checkOn||(_.valHooks[this].get=function(M){return M.getAttribute("value")===null?"on":M.value})});var zl=t.location,Gh={guid:Date.now()},kc=/\?/;_.parseXML=function(M){var N,H;if(!M||typeof M!="string")return null;try{N=new t.DOMParser().parseFromString(M,"text/xml")}catch{}return H=N&&N.getElementsByTagName("parsererror")[0],(!N||H)&&_.error("Invalid XML: "+(H?_.map(H.childNodes,function(K){return K.textContent}).join(`
`):M)),N};var qh=/^(?:focusinfocus|focusoutblur)$/,cm=function(M){M.stopPropagation()};_.extend(_.event,{trigger:function(M,N,H,K){var re,ne,ce,Be,Pe,Ye,ft,bt,at=[H||x],Nt=h.call(M,"type")?M.type:M,Kt=h.call(M,"namespace")?M.namespace.split("."):[];if(ne=bt=ce=H=H||x,!(H.nodeType===3||H.nodeType===8)&&!qh.test(Nt+_.event.triggered)&&(Nt.indexOf(".")>-1&&(Kt=Nt.split("."),Nt=Kt.shift(),Kt.sort()),Pe=Nt.indexOf(":")<0&&"on"+Nt,M=M[_.expando]?M:new _.Event(Nt,typeof M=="object"&&M),M.isTrigger=K?2:3,M.namespace=Kt.join("."),M.rnamespace=M.namespace?new RegExp("(^|\\.)"+Kt.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,M.result=void 0,M.target||(M.target=H),N=N==null?[M]:_.makeArray(N,[M]),ft=_.event.special[Nt]||{},!(!K&&ft.trigger&&ft.trigger.apply(H,N)===!1))){if(!K&&!ft.noBubble&&!y(H)){for(Be=ft.delegateType||Nt,qh.test(Be+Nt)||(ne=ne.parentNode);ne;ne=ne.parentNode)at.push(ne),ce=ne;ce===(H.ownerDocument||x)&&at.push(ce.defaultView||ce.parentWindow||t)}for(re=0;(ne=at[re++])&&!M.isPropagationStopped();)bt=ne,M.type=re>1?Be:ft.bindType||Nt,Ye=(Re.get(ne,"events")||Object.create(null))[M.type]&&Re.get(ne,"handle"),Ye&&Ye.apply(ne,N),Ye=Pe&&ne[Pe],Ye&&Ye.apply&&te(ne)&&(M.result=Ye.apply(ne,N),M.result===!1&&M.preventDefault());return M.type=Nt,!K&&!M.isDefaultPrevented()&&(!ft._default||ft._default.apply(at.pop(),N)===!1)&&te(H)&&Pe&&g(H[Nt])&&!y(H)&&(ce=H[Pe],ce&&(H[Pe]=null),_.event.triggered=Nt,M.isPropagationStopped()&&bt.addEventListener(Nt,cm),H[Nt](),M.isPropagationStopped()&&bt.removeEventListener(Nt,cm),_.event.triggered=void 0,ce&&(H[Pe]=ce)),M.result}},simulate:function(M,N,H){var K=_.extend(new _.Event,H,{type:M,isSimulated:!0});_.event.trigger(K,null,N)}}),_.fn.extend({trigger:function(M,N){return this.each(function(){_.event.trigger(M,N,this)})},triggerHandler:function(M,N){var H=this[0];if(H)return _.event.trigger(M,N,H,!0)}});var hm=/\[\]$/,dm=/\r?\n/g,ji=/^(?:submit|button|image|reset|file)$/i,rl=/^(?:input|select|textarea|keygen)/i;function zr(M,N,H,K){var re;if(Array.isArray(N))_.each(N,function(ne,ce){H||hm.test(M)?K(M,ce):zr(M+"["+(typeof ce=="object"&&ce!=null?ne:"")+"]",ce,H,K)});else if(!H&&C(N)==="object")for(re in N)zr(M+"["+re+"]",N[re],H,K);else K(M,N)}_.param=function(M,N){var H,K=[],re=function(ne,ce){var Be=g(ce)?ce():ce;K[K.length]=encodeURIComponent(ne)+"="+encodeURIComponent(Be??"")};if(M==null)return"";if(Array.isArray(M)||M.jquery&&!_.isPlainObject(M))_.each(M,function(){re(this.name,this.value)});else for(H in M)zr(H,M[H],N,re);return K.join("&")},_.fn.extend({serialize:function(){return _.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var M=_.prop(this,"elements");return M?_.makeArray(M):this}).filter(function(){var M=this.type;return this.name&&!_(this).is(":disabled")&&rl.test(this.nodeName)&&!ji.test(M)&&(this.checked||!Bt.test(M))}).map(function(M,N){var H=_(this).val();return H==null?null:Array.isArray(H)?_.map(H,function(K){return{name:N.name,value:K.replace(dm,`\r
`)}}):{name:N.name,value:H.replace(dm,`\r
`)}}).get()}});var _v=/%20/g,Yh=/#.*$/,fm=/([?&])_=[^&]*/,pm=/^(.*?):[ \t]*([^\r\n]*)$/mg,qu=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,mm=/^(?:GET|HEAD)$/,Xh=/^\/\//,Vi={},mr={},gm="*/".concat("*"),bf=x.createElement("a");bf.href=zl.href;function wv(M){return function(N,H){typeof N!="string"&&(H=N,N="*");var K,re=0,ne=N.toLowerCase().match(Te)||[];if(g(H))for(;K=ne[re++];)K[0]==="+"?(K=K.slice(1)||"*",(M[K]=M[K]||[]).unshift(H)):(M[K]=M[K]||[]).push(H)}}function vm(M,N,H,K){var re={},ne=M===mr;function ce(Be){var Pe;return re[Be]=!0,_.each(M[Be]||[],function(Ye,ft){var bt=ft(N,H,K);if(typeof bt=="string"&&!ne&&!re[bt])return N.dataTypes.unshift(bt),ce(bt),!1;if(ne)return!(Pe=bt)}),Pe}return ce(N.dataTypes[0])||!re["*"]&&ce("*")}function Kh(M,N){var H,K,re=_.ajaxSettings.flatOptions||{};for(H in N)N[H]!==void 0&&((re[H]?M:K||(K={}))[H]=N[H]);return K&&_.extend(!0,M,K),M}function E1(M,N,H){for(var K,re,ne,ce,Be=M.contents,Pe=M.dataTypes;Pe[0]==="*";)Pe.shift(),K===void 0&&(K=M.mimeType||N.getResponseHeader("Content-Type"));if(K){for(re in Be)if(Be[re]&&Be[re].test(K)){Pe.unshift(re);break}}if(Pe[0]in H)ne=Pe[0];else{for(re in H){if(!Pe[0]||M.converters[re+" "+Pe[0]]){ne=re;break}ce||(ce=re)}ne=ne||ce}if(ne)return ne!==Pe[0]&&Pe.unshift(ne),H[ne]}function ym(M,N,H,K){var re,ne,ce,Be,Pe,Ye={},ft=M.dataTypes.slice();if(ft[1])for(ce in M.converters)Ye[ce.toLowerCase()]=M.converters[ce];for(ne=ft.shift();ne;)if(M.responseFields[ne]&&(H[M.responseFields[ne]]=N),!Pe&&K&&M.dataFilter&&(N=M.dataFilter(N,M.dataType)),Pe=ne,ne=ft.shift(),ne){if(ne==="*")ne=Pe;else if(Pe!=="*"&&Pe!==ne){if(ce=Ye[Pe+" "+ne]||Ye["* "+ne],!ce){for(re in Ye)if(Be=re.split(" "),Be[1]===ne&&(ce=Ye[Pe+" "+Be[0]]||Ye["* "+Be[0]],ce)){ce===!0?ce=Ye[re]:Ye[re]!==!0&&(ne=Be[0],ft.unshift(Be[1]));break}}if(ce!==!0)if(ce&&M.throws)N=ce(N);else try{N=ce(N)}catch(bt){return{state:"parsererror",error:ce?bt:"No conversion from "+Pe+" to "+ne}}}}return{state:"success",data:N}}_.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zl.href,type:"GET",isLocal:qu.test(zl.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":gm,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":_.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(M,N){return N?Kh(Kh(M,_.ajaxSettings),N):Kh(_.ajaxSettings,M)},ajaxPrefilter:wv(Vi),ajaxTransport:wv(mr),ajax:function(M,N){typeof M=="object"&&(N=M,M=void 0),N=N||{};var H,K,re,ne,ce,Be,Pe,Ye,ft,bt,at=_.ajaxSetup({},N),Nt=at.context||at,Kt=at.context&&(Nt.nodeType||Nt.jquery)?_(Nt):_.event,Hi=_.Deferred(),Wi=_.Callbacks("once memory"),ns=at.statusCode||{},ln={},nl={},wo="canceled",ar={readyState:0,getResponseHeader:function(Gi){var jr;if(Pe){if(!ne)for(ne={};jr=pm.exec(re);)ne[jr[1].toLowerCase()+" "]=(ne[jr[1].toLowerCase()+" "]||[]).concat(jr[2]);jr=ne[Gi.toLowerCase()+" "]}return jr==null?null:jr.join(", ")},getAllResponseHeaders:function(){return Pe?re:null},setRequestHeader:function(Gi,jr){return Pe==null&&(Gi=nl[Gi.toLowerCase()]=nl[Gi.toLowerCase()]||Gi,ln[Gi]=jr),this},overrideMimeType:function(Gi){return Pe==null&&(at.mimeType=Gi),this},statusCode:function(Gi){var jr;if(Gi)if(Pe)ar.always(Gi[ar.status]);else for(jr in Gi)ns[jr]=[ns[jr],Gi[jr]];return this},abort:function(Gi){var jr=Gi||wo;return H&&H.abort(jr),Eo(0,jr),this}};if(Hi.promise(ar),at.url=((M||at.url||zl.href)+"").replace(Xh,zl.protocol+"//"),at.type=N.method||N.type||at.method||at.type,at.dataTypes=(at.dataType||"*").toLowerCase().match(Te)||[""],at.crossDomain==null){Be=x.createElement("a");try{Be.href=at.url,Be.href=Be.href,at.crossDomain=bf.protocol+"//"+bf.host!=Be.protocol+"//"+Be.host}catch{at.crossDomain=!0}}if(at.data&&at.processData&&typeof at.data!="string"&&(at.data=_.param(at.data,at.traditional)),vm(Vi,at,N,ar),Pe)return ar;Ye=_.event&&at.global,Ye&&_.active++===0&&_.event.trigger("ajaxStart"),at.type=at.type.toUpperCase(),at.hasContent=!mm.test(at.type),K=at.url.replace(Yh,""),at.hasContent?at.data&&at.processData&&(at.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(at.data=at.data.replace(_v,"+")):(bt=at.url.slice(K.length),at.data&&(at.processData||typeof at.data=="string")&&(K+=(kc.test(K)?"&":"?")+at.data,delete at.data),at.cache===!1&&(K=K.replace(fm,"$1"),bt=(kc.test(K)?"&":"?")+"_="+Gh.guid+++bt),at.url=K+bt),at.ifModified&&(_.lastModified[K]&&ar.setRequestHeader("If-Modified-Since",_.lastModified[K]),_.etag[K]&&ar.setRequestHeader("If-None-Match",_.etag[K])),(at.data&&at.hasContent&&at.contentType!==!1||N.contentType)&&ar.setRequestHeader("Content-Type",at.contentType),ar.setRequestHeader("Accept",at.dataTypes[0]&&at.accepts[at.dataTypes[0]]?at.accepts[at.dataTypes[0]]+(at.dataTypes[0]!=="*"?", "+gm+"; q=0.01":""):at.accepts["*"]);for(ft in at.headers)ar.setRequestHeader(ft,at.headers[ft]);if(at.beforeSend&&(at.beforeSend.call(Nt,ar,at)===!1||Pe))return ar.abort();if(wo="abort",Wi.add(at.complete),ar.done(at.success),ar.fail(at.error),H=vm(mr,at,N,ar),!H)Eo(-1,"No Transport");else{if(ar.readyState=1,Ye&&Kt.trigger("ajaxSend",[ar,at]),Pe)return ar;at.async&&at.timeout>0&&(ce=t.setTimeout(function(){ar.abort("timeout")},at.timeout));try{Pe=!1,H.send(ln,Eo)}catch(Gi){if(Pe)throw Gi;Eo(-1,Gi)}}function Eo(Gi,jr,Fl,Bs){var Ka,uu,$a,So,sl,oa=jr;Pe||(Pe=!0,ce&&t.clearTimeout(ce),H=void 0,re=Bs||"",ar.readyState=Gi>0?4:0,Ka=Gi>=200&&Gi<300||Gi===304,Fl&&(So=E1(at,ar,Fl)),!Ka&&_.inArray("script",at.dataTypes)>-1&&_.inArray("json",at.dataTypes)<0&&(at.converters["text script"]=function(){}),So=ym(at,So,ar,Ka),Ka?(at.ifModified&&(sl=ar.getResponseHeader("Last-Modified"),sl&&(_.lastModified[K]=sl),sl=ar.getResponseHeader("etag"),sl&&(_.etag[K]=sl)),Gi===204||at.type==="HEAD"?oa="nocontent":Gi===304?oa="notmodified":(oa=So.state,uu=So.data,$a=So.error,Ka=!$a)):($a=oa,(Gi||!oa)&&(oa="error",Gi<0&&(Gi=0))),ar.status=Gi,ar.statusText=(jr||oa)+"",Ka?Hi.resolveWith(Nt,[uu,oa,ar]):Hi.rejectWith(Nt,[ar,oa,$a]),ar.statusCode(ns),ns=void 0,Ye&&Kt.trigger(Ka?"ajaxSuccess":"ajaxError",[ar,at,Ka?uu:$a]),Wi.fireWith(Nt,[ar,oa]),Ye&&(Kt.trigger("ajaxComplete",[ar,at]),--_.active||_.event.trigger("ajaxStop")))}return ar},getJSON:function(M,N,H){return _.get(M,N,H,"json")},getScript:function(M,N){return _.get(M,void 0,N,"script")}}),_.each(["get","post"],function(M,N){_[N]=function(H,K,re,ne){return g(K)&&(ne=ne||re,re=K,K=void 0),_.ajax(_.extend({url:H,type:N,dataType:ne,data:K,success:re},_.isPlainObject(H)&&H))}}),_.ajaxPrefilter(function(M){var N;for(N in M.headers)N.toLowerCase()==="content-type"&&(M.contentType=M.headers[N]||"")}),_._evalUrl=function(M,N,H){return _.ajax({url:M,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(K){_.globalEval(K,N,H)}})},_.fn.extend({wrapAll:function(M){var N;return this[0]&&(g(M)&&(M=M.call(this[0])),N=_(M,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&N.insertBefore(this[0]),N.map(function(){for(var H=this;H.firstElementChild;)H=H.firstElementChild;return H}).append(this)),this},wrapInner:function(M){return g(M)?this.each(function(N){_(this).wrapInner(M.call(this,N))}):this.each(function(){var N=_(this),H=N.contents();H.length?H.wrapAll(M):N.append(M)})},wrap:function(M){var N=g(M);return this.each(function(H){_(this).wrapAll(N?M.call(this,H):M)})},unwrap:function(M){return this.parent(M).not("body").each(function(){_(this).replaceWith(this.childNodes)}),this}}),_.expr.pseudos.hidden=function(M){return!_.expr.pseudos.visible(M)},_.expr.pseudos.visible=function(M){return!!(M.offsetWidth||M.offsetHeight||M.getClientRects().length)},_.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch{}};var gr={0:200,1223:204},Sn=_.ajaxSettings.xhr();m.cors=!!Sn&&"withCredentials"in Sn,m.ajax=Sn=!!Sn,_.ajaxTransport(function(M){var N,H;if(m.cors||Sn&&!M.crossDomain)return{send:function(K,re){var ne,ce=M.xhr();if(ce.open(M.type,M.url,M.async,M.username,M.password),M.xhrFields)for(ne in M.xhrFields)ce[ne]=M.xhrFields[ne];M.mimeType&&ce.overrideMimeType&&ce.overrideMimeType(M.mimeType),!M.crossDomain&&!K["X-Requested-With"]&&(K["X-Requested-With"]="XMLHttpRequest");for(ne in K)ce.setRequestHeader(ne,K[ne]);N=function(Be){return function(){N&&(N=H=ce.onload=ce.onerror=ce.onabort=ce.ontimeout=ce.onreadystatechange=null,Be==="abort"?ce.abort():Be==="error"?typeof ce.status!="number"?re(0,"error"):re(ce.status,ce.statusText):re(gr[ce.status]||ce.status,ce.statusText,(ce.responseType||"text")!=="text"||typeof ce.responseText!="string"?{binary:ce.response}:{text:ce.responseText},ce.getAllResponseHeaders()))}},ce.onload=N(),H=ce.onerror=ce.ontimeout=N("error"),ce.onabort!==void 0?ce.onabort=H:ce.onreadystatechange=function(){ce.readyState===4&&t.setTimeout(function(){N&&H()})},N=N("abort");try{ce.send(M.hasContent&&M.data||null)}catch(Be){if(N)throw Be}},abort:function(){N&&N()}}}),_.ajaxPrefilter(function(M){M.crossDomain&&(M.contents.script=!1)}),_.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(M){return _.globalEval(M),M}}}),_.ajaxPrefilter("script",function(M){M.cache===void 0&&(M.cache=!1),M.crossDomain&&(M.type="GET")}),_.ajaxTransport("script",function(M){if(M.crossDomain||M.scriptAttrs){var N,H;return{send:function(K,re){N=_("<script>").attr(M.scriptAttrs||{}).prop({charset:M.scriptCharset,src:M.url}).on("load error",H=function(ne){N.remove(),H=null,ne&&re(ne.type==="error"?404:200,ne.type)}),x.head.appendChild(N[0])},abort:function(){H&&H()}}}});var sa=[],Pa=/(=)\?(?=&|$)|\?\?/;_.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var M=sa.pop()||_.expando+"_"+Gh.guid++;return this[M]=!0,M}}),_.ajaxPrefilter("json jsonp",function(M,N,H){var K,re,ne,ce=M.jsonp!==!1&&(Pa.test(M.url)?"url":typeof M.data=="string"&&(M.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Pa.test(M.data)&&"data");if(ce||M.dataTypes[0]==="jsonp")return K=M.jsonpCallback=g(M.jsonpCallback)?M.jsonpCallback():M.jsonpCallback,ce?M[ce]=M[ce].replace(Pa,"$1"+K):M.jsonp!==!1&&(M.url+=(kc.test(M.url)?"&":"?")+M.jsonp+"="+K),M.converters["script json"]=function(){return ne||_.error(K+" was not called"),ne[0]},M.dataTypes[0]="json",re=t[K],t[K]=function(){ne=arguments},H.always(function(){re===void 0?_(t).removeProp(K):t[K]=re,M[K]&&(M.jsonpCallback=N.jsonpCallback,sa.push(K)),ne&&g(re)&&re(ne[0]),ne=re=void 0}),"script"}),m.createHTMLDocument=function(){var M=x.implementation.createHTMLDocument("").body;return M.innerHTML="<form></form><form></form>",M.childNodes.length===2}(),_.parseHTML=function(M,N,H){if(typeof M!="string")return[];typeof N=="boolean"&&(H=N,N=!1);var K,re,ne;return N||(m.createHTMLDocument?(N=x.implementation.createHTMLDocument(""),K=N.createElement("base"),K.href=x.location.href,N.head.appendChild(K)):N=x),re=se.exec(M),ne=!H&&[],re?[N.createElement(re[1])]:(re=Rn([M],N,ne),ne&&ne.length&&_(ne).remove(),_.merge([],re.childNodes))},_.fn.load=function(M,N,H){var K,re,ne,ce=this,Be=M.indexOf(" ");return Be>-1&&(K=il(M.slice(Be)),M=M.slice(0,Be)),g(N)?(H=N,N=void 0):N&&typeof N=="object"&&(re="POST"),ce.length>0&&_.ajax({url:M,type:re||"GET",dataType:"html",data:N}).done(function(Pe){ne=arguments,ce.html(K?_("<div>").append(_.parseHTML(Pe)).find(K):Pe)}).always(H&&function(Pe,Ye){ce.each(function(){H.apply(this,ne||[Pe.responseText,Ye,Pe])})}),this},_.expr.pseudos.animated=function(M){return _.grep(_.timers,function(N){return M===N.elem}).length},_.offset={setOffset:function(M,N,H){var K,re,ne,ce,Be,Pe,Ye,ft=_.css(M,"position"),bt=_(M),at={};ft==="static"&&(M.style.position="relative"),Be=bt.offset(),ne=_.css(M,"top"),Pe=_.css(M,"left"),Ye=(ft==="absolute"||ft==="fixed")&&(ne+Pe).indexOf("auto")>-1,Ye?(K=bt.position(),ce=K.top,re=K.left):(ce=parseFloat(ne)||0,re=parseFloat(Pe)||0),g(N)&&(N=N.call(M,H,_.extend({},Be))),N.top!=null&&(at.top=N.top-Be.top+ce),N.left!=null&&(at.left=N.left-Be.left+re),"using"in N?N.using.call(M,at):bt.css(at)}},_.fn.extend({offset:function(M){if(arguments.length)return M===void 0?this:this.each(function(re){_.offset.setOffset(this,M,re)});var N,H,K=this[0];if(K)return K.getClientRects().length?(N=K.getBoundingClientRect(),H=K.ownerDocument.defaultView,{top:N.top+H.pageYOffset,left:N.left+H.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var M,N,H,K=this[0],re={top:0,left:0};if(_.css(K,"position")==="fixed")N=K.getBoundingClientRect();else{for(N=this.offset(),H=K.ownerDocument,M=K.offsetParent||H.documentElement;M&&(M===H.body||M===H.documentElement)&&_.css(M,"position")==="static";)M=M.parentNode;M&&M!==K&&M.nodeType===1&&(re=_(M).offset(),re.top+=_.css(M,"borderTopWidth",!0),re.left+=_.css(M,"borderLeftWidth",!0))}return{top:N.top-re.top-_.css(K,"marginTop",!0),left:N.left-re.left-_.css(K,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var M=this.offsetParent;M&&_.css(M,"position")==="static";)M=M.offsetParent;return M||kt})}}),_.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(M,N){var H=N==="pageYOffset";_.fn[M]=function(K){return ue(this,function(re,ne,ce){var Be;if(y(re)?Be=re:re.nodeType===9&&(Be=re.defaultView),ce===void 0)return Be?Be[N]:re[ne];Be?Be.scrollTo(H?Be.pageXOffset:ce,H?ce:Be.pageYOffset):re[ne]=ce},M,K,arguments.length)}}),_.each(["top","left"],function(M,N){_.cssHooks[N]=Lr(m.pixelPosition,function(H,K){if(K)return K=Wn(H,N),Li.test(K)?_(H).position()[N]+"px":K})}),_.each({Height:"height",Width:"width"},function(M,N){_.each({padding:"inner"+M,content:N,"":"outer"+M},function(H,K){_.fn[K]=function(re,ne){var ce=arguments.length&&(H||typeof re!="boolean"),Be=H||(re===!0||ne===!0?"margin":"border");return ue(this,function(Pe,Ye,ft){var bt;return y(Pe)?K.indexOf("outer")===0?Pe["inner"+M]:Pe.document.documentElement["client"+M]:Pe.nodeType===9?(bt=Pe.documentElement,Math.max(Pe.body["scroll"+M],bt["scroll"+M],Pe.body["offset"+M],bt["offset"+M],bt["client"+M])):ft===void 0?_.css(Pe,Ye,Be):_.style(Pe,Ye,ft,Be)},N,ce?re:void 0,ce)}})}),_.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(M,N){_.fn[N]=function(H){return this.on(N,H)}}),_.fn.extend({bind:function(M,N,H){return this.on(M,null,N,H)},unbind:function(M,N){return this.off(M,null,N)},delegate:function(M,N,H,K){return this.on(N,M,H,K)},undelegate:function(M,N,H){return arguments.length===1?this.off(M,"**"):this.off(N,M||"**",H)},hover:function(M,N){return this.on("mouseenter",M).on("mouseleave",N||M)}}),_.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(M,N){_.fn[N]=function(H,K){return arguments.length>0?this.on(N,null,H,K):this.trigger(N)}});var xm=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;_.proxy=function(M,N){var H,K,re;if(typeof N=="string"&&(H=M[N],N=M,M=H),!!g(M))return K=s.call(arguments,2),re=function(){return M.apply(N||this,K.concat(s.call(arguments)))},re.guid=M.guid=M.guid||_.guid++,re},_.holdReady=function(M){M?_.readyWait++:_.ready(!0)},_.isArray=Array.isArray,_.parseJSON=JSON.parse,_.nodeName=I,_.isFunction=g,_.isWindow=y,_.camelCase=ae,_.type=C,_.now=Date.now,_.isNumeric=function(M){var N=_.type(M);return(N==="number"||N==="string")&&!isNaN(M-parseFloat(M))},_.trim=function(M){return M==null?"":(M+"").replace(xm,"$1")};var bm=t.jQuery,aa=t.$;return _.noConflict=function(M){return t.$===_&&(t.$=aa),M&&t.jQuery===_&&(t.jQuery=bm),_},typeof i>"u"&&(t.jQuery=t.$=_),_})})(rae);var w1=rae.exports,nae={},yf={};Object.defineProperty(yf,"__esModule",{value:!0});yf.TempoElement=void 0;const HO="STORYBOARD-TOP-CONSTANT";class ap{constructor(t,i,r){if(t&&/[^0-9a-zA-Z-_]/.test(t))throw new Error("Codebase ID contains invalid chars :"+t);if(i&&/[^0-9a-zA-Z-_]/.test(i))throw new Error("Storyboard ID contains invalid chars :"+t);this.codebaseId=t||"",this.storyboardId=i,this.uniquePath=r,this.cachedKey=null}isEqual(t){return this.codebaseId===t.codebaseId&&this.storyboardId===t.storyboardId&&this.uniquePath===t.uniquePath}getKey(){return this.cachedKey?this.cachedKey:(this.cachedKey=`TE_${this.codebaseId}_${this.storyboardId}_${this.uniquePath}`,this.cachedKey)}isEmpty(){return!(this.storyboardId&&this.uniquePath)}static fromKey(t){if(!t)return ap.empty();const[i,r,n,s]=t.split("_");return!n||!s?ap.empty():new ap(r,n,s)}static fromOtherElement(t){return new ap(t.codebaseId,t.storyboardId,t.uniquePath)}static empty(){return new ap("","","")}static forStoryboard(t){return new ap(HO,t,"0")}isStoryboard(t){return this.codebaseId===HO&&(!t||this.storyboardId===t)}isKnownElement(){return!this.isEmpty()&&!!this.codebaseId&&this.codebaseId!==HO}isParentOf(t){return t?this.isStoryboard()?this.storyboardId===t.storyboardId&&this.uniquePath!==t.uniquePath:this.storyboardId===t.storyboardId&&this.uniquePath!==t.uniquePath&&!!this.uniquePath&&!!t.uniquePath&&t.uniquePath.startsWith(this.uniquePath):!1}isSiblingOf(t){if(!t||!this.uniquePath||!t.uniquePath||this.isEqual(t))return!1;if(this.isStoryboard())return t.isStoryboard();const i=this.uniquePath.split("-").slice(0,-1).join("-"),r=t.uniquePath.split("-").slice(0,-1).join("-");return this.storyboardId===t.storyboardId&&this.uniquePath!==t.uniquePath&&!!i&&!!r&&i===r}}yf.TempoElement=ap;var yw={},i2={},r2={};Object.defineProperty(r2,"__esModule",{value:!0});r2.default=Jrt;let QS;const Qrt=new Uint8Array(16);function Jrt(){if(!QS&&(QS=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!QS))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return QS(Qrt)}var um={},vv={},n2={};Object.defineProperty(n2,"__esModule",{value:!0});n2.default=void 0;var ent=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;n2.default=ent;Object.defineProperty(vv,"__esModule",{value:!0});vv.default=void 0;var tnt=int(n2);function int(e){return e&&e.__esModule?e:{default:e}}function rnt(e){return typeof e=="string"&&tnt.default.test(e)}var nnt=rnt;vv.default=nnt;Object.defineProperty(um,"__esModule",{value:!0});um.default=void 0;um.unsafeStringify=sae;var snt=ant(vv);function ant(e){return e&&e.__esModule?e:{default:e}}const Ra=[];for(let e=0;e<256;++e)Ra.push((e+256).toString(16).slice(1));function sae(e,t=0){return Ra[e[t+0]]+Ra[e[t+1]]+Ra[e[t+2]]+Ra[e[t+3]]+"-"+Ra[e[t+4]]+Ra[e[t+5]]+"-"+Ra[e[t+6]]+Ra[e[t+7]]+"-"+Ra[e[t+8]]+Ra[e[t+9]]+"-"+Ra[e[t+10]]+Ra[e[t+11]]+Ra[e[t+12]]+Ra[e[t+13]]+Ra[e[t+14]]+Ra[e[t+15]]}function ont(e,t=0){const i=sae(e,t);if(!(0,snt.default)(i))throw TypeError("Stringified UUID is invalid");return i}var lnt=ont;um.default=lnt;Object.defineProperty(i2,"__esModule",{value:!0});i2.default=void 0;var unt=hnt(r2),cnt=um;function hnt(e){return e&&e.__esModule?e:{default:e}}let Uq,WO,GO=0,qO=0;function dnt(e,t,i){let r=t&&i||0;const n=t||new Array(16);e=e||{};let s=e.node||Uq,a=e.clockseq!==void 0?e.clockseq:WO;if(s==null||a==null){const d=e.random||(e.rng||unt.default)();s==null&&(s=Uq=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),a==null&&(a=WO=(d[6]<<8|d[7])&16383)}let o=e.msecs!==void 0?e.msecs:Date.now(),l=e.nsecs!==void 0?e.nsecs:qO+1;const u=o-GO+(l-qO)/1e4;if(u<0&&e.clockseq===void 0&&(a=a+1&16383),(u<0||o>GO)&&e.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");GO=o,qO=l,WO=a,o+=122192928e5;const c=((o&268435455)*1e4+l)%4294967296;n[r++]=c>>>24&255,n[r++]=c>>>16&255,n[r++]=c>>>8&255,n[r++]=c&255;const h=o/4294967296*1e4&268435455;n[r++]=h>>>8&255,n[r++]=h&255,n[r++]=h>>>24&15|16,n[r++]=h>>>16&255,n[r++]=a>>>8|128,n[r++]=a&255;for(let d=0;d<6;++d)n[r+d]=s[d];return t||(0,cnt.unsafeStringify)(n)}var fnt=dnt;i2.default=fnt;var s2={},Zp={},xw={};Object.defineProperty(xw,"__esModule",{value:!0});xw.default=void 0;var pnt=mnt(vv);function mnt(e){return e&&e.__esModule?e:{default:e}}function gnt(e){if(!(0,pnt.default)(e))throw TypeError("Invalid UUID");let t;const i=new Uint8Array(16);return i[0]=(t=parseInt(e.slice(0,8),16))>>>24,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=t&255,i[4]=(t=parseInt(e.slice(9,13),16))>>>8,i[5]=t&255,i[6]=(t=parseInt(e.slice(14,18),16))>>>8,i[7]=t&255,i[8]=(t=parseInt(e.slice(19,23),16))>>>8,i[9]=t&255,i[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,i[11]=t/4294967296&255,i[12]=t>>>24&255,i[13]=t>>>16&255,i[14]=t>>>8&255,i[15]=t&255,i}var vnt=gnt;xw.default=vnt;Object.defineProperty(Zp,"__esModule",{value:!0});Zp.URL=Zp.DNS=void 0;Zp.default=wnt;var ynt=um,xnt=bnt(xw);function bnt(e){return e&&e.__esModule?e:{default:e}}function _nt(e){e=unescape(encodeURIComponent(e));const t=[];for(let i=0;i<e.length;++i)t.push(e.charCodeAt(i));return t}const aae="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Zp.DNS=aae;const oae="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Zp.URL=oae;function wnt(e,t,i){function r(n,s,a,o){var l;if(typeof n=="string"&&(n=_nt(n)),typeof s=="string"&&(s=(0,xnt.default)(s)),((l=s)===null||l===void 0?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+n.length);if(u.set(s),u.set(n,s.length),u=i(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,a){o=o||0;for(let c=0;c<16;++c)a[o+c]=u[c];return a}return(0,ynt.unsafeStringify)(u)}try{r.name=e}catch{}return r.DNS=aae,r.URL=oae,r}var a2={};Object.defineProperty(a2,"__esModule",{value:!0});a2.default=void 0;function Ent(e){if(typeof e=="string"){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let i=0;i<t.length;++i)e[i]=t.charCodeAt(i)}return Snt(Tnt(Cnt(e),e.length*8))}function Snt(e){const t=[],i=e.length*32,r="0123456789abcdef";for(let n=0;n<i;n+=8){const s=e[n>>5]>>>n%32&255,a=parseInt(r.charAt(s>>>4&15)+r.charAt(s&15),16);t.push(a)}return t}function lae(e){return(e+64>>>9<<4)+14+1}function Tnt(e,t){e[t>>5]|=128<<t%32,e[lae(t)-1]=t;let i=1732584193,r=-271733879,n=-1732584194,s=271733878;for(let a=0;a<e.length;a+=16){const o=i,l=r,u=n,c=s;i=no(i,r,n,s,e[a],7,-680876936),s=no(s,i,r,n,e[a+1],12,-389564586),n=no(n,s,i,r,e[a+2],17,606105819),r=no(r,n,s,i,e[a+3],22,-1044525330),i=no(i,r,n,s,e[a+4],7,-176418897),s=no(s,i,r,n,e[a+5],12,1200080426),n=no(n,s,i,r,e[a+6],17,-1473231341),r=no(r,n,s,i,e[a+7],22,-45705983),i=no(i,r,n,s,e[a+8],7,1770035416),s=no(s,i,r,n,e[a+9],12,-1958414417),n=no(n,s,i,r,e[a+10],17,-42063),r=no(r,n,s,i,e[a+11],22,-1990404162),i=no(i,r,n,s,e[a+12],7,1804603682),s=no(s,i,r,n,e[a+13],12,-40341101),n=no(n,s,i,r,e[a+14],17,-1502002290),r=no(r,n,s,i,e[a+15],22,1236535329),i=so(i,r,n,s,e[a+1],5,-165796510),s=so(s,i,r,n,e[a+6],9,-1069501632),n=so(n,s,i,r,e[a+11],14,643717713),r=so(r,n,s,i,e[a],20,-373897302),i=so(i,r,n,s,e[a+5],5,-701558691),s=so(s,i,r,n,e[a+10],9,38016083),n=so(n,s,i,r,e[a+15],14,-660478335),r=so(r,n,s,i,e[a+4],20,-405537848),i=so(i,r,n,s,e[a+9],5,568446438),s=so(s,i,r,n,e[a+14],9,-1019803690),n=so(n,s,i,r,e[a+3],14,-187363961),r=so(r,n,s,i,e[a+8],20,1163531501),i=so(i,r,n,s,e[a+13],5,-1444681467),s=so(s,i,r,n,e[a+2],9,-51403784),n=so(n,s,i,r,e[a+7],14,1735328473),r=so(r,n,s,i,e[a+12],20,-1926607734),i=ao(i,r,n,s,e[a+5],4,-378558),s=ao(s,i,r,n,e[a+8],11,-2022574463),n=ao(n,s,i,r,e[a+11],16,1839030562),r=ao(r,n,s,i,e[a+14],23,-35309556),i=ao(i,r,n,s,e[a+1],4,-1530992060),s=ao(s,i,r,n,e[a+4],11,1272893353),n=ao(n,s,i,r,e[a+7],16,-155497632),r=ao(r,n,s,i,e[a+10],23,-1094730640),i=ao(i,r,n,s,e[a+13],4,681279174),s=ao(s,i,r,n,e[a],11,-358537222),n=ao(n,s,i,r,e[a+3],16,-722521979),r=ao(r,n,s,i,e[a+6],23,76029189),i=ao(i,r,n,s,e[a+9],4,-640364487),s=ao(s,i,r,n,e[a+12],11,-421815835),n=ao(n,s,i,r,e[a+15],16,530742520),r=ao(r,n,s,i,e[a+2],23,-995338651),i=oo(i,r,n,s,e[a],6,-198630844),s=oo(s,i,r,n,e[a+7],10,1126891415),n=oo(n,s,i,r,e[a+14],15,-1416354905),r=oo(r,n,s,i,e[a+5],21,-57434055),i=oo(i,r,n,s,e[a+12],6,1700485571),s=oo(s,i,r,n,e[a+3],10,-1894986606),n=oo(n,s,i,r,e[a+10],15,-1051523),r=oo(r,n,s,i,e[a+1],21,-2054922799),i=oo(i,r,n,s,e[a+8],6,1873313359),s=oo(s,i,r,n,e[a+15],10,-30611744),n=oo(n,s,i,r,e[a+6],15,-1560198380),r=oo(r,n,s,i,e[a+13],21,1309151649),i=oo(i,r,n,s,e[a+4],6,-145523070),s=oo(s,i,r,n,e[a+11],10,-1120210379),n=oo(n,s,i,r,e[a+2],15,718787259),r=oo(r,n,s,i,e[a+9],21,-343485551),i=Pp(i,o),r=Pp(r,l),n=Pp(n,u),s=Pp(s,c)}return[i,r,n,s]}function Cnt(e){if(e.length===0)return[];const t=e.length*8,i=new Uint32Array(lae(t));for(let r=0;r<t;r+=8)i[r>>5]|=(e[r/8]&255)<<r%32;return i}function Pp(e,t){const i=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(i>>16)<<16|i&65535}function Ant(e,t){return e<<t|e>>>32-t}function o2(e,t,i,r,n,s){return Pp(Ant(Pp(Pp(t,e),Pp(r,s)),n),i)}function no(e,t,i,r,n,s,a){return o2(t&i|~t&r,e,t,n,s,a)}function so(e,t,i,r,n,s,a){return o2(t&r|i&~r,e,t,n,s,a)}function ao(e,t,i,r,n,s,a){return o2(t^i^r,e,t,n,s,a)}function oo(e,t,i,r,n,s,a){return o2(i^(t|~r),e,t,n,s,a)}var Mnt=Ent;a2.default=Mnt;Object.defineProperty(s2,"__esModule",{value:!0});s2.default=void 0;var Pnt=uae(Zp),Dnt=uae(a2);function uae(e){return e&&e.__esModule?e:{default:e}}const Int=(0,Pnt.default)("v3",48,Dnt.default);var Ont=Int;s2.default=Ont;var l2={},u2={};Object.defineProperty(u2,"__esModule",{value:!0});u2.default=void 0;const Rnt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var Lnt={randomUUID:Rnt};u2.default=Lnt;Object.defineProperty(l2,"__esModule",{value:!0});l2.default=void 0;var jq=cae(u2),Nnt=cae(r2),knt=um;function cae(e){return e&&e.__esModule?e:{default:e}}function Bnt(e,t,i){if(jq.default.randomUUID&&!t&&!e)return jq.default.randomUUID();e=e||{};const r=e.random||(e.rng||Nnt.default)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){i=i||0;for(let n=0;n<16;++n)t[i+n]=r[n];return t}return(0,knt.unsafeStringify)(r)}var znt=Bnt;l2.default=znt;var c2={},h2={};Object.defineProperty(h2,"__esModule",{value:!0});h2.default=void 0;function Fnt(e,t,i,r){switch(e){case 0:return t&i^~t&r;case 1:return t^i^r;case 2:return t&i^t&r^i&r;case 3:return t^i^r}}function YO(e,t){return e<<t|e>>>32-t}function Unt(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){const a=unescape(encodeURIComponent(e));e=[];for(let o=0;o<a.length;++o)e.push(a.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,n=Math.ceil(r/16),s=new Array(n);for(let a=0;a<n;++a){const o=new Uint32Array(16);for(let l=0;l<16;++l)o[l]=e[a*64+l*4]<<24|e[a*64+l*4+1]<<16|e[a*64+l*4+2]<<8|e[a*64+l*4+3];s[a]=o}s[n-1][14]=(e.length-1)*8/Math.pow(2,32),s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=(e.length-1)*8&4294967295;for(let a=0;a<n;++a){const o=new Uint32Array(80);for(let f=0;f<16;++f)o[f]=s[a][f];for(let f=16;f<80;++f)o[f]=YO(o[f-3]^o[f-8]^o[f-14]^o[f-16],1);let l=i[0],u=i[1],c=i[2],h=i[3],d=i[4];for(let f=0;f<80;++f){const m=Math.floor(f/20),g=YO(l,5)+Fnt(m,u,c,h)+d+t[m]+o[f]>>>0;d=h,h=c,c=YO(u,30)>>>0,u=l,l=g}i[0]=i[0]+l>>>0,i[1]=i[1]+u>>>0,i[2]=i[2]+c>>>0,i[3]=i[3]+h>>>0,i[4]=i[4]+d>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,i[0]&255,i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,i[1]&255,i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,i[2]&255,i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,i[3]&255,i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,i[4]&255]}var jnt=Unt;h2.default=jnt;Object.defineProperty(c2,"__esModule",{value:!0});c2.default=void 0;var Vnt=hae(Zp),Hnt=hae(h2);function hae(e){return e&&e.__esModule?e:{default:e}}const Wnt=(0,Vnt.default)("v5",80,Hnt.default);var Gnt=Wnt;c2.default=Gnt;var d2={};Object.defineProperty(d2,"__esModule",{value:!0});d2.default=void 0;var qnt="00000000-0000-0000-0000-000000000000";d2.default=qnt;var f2={};Object.defineProperty(f2,"__esModule",{value:!0});f2.default=void 0;var Ynt=Xnt(vv);function Xnt(e){return e&&e.__esModule?e:{default:e}}function Knt(e){if(!(0,Ynt.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}var $nt=Knt;f2.default=$nt;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return a.default}});var t=c(i2),i=c(s2),r=c(l2),n=c(c2),s=c(d2),a=c(f2),o=c(vv),l=c(um),u=c(xw);function c(h){return h&&h.__esModule?h:{default:h}}})(yw);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructChangeLedgerClass=e.UnknownChange=e.RedoChange=e.UndoChange=e.EditTextChange=e.RemoveClassChange=e.AddClassChange=e.ChangeTagChange=e.DuplicateChange=e.WrapDivChange=e.ChangePropChange=e.RemoveJsxChange=e.MoveJsxChange=e.AddJsxChange=e.StylingChange=e.ChangeLedgerItem=e.CHANGE_TYPES_WITH_INSTANT_UNDO=e.ChangeType=e.StylingFramework=void 0;const t=yf,i=yw;var r;(function(A){A.INLINE="Inline",A.CSS="CSS",A.TAILWIND="Tailwind"})(r||(e.StylingFramework=r={}));var n;(function(A){A.STYLING="STYLING",A.ADD_JSX="ADD_JSX",A.MOVE_JSX="MOVE_JSX",A.REMOVE_JSX="REMOVE_JSX",A.CHANGE_PROP="CHANGE_PROP",A.ADD_CLASS="ADD_CLASS",A.REMOVE_CLASS="REMOVE_CLASS",A.EDIT_TEXT="EDIT_TEXT",A.WRAP_DIV="WRAP_DIV",A.CHANGE_TAG="CHANGE_TAG",A.DUPLICATE="DUPLICATE",A.UNDO="UNDO",A.REDO="REDO",A.UNKNOWN="UNKNOWN"})(n||(e.ChangeType=n={})),e.CHANGE_TYPES_WITH_INSTANT_UNDO=[n.REMOVE_JSX,n.ADD_CLASS,n.STYLING];class s{constructor(E,_,P,I){this.prevIdToNewIdMap={},this.id=I||(0,i.v4)(),this.type=E,this.changeFields=P,this.changeName=_,this._consumed=!1,this._failed=!1,this._instantUpdateSent=!1,this._instantUpdateFinished=!1,this._instantUpdateSuccessful=!1,this._sendInstantUpdate=!0,this.canInstantUpdateWhileFlushing=!1,this._apiPromise=new Promise((D,k)=>{this._resolveApi=D,this._rejectApi=k})}resolveApi(E){var _;(_=this._resolveApi)===null||_===void 0||_.call(this,E)}rejectApi(E){var _;this._apiRejectionAdded&&((_=this._rejectApi)===null||_===void 0||_.call(this,E))}needsToSendInstantUpdate(){return!this._instantUpdateSent&&this._sendInstantUpdate}markInstantUpdateSent(){this._instantUpdateSent=!0}markInstantUpdateFinished(E,_){this._instantUpdateFinished=!0,this._instantUpdateSuccessful=_,this._instantUpdateData=E}getInstantUpdateData(){return this._instantUpdateData}wasInstantUpdateSuccessful(){return this._instantUpdateSuccessful}isInstantUpdateFinished(){return this._instantUpdateFinished}markProcessedSucceeded(){this._consumed=!0}markProcessedFailed(){this._failed=!0,this._consumed=!0}isFailed(){return this._failed}needToProcessChange(){return!this._consumed}onApiResolve(E){return this._apiPromise.then(E)}onApiReject(E){return this._apiRejectionAdded=!0,this._apiPromise.catch(E)}doNotSendInstantUpdate(){this._sendInstantUpdate=!1}clearSelectedElementsAfterInstantUpdate(){this.elementKeyToSelectAfterInstantUpdate=null,this.elementKeysToMultiselectAfterInstantUpdate=null}setSelectedElementsAfterInstantUpdate(E,_){this.elementKeyToSelectAfterInstantUpdate=E,this.elementKeysToMultiselectAfterInstantUpdate=_}clearSelectedElementsAfterUndoInstantUpdate(){this.elementKeyToSelectAfterUndoInstantUpdate=null,this.elementKeysToMultiselectAfterUndoInstantUpdate=null}setSelectedElementsAfterUndoInstantUpdate(E,_){this.elementKeyToSelectAfterUndoInstantUpdate=E,this.elementKeysToMultiselectAfterUndoInstantUpdate=_}getElementKeyToSelectAfterInstantUpdate(){return this.elementKeyToSelectAfterInstantUpdate}getElementKeysToMultiselectAfterInstantUpdate(){return this.elementKeysToMultiselectAfterInstantUpdate}getElementKeyToSelectAfterUndoInstantUpdate(){return this.elementKeyToSelectAfterUndoInstantUpdate}getElementKeysToMultiselectAfterUndoInstantUpdate(){return this.elementKeysToMultiselectAfterUndoInstantUpdate}applyAllCodebaseIdChanges(E){var _,P;const I=D=>{if(!D)return null;const k=t.TempoElement.fromKey(D),B=k.codebaseId,z=E[B];return z?new t.TempoElement(z,k.storyboardId,k.uniquePath).getKey():null};if(this.elementKeyToSelectAfterInstantUpdate){const D=I(this.elementKeyToSelectAfterInstantUpdate);this.elementKeyToSelectAfterInstantUpdate=D||this.elementKeyToSelectAfterInstantUpdate}if(this.elementKeysToMultiselectAfterInstantUpdate&&(this.elementKeysToMultiselectAfterInstantUpdate=(_=this.elementKeysToMultiselectAfterInstantUpdate)===null||_===void 0?void 0:_.map(D=>I(D)||D)),this.elementKeyToSelectAfterUndoInstantUpdate){const D=I(this.elementKeyToSelectAfterUndoInstantUpdate);this.elementKeyToSelectAfterUndoInstantUpdate=D||this.elementKeyToSelectAfterUndoInstantUpdate}this.elementKeysToMultiselectAfterUndoInstantUpdate&&(this.elementKeysToMultiselectAfterUndoInstantUpdate=(P=this.elementKeysToMultiselectAfterUndoInstantUpdate)===null||P===void 0?void 0:P.map(D=>I(D)||D)),this.applyCodebaseIdChanges(E)}}e.ChangeLedgerItem=s;class a extends s{constructor(E,_){super(n.STYLING,"Styling",E,_),this.canInstantUpdateWhileFlushing=!0}prepareApiRequest(E,_,P){const{codebaseId:I,stylingChanges:D,stylingFramework:k,modifiers:B,customProperties:z}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/styling`,body:{reactElement:_[I],styling:D,stylingFramework:k,modifiers:B,customProperties:z}}}applyCodebaseIdChanges(E){const _=E[this.changeFields.codebaseId];_&&(this.changeFields.codebaseId=_)}}e.StylingChange=a;class o extends s{constructor(E,_){super(n.ADD_JSX,"Add Element",E,_)}prepareApiRequest(E,_,P){const{codebaseIdToAddTo:I,beforeCodebaseId:D,afterCodebaseId:k,addCodebaseId:B,addNativeTag:z,fileContentsToSourceFrom:W,fileContentsSourceFilename:$,propsToSet:Z,deletedStoryboardId:G,htmlForInstantUpdate:V}=this.changeFields,J={destinationElement:_[I],beforeElement:_[D||""],afterElement:_[k||""],newElement:{},canvasId:P.id,deletedStoryboardId:G,fileContentsToSourceFrom:W,fileContentsSourceFilename:$};B?J.newElement=Object.assign({},_[B]):z&&(J.newElement.type="native",J.newElement.nativeTag=z,J.newElement.componentName=z),Z&&(J.newElement.propsToSet=Z),Object.keys(J.newElement).length||delete J.newElement;const U=!!V;return J.hasInstantUpdate=U,{urlPath:`canvases/${E}/parseAndMutate/mutate/addJsxElement`,body:J,successToastMessage:U?void 0:"Successfully added"}}applyCodebaseIdChanges(E){["codebaseIdToAddTo","beforeCodebaseId","afterCodebaseId","addCodebaseId"].forEach(P=>{const I=E[this.changeFields[P]];I&&(this.changeFields[P]=I)})}}e.AddJsxChange=o;class l extends s{constructor(E,_){super(n.MOVE_JSX,"Move Element",E,_)}prepareApiRequest(E,_,P){const{codebaseIdToMoveTo:I,codebaseIdToMove:D,afterCodebaseId:k,beforeCodebaseId:B,expectedCurrentParentCodebaseId:z}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/moveJsxElement`,body:{elementToMove:_[D],newContainerElement:_[I],afterElement:_[k||""],beforeElement:_[B||""],expectedCurrentParent:_[z||""]}}}applyCodebaseIdChanges(E){["codebaseIdToMoveTo","codebaseIdToMove","afterCodebaseId","beforeCodebaseId","expectedCurrentParentCodebaseId"].forEach(P=>{const I=E[this.changeFields[P]];I&&(this.changeFields[P]=I)})}}e.MoveJsxChange=l;class u extends s{constructor(E,_){E.codebaseIdsToRemove=Array.from(new Set(E.codebaseIdsToRemove)),super(n.REMOVE_JSX,"Delete Element",E,_)}prepareApiRequest(E,_,P){const{codebaseIdsToRemove:I}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/removeJsxElement`,body:{elementsToRemove:I.map(D=>_[D]).filter(D=>D)}}}applyCodebaseIdChanges(E){this.changeFields.codebaseIdsToRemove=this.changeFields.codebaseIdsToRemove.map(_=>{const P=E[_];return P||_})}}e.RemoveJsxChange=u;class c extends s{constructor(E,_){super(n.CHANGE_PROP,"Change Prop",E,_)}prepareApiRequest(E,_,P){const{codebaseIdToChange:I,propName:D,propValue:k}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/changePropValue`,body:{elementToModify:_[I],propName:D,propValue:k},successToastMessage:"Prop changed"}}applyCodebaseIdChanges(E){const _=E[this.changeFields.codebaseIdToChange];_&&(this.changeFields.codebaseIdToChange=_)}}e.ChangePropChange=c;class h extends s{constructor(E,_){E.codebaseIdsToWrap=Array.from(new Set(E.codebaseIdsToWrap)),super(n.WRAP_DIV,"Wrap In Div",E,_)}prepareApiRequest(E,_,P){const{codebaseIdsToWrap:I}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/wrapInDiv`,body:{reactElements:I.map(D=>_[D])}}}applyCodebaseIdChanges(E){this.changeFields.codebaseIdsToWrap=this.changeFields.codebaseIdsToWrap.map(_=>{const P=E[_];return P||_})}}e.WrapDivChange=h;class d extends s{constructor(E,_){E.codebaseIdsToDuplicate=Array.from(new Set(E.codebaseIdsToDuplicate)),super(n.DUPLICATE,"Duplicate",E,_)}prepareApiRequest(E,_,P){const{codebaseIdsToDuplicate:I}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/duplicate`,body:{reactElements:I.map(D=>_[D])}}}applyCodebaseIdChanges(E){this.changeFields.codebaseIdsToDuplicate=this.changeFields.codebaseIdsToDuplicate.map(_=>{const P=E[_];return P||_})}}e.DuplicateChange=d;class f extends s{constructor(E,_){super(n.CHANGE_TAG,"Change Tag Name",E,_)}prepareApiRequest(E,_,P){const{codebaseIdToChange:I,newTagName:D}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/changeElementTag`,body:{elementToModify:_[I],newTag:D}}}applyCodebaseIdChanges(E){const _=E[this.changeFields.codebaseIdToChange];_&&(this.changeFields.codebaseIdToChange=_)}}e.ChangeTagChange=f;class m extends s{constructor(E,_){super(n.ADD_CLASS,"Add Class",E,_),this.canInstantUpdateWhileFlushing=!0}prepareApiRequest(E,_,P){const{codebaseIdToAddClass:I,className:D,addingTailwindClass:k,modifiers:B,customProperties:z}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/addClass`,body:{reactElement:_[I],className:D,stylingFramework:k?r.TAILWIND:null,modifiers:B,customProperties:z}}}applyCodebaseIdChanges(E){const _=E[this.changeFields.codebaseIdToAddClass];_&&(this.changeFields.codebaseIdToAddClass=_)}}e.AddClassChange=m;class g extends s{constructor(E,_){super(n.REMOVE_CLASS,"Remove Class",E,_)}prepareApiRequest(E,_,P){const{codebaseIdToRemoveClass:I,className:D}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/removeClass`,body:{reactElement:_[I],className:D}}}applyCodebaseIdChanges(E){const _=E[this.changeFields.codebaseIdToRemoveClass];_&&(this.changeFields.codebaseIdToRemoveClass=_)}}e.RemoveClassChange=g;class y extends s{constructor(E,_){super(n.EDIT_TEXT,"Edit Text",E,_)}prepareApiRequest(E,_,P){const{codebaseIdToEditText:I,newText:D,oldText:k}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/mutate/editText`,body:{element:_[I],newText:D,oldText:k}}}applyCodebaseIdChanges(E){const _=E[this.changeFields.codebaseIdToEditText];_&&(this.changeFields.codebaseIdToEditText=_)}}e.EditTextChange=y;class x extends s{constructor(E,_){var P;super(n.UNDO,"Undo",E,_),!((P=E.changeToUndo)===null||P===void 0)&&P.canInstantUpdateWhileFlushing&&(this.canInstantUpdateWhileFlushing=!0)}prepareApiRequest(E,_,P){const{changeToUndo:I}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/activities/undoChangeToFiles`,body:{latestUuid:I.activityId}}}applyCodebaseIdChanges(E){}}e.UndoChange=x;class w extends s{constructor(E,_){var P;super(n.REDO,"Redo",E,_),!((P=E.changeToRedo)===null||P===void 0)&&P.canInstantUpdateWhileFlushing&&(this.canInstantUpdateWhileFlushing=!0)}prepareApiRequest(E,_,P){const{changeToRedo:I}=this.changeFields;return{urlPath:`canvases/${E}/parseAndMutate/activities/redoChangeToFiles`,body:{changeToRedoId:I.activityId}}}applyCodebaseIdChanges(E){}}e.RedoChange=w;class b extends s{constructor(E,_){super(n.UNKNOWN,"",E,_),this.markProcessedSucceeded(),this.doNotSendInstantUpdate()}prepareApiRequest(E,_,P){throw Error("Unsupported operation")}applyCodebaseIdChanges(E){}}e.UnknownChange=b;const C=A=>{if(!A||!A.type)return null;const E=A.type,_=A.changeFields,P=A.id,D=(()=>{switch(E){case n.STYLING:return new a(_,P);case n.ADD_JSX:return new o(_,P);case n.REMOVE_JSX:return new u(_,P);case n.MOVE_JSX:return new l(_,P);case n.CHANGE_PROP:return new c(_,P);case n.ADD_CLASS:return new m(_,P);case n.REMOVE_CLASS:return new g(_,P);case n.WRAP_DIV:return new h(_,P);case n.CHANGE_TAG:return new f(_,P);case n.DUPLICATE:return new d(_,P);case n.EDIT_TEXT:return new y(_,P);case n.UNDO:return _.changeToUndo=(0,e.reconstructChangeLedgerClass)(_.changeToUndo),new x(_,P);case n.REDO:return _.changeToRedo=(0,e.reconstructChangeLedgerClass)(_.changeToRedo),new w(_,P);case n.UNKNOWN:return new b(_,P);default:throw new Error(`Unknown change type: ${E}`)}})();return Object.keys(A).forEach(k=>{["type","changeFields","id"].includes(k)||(D[k]=A[k])}),D};e.reconstructChangeLedgerClass=C})(nae);var As={};Object.defineProperty(As,"__esModule",{value:!0});As.STORYBOARD_HYDRATION_STATUS=As.SELECT_OR_HOVER_STORYBOARD=As.DELETE_STYLE_CONSTANT=As.FIXED_IFRAME_MESSAGE_IDS=As.INHERITABLE_CSS_PROPS=As.CSS_VALUES_TO_COLLECT_FOR_PARENT=As.CSS_VALUES_TO_COLLECT=void 0;As.CSS_VALUES_TO_COLLECT=new Set(["display","flex-direction","flex-grow","flex-shrink","font-family","align-items","justify-content","column-gap","row-gap","flex-wrap","align-content","overflow","text-align","width","max-width","min-width","height","max-height","min-height","font-size","line-height","padding","padding-top","padding-left","padding-right","padding-bottom","margin","margin-top","margin-left","margin-right","margin-bottom","border-radius","font-family","font-weight","object-fit","background-clip","border-left-style","border-top-style","border-right-style","border-bottom-style","border-left-width","border-top-width","border-right-width","border-bottom-width","border-left-color","border-top-color","border-right-color","border-bottom-color","background-color","color","transform","border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius","letter-spacing","opacity","font-style","text-decoration-line","top","left","right","bottom","position","background-image"]);As.CSS_VALUES_TO_COLLECT_FOR_PARENT=new Set(["display","flex-direction"]);As.INHERITABLE_CSS_PROPS={azimuth:!0,"border-collapse":!0,"border-spacing":!0,"caption-side":!0,color:!0,cursor:!0,direction:!0,"empty-cells":!0,"font-family":!0,"font-size":!0,"font-style":!0,"font-variant":!0,"font-weight":!0,font:!0,"letter-spacing":!0,"line-height":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,"list-style":!0,orphans:!0,quotes:!0,"text-align":!0,"text-indent":!0,"text-transform":!0,visibility:!0,"white-space":!0,widows:!0,"word-spacing":!0};var Vq;(function(e){e.HOVERED_ELEMENT_KEY="HOVERED_ELEMENT_KEY",e.SELECTED_ELEMENT_KEY="SELECTED_ELEMENT_KEY",e.MULTI_SELECTED_ELEMENT_KEYS="MULTI_SELECTED_ELEMENT_KEYS",e.CONTEXT_REQUESTED="CONTEXT_REQUESTED",e.WHEEL_EVENT="WHEEL_EVENT",e.NAV_TREE="NAV_TREE",e.PROCESSED_CSS_RULES_FOR_ELEMENT="PROCESSED_CSS_RULES_FOR_ELEMENT",e.CSS_EVALS_FOR_ELEMENT="CSS_EVALS_FOR_ELEMENT",e.ELEMENT_CLASS_LIST="ELEMENT_CLASS_LIST",e.KEY_DOWN_EVENT="KEY_DOWN_EVENT",e.KEY_UP_EVENT="KEY_UP_EVENT",e.MOUSE_MOVE_EVENT="MOUSE_MOVE_EVENT",e.DRAG_START_EVENT="DRAG_START_EVENT",e.DRAG_END_EVENT="DRAG_END_EVENT",e.DRAG_CANCEL_EVENT="DRAG_CANCEL_EVENT",e.LATEST_HREF="LATEST_HREF",e.LATEST_HYDRATION_ERROR_STATUS="LATEST_HYDRATION_ERROR_STATUS",e.START_EDITING_TEXT="START_EDITING_TEXT",e.EDITED_TEXT="EDITED_TEXT",e.INSTANT_UPDATE_DONE="INSTANT_UPDATE_DONE",e.EDIT_DYNAMIC_TEXT="EDIT_DYNAMIC_TEXT"})(Vq||(As.FIXED_IFRAME_MESSAGE_IDS=Vq={}));As.DELETE_STYLE_CONSTANT=null;As.SELECT_OR_HOVER_STORYBOARD="SELECT_OR_HOVER_STORYBOARD";var Hq;(function(e){e.OTHER_ERROR="other_error",e.ERROR="error",e.NO_ERROR="no_error"})(Hq||(As.STORYBOARD_HYDRATION_STATUS=Hq={}));var XO={},KO={},Znt=function(e){var t,i,r,n,s=[];for(t=e.split(","),r=0,n=t.length;r<n;r+=1)i=t[r],i.length>0&&s.push(WN(i));return s},WN=function(e){var t=e,i,r={a:0,b:0,c:0},n=[],s=/(\[[^\]]+\])/g,a=/(#[^\#\s\+>~\.\[:\)]+)/g,o=/(\.[^\s\+>~\.\[:\)]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,u=/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,c=/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,h=/([^\s\+>~\.\[:]+)/g;return i=function(d,f){var m,g,y,x,w,b;if(d.test(t))for(m=t.match(d),g=0,y=m.length;g<y;g+=1)r[f]+=1,x=m[g],w=t.indexOf(x),b=x.length,n.push({selector:e.substr(w,b),type:f,index:w,length:b}),t=t.replace(x,Array(b+1).join(" "))},function(){var d=function(y){var x,w,b,C;if(y.test(t))for(x=t.match(y),w=0,b=x.length;w<b;w+=1)C=x[w],t=t.replace(C,Array(C.length+1).join("A"))},f=/\\[0-9A-Fa-f]{6}\s?/g,m=/\\[0-9A-Fa-f]{1,5}\s/g,g=/\\./g;d(f),d(m),d(g)}(),function(){var d=/{[^]*/gm,f,m,g,y;if(d.test(t))for(f=t.match(d),m=0,g=f.length;m<g;m+=1)y=f[m],t=t.replace(y,Array(y.length+1).join(" "))}(),i(s,"b"),i(a,"a"),i(o,"b"),i(l,"c"),i(u,"b"),i(c,"b"),t=t.replace(/[\*\s\+>~]/g," "),t=t.replace(/[#\.]/g," "),t=t.replace(/:not/g,"    "),t=t.replace(/:local/g,"      "),t=t.replace(/:global/g,"       "),t=t.replace(/[\(\)]/g," "),i(h,"c"),n.sort(function(d,f){return d.index-f.index}),{selector:e,specificity:"0,"+r.a.toString()+","+r.b.toString()+","+r.c.toString(),specificityArray:[0,r.a,r.b,r.c],parts:n}},Qnt=function(e,t){var i,r,n;if(typeof e=="string"){if(e.indexOf(",")!==-1)throw"Invalid CSS selector";i=WN(e).specificityArray}else if(Array.isArray(e)){if(e.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";i=e}else throw"Invalid CSS selector or specificity array";if(typeof t=="string"){if(t.indexOf(",")!==-1)throw"Invalid CSS selector";r=WN(t).specificityArray}else if(Array.isArray(t)){if(t.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";r=t}else throw"Invalid CSS selector or specificity array";for(n=0;n<4;n+=1){if(i[n]<r[n])return-1;if(i[n]>r[n])return 1}return 0};const Jnt=Object.freeze(Object.defineProperty({__proto__:null,calculate:Znt,compare:Qnt},Symbol.toStringTag,{value:"Module"})),est=hde(Jnt);var dae={},p2={},fae={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createRegularIndex=e.createMulticharIndex=e.emptyRegularIndex=e.emptyMulticharIndex=void 0,e.emptyMulticharIndex={},e.emptyRegularIndex={};function t(n,s){for(var a=s,o=0;o<n.length;o++){var l=o===n.length-1,u=n.charAt(o),c=a[u]||(a[u]={chars:{}});l&&(c.self=n),a=c.chars}}function i(n){if(n.length===0)return e.emptyMulticharIndex;for(var s={},a=0,o=n;a<o.length;a++){var l=o[a];t(l,s)}return s}e.createMulticharIndex=i;function r(n){if(n.length===0)return e.emptyRegularIndex;for(var s={},a=0,o=n;a<o.length;a++){var l=o[a];s[l]=!0}return s}e.createRegularIndex=r})(fae);var Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});Sh.calculatePseudoSignatures=Sh.inverseCategories=Sh.defaultPseudoSignature=Sh.emptyPseudoSignatures=void 0;Sh.emptyPseudoSignatures={};Sh.defaultPseudoSignature={type:"String",optional:!0};function tst(e){var t={type:"NoArgument",optional:!1};function i(a){if(t.type&&t.type!==a&&t.type!=="NoArgument")throw new Error('Conflicting pseudo-class argument type: "'.concat(t.type,'" vs "').concat(a,'".'));t.type=a}for(var r=0,n=e;r<n.length;r++){var s=n[r];s==="NoArgument"&&(t.optional=!0),s==="Formula"&&i("Formula"),s==="FormulaOfSelector"&&(i("Formula"),t.ofSelector=!0),s==="String"&&i("String"),s==="Selector"&&i("Selector")}return t}function pae(e){for(var t={},i=0,r=Object.keys(e);i<r.length;i++){var n=r[i],s=e[n];if(s)for(var a=0,o=s;a<o.length;a++){var l=o[a];(t[l]||(t[l]=[])).push(n)}}return t}Sh.inverseCategories=pae;function ist(e){for(var t=pae(e),i={},r=0,n=Object.keys(t);r<n.length;r++){var s=n[r],a=t[s];a&&(i[s]=tst(a))}return i}Sh.calculatePseudoSignatures=ist;var mae={};(function(e){var t=Nr&&Nr.__assign||function(){return t=Object.assign||function(b){for(var C,A=1,E=arguments.length;A<E;A++){C=arguments[A];for(var _ in C)Object.prototype.hasOwnProperty.call(C,_)&&(b[_]=C[_])}return b},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.pseudoLocationIndex=e.buildPseudoLocationIndex=e.cssSyntaxDefinitions=e.cssModules=e.extendSyntaxDefinition=e.getXmlOptions=void 0;var i={},r={wildcard:!0};function n(b){return b?typeof b=="boolean"?r:b:i}e.getXmlOptions=n;function s(b,C){return function(A,E){return C(b(A),b(E))}}function a(b){return function(C,A){var E=b(C,A);if(!E)throw new Error("Syntax definition cannot be null or undefined.");return E}}function o(b,C){return function(A,E){return E===!0?b:C(A===!0?b:A,E)}}function l(b){return function(C,A){if(!A||!C)return A;if(typeof A!="object"||A===null)throw new Error("Unexpected syntax definition extension type: ".concat(A,"."));for(var E=t({},C),_=0,P=Object.entries(A);_<P.length;_++){var I=P[_],D=I[0],k=I[1];if(D!=="latest"){var B=b[D];E[D]=B(C[D],k)}}return E}}function u(b,C){return C!==void 0?C:b}function c(b,C){return C?b?b.concat(C):C:b}function h(b,C){if(!C)return b;if(!b)return C;for(var A=t({},b),E=0,_=Object.entries(C);E<_.length;E++){var P=_[E],I=P[0],D=P[1];if(!D){delete A[I];continue}var k=b[I];if(!k){A[I]=D;continue}A[I]=k.concat(D)}return A}e.extendSyntaxDefinition=a(l({baseSyntax:u,modules:c,tag:o(r,l({wildcard:u})),ids:u,classNames:u,namespace:o(r,l({wildcard:u})),combinators:c,attributes:l({operators:c,caseSensitivityModifiers:c,unknownCaseSensitivityModifiers:u}),pseudoClasses:l({unknown:u,definitions:h}),pseudoElements:l({unknown:u,notation:u,definitions:s(function(b){return Array.isArray(b)?{NoArgument:b}:b},h)})}));var d={tag:{},ids:!0,classNames:!0,combinators:[],pseudoElements:{unknown:"reject",notation:"singleColon",definitions:["first-letter","first-line"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["link","visited","active"]}}},f=(0,e.extendSyntaxDefinition)(d,{tag:{wildcard:!0},combinators:[">","+"],attributes:{unknownCaseSensitivityModifiers:"reject",operators:["=","~=","|="]},pseudoElements:{definitions:["before","after"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["hover","focus","first-child"],String:["lang"]}}}),m=(0,e.extendSyntaxDefinition)(f,{namespace:{wildcard:!0},combinators:["~"],attributes:{operators:["^=","$=","*="]},pseudoElements:{notation:"both"},pseudoClasses:{definitions:{NoArgument:["root","last-child","first-of-type","last-of-type","only-child","only-of-type","empty","target","enabled","disabled","checked","indeterminate"],Formula:["nth-child","nth-last-child","nth-of-type","nth-last-of-type"],Selector:["not"]}}}),g=(0,e.extendSyntaxDefinition)(m,{combinators:["||"],attributes:{caseSensitivityModifiers:["i","I","s","S"]},pseudoClasses:{definitions:{NoArgument:["any-link","local-link","target-within","scope","current","past","future","focus-within","focus-visible","read-write","read-only","placeholder-shown","default","valid","invalid","in-range","out-of-range","required","optional","blank","user-invalid","playing","paused","autofill","modal","fullscreen","picture-in-picture","defined","loading","popover-open"],Formula:["nth-col","nth-last-col"],String:["dir"],FormulaOfSelector:["nth-child","nth-last-child"],Selector:["current","is","where","has","state"]}},pseudoElements:{definitions:{NoArgument:["marker"],Selector:["part"]}}});e.cssModules={"css-position-1":{latest:!1,pseudoClasses:{definitions:{NoArgument:["static","relative","absolute"]}}},"css-position-2":{latest:!1,pseudoClasses:{definitions:{NoArgument:["static","relative","absolute","fixed"]}}},"css-position-3":{latest:!1,pseudoClasses:{definitions:{NoArgument:["sticky","fixed","absolute","relative","static"]}}},"css-position-4":{latest:!0,pseudoClasses:{definitions:{NoArgument:["sticky","fixed","absolute","relative","static","initial"]}}},"css-scoping-1":{latest:!0,pseudoClasses:{definitions:{NoArgument:["host","host-context"],Selector:["host","host-context"]}},pseudoElements:{definitions:{Selector:["slotted"]}}},"css-pseudo-4":{latest:!0,pseudoElements:{definitions:{NoArgument:["marker","selection","target-text","search-text","spelling-error","grammar-error","backdrop","file-selector-button","prefix","postfix","placeholder","details-content"],String:["highlight"]}}},"css-shadow-parts-1":{latest:!0,pseudoElements:{definitions:{Selector:["part"]}}}};var y=t(t({},g),{modules:Object.entries(e.cssModules).filter(function(b){var C=b[1].latest;return C}).map(function(b){var C=b[0];return C})}),x=(0,e.extendSyntaxDefinition)(y,{pseudoElements:{unknown:"accept"},pseudoClasses:{unknown:"accept"},attributes:{unknownCaseSensitivityModifiers:"accept"}});e.cssSyntaxDefinitions={css1:d,css2:f,css3:m,"selectors-3":m,"selectors-4":g,latest:y,progressive:x};function w(){for(var b={pseudoClasses:{},pseudoElements:{}},C=["css1","css2","css3","selectors-3","selectors-4"],A=0,E=C;A<E.length;A++){var _=E[A],P=e.cssSyntaxDefinitions[_];if(P.pseudoClasses&&typeof P.pseudoClasses=="object"){var I=P.pseudoClasses.definitions;if(I)for(var D=0,k=Object.entries(I);D<k.length;D++)for(var B=k[D],z=B[1],W=0,$=z;W<$.length;W++){var Z=$[W];b.pseudoClasses[Z]||(b.pseudoClasses[Z]=[]),b.pseudoClasses[Z].includes(_)||b.pseudoClasses[Z].push(_)}}if(P.pseudoElements&&typeof P.pseudoElements=="object"){var I=P.pseudoElements.definitions;if(I)if(Array.isArray(I))for(var G=0,V=I;G<V.length;G++){var J=V[G];b.pseudoElements[J]||(b.pseudoElements[J]=[]),b.pseudoElements[J].includes(_)||b.pseudoElements[J].push(_)}else for(var U=0,ie=Object.values(I);U<ie.length;U++)for(var z=ie[U],se=0,ee=z;se<ee.length;se++){var ve=ee[se];b.pseudoElements[ve]||(b.pseudoElements[ve]=[]),b.pseudoElements[ve].includes(_)||b.pseudoElements[ve].push(_)}}}for(var _e=0,he=Object.entries(e.cssModules);_e<he.length;_e++){var De=he[_e],we=De[0],Le=De[1];if(Le.pseudoClasses&&typeof Le.pseudoClasses=="object"){var I=Le.pseudoClasses.definitions;if(I)for(var Te=0,ke=Object.values(I);Te<ke.length;Te++)for(var z=ke[Te],Xe=0,et=z;Xe<et.length;Xe++){var Ze=et[Xe];b.pseudoClasses[Ze]||(b.pseudoClasses[Ze]=[]),b.pseudoClasses[Ze].includes(we)||b.pseudoClasses[Ze].push(we)}}if(Le.pseudoElements&&typeof Le.pseudoElements=="object"){var I=Le.pseudoElements.definitions;if(I)if(Array.isArray(I))for(var st=0,_t=I;st<_t.length;st++){var St=_t[st];b.pseudoElements[St]||(b.pseudoElements[St]=[]),b.pseudoElements[St].includes(we)||b.pseudoElements[St].push(we)}else for(var ue=0,Ee=Object.values(I);ue<Ee.length;ue++)for(var z=Ee[ue],Ae=0,Ge=z;Ae<Ge.length;Ae++){var ae=Ge[Ae];b.pseudoElements[ae]||(b.pseudoElements[ae]=[]),b.pseudoElements[ae].includes(we)||b.pseudoElements[ae].push(we)}}}return b}e.buildPseudoLocationIndex=w,e.pseudoLocationIndex=w()})(mae);var uF={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.escapeString=e.escapeIdentifier=e.maxHexLength=e.digitsChars=e.quoteChars=e.whitespaceChars=e.stringRenderEscapeChars=e.identEscapeChars=e.isHex=e.isIdent=e.isIdentStart=void 0;function t(a){return a>="a"&&a<="z"||a>="A"&&a<="Z"||a==="-"||a==="_"||a==="\\"||a>=" "}e.isIdentStart=t;function i(a){return a>="a"&&a<="z"||a>="A"&&a<="Z"||a>="0"&&a<="9"||a==="-"||a==="_"||a>=" "}e.isIdent=i;function r(a){return a>="a"&&a<="f"||a>="A"&&a<="F"||a>="0"&&a<="9"}e.isHex=r,e.identEscapeChars={"!":!0,'"':!0,"#":!0,$:!0,"%":!0,"&":!0,"'":!0,"(":!0,")":!0,"*":!0,"+":!0,",":!0,".":!0,"/":!0,";":!0,"<":!0,"=":!0,">":!0,"?":!0,"@":!0,"[":!0,"\\":!0,"]":!0,"^":!0,"`":!0,"{":!0,"|":!0,"}":!0,"~":!0},e.stringRenderEscapeChars={"\n":!0,"\r":!0,"	":!0,"\f":!0,"\v":!0},e.whitespaceChars={" ":!0,"	":!0,"\n":!0,"\r":!0,"\f":!0},e.quoteChars={'"':!0,"'":!0},e.digitsChars={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0},e.maxHexLength=6;function n(a){for(var o=a.length,l="",u=0;u<o;){var c=a.charAt(u);if(e.identEscapeChars[c]||c==="-"&&u===1&&a.charAt(0)==="-")l+="\\"+c;else if(c==="-"||c==="_"||c>="A"&&c<="Z"||c>="a"&&c<="z"||c>="0"&&c<="9"&&u!==0&&!(u===1&&a.charAt(0)==="-"))l+=c;else{var h=c.charCodeAt(0);if((h&63488)===55296){var d=a.charCodeAt(u++);if((h&64512)!==55296||(d&64512)!==56320)throw Error("UCS-2(decode): illegal sequence");h=((h&1023)<<10)+(d&1023)+65536}l+="\\"+h.toString(16)+" "}u++}return l.trim()}e.escapeIdentifier=n;function s(a){for(var o=a.length,l="",u=0;u<o;){var c=a.charAt(u);c==='"'?c='\\"':c==="\\"?c="\\\\":e.stringRenderEscapeChars[c]&&(c="\\"+c.charCodeAt(0).toString(16)+(u===o-1?"":" ")),l+=c,u++}return'"'.concat(l,'"')}e.escapeString=s})(uF);Object.defineProperty(p2,"__esModule",{value:!0});p2.createParser=void 0;var Zf=fae,Qf=Sh,rh=mae,fa=uF,$O="css-selector-parser parse error: ";function rst(e){e===void 0&&(e={});var t=e.syntax,i=t===void 0?"latest":t,r=e.substitutes,n=e.strict,s=n===void 0?!0:n,a=e.modules,o=typeof i=="object"?i:rh.cssSyntaxDefinitions[i];if(o.baseSyntax&&(o=(0,rh.extendSyntaxDefinition)(rh.cssSyntaxDefinitions[o.baseSyntax],o)),o.modules&&o.modules.length>0)for(var l=0,u=o.modules;l<u.length;l++){var c=u[l],h=rh.cssModules[c];h&&(o=(0,rh.extendSyntaxDefinition)(h,o))}if(a&&a.length>0)for(var d=0,f=a;d<f.length;d++){var m=f[d],h=rh.cssModules[m];h&&(o=(0,rh.extendSyntaxDefinition)(h,o))}var g=o.tag?[!0,!!(0,rh.getXmlOptions)(o.tag).wildcard]:[!1,!1],y=g[0],x=g[1],w=!!o.ids,b=!!o.classNames,C=!!o.namespace,A=o.namespace&&(o.namespace===!0||o.namespace.wildcard===!0);if(C&&!y)throw new Error("".concat($O,"Namespaces cannot be enabled while tags are disabled."));var E=!!r,_=o.combinators?(0,Zf.createMulticharIndex)(o.combinators):Zf.emptyMulticharIndex,P=o.attributes?[!0,o.attributes.operators?(0,Zf.createMulticharIndex)(o.attributes.operators):Zf.emptyMulticharIndex,o.attributes.caseSensitivityModifiers?(0,Zf.createRegularIndex)(o.attributes.caseSensitivityModifiers):Zf.emptyRegularIndex,o.attributes.unknownCaseSensitivityModifiers==="accept"]:[!1,Zf.emptyMulticharIndex,Zf.emptyRegularIndex,!1],I=P[0],D=P[1],k=P[2],B=P[3],z=B||Object.keys(k).length>0,W=o.pseudoClasses?[!0,o.pseudoClasses.definitions?(0,Qf.calculatePseudoSignatures)(o.pseudoClasses.definitions):Qf.emptyPseudoSignatures,o.pseudoClasses.unknown==="accept"]:[!1,Qf.emptyPseudoSignatures,!1],$=W[0],Z=W[1],G=W[2],V=o.pseudoElements?[!0,o.pseudoElements.notation==="singleColon"||o.pseudoElements.notation==="both",!o.pseudoElements.notation||o.pseudoElements.notation==="doubleColon"||o.pseudoElements.notation==="both",o.pseudoElements.definitions?(0,Qf.calculatePseudoSignatures)(Array.isArray(o.pseudoElements.definitions)?{NoArgument:o.pseudoElements.definitions}:o.pseudoElements.definitions):Qf.emptyPseudoSignatures,o.pseudoElements.unknown==="accept"]:[!1,!1,!1,Qf.emptyPseudoSignatures,!1],J=V[0],U=V[1],ie=V[2],se=V[3],ee=V[4],ve="",_e=ve.length,he=0,De="",we=function(Qe){return De===Qe},Le=function(){return we("*")||(0,fa.isIdentStart)(De)},Te=function(Qe){he=Qe,De=ve.charAt(he)},ke=function(){he++,De=ve.charAt(he)},Xe=function(){var Qe=De;return he++,De=ve.charAt(he),Qe};function et(Qe){var mt=Math.min(_e-1,he),Ht=new Error("".concat($O).concat(Qe," Pos: ").concat(mt,"."));throw Ht.position=mt,Ht.name="ParserError",Ht}function Ze(Qe,mt){if(!Qe)return et(mt)}var st=function(){Ze(he<_e,"Unexpected end of input.")},_t=function(){return he>=_e},St=function(Qe){Ze(he<_e,'Expected "'.concat(Qe,'" but end of input reached.')),Ze(De===Qe,'Expected "'.concat(Qe,'" but "').concat(De,'" found.')),he++,De=ve.charAt(he)};function ue(Qe){var mt=Ee(Qe,he);if(mt)return he+=mt.length,De=ve.charAt(he),mt}function Ee(Qe,mt){var Ht=ve.charAt(mt),Wt=Qe[Ht];if(Wt){var Ue=Ee(Wt.chars,mt+1);if(Ue)return Ue;if(Wt.self)return Wt.self}}function Ae(){for(var Qe=Xe(),mt=1;(0,fa.isHex)(De)&&mt<fa.maxHexLength;)Qe+=Xe(),mt++;return Ne(),String.fromCharCode(parseInt(Qe,16))}function Ge(Qe){var mt="";for(St(Qe);he<_e;){if(we(Qe))return ke(),mt;we("\\")?(ke(),we(Qe)?(mt+=Qe,ke()):De===`
`||De==="\f"?ke():De==="\r"?(ke(),we(`
`)&&ke()):(0,fa.isHex)(De)?mt+=Ae():(mt+=De,ke())):(mt+=De,ke())}return mt}function ae(){if(!(0,fa.isIdentStart)(De))return null;for(var Qe="";we("-");)Qe+=De,ke();for(Qe==="-"&&!(0,fa.isIdent)(De)&&!we("\\")&&et("Identifiers cannot consist of a single hyphen."),s&&Qe.length>=2&&et("Identifiers cannot start with two hyphens with strict mode on."),fa.digitsChars[De]&&et("Identifiers cannot start with hyphens followed by digits.");he<_e;)if((0,fa.isIdent)(De))Qe+=Xe();else if(we("\\"))ke(),st(),(0,fa.isHex)(De)?Qe+=Ae():Qe+=Xe();else break;return Qe}function te(){for(var Qe="";he<_e&&!we(")");)if(we("\\")){if(ke(),_t()&&!s)return(Qe+"\\").trim();st(),(0,fa.isHex)(De)?Qe+=Ae():Qe+=Xe()}else Qe+=Xe();return Qe.trim()}function Ne(){if(De===" "||De==="	"||De==="\f"||De===`
`){ke();return}De==="\r"&&ke(),De===`
`&&ke()}function Re(){for(;fa.whitespaceChars[De];)ke()}function Y(Qe){Qe===void 0&&(Qe=!1),Re();for(var mt=[kt(Qe)];we(",");)ke(),Re(),mt.push(kt(Qe));return{type:"Selector",rules:mt}}function Me(){St("["),Re();var Qe;if(we("|")){Ze(C,"Namespaces are not enabled."),ke();var mt=ae();Ze(mt,"Expected attribute name."),Qe={type:"Attribute",name:mt,namespace:{type:"NoNamespace"}}}else if(we("*")){Ze(C,"Namespaces are not enabled."),Ze(A,"Wildcard namespace is not enabled."),ke(),St("|");var Ht=ae();Ze(Ht,"Expected attribute name."),Qe={type:"Attribute",name:Ht,namespace:{type:"WildcardNamespace"}}}else{var Wt=ae();if(Ze(Wt,"Expected attribute name."),Qe={type:"Attribute",name:Wt},we("|")){var Ue=he;if(ke(),(0,fa.isIdentStart)(De)){Ze(C,"Namespaces are not enabled.");var dt=ae();Ze(dt,"Expected attribute name."),Qe={type:"Attribute",name:dt,namespace:{type:"NamespaceName",name:Wt}}}else Te(Ue)}}if(Ze(Qe.name,"Expected attribute name."),Re(),_t()&&!s)return Qe;if(we("]"))ke();else{if(Qe.operator=ue(D),Ze(Qe.operator,"Expected a valid attribute selector operator."),Re(),st(),fa.quoteChars[De])Qe.value={type:"String",value:Ge(De)};else if(E&&we("$")){ke();var gt=ae();Ze(gt,"Expected substitute name."),Qe.value={type:"Substitution",name:gt}}else{var Bt=ae();Ze(Bt,"Expected attribute value."),Qe.value={type:"String",value:Bt}}if(Re(),_t()&&!s)return Qe;if(!we("]")){var ei=ae();if(Ze(ei,"Expected end of attribute selector."),Qe.caseSensitivityModifier=ei,Ze(z,"Attribute case sensitivity modifiers are not enabled."),Ze(B||k[Qe.caseSensitivityModifier],"Unknown attribute case sensitivity modifier."),Re(),_t()&&!s)return Qe}St("]")}return Qe}function Ke(){for(var Qe="";fa.digitsChars[De];)Qe+=Xe();return Ze(Qe!=="","Formula parse error."),parseInt(Qe)}var ot=function(){return we("-")||we("+")||fa.digitsChars[De]};function qe(){if(we("e")||we("o")){var Qe=ae();if(Qe==="even")return Re(),[2,0];if(Qe==="odd")return Re(),[2,1]}var mt=null,Ht=1;if(we("-")&&(ke(),Ht=-1),ot()&&(we("+")&&ke(),mt=Ke(),!we("\\")&&!we("n")))return[0,mt*Ht];mt===null&&(mt=1),mt*=Ht;var Wt;if(we("\\")?(ke(),(0,fa.isHex)(De)?Wt=Ae():Wt=Xe()):Wt=Xe(),Ze(Wt==="n",'Formula parse error: expected "n".'),Re(),we("+")||we("-")){var Ue=we("+")?1:-1;return ke(),Re(),[mt,Ue*Ke()]}else return[mt,0]}function It(Qe,mt,Ht){var Wt;if(we("(")){if(ke(),Re(),E&&we("$")){ke();var Ue=ae();Ze(Ue,"Expected substitute name."),Wt={type:"Substitution",name:Ue}}else if(Ht.type==="String")Wt={type:"String",value:te()},Ze(Wt.value,"Expected ".concat(mt," argument value."));else if(Ht.type==="Selector")Wt=Y(!0);else if(Ht.type==="Formula"){var dt=qe(),gt=dt[0],Bt=dt[1];if(Wt={type:"Formula",a:gt,b:Bt},Ht.ofSelector&&(Re(),we("o")||we("\\"))){var ei=ae();Ze(ei==="of","Formula of selector parse error."),Re(),Wt={type:"FormulaOfSelector",a:gt,b:Bt,selector:kt()}}}else return et("Invalid ".concat(mt," signature."));if(Re(),_t()&&!s)return Wt;St(")")}else Ze(Ht.optional,"Argument is required for ".concat(mt,' "').concat(Qe,'".'));return Wt}function Ot(){if(we("*"))return Ze(x,"Wildcard tag name is not enabled."),ke(),{type:"WildcardTag"};if((0,fa.isIdentStart)(De)){Ze(y,"Tag names are not enabled.");var Qe=ae();return Ze(Qe,"Expected tag name."),{type:"TagName",name:Qe}}else return et("Expected tag name.")}function Dt(){if(we("*")){var Qe=he;if(ke(),!we("|")||(ke(),!Le()))return Te(Qe),Ot();Ze(C,"Namespaces are not enabled."),Ze(A,"Wildcard namespace is not enabled.");var mt=Ot();return mt.namespace={type:"WildcardNamespace"},mt}else if(we("|")){Ze(C,"Namespaces are not enabled."),ke();var mt=Ot();return mt.namespace={type:"NoNamespace"},mt}else if((0,fa.isIdentStart)(De)){var Ht=ae();if(Ze(Ht,"Expected tag name."),!we("|"))return Ze(y,"Tag names are not enabled."),{type:"TagName",name:Ht};var Qe=he;if(ke(),!Le())return Te(Qe),{type:"TagName",name:Ht};Ze(C,"Namespaces are not enabled.");var mt=Ot();return mt.namespace={type:"NamespaceName",name:Ht},mt}else return et("Expected tag name.")}function kt(Qe){var mt,Ht;Qe===void 0&&(Qe=!1);var Wt={type:"Rule",items:[]};if(Qe){var Ue=ue(_);Ue&&(Wt.combinator=Ue,Re())}for(;he<_e;)if(Le())Ze(Wt.items.length===0,"Unexpected tag/namespace start."),Wt.items.push(Dt());else if(we("|")){var dt=he;if(ke(),Le())Ze(Wt.items.length===0,"Unexpected tag/namespace start."),Te(dt),Wt.items.push(Dt());else{Te(dt);break}}else if(we(".")){Ze(b,"Class names are not enabled."),ke();var gt=ae();Ze(gt,"Expected class name."),Wt.items.push({type:"ClassName",name:gt})}else if(we("#")){Ze(w,"IDs are not enabled."),ke();var Bt=ae();Ze(Bt,"Expected ID name."),Wt.items.push({type:"Id",name:Bt})}else if(we("["))Ze(I,"Attributes are not enabled."),Wt.items.push(Me());else if(we(":")){var ei=!1,zi=!1;ke(),we(":")&&(Ze(J,"Pseudo elements are not enabled."),Ze(ie,"Pseudo elements double colon notation is not enabled."),ei=!0,ke());var vi=ae();if(Ze(ei||vi,"Expected pseudo-class name."),Ze(!ei||vi,"Expected pseudo-element name."),Ze(vi,"Expected pseudo-class name."),!(!ei||ee||Object.prototype.hasOwnProperty.call(se,vi))){var Yi=rh.pseudoLocationIndex.pseudoElements[vi],wn='Unknown pseudo-element "'.concat(vi,'"');Yi&&Yi.length>0&&(wn+=". It is defined in: ".concat(Yi.join(", "))),et(wn+".")}if(zi=J&&(ei||!ei&&U&&Object.prototype.hasOwnProperty.call(se,vi)),zi){var yr=(mt=se[vi])!==null&&mt!==void 0?mt:ee&&Qf.defaultPseudoSignature,Rn={type:"PseudoElement",name:vi},Yr=It(vi,"pseudo-element",yr);Yr&&(Ze(Yr.type!=="Formula"&&Yr.type!=="FormulaOfSelector","Pseudo-elements cannot have formula argument."),Rn.argument=Yr),Wt.items.push(Rn)}else{Ze($,"Pseudo-classes are not enabled.");var yr=(Ht=Z[vi])!==null&&Ht!==void 0?Ht:G&&Qf.defaultPseudoSignature;if(!yr){var Yi=rh.pseudoLocationIndex.pseudoClasses[vi],wn='Unknown pseudo-class: "'.concat(vi,'"');Yi&&Yi.length>0&&(wn+=". It is defined in: ".concat(Yi.join(", "))),et(wn+".")}var Yr=It(vi,"pseudo-class",yr),Hn={type:"PseudoClass",name:vi};Yr&&(Hn.argument=Yr),Wt.items.push(Hn)}}else break;if(Wt.items.length===0)return _t()?et("Expected rule but end of input reached."):et('Expected rule but "'.concat(De,'" found.'));if(Re(),!_t()&&!we(",")&&!we(")")){var Ue=ue(_);Re(),Wt.nestedRule=kt(),Wt.nestedRule.combinator=Ue}return Wt}return function(Qe){if(typeof Qe!="string")throw new Error("".concat($O,"Expected string input."));return ve=Qe,_e=ve.length,he=0,De=ve.charAt(0),Y()}}p2.createParser=rst;var m2={};Object.defineProperty(m2,"__esModule",{value:!0});m2.render=void 0;var Kl=uF,gae="css-selector-parser render error: ";function Wq(e){if(e.type==="WildcardNamespace")return"*|";if(e.type==="NamespaceName")return"".concat((0,Kl.escapeIdentifier)(e.name),"|");if(e.type==="NoNamespace")return"|";throw new Error("".concat(gae,"Unknown namespace type: ").concat(e.type,"."))}function nst(e){return"$".concat((0,Kl.escapeIdentifier)(e.name))}function Gq(e,t){if(e){var i="".concat(e===1?"":e===-1?"-":e,"n");return t&&(i+="".concat(t>0?"+":"").concat(t)),i}else return String(t)}function ag(e){if(e.type==="Selector")return e.rules.map(ag).join(", ");if(e.type==="Rule"){var t="",i=e.items,r=e.combinator,n=e.nestedRule;r&&(t+="".concat(r," "));for(var s=0,a=i;s<a.length;s++){var o=a[s];t+=ag(o)}return n&&(t+=" ".concat(ag(n))),t}else if(e.type==="TagName"||e.type==="WildcardTag"){var t="",l=e.namespace;return l&&(t+=Wq(l)),e.type==="TagName"?t+=(0,Kl.escapeIdentifier)(e.name):e.type==="WildcardTag"&&(t+="*"),t}else{if(e.type==="Id")return"#".concat((0,Kl.escapeIdentifier)(e.name));if(e.type==="ClassName")return".".concat((0,Kl.escapeIdentifier)(e.name));if(e.type==="Attribute"){var u=e.name,l=e.namespace,c=e.operator,h=e.value,d=e.caseSensitivityModifier,t="[";if(l&&(t+=Wq(l)),t+=(0,Kl.escapeIdentifier)(u),c&&h){if(t+=c,h.type==="String")t+=(0,Kl.escapeString)(h.value);else if(h.type==="Substitution")t+=nst(h);else throw new Error("Unknown attribute value type: ".concat(h.type,"."));d&&(t+=" ".concat((0,Kl.escapeIdentifier)(d)))}return t+="]",t}else if(e.type==="PseudoClass"){var f=e.name,m=e.argument,t=":".concat((0,Kl.escapeIdentifier)(f));return m&&(t+="(".concat(m.type==="String"?(0,Kl.escapeIdentifier)(m.value):ag(m),")")),t}else if(e.type==="PseudoElement"){var g=e.name,m=e.argument,t="::".concat((0,Kl.escapeIdentifier)(g));return m&&(t+="(".concat(m.type==="String"?(0,Kl.escapeIdentifier)(m.value):ag(m),")")),t}else{if(e.type==="String")throw new Error("".concat(gae,"String cannot be rendered outside of context."));if(e.type==="Formula")return Gq(e.a,e.b);if(e.type==="FormulaOfSelector")return Gq(e.a,e.b)+" of "+ag(e.selector);if(e.type==="Substitution")return"$".concat((0,Kl.escapeIdentifier)(e.name))}}throw new Error("Unknown type specified to render method: ".concat(e.type,"."))}m2.render=ag;var g2={},Gs=Nr&&Nr.__assign||function(){return Gs=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Gs.apply(this,arguments)};Object.defineProperty(g2,"__esModule",{value:!0});g2.ast=void 0;function lo(e){return function(t,i){var r;return r={},r[t]=function(n){return Gs({type:e},n)},r[i]=function(n){return typeof n=="object"&&n!==null&&n.type===e},r}}g2.ast=Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs(Gs({},lo("Selector")("selector","isSelector")),lo("Rule")("rule","isRule")),lo("TagName")("tagName","isTagName")),lo("Id")("id","isId")),lo("ClassName")("className","isClassName")),lo("WildcardTag")("wildcardTag","isWildcardTag")),lo("NamespaceName")("namespaceName","isNamespaceName")),lo("WildcardNamespace")("wildcardNamespace","isWildcardNamespace")),lo("NoNamespace")("noNamespace","isNoNamespace")),lo("Attribute")("attribute","isAttribute")),lo("PseudoClass")("pseudoClass","isPseudoClass")),lo("PseudoElement")("pseudoElement","isPseudoElement")),lo("String")("string","isString")),lo("Formula")("formula","isFormula")),lo("FormulaOfSelector")("formulaOfSelector","isFormulaOfSelector")),lo("Substitution")("substitution","isSubstitution"));(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ast=e.render=e.createParser=void 0;var t=p2;Object.defineProperty(e,"createParser",{enumerable:!0,get:function(){return t.createParser}});var i=m2;Object.defineProperty(e,"render",{enumerable:!0,get:function(){return i.render}});var r=g2;Object.defineProperty(e,"ast",{enumerable:!0,get:function(){return r.ast}})})(dae);var yv={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.removeSessionStorageItem=e.setSessionStorageItem=e.getSessionStorageItem=e.removeMemoryStorageItem=e.setMemoryStorageItem=e.getMemoryStorageItem=e.CURRENT_NAV_TREE=e.ELEMENT_KEY_TO_NAV_NODE=e.ELEMENT_KEY_TO_LOOKUP_LIST=e.NAV_TREE_CALLBACKS=e.IS_FLUSHING=e.HOT_RELOADING=e.TEXT_EDIT=e.HOVERED_ELEMENT_KEY=e.MULTI_SELECTED_ELEMENT_KEYS=e.SELECTED_ELEMENT_KEY=e.SAVED_STORYBOARD_COMPONENT_FILENAME=e.ORIGINAL_STORYBOARD_URL=e.STORYBOARD_TYPE=e.STORYBOARD_COMPONENT=e.SCOPE_LOOKUP=e.TREE_ELEMENT_LOOKUP=void 0,e.TREE_ELEMENT_LOOKUP="TREE_ELEMENT_LOOKUP",e.SCOPE_LOOKUP="SCOPE_LOOKUP",e.STORYBOARD_COMPONENT="STORYBOARD_COMPONENT",e.STORYBOARD_TYPE="STORYBOARD_TYPE",e.ORIGINAL_STORYBOARD_URL="ORIGINAL_STORYBOARD_URL",e.SAVED_STORYBOARD_COMPONENT_FILENAME="SAVED_STORYBOARD_COMPONENT_FILENAME",e.SELECTED_ELEMENT_KEY="SELECTED_ELEMENT_KEY",e.MULTI_SELECTED_ELEMENT_KEYS="MULTI_SELECTED_ELEMENT_KEYS",e.HOVERED_ELEMENT_KEY="HOVERED_ELEMENT_KEY",e.TEXT_EDIT="TEXT_EDIT",e.HOT_RELOADING="HOT_RELOADING",e.IS_FLUSHING="IS_FLUSHING",e.NAV_TREE_CALLBACKS="NAV_TREE_CALLBACKS",e.ELEMENT_KEY_TO_LOOKUP_LIST="ELEMENT_KEY_TO_LOOKUP_LIST",e.ELEMENT_KEY_TO_NAV_NODE="ELEMENT_KEY_TO_NAV_NODE",e.CURRENT_NAV_TREE="CURRENT_NAV_TREE";const t={},i=l=>t[l];e.getMemoryStorageItem=i;const r=(l,u)=>{t[l]=u,u||delete t[l]};e.setMemoryStorageItem=r;const n=l=>{delete t[l]};e.removeMemoryStorageItem=n;const s=(l,u)=>sessionStorage.getItem(`${u}_${l}`);e.getSessionStorageItem=s;const a=(l,u,c)=>{if(!u){(0,e.removeSessionStorageItem)(l,c);return}sessionStorage.setItem(`${c}_${l}`,u)};e.setSessionStorageItem=a;const o=(l,u)=>{sessionStorage.removeItem(`${u}_${l}`)};e.removeSessionStorageItem=o})(yv);var ZO={},QO={},cF={};(function(e){var t=Nr&&Nr.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(e,"__esModule",{value:!0}),e.teardownEditableText=e.setupEditableText=e.getEditingInfo=e.currentlyEditing=e.hasTextContents=e.canEditText=void 0;const i=xv(),r=yv,n=As,s=t(w1),a=m=>{const y=((0,r.getMemoryStorageItem)(r.TREE_ELEMENT_LOOKUP)||{})[m.codebaseId];return y?y.staticTextContents:!1};e.canEditText=a;const o=m=>{if(!m)return!1;let g=!1,y=!1;return m.childNodes.forEach(x=>{if(x.nodeType===Node.TEXT_NODE){g=!0;return}y=!0}),g&&!y};e.hasTextContents=o;const l=()=>{const m=(0,r.getMemoryStorageItem)(r.TEXT_EDIT);return m!=null};e.currentlyEditing=l;const u=m=>{(0,r.setMemoryStorageItem)(r.TEXT_EDIT,m)},c=()=>(0,r.getMemoryStorageItem)(r.TEXT_EDIT);e.getEditingInfo=c;const h=()=>{(0,r.setMemoryStorageItem)(r.TEXT_EDIT,null)},d=(m,g,y)=>{const x=`.${i.ELEMENT_KEY_PREFIX}${m.getKey()}`,w=(0,s.default)(x).get(0);if(!w)return;const b=(0,s.default)(w).text();u({key:m.getKey(),originalText:b}),g.postMessage({id:n.FIXED_IFRAME_MESSAGE_IDS.START_EDITING_TEXT,data:{key:m.getKey(),oldText:b}}),(0,s.default)(w).attr("contenteditable","plaintext-only").trigger("focus"),(0,s.default)(w).css({cursor:"text",outline:"none",border:"none"}),(0,s.default)(w).on("blur",()=>(0,e.teardownEditableText)(g,y))};e.setupEditableText=d;const f=(m,g)=>{var y;const x=(0,e.getEditingInfo)();if(!(0,e.currentlyEditing)()||(h(),!x))return;const w=`.${i.ELEMENT_KEY_PREFIX}${x.key}`,b=(0,s.default)(w).get(0);if(!b)return;const C=(0,s.default)(b).text();m.postMessage({id:n.FIXED_IFRAME_MESSAGE_IDS.EDITED_TEXT,data:{key:x.key,newText:C,oldText:x.originalText}}),(y=window.getSelection())===null||y===void 0||y.removeAllRanges(),(0,s.default)(b).removeAttr("contenteditable").off("blur").css({cursor:"",outline:"",border:""}),h()};e.teardownEditableText=f})(cF);var qq;function vae(){return qq||(qq=1,function(e){var t=Nr&&Nr.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeOutline=e.updateOutlines=e.clearAllOutlines=e.getOutlineElement=e.OutlineType=e.PRIMARY_COMPONENT_OUTLINE_COLOR=e.SECONDARY_OUTLINE_COLOUR=e.PRIMARY_OUTLINE_COLOUR=void 0;const i=xv(),r=yv,n=t(w1),s=yf,a=cF,o=As;e.PRIMARY_OUTLINE_COLOUR="#4597F7",e.SECONDARY_OUTLINE_COLOUR="#4597F7",e.PRIMARY_COMPONENT_OUTLINE_COLOR="#6183e4";var l;(function(w){w[w.PRIMARY=0]="PRIMARY",w[w.SECONDARY=1]="SECONDARY",w[w.CHILD=2]="CHILD",w[w.MOVE=3]="MOVE"})(l||(e.OutlineType=l={}));const u=()=>(0,r.getMemoryStorageItem)("aiContext")?{primary:"#6858f5",secondary:"#6858f5",component:"#5246C2"}:{primary:e.PRIMARY_OUTLINE_COLOUR,secondary:e.SECONDARY_OUTLINE_COLOUR,component:e.PRIMARY_COMPONENT_OUTLINE_COLOR},c=(w,b,C)=>`url("data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' stroke='${w.replace("#","%23")}' stroke-width='${b}' stroke-dasharray='1%2c ${C}' stroke-dashoffset='0' stroke-linecap='square'/%3e%3c/svg%3e")`,h=w=>w.charAt(0).toUpperCase()+w.slice(1),d=()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>',f=(w,b,C)=>{const A=document.createElement("div"),E=document.createElement("div");E.innerText="Edit Dynamic Text",E.classList.add(i.EDIT_TEXT_BUTTON),E.classList.add(i.OUTLINE_CLASS);const _=document.createElement("div");return _.innerHTML=d(),_.style.width="22px",_.style.height="22px",_.classList.add(i.EDIT_TEXT_BUTTON),_.classList.add(i.OUTLINE_CLASS),A.appendChild(_),A.appendChild(E),A.classList.add(i.OUTLINE_CLASS),A.classList.add(i.EDIT_TEXT_BUTTON),A.style.color="white",A.style.cursor="pointer",A.style.backgroundColor=b,A.style.padding="4px 12px 4px 12px",A.style.borderRadius="8px",A.style.fontSize="20px",A.style.pointerEvents="auto",A.style.display="flex",A.style.flexDirection="row",A.style.alignItems="center",A.style.justifyContent="center",A.style.gap="8px",A.addEventListener("pointerdown",P=>{P.preventDefault(),P.stopPropagation(),w.postMessage({id:o.FIXED_IFRAME_MESSAGE_IDS.EDIT_DYNAMIC_TEXT,elementKey:C})}),A.addEventListener("pointerup",P=>{P.preventDefault(),P.stopPropagation()}),A},m=(w,b,C,A,E,_,P,I,D,k)=>{const B=u(),z=C,W=A,$=(0,r.getMemoryStorageItem)("zoomPerc"),Z=$?1/Number($):1,G=document.createElement("div");if(G.classList.add(i.OUTLINE_CLASS),b===l.CHILD||b===l.MOVE){const J=5*Z;G.style.backgroundImage=c(D?B.component:B.primary,Math.max(1,Math.round(J)),Math.max(3,Math.round(J*3)))}else{const J=b===l.SECONDARY?.5*Z:1*Z;J>=.5&&(G.style.outline=`${J}px solid ${b===l.SECONDARY?B.secondary:D?B.component:B.primary}`),G.style.border=`${J>=.5?J:J*2}px solid ${b===l.SECONDARY?B.secondary:D?B.component:B.primary}`}switch(G.style.position="fixed",G.style.pointerEvents="none",b){case l.PRIMARY:G.style.zIndex="2000000002";break;case l.SECONDARY:G.style.zIndex="2000000001";break;case l.CHILD:G.style.zIndex="2000000000";break;case l.MOVE:G.style.zIndex="2000000003";break}G.style.boxSizing="border-box",G.style.left=z+"px",G.style.top=W+"px",G.style.width=E+"px",G.style.height=_+"px",G.style.cursor="default !important";const V=Math.min(2,Z);if(b===l.PRIMARY&&P){const J=document.createElement("div");G.appendChild(J),J.classList.add(i.OUTLINE_CLASS),J.innerHTML=`${Math.round(E)} x ${Math.round(_)}`,J.style.color="white",J.style.backgroundColor=D?B.component:B.primary,J.style.padding="4px 12px 4px 12px",J.style.height="38px",J.style.borderRadius="8px",J.style.position="absolute",J.style.left=`calc(${E}px / 2)`,J.style.fontSize="20px",J.style.whiteSpace="nowrap";const U=-Math.max(22,45+(52*V-52)/2);J.style.bottom=`${U}px`,J.style.transform=`scale(${V}) translateX(${-50/V}%)`}if(P&&I){const J=document.createElement("div");G.appendChild(J),J.style.display="flex",J.style.width=E/V+"px",J.style.justifyContent="space-between",J.style.flexDirection="row",J.style.gap="4px",J.style.position="absolute",J.style.left="0px",J.style.transform=`scale(${V}) translateX(${50-50/V}%) translateY(${-70-50/V}%)`;const U=document.createElement("div");if(J.appendChild(U),U.classList.add(i.OUTLINE_CLASS),U.innerHTML=I?D?h(I):I.toLowerCase():"",U.style.color="white",U.style.backgroundColor=D?B.component:B.primary,U.style.padding="4px 12px 4px 12px",U.style.height="38px",U.style.borderRadius="8px",U.style.fontSize="20px",b===l.PRIMARY){const ie=(0,n.default)(`.${i.ELEMENT_KEY_PREFIX}${k}`).get(0),se=s.TempoElement.fromKey(k||"");if((0,a.hasTextContents)(ie)&&!(0,a.canEditText)(se)){const ee=f(w,D?B.component:B.primary,k);J.appendChild(ee)}}}return G};e.getOutlineElement=m;const g=()=>{(0,n.default)(`.${i.OUTLINE_CLASS}`).remove()};e.clearAllOutlines=g;const y=(w,b)=>{if((0,e.clearAllOutlines)(),!!(0,r.getSessionStorageItem)("driveModeEnabled",b))return;const A=(0,r.getMemoryStorageItem)(r.HOVERED_ELEMENT_KEY),E=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),_=(0,r.getMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS),P=s.TempoElement.fromKey(E),I=document.getElementsByTagName("body")[0],D=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{},k=z=>{var W,$;const Z=D[z],G=($=(W=(0,n.default)("body").find(`.${i.ELEMENT_KEY_PREFIX}${z}`).get(0))===null||W===void 0?void 0:W.getBoundingClientRect)===null||$===void 0?void 0:$.call(W);return G?{left:G.left,top:G.top,width:G.width,height:G.height}:Z!=null&&Z.pageBoundingBox?{left:Z.pageBoundingBox.pageX,top:Z.pageBoundingBox.pageY,width:Z.pageBoundingBox.width,height:Z.pageBoundingBox.height}:null},B=(z,W,$,Z)=>{var G,V;const J=D[z];if(!J)return;const U=J==null?void 0:J.name,ie=k(z);if(ie){I.appendChild((0,e.getOutlineElement)(w,$?l.CHILD:l.PRIMARY,ie.left,ie.top,ie.width,ie.height,W,U,J==null?void 0:J.isComponent,z));const se=(0,r.getMemoryStorageItem)("mouseDragContext"),ee=(0,r.getMemoryStorageItem)("mousePos");W&&(se!=null&&se.dragging)&&ee&&I.appendChild((0,e.getOutlineElement)(w,l.MOVE,ee.pageX-ie.width/2+se.offsetX,ee.pageY-ie.height/2+se.offsetY,ie.width,ie.height,void 0,void 0,J==null?void 0:J.isComponent,z))}Z&&((V=(G=J==null?void 0:J.children)===null||G===void 0?void 0:G.forEach)===null||V===void 0||V.call(G,se=>{B(se.tempoElement.getKey(),!1,!0,!1)}))};if(A&&B(A,!1,!1,!0),_!=null&&_.length){let z=k(_[0]);_.slice(1).forEach(W=>{const $=k(W);if($)if(z){const Z=z.left+z.width,G=z.top+z.height;z.left=Math.min(z.left,$.left),z.top=Math.min(z.top,$.top);const V=Math.max(Z,$.left+$.width),J=Math.max(G,$.top+$.height);z.width=V-z.left,z.height=J-z.top}else z=$}),z&&I.appendChild((0,e.getOutlineElement)(w,l.PRIMARY,z.left,z.top,z.width,z.height,!0,`${_.length} Elements`,!1)),_.forEach(W=>{B(W,!1,!1,!1)})}else E&&B(E,!0,!1,!1);(0,n.default)(`.${i.TEMPO_INSTANT_DIV_DRAW_CLASS}`).each((z,W)=>{const $=W.getBoundingClientRect();I.appendChild((0,e.getOutlineElement)(w,l.PRIMARY,$.left,$.top,$.width,$.height))}),(0,n.default)(`*[${i.TEMPO_OUTLINE_UNTIL_REFESH}=true]`).each((z,W)=>{const $=W.getBoundingClientRect();I.appendChild((0,e.getOutlineElement)(w,l.PRIMARY,$.left,$.top,$.width,$.height))}),P!=null&&P.codebaseId&&(0,n.default)("body").find(`.${P==null?void 0:P.codebaseId}`).not(`.${i.ELEMENT_KEY_PREFIX}${E}`).not(`.${i.ELEMENT_KEY_PREFIX}${A}`).each((z,W)=>{const $=W.getBoundingClientRect();I.appendChild((0,e.getOutlineElement)(w,l.SECONDARY,$.left,$.top,$.width,$.height))})};e.updateOutlines=y;const x=w=>{if(!(w!=null&&w.classList))return!1;let b=!1;return w.classList.forEach(C=>{C===i.OUTLINE_CLASS&&(b=!0)}),b};e.isNodeOutline=x}(QO)),QO}var Yq;function yae(){return Yq||(Yq=1,function(e){var t=Nr&&Nr.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(e,"__esModule",{value:!0}),e.runNavTreeBuiltCallbacks=e.addNavTreeBuiltCallback=e.buildNavForNode=e.getNavNodeForVirtualComponent=e.ExtractedPropType=e.SKIP_ROOT_CODEBASE_ID=e.EMPTY_TREE_CODEBASE_ID=e.TOP_LEVEL_PARENT_COMPONENT_TO_SKIP=e.UNKNOWN_PARENT_COMPONENT=void 0;const i=hF(),r=xv(),n=vae(),s=t(w1),a=yv,o=yf;e.UNKNOWN_PARENT_COMPONENT="UnknownComponent",e.TOP_LEVEL_PARENT_COMPONENT_TO_SKIP="TOP_LEVEL_PARENT_COMPONENT_TO_SKIP",e.EMPTY_TREE_CODEBASE_ID="EMPTY-TREE",e.SKIP_ROOT_CODEBASE_ID="SKIP-ROOT";var l;(function(x){x.LITERAL="LITERAL",x.FUNCTION="FUNCTION",x.JSON_OBJECT="JSON_OBJECT"})(l||(e.ExtractedPropType=l={}));const u=x=>{var w;if(!(!((w=x==null?void 0:x.element)===null||w===void 0)&&w.memoizedProps))return{};const b={};return Object.keys(x.element.memoizedProps).forEach(C=>{if(C==="children"||r.KNOWN_ATTRIBUTES.has(C.toLowerCase()))return;let A=x.element.memoizedProps[C];if(C==="className"&&typeof A=="string"&&(A=(0,r.getAllUnknownClasesFromList)(A.split(" ")).join(" ")),typeof A=="function")b[C]={value:C,type:l.FUNCTION};else if(typeof A=="object")try{b[C]={value:JSON.stringify(A),type:l.JSON_OBJECT}}catch{}else b[C]={value:A,type:l.LITERAL}}),b},c=x=>{var w,b;if(!(!((b=(w=x==null?void 0:x.element)===null||w===void 0?void 0:w.memoizedProps)===null||b===void 0)&&b.children))return[];const C=[];return Array.from(x.element.memoizedProps.children||[]).forEach((A,E)=>{typeof A!="object"&&C.push({index:E,value:A})}),C};function h(x){const w={"!":"_exclamation_","@":"_at_","#":"_hash_",$:"_dollar_","%":"_percent_","^":"_caret_","&":"_and_","*":"_asterisk_","(":"_openParen_",")":"_closeParen_","+":"_plus_","=":"_equals_","[":"_openBracket_","]":"_closeBracket_","{":"_openBrace_","}":"_closeBrace_","|":"_pipe_",";":"_semicolon_",":":"_colon_",",":"_comma_",".":"_period_","<":"_lessThan_",">":"_greaterThan_","/":"_slash_","?":"_question_","\\":"_backslash_"," ":"_space_"};return Object.keys(w).forEach(b=>{const C=new RegExp("\\"+b,"g");x=x.replace(C,w[b])}),x=x.replace(/^[0-9-]/,"_startNumOrHyphen_"),x.replace(/[^a-zA-Z0-9_-]/g,"_")}const d=(x,w,b,C,A,E,_)=>{const P={parent:x,children:[],classList:[],directlySetClassList:[],name:"",tempoElement:o.TempoElement.empty()};return P.name=w,P.isComponent=!0,P.tempoElement=new o.TempoElement(b,E,C),P.props=u(_),P.literalChildren=c(_),Object.keys(A).forEach(I=>{var D;P.scope||((D=A[I].codebaseIds)===null||D===void 0?void 0:D.indexOf(b))>-1&&(P.scope=A[I])}),P};e.getNavNodeForVirtualComponent=d;const f=(x,w,b,C,A,E,_,P,I,D,k,B)=>{var z,W,$,Z,G,V,J,U,ie,se,ee;if(!b||(0,n.isNodeOutline)(b)||(0,r.isSkipNavTreeNode)(b)||["noscript","script"].includes((z=b==null?void 0:b.tagName)===null||z===void 0?void 0:z.toLowerCase()))return null;const ve=(0,r.getCodebaseIdFromNode)(b),_e=(0,r.getUniqueLookupFromNode)(b);if(((W=b==null?void 0:b.tagName)===null||W===void 0?void 0:W.toLowerCase())==="iframe"&&!ve)return b.remove(),null;let he=null;_e&&(he=P[_e]);const De=b.getBoundingClientRect(),{top:we,left:Le}=(0,s.default)(b).offset()||{top:0,left:0};let Te=w,ke=C;const Xe=[];let et,Ze;if(he&&(w!=null&&w.reactFiberNode)){let Ae=he.parent,Ge=[];for(;Ae&&Ae!==w.reactFiberNode;){const ae=((Z=($=Ae==null?void 0:Ae.element)===null||$===void 0?void 0:$._debugSource)===null||Z===void 0?void 0:Z.fileName)&&!(!((J=(V=(G=Ae==null?void 0:Ae.element)===null||G===void 0?void 0:G._debugSource)===null||V===void 0?void 0:V.fileName)===null||J===void 0)&&J.includes("node_modules"));(!((U=Ae.props)===null||U===void 0)&&U.tempoelementid||!((ie=Ae.props)===null||ie===void 0)&&ie["data-testid"])&&(I!=null&&I.has(Ae.name)||D!=null&&D.has(Ae.name)||ae)&&Ge.push(Ae),Ae=Ae.parent}if(Ae&&Ge.length){let ae=w;Array.from(Ge).reverse().forEach(te=>{var Ne,Re,Y,Me,Ke,ot,qe,It,Ot;if(((Y=(Re=(Ne=te==null?void 0:te.element)===null||Ne===void 0?void 0:Ne.elementType)===null||Re===void 0?void 0:Re.$$typeof)===null||Y===void 0?void 0:Y.toString())==="Symbol(react.forward_ref)"){if(!et&&!Ze){Ze=((Me=te.props)===null||Me===void 0?void 0:Me.tempoelementid)||((Ke=te.props)===null||Ke===void 0?void 0:Ke["data-testid"]);const kt=_[Ze||""];(kt==null?void 0:kt.type)==="component-instance"?et=kt.componentName:et=te.name}return}const Dt=ae?(ot=ae.children)===null||ot===void 0?void 0:ot.find(kt=>kt.reactFiberNode===te):null;if(Dt){if(ae=Dt,ae.tempoElement&&Xe.push(ae.tempoElement.getKey()),!Dt.pageBoundingBox)Dt.pageBoundingBox={pageX:Le,pageY:we,width:De.width,height:De.height};else{const kt=Math.max(Dt.pageBoundingBox.pageX+Dt.pageBoundingBox.width,Le+De.width),Qe=Math.min(Dt.pageBoundingBox.pageX,De.left),mt=Math.min(Dt.pageBoundingBox.pageY,De.top),Ht=Math.max(Dt.pageBoundingBox.pageY+Dt.pageBoundingBox.height,we+De.height);Dt.pageBoundingBox.pageX=Qe,Dt.pageBoundingBox.pageY=mt,Dt.pageBoundingBox.width=kt-Qe,Dt.pageBoundingBox.height=Ht-mt}return}else{let kt;et?(kt=Ze,et=void 0,Ze=void 0):(te.name,kt=((qe=te.props)===null||qe===void 0?void 0:qe.tempoelementid)||((It=te.props)===null||It===void 0?void 0:It["data-testid"])),ke=h(`${ke}-${((Ot=ae==null?void 0:ae.children)===null||Ot===void 0?void 0:Ot.length)||0}`);const Qe=(0,e.getNavNodeForVirtualComponent)(ae,te.name,kt,ke,E,x,te);ae.children.push(Qe),ae=Qe,Xe.push(Qe.tempoElement.getKey()),B[Qe.tempoElement.getKey()]=Qe,Qe.pageBoundingBox={pageX:Le,pageY:we,width:De.width,height:De.height}}}),Te=ae}}const st={parent:Te,children:[],classList:(0,r.getAllUnknownClasses)(b),directlySetClassList:[],name:"",tempoElement:o.TempoElement.empty()};(se=Te==null?void 0:Te.children)===null||se===void 0||se.push(st),st.name=et||b.tagName,st.elementTagName=b.tagName,st.isComponent=!!Ze;const _t=h(`${ke}${A}`),St=Ze||ve||void 0;st.tempoElement=new o.TempoElement(St,x,_t);const ue=st.tempoElement.getKey();Xe.forEach(Ae=>{k[Ae]?k[Ae].push(ue):k[Ae]=[ue]}),k[ue]=[ue],(0,r.addElementKeyAsClass)(b,ue);const Ee=_[st.tempoElement.codebaseId];if(Ee){const Ae=new Set((Ee==null?void 0:Ee.removableClasses)||[]);st.directlySetClassList=(ee=st.classList)===null||ee===void 0?void 0:ee.filter(Ge=>Ae.has(Ge))}if(st.reactFiberNode=he,st.props=u(he),st.literalChildren=c(he),st.pageBoundingBox={pageX:Le,pageY:we,width:De.width,height:De.height},st.displayType=(0,i.cssEval)(b,"display"),st.positionType=(0,i.cssEval)(b,"position"),st.flexDirection=(0,i.cssEval)(b,"flex-direction"),st.floatVal=(0,i.cssEval)(b,"float"),st.tempoElement.codebaseId&&Object.keys(E).forEach(Ae=>{var Ge;st.scope||((Ge=E[Ae].codebaseIds)===null||Ge===void 0?void 0:Ge.indexOf(st.tempoElement.codebaseId))>-1&&(st.scope=E[Ae])}),b.children&&b.tagName!=="svg"){let Ae=0;Array.from(b.children).forEach(Ge=>{(0,e.buildNavForNode)(x,st,Ge,_t,`-${Ae}`,E,_,P,I,D,k,B),Ae+=1})}return B[ue]=st,Te?null:m(st,B,_,x)};e.buildNavForNode=f;const m=(x,w,b,C)=>{let A=x;const E=(0,a.getMemoryStorageItem)(a.STORYBOARD_TYPE)||"APPLICATION",_=(0,a.getMemoryStorageItem)(a.SAVED_STORYBOARD_COMPONENT_FILENAME),P=(0,a.getMemoryStorageItem)(a.ORIGINAL_STORYBOARD_URL),I=P&&!window.location.href.includes(P),D=z=>{var W,$,Z,G,V,J;const U=(W=b[z.tempoElement.codebaseId])===null||W===void 0?void 0:W.filename;if(E==="STORY"&&U&&!U.includes("_app")&&!U.includes("_document"))return!0;if((($=z.parent)===null||$===void 0?void 0:$.name)==="BODY"){let ie=(Z=z.reactFiberNode)===null||Z===void 0?void 0:Z.parent;for(;ie;){const se=((G=ie==null?void 0:ie.props)===null||G===void 0?void 0:G.tempoelementid)||((V=ie==null?void 0:ie.props)===null||V===void 0?void 0:V["data-testid"])||"";if(se){const ee=(J=b[se])===null||J===void 0?void 0:J.filename;if(!!(ee!=null&&ee.includes("tempobook/storyboards"))||!!(ee&&ee===_))return!0}ie=ie==null?void 0:ie.parent}}return!!(U!=null&&U.includes("tempobook/storyboards"))||!!(U&&U===_)},k=(z,W)=>{var $,Z;for(let V=z.children.length-1;V>=0;V--)k(z.children[V],W||D(z));const G=E!=="APPLICATION"&&!I&&!W&&!D(z);if(!(!(($=z.tempoElement.codebaseId)===null||$===void 0)&&$.startsWith("tempo-"))||G)if(z.parent){const V=z.children,J=(Z=z.parent.children)===null||Z===void 0?void 0:Z.indexOf(z);z.parent.children.splice(J,1,...V),V.forEach(U=>{U.parent=z.parent}),delete w[z.tempoElement.getKey()]}else z.children.length===1?(A=z.children[0],delete w[z.tempoElement.getKey()],A.parent=void 0):z.children.length===0?(A={children:[],tempoElement:new o.TempoElement(e.EMPTY_TREE_CODEBASE_ID,C,"1"),name:""},delete w[z.tempoElement.getKey()]):(z.tempoElement=new o.TempoElement(e.SKIP_ROOT_CODEBASE_ID,z.tempoElement.storyboardId,z.tempoElement.uniquePath),delete w[z.tempoElement.getKey()])};k(x,!1);const B=(z,W)=>{delete z.reactFiberNode,z.level=W,z.children.forEach($=>{B($,z.tempoElement.codebaseId===e.SKIP_ROOT_CODEBASE_ID?W:W+1)})};return B(A,0),A},g=x=>{const{callbackFn:w,state:b}=x,C=(0,a.getMemoryStorageItem)(a.NAV_TREE_CALLBACKS)||[];b.multiSelectedElementKeys=(b.multiSelectedElementKeys||[]).sort(),!C.find(E=>E.callbackFn.toString()===w.toString()&&E.state.selectedElementKey===b.selectedElementKey&&E.state.multiSelectedElementKeys.join(",")===b.multiSelectedElementKeys.join(","))&&(C.push(x),(0,a.setMemoryStorageItem)(a.NAV_TREE_CALLBACKS,C))};e.addNavTreeBuiltCallback=g;const y=()=>{const x=(0,a.getMemoryStorageItem)(a.NAV_TREE_CALLBACKS)||[];if(!x.length)return;const w=(0,a.getMemoryStorageItem)(a.SELECTED_ELEMENT_KEY),b=((0,a.getMemoryStorageItem)(a.MULTI_SELECTED_ELEMENT_KEYS)||[]).sort();x.forEach(C=>{const{callbackFn:A,state:E}=C;E.selectedElementKey===w&&E.multiSelectedElementKeys.join(",")===b.join(",")&&A()}),(0,a.removeMemoryStorageItem)(a.NAV_TREE_CALLBACKS)};e.runNavTreeBuiltCallbacks=y}(ZO)),ZO}var Xq;function hF(){return Xq||(Xq=1,function(e){var t=Nr&&Nr.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(e,"__esModule",{value:!0}),e.ruleMatchesElement=e.getElementClassList=e.getCssEvals=e.cssEval=e.processRulesForSelectedElement=e.setModifiersForSelectedElement=e.parse=void 0;const i=t(w1),r=xv(),n=xae(),s=As,a=yw,o=est,l=yf,u=dae,c=yv,h=yae();e.parse=(0,u.createParser)({syntax:{baseSyntax:"latest",pseudoClasses:{unknown:"accept",definitions:{Selector:["has"]}},pseudoElements:{unknown:"accept"},combinators:[">","+","~"],attributes:{operators:["^=","$=","*=","~="]},classNames:!0,namespace:{wildcard:!0},tag:{wildcard:!0}},substitutes:!0});const d=(E,_,P,I)=>{try{E.insertRule?E.insertRule(`${_} { ${P} }`,I):E.addRule(_,P,I)}catch(D){console.log("Error adding rule: ",D)}},f=E=>{let _=[];if(E instanceof CSSMediaRule){for(let P of E.cssRules)if(E.media.mediaText.includes("min-width")&&P instanceof CSSStyleRule){const I=(0,e.parse)(P.selectorText);if(I.type!=="Selector")continue;const k=I.rules[0].items.filter(B=>B.type==="ClassName").map(B=>B.name);if(k.length!==1)continue;_.push({class:k[0],pseudos:m(k[0]),cssText:P.style.cssText,style:P.style})}}return _},m=E=>{const _=new RegExp("(?:\\b|(?<=[:.]))(sm|md|lg|xl|2xl)\\\\?:[\\w-]+","g"),I=(E.match(_)||[]).map(D=>{const k=D.indexOf(D.includes("\\:")?"\\:":":");return D.substring(0,k)});return[...new Set(I)]},g=E=>{if(E.type!=="Selector")return;const _=E.rules[0],P=_.items.filter(B=>B.type==="ClassName").map(B=>B.name);if(P.length===0||P[0]!=="dark")return;const I=_.nestedRule;if(!I)return;let D=[];const k=I.items.filter(B=>B.type==="ClassName").map(B=>B.name);if(k.length>1){console.log("Skipping is selector with multiple classes",_);return}return D.push({class:k[0],pseudos:["dark",...I.items.filter(B=>B.type==="PseudoClass").map(B=>B.name)]}),D},y=(E,_,P)=>{document.querySelectorAll('[class*="tempo-force-"]').forEach(B=>{Array.from(B.classList).forEach(W=>{W.startsWith("tempo-force-")&&B.classList.remove(W)})});const D=l.TempoElement.fromKey(P);if(D.isEmpty())return;const k=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${D.getKey()}`).get(0);k&&_.forEach(B=>{k.classList.add("tempo-force-"+B)})};e.setModifiersForSelectedElement=y;const x=(E,_,P)=>{var I,D,k,B,z;if(!_)return;const W=l.TempoElement.fromKey(P);if(W.isEmpty())return;const $=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${W.getKey()}`).get(0),Z=(0,c.getMemoryStorageItem)(c.MULTI_SELECTED_ELEMENT_KEYS)||[];if(!$){(0,h.addNavTreeBuiltCallback)({callbackFn:()=>{(0,e.processRulesForSelectedElement)(E,_,P)},state:{selectedElementKey:P,multiSelectedElementKeys:Z}});return}const G=[],V=new Set,J=new Set,U={filename:"",selector:"element.style",source:{},styles:{},applied:!0,codebaseId:"element.style",removable:!1,allowChanges:!0};for(let he=0;he<((I=$==null?void 0:$.style)===null||I===void 0?void 0:I.length);he++){const De=$.style[he];U.styles[De]=$.style[De]}G.push(U);let ie=!1;const se=[],ee=[];Object.keys(_).forEach(he=>{var De;const we=_[he];if(J.add(we.selector),!(0,n.isCssSelectorValid)(we.selector))return;if((0,n.getAllClassesFromSelector)(we.selector).forEach(Xe=>{V.add(Xe)}),(0,n.isCssSelectorValid)(we.selector)&&($!=null&&$.matches(we.selector))){se.push(Object.assign(Object.assign({},we),{applied:!0,allowChanges:!0,removable:(0,n.canRemoveCssClassFromElement)(we.selector,$)}));return}let Le=0,Te=$==null?void 0:$.parentElement;const ke={};for(;Te;){if(!ie){const Xe={};for(let et=0;et<((De=Te==null?void 0:Te.style)===null||De===void 0?void 0:De.length);et++){const Ze=Te.style[et];s.INHERITABLE_CSS_PROPS[Ze]&&(Xe[Ze]=Te.style[Ze])}Object.keys(Xe).length!==0&&ee.push({filename:"",selector:`parentElement${Le}.style`,inherited:!0,source:{},styles:Xe,applied:!0,codebaseId:`parentElement${Le}.style`,removable:!1,allowChanges:!1})}if((0,n.isCssSelectorValid)(we.selector)&&!(Te!=null&&Te.matches(we.selector))){Te=Te.parentElement;continue}Object.keys((we==null?void 0:we.styles)||{}).forEach(Xe=>{s.INHERITABLE_CSS_PROPS[Xe]&&ke[Xe]!==null&&(ke[Xe]=we.styles[Xe])}),Te=Te.parentElement,Le+=1}ie=!0,Object.keys(ke).length!==0&&ee.push(Object.assign(Object.assign({},we),{inherited:!0,styles:ke,applied:!0,removable:!1,allowChanges:!1})),ee.push(Object.assign(Object.assign({},we),{applied:!1,allowChanges:!1,eligibleToApply:(0,n.canApplyCssRuleToElement)(we.selector,$)}))});const ve=document.styleSheets[0];for(let he=0;he<document.styleSheets.length;he+=1){const De=document.styleSheets[he];let we=null;try{we=De.cssRules}catch(Le){console.log(Le);try{we=De.rules}catch(Te){console.log(Te)}}if(we)for(let Le=0;Le<we.length;Le+=1){const Te=we[Le],ke=f(Te);if(ke.length>0)for(let ue=0;ue<ke.length;ue++){const Ee=ke[ue];if(!($!=null&&$.matches("."+CSS.escape(Ee.class))))continue;const Ae={};for(let ae=0;ae<((D=Ee==null?void 0:Ee.style)===null||D===void 0?void 0:D.length);ae+=1){const te=Ee==null?void 0:Ee.style[ae];Ae[te]=Ee==null?void 0:Ee.style[te]}const Ge={filename:void 0,selector:CSS.escape("."+Ee.class),classParsed:Ee.class,source:{},styles:Ae,applied:!0,modifiers:Object.assign({},Ee.pseudos.reduce((ae,te)=>(ae[te]=!0,ae),{})),codebaseId:`${Ee.class} ${(0,a.v4)().toString()}`,removable:!1,allowChanges:!1,cssText:Ee.cssText};se.push(Ge)}if(!Te.selectorText||J.has(Te.selectorText))continue;const Xe=(0,e.parse)(Te.selectorText);if(Xe.type!=="Selector")continue;const et=Xe.rules[0];if(!et)continue;const Ze=et.items.filter(ue=>ue.type==="ClassName").map(ue=>ue.name),st=et.items.filter(ue=>ue.type==="PseudoClass");if(Ze.length===0&&st.length===1&&st[0].name==="is"){const ue=st[0];if(ue&&((k=ue.argument)===null||k===void 0?void 0:k.type)==="Selector"){const Ee=g(ue.argument);if(Ee)for(const Ae of Ee){if(!($!=null&&$.matches("."+CSS.escape(Ae.class))))continue;const Ge={};for(let te=0;te<((B=Te==null?void 0:Te.style)===null||B===void 0?void 0:B.length);te+=1){const Ne=Te.style[te];Ge[Ne]=Te.style[Ne]}const ae={filename:void 0,selector:CSS.escape("."+Ae.class),classParsed:Ae.class,source:{},styles:Ge,applied:!0,modifiers:Object.assign({},Ae.pseudos.reduce((te,Ne)=>(te[Ne]=!0,te),{})),codebaseId:`${Te.selectorText} ${(0,a.v4)().toString()}`,removable:!1,allowChanges:!1,cssText:Te.style.cssText};se.push(ae)}}}if(Ze.length===0||Ze.length>1)continue;const _t=Ze[0],St=et.items.filter(ue=>ue.type==="PseudoClass").map(ue=>ue.name);try{if($!=null&&$.matches("."+CSS.escape(_t))){const ue={};for(let Ee=0;Ee<((z=Te==null?void 0:Te.style)===null||z===void 0?void 0:z.length);Ee+=1){const Ae=Te.style[Ee];ue[Ae]=Te.style[Ae]}se.push({filename:void 0,selector:Te.selectorText,classParsed:_t,source:{},styles:ue,applied:!0,modifiers:Object.assign({},St.reduce((Ee,Ae)=>(Ee[Ae.name]=!0,Ee),{})),codebaseId:`${Te.selectorText} ${(0,a.v4)().toString()}`,removable:!1,allowChanges:!1,cssText:Te.style.cssText})}}catch{}}}for(let he=0;he<se.length;he++){const De=se[he];if(!De.modifiers)continue;const we=Object.keys(De.modifiers);if(we.length<1)continue;const Le=De.classParsed;if(!Le)continue;const Te=De.cssText;if(!Te)continue;const ke=we.map(Ze=>".tempo-force-"+Ze).join(""),Xe="."+CSS.escape(Le)+ke;d(ve,Xe,Te,ve.cssRules.length)}const _e=G.concat(se.sort((he,De)=>{try{return-(0,o.compare)(he.selector,De.selector)}catch{let Le=!0;try{(0,o.compare)(he.selector,"body")}catch{Le=!1}let Te=!0;try{(0,o.compare)(De.selector,"body")}catch{Te=!1}return Le&&!Te?-1:!Le&&Te?1:0}})).concat(ee);E.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.PROCESSED_CSS_RULES_FOR_ELEMENT,processedCssRules:_e})};e.processRulesForSelectedElement=x;const w=(E,_)=>window.getComputedStyle(E,null).getPropertyValue(_);e.cssEval=w;const b=(E,_)=>{let P={};const I=l.TempoElement.fromKey(_);if(I.isEmpty())return;const D=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${I.getKey()}`).get(0);if(!D)return;s.CSS_VALUES_TO_COLLECT.forEach(z=>{P[z]=(0,e.cssEval)(D,z)});const k={};if(D.parentElement){s.CSS_VALUES_TO_COLLECT_FOR_PARENT.forEach(W=>{k[W]=(0,e.cssEval)(D.parentElement,W)});let z=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${I.getKey()}`).closest(".dark").length>0;k.darkEnabledInParent=z}P.parent=k,E.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.CSS_EVALS_FOR_ELEMENT,cssEvals:P})};e.getCssEvals=b;const C=(E,_)=>{const P=l.TempoElement.fromKey(_);if(P.isEmpty())return;const I=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${P.getKey()}`).get(0);I&&E.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.ELEMENT_CLASS_LIST,classList:Array.from(I.classList)})};e.getElementClassList=C;const A=(E,_,P,I)=>{if(!P)return;const D=l.TempoElement.fromKey(I);if(D.isEmpty())return;const k=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${D.getKey()}`).get(0);k&&E.postMessage({id:_,matches:k==null?void 0:k.matches(P)})};e.ruleMatchesElement=A}(KO)),KO}var Kq;function xae(){return Kq||(Kq=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.camelToSnakeCase=e.isCssSelectorValid=e.getAllClassesFromSelector=e.canRemoveCssClassFromElement=e.canApplyCssRuleToElement=void 0;const t=hF(),i=(l,u)=>{var c;try{if(!u||!(0,e.isCssSelectorValid)(l)||u.matches(l))return!1;let d=(0,t.parse)(l);for(;d.nestedRule;)d=d.nestedRule;const f=[],m=new Set(u.classList);(c=d.items)===null||c===void 0||c.forEach(y=>{if(y.type==="ClassName"){const x=y.name;m.has(x)||(u.classList.add(x),f.push(x))}});const g=u.matches(l);return f.forEach(y=>{u.classList.remove(y)}),g}catch(h){return console.error(h),!1}};e.canApplyCssRuleToElement=i;const r=(l,u)=>{var c;try{if(!(0,e.isCssSelectorValid)(l)||!u.matches(l))return!1;let d=(0,t.parse)(l);for(;d.nestedRule;)d=d.nestedRule;const f=[],m=new Set(u.classList);(c=d.items)===null||c===void 0||c.forEach(y=>{if(y.type==="ClassName"){const x=y.name;if(!m.has(x))return;u.classList.remove(x),f.push(x)}});const g=!u.matches(l);return f.forEach(y=>{u.classList.add(y)}),g}catch(h){return console.error(h),!1}};e.canRemoveCssClassFromElement=r;const n=l=>{try{if(!(0,e.isCssSelectorValid)(l))return new Set;let c=(0,t.parse)(l);const h=new Set;for(;c;)(c.items||[]).forEach(f=>{f.type==="ClassName"&&h.add(f.name)}),c=c.nestedRule;return h}catch(u){return console.log("Failed to parse classes from selector "+l+", "+u),new Set}};e.getAllClassesFromSelector=n;const s=l=>document.createDocumentFragment().querySelector(l),a=l=>{try{s(l);const u=(0,t.parse)(l);return!0}catch{return!1}};e.isCssSelectorValid=a;const o=l=>l&&l.charAt(0).toLowerCase()+l.substring(1).replace(/[A-Z]/g,u=>`-${u.toLowerCase()}`);e.camelToSnakeCase=o}(XO)),XO}var $q;function bae(){return $q||($q=1,function(e){var t=Nr&&Nr.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(e,"__esModule",{value:!0}),e.updateCodebaseIds=e.applyChangeItemToDocument=e.TEMPORARY_STYLING_CLASS_NAME=e.ADD_CLASS_INSTANT_UPDATE_QUEUE=e.ADD_JSX_PREFIX=e.DUPLICATE_PLACEHOLDER_PREFIX=e.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID=void 0;const i=t(w1),r=xv(),n=nae,s=As,a=xae(),o=yv,l=yf,u=yw;e.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID="tempo-wrap-in-div-placeholder",e.DUPLICATE_PLACEHOLDER_PREFIX="tempo-duplicate-placeholder-",e.ADD_JSX_PREFIX="tempo-add-jsx-placeholder-",e.ADD_CLASS_INSTANT_UPDATE_QUEUE="ADD_CLASS_INSTANT_UPDATE_QUEUE",e.TEMPORARY_STYLING_CLASS_NAME="arb89-temp-styling";const c=g=>{let y=null,x=1/0;return(0,i.default)(`.component-${g}`).each((w,b)=>{(0,i.default)(b).parents().length<x&&(x=(0,i.default)(b).parents().length,y=(0,r.getCodebaseIdFromNode)(b))}),y},h=(g,y,x)=>{var w=document.createElement("style");if(x){const C=document.getElementById(x);C&&C.remove(),w.id=x}document.head.appendChild(w);var b=w.sheet;b.insertRule?b.insertRule(g+"{"+y+"}",b.cssRules.length):b.addRule&&b.addRule(g,y,b.rules.length)},d=(g,y,x)=>{var w;if(!x||!x.type)return{sendNewNavTree:!1,instantUpdateSuccessful:!1};const b=(0,n.reconstructChangeLedgerClass)(x);let C={},A=!1;document.getElementById(r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS)||h(`.${r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS}`,"display: none !important",r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS);let E=!1;if(b.type===n.ChangeType.ADD_JSX){const D=b.changeFields,k=[];if(D.htmlForInstantUpdate){const B=(0,i.default)(D.htmlForInstantUpdate);B.attr(r.TEMPO_DELETE_AFTER_REFRESH,"true"),B.attr(r.TEMPO_INSTANT_UPDATE,"true"),B.attr(r.TEMPO_OUTLINE_UNTIL_REFESH,"true");const z=`${e.ADD_JSX_PREFIX}${(0,u.v4)()}`;B.attr(r.TEMPO_ELEMENT_ID,z),B.addClass(z),k.push(z),(0,i.default)(`.${D.codebaseIdToAddTo}`).each((W,$)=>{if(D.afterCodebaseId){const Z=(0,i.default)(`.${D.afterCodebaseId}`);if(!(Z!=null&&Z.length))return;B.insertAfter(Z.first())}else if(D.beforeCodebaseId){const Z=(0,i.default)(`.${D.beforeCodebaseId}`);if(!(Z!=null&&Z.length))return;B.insertBefore(Z.first())}else(0,i.default)($).append(B);E=!0,A=!0})}C.newAddedIds=k}else if(b.type===n.ChangeType.MOVE_JSX){const I=b,D=[];if((0,i.default)(`.${I.changeFields.codebaseIdToMove}`).length>0)(0,i.default)(`.${I.changeFields.codebaseIdToMove}`).each((z,W)=>{D.push((0,i.default)(W))});else{let z=c(I.changeFields.codebaseIdToMove||"");z&&(0,i.default)(`.${z}`).each((W,$)=>{D.push((0,i.default)($))})}let k=c(I.changeFields.codebaseIdToMoveTo||"")||I.changeFields.codebaseIdToMoveTo;const B=[];D.forEach(z=>{let W=null,$=z.parent();for(;$.length;){if($.hasClass(k)){W=$;break}const Z=$.find(`.${k}`);if(Z.length){W=Z.first();break}$=$.parent()}if(!W){B.push(null);return}B.push(W)}),D.forEach((z,W)=>{const $=B[W];if(!$.length){console.log("Could not find new parent element for instant update");return}E=!0,A=!0,z.attr(r.TEMPO_INSTANT_UPDATE,"true");let Z=!$.is(z.parent()),G;if(Z&&(G=z.clone(),G.attr(r.TEMPO_DELETE_AFTER_REFRESH,"true"),z.addClass(r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),z.attr(r.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH,"true")),I.changeFields.afterCodebaseId){const V=c(I.changeFields.afterCodebaseId)||I.changeFields.afterCodebaseId,J=$.children(`.${V}`);if(J.length){Z&&G?G.insertAfter(J.first()):z.insertAfter(J.first());return}}if(I.changeFields.beforeCodebaseId){const V=c(I.changeFields.beforeCodebaseId)||I.changeFields.beforeCodebaseId,J=$.children(`.${V}`);if(J.length){Z&&G?G.insertBefore(J.first()):z.insertBefore(J.first());return}}Z&&G?G.appendTo($):z.appendTo($)})}else if(b.type===n.ChangeType.REMOVE_JSX){const I=b,D={};I.changeFields.codebaseIdsToRemove.forEach(k=>{let B;if((0,i.default)(`.${k}`).length>0)B=k;else{let z=c(k||"");if(!z)return console.log("Could not find component element for instant update"),!1;B=z}(0,i.default)(`.${B}`).each((z,W)=>{const $=(0,r.getElementKeyFromNode)(W),Z=(0,r.getElementKeyFromNode)(W.parentElement);$&&Z&&(D[Z]||(D[Z]=[]),D[Z].push({outerHTML:W.outerHTML,elementKeyRemoved:$})),W.classList.add(r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),W.setAttribute(r.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH,"true"),E=!0,A=!0})}),C.parentToElementKeysRemoved=D}else if(b.type===n.ChangeType.ADD_CLASS||b.type===n.ChangeType.STYLING){let I,D,k,B,z,W;if(b.type===n.ChangeType.ADD_CLASS){const G=b;z=G.changeFields.className,I=G.changeFields.className,D=G.changeFields.cssEquivalent,k=G.changeFields.codebaseIdToAddClass,B=G.changeFields.temporaryOnly,W=G.changeFields.modifiers,B&&(I=e.TEMPORARY_STYLING_CLASS_NAME)}else{const G=b.changeFields;I="",D=Object.keys(G.stylingChanges).map(V=>G.stylingChanges[V]===s.DELETE_STYLE_CONSTANT?`${(0,a.camelToSnakeCase)(V)}: unset !important;`:`${(0,a.camelToSnakeCase)(V)}: ${G.stylingChanges[V]};`).join(""),k=G.codebaseId,W=G.modifiers}const $=/[^A-Za-z0-9_-]/g;let Z=(I||"").replace($,"-").replace(/^\d/,"-$&");if(D&&!B){const G=Date.now()-17040672e5;Z=`${r.TEMPO_INSTANT_UPDATE_STYLING_PREFIX}${G}-${Z}`}if(Z){if(B||(0,i.default)(`.${k}`).removeClass(e.TEMPORARY_STYLING_CLASS_NAME),D)if(W&&W.length>0){const V=["hover","required","focus","active","invalid","disabled"],J=W.filter(ee=>V.includes(ee)),U=J.join(":");if(J.length>0){const ee=`${Z}:${U}`;h(`.${ee}`,D,ee)}else h(`.${Z}`,D,Z);const ie=W.map(ee=>`.tempo-force-${ee}`).join(""),se=`${Z}${ie}`;h(`.${se}`,D,se)}else h(`.${Z}`,D,Z);const G=(0,o.getMemoryStorageItem)(e.ADD_CLASS_INSTANT_UPDATE_QUEUE)||[];if((0,i.default)(`.${k}`).length>0)(0,i.default)(`.${k}`).addClass(Z),A=!0,G.push({codebaseId:k,className:Z});else{let V=c(k||"");V&&(0,i.default)(`.${V}`).length>0&&(A=!0,(0,i.default)(`.${V}`).addClass(Z),G.push({codebaseId:V,className:Z}))}(0,o.setMemoryStorageItem)(e.ADD_CLASS_INSTANT_UPDATE_QUEUE,G),C.addedClass=Z,C.codebaseAddedClass=z}}else if(b.type===n.ChangeType.REMOVE_CLASS){const I=b.changeFields;if((0,i.default)(`.${I.codebaseIdToRemoveClass}`).length>0)(0,i.default)(`.${I.codebaseIdToRemoveClass}`).removeClass(I.className),A=!0;else{let D=c(I.codebaseIdToRemoveClass||"");D&&(0,i.default)(`.${D}`).length>0&&(A=!0,(0,i.default)(`.${D}`).removeClass(I.className))}}else if(b.type===n.ChangeType.WRAP_DIV){const D=b.changeFields.codebaseIdsToWrap,k=D[0];(0,i.default)(`.${k}`).each((B,z)=>{const W=D.slice(1),$=(0,i.default)(z).siblings(),Z=[z];let G=z,V=(0,i.default)(z).index();W.forEach(U=>{const ie=$.filter(`.${U}`).get(0);if(ie){Z.push(ie);const se=(0,i.default)(ie).index();se<V&&(G=ie,V=se)}}),Z.length,D.length;const J=document.createElement("div");J.className=e.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID,J.setAttribute(r.TEMPO_INSTANT_UPDATE,"true"),J.setAttribute("tempoelementid",e.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID),J.setAttribute("data-testid",e.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID),J.setAttribute(r.TEMPO_DELETE_AFTER_REFRESH,"true"),Z.forEach(U=>{J.appendChild(U.cloneNode(!0)),U.classList.add(r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),U.setAttribute(r.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH,"true")}),G.insertAdjacentElement("beforebegin",J),E=!0,A=!0})}else if(b.type===n.ChangeType.DUPLICATE)b.changeFields.codebaseIdsToDuplicate.forEach(k=>{(0,i.default)(`.${k}`).each((B,z)=>{const W=z.cloneNode(!0);W.setAttribute(r.TEMPO_DELETE_AFTER_REFRESH,"true"),W.setAttribute(r.TEMPO_INSTANT_UPDATE,"true"),W.setAttribute("tempoelementid",`${e.DUPLICATE_PLACEHOLDER_PREFIX}${k}`),W.setAttribute("data-testid",`${e.DUPLICATE_PLACEHOLDER_PREFIX}${k}`),W.classList.add(e.DUPLICATE_PLACEHOLDER_PREFIX+k),W.classList.remove(k);let $=Array.from(W.children);for(;$.length;){const Z=$.pop();if(!Z)continue;const G=Z.getAttribute("tempoelementid")||Z.getAttribute("data-testid");G&&(Z.setAttribute("tempoelementid",`${e.DUPLICATE_PLACEHOLDER_PREFIX}${G}`),Z.setAttribute("data-testid",`${e.DUPLICATE_PLACEHOLDER_PREFIX}${G}`),Z.classList.remove(G),Z.classList.add(e.DUPLICATE_PLACEHOLDER_PREFIX+G),Z.setAttribute(r.TEMPO_INSTANT_UPDATE,"true"),$.push(...Array.from(Z.children)))}z.insertAdjacentElement("afterend",W),E=!0,A=!0})});else if(b.type===n.ChangeType.CHANGE_TAG){const I=b.changeFields;(0,i.default)(`.${I.codebaseIdToChange}`).each((D,k)=>{const B=(0,i.default)("<"+I.newTagName+"></"+I.newTagName+">");B.attr(r.TEMPO_INSTANT_UPDATE,"true"),B.attr(r.TEMPO_DELETE_AFTER_REFRESH,"true");const z=(0,i.default)(k);i.default.each(z[0].attributes,function(){B.attr(this.name,this.value)}),z.contents().clone(!0,!0).appendTo(B),z.before(B),z.addClass(r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),z.attr(r.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH,"true"),E=!0,A=!0})}else if(b.type===n.ChangeType.UNDO){const{sendNewNavTree:I,instantUpdateSuccessful:D}=f(g,b);E=I,A=D}else if(b.type===n.ChangeType.REDO){const D=b.changeFields.changeToRedo;if(n.CHANGE_TYPES_WITH_INSTANT_UNDO.includes(D.type)){const{sendNewNavTree:k,instantUpdateSuccessful:B}=(0,e.applyChangeItemToDocument)(g,y,D);E=k,A=B,D.prevIdToNewIdMap&&(0,e.updateCodebaseIds)(g,D.prevIdToNewIdMap,!0)}}let _=b.getElementKeyToSelectAfterInstantUpdate(),P=b.getElementKeysToMultiselectAfterInstantUpdate();return b.type===n.ChangeType.UNDO&&(_=b.changeFields.changeToUndo.getElementKeyToSelectAfterUndoInstantUpdate(),P=b.changeFields.changeToUndo.getElementKeysToMultiselectAfterUndoInstantUpdate()),_!==void 0&&((0,o.setMemoryStorageItem)(o.SELECTED_ELEMENT_KEY,_),g.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:_,outerHTML:(w=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${_}`).get(0))===null||w===void 0?void 0:w.outerHTML})),P!==void 0&&((0,o.setMemoryStorageItem)(o.MULTI_SELECTED_ELEMENT_KEYS,P),g.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,elementKeys:P,outerHTMLs:P==null?void 0:P.map(I=>{var D;return(D=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${I}`).get(0))===null||D===void 0?void 0:D.outerHTML})})),A&&(0,i.default)(`*[${r.TEMPO_DELETE_AFTER_INSTANT_UPDATE}=true]`).remove(),g.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.INSTANT_UPDATE_DONE,changeItem:x,instantUpdateData:C,instantUpdateSuccessful:A}),{sendNewNavTree:E,instantUpdateSuccessful:A}};e.applyChangeItemToDocument=d;const f=(g,y)=>{const x=y.changeFields,w=x.changeToUndo;if(!n.CHANGE_TYPES_WITH_INSTANT_UNDO.includes(w.type))return{sendNewNavTree:!1,instantUpdateSuccessful:!1};let b=!1,C=!1;if(w.prevIdToNewIdMap){const A={};Object.keys(w.prevIdToNewIdMap).forEach(_=>{const P=w.prevIdToNewIdMap[_];A[P]=_});const E=w.getElementKeyToSelectAfterUndoInstantUpdate()!==void 0;(0,e.updateCodebaseIds)(g,A,!E)}if(w.type===n.ChangeType.REMOVE_JSX){const E=w.changeFields.codebaseIdsToRemove;if(x.matchingActivityFlushed){const P=w.getInstantUpdateData().parentToElementKeysRemoved||{};Object.entries(P).forEach(([I,D])=>{const k=Object.values(D).sort((z,W)=>{const $=l.TempoElement.fromKey(z.elementKeyRemoved),Z=l.TempoElement.fromKey(W.elementKeyRemoved);return $.uniquePath.localeCompare(Z.uniquePath)}),B=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${I}`).get(0);B&&k.forEach(z=>{const{elementKeyRemoved:W,outerHTML:$}=z,Z=l.TempoElement.fromKey(W),G=Number(Z.uniquePath.split("-").pop()),V=(0,i.default)($).get(0);V&&(V.setAttribute(r.TEMPO_DELETE_AFTER_REFRESH,"true"),V.setAttribute(r.TEMPO_INSTANT_UPDATE,"true"),B.insertBefore(V,B.children[G]||null),C=!0,b=!0)})})}else E.forEach(_=>{(0,i.default)(`.${_}`).each((P,I)=>{I.classList.remove(r.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),I.removeAttribute(r.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH),b=!0,C=!0})})}else if(w.type===n.ChangeType.ADD_CLASS||w.type===n.ChangeType.STYLING){const A=w.getInstantUpdateData(),E=w.changeFields,_=A==null?void 0:A.addedClass;_&&(0,i.default)(`.${E.codebaseIdToAddClass}`).each((I,D)=>{(0,i.default)(D).hasClass(_)&&((0,i.default)(D).removeClass(_),C=!0)});const P=A==null?void 0:A.codebaseAddedClass;P&&(0,i.default)(`.${E.codebaseIdToAddClass}`).each((I,D)=>{(0,i.default)(D).hasClass(P)&&((0,i.default)(D).removeClass(P),C=!0)})}else if(w.type===n.ChangeType.ADD_JSX){const A=w.getInstantUpdateData(),E=A==null?void 0:A.addedIds;E==null||E.forEach(_=>{(0,i.default)(`.${_}`).remove(),C=!0}),b=!0}return{sendNewNavTree:b,instantUpdateSuccessful:C}},m=(g,y,x)=>{const w=[];if(Object.entries(y).forEach(([A,E])=>{(0,i.default)(`.${A}`).each((_,P)=>{w.push({item:P,prevCodebaseId:A,newCodebaseId:E})})}),w.forEach(A=>{const E=(0,i.default)(A.item),_=(E.attr("class")||"").replace(new RegExp(`${A.prevCodebaseId}`,"g"),A.newCodebaseId);E.attr("class",_),A.item.setAttribute("tempoelementid",A.newCodebaseId),A.item.setAttribute("data-testid",A.newCodebaseId)}),!x)return!!w.length;[{key:o.SELECTED_ELEMENT_KEY,messageId:s.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY},{key:o.HOVERED_ELEMENT_KEY,messageId:s.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY}].forEach(({key:A,messageId:E})=>{var _;const P=(0,o.getMemoryStorageItem)(A),I=l.TempoElement.fromKey(P);if(y[I.codebaseId]){const D=new l.TempoElement(y[I.codebaseId],I.storyboardId,I.uniquePath);(0,o.setMemoryStorageItem)(A,D.getKey()),g.postMessage({id:E,elementKey:D.getKey(),outerHTML:(_=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${D.getKey()}`).get(0))===null||_===void 0?void 0:_.outerHTML})}});const C=(0,o.getMemoryStorageItem)(o.MULTI_SELECTED_ELEMENT_KEYS);if(C!=null&&C.length){const A=[];C.forEach(E=>{const _=l.TempoElement.fromKey(E);if(y[_.codebaseId]){const P=new l.TempoElement(y[_.codebaseId],_.storyboardId,_.uniquePath);A.push(P.getKey())}else A.push(E)}),(0,o.setMemoryStorageItem)(o.MULTI_SELECTED_ELEMENT_KEYS,A),g.postMessage({id:s.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,elementKeys:A,outerHTMLs:A==null?void 0:A.map(E=>{var _;return(_=(0,i.default)(`.${r.ELEMENT_KEY_PREFIX}${E}`).get(0))===null||_===void 0?void 0:_.outerHTML})})}return!!w.length};e.updateCodebaseIds=m}(VO)),VO}var Zq;function xv(){return Zq||(Zq=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isElementInSvg=e.isSkipNavTreeNode=e.isMovingElement=e.getAllUnknownClasses=e.getAllUnknownClasesFromList=e.isOutline=e.hasClass=e.removeUniqueLookupFromNode=e.getUniqueLookupFromNode=e.getElementKeyFromNode=e.addCodebaseIdToNode=e.addUniqueLookupAsClass=e.addElementKeyAsClass=e.getCodebaseIdFromNode=e.getCodebaseIdFromClassName=e.validateUuid=e.KNOWN_ATTRIBUTES=e.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD=e.TEMPO_TEST_ID=e.TEMPO_ELEMENT_ID=e.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH=e.TEMPO_OUTLINE_UNTIL_REFESH=e.TEMPO_DELETE_AFTER_REFRESH=e.TEMPO_INSTANT_UPDATE=e.TEMPO_DELETE_AFTER_INSTANT_UPDATE=e.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS=e.TEMPO_INSTANT_UPDATE_STYLING_PREFIX=e.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE=e.TEMPO_INSTANT_DIV_DRAW_CLASS=e.EDIT_TEXT_BUTTON=e.OUTLINE_CLASS=e.UNIQUE_LOOKUP_PREFIX=e.ELEMENT_KEY_PREFIX=void 0;const t=bae();e.ELEMENT_KEY_PREFIX="arb89-key-",e.UNIQUE_LOOKUP_PREFIX="arb89-lookup-",e.OUTLINE_CLASS="arb89-outline",e.EDIT_TEXT_BUTTON="arb89-edit-text-button",e.TEMPO_INSTANT_DIV_DRAW_CLASS="arb89-instant-div-draw",e.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE="arb89-move-between-parents-outline",e.TEMPO_INSTANT_UPDATE_STYLING_PREFIX="arb89-styling-",e.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS="arb89-display-none-until-refresh",e.TEMPO_DELETE_AFTER_INSTANT_UPDATE="arb89-delete-after-instant-update";const i=new Set([e.OUTLINE_CLASS,e.TEMPO_INSTANT_DIV_DRAW_CLASS,e.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE,e.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS,t.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID,t.TEMPORARY_STYLING_CLASS_NAME,e.EDIT_TEXT_BUTTON]),r=[e.ELEMENT_KEY_PREFIX,e.UNIQUE_LOOKUP_PREFIX,e.TEMPO_INSTANT_UPDATE_STYLING_PREFIX,t.DUPLICATE_PLACEHOLDER_PREFIX,t.ADD_JSX_PREFIX];e.TEMPO_INSTANT_UPDATE="arb89-instant-update",e.TEMPO_DELETE_AFTER_REFRESH="arb89-delete-after-refresh",e.TEMPO_OUTLINE_UNTIL_REFESH="arb89-outline-until-refresh",e.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH="arb89-do-not-show-in-nav",e.TEMPO_ELEMENT_ID="tempoelementid",e.TEMPO_TEST_ID="data-testid",e.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD="arb89-queue-delete-after-hot-reload",e.KNOWN_ATTRIBUTES=new Set([e.TEMPO_INSTANT_UPDATE,e.TEMPO_DELETE_AFTER_REFRESH,e.TEMPO_DELETE_AFTER_INSTANT_UPDATE,e.TEMPO_OUTLINE_UNTIL_REFESH,e.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD,e.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH,e.TEMPO_ELEMENT_ID,e.TEMPO_TEST_ID]);const n=C=>new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i").test(C);e.validateUuid=n;const s=C=>C&&C.startsWith("tempo-")&&((0,e.validateUuid)(C.substring(6))||C===t.WRAP_IN_DIV_PLACEHOLDER_CODEBASE_ID||C.startsWith(t.DUPLICATE_PLACEHOLDER_PREFIX))?C:null;e.getCodebaseIdFromClassName=s;const a=C=>{var A;if(!(C!=null&&C.classList))return null;let E=null;return C.classList.forEach(_=>{if(E||!_)return;const P=(0,e.getCodebaseIdFromClassName)(_);P&&(E=P)}),E||(((A=C==null?void 0:C.tagName)===null||A===void 0?void 0:A.toLowerCase())=="body"?"body":(C==null?void 0:C.id)=="root"?"root":(C==null?void 0:C.id)=="__next"?"__next":null)};e.getCodebaseIdFromNode=a;const o=(C,A)=>{if(!(C!=null&&C.classList))return;const E=new Set;C.classList.forEach(_=>{_!=null&&_.startsWith(e.ELEMENT_KEY_PREFIX)&&E.add(_)}),E.forEach(_=>{C.classList.remove(_)}),C.classList.add(`${e.ELEMENT_KEY_PREFIX}${A}`)};e.addElementKeyAsClass=o;const l=(C,A)=>{if(!(C!=null&&C.classList))return;const E=new Set;C.classList.forEach(_=>{_!=null&&_.startsWith(e.UNIQUE_LOOKUP_PREFIX)&&E.add(_)}),E.forEach(_=>{C.classList.remove(_)}),C.classList.add(`${e.UNIQUE_LOOKUP_PREFIX}${A}`)};e.addUniqueLookupAsClass=l;const u=(C,A)=>{if(!(C!=null&&C.classList))return;const E=new Set;C.classList.forEach(_=>{_&&(0,e.getCodebaseIdFromClassName)(_)&&E.add(_)}),E.forEach(_=>{C.classList.remove(_)}),C.classList.add(A)};e.addCodebaseIdToNode=u;const c=C=>{if(!(C!=null&&C.classList))return null;let A=null;return C.classList.forEach(E=>{E!=null&&E.startsWith(e.ELEMENT_KEY_PREFIX)&&(A=E.substring(e.ELEMENT_KEY_PREFIX.length))}),A};e.getElementKeyFromNode=c;const h=C=>{if(!(C!=null&&C.classList))return null;let A=null;return C.classList.forEach(E=>{E!=null&&E.startsWith(e.UNIQUE_LOOKUP_PREFIX)&&(A=E.substring(e.UNIQUE_LOOKUP_PREFIX.length))}),A};e.getUniqueLookupFromNode=h;const d=C=>{if(!(C!=null&&C.classList))return!1;const A=new Set;return C.classList.forEach(E=>{E!=null&&E.startsWith(e.UNIQUE_LOOKUP_PREFIX)&&A.add(E)}),A.forEach(E=>{C.classList.remove(E)}),A.size>0};e.removeUniqueLookupFromNode=d;const f=(C,A)=>{if(!(C!=null&&C.classList))return!1;let E=!1;return C.classList.forEach(_=>{_==A&&(E=!0)}),E};e.hasClass=f;const m=C=>(0,e.hasClass)(C,e.OUTLINE_CLASS);e.isOutline=m;const g=C=>C.filter(A=>{if(!A)return!1;const E=(0,e.getCodebaseIdFromClassName)(A)!==null;return!r.some(P=>A.startsWith(P))&&!i.has(A)&&!E});e.getAllUnknownClasesFromList=g;const y=C=>C!=null&&C.classList?(0,e.getAllUnknownClasesFromList)(Array.from(C.classList)):[];e.getAllUnknownClasses=y;const x=C=>!C||typeof C.getAttribute!="function"?!1:C.getAttribute(e.TEMPO_INSTANT_UPDATE)==="true";e.isMovingElement=x;const w=C=>{if(C)return C.getAttribute(e.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH)==="true"};e.isSkipNavTreeNode=w;const b=(C,A)=>{var E;return C?A&&((E=C.tagName)===null||E===void 0?void 0:E.toLowerCase())==="svg"?!0:C.parentNode?(0,e.isElementInSvg)(C.parentNode,!0):!1:!1};e.isElementInSvg=b}(jO)),jO}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.findElementInTree=e.getElementName=e.clearLookupsFromTree=e.buildTreeLookupMap=e.removeUniqueLoookupFromReactTreeNode=e.addUniqueLoookupToReactTreeNode=e.getUniqueLoookupFromReactTreeNode=e.getDomElementForReactNode=e.buildNodeTree=e.getRootReactElement=e.findReactInstance=void 0;const t=xv(),i=yw,r=b=>{if(b.hasOwnProperty("_reactRootContainer"))return b._reactRootContainer._internalRoot?b._reactRootContainer._internalRoot.current:b._reactRootContainer.current;const C=Object.keys(b).find(A=>A.startsWith("__reactInternalInstance")||A.startsWith("__reactFiber")||A.startsWith("__reactContainer"));if(C)return b[C]};e.findReactInstance=r;function n(b){return typeof HTMLElement=="object"?b instanceof HTMLElement:b&&typeof b=="object"&&b!==null&&b.nodeType===1&&typeof b.nodeName=="string"}const s=()=>{var b;let C="#root";document.querySelector(C)||(C="#__next");const A=document.querySelector(C);let E=null;return A?E=(0,e.findReactInstance)(A):document.getElementsByTagName("body")[0].childNodes.forEach(_=>{E||_.tagName==="DIV"&&(E=(0,e.findReactInstance)(_))}),E&&!E.child&&(!((b=E.alternate)===null||b===void 0)&&b.child)&&(E=E.alternate),E};e.getRootReactElement=s;const a=b=>{if(!b||typeof b=="string")return b;const C=Object.assign({},b);return delete C.children,C},o=b=>{if(!b)return;const{baseState:C}=b;return C||b},l=(b,C)=>{var A,E;let _={children:[]};if(_.element=b,_.parent=C,!b)return _;_.name=(0,e.getElementName)(b.type),typeof _.name!="string"&&(_.name=(E=(A=_.name)===null||A===void 0?void 0:A.toString)===null||E===void 0?void 0:E.call(A)),_.props=a(b.memoizedProps),_.state=o(b.memoizedState);let{child:P}=b;if(P)for(_.children.push(P);P.sibling;)_.children.push(P.sibling),P=P.sibling;return _.children=_.children.map(I=>(0,e.buildNodeTree)(I,_)),_};e.buildNodeTree=l;const u=b=>{var C,A;let E=(C=b==null?void 0:b.element)===null||C===void 0?void 0:C.stateNode;return E&&((A=E==null?void 0:E.constructor)===null||A===void 0?void 0:A.name)==="FiberRootNode"&&(E=E.containerInfo),n(E)?E:null};e.getDomElementForReactNode=u;const c=b=>{const C=(0,e.getDomElementForReactNode)(b);return C?(0,t.getUniqueLookupFromNode)(C):null};e.getUniqueLoookupFromReactTreeNode=c;const h=(b,C)=>{const A=(0,e.getDomElementForReactNode)(b);return A?((0,t.addUniqueLookupAsClass)(A,C),!0):!1};e.addUniqueLoookupToReactTreeNode=h;const d=b=>{const C=(0,e.getDomElementForReactNode)(b);return C?((0,t.removeUniqueLookupFromNode)(C),!0):!1};e.removeUniqueLoookupFromReactTreeNode=d;const f=(b,C)=>{const A=(0,i.v4)();(0,e.addUniqueLoookupToReactTreeNode)(b,A)&&(C[A]=b),b.children.forEach(_=>{(0,e.buildTreeLookupMap)(_,C)})};e.buildTreeLookupMap=f;const m=b=>{(0,e.removeUniqueLoookupFromReactTreeNode)(b),b.children.forEach(C=>{(0,e.clearLookupsFromTree)(C)})};e.clearLookupsFromTree=m;const g=b=>typeof b=="function",y=b=>typeof b=="object",x=b=>{var C;return b&&(g(b)||y(b)?b.displayName?g(b.displayName)?b.displayName():b.displayName:b.name?g(b.name)?b.name():b.name:!((C=b.render)===null||C===void 0)&&C.name?b.render.name:null:b)};e.getElementName=x;const w=(b,C,A)=>{let E=[b];const _=[];for(;E.length>0;){const P=E.shift();if(C(P)&&(_.push(P),A))break;E=E.concat(P.children||[])}return _};e.findElementInTree=w})(lF);var _ae={exports:{}};(function(e){var t=function(){var i=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function a(l,u){if(!s[l]){s[l]={};for(var c=0;c<l.length;c++)s[l][l.charAt(c)]=c}return s[l][u]}var o={compressToBase64:function(l){if(l==null)return"";var u=o._compress(l,6,function(c){return r.charAt(c)});switch(u.length%4){default:case 0:return u;case 1:return u+"===";case 2:return u+"==";case 3:return u+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:o._decompress(l.length,32,function(u){return a(r,l.charAt(u))})},compressToUTF16:function(l){return l==null?"":o._compress(l,15,function(u){return i(u+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:o._decompress(l.length,16384,function(u){return l.charCodeAt(u)-32})},compressToUint8Array:function(l){for(var u=o.compress(l),c=new Uint8Array(u.length*2),h=0,d=u.length;h<d;h++){var f=u.charCodeAt(h);c[h*2]=f>>>8,c[h*2+1]=f%256}return c},decompressFromUint8Array:function(l){if(l==null)return o.decompress(l);for(var u=new Array(l.length/2),c=0,h=u.length;c<h;c++)u[c]=l[c*2]*256+l[c*2+1];var d=[];return u.forEach(function(f){d.push(i(f))}),o.decompress(d.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":o._compress(l,6,function(u){return n.charAt(u)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),o._decompress(l.length,32,function(u){return a(n,l.charAt(u))}))},compress:function(l){return o._compress(l,16,function(u){return i(u)})},_compress:function(l,u,c){if(l==null)return"";var h,d,f={},m={},g="",y="",x="",w=2,b=3,C=2,A=[],E=0,_=0,P;for(P=0;P<l.length;P+=1)if(g=l.charAt(P),Object.prototype.hasOwnProperty.call(f,g)||(f[g]=b++,m[g]=!0),y=x+g,Object.prototype.hasOwnProperty.call(f,y))x=y;else{if(Object.prototype.hasOwnProperty.call(m,x)){if(x.charCodeAt(0)<256){for(h=0;h<C;h++)E=E<<1,_==u-1?(_=0,A.push(c(E)),E=0):_++;for(d=x.charCodeAt(0),h=0;h<8;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1}else{for(d=1,h=0;h<C;h++)E=E<<1|d,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=0;for(d=x.charCodeAt(0),h=0;h<16;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1}w--,w==0&&(w=Math.pow(2,C),C++),delete m[x]}else for(d=f[x],h=0;h<C;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1;w--,w==0&&(w=Math.pow(2,C),C++),f[y]=b++,x=String(g)}if(x!==""){if(Object.prototype.hasOwnProperty.call(m,x)){if(x.charCodeAt(0)<256){for(h=0;h<C;h++)E=E<<1,_==u-1?(_=0,A.push(c(E)),E=0):_++;for(d=x.charCodeAt(0),h=0;h<8;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1}else{for(d=1,h=0;h<C;h++)E=E<<1|d,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=0;for(d=x.charCodeAt(0),h=0;h<16;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1}w--,w==0&&(w=Math.pow(2,C),C++),delete m[x]}else for(d=f[x],h=0;h<C;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1;w--,w==0&&(w=Math.pow(2,C),C++)}for(d=2,h=0;h<C;h++)E=E<<1|d&1,_==u-1?(_=0,A.push(c(E)),E=0):_++,d=d>>1;for(;;)if(E=E<<1,_==u-1){A.push(c(E));break}else _++;return A.join("")},decompress:function(l){return l==null?"":l==""?null:o._decompress(l.length,32768,function(u){return l.charCodeAt(u)})},_decompress:function(l,u,c){var h=[],d=4,f=4,m=3,g="",y=[],x,w,b,C,A,E,_,P={val:c(0),position:u,index:1};for(x=0;x<3;x+=1)h[x]=x;for(b=0,A=Math.pow(2,2),E=1;E!=A;)C=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=c(P.index++)),b|=(C>0?1:0)*E,E<<=1;switch(b){case 0:for(b=0,A=Math.pow(2,8),E=1;E!=A;)C=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=c(P.index++)),b|=(C>0?1:0)*E,E<<=1;_=i(b);break;case 1:for(b=0,A=Math.pow(2,16),E=1;E!=A;)C=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=c(P.index++)),b|=(C>0?1:0)*E,E<<=1;_=i(b);break;case 2:return""}for(h[3]=_,w=_,y.push(_);;){if(P.index>l)return"";for(b=0,A=Math.pow(2,m),E=1;E!=A;)C=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=c(P.index++)),b|=(C>0?1:0)*E,E<<=1;switch(_=b){case 0:for(b=0,A=Math.pow(2,8),E=1;E!=A;)C=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=c(P.index++)),b|=(C>0?1:0)*E,E<<=1;h[f++]=i(b),_=f-1,d--;break;case 1:for(b=0,A=Math.pow(2,16),E=1;E!=A;)C=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=c(P.index++)),b|=(C>0?1:0)*E,E<<=1;h[f++]=i(b),_=f-1,d--;break;case 2:return y.join("")}if(d==0&&(d=Math.pow(2,m),m++),h[_])g=h[_];else if(_===f)g=w+w.charAt(0);else return null;y.push(g),h[f++]=w+g.charAt(0),d--,w=g,d==0&&(d=Math.pow(2,m),m++)}}};return o}();e!=null?e.exports=t:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return t})})(_ae);var sst=_ae.exports,dF={};Object.defineProperty(dF,"__esModule",{value:!0});const ast={init:()=>{(function(e,t){var i,r,n,s;t.__SV||(window.posthog=t,t._i=[],t.init=function(a,o,l){function u(h,d){var f=d.split(".");f.length==2&&(h=h[f[0]],d=f[1]),h[d]=function(){h.push([d].concat(Array.prototype.slice.call(arguments,0)))}}(n=e.createElement("script")).type="text/javascript",n.async=!0,n.src=o.api_host+"/static/array.js",(s=e.getElementsByTagName("script")[0]).parentNode.insertBefore(n,s);var c=t;for(l!==void 0?c=t[l]=[]:l="posthog",c.people=c.people||[],c.toString=function(h){var d="posthog";return l!=="posthog"&&(d+="."+l),h||(d+=" (stub)"),d},c.people.toString=function(){return c.toString(1)+".people (stub)"},i="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys getNextSurveyStep onSessionId".split(" "),r=0;r<i.length;r++)u(c,i[r]);t._i.push([a,o,l])},t.__SV=1)})(document,window.posthog||[]),posthog.init("phc_jjpEvBVV0R2mp44ePAL8Yt4jdtX5HW1lc493rkpUwwa",{api_host:"https://us.i.posthog.com",person_profiles:"identified_only",session_recording:{recordCrossOriginIframes:!0,maskAllInputs:!1,maskInputOptions:{password:!0}}})}};dF.default=ast;var v2={},FA={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */FA.exports;(function(e,t){(function(){var i,r="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",u=500,c="__lodash_placeholder__",h=1,d=2,f=4,m=1,g=2,y=1,x=2,w=4,b=8,C=16,A=32,E=64,_=128,P=256,I=512,D=30,k="...",B=800,z=16,W=1,$=2,Z=3,G=1/0,V=9007199254740991,J=17976931348623157e292,U=NaN,ie=4294967295,se=ie-1,ee=ie>>>1,ve=[["ary",_],["bind",y],["bindKey",x],["curry",b],["curryRight",C],["flip",I],["partial",A],["partialRight",E],["rearg",P]],_e="[object Arguments]",he="[object Array]",De="[object AsyncFunction]",we="[object Boolean]",Le="[object Date]",Te="[object DOMException]",ke="[object Error]",Xe="[object Function]",et="[object GeneratorFunction]",Ze="[object Map]",st="[object Number]",_t="[object Null]",St="[object Object]",ue="[object Promise]",Ee="[object Proxy]",Ae="[object RegExp]",Ge="[object Set]",ae="[object String]",te="[object Symbol]",Ne="[object Undefined]",Re="[object WeakMap]",Y="[object WeakSet]",Me="[object ArrayBuffer]",Ke="[object DataView]",ot="[object Float32Array]",qe="[object Float64Array]",It="[object Int8Array]",Ot="[object Int16Array]",Dt="[object Int32Array]",kt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",mt="[object Uint16Array]",Ht="[object Uint32Array]",Wt=/\b__p \+= '';/g,Ue=/\b(__p \+=) '' \+/g,dt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gt=/&(?:amp|lt|gt|quot|#39);/g,Bt=/[&<>"']/g,ei=RegExp(gt.source),zi=RegExp(Bt.source),vi=/<%-([\s\S]+?)%>/g,Yi=/<%([\s\S]+?)%>/g,wn=/<%=([\s\S]+?)%>/g,yr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rn=/^\w*$/,Yr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hn=/[\\^$.*+?()[\]{}|]/g,Jo=RegExp(Hn.source),Bl=/^\s+/,Ln=/\s/,me=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,pt=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xt=/[()=,{}\[\]\/\s]/,Qt=/\\(\\)?/g,hi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ui=/\w*$/,ri=/^[-+]0x[0-9a-f]+$/i,dr=/^0b[01]+$/i,Li=/^\[object .+?Constructor\]$/,Ni=/^0o[0-7]+$/i,bi=/^(?:0|[1-9]\d*)$/,on=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,is=/($^)/,Wn=/['\n\r\u2028\u2029\\]/g,Lr="\\ud800-\\udfff",Xi="\\u0300-\\u036f",ia="\\ufe20-\\ufe2f",Fi="\\u20d0-\\u20ff",Ya=Xi+ia+Fi,ra="\\u2700-\\u27bf",ks="a-z\\xdf-\\xf6\\xf8-\\xff",Aa="\\xac\\xb1\\xd7\\xf7",le="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",pe="\\u2000-\\u206f",Ce=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ye="A-Z\\xc0-\\xd6\\xd8-\\xde",We="\\ufe0e\\ufe0f",Ct=Aa+le+pe+Ce,En="['’]",Wu="["+Lr+"]",Di="["+Ct+"]",Dr="["+Ya+"]",el="\\d+",_o="["+ra+"]",na="["+ks+"]",bv="[^"+Lr+Ct+el+ra+ks+ye+"]",Nc="\\ud83c[\\udffb-\\udfff]",rs="(?:"+Dr+"|"+Nc+")",pn="[^"+Lr+"]",Ma="(?:\\ud83c[\\udde6-\\uddff]){2}",Gu="[\\ud800-\\udbff][\\udc00-\\udfff]",tl="["+ye+"]",il="\\u200d",Xa="(?:"+na+"|"+bv+")",Wh="(?:"+tl+"|"+bv+")",xf="(?:"+En+"(?:d|ll|m|re|s|t|ve))?",zl="(?:"+En+"(?:D|LL|M|RE|S|T|VE))?",Gh=rs+"?",kc="["+We+"]?",qh="(?:"+il+"(?:"+[pn,Ma,Gu].join("|")+")"+kc+Gh+")*",cm="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hm="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",dm=kc+Gh+qh,ji="(?:"+[_o,Ma,Gu].join("|")+")"+dm,rl="(?:"+[pn+Dr+"?",Dr,Ma,Gu,Wu].join("|")+")",zr=RegExp(En,"g"),_v=RegExp(Dr,"g"),Yh=RegExp(Nc+"(?="+Nc+")|"+rl+dm,"g"),fm=RegExp([tl+"?"+na+"+"+xf+"(?="+[Di,tl,"$"].join("|")+")",Wh+"+"+zl+"(?="+[Di,tl+Xa,"$"].join("|")+")",tl+"?"+Xa+"+"+xf,tl+"+"+zl,hm,cm,el,ji].join("|"),"g"),pm=RegExp("["+il+Lr+Ya+We+"]"),qu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xh=-1,Vi={};Vi[ot]=Vi[qe]=Vi[It]=Vi[Ot]=Vi[Dt]=Vi[kt]=Vi[Qe]=Vi[mt]=Vi[Ht]=!0,Vi[_e]=Vi[he]=Vi[Me]=Vi[we]=Vi[Ke]=Vi[Le]=Vi[ke]=Vi[Xe]=Vi[Ze]=Vi[st]=Vi[St]=Vi[Ae]=Vi[Ge]=Vi[ae]=Vi[Re]=!1;var mr={};mr[_e]=mr[he]=mr[Me]=mr[Ke]=mr[we]=mr[Le]=mr[ot]=mr[qe]=mr[It]=mr[Ot]=mr[Dt]=mr[Ze]=mr[st]=mr[St]=mr[Ae]=mr[Ge]=mr[ae]=mr[te]=mr[kt]=mr[Qe]=mr[mt]=mr[Ht]=!0,mr[ke]=mr[Xe]=mr[Re]=!1;var gm={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},bf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wv={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Kh=parseFloat,E1=parseInt,ym=typeof Nr=="object"&&Nr&&Nr.Object===Object&&Nr,gr=typeof self=="object"&&self&&self.Object===Object&&self,Sn=ym||gr||Function("return this")(),sa=t&&!t.nodeType&&t,Pa=sa&&!0&&e&&!e.nodeType&&e,xm=Pa&&Pa.exports===sa,bm=xm&&ym.process,aa=function(){try{var be=Pa&&Pa.require&&Pa.require("util").types;return be||bm&&bm.binding&&bm.binding("util")}catch{}}(),M=aa&&aa.isArrayBuffer,N=aa&&aa.isDate,H=aa&&aa.isMap,K=aa&&aa.isRegExp,re=aa&&aa.isSet,ne=aa&&aa.isTypedArray;function ce(be,je,Fe){switch(Fe.length){case 0:return be.call(je);case 1:return be.call(je,Fe[0]);case 2:return be.call(je,Fe[0],Fe[1]);case 3:return be.call(je,Fe[0],Fe[1],Fe[2])}return be.apply(je,Fe)}function Be(be,je,Fe,vt){for(var Tt=-1,Jt=be==null?0:be.length;++Tt<Jt;){var ii=be[Tt];je(vt,ii,Fe(ii),be)}return vt}function Pe(be,je){for(var Fe=-1,vt=be==null?0:be.length;++Fe<vt&&je(be[Fe],Fe,be)!==!1;);return be}function Ye(be,je){for(var Fe=be==null?0:be.length;Fe--&&je(be[Fe],Fe,be)!==!1;);return be}function ft(be,je){for(var Fe=-1,vt=be==null?0:be.length;++Fe<vt;)if(!je(be[Fe],Fe,be))return!1;return!0}function bt(be,je){for(var Fe=-1,vt=be==null?0:be.length,Tt=0,Jt=[];++Fe<vt;){var ii=be[Fe];je(ii,Fe,be)&&(Jt[Tt++]=ii)}return Jt}function at(be,je){var Fe=be==null?0:be.length;return!!Fe&&jr(be,je,0)>-1}function Nt(be,je,Fe){for(var vt=-1,Tt=be==null?0:be.length;++vt<Tt;)if(Fe(je,be[vt]))return!0;return!1}function Kt(be,je){for(var Fe=-1,vt=be==null?0:be.length,Tt=Array(vt);++Fe<vt;)Tt[Fe]=je(be[Fe],Fe,be);return Tt}function Hi(be,je){for(var Fe=-1,vt=je.length,Tt=be.length;++Fe<vt;)be[Tt+Fe]=je[Fe];return be}function Wi(be,je,Fe,vt){var Tt=-1,Jt=be==null?0:be.length;for(vt&&Jt&&(Fe=be[++Tt]);++Tt<Jt;)Fe=je(Fe,be[Tt],Tt,be);return Fe}function ns(be,je,Fe,vt){var Tt=be==null?0:be.length;for(vt&&Tt&&(Fe=be[--Tt]);Tt--;)Fe=je(Fe,be[Tt],Tt,be);return Fe}function ln(be,je){for(var Fe=-1,vt=be==null?0:be.length;++Fe<vt;)if(je(be[Fe],Fe,be))return!0;return!1}var nl=uu("length");function wo(be){return be.split("")}function ar(be){return be.match(tt)||[]}function Eo(be,je,Fe){var vt;return Fe(be,function(Tt,Jt,ii){if(je(Tt,Jt,ii))return vt=Jt,!1}),vt}function Gi(be,je,Fe,vt){for(var Tt=be.length,Jt=Fe+(vt?1:-1);vt?Jt--:++Jt<Tt;)if(je(be[Jt],Jt,be))return Jt;return-1}function jr(be,je,Fe){return je===je?zc(be,je,Fe):Gi(be,Bs,Fe)}function Fl(be,je,Fe,vt){for(var Tt=Fe-1,Jt=be.length;++Tt<Jt;)if(vt(be[Tt],je))return Tt;return-1}function Bs(be){return be!==be}function Ka(be,je){var Fe=be==null?0:be.length;return Fe?oa(be,je)/Fe:U}function uu(be){return function(je){return je==null?i:je[be]}}function $a(be){return function(je){return be==null?i:be[je]}}function So(be,je,Fe,vt,Tt){return Tt(be,function(Jt,ii,Gt){Fe=vt?(vt=!1,Jt):je(Fe,Jt,ii,Gt)}),Fe}function sl(be,je){var Fe=be.length;for(be.sort(je);Fe--;)be[Fe]=be[Fe].value;return be}function oa(be,je){for(var Fe,vt=-1,Tt=be.length;++vt<Tt;){var Jt=je(be[vt]);Jt!==i&&(Fe=Fe===i?Jt:Fe+Jt)}return Fe}function $h(be,je){for(var Fe=-1,vt=Array(be);++Fe<be;)vt[Fe]=je(Fe);return vt}function al(be,je){return Kt(je,function(Fe){return[Fe,be[Fe]]})}function ol(be){return be&&be.slice(0,wm(be)+1).replace(Bl,"")}function un(be){return function(je){return be(je)}}function cu(be,je){return Kt(je,function(Fe){return be[Fe]})}function Zh(be,je){return be.has(je)}function ir(be,je){for(var Fe=-1,vt=be.length;++Fe<vt&&jr(je,be[Fe],0)>-1;);return Fe}function Qh(be,je){for(var Fe=be.length;Fe--&&jr(je,be[Fe],0)>-1;);return Fe}function _s(be,je){for(var Fe=be.length,vt=0;Fe--;)be[Fe]===je&&++vt;return vt}var Bc=$a(gm),Jh=$a(bf);function Ev(be){return"\\"+vm[be]}function ed(be,je){return be==null?i:be[je]}function Za(be){return pm.test(be)}function ll(be){return qu.test(be)}function To(be){for(var je,Fe=[];!(je=be.next()).done;)Fe.push(je.value);return Fe}function _f(be){var je=-1,Fe=Array(be.size);return be.forEach(function(vt,Tt){Fe[++je]=[Tt,vt]}),Fe}function hu(be,je){return function(Fe){return be(je(Fe))}}function Co(be,je){for(var Fe=-1,vt=be.length,Tt=0,Jt=[];++Fe<vt;){var ii=be[Fe];(ii===je||ii===c)&&(be[Fe]=c,Jt[Tt++]=Fe)}return Jt}function zs(be){var je=-1,Fe=Array(be.size);return be.forEach(function(vt){Fe[++je]=vt}),Fe}function _m(be){var je=-1,Fe=Array(be.size);return be.forEach(function(vt){Fe[++je]=[vt,vt]}),Fe}function zc(be,je,Fe){for(var vt=Fe-1,Tt=be.length;++vt<Tt;)if(be[vt]===je)return vt;return-1}function wf(be,je,Fe){for(var vt=Fe+1;vt--;)if(be[vt]===je)return vt;return vt}function ws(be){return Za(be)?id(be):nl(be)}function Es(be){return Za(be)?Se(be):wo(be)}function wm(be){for(var je=be.length;je--&&Ln.test(be.charAt(je)););return je}var td=$a(wv);function id(be){for(var je=Yh.lastIndex=0;Yh.test(be);)++je;return je}function Se(be){return be.match(Yh)||[]}function Ve(be){return be.match(fm)||[]}var it=function be(je){je=je==null?Sn:ut.defaults(Sn.Object(),je,ut.pick(Sn,mm));var Fe=je.Array,vt=je.Date,Tt=je.Error,Jt=je.Function,ii=je.Math,Gt=je.Object,er=je.RegExp,si=je.String,Zi=je.TypeError,ss=Fe.prototype,Nn=Jt.prototype,as=Gt.prototype,la=je["__core-js_shared__"],Ul=Nn.toString,Ai=as.hasOwnProperty,y2=0,rd=function(){var v=/[^.]+$/.exec(la&&la.keys&&la.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Em=as.toString,bw=Ul.call(Gt),x2=Sn._,Yu=er("^"+Ul.call(Ai).replace(Hn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sm=xm?je.Buffer:i,Xu=je.Symbol,Fc=je.Uint8Array,_w=Sm?Sm.allocUnsafe:i,nd=hu(Gt.getPrototypeOf,Gt),Ef=Gt.create,S1=as.propertyIsEnumerable,Tm=ss.splice,ww=Xu?Xu.isConcatSpreadable:i,Sf=Xu?Xu.iterator:i,Uc=Xu?Xu.toStringTag:i,Cm=function(){try{var v=Nm(Gt,"defineProperty");return v({},"",{}),v}catch{}}(),Ew=je.clearTimeout!==Sn.clearTimeout&&je.clearTimeout,Sw=vt&&vt.now!==Sn.Date.now&&vt.now,b2=je.setTimeout!==Sn.setTimeout&&je.setTimeout,Am=ii.ceil,Mm=ii.floor,T1=Gt.getOwnPropertySymbols,p=Sm?Sm.isBuffer:i,S=je.isFinite,O=ss.join,F=hu(Gt.keys,Gt),Q=ii.max,fe=ii.min,ze=vt.now,rt=je.parseInt,ct=ii.random,Rt=ss.reverse,$t=Nm(je,"DataView"),fi=Nm(je,"Map"),rr=Nm(je,"Promise"),Gn=Nm(je,"Set"),Dn=Nm(je,"WeakMap"),ua=Nm(Gt,"create"),Fs=Dn&&new Dn,jl={},_2=km($t),w2=km(fi),E2=km(rr),Tw=km(Gn),S2=km(Dn),Pm=Xu?Xu.prototype:i,mn=Pm?Pm.valueOf:i,Dm=Pm?Pm.toString:i;function ge(v){if(qn(v)&&!tr(v)&&!(v instanceof fr)){if(v instanceof Qa)return v;if(Ai.call(v,"__wrapped__"))return f5(v)}return new Qa(v)}var Tf=function(){function v(){}return function(T){if(!kn(T))return{};if(Ef)return Ef(T);v.prototype=T;var R=new v;return v.prototype=i,R}}();function Sv(){}function Qa(v,T){this.__wrapped__=v,this.__actions__=[],this.__chain__=!!T,this.__index__=0,this.__values__=i}ge.templateSettings={escape:vi,evaluate:Yi,interpolate:wn,variable:"",imports:{_:ge}},ge.prototype=Sv.prototype,ge.prototype.constructor=ge,Qa.prototype=Tf(Sv.prototype),Qa.prototype.constructor=Qa;function fr(v){this.__wrapped__=v,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function T2(){var v=new fr(this.__wrapped__);return v.__actions__=ul(this.__actions__),v.__dir__=this.__dir__,v.__filtered__=this.__filtered__,v.__iteratees__=ul(this.__iteratees__),v.__takeCount__=this.__takeCount__,v.__views__=ul(this.__views__),v}function Sae(){if(this.__filtered__){var v=new fr(this);v.__dir__=-1,v.__filtered__=!0}else v=this.clone(),v.__dir__*=-1;return v}function Tae(){var v=this.__wrapped__.value(),T=this.__dir__,R=tr(v),X=T<0,oe=R?v.length:0,xe=Boe(0,oe,this.__views__),Oe=xe.start,He=xe.end,Je=He-Oe,At=X?He:Oe-1,Mt=this.__iteratees__,Lt=Mt.length,Yt=0,li=fe(Je,this.__takeCount__);if(!R||!X&&oe==Je&&li==Je)return kF(v,this.__actions__);var Ii=[];e:for(;Je--&&Yt<li;){At+=T;for(var cr=-1,Oi=v[At];++cr<Lt;){var xr=Mt[cr],Ar=xr.iteratee,Wl=xr.type,Po=Ar(Oi);if(Wl==$)Oi=Po;else if(!Po){if(Wl==W)continue e;break e}}Ii[Yt++]=Oi}return Ii}fr.prototype=Tf(Sv.prototype),fr.prototype.constructor=fr;function Im(v){var T=-1,R=v==null?0:v.length;for(this.clear();++T<R;){var X=v[T];this.set(X[0],X[1])}}function Cae(){this.__data__=ua?ua(null):{},this.size=0}function Aae(v){var T=this.has(v)&&delete this.__data__[v];return this.size-=T?1:0,T}function Mae(v){var T=this.__data__;if(ua){var R=T[v];return R===l?i:R}return Ai.call(T,v)?T[v]:i}function Pae(v){var T=this.__data__;return ua?T[v]!==i:Ai.call(T,v)}function Dae(v,T){var R=this.__data__;return this.size+=this.has(v)?0:1,R[v]=ua&&T===i?l:T,this}Im.prototype.clear=Cae,Im.prototype.delete=Aae,Im.prototype.get=Mae,Im.prototype.has=Pae,Im.prototype.set=Dae;function sd(v){var T=-1,R=v==null?0:v.length;for(this.clear();++T<R;){var X=v[T];this.set(X[0],X[1])}}function Iae(){this.__data__=[],this.size=0}function Oae(v){var T=this.__data__,R=Cw(T,v);if(R<0)return!1;var X=T.length-1;return R==X?T.pop():Tm.call(T,R,1),--this.size,!0}function Rae(v){var T=this.__data__,R=Cw(T,v);return R<0?i:T[R][1]}function Lae(v){return Cw(this.__data__,v)>-1}function Nae(v,T){var R=this.__data__,X=Cw(R,v);return X<0?(++this.size,R.push([v,T])):R[X][1]=T,this}sd.prototype.clear=Iae,sd.prototype.delete=Oae,sd.prototype.get=Rae,sd.prototype.has=Lae,sd.prototype.set=Nae;function ad(v){var T=-1,R=v==null?0:v.length;for(this.clear();++T<R;){var X=v[T];this.set(X[0],X[1])}}function kae(){this.size=0,this.__data__={hash:new Im,map:new(fi||sd),string:new Im}}function Bae(v){var T=zw(this,v).delete(v);return this.size-=T?1:0,T}function zae(v){return zw(this,v).get(v)}function Fae(v){return zw(this,v).has(v)}function Uae(v,T){var R=zw(this,v),X=R.size;return R.set(v,T),this.size+=R.size==X?0:1,this}ad.prototype.clear=kae,ad.prototype.delete=Bae,ad.prototype.get=zae,ad.prototype.has=Fae,ad.prototype.set=Uae;function Om(v){var T=-1,R=v==null?0:v.length;for(this.__data__=new ad;++T<R;)this.add(v[T])}function jae(v){return this.__data__.set(v,l),this}function Vae(v){return this.__data__.has(v)}Om.prototype.add=Om.prototype.push=jae,Om.prototype.has=Vae;function Ku(v){var T=this.__data__=new sd(v);this.size=T.size}function Hae(){this.__data__=new sd,this.size=0}function Wae(v){var T=this.__data__,R=T.delete(v);return this.size=T.size,R}function Gae(v){return this.__data__.get(v)}function qae(v){return this.__data__.has(v)}function Yae(v,T){var R=this.__data__;if(R instanceof sd){var X=R.__data__;if(!fi||X.length<n-1)return X.push([v,T]),this.size=++R.size,this;R=this.__data__=new ad(X)}return R.set(v,T),this.size=R.size,this}Ku.prototype.clear=Hae,Ku.prototype.delete=Wae,Ku.prototype.get=Gae,Ku.prototype.has=qae,Ku.prototype.set=Yae;function fF(v,T){var R=tr(v),X=!R&&Bm(v),oe=!R&&!X&&Df(v),xe=!R&&!X&&!oe&&Mv(v),Oe=R||X||oe||xe,He=Oe?$h(v.length,si):[],Je=He.length;for(var At in v)(T||Ai.call(v,At))&&!(Oe&&(At=="length"||oe&&(At=="offset"||At=="parent")||xe&&(At=="buffer"||At=="byteLength"||At=="byteOffset")||cd(At,Je)))&&He.push(At);return He}function pF(v){var T=v.length;return T?v[k2(0,T-1)]:i}function Xae(v,T){return Fw(ul(v),Rm(T,0,v.length))}function Kae(v){return Fw(ul(v))}function C2(v,T,R){(R!==i&&!$u(v[T],R)||R===i&&!(T in v))&&od(v,T,R)}function C1(v,T,R){var X=v[T];(!(Ai.call(v,T)&&$u(X,R))||R===i&&!(T in v))&&od(v,T,R)}function Cw(v,T){for(var R=v.length;R--;)if($u(v[R][0],T))return R;return-1}function $ae(v,T,R,X){return Cf(v,function(oe,xe,Oe){T(X,oe,R(oe),Oe)}),X}function mF(v,T){return v&&Vc(T,ca(T),v)}function Zae(v,T){return v&&Vc(T,hl(T),v)}function od(v,T,R){T=="__proto__"&&Cm?Cm(v,T,{configurable:!0,enumerable:!0,value:R,writable:!0}):v[T]=R}function A2(v,T){for(var R=-1,X=T.length,oe=Fe(X),xe=v==null;++R<X;)oe[R]=xe?i:oP(v,T[R]);return oe}function Rm(v,T,R){return v===v&&(R!==i&&(v=v<=R?v:R),T!==i&&(v=v>=T?v:T)),v}function du(v,T,R,X,oe,xe){var Oe,He=T&h,Je=T&d,At=T&f;if(R&&(Oe=oe?R(v,X,oe,xe):R(v)),Oe!==i)return Oe;if(!kn(v))return v;var Mt=tr(v);if(Mt){if(Oe=Foe(v),!He)return ul(v,Oe)}else{var Lt=Ja(v),Yt=Lt==Xe||Lt==et;if(Df(v))return FF(v,He);if(Lt==St||Lt==_e||Yt&&!oe){if(Oe=Je||Yt?{}:n5(v),!He)return Je?Moe(v,Zae(Oe,v)):Aoe(v,mF(Oe,v))}else{if(!mr[Lt])return oe?v:{};Oe=Uoe(v,Lt,He)}}xe||(xe=new Ku);var li=xe.get(v);if(li)return li;xe.set(v,Oe),R5(v)?v.forEach(function(Oi){Oe.add(du(Oi,T,R,Oi,v,xe))}):I5(v)&&v.forEach(function(Oi,xr){Oe.set(xr,du(Oi,T,R,xr,v,xe))});var Ii=At?Je?Y2:q2:Je?hl:ca,cr=Mt?i:Ii(v);return Pe(cr||v,function(Oi,xr){cr&&(xr=Oi,Oi=v[xr]),C1(Oe,xr,du(Oi,T,R,xr,v,xe))}),Oe}function Qae(v){var T=ca(v);return function(R){return gF(R,v,T)}}function gF(v,T,R){var X=R.length;if(v==null)return!X;for(v=Gt(v);X--;){var oe=R[X],xe=T[oe],Oe=v[oe];if(Oe===i&&!(oe in v)||!xe(Oe))return!1}return!0}function vF(v,T,R){if(typeof v!="function")throw new Zi(a);return R1(function(){v.apply(i,R)},T)}function A1(v,T,R,X){var oe=-1,xe=at,Oe=!0,He=v.length,Je=[],At=T.length;if(!He)return Je;R&&(T=Kt(T,un(R))),X?(xe=Nt,Oe=!1):T.length>=n&&(xe=Zh,Oe=!1,T=new Om(T));e:for(;++oe<He;){var Mt=v[oe],Lt=R==null?Mt:R(Mt);if(Mt=X||Mt!==0?Mt:0,Oe&&Lt===Lt){for(var Yt=At;Yt--;)if(T[Yt]===Lt)continue e;Je.push(Mt)}else xe(T,Lt,X)||Je.push(Mt)}return Je}var Cf=WF(jc),yF=WF(P2,!0);function Jae(v,T){var R=!0;return Cf(v,function(X,oe,xe){return R=!!T(X,oe,xe),R}),R}function Aw(v,T,R){for(var X=-1,oe=v.length;++X<oe;){var xe=v[X],Oe=T(xe);if(Oe!=null&&(He===i?Oe===Oe&&!Hl(Oe):R(Oe,He)))var He=Oe,Je=xe}return Je}function eoe(v,T,R,X){var oe=v.length;for(R=or(R),R<0&&(R=-R>oe?0:oe+R),X=X===i||X>oe?oe:or(X),X<0&&(X+=oe),X=R>X?0:N5(X);R<X;)v[R++]=T;return v}function xF(v,T){var R=[];return Cf(v,function(X,oe,xe){T(X,oe,xe)&&R.push(X)}),R}function Da(v,T,R,X,oe){var xe=-1,Oe=v.length;for(R||(R=Voe),oe||(oe=[]);++xe<Oe;){var He=v[xe];T>0&&R(He)?T>1?Da(He,T-1,R,X,oe):Hi(oe,He):X||(oe[oe.length]=He)}return oe}var M2=GF(),bF=GF(!0);function jc(v,T){return v&&M2(v,T,ca)}function P2(v,T){return v&&bF(v,T,ca)}function Mw(v,T){return bt(T,function(R){return hd(v[R])})}function Lm(v,T){T=Mf(T,v);for(var R=0,X=T.length;v!=null&&R<X;)v=v[Hc(T[R++])];return R&&R==X?v:i}function _F(v,T,R){var X=T(v);return tr(v)?X:Hi(X,R(v))}function Ao(v){return v==null?v===i?Ne:_t:Uc&&Uc in Gt(v)?koe(v):Koe(v)}function D2(v,T){return v>T}function toe(v,T){return v!=null&&Ai.call(v,T)}function ioe(v,T){return v!=null&&T in Gt(v)}function roe(v,T,R){return v>=fe(T,R)&&v<Q(T,R)}function I2(v,T,R){for(var X=R?Nt:at,oe=v[0].length,xe=v.length,Oe=xe,He=Fe(xe),Je=1/0,At=[];Oe--;){var Mt=v[Oe];Oe&&T&&(Mt=Kt(Mt,un(T))),Je=fe(Mt.length,Je),He[Oe]=!R&&(T||oe>=120&&Mt.length>=120)?new Om(Oe&&Mt):i}Mt=v[0];var Lt=-1,Yt=He[0];e:for(;++Lt<oe&&At.length<Je;){var li=Mt[Lt],Ii=T?T(li):li;if(li=R||li!==0?li:0,!(Yt?Zh(Yt,Ii):X(At,Ii,R))){for(Oe=xe;--Oe;){var cr=He[Oe];if(!(cr?Zh(cr,Ii):X(v[Oe],Ii,R)))continue e}Yt&&Yt.push(Ii),At.push(li)}}return At}function noe(v,T,R,X){return jc(v,function(oe,xe,Oe){T(X,R(oe),xe,Oe)}),X}function M1(v,T,R){T=Mf(T,v),v=l5(v,T);var X=v==null?v:v[Hc(pu(T))];return X==null?i:ce(X,v,R)}function wF(v){return qn(v)&&Ao(v)==_e}function soe(v){return qn(v)&&Ao(v)==Me}function aoe(v){return qn(v)&&Ao(v)==Le}function P1(v,T,R,X,oe){return v===T?!0:v==null||T==null||!qn(v)&&!qn(T)?v!==v&&T!==T:ooe(v,T,R,X,P1,oe)}function ooe(v,T,R,X,oe,xe){var Oe=tr(v),He=tr(T),Je=Oe?he:Ja(v),At=He?he:Ja(T);Je=Je==_e?St:Je,At=At==_e?St:At;var Mt=Je==St,Lt=At==St,Yt=Je==At;if(Yt&&Df(v)){if(!Df(T))return!1;Oe=!0,Mt=!1}if(Yt&&!Mt)return xe||(xe=new Ku),Oe||Mv(v)?t5(v,T,R,X,oe,xe):Loe(v,T,Je,R,X,oe,xe);if(!(R&m)){var li=Mt&&Ai.call(v,"__wrapped__"),Ii=Lt&&Ai.call(T,"__wrapped__");if(li||Ii){var cr=li?v.value():v,Oi=Ii?T.value():T;return xe||(xe=new Ku),oe(cr,Oi,R,X,xe)}}return Yt?(xe||(xe=new Ku),Noe(v,T,R,X,oe,xe)):!1}function loe(v){return qn(v)&&Ja(v)==Ze}function O2(v,T,R,X){var oe=R.length,xe=oe,Oe=!X;if(v==null)return!xe;for(v=Gt(v);oe--;){var He=R[oe];if(Oe&&He[2]?He[1]!==v[He[0]]:!(He[0]in v))return!1}for(;++oe<xe;){He=R[oe];var Je=He[0],At=v[Je],Mt=He[1];if(Oe&&He[2]){if(At===i&&!(Je in v))return!1}else{var Lt=new Ku;if(X)var Yt=X(At,Mt,Je,v,T,Lt);if(!(Yt===i?P1(Mt,At,m|g,X,Lt):Yt))return!1}}return!0}function EF(v){if(!kn(v)||Woe(v))return!1;var T=hd(v)?Yu:Li;return T.test(km(v))}function uoe(v){return qn(v)&&Ao(v)==Ae}function coe(v){return qn(v)&&Ja(v)==Ge}function hoe(v){return qn(v)&&Gw(v.length)&&!!Vi[Ao(v)]}function SF(v){return typeof v=="function"?v:v==null?dl:typeof v=="object"?tr(v)?AF(v[0],v[1]):CF(v):q5(v)}function R2(v){if(!O1(v))return F(v);var T=[];for(var R in Gt(v))Ai.call(v,R)&&R!="constructor"&&T.push(R);return T}function doe(v){if(!kn(v))return Xoe(v);var T=O1(v),R=[];for(var X in v)X=="constructor"&&(T||!Ai.call(v,X))||R.push(X);return R}function L2(v,T){return v<T}function TF(v,T){var R=-1,X=cl(v)?Fe(v.length):[];return Cf(v,function(oe,xe,Oe){X[++R]=T(oe,xe,Oe)}),X}function CF(v){var T=K2(v);return T.length==1&&T[0][2]?a5(T[0][0],T[0][1]):function(R){return R===v||O2(R,v,T)}}function AF(v,T){return Z2(v)&&s5(T)?a5(Hc(v),T):function(R){var X=oP(R,v);return X===i&&X===T?lP(R,v):P1(T,X,m|g)}}function Pw(v,T,R,X,oe){v!==T&&M2(T,function(xe,Oe){if(oe||(oe=new Ku),kn(xe))foe(v,T,Oe,R,Pw,X,oe);else{var He=X?X(J2(v,Oe),xe,Oe+"",v,T,oe):i;He===i&&(He=xe),C2(v,Oe,He)}},hl)}function foe(v,T,R,X,oe,xe,Oe){var He=J2(v,R),Je=J2(T,R),At=Oe.get(Je);if(At){C2(v,R,At);return}var Mt=xe?xe(He,Je,R+"",v,T,Oe):i,Lt=Mt===i;if(Lt){var Yt=tr(Je),li=!Yt&&Df(Je),Ii=!Yt&&!li&&Mv(Je);Mt=Je,Yt||li||Ii?tr(He)?Mt=He:os(He)?Mt=ul(He):li?(Lt=!1,Mt=FF(Je,!0)):Ii?(Lt=!1,Mt=UF(Je,!0)):Mt=[]:L1(Je)||Bm(Je)?(Mt=He,Bm(He)?Mt=k5(He):(!kn(He)||hd(He))&&(Mt=n5(Je))):Lt=!1}Lt&&(Oe.set(Je,Mt),oe(Mt,Je,X,xe,Oe),Oe.delete(Je)),C2(v,R,Mt)}function MF(v,T){var R=v.length;if(R)return T+=T<0?R:0,cd(T,R)?v[T]:i}function PF(v,T,R){T.length?T=Kt(T,function(xe){return tr(xe)?function(Oe){return Lm(Oe,xe.length===1?xe[0]:xe)}:xe}):T=[dl];var X=-1;T=Kt(T,un(Mi()));var oe=TF(v,function(xe,Oe,He){var Je=Kt(T,function(At){return At(xe)});return{criteria:Je,index:++X,value:xe}});return sl(oe,function(xe,Oe){return Coe(xe,Oe,R)})}function poe(v,T){return DF(v,T,function(R,X){return lP(v,X)})}function DF(v,T,R){for(var X=-1,oe=T.length,xe={};++X<oe;){var Oe=T[X],He=Lm(v,Oe);R(He,Oe)&&D1(xe,Mf(Oe,v),He)}return xe}function moe(v){return function(T){return Lm(T,v)}}function N2(v,T,R,X){var oe=X?Fl:jr,xe=-1,Oe=T.length,He=v;for(v===T&&(T=ul(T)),R&&(He=Kt(v,un(R)));++xe<Oe;)for(var Je=0,At=T[xe],Mt=R?R(At):At;(Je=oe(He,Mt,Je,X))>-1;)He!==v&&Tm.call(He,Je,1),Tm.call(v,Je,1);return v}function IF(v,T){for(var R=v?T.length:0,X=R-1;R--;){var oe=T[R];if(R==X||oe!==xe){var xe=oe;cd(oe)?Tm.call(v,oe,1):F2(v,oe)}}return v}function k2(v,T){return v+Mm(ct()*(T-v+1))}function goe(v,T,R,X){for(var oe=-1,xe=Q(Am((T-v)/(R||1)),0),Oe=Fe(xe);xe--;)Oe[X?xe:++oe]=v,v+=R;return Oe}function B2(v,T){var R="";if(!v||T<1||T>V)return R;do T%2&&(R+=v),T=Mm(T/2),T&&(v+=v);while(T);return R}function pr(v,T){return eP(o5(v,T,dl),v+"")}function voe(v){return pF(Pv(v))}function yoe(v,T){var R=Pv(v);return Fw(R,Rm(T,0,R.length))}function D1(v,T,R,X){if(!kn(v))return v;T=Mf(T,v);for(var oe=-1,xe=T.length,Oe=xe-1,He=v;He!=null&&++oe<xe;){var Je=Hc(T[oe]),At=R;if(Je==="__proto__"||Je==="constructor"||Je==="prototype")return v;if(oe!=Oe){var Mt=He[Je];At=X?X(Mt,Je,He):i,At===i&&(At=kn(Mt)?Mt:cd(T[oe+1])?[]:{})}C1(He,Je,At),He=He[Je]}return v}var OF=Fs?function(v,T){return Fs.set(v,T),v}:dl,xoe=Cm?function(v,T){return Cm(v,"toString",{configurable:!0,enumerable:!1,value:cP(T),writable:!0})}:dl;function boe(v){return Fw(Pv(v))}function fu(v,T,R){var X=-1,oe=v.length;T<0&&(T=-T>oe?0:oe+T),R=R>oe?oe:R,R<0&&(R+=oe),oe=T>R?0:R-T>>>0,T>>>=0;for(var xe=Fe(oe);++X<oe;)xe[X]=v[X+T];return xe}function _oe(v,T){var R;return Cf(v,function(X,oe,xe){return R=T(X,oe,xe),!R}),!!R}function Dw(v,T,R){var X=0,oe=v==null?X:v.length;if(typeof T=="number"&&T===T&&oe<=ee){for(;X<oe;){var xe=X+oe>>>1,Oe=v[xe];Oe!==null&&!Hl(Oe)&&(R?Oe<=T:Oe<T)?X=xe+1:oe=xe}return oe}return z2(v,T,dl,R)}function z2(v,T,R,X){var oe=0,xe=v==null?0:v.length;if(xe===0)return 0;T=R(T);for(var Oe=T!==T,He=T===null,Je=Hl(T),At=T===i;oe<xe;){var Mt=Mm((oe+xe)/2),Lt=R(v[Mt]),Yt=Lt!==i,li=Lt===null,Ii=Lt===Lt,cr=Hl(Lt);if(Oe)var Oi=X||Ii;else At?Oi=Ii&&(X||Yt):He?Oi=Ii&&Yt&&(X||!li):Je?Oi=Ii&&Yt&&!li&&(X||!cr):li||cr?Oi=!1:Oi=X?Lt<=T:Lt<T;Oi?oe=Mt+1:xe=Mt}return fe(xe,se)}function RF(v,T){for(var R=-1,X=v.length,oe=0,xe=[];++R<X;){var Oe=v[R],He=T?T(Oe):Oe;if(!R||!$u(He,Je)){var Je=He;xe[oe++]=Oe===0?0:Oe}}return xe}function LF(v){return typeof v=="number"?v:Hl(v)?U:+v}function Vl(v){if(typeof v=="string")return v;if(tr(v))return Kt(v,Vl)+"";if(Hl(v))return Dm?Dm.call(v):"";var T=v+"";return T=="0"&&1/v==-1/0?"-0":T}function Af(v,T,R){var X=-1,oe=at,xe=v.length,Oe=!0,He=[],Je=He;if(R)Oe=!1,oe=Nt;else if(xe>=n){var At=T?null:Ooe(v);if(At)return zs(At);Oe=!1,oe=Zh,Je=new Om}else Je=T?[]:He;e:for(;++X<xe;){var Mt=v[X],Lt=T?T(Mt):Mt;if(Mt=R||Mt!==0?Mt:0,Oe&&Lt===Lt){for(var Yt=Je.length;Yt--;)if(Je[Yt]===Lt)continue e;T&&Je.push(Lt),He.push(Mt)}else oe(Je,Lt,R)||(Je!==He&&Je.push(Lt),He.push(Mt))}return He}function F2(v,T){return T=Mf(T,v),v=l5(v,T),v==null||delete v[Hc(pu(T))]}function NF(v,T,R,X){return D1(v,T,R(Lm(v,T)),X)}function Iw(v,T,R,X){for(var oe=v.length,xe=X?oe:-1;(X?xe--:++xe<oe)&&T(v[xe],xe,v););return R?fu(v,X?0:xe,X?xe+1:oe):fu(v,X?xe+1:0,X?oe:xe)}function kF(v,T){var R=v;return R instanceof fr&&(R=R.value()),Wi(T,function(X,oe){return oe.func.apply(oe.thisArg,Hi([X],oe.args))},R)}function U2(v,T,R){var X=v.length;if(X<2)return X?Af(v[0]):[];for(var oe=-1,xe=Fe(X);++oe<X;)for(var Oe=v[oe],He=-1;++He<X;)He!=oe&&(xe[oe]=A1(xe[oe]||Oe,v[He],T,R));return Af(Da(xe,1),T,R)}function BF(v,T,R){for(var X=-1,oe=v.length,xe=T.length,Oe={};++X<oe;){var He=X<xe?T[X]:i;R(Oe,v[X],He)}return Oe}function j2(v){return os(v)?v:[]}function V2(v){return typeof v=="function"?v:dl}function Mf(v,T){return tr(v)?v:Z2(v,T)?[v]:d5(Wr(v))}var woe=pr;function Pf(v,T,R){var X=v.length;return R=R===i?X:R,!T&&R>=X?v:fu(v,T,R)}var zF=Ew||function(v){return Sn.clearTimeout(v)};function FF(v,T){if(T)return v.slice();var R=v.length,X=_w?_w(R):new v.constructor(R);return v.copy(X),X}function H2(v){var T=new v.constructor(v.byteLength);return new Fc(T).set(new Fc(v)),T}function Eoe(v,T){var R=T?H2(v.buffer):v.buffer;return new v.constructor(R,v.byteOffset,v.byteLength)}function Soe(v){var T=new v.constructor(v.source,ui.exec(v));return T.lastIndex=v.lastIndex,T}function Toe(v){return mn?Gt(mn.call(v)):{}}function UF(v,T){var R=T?H2(v.buffer):v.buffer;return new v.constructor(R,v.byteOffset,v.length)}function jF(v,T){if(v!==T){var R=v!==i,X=v===null,oe=v===v,xe=Hl(v),Oe=T!==i,He=T===null,Je=T===T,At=Hl(T);if(!He&&!At&&!xe&&v>T||xe&&Oe&&Je&&!He&&!At||X&&Oe&&Je||!R&&Je||!oe)return 1;if(!X&&!xe&&!At&&v<T||At&&R&&oe&&!X&&!xe||He&&R&&oe||!Oe&&oe||!Je)return-1}return 0}function Coe(v,T,R){for(var X=-1,oe=v.criteria,xe=T.criteria,Oe=oe.length,He=R.length;++X<Oe;){var Je=jF(oe[X],xe[X]);if(Je){if(X>=He)return Je;var At=R[X];return Je*(At=="desc"?-1:1)}}return v.index-T.index}function VF(v,T,R,X){for(var oe=-1,xe=v.length,Oe=R.length,He=-1,Je=T.length,At=Q(xe-Oe,0),Mt=Fe(Je+At),Lt=!X;++He<Je;)Mt[He]=T[He];for(;++oe<Oe;)(Lt||oe<xe)&&(Mt[R[oe]]=v[oe]);for(;At--;)Mt[He++]=v[oe++];return Mt}function HF(v,T,R,X){for(var oe=-1,xe=v.length,Oe=-1,He=R.length,Je=-1,At=T.length,Mt=Q(xe-He,0),Lt=Fe(Mt+At),Yt=!X;++oe<Mt;)Lt[oe]=v[oe];for(var li=oe;++Je<At;)Lt[li+Je]=T[Je];for(;++Oe<He;)(Yt||oe<xe)&&(Lt[li+R[Oe]]=v[oe++]);return Lt}function ul(v,T){var R=-1,X=v.length;for(T||(T=Fe(X));++R<X;)T[R]=v[R];return T}function Vc(v,T,R,X){var oe=!R;R||(R={});for(var xe=-1,Oe=T.length;++xe<Oe;){var He=T[xe],Je=X?X(R[He],v[He],He,R,v):i;Je===i&&(Je=v[He]),oe?od(R,He,Je):C1(R,He,Je)}return R}function Aoe(v,T){return Vc(v,$2(v),T)}function Moe(v,T){return Vc(v,i5(v),T)}function Ow(v,T){return function(R,X){var oe=tr(R)?Be:$ae,xe=T?T():{};return oe(R,v,Mi(X,2),xe)}}function Tv(v){return pr(function(T,R){var X=-1,oe=R.length,xe=oe>1?R[oe-1]:i,Oe=oe>2?R[2]:i;for(xe=v.length>3&&typeof xe=="function"?(oe--,xe):i,Oe&&Mo(R[0],R[1],Oe)&&(xe=oe<3?i:xe,oe=1),T=Gt(T);++X<oe;){var He=R[X];He&&v(T,He,X,xe)}return T})}function WF(v,T){return function(R,X){if(R==null)return R;if(!cl(R))return v(R,X);for(var oe=R.length,xe=T?oe:-1,Oe=Gt(R);(T?xe--:++xe<oe)&&X(Oe[xe],xe,Oe)!==!1;);return R}}function GF(v){return function(T,R,X){for(var oe=-1,xe=Gt(T),Oe=X(T),He=Oe.length;He--;){var Je=Oe[v?He:++oe];if(R(xe[Je],Je,xe)===!1)break}return T}}function Poe(v,T,R){var X=T&y,oe=I1(v);function xe(){var Oe=this&&this!==Sn&&this instanceof xe?oe:v;return Oe.apply(X?R:this,arguments)}return xe}function qF(v){return function(T){T=Wr(T);var R=Za(T)?Es(T):i,X=R?R[0]:T.charAt(0),oe=R?Pf(R,1).join(""):T.slice(1);return X[v]()+oe}}function Cv(v){return function(T){return Wi(W5(H5(T).replace(zr,"")),v,"")}}function I1(v){return function(){var T=arguments;switch(T.length){case 0:return new v;case 1:return new v(T[0]);case 2:return new v(T[0],T[1]);case 3:return new v(T[0],T[1],T[2]);case 4:return new v(T[0],T[1],T[2],T[3]);case 5:return new v(T[0],T[1],T[2],T[3],T[4]);case 6:return new v(T[0],T[1],T[2],T[3],T[4],T[5]);case 7:return new v(T[0],T[1],T[2],T[3],T[4],T[5],T[6])}var R=Tf(v.prototype),X=v.apply(R,T);return kn(X)?X:R}}function Doe(v,T,R){var X=I1(v);function oe(){for(var xe=arguments.length,Oe=Fe(xe),He=xe,Je=Av(oe);He--;)Oe[He]=arguments[He];var At=xe<3&&Oe[0]!==Je&&Oe[xe-1]!==Je?[]:Co(Oe,Je);if(xe-=At.length,xe<R)return ZF(v,T,Rw,oe.placeholder,i,Oe,At,i,i,R-xe);var Mt=this&&this!==Sn&&this instanceof oe?X:v;return ce(Mt,this,Oe)}return oe}function YF(v){return function(T,R,X){var oe=Gt(T);if(!cl(T)){var xe=Mi(R,3);T=ca(T),R=function(He){return xe(oe[He],He,oe)}}var Oe=v(T,R,X);return Oe>-1?oe[xe?T[Oe]:Oe]:i}}function XF(v){return ud(function(T){var R=T.length,X=R,oe=Qa.prototype.thru;for(v&&T.reverse();X--;){var xe=T[X];if(typeof xe!="function")throw new Zi(a);if(oe&&!Oe&&Bw(xe)=="wrapper")var Oe=new Qa([],!0)}for(X=Oe?X:R;++X<R;){xe=T[X];var He=Bw(xe),Je=He=="wrapper"?X2(xe):i;Je&&Q2(Je[0])&&Je[1]==(_|b|A|P)&&!Je[4].length&&Je[9]==1?Oe=Oe[Bw(Je[0])].apply(Oe,Je[3]):Oe=xe.length==1&&Q2(xe)?Oe[He]():Oe.thru(xe)}return function(){var At=arguments,Mt=At[0];if(Oe&&At.length==1&&tr(Mt))return Oe.plant(Mt).value();for(var Lt=0,Yt=R?T[Lt].apply(this,At):Mt;++Lt<R;)Yt=T[Lt].call(this,Yt);return Yt}})}function Rw(v,T,R,X,oe,xe,Oe,He,Je,At){var Mt=T&_,Lt=T&y,Yt=T&x,li=T&(b|C),Ii=T&I,cr=Yt?i:I1(v);function Oi(){for(var xr=arguments.length,Ar=Fe(xr),Wl=xr;Wl--;)Ar[Wl]=arguments[Wl];if(li)var Po=Av(Oi),Gl=_s(Ar,Po);if(X&&(Ar=VF(Ar,X,oe,li)),xe&&(Ar=HF(Ar,xe,Oe,li)),xr-=Gl,li&&xr<At){var ls=Co(Ar,Po);return ZF(v,T,Rw,Oi.placeholder,R,Ar,ls,He,Je,At-xr)}var Zu=Lt?R:this,fd=Yt?Zu[v]:v;return xr=Ar.length,He?Ar=$oe(Ar,He):Ii&&xr>1&&Ar.reverse(),Mt&&Je<xr&&(Ar.length=Je),this&&this!==Sn&&this instanceof Oi&&(fd=cr||I1(fd)),fd.apply(Zu,Ar)}return Oi}function KF(v,T){return function(R,X){return noe(R,v,T(X),{})}}function Lw(v,T){return function(R,X){var oe;if(R===i&&X===i)return T;if(R!==i&&(oe=R),X!==i){if(oe===i)return X;typeof R=="string"||typeof X=="string"?(R=Vl(R),X=Vl(X)):(R=LF(R),X=LF(X)),oe=v(R,X)}return oe}}function W2(v){return ud(function(T){return T=Kt(T,un(Mi())),pr(function(R){var X=this;return v(T,function(oe){return ce(oe,X,R)})})})}function Nw(v,T){T=T===i?" ":Vl(T);var R=T.length;if(R<2)return R?B2(T,v):T;var X=B2(T,Am(v/ws(T)));return Za(T)?Pf(Es(X),0,v).join(""):X.slice(0,v)}function Ioe(v,T,R,X){var oe=T&y,xe=I1(v);function Oe(){for(var He=-1,Je=arguments.length,At=-1,Mt=X.length,Lt=Fe(Mt+Je),Yt=this&&this!==Sn&&this instanceof Oe?xe:v;++At<Mt;)Lt[At]=X[At];for(;Je--;)Lt[At++]=arguments[++He];return ce(Yt,oe?R:this,Lt)}return Oe}function $F(v){return function(T,R,X){return X&&typeof X!="number"&&Mo(T,R,X)&&(R=X=i),T=dd(T),R===i?(R=T,T=0):R=dd(R),X=X===i?T<R?1:-1:dd(X),goe(T,R,X,v)}}function kw(v){return function(T,R){return typeof T=="string"&&typeof R=="string"||(T=mu(T),R=mu(R)),v(T,R)}}function ZF(v,T,R,X,oe,xe,Oe,He,Je,At){var Mt=T&b,Lt=Mt?Oe:i,Yt=Mt?i:Oe,li=Mt?xe:i,Ii=Mt?i:xe;T|=Mt?A:E,T&=~(Mt?E:A),T&w||(T&=-4);var cr=[v,T,oe,li,Lt,Ii,Yt,He,Je,At],Oi=R.apply(i,cr);return Q2(v)&&u5(Oi,cr),Oi.placeholder=X,c5(Oi,v,T)}function G2(v){var T=ii[v];return function(R,X){if(R=mu(R),X=X==null?0:fe(or(X),292),X&&S(R)){var oe=(Wr(R)+"e").split("e"),xe=T(oe[0]+"e"+(+oe[1]+X));return oe=(Wr(xe)+"e").split("e"),+(oe[0]+"e"+(+oe[1]-X))}return T(R)}}var Ooe=Gn&&1/zs(new Gn([,-0]))[1]==G?function(v){return new Gn(v)}:fP;function QF(v){return function(T){var R=Ja(T);return R==Ze?_f(T):R==Ge?_m(T):al(T,v(T))}}function ld(v,T,R,X,oe,xe,Oe,He){var Je=T&x;if(!Je&&typeof v!="function")throw new Zi(a);var At=X?X.length:0;if(At||(T&=-97,X=oe=i),Oe=Oe===i?Oe:Q(or(Oe),0),He=He===i?He:or(He),At-=oe?oe.length:0,T&E){var Mt=X,Lt=oe;X=oe=i}var Yt=Je?i:X2(v),li=[v,T,R,X,oe,Mt,Lt,xe,Oe,He];if(Yt&&Yoe(li,Yt),v=li[0],T=li[1],R=li[2],X=li[3],oe=li[4],He=li[9]=li[9]===i?Je?0:v.length:Q(li[9]-At,0),!He&&T&(b|C)&&(T&=-25),!T||T==y)var Ii=Poe(v,T,R);else T==b||T==C?Ii=Doe(v,T,He):(T==A||T==(y|A))&&!oe.length?Ii=Ioe(v,T,R,X):Ii=Rw.apply(i,li);var cr=Yt?OF:u5;return c5(cr(Ii,li),v,T)}function JF(v,T,R,X){return v===i||$u(v,as[R])&&!Ai.call(X,R)?T:v}function e5(v,T,R,X,oe,xe){return kn(v)&&kn(T)&&(xe.set(T,v),Pw(v,T,i,e5,xe),xe.delete(T)),v}function Roe(v){return L1(v)?i:v}function t5(v,T,R,X,oe,xe){var Oe=R&m,He=v.length,Je=T.length;if(He!=Je&&!(Oe&&Je>He))return!1;var At=xe.get(v),Mt=xe.get(T);if(At&&Mt)return At==T&&Mt==v;var Lt=-1,Yt=!0,li=R&g?new Om:i;for(xe.set(v,T),xe.set(T,v);++Lt<He;){var Ii=v[Lt],cr=T[Lt];if(X)var Oi=Oe?X(cr,Ii,Lt,T,v,xe):X(Ii,cr,Lt,v,T,xe);if(Oi!==i){if(Oi)continue;Yt=!1;break}if(li){if(!ln(T,function(xr,Ar){if(!Zh(li,Ar)&&(Ii===xr||oe(Ii,xr,R,X,xe)))return li.push(Ar)})){Yt=!1;break}}else if(!(Ii===cr||oe(Ii,cr,R,X,xe))){Yt=!1;break}}return xe.delete(v),xe.delete(T),Yt}function Loe(v,T,R,X,oe,xe,Oe){switch(R){case Ke:if(v.byteLength!=T.byteLength||v.byteOffset!=T.byteOffset)return!1;v=v.buffer,T=T.buffer;case Me:return!(v.byteLength!=T.byteLength||!xe(new Fc(v),new Fc(T)));case we:case Le:case st:return $u(+v,+T);case ke:return v.name==T.name&&v.message==T.message;case Ae:case ae:return v==T+"";case Ze:var He=_f;case Ge:var Je=X&m;if(He||(He=zs),v.size!=T.size&&!Je)return!1;var At=Oe.get(v);if(At)return At==T;X|=g,Oe.set(v,T);var Mt=t5(He(v),He(T),X,oe,xe,Oe);return Oe.delete(v),Mt;case te:if(mn)return mn.call(v)==mn.call(T)}return!1}function Noe(v,T,R,X,oe,xe){var Oe=R&m,He=q2(v),Je=He.length,At=q2(T),Mt=At.length;if(Je!=Mt&&!Oe)return!1;for(var Lt=Je;Lt--;){var Yt=He[Lt];if(!(Oe?Yt in T:Ai.call(T,Yt)))return!1}var li=xe.get(v),Ii=xe.get(T);if(li&&Ii)return li==T&&Ii==v;var cr=!0;xe.set(v,T),xe.set(T,v);for(var Oi=Oe;++Lt<Je;){Yt=He[Lt];var xr=v[Yt],Ar=T[Yt];if(X)var Wl=Oe?X(Ar,xr,Yt,T,v,xe):X(xr,Ar,Yt,v,T,xe);if(!(Wl===i?xr===Ar||oe(xr,Ar,R,X,xe):Wl)){cr=!1;break}Oi||(Oi=Yt=="constructor")}if(cr&&!Oi){var Po=v.constructor,Gl=T.constructor;Po!=Gl&&"constructor"in v&&"constructor"in T&&!(typeof Po=="function"&&Po instanceof Po&&typeof Gl=="function"&&Gl instanceof Gl)&&(cr=!1)}return xe.delete(v),xe.delete(T),cr}function ud(v){return eP(o5(v,i,g5),v+"")}function q2(v){return _F(v,ca,$2)}function Y2(v){return _F(v,hl,i5)}var X2=Fs?function(v){return Fs.get(v)}:fP;function Bw(v){for(var T=v.name+"",R=jl[T],X=Ai.call(jl,T)?R.length:0;X--;){var oe=R[X],xe=oe.func;if(xe==null||xe==v)return oe.name}return T}function Av(v){var T=Ai.call(ge,"placeholder")?ge:v;return T.placeholder}function Mi(){var v=ge.iteratee||hP;return v=v===hP?SF:v,arguments.length?v(arguments[0],arguments[1]):v}function zw(v,T){var R=v.__data__;return Hoe(T)?R[typeof T=="string"?"string":"hash"]:R.map}function K2(v){for(var T=ca(v),R=T.length;R--;){var X=T[R],oe=v[X];T[R]=[X,oe,s5(oe)]}return T}function Nm(v,T){var R=ed(v,T);return EF(R)?R:i}function koe(v){var T=Ai.call(v,Uc),R=v[Uc];try{v[Uc]=i;var X=!0}catch{}var oe=Em.call(v);return X&&(T?v[Uc]=R:delete v[Uc]),oe}var $2=T1?function(v){return v==null?[]:(v=Gt(v),bt(T1(v),function(T){return S1.call(v,T)}))}:pP,i5=T1?function(v){for(var T=[];v;)Hi(T,$2(v)),v=nd(v);return T}:pP,Ja=Ao;($t&&Ja(new $t(new ArrayBuffer(1)))!=Ke||fi&&Ja(new fi)!=Ze||rr&&Ja(rr.resolve())!=ue||Gn&&Ja(new Gn)!=Ge||Dn&&Ja(new Dn)!=Re)&&(Ja=function(v){var T=Ao(v),R=T==St?v.constructor:i,X=R?km(R):"";if(X)switch(X){case _2:return Ke;case w2:return Ze;case E2:return ue;case Tw:return Ge;case S2:return Re}return T});function Boe(v,T,R){for(var X=-1,oe=R.length;++X<oe;){var xe=R[X],Oe=xe.size;switch(xe.type){case"drop":v+=Oe;break;case"dropRight":T-=Oe;break;case"take":T=fe(T,v+Oe);break;case"takeRight":v=Q(v,T-Oe);break}}return{start:v,end:T}}function zoe(v){var T=v.match(lt);return T?T[1].split(pt):[]}function r5(v,T,R){T=Mf(T,v);for(var X=-1,oe=T.length,xe=!1;++X<oe;){var Oe=Hc(T[X]);if(!(xe=v!=null&&R(v,Oe)))break;v=v[Oe]}return xe||++X!=oe?xe:(oe=v==null?0:v.length,!!oe&&Gw(oe)&&cd(Oe,oe)&&(tr(v)||Bm(v)))}function Foe(v){var T=v.length,R=new v.constructor(T);return T&&typeof v[0]=="string"&&Ai.call(v,"index")&&(R.index=v.index,R.input=v.input),R}function n5(v){return typeof v.constructor=="function"&&!O1(v)?Tf(nd(v)):{}}function Uoe(v,T,R){var X=v.constructor;switch(T){case Me:return H2(v);case we:case Le:return new X(+v);case Ke:return Eoe(v,R);case ot:case qe:case It:case Ot:case Dt:case kt:case Qe:case mt:case Ht:return UF(v,R);case Ze:return new X;case st:case ae:return new X(v);case Ae:return Soe(v);case Ge:return new X;case te:return Toe(v)}}function joe(v,T){var R=T.length;if(!R)return v;var X=R-1;return T[X]=(R>1?"& ":"")+T[X],T=T.join(R>2?", ":" "),v.replace(me,`{
/* [wrapped with `+T+`] */
`)}function Voe(v){return tr(v)||Bm(v)||!!(ww&&v&&v[ww])}function cd(v,T){var R=typeof v;return T=T??V,!!T&&(R=="number"||R!="symbol"&&bi.test(v))&&v>-1&&v%1==0&&v<T}function Mo(v,T,R){if(!kn(R))return!1;var X=typeof T;return(X=="number"?cl(R)&&cd(T,R.length):X=="string"&&T in R)?$u(R[T],v):!1}function Z2(v,T){if(tr(v))return!1;var R=typeof v;return R=="number"||R=="symbol"||R=="boolean"||v==null||Hl(v)?!0:Rn.test(v)||!yr.test(v)||T!=null&&v in Gt(T)}function Hoe(v){var T=typeof v;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?v!=="__proto__":v===null}function Q2(v){var T=Bw(v),R=ge[T];if(typeof R!="function"||!(T in fr.prototype))return!1;if(v===R)return!0;var X=X2(R);return!!X&&v===X[0]}function Woe(v){return!!rd&&rd in v}var Goe=la?hd:mP;function O1(v){var T=v&&v.constructor,R=typeof T=="function"&&T.prototype||as;return v===R}function s5(v){return v===v&&!kn(v)}function a5(v,T){return function(R){return R==null?!1:R[v]===T&&(T!==i||v in Gt(R))}}function qoe(v){var T=Hw(v,function(X){return R.size===u&&R.clear(),X}),R=T.cache;return T}function Yoe(v,T){var R=v[1],X=T[1],oe=R|X,xe=oe<(y|x|_),Oe=X==_&&R==b||X==_&&R==P&&v[7].length<=T[8]||X==(_|P)&&T[7].length<=T[8]&&R==b;if(!(xe||Oe))return v;X&y&&(v[2]=T[2],oe|=R&y?0:w);var He=T[3];if(He){var Je=v[3];v[3]=Je?VF(Je,He,T[4]):He,v[4]=Je?Co(v[3],c):T[4]}return He=T[5],He&&(Je=v[5],v[5]=Je?HF(Je,He,T[6]):He,v[6]=Je?Co(v[5],c):T[6]),He=T[7],He&&(v[7]=He),X&_&&(v[8]=v[8]==null?T[8]:fe(v[8],T[8])),v[9]==null&&(v[9]=T[9]),v[0]=T[0],v[1]=oe,v}function Xoe(v){var T=[];if(v!=null)for(var R in Gt(v))T.push(R);return T}function Koe(v){return Em.call(v)}function o5(v,T,R){return T=Q(T===i?v.length-1:T,0),function(){for(var X=arguments,oe=-1,xe=Q(X.length-T,0),Oe=Fe(xe);++oe<xe;)Oe[oe]=X[T+oe];oe=-1;for(var He=Fe(T+1);++oe<T;)He[oe]=X[oe];return He[T]=R(Oe),ce(v,this,He)}}function l5(v,T){return T.length<2?v:Lm(v,fu(T,0,-1))}function $oe(v,T){for(var R=v.length,X=fe(T.length,R),oe=ul(v);X--;){var xe=T[X];v[X]=cd(xe,R)?oe[xe]:i}return v}function J2(v,T){if(!(T==="constructor"&&typeof v[T]=="function")&&T!="__proto__")return v[T]}var u5=h5(OF),R1=b2||function(v,T){return Sn.setTimeout(v,T)},eP=h5(xoe);function c5(v,T,R){var X=T+"";return eP(v,joe(X,Zoe(zoe(X),R)))}function h5(v){var T=0,R=0;return function(){var X=ze(),oe=z-(X-R);if(R=X,oe>0){if(++T>=B)return arguments[0]}else T=0;return v.apply(i,arguments)}}function Fw(v,T){var R=-1,X=v.length,oe=X-1;for(T=T===i?X:T;++R<T;){var xe=k2(R,oe),Oe=v[xe];v[xe]=v[R],v[R]=Oe}return v.length=T,v}var d5=qoe(function(v){var T=[];return v.charCodeAt(0)===46&&T.push(""),v.replace(Yr,function(R,X,oe,xe){T.push(oe?xe.replace(Qt,"$1"):X||R)}),T});function Hc(v){if(typeof v=="string"||Hl(v))return v;var T=v+"";return T=="0"&&1/v==-1/0?"-0":T}function km(v){if(v!=null){try{return Ul.call(v)}catch{}try{return v+""}catch{}}return""}function Zoe(v,T){return Pe(ve,function(R){var X="_."+R[0];T&R[1]&&!at(v,X)&&v.push(X)}),v.sort()}function f5(v){if(v instanceof fr)return v.clone();var T=new Qa(v.__wrapped__,v.__chain__);return T.__actions__=ul(v.__actions__),T.__index__=v.__index__,T.__values__=v.__values__,T}function Qoe(v,T,R){(R?Mo(v,T,R):T===i)?T=1:T=Q(or(T),0);var X=v==null?0:v.length;if(!X||T<1)return[];for(var oe=0,xe=0,Oe=Fe(Am(X/T));oe<X;)Oe[xe++]=fu(v,oe,oe+=T);return Oe}function Joe(v){for(var T=-1,R=v==null?0:v.length,X=0,oe=[];++T<R;){var xe=v[T];xe&&(oe[X++]=xe)}return oe}function ele(){var v=arguments.length;if(!v)return[];for(var T=Fe(v-1),R=arguments[0],X=v;X--;)T[X-1]=arguments[X];return Hi(tr(R)?ul(R):[R],Da(T,1))}var tle=pr(function(v,T){return os(v)?A1(v,Da(T,1,os,!0)):[]}),ile=pr(function(v,T){var R=pu(T);return os(R)&&(R=i),os(v)?A1(v,Da(T,1,os,!0),Mi(R,2)):[]}),rle=pr(function(v,T){var R=pu(T);return os(R)&&(R=i),os(v)?A1(v,Da(T,1,os,!0),i,R):[]});function nle(v,T,R){var X=v==null?0:v.length;return X?(T=R||T===i?1:or(T),fu(v,T<0?0:T,X)):[]}function sle(v,T,R){var X=v==null?0:v.length;return X?(T=R||T===i?1:or(T),T=X-T,fu(v,0,T<0?0:T)):[]}function ale(v,T){return v&&v.length?Iw(v,Mi(T,3),!0,!0):[]}function ole(v,T){return v&&v.length?Iw(v,Mi(T,3),!0):[]}function lle(v,T,R,X){var oe=v==null?0:v.length;return oe?(R&&typeof R!="number"&&Mo(v,T,R)&&(R=0,X=oe),eoe(v,T,R,X)):[]}function p5(v,T,R){var X=v==null?0:v.length;if(!X)return-1;var oe=R==null?0:or(R);return oe<0&&(oe=Q(X+oe,0)),Gi(v,Mi(T,3),oe)}function m5(v,T,R){var X=v==null?0:v.length;if(!X)return-1;var oe=X-1;return R!==i&&(oe=or(R),oe=R<0?Q(X+oe,0):fe(oe,X-1)),Gi(v,Mi(T,3),oe,!0)}function g5(v){var T=v==null?0:v.length;return T?Da(v,1):[]}function ule(v){var T=v==null?0:v.length;return T?Da(v,G):[]}function cle(v,T){var R=v==null?0:v.length;return R?(T=T===i?1:or(T),Da(v,T)):[]}function hle(v){for(var T=-1,R=v==null?0:v.length,X={};++T<R;){var oe=v[T];X[oe[0]]=oe[1]}return X}function v5(v){return v&&v.length?v[0]:i}function dle(v,T,R){var X=v==null?0:v.length;if(!X)return-1;var oe=R==null?0:or(R);return oe<0&&(oe=Q(X+oe,0)),jr(v,T,oe)}function fle(v){var T=v==null?0:v.length;return T?fu(v,0,-1):[]}var ple=pr(function(v){var T=Kt(v,j2);return T.length&&T[0]===v[0]?I2(T):[]}),mle=pr(function(v){var T=pu(v),R=Kt(v,j2);return T===pu(R)?T=i:R.pop(),R.length&&R[0]===v[0]?I2(R,Mi(T,2)):[]}),gle=pr(function(v){var T=pu(v),R=Kt(v,j2);return T=typeof T=="function"?T:i,T&&R.pop(),R.length&&R[0]===v[0]?I2(R,i,T):[]});function vle(v,T){return v==null?"":O.call(v,T)}function pu(v){var T=v==null?0:v.length;return T?v[T-1]:i}function yle(v,T,R){var X=v==null?0:v.length;if(!X)return-1;var oe=X;return R!==i&&(oe=or(R),oe=oe<0?Q(X+oe,0):fe(oe,X-1)),T===T?wf(v,T,oe):Gi(v,Bs,oe,!0)}function xle(v,T){return v&&v.length?MF(v,or(T)):i}var ble=pr(y5);function y5(v,T){return v&&v.length&&T&&T.length?N2(v,T):v}function _le(v,T,R){return v&&v.length&&T&&T.length?N2(v,T,Mi(R,2)):v}function wle(v,T,R){return v&&v.length&&T&&T.length?N2(v,T,i,R):v}var Ele=ud(function(v,T){var R=v==null?0:v.length,X=A2(v,T);return IF(v,Kt(T,function(oe){return cd(oe,R)?+oe:oe}).sort(jF)),X});function Sle(v,T){var R=[];if(!(v&&v.length))return R;var X=-1,oe=[],xe=v.length;for(T=Mi(T,3);++X<xe;){var Oe=v[X];T(Oe,X,v)&&(R.push(Oe),oe.push(X))}return IF(v,oe),R}function tP(v){return v==null?v:Rt.call(v)}function Tle(v,T,R){var X=v==null?0:v.length;return X?(R&&typeof R!="number"&&Mo(v,T,R)?(T=0,R=X):(T=T==null?0:or(T),R=R===i?X:or(R)),fu(v,T,R)):[]}function Cle(v,T){return Dw(v,T)}function Ale(v,T,R){return z2(v,T,Mi(R,2))}function Mle(v,T){var R=v==null?0:v.length;if(R){var X=Dw(v,T);if(X<R&&$u(v[X],T))return X}return-1}function Ple(v,T){return Dw(v,T,!0)}function Dle(v,T,R){return z2(v,T,Mi(R,2),!0)}function Ile(v,T){var R=v==null?0:v.length;if(R){var X=Dw(v,T,!0)-1;if($u(v[X],T))return X}return-1}function Ole(v){return v&&v.length?RF(v):[]}function Rle(v,T){return v&&v.length?RF(v,Mi(T,2)):[]}function Lle(v){var T=v==null?0:v.length;return T?fu(v,1,T):[]}function Nle(v,T,R){return v&&v.length?(T=R||T===i?1:or(T),fu(v,0,T<0?0:T)):[]}function kle(v,T,R){var X=v==null?0:v.length;return X?(T=R||T===i?1:or(T),T=X-T,fu(v,T<0?0:T,X)):[]}function Ble(v,T){return v&&v.length?Iw(v,Mi(T,3),!1,!0):[]}function zle(v,T){return v&&v.length?Iw(v,Mi(T,3)):[]}var Fle=pr(function(v){return Af(Da(v,1,os,!0))}),Ule=pr(function(v){var T=pu(v);return os(T)&&(T=i),Af(Da(v,1,os,!0),Mi(T,2))}),jle=pr(function(v){var T=pu(v);return T=typeof T=="function"?T:i,Af(Da(v,1,os,!0),i,T)});function Vle(v){return v&&v.length?Af(v):[]}function Hle(v,T){return v&&v.length?Af(v,Mi(T,2)):[]}function Wle(v,T){return T=typeof T=="function"?T:i,v&&v.length?Af(v,i,T):[]}function iP(v){if(!(v&&v.length))return[];var T=0;return v=bt(v,function(R){if(os(R))return T=Q(R.length,T),!0}),$h(T,function(R){return Kt(v,uu(R))})}function x5(v,T){if(!(v&&v.length))return[];var R=iP(v);return T==null?R:Kt(R,function(X){return ce(T,i,X)})}var Gle=pr(function(v,T){return os(v)?A1(v,T):[]}),qle=pr(function(v){return U2(bt(v,os))}),Yle=pr(function(v){var T=pu(v);return os(T)&&(T=i),U2(bt(v,os),Mi(T,2))}),Xle=pr(function(v){var T=pu(v);return T=typeof T=="function"?T:i,U2(bt(v,os),i,T)}),Kle=pr(iP);function $le(v,T){return BF(v||[],T||[],C1)}function Zle(v,T){return BF(v||[],T||[],D1)}var Qle=pr(function(v){var T=v.length,R=T>1?v[T-1]:i;return R=typeof R=="function"?(v.pop(),R):i,x5(v,R)});function b5(v){var T=ge(v);return T.__chain__=!0,T}function Jle(v,T){return T(v),v}function Uw(v,T){return T(v)}var eue=ud(function(v){var T=v.length,R=T?v[0]:0,X=this.__wrapped__,oe=function(xe){return A2(xe,v)};return T>1||this.__actions__.length||!(X instanceof fr)||!cd(R)?this.thru(oe):(X=X.slice(R,+R+(T?1:0)),X.__actions__.push({func:Uw,args:[oe],thisArg:i}),new Qa(X,this.__chain__).thru(function(xe){return T&&!xe.length&&xe.push(i),xe}))});function tue(){return b5(this)}function iue(){return new Qa(this.value(),this.__chain__)}function rue(){this.__values__===i&&(this.__values__=L5(this.value()));var v=this.__index__>=this.__values__.length,T=v?i:this.__values__[this.__index__++];return{done:v,value:T}}function nue(){return this}function sue(v){for(var T,R=this;R instanceof Sv;){var X=f5(R);X.__index__=0,X.__values__=i,T?oe.__wrapped__=X:T=X;var oe=X;R=R.__wrapped__}return oe.__wrapped__=v,T}function aue(){var v=this.__wrapped__;if(v instanceof fr){var T=v;return this.__actions__.length&&(T=new fr(this)),T=T.reverse(),T.__actions__.push({func:Uw,args:[tP],thisArg:i}),new Qa(T,this.__chain__)}return this.thru(tP)}function oue(){return kF(this.__wrapped__,this.__actions__)}var lue=Ow(function(v,T,R){Ai.call(v,R)?++v[R]:od(v,R,1)});function uue(v,T,R){var X=tr(v)?ft:Jae;return R&&Mo(v,T,R)&&(T=i),X(v,Mi(T,3))}function cue(v,T){var R=tr(v)?bt:xF;return R(v,Mi(T,3))}var hue=YF(p5),due=YF(m5);function fue(v,T){return Da(jw(v,T),1)}function pue(v,T){return Da(jw(v,T),G)}function mue(v,T,R){return R=R===i?1:or(R),Da(jw(v,T),R)}function _5(v,T){var R=tr(v)?Pe:Cf;return R(v,Mi(T,3))}function w5(v,T){var R=tr(v)?Ye:yF;return R(v,Mi(T,3))}var gue=Ow(function(v,T,R){Ai.call(v,R)?v[R].push(T):od(v,R,[T])});function vue(v,T,R,X){v=cl(v)?v:Pv(v),R=R&&!X?or(R):0;var oe=v.length;return R<0&&(R=Q(oe+R,0)),qw(v)?R<=oe&&v.indexOf(T,R)>-1:!!oe&&jr(v,T,R)>-1}var yue=pr(function(v,T,R){var X=-1,oe=typeof T=="function",xe=cl(v)?Fe(v.length):[];return Cf(v,function(Oe){xe[++X]=oe?ce(T,Oe,R):M1(Oe,T,R)}),xe}),xue=Ow(function(v,T,R){od(v,R,T)});function jw(v,T){var R=tr(v)?Kt:TF;return R(v,Mi(T,3))}function bue(v,T,R,X){return v==null?[]:(tr(T)||(T=T==null?[]:[T]),R=X?i:R,tr(R)||(R=R==null?[]:[R]),PF(v,T,R))}var _ue=Ow(function(v,T,R){v[R?0:1].push(T)},function(){return[[],[]]});function wue(v,T,R){var X=tr(v)?Wi:So,oe=arguments.length<3;return X(v,Mi(T,4),R,oe,Cf)}function Eue(v,T,R){var X=tr(v)?ns:So,oe=arguments.length<3;return X(v,Mi(T,4),R,oe,yF)}function Sue(v,T){var R=tr(v)?bt:xF;return R(v,Ww(Mi(T,3)))}function Tue(v){var T=tr(v)?pF:voe;return T(v)}function Cue(v,T,R){(R?Mo(v,T,R):T===i)?T=1:T=or(T);var X=tr(v)?Xae:yoe;return X(v,T)}function Aue(v){var T=tr(v)?Kae:boe;return T(v)}function Mue(v){if(v==null)return 0;if(cl(v))return qw(v)?ws(v):v.length;var T=Ja(v);return T==Ze||T==Ge?v.size:R2(v).length}function Pue(v,T,R){var X=tr(v)?ln:_oe;return R&&Mo(v,T,R)&&(T=i),X(v,Mi(T,3))}var Due=pr(function(v,T){if(v==null)return[];var R=T.length;return R>1&&Mo(v,T[0],T[1])?T=[]:R>2&&Mo(T[0],T[1],T[2])&&(T=[T[0]]),PF(v,Da(T,1),[])}),Vw=Sw||function(){return Sn.Date.now()};function Iue(v,T){if(typeof T!="function")throw new Zi(a);return v=or(v),function(){if(--v<1)return T.apply(this,arguments)}}function E5(v,T,R){return T=R?i:T,T=v&&T==null?v.length:T,ld(v,_,i,i,i,i,T)}function S5(v,T){var R;if(typeof T!="function")throw new Zi(a);return v=or(v),function(){return--v>0&&(R=T.apply(this,arguments)),v<=1&&(T=i),R}}var rP=pr(function(v,T,R){var X=y;if(R.length){var oe=Co(R,Av(rP));X|=A}return ld(v,X,T,R,oe)}),T5=pr(function(v,T,R){var X=y|x;if(R.length){var oe=Co(R,Av(T5));X|=A}return ld(T,X,v,R,oe)});function C5(v,T,R){T=R?i:T;var X=ld(v,b,i,i,i,i,i,T);return X.placeholder=C5.placeholder,X}function A5(v,T,R){T=R?i:T;var X=ld(v,C,i,i,i,i,i,T);return X.placeholder=A5.placeholder,X}function M5(v,T,R){var X,oe,xe,Oe,He,Je,At=0,Mt=!1,Lt=!1,Yt=!0;if(typeof v!="function")throw new Zi(a);T=mu(T)||0,kn(R)&&(Mt=!!R.leading,Lt="maxWait"in R,xe=Lt?Q(mu(R.maxWait)||0,T):xe,Yt="trailing"in R?!!R.trailing:Yt);function li(ls){var Zu=X,fd=oe;return X=oe=i,At=ls,Oe=v.apply(fd,Zu),Oe}function Ii(ls){return At=ls,He=R1(xr,T),Mt?li(ls):Oe}function cr(ls){var Zu=ls-Je,fd=ls-At,Y5=T-Zu;return Lt?fe(Y5,xe-fd):Y5}function Oi(ls){var Zu=ls-Je,fd=ls-At;return Je===i||Zu>=T||Zu<0||Lt&&fd>=xe}function xr(){var ls=Vw();if(Oi(ls))return Ar(ls);He=R1(xr,cr(ls))}function Ar(ls){return He=i,Yt&&X?li(ls):(X=oe=i,Oe)}function Wl(){He!==i&&zF(He),At=0,X=Je=oe=He=i}function Po(){return He===i?Oe:Ar(Vw())}function Gl(){var ls=Vw(),Zu=Oi(ls);if(X=arguments,oe=this,Je=ls,Zu){if(He===i)return Ii(Je);if(Lt)return zF(He),He=R1(xr,T),li(Je)}return He===i&&(He=R1(xr,T)),Oe}return Gl.cancel=Wl,Gl.flush=Po,Gl}var Oue=pr(function(v,T){return vF(v,1,T)}),Rue=pr(function(v,T,R){return vF(v,mu(T)||0,R)});function Lue(v){return ld(v,I)}function Hw(v,T){if(typeof v!="function"||T!=null&&typeof T!="function")throw new Zi(a);var R=function(){var X=arguments,oe=T?T.apply(this,X):X[0],xe=R.cache;if(xe.has(oe))return xe.get(oe);var Oe=v.apply(this,X);return R.cache=xe.set(oe,Oe)||xe,Oe};return R.cache=new(Hw.Cache||ad),R}Hw.Cache=ad;function Ww(v){if(typeof v!="function")throw new Zi(a);return function(){var T=arguments;switch(T.length){case 0:return!v.call(this);case 1:return!v.call(this,T[0]);case 2:return!v.call(this,T[0],T[1]);case 3:return!v.call(this,T[0],T[1],T[2])}return!v.apply(this,T)}}function Nue(v){return S5(2,v)}var kue=woe(function(v,T){T=T.length==1&&tr(T[0])?Kt(T[0],un(Mi())):Kt(Da(T,1),un(Mi()));var R=T.length;return pr(function(X){for(var oe=-1,xe=fe(X.length,R);++oe<xe;)X[oe]=T[oe].call(this,X[oe]);return ce(v,this,X)})}),nP=pr(function(v,T){var R=Co(T,Av(nP));return ld(v,A,i,T,R)}),P5=pr(function(v,T){var R=Co(T,Av(P5));return ld(v,E,i,T,R)}),Bue=ud(function(v,T){return ld(v,P,i,i,i,T)});function zue(v,T){if(typeof v!="function")throw new Zi(a);return T=T===i?T:or(T),pr(v,T)}function Fue(v,T){if(typeof v!="function")throw new Zi(a);return T=T==null?0:Q(or(T),0),pr(function(R){var X=R[T],oe=Pf(R,0,T);return X&&Hi(oe,X),ce(v,this,oe)})}function Uue(v,T,R){var X=!0,oe=!0;if(typeof v!="function")throw new Zi(a);return kn(R)&&(X="leading"in R?!!R.leading:X,oe="trailing"in R?!!R.trailing:oe),M5(v,T,{leading:X,maxWait:T,trailing:oe})}function jue(v){return E5(v,1)}function Vue(v,T){return nP(V2(T),v)}function Hue(){if(!arguments.length)return[];var v=arguments[0];return tr(v)?v:[v]}function Wue(v){return du(v,f)}function Gue(v,T){return T=typeof T=="function"?T:i,du(v,f,T)}function que(v){return du(v,h|f)}function Yue(v,T){return T=typeof T=="function"?T:i,du(v,h|f,T)}function Xue(v,T){return T==null||gF(v,T,ca(T))}function $u(v,T){return v===T||v!==v&&T!==T}var Kue=kw(D2),$ue=kw(function(v,T){return v>=T}),Bm=wF(function(){return arguments}())?wF:function(v){return qn(v)&&Ai.call(v,"callee")&&!S1.call(v,"callee")},tr=Fe.isArray,Zue=M?un(M):soe;function cl(v){return v!=null&&Gw(v.length)&&!hd(v)}function os(v){return qn(v)&&cl(v)}function Que(v){return v===!0||v===!1||qn(v)&&Ao(v)==we}var Df=p||mP,Jue=N?un(N):aoe;function ece(v){return qn(v)&&v.nodeType===1&&!L1(v)}function tce(v){if(v==null)return!0;if(cl(v)&&(tr(v)||typeof v=="string"||typeof v.splice=="function"||Df(v)||Mv(v)||Bm(v)))return!v.length;var T=Ja(v);if(T==Ze||T==Ge)return!v.size;if(O1(v))return!R2(v).length;for(var R in v)if(Ai.call(v,R))return!1;return!0}function ice(v,T){return P1(v,T)}function rce(v,T,R){R=typeof R=="function"?R:i;var X=R?R(v,T):i;return X===i?P1(v,T,i,R):!!X}function sP(v){if(!qn(v))return!1;var T=Ao(v);return T==ke||T==Te||typeof v.message=="string"&&typeof v.name=="string"&&!L1(v)}function nce(v){return typeof v=="number"&&S(v)}function hd(v){if(!kn(v))return!1;var T=Ao(v);return T==Xe||T==et||T==De||T==Ee}function D5(v){return typeof v=="number"&&v==or(v)}function Gw(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=V}function kn(v){var T=typeof v;return v!=null&&(T=="object"||T=="function")}function qn(v){return v!=null&&typeof v=="object"}var I5=H?un(H):loe;function sce(v,T){return v===T||O2(v,T,K2(T))}function ace(v,T,R){return R=typeof R=="function"?R:i,O2(v,T,K2(T),R)}function oce(v){return O5(v)&&v!=+v}function lce(v){if(Goe(v))throw new Tt(s);return EF(v)}function uce(v){return v===null}function cce(v){return v==null}function O5(v){return typeof v=="number"||qn(v)&&Ao(v)==st}function L1(v){if(!qn(v)||Ao(v)!=St)return!1;var T=nd(v);if(T===null)return!0;var R=Ai.call(T,"constructor")&&T.constructor;return typeof R=="function"&&R instanceof R&&Ul.call(R)==bw}var aP=K?un(K):uoe;function hce(v){return D5(v)&&v>=-9007199254740991&&v<=V}var R5=re?un(re):coe;function qw(v){return typeof v=="string"||!tr(v)&&qn(v)&&Ao(v)==ae}function Hl(v){return typeof v=="symbol"||qn(v)&&Ao(v)==te}var Mv=ne?un(ne):hoe;function dce(v){return v===i}function fce(v){return qn(v)&&Ja(v)==Re}function pce(v){return qn(v)&&Ao(v)==Y}var mce=kw(L2),gce=kw(function(v,T){return v<=T});function L5(v){if(!v)return[];if(cl(v))return qw(v)?Es(v):ul(v);if(Sf&&v[Sf])return To(v[Sf]());var T=Ja(v),R=T==Ze?_f:T==Ge?zs:Pv;return R(v)}function dd(v){if(!v)return v===0?v:0;if(v=mu(v),v===G||v===-1/0){var T=v<0?-1:1;return T*J}return v===v?v:0}function or(v){var T=dd(v),R=T%1;return T===T?R?T-R:T:0}function N5(v){return v?Rm(or(v),0,ie):0}function mu(v){if(typeof v=="number")return v;if(Hl(v))return U;if(kn(v)){var T=typeof v.valueOf=="function"?v.valueOf():v;v=kn(T)?T+"":T}if(typeof v!="string")return v===0?v:+v;v=ol(v);var R=dr.test(v);return R||Ni.test(v)?E1(v.slice(2),R?2:8):ri.test(v)?U:+v}function k5(v){return Vc(v,hl(v))}function vce(v){return v?Rm(or(v),-9007199254740991,V):v===0?v:0}function Wr(v){return v==null?"":Vl(v)}var yce=Tv(function(v,T){if(O1(T)||cl(T)){Vc(T,ca(T),v);return}for(var R in T)Ai.call(T,R)&&C1(v,R,T[R])}),B5=Tv(function(v,T){Vc(T,hl(T),v)}),Yw=Tv(function(v,T,R,X){Vc(T,hl(T),v,X)}),xce=Tv(function(v,T,R,X){Vc(T,ca(T),v,X)}),bce=ud(A2);function _ce(v,T){var R=Tf(v);return T==null?R:mF(R,T)}var wce=pr(function(v,T){v=Gt(v);var R=-1,X=T.length,oe=X>2?T[2]:i;for(oe&&Mo(T[0],T[1],oe)&&(X=1);++R<X;)for(var xe=T[R],Oe=hl(xe),He=-1,Je=Oe.length;++He<Je;){var At=Oe[He],Mt=v[At];(Mt===i||$u(Mt,as[At])&&!Ai.call(v,At))&&(v[At]=xe[At])}return v}),Ece=pr(function(v){return v.push(i,e5),ce(z5,i,v)});function Sce(v,T){return Eo(v,Mi(T,3),jc)}function Tce(v,T){return Eo(v,Mi(T,3),P2)}function Cce(v,T){return v==null?v:M2(v,Mi(T,3),hl)}function Ace(v,T){return v==null?v:bF(v,Mi(T,3),hl)}function Mce(v,T){return v&&jc(v,Mi(T,3))}function Pce(v,T){return v&&P2(v,Mi(T,3))}function Dce(v){return v==null?[]:Mw(v,ca(v))}function Ice(v){return v==null?[]:Mw(v,hl(v))}function oP(v,T,R){var X=v==null?i:Lm(v,T);return X===i?R:X}function Oce(v,T){return v!=null&&r5(v,T,toe)}function lP(v,T){return v!=null&&r5(v,T,ioe)}var Rce=KF(function(v,T,R){T!=null&&typeof T.toString!="function"&&(T=Em.call(T)),v[T]=R},cP(dl)),Lce=KF(function(v,T,R){T!=null&&typeof T.toString!="function"&&(T=Em.call(T)),Ai.call(v,T)?v[T].push(R):v[T]=[R]},Mi),Nce=pr(M1);function ca(v){return cl(v)?fF(v):R2(v)}function hl(v){return cl(v)?fF(v,!0):doe(v)}function kce(v,T){var R={};return T=Mi(T,3),jc(v,function(X,oe,xe){od(R,T(X,oe,xe),X)}),R}function Bce(v,T){var R={};return T=Mi(T,3),jc(v,function(X,oe,xe){od(R,oe,T(X,oe,xe))}),R}var zce=Tv(function(v,T,R){Pw(v,T,R)}),z5=Tv(function(v,T,R,X){Pw(v,T,R,X)}),Fce=ud(function(v,T){var R={};if(v==null)return R;var X=!1;T=Kt(T,function(xe){return xe=Mf(xe,v),X||(X=xe.length>1),xe}),Vc(v,Y2(v),R),X&&(R=du(R,h|d|f,Roe));for(var oe=T.length;oe--;)F2(R,T[oe]);return R});function Uce(v,T){return F5(v,Ww(Mi(T)))}var jce=ud(function(v,T){return v==null?{}:poe(v,T)});function F5(v,T){if(v==null)return{};var R=Kt(Y2(v),function(X){return[X]});return T=Mi(T),DF(v,R,function(X,oe){return T(X,oe[0])})}function Vce(v,T,R){T=Mf(T,v);var X=-1,oe=T.length;for(oe||(oe=1,v=i);++X<oe;){var xe=v==null?i:v[Hc(T[X])];xe===i&&(X=oe,xe=R),v=hd(xe)?xe.call(v):xe}return v}function Hce(v,T,R){return v==null?v:D1(v,T,R)}function Wce(v,T,R,X){return X=typeof X=="function"?X:i,v==null?v:D1(v,T,R,X)}var U5=QF(ca),j5=QF(hl);function Gce(v,T,R){var X=tr(v),oe=X||Df(v)||Mv(v);if(T=Mi(T,4),R==null){var xe=v&&v.constructor;oe?R=X?new xe:[]:kn(v)?R=hd(xe)?Tf(nd(v)):{}:R={}}return(oe?Pe:jc)(v,function(Oe,He,Je){return T(R,Oe,He,Je)}),R}function qce(v,T){return v==null?!0:F2(v,T)}function Yce(v,T,R){return v==null?v:NF(v,T,V2(R))}function Xce(v,T,R,X){return X=typeof X=="function"?X:i,v==null?v:NF(v,T,V2(R),X)}function Pv(v){return v==null?[]:cu(v,ca(v))}function Kce(v){return v==null?[]:cu(v,hl(v))}function $ce(v,T,R){return R===i&&(R=T,T=i),R!==i&&(R=mu(R),R=R===R?R:0),T!==i&&(T=mu(T),T=T===T?T:0),Rm(mu(v),T,R)}function Zce(v,T,R){return T=dd(T),R===i?(R=T,T=0):R=dd(R),v=mu(v),roe(v,T,R)}function Qce(v,T,R){if(R&&typeof R!="boolean"&&Mo(v,T,R)&&(T=R=i),R===i&&(typeof T=="boolean"?(R=T,T=i):typeof v=="boolean"&&(R=v,v=i)),v===i&&T===i?(v=0,T=1):(v=dd(v),T===i?(T=v,v=0):T=dd(T)),v>T){var X=v;v=T,T=X}if(R||v%1||T%1){var oe=ct();return fe(v+oe*(T-v+Kh("1e-"+((oe+"").length-1))),T)}return k2(v,T)}var Jce=Cv(function(v,T,R){return T=T.toLowerCase(),v+(R?V5(T):T)});function V5(v){return uP(Wr(v).toLowerCase())}function H5(v){return v=Wr(v),v&&v.replace(on,Bc).replace(_v,"")}function ehe(v,T,R){v=Wr(v),T=Vl(T);var X=v.length;R=R===i?X:Rm(or(R),0,X);var oe=R;return R-=T.length,R>=0&&v.slice(R,oe)==T}function the(v){return v=Wr(v),v&&zi.test(v)?v.replace(Bt,Jh):v}function ihe(v){return v=Wr(v),v&&Jo.test(v)?v.replace(Hn,"\\$&"):v}var rhe=Cv(function(v,T,R){return v+(R?"-":"")+T.toLowerCase()}),nhe=Cv(function(v,T,R){return v+(R?" ":"")+T.toLowerCase()}),she=qF("toLowerCase");function ahe(v,T,R){v=Wr(v),T=or(T);var X=T?ws(v):0;if(!T||X>=T)return v;var oe=(T-X)/2;return Nw(Mm(oe),R)+v+Nw(Am(oe),R)}function ohe(v,T,R){v=Wr(v),T=or(T);var X=T?ws(v):0;return T&&X<T?v+Nw(T-X,R):v}function lhe(v,T,R){v=Wr(v),T=or(T);var X=T?ws(v):0;return T&&X<T?Nw(T-X,R)+v:v}function uhe(v,T,R){return R||T==null?T=0:T&&(T=+T),rt(Wr(v).replace(Bl,""),T||0)}function che(v,T,R){return(R?Mo(v,T,R):T===i)?T=1:T=or(T),B2(Wr(v),T)}function hhe(){var v=arguments,T=Wr(v[0]);return v.length<3?T:T.replace(v[1],v[2])}var dhe=Cv(function(v,T,R){return v+(R?"_":"")+T.toLowerCase()});function fhe(v,T,R){return R&&typeof R!="number"&&Mo(v,T,R)&&(T=R=i),R=R===i?ie:R>>>0,R?(v=Wr(v),v&&(typeof T=="string"||T!=null&&!aP(T))&&(T=Vl(T),!T&&Za(v))?Pf(Es(v),0,R):v.split(T,R)):[]}var phe=Cv(function(v,T,R){return v+(R?" ":"")+uP(T)});function mhe(v,T,R){return v=Wr(v),R=R==null?0:Rm(or(R),0,v.length),T=Vl(T),v.slice(R,R+T.length)==T}function ghe(v,T,R){var X=ge.templateSettings;R&&Mo(v,T,R)&&(T=i),v=Wr(v),T=Yw({},T,X,JF);var oe=Yw({},T.imports,X.imports,JF),xe=ca(oe),Oe=cu(oe,xe),He,Je,At=0,Mt=T.interpolate||is,Lt="__p += '",Yt=er((T.escape||is).source+"|"+Mt.source+"|"+(Mt===wn?hi:is).source+"|"+(T.evaluate||is).source+"|$","g"),li="//# sourceURL="+(Ai.call(T,"sourceURL")?(T.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xh+"]")+`
`;v.replace(Yt,function(Oi,xr,Ar,Wl,Po,Gl){return Ar||(Ar=Wl),Lt+=v.slice(At,Gl).replace(Wn,Ev),xr&&(He=!0,Lt+=`' +
__e(`+xr+`) +
'`),Po&&(Je=!0,Lt+=`';
`+Po+`;
__p += '`),Ar&&(Lt+=`' +
((__t = (`+Ar+`)) == null ? '' : __t) +
'`),At=Gl+Oi.length,Oi}),Lt+=`';
`;var Ii=Ai.call(T,"variable")&&T.variable;if(!Ii)Lt=`with (obj) {
`+Lt+`
}
`;else if(xt.test(Ii))throw new Tt(o);Lt=(Je?Lt.replace(Wt,""):Lt).replace(Ue,"$1").replace(dt,"$1;"),Lt="function("+(Ii||"obj")+`) {
`+(Ii?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(He?", __e = _.escape":"")+(Je?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Lt+`return __p
}`;var cr=G5(function(){return Jt(xe,li+"return "+Lt).apply(i,Oe)});if(cr.source=Lt,sP(cr))throw cr;return cr}function vhe(v){return Wr(v).toLowerCase()}function yhe(v){return Wr(v).toUpperCase()}function xhe(v,T,R){if(v=Wr(v),v&&(R||T===i))return ol(v);if(!v||!(T=Vl(T)))return v;var X=Es(v),oe=Es(T),xe=ir(X,oe),Oe=Qh(X,oe)+1;return Pf(X,xe,Oe).join("")}function bhe(v,T,R){if(v=Wr(v),v&&(R||T===i))return v.slice(0,wm(v)+1);if(!v||!(T=Vl(T)))return v;var X=Es(v),oe=Qh(X,Es(T))+1;return Pf(X,0,oe).join("")}function _he(v,T,R){if(v=Wr(v),v&&(R||T===i))return v.replace(Bl,"");if(!v||!(T=Vl(T)))return v;var X=Es(v),oe=ir(X,Es(T));return Pf(X,oe).join("")}function whe(v,T){var R=D,X=k;if(kn(T)){var oe="separator"in T?T.separator:oe;R="length"in T?or(T.length):R,X="omission"in T?Vl(T.omission):X}v=Wr(v);var xe=v.length;if(Za(v)){var Oe=Es(v);xe=Oe.length}if(R>=xe)return v;var He=R-ws(X);if(He<1)return X;var Je=Oe?Pf(Oe,0,He).join(""):v.slice(0,He);if(oe===i)return Je+X;if(Oe&&(He+=Je.length-He),aP(oe)){if(v.slice(He).search(oe)){var At,Mt=Je;for(oe.global||(oe=er(oe.source,Wr(ui.exec(oe))+"g")),oe.lastIndex=0;At=oe.exec(Mt);)var Lt=At.index;Je=Je.slice(0,Lt===i?He:Lt)}}else if(v.indexOf(Vl(oe),He)!=He){var Yt=Je.lastIndexOf(oe);Yt>-1&&(Je=Je.slice(0,Yt))}return Je+X}function Ehe(v){return v=Wr(v),v&&ei.test(v)?v.replace(gt,td):v}var She=Cv(function(v,T,R){return v+(R?" ":"")+T.toUpperCase()}),uP=qF("toUpperCase");function W5(v,T,R){return v=Wr(v),T=R?i:T,T===i?ll(v)?Ve(v):ar(v):v.match(T)||[]}var G5=pr(function(v,T){try{return ce(v,i,T)}catch(R){return sP(R)?R:new Tt(R)}}),The=ud(function(v,T){return Pe(T,function(R){R=Hc(R),od(v,R,rP(v[R],v))}),v});function Che(v){var T=v==null?0:v.length,R=Mi();return v=T?Kt(v,function(X){if(typeof X[1]!="function")throw new Zi(a);return[R(X[0]),X[1]]}):[],pr(function(X){for(var oe=-1;++oe<T;){var xe=v[oe];if(ce(xe[0],this,X))return ce(xe[1],this,X)}})}function Ahe(v){return Qae(du(v,h))}function cP(v){return function(){return v}}function Mhe(v,T){return v==null||v!==v?T:v}var Phe=XF(),Dhe=XF(!0);function dl(v){return v}function hP(v){return SF(typeof v=="function"?v:du(v,h))}function Ihe(v){return CF(du(v,h))}function Ohe(v,T){return AF(v,du(T,h))}var Rhe=pr(function(v,T){return function(R){return M1(R,v,T)}}),Lhe=pr(function(v,T){return function(R){return M1(v,R,T)}});function dP(v,T,R){var X=ca(T),oe=Mw(T,X);R==null&&!(kn(T)&&(oe.length||!X.length))&&(R=T,T=v,v=this,oe=Mw(T,ca(T)));var xe=!(kn(R)&&"chain"in R)||!!R.chain,Oe=hd(v);return Pe(oe,function(He){var Je=T[He];v[He]=Je,Oe&&(v.prototype[He]=function(){var At=this.__chain__;if(xe||At){var Mt=v(this.__wrapped__),Lt=Mt.__actions__=ul(this.__actions__);return Lt.push({func:Je,args:arguments,thisArg:v}),Mt.__chain__=At,Mt}return Je.apply(v,Hi([this.value()],arguments))})}),v}function Nhe(){return Sn._===this&&(Sn._=x2),this}function fP(){}function khe(v){return v=or(v),pr(function(T){return MF(T,v)})}var Bhe=W2(Kt),zhe=W2(ft),Fhe=W2(ln);function q5(v){return Z2(v)?uu(Hc(v)):moe(v)}function Uhe(v){return function(T){return v==null?i:Lm(v,T)}}var jhe=$F(),Vhe=$F(!0);function pP(){return[]}function mP(){return!1}function Hhe(){return{}}function Whe(){return""}function Ghe(){return!0}function qhe(v,T){if(v=or(v),v<1||v>V)return[];var R=ie,X=fe(v,ie);T=Mi(T),v-=ie;for(var oe=$h(X,T);++R<v;)T(R);return oe}function Yhe(v){return tr(v)?Kt(v,Hc):Hl(v)?[v]:ul(d5(Wr(v)))}function Xhe(v){var T=++y2;return Wr(v)+T}var Khe=Lw(function(v,T){return v+T},0),$he=G2("ceil"),Zhe=Lw(function(v,T){return v/T},1),Qhe=G2("floor");function Jhe(v){return v&&v.length?Aw(v,dl,D2):i}function ede(v,T){return v&&v.length?Aw(v,Mi(T,2),D2):i}function tde(v){return Ka(v,dl)}function ide(v,T){return Ka(v,Mi(T,2))}function rde(v){return v&&v.length?Aw(v,dl,L2):i}function nde(v,T){return v&&v.length?Aw(v,Mi(T,2),L2):i}var sde=Lw(function(v,T){return v*T},1),ade=G2("round"),ode=Lw(function(v,T){return v-T},0);function lde(v){return v&&v.length?oa(v,dl):0}function ude(v,T){return v&&v.length?oa(v,Mi(T,2)):0}return ge.after=Iue,ge.ary=E5,ge.assign=yce,ge.assignIn=B5,ge.assignInWith=Yw,ge.assignWith=xce,ge.at=bce,ge.before=S5,ge.bind=rP,ge.bindAll=The,ge.bindKey=T5,ge.castArray=Hue,ge.chain=b5,ge.chunk=Qoe,ge.compact=Joe,ge.concat=ele,ge.cond=Che,ge.conforms=Ahe,ge.constant=cP,ge.countBy=lue,ge.create=_ce,ge.curry=C5,ge.curryRight=A5,ge.debounce=M5,ge.defaults=wce,ge.defaultsDeep=Ece,ge.defer=Oue,ge.delay=Rue,ge.difference=tle,ge.differenceBy=ile,ge.differenceWith=rle,ge.drop=nle,ge.dropRight=sle,ge.dropRightWhile=ale,ge.dropWhile=ole,ge.fill=lle,ge.filter=cue,ge.flatMap=fue,ge.flatMapDeep=pue,ge.flatMapDepth=mue,ge.flatten=g5,ge.flattenDeep=ule,ge.flattenDepth=cle,ge.flip=Lue,ge.flow=Phe,ge.flowRight=Dhe,ge.fromPairs=hle,ge.functions=Dce,ge.functionsIn=Ice,ge.groupBy=gue,ge.initial=fle,ge.intersection=ple,ge.intersectionBy=mle,ge.intersectionWith=gle,ge.invert=Rce,ge.invertBy=Lce,ge.invokeMap=yue,ge.iteratee=hP,ge.keyBy=xue,ge.keys=ca,ge.keysIn=hl,ge.map=jw,ge.mapKeys=kce,ge.mapValues=Bce,ge.matches=Ihe,ge.matchesProperty=Ohe,ge.memoize=Hw,ge.merge=zce,ge.mergeWith=z5,ge.method=Rhe,ge.methodOf=Lhe,ge.mixin=dP,ge.negate=Ww,ge.nthArg=khe,ge.omit=Fce,ge.omitBy=Uce,ge.once=Nue,ge.orderBy=bue,ge.over=Bhe,ge.overArgs=kue,ge.overEvery=zhe,ge.overSome=Fhe,ge.partial=nP,ge.partialRight=P5,ge.partition=_ue,ge.pick=jce,ge.pickBy=F5,ge.property=q5,ge.propertyOf=Uhe,ge.pull=ble,ge.pullAll=y5,ge.pullAllBy=_le,ge.pullAllWith=wle,ge.pullAt=Ele,ge.range=jhe,ge.rangeRight=Vhe,ge.rearg=Bue,ge.reject=Sue,ge.remove=Sle,ge.rest=zue,ge.reverse=tP,ge.sampleSize=Cue,ge.set=Hce,ge.setWith=Wce,ge.shuffle=Aue,ge.slice=Tle,ge.sortBy=Due,ge.sortedUniq=Ole,ge.sortedUniqBy=Rle,ge.split=fhe,ge.spread=Fue,ge.tail=Lle,ge.take=Nle,ge.takeRight=kle,ge.takeRightWhile=Ble,ge.takeWhile=zle,ge.tap=Jle,ge.throttle=Uue,ge.thru=Uw,ge.toArray=L5,ge.toPairs=U5,ge.toPairsIn=j5,ge.toPath=Yhe,ge.toPlainObject=k5,ge.transform=Gce,ge.unary=jue,ge.union=Fle,ge.unionBy=Ule,ge.unionWith=jle,ge.uniq=Vle,ge.uniqBy=Hle,ge.uniqWith=Wle,ge.unset=qce,ge.unzip=iP,ge.unzipWith=x5,ge.update=Yce,ge.updateWith=Xce,ge.values=Pv,ge.valuesIn=Kce,ge.without=Gle,ge.words=W5,ge.wrap=Vue,ge.xor=qle,ge.xorBy=Yle,ge.xorWith=Xle,ge.zip=Kle,ge.zipObject=$le,ge.zipObjectDeep=Zle,ge.zipWith=Qle,ge.entries=U5,ge.entriesIn=j5,ge.extend=B5,ge.extendWith=Yw,dP(ge,ge),ge.add=Khe,ge.attempt=G5,ge.camelCase=Jce,ge.capitalize=V5,ge.ceil=$he,ge.clamp=$ce,ge.clone=Wue,ge.cloneDeep=que,ge.cloneDeepWith=Yue,ge.cloneWith=Gue,ge.conformsTo=Xue,ge.deburr=H5,ge.defaultTo=Mhe,ge.divide=Zhe,ge.endsWith=ehe,ge.eq=$u,ge.escape=the,ge.escapeRegExp=ihe,ge.every=uue,ge.find=hue,ge.findIndex=p5,ge.findKey=Sce,ge.findLast=due,ge.findLastIndex=m5,ge.findLastKey=Tce,ge.floor=Qhe,ge.forEach=_5,ge.forEachRight=w5,ge.forIn=Cce,ge.forInRight=Ace,ge.forOwn=Mce,ge.forOwnRight=Pce,ge.get=oP,ge.gt=Kue,ge.gte=$ue,ge.has=Oce,ge.hasIn=lP,ge.head=v5,ge.identity=dl,ge.includes=vue,ge.indexOf=dle,ge.inRange=Zce,ge.invoke=Nce,ge.isArguments=Bm,ge.isArray=tr,ge.isArrayBuffer=Zue,ge.isArrayLike=cl,ge.isArrayLikeObject=os,ge.isBoolean=Que,ge.isBuffer=Df,ge.isDate=Jue,ge.isElement=ece,ge.isEmpty=tce,ge.isEqual=ice,ge.isEqualWith=rce,ge.isError=sP,ge.isFinite=nce,ge.isFunction=hd,ge.isInteger=D5,ge.isLength=Gw,ge.isMap=I5,ge.isMatch=sce,ge.isMatchWith=ace,ge.isNaN=oce,ge.isNative=lce,ge.isNil=cce,ge.isNull=uce,ge.isNumber=O5,ge.isObject=kn,ge.isObjectLike=qn,ge.isPlainObject=L1,ge.isRegExp=aP,ge.isSafeInteger=hce,ge.isSet=R5,ge.isString=qw,ge.isSymbol=Hl,ge.isTypedArray=Mv,ge.isUndefined=dce,ge.isWeakMap=fce,ge.isWeakSet=pce,ge.join=vle,ge.kebabCase=rhe,ge.last=pu,ge.lastIndexOf=yle,ge.lowerCase=nhe,ge.lowerFirst=she,ge.lt=mce,ge.lte=gce,ge.max=Jhe,ge.maxBy=ede,ge.mean=tde,ge.meanBy=ide,ge.min=rde,ge.minBy=nde,ge.stubArray=pP,ge.stubFalse=mP,ge.stubObject=Hhe,ge.stubString=Whe,ge.stubTrue=Ghe,ge.multiply=sde,ge.nth=xle,ge.noConflict=Nhe,ge.noop=fP,ge.now=Vw,ge.pad=ahe,ge.padEnd=ohe,ge.padStart=lhe,ge.parseInt=uhe,ge.random=Qce,ge.reduce=wue,ge.reduceRight=Eue,ge.repeat=che,ge.replace=hhe,ge.result=Vce,ge.round=ade,ge.runInContext=be,ge.sample=Tue,ge.size=Mue,ge.snakeCase=dhe,ge.some=Pue,ge.sortedIndex=Cle,ge.sortedIndexBy=Ale,ge.sortedIndexOf=Mle,ge.sortedLastIndex=Ple,ge.sortedLastIndexBy=Dle,ge.sortedLastIndexOf=Ile,ge.startCase=phe,ge.startsWith=mhe,ge.subtract=ode,ge.sum=lde,ge.sumBy=ude,ge.template=ghe,ge.times=qhe,ge.toFinite=dd,ge.toInteger=or,ge.toLength=N5,ge.toLower=vhe,ge.toNumber=mu,ge.toSafeInteger=vce,ge.toString=Wr,ge.toUpper=yhe,ge.trim=xhe,ge.trimEnd=bhe,ge.trimStart=_he,ge.truncate=whe,ge.unescape=Ehe,ge.uniqueId=Xhe,ge.upperCase=She,ge.upperFirst=uP,ge.each=_5,ge.eachRight=w5,ge.first=v5,dP(ge,function(){var v={};return jc(ge,function(T,R){Ai.call(ge.prototype,R)||(v[R]=T)}),v}(),{chain:!1}),ge.VERSION=r,Pe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(v){ge[v].placeholder=ge}),Pe(["drop","take"],function(v,T){fr.prototype[v]=function(R){R=R===i?1:Q(or(R),0);var X=this.__filtered__&&!T?new fr(this):this.clone();return X.__filtered__?X.__takeCount__=fe(R,X.__takeCount__):X.__views__.push({size:fe(R,ie),type:v+(X.__dir__<0?"Right":"")}),X},fr.prototype[v+"Right"]=function(R){return this.reverse()[v](R).reverse()}}),Pe(["filter","map","takeWhile"],function(v,T){var R=T+1,X=R==W||R==Z;fr.prototype[v]=function(oe){var xe=this.clone();return xe.__iteratees__.push({iteratee:Mi(oe,3),type:R}),xe.__filtered__=xe.__filtered__||X,xe}}),Pe(["head","last"],function(v,T){var R="take"+(T?"Right":"");fr.prototype[v]=function(){return this[R](1).value()[0]}}),Pe(["initial","tail"],function(v,T){var R="drop"+(T?"":"Right");fr.prototype[v]=function(){return this.__filtered__?new fr(this):this[R](1)}}),fr.prototype.compact=function(){return this.filter(dl)},fr.prototype.find=function(v){return this.filter(v).head()},fr.prototype.findLast=function(v){return this.reverse().find(v)},fr.prototype.invokeMap=pr(function(v,T){return typeof v=="function"?new fr(this):this.map(function(R){return M1(R,v,T)})}),fr.prototype.reject=function(v){return this.filter(Ww(Mi(v)))},fr.prototype.slice=function(v,T){v=or(v);var R=this;return R.__filtered__&&(v>0||T<0)?new fr(R):(v<0?R=R.takeRight(-v):v&&(R=R.drop(v)),T!==i&&(T=or(T),R=T<0?R.dropRight(-T):R.take(T-v)),R)},fr.prototype.takeRightWhile=function(v){return this.reverse().takeWhile(v).reverse()},fr.prototype.toArray=function(){return this.take(ie)},jc(fr.prototype,function(v,T){var R=/^(?:filter|find|map|reject)|While$/.test(T),X=/^(?:head|last)$/.test(T),oe=ge[X?"take"+(T=="last"?"Right":""):T],xe=X||/^find/.test(T);oe&&(ge.prototype[T]=function(){var Oe=this.__wrapped__,He=X?[1]:arguments,Je=Oe instanceof fr,At=He[0],Mt=Je||tr(Oe),Lt=function(xr){var Ar=oe.apply(ge,Hi([xr],He));return X&&Yt?Ar[0]:Ar};Mt&&R&&typeof At=="function"&&At.length!=1&&(Je=Mt=!1);var Yt=this.__chain__,li=!!this.__actions__.length,Ii=xe&&!Yt,cr=Je&&!li;if(!xe&&Mt){Oe=cr?Oe:new fr(this);var Oi=v.apply(Oe,He);return Oi.__actions__.push({func:Uw,args:[Lt],thisArg:i}),new Qa(Oi,Yt)}return Ii&&cr?v.apply(this,He):(Oi=this.thru(Lt),Ii?X?Oi.value()[0]:Oi.value():Oi)})}),Pe(["pop","push","shift","sort","splice","unshift"],function(v){var T=ss[v],R=/^(?:push|sort|unshift)$/.test(v)?"tap":"thru",X=/^(?:pop|shift)$/.test(v);ge.prototype[v]=function(){var oe=arguments;if(X&&!this.__chain__){var xe=this.value();return T.apply(tr(xe)?xe:[],oe)}return this[R](function(Oe){return T.apply(tr(Oe)?Oe:[],oe)})}}),jc(fr.prototype,function(v,T){var R=ge[T];if(R){var X=R.name+"";Ai.call(jl,X)||(jl[X]=[]),jl[X].push({name:T,func:R})}}),jl[Rw(i,x).name]=[{name:"wrapper",func:i}],fr.prototype.clone=T2,fr.prototype.reverse=Sae,fr.prototype.value=Tae,ge.prototype.at=eue,ge.prototype.chain=tue,ge.prototype.commit=iue,ge.prototype.next=rue,ge.prototype.plant=sue,ge.prototype.reverse=aue,ge.prototype.toJSON=ge.prototype.valueOf=ge.prototype.value=oue,ge.prototype.first=ge.prototype.head,Sf&&(ge.prototype[Sf]=nue),ge},ut=it();Pa?((Pa.exports=ut)._=ut,sa._=ut):Sn._=ut}).call(Nr)})(FA,FA.exports);var ost=FA.exports,Qq=Nr&&Nr.__awaiter||function(e,t,i,r){function n(s){return s instanceof i?s:new i(function(a){a(s)})}return new(i||(i=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?s(c.value):n(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})},wae=Nr&&Nr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(v2,"__esModule",{value:!0});v2.initChannelMessagingFunctions=void 0;const _i=xv(),$e=yv,JO=yae(),hr=wae(w1),lst=wae(ost),br=vae(),Md=hF(),nr=As,f0=bae(),JS=lF,pl=yf,Pd=cF,ust=20,eR="IMMEDIATELY_REMOVE_POINTER_LOCK",Jq="LAST_NAV_TREE_REFRESH_TIME",cst=()=>{String.prototype.hashCode=function(){var I=0,D,k;if(this.length===0)return I;for(D=0;D<this.length;D++)k=this.charCodeAt(D),I=(I<<5)-I+k,I|=0;return I};let e=!1;const t=()=>{try{return{get passive(){return e=!0,!1}}}catch{return e=!1,e}},i=function(){var I=window.MutationObserver||window.WebKitMutationObserver;return function(D,k){if(!D||D.nodeType!==1)return()=>{};if(I){var B=new I(k);return B.observe(D,{childList:!0,subtree:!0,attributes:!0}),()=>{B.disconnect()}}else if(window.addEventListener)return D.addEventListener("DOMNodeInserted",k,!1),D.addEventListener("DOMNodeRemoved",k,!1),()=>{D.removeEventListener("DOMNodeInserted",k,!1),D.removeEventListener("DOMNodeRemoved",k,!1)};return()=>{}}}(),r=I=>{const D=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),k=pl.TempoElement.fromKey(D),B=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE);let z=null,W=I.target;for(;W&&!z;)z=B[(0,_i.getElementKeyFromNode)(W)||""],W=W.parentElement;if(!z)return nr.SELECT_OR_HOVER_STORYBOARD;const $=V=>{var J,U,ie,se;if(k.isEmpty())throw Error("No selected element when isNavNodeMatch called");if(!V||!V.tempoElement.codebaseId.startsWith("tempo-")||V.tempoElement.codebaseId===JO.SKIP_ROOT_CODEBASE_ID)return!1;if(k.isEqual(V.tempoElement)||V.tempoElement.isParentOf(k))return!0;let ee=V.parent;for(;ee&&!ee.tempoElement.codebaseId.startsWith("tempo-");)ee=ee.parent;if(!((J=ee==null?void 0:ee.tempoElement)===null||J===void 0)&&J.isEqual(k))return!0;const ve=B[k.getKey()];return!!(ve&&(!((se=(ie=(U=V.parent)===null||U===void 0?void 0:U.children)===null||ie===void 0?void 0:ie.includes)===null||se===void 0)&&se.call(ie,ve)))};let Z=null,G=z;for(;G;){if(!k.isEmpty()&&!k.isStoryboard()){if($(G)){Z=G;break}}else G.tempoElement.codebaseId&&G.tempoElement.codebaseId.startsWith("tempo-")&&(Z=G);G=G.parent}return Z||null},n=(I,D,k,B)=>{const z=h(I,D,k),W=(0,Pd.getEditingInfo)();if(I.altKey||z&&!W||(0,$e.getMemoryStorageItem)("mouseDragContext"))return;const $=(0,$e.getMemoryStorageItem)($e.HOVERED_ELEMENT_KEY),Z=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{};let G;if(I.metaKey||I.ctrlKey||B){const ie=(0,_i.getElementKeyFromNode)(I.target);G=Z[ie],!G&&I.target.parentNode===document.body&&(G=nr.SELECT_OR_HOVER_STORYBOARD)}else G=r(I);const V=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),J=pl.TempoElement.fromKey(V);if(I.shiftKey&&G&&V&&(typeof G=="string"&&!J.isStoryboard()&&(G=null),typeof G!="string"&&!(G!=null&&G.tempoElement.isSiblingOf(J))&&(G=null)),!G){$!==null&&((0,$e.setMemoryStorageItem)($e.HOVERED_ELEMENT_KEY,null),D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:null}),(0,br.updateOutlines)(D,k));return}if(typeof G=="string"){if(G===nr.SELECT_OR_HOVER_STORYBOARD){const ie=pl.TempoElement.forStoryboard(k).getKey();$!==ie&&((0,$e.setMemoryStorageItem)($e.HOVERED_ELEMENT_KEY,ie),D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:ie}),(0,br.updateOutlines)(D,k))}return}const U=G.tempoElement.getKey();$!==U&&(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:U}),(0,$e.setMemoryStorageItem)($e.HOVERED_ELEMENT_KEY,U),(0,br.updateOutlines)(D,k))},s=(I,D)=>{(0,$e.getMemoryStorageItem)($e.HOVERED_ELEMENT_KEY)&&(I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:null}),(0,$e.setMemoryStorageItem)($e.HOVERED_ELEMENT_KEY,null),(0,br.updateOutlines)(I,D))},a=(I,D,k)=>Qq(void 0,void 0,void 0,function*(){var B;h(I,D,k);let z=(0,$e.getMemoryStorageItem)("mouseDragContext");!I.buttons&&z&&((0,$e.setMemoryStorageItem)("mouseDragContext",null),z!=null&&z.dragging&&D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.DRAG_CANCEL_EVENT,event:{}}),z=null);const W={pageX:I.pageX,pageY:I.pageY,clientX:I.clientX,clientY:I.clientY};if((0,$e.setMemoryStorageItem)("mousePos",W),D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.MOUSE_MOVE_EVENT,event:W}),z&&!z.dragging){const $=(0,$e.getMemoryStorageItem)("zoomPerc")||1;if(Math.abs(z.pageX-I.pageX)+Math.abs(z.pageY-I.pageY)>=ust/$&&(z.parentSelectedElementKey&&((0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{})[z.parentSelectedElementKey]&&(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:z.parentSelectedElementKey,outerHTML:(B=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${z.parentSelectedElementKey}`).get(0))===null||B===void 0?void 0:B.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,z.parentSelectedElementKey)),!(0,$e.getMemoryStorageItem)("aiContext"))){(0,$e.setMemoryStorageItem)("mouseDragContext",Object.assign(Object.assign({},z),{dragging:!0}));const V=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),J=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${V}`).get(0);D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.DRAG_START_EVENT,event:z,outerHTML:J==null?void 0:J.outerHTML});const U=(0,hr.default)("body").get(0);(0,$e.setMemoryStorageItem)(eR,!0),yield U==null?void 0:U.requestPointerLock()}}(0,$e.getMemoryStorageItem)("mouseDragContext")&&(0,br.updateOutlines)(D,k)}),o=I=>{if(!I)return null;if(!(I!=null&&I.isComponent)){const z=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${I.tempoElement.getKey()}`).get(0);return z==null?void 0:z.parentElement}const k=((0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_LOOKUP_LIST)||{})[I.tempoElement.getKey()]||[];let B;return k.forEach(z=>{B||(B=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${z}`).get(0))}),B==null?void 0:B.parentElement},l=(I,D,k)=>{if(I.which!==1||(0,_i.hasClass)(I.target,_i.EDIT_TEXT_BUTTON)||h(I,D,k))return;const z=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),W=pl.TempoElement.fromKey(z),$=c(I,D,k),Z=!W.isEmpty()&&W.isParentOf($==null?void 0:$.tempoElement);let G,V;$!=null&&$.pageBoundingBox&&(G=$.pageBoundingBox.pageX+$.pageBoundingBox.width/2-I.pageX,V=$.pageBoundingBox.pageY+$.pageBoundingBox.height/2-I.pageY);const J={pageX:I.pageX,pageY:I.pageY,offsetX:G,offsetY:V,parentSelectedElementKey:Z?z:null},U=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{},ie=Z?U[z]:$,se=o(ie);se&&(J.selectedParentDisplay=(0,Md.cssEval)(se,"display"),J.selectedParentFlexDirection=(0,Md.cssEval)(se,"flex-direction")),(0,$e.getMemoryStorageItem)("aiContext")||(0,$e.setMemoryStorageItem)("mouseDragContext",J),(0,br.updateOutlines)(D,k)},u=(I,D,k)=>{h(I,D,k);const B=(0,$e.getMemoryStorageItem)("mouseDragContext");(0,$e.setMemoryStorageItem)("mouseDragContext",null),B!=null&&B.dragging&&D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.DRAG_END_EVENT,event:{}}),(0,br.updateOutlines)(D,k)},c=(I,D,k)=>{var B,z,W;if(!!(0,$e.getSessionStorageItem)("driveModeEnabled",k))return null;const Z=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{};let G;if(I.metaKey||I.ctrlKey){const ve=(0,_i.getElementKeyFromNode)(I.target);G=Z[ve],!G&&I.target.parentNode===document.body&&(G=nr.SELECT_OR_HOVER_STORYBOARD)}else G=r(I);const V=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY);if(!G)return V&&(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:null}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,null),(0,br.updateOutlines)(D,k)),null;const J=pl.TempoElement.fromKey(V),U=(0,$e.getMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS)||[];let ie=typeof G=="string"?pl.TempoElement.forStoryboard(k):G.tempoElement,se=[];if(I.shiftKey&&V){const ve=U.map(_e=>pl.TempoElement.fromKey(_e)).find(_e=>_e.isParentOf(ie)||_e.isEqual(ie));if(ve)se=U.filter(_e=>_e!==ve.getKey()),ve.isEqual(J)&&se.length>1&&(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:se[0],outerHTML:(B=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${se[0]}`).get(0))===null||B===void 0?void 0:B.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,se[0]));else if(J.isSiblingOf(ie))U!=null&&U.length?se=U.concat([ie.getKey()]):se=[V,ie.getKey()];else return null}if(se.length>1)return D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,elementKeys:se,outerHTMLs:se==null?void 0:se.map(ve=>{var _e;return(_e=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${ve}`).get(0))===null||_e===void 0?void 0:_e.outerHTML})}),(0,$e.setMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS,se),(0,br.updateOutlines)(D,k),(0,Pd.teardownEditableText)(D,k),null;se.length===1&&(ie=pl.TempoElement.fromKey(se[0]));const ee=()=>{D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,elementKeys:[],outerHTMLs:[]}),(0,$e.setMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS,null)};if(ie.isStoryboard())return ie.getKey()!==V&&(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:ie.getKey(),outerHTML:(z=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${ie.getKey()}`).get(0))===null||z===void 0?void 0:z.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,ie.getKey()),(0,br.updateOutlines)(D,k)),(0,Pd.teardownEditableText)(D,k),ee(),null;if((0,Pd.currentlyEditing)()){const ve=(0,Pd.getEditingInfo)();return(ve==null?void 0:ve.key)!==V&&(0,Pd.teardownEditableText)(D,k),ee(),null}return I.preventDefault(),I.stopPropagation(),(0,Pd.canEditText)(ie)&&ie.getKey()===V&&(0,Pd.setupEditableText)(ie,D,k),ie.getKey()===V?(ee(),G):(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:ie.getKey(),outerHTML:(W=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${ie.getKey()}`).get(0))===null||W===void 0?void 0:W.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,ie.getKey()),(0,br.updateOutlines)(D,k),ee(),G)},h=(I,D,k)=>{var B,z;const W=!!(0,$e.getSessionStorageItem)("driveModeEnabled",k),$=(0,Pd.getEditingInfo)();return W||$?!0:((B=I==null?void 0:I.preventDefault)===null||B===void 0||B.call(I),(z=I==null?void 0:I.stopPropagation)===null||z===void 0||z.call(I),!1)},d=(I,D,k)=>{var B;if(h(I,D,k))return;I.preventDefault(),I.stopPropagation(),(0,$e.setMemoryStorageItem)("mouseDragContext",null);const W=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{};let $;if(I.metaKey||I.ctrlKey){const se=(0,_i.getElementKeyFromNode)(I.target);$=W[se],!$&&I.target.parentNode===document.body&&($=nr.SELECT_OR_HOVER_STORYBOARD)}else $=r(I);const Z=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),G=(0,$e.getMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS);if(!$||typeof $=="string"){if($===nr.SELECT_OR_HOVER_STORYBOARD&&!(G!=null&&G.length)){const se=pl.TempoElement.forStoryboard(k).getKey();if(Z===se)return;D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:se}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,se),(0,br.updateOutlines)(D,k)}return}let V=null;const J=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),U=pl.TempoElement.fromKey(J);!$.tempoElement.isEqual(U)&&!U.isParentOf($.tempoElement)&&!(G!=null&&G.length)&&(V=$.tempoElement.getKey(),D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:V,outerHTML:(B=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${V}`).get(0))===null||B===void 0?void 0:B.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,V),(0,br.updateOutlines)(D,k));const ie={clientX:I.clientX,clientY:I.clientY};D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.CONTEXT_REQUESTED,event:ie})},f=(I,D,k,B,z)=>{let W=k;W||(W=(0,$e.getMemoryStorageItem)($e.TREE_ELEMENT_LOOKUP)||{});let $=B;$||($=(0,$e.getMemoryStorageItem)($e.SCOPE_LOOKUP)||{});let Z=z;z==="EXPLICIT_NONE"?Z=null:Z||(Z=(0,$e.getMemoryStorageItem)($e.STORYBOARD_COMPONENT)||{});const G=(0,JS.getRootReactElement)(),V=(0,JS.buildNodeTree)(G,null),J={};(0,JS.buildTreeLookupMap)(V,J);const U=new Set,ie=new Set;W&&Object.values(W).forEach(_e=>{(_e.type==="component"||_e.type==="storybook-component")&&U.add(_e.componentName),_e.type==="component-instance"&&ie.add(_e.componentName)});const se={},ee={},ve=(0,JO.buildNavForNode)(D,void 0,(0,hr.default)("body").get(0),"","root",$,W,J,U,ie,se,ee);(0,$e.setMemoryStorageItem)($e.ELEMENT_KEY_TO_LOOKUP_LIST,se),(0,$e.setMemoryStorageItem)($e.CURRENT_NAV_TREE,ve),(0,$e.setMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE,ee),(0,JS.clearLookupsFromTree)(V),I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.NAV_TREE,navTree:ve,outerHtml:document.documentElement.outerHTML}),(0,JO.runNavTreeBuiltCallbacks)()},m=()=>{const I=[];(0,hr.default)(`*[class*=${_i.TEMPO_INSTANT_UPDATE_STYLING_PREFIX}]`).each((D,k)=>{(k.getAttribute("class")||"").split(" ").forEach(z=>{z.startsWith(_i.TEMPO_INSTANT_UPDATE_STYLING_PREFIX)&&I.push(z)})}),(0,hr.default)(`*[${_i.TEMPO_DELETE_AFTER_REFRESH}=true]`).attr(_i.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD,"true"),(0,$e.setMemoryStorageItem)(f0.ADD_CLASS_INSTANT_UPDATE_QUEUE,[]),(0,$e.setMemoryStorageItem)("POST_HOT_RELOAD_CLEAR",{classesToDelete:I})},g=(I,D)=>{(0,$e.setMemoryStorageItem)(Jq,new Date);const{classesToDelete:k}=(0,$e.getMemoryStorageItem)("POST_HOT_RELOAD_CLEAR")||{};(0,hr.default)(`*[${_i.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD}=true]`).remove(),(0,hr.default)(`.${_i.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS}`).removeClass(_i.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),(0,hr.default)(`*[${_i.TEMPO_INSTANT_UPDATE}=true]`).removeAttr(_i.TEMPO_INSTANT_UPDATE),(0,hr.default)(`*[${_i.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH}=true]`).removeAttr(_i.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH),(0,hr.default)(`.${f0.TEMPORARY_STYLING_CLASS_NAME}`).removeClass(f0.TEMPORARY_STYLING_CLASS_NAME),k==null||k.forEach(z=>{(0,hr.default)(`.${z}`).removeClass(z)}),((0,$e.getMemoryStorageItem)(f0.ADD_CLASS_INSTANT_UPDATE_QUEUE)||[]).forEach(z=>{if(!z)return;const{codebaseId:W,className:$}=z;W&&$&&((0,hr.default)(`.${W}`).attr(_i.TEMPO_INSTANT_UPDATE,"true"),(0,hr.default)(`.${W}`).addClass($))});try{setTimeout(()=>{f(I,D),(0,br.updateOutlines)(I,D)},300)}catch(z){console.error("ERROR: Could not re-create nav tree on DOM change, "+z)}},y=(I,D,k,B)=>{var z;(0,$e.getMemoryStorageItem)("href")!==window.location.href&&(D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.LATEST_HREF,href:window.location.href}),(0,$e.setMemoryStorageItem)("href",window.location.href));let W=!1;if(B){const $=(z=I==null?void 0:I[0])===null||z===void 0?void 0:z.target;$&&$.id==="container"&&((0,$e.getMemoryStorageItem)($e.HOT_RELOADING),$.classList.contains("visible")?(0,$e.setMemoryStorageItem)($e.HOT_RELOADING,!0):((0,$e.setMemoryStorageItem)($e.HOT_RELOADING,!1),W=!0))}else I.forEach($=>{if($.type==="attributes"&&$.attributeName==="class"&&$.target&&!(0,br.isNodeOutline)($.target)&&!(0,_i.isMovingElement)($.target)&&!$.target.tagName.toLowerCase().includes("script")){const Z=(0,_i.getElementKeyFromNode)($.target),G=(0,_i.getUniqueLookupFromNode)($.target);!Z&&!G&&!(0,_i.isElementInSvg)($.target)&&(W=!0);return}[$.addedNodes,$.removedNodes].forEach(Z=>{Z&&Z.forEach(G=>{!(0,br.isNodeOutline)(G)&&!(0,_i.isMovingElement)(G)&&(W=!0)})})});if(W){if(B){const $=new Date;setTimeout(()=>{const Z=(0,$e.getMemoryStorageItem)(Jq);(!Z||Z<$)&&g(D,k)},1e3);return}g(D,k)}},x=(I,D,k)=>{const B=h(I,D,k),z=I.altKey;if(!(I.ctrlKey||I.metaKey)&&(B||z))return;I.preventDefault(),I.stopPropagation();const $={deltaX:I.deltaX,deltaY:I.deltaY,wheelDelta:I.wheelDelta,x:I.x,y:I.y,altKey:I.altKey,ctrlKey:I.ctrlKey,shiftKey:I.shiftKey,metaKey:I.metaKey};D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.WHEEL_EVENT,event:$})},w=()=>{const I=document.activeElement;let D,k,B;return I&&(D=I.tagName,I instanceof HTMLElement&&(k=I.isContentEditable),I instanceof HTMLInputElement&&(B=I.type)),{tagName:D,isContentEditable:k,elementType:B}},b=(I,D)=>{D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.KEY_DOWN_EVENT,event:{key:I.key,metaKey:I.metaKey,shiftKey:I.shiftKey,ctrlKey:I.ctrlKey,activeElement:Object.assign({},w())}})},C=(I,D)=>{D.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.KEY_UP_EVENT,event:{key:I.key,metaKey:I.metaKey,shiftKey:I.shiftKey,ctrlKey:I.ctrlKey,activeElement:Object.assign({},w())}})},A=lst.default.throttle((I,D)=>(0,br.updateOutlines)(I,D),15),E=(I,D,k)=>{A(D,k)};window.initProject=(I,D,k,B,z,W={},$,Z,G)=>{const V=t();V.capture=!0;const J=(0,hr.default)("body");(0,$e.setMemoryStorageItem)($e.TREE_ELEMENT_LOOKUP,k),(0,$e.setMemoryStorageItem)($e.SCOPE_LOOKUP,B),z&&(0,$e.setMemoryStorageItem)($e.STORYBOARD_COMPONENT,z),(0,$e.setMemoryStorageItem)($e.STORYBOARD_TYPE,$),(0,$e.setMemoryStorageItem)($e.SAVED_STORYBOARD_COMPONENT_FILENAME,Z),G&&(0,$e.setMemoryStorageItem)($e.ORIGINAL_STORYBOARD_URL,G),(0,$e.removeMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),(0,$e.removeMemoryStorageItem)($e.HOVERED_ELEMENT_KEY),(0,br.updateOutlines)(I,D);const U=J.get(0);U==null||U.addEventListener("click",se=>{h(se,I,D)},V),U==null||U.addEventListener("pointerover",se=>{n(se,I,D)},V),U==null||U.addEventListener("pointerdown",se=>{l(se,I,D)},V),U==null||U.addEventListener("pointerup",se=>{u(se,I,D)},V),U==null||U.addEventListener("pointermove",se=>{a(se,I,D)},V),U==null||U.addEventListener("pointerleave",se=>{h(se,I,D)},V),U==null||U.addEventListener("contextmenu",se=>{d(se,I,D)},V),U==null||U.addEventListener("dblclick",se=>{h(se,I,D)},V),U==null||U.addEventListener("mouseover",se=>{h(se,I,D)},V),U==null||U.addEventListener("mouseout",se=>{h(se,I,D)},V),U==null||U.addEventListener("mousemove",se=>{h(se,I,D)},V),U==null||U.addEventListener("mousedown",se=>{h(se,I,D)},V),U==null||U.addEventListener("mouseup",se=>{h(se,I,D)},V),U==null||U.addEventListener("wheel",se=>{x(se,I,D)},V),U==null||U.addEventListener("keydown",se=>{b(se,I)},V),U==null||U.addEventListener("keyup",se=>{C(se,I)},V),window.addEventListener("scroll",se=>{E(se,I,D)},V),document.addEventListener("pointerlockchange",()=>{document.pointerLockElement&&(0,$e.getMemoryStorageItem)(eR)&&(document.exitPointerLock(),(0,$e.setMemoryStorageItem)(eR,!1))},!1),i(U,se=>{y(se,I,D)});const ie=document.getElementById("__next-build-watcher");ie&&ie.shadowRoot&&Array.from(ie.shadowRoot.children).forEach(se=>{i(se,ee=>{y(ee,I,D,!0)})}),W.driveModeEnabled?_(I,D):P(I,D),W.aiContextSelection?((0,$e.setMemoryStorageItem)("aiContext",!0),(0,br.updateOutlines)(I,D)):((0,$e.setMemoryStorageItem)("aiContext",!1),(0,br.updateOutlines)(I,D));try{f(I,D,k,B,z||"EXPLICIT_NONE")}catch(se){console.log(se),console.error("Error building nav tree: "+se)}};const _=(I,D)=>{(0,$e.getSessionStorageItem)("driveModeEnabled",D)||((0,$e.setSessionStorageItem)("driveModeEnabled","enabled",D),s(I,D),(0,br.clearAllOutlines)()),(0,hr.default)("body").css("cursor","")},P=(I,D)=>{(0,$e.getSessionStorageItem)("driveModeEnabled",D)&&((0,$e.removeSessionStorageItem)("driveModeEnabled",D),(0,br.updateOutlines)(I,D),s(I,D)),(0,hr.default)("body").attr("style",function(k,B){return(B||"")+"cursor: default !important;"})};window.enableDriveMode=(I,D)=>{_(I,D)},window.disableDriveMode=(I,D)=>{P(I,D)},window.setNewLookups=(I,D,k,B)=>{const z=(0,$e.getMemoryStorageItem)($e.TREE_ELEMENT_LOOKUP)||{},W=(0,$e.getMemoryStorageItem)($e.SCOPE_LOOKUP)||{},$=Object.assign({},z);Object.keys(k).forEach(G=>{k[G]?$[G]=k[G]:$[G]&&delete $[G]});const Z=Object.assign({},W);Object.keys(B).forEach(G=>{B[G]?Z[G]=B[G]:Z[G]&&delete Z[G]}),(0,$e.setMemoryStorageItem)($e.TREE_ELEMENT_LOOKUP,$),(0,$e.setMemoryStorageItem)($e.SCOPE_LOOKUP,Z)},window.setHoveredElement=(I,D,k)=>{(0,$e.getSessionStorageItem)("driveModeEnabled",D)||(0,$e.getMemoryStorageItem)($e.HOVERED_ELEMENT_KEY)===k||(k?(0,$e.setMemoryStorageItem)($e.HOVERED_ELEMENT_KEY,k):(0,$e.removeMemoryStorageItem)($e.HOVERED_ELEMENT_KEY),(0,br.updateOutlines)(I,D))},window.setSelectedElement=(I,D,k)=>{var B,z;if((0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY)!==k){if(k){const $=pl.TempoElement.fromKey(k);let Z=k;if($.isStoryboard(D)){const G=(0,$e.getMemoryStorageItem)($e.CURRENT_NAV_TREE),V=(B=G==null?void 0:G.tempoElement)===null||B===void 0?void 0:B.getKey();V&&(Z=V)}I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,doNotSetElementKey:!0,outerHTML:(z=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${Z}`).get(0))===null||z===void 0?void 0:z.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,k)}else I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,doNotSetElementKey:!0,outerHTML:null}),(0,$e.removeMemoryStorageItem)($e.SELECTED_ELEMENT_KEY);(0,br.updateOutlines)(I,D)}},window.setMultiselectedElementKeys=(I,D,k)=>{const B=(0,$e.getMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS),z=new Set(B||[]),W=new Set(k||[]);z.size===W.size&&[...z].every(Z=>W.has(Z))||(k?((0,$e.setMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS,k),I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,doNotSetElementKeys:!0,outerHTMLs:k==null?void 0:k.map(Z=>{var G;return(G=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${Z}`).get(0))===null||G===void 0?void 0:G.outerHTML})})):((0,$e.removeMemoryStorageItem)($e.MULTI_SELECTED_ELEMENT_KEYS),I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,doNotSetElementKeys:!0,outerHTMLs:[]})),(0,br.updateOutlines)(I,D))},window.processRulesForSelectedElement=(I,D,k,B)=>{(0,Md.processRulesForSelectedElement)(I,k,B)},window.setModifiersForSelectedElement=(I,D,k,B)=>{(0,Md.setModifiersForSelectedElement)(I,k,B)},window.getCssEvals=(I,D,k)=>{(0,Md.getCssEvals)(I,k)},window.ruleMatchesElement=(I,D,k,B,z)=>{(0,Md.ruleMatchesElement)(I,k,B,z)},window.getElementClassList=(I,D,k)=>{(0,Md.getElementClassList)(I,k)},window.applyChangeItemToDocument=(I,D,k)=>Qq(void 0,void 0,void 0,function*(){const{sendNewNavTree:B}=(0,f0.applyChangeItemToDocument)(I,D,k);B&&f(I,D),(0,br.updateOutlines)(I,D)}),window.updateCodebaseIds=(I,D,k,B,z)=>{(0,f0.updateCodebaseIds)(I,k,!0)&&f(I,D,B,z),(0,br.updateOutlines)(I,D)},window.dispatchEvent=(I,D,k,B)=>{const z=new CustomEvent(k,Object.assign({},B));document.dispatchEvent(z)},window.updateOutlines=(I,D)=>{(0,br.updateOutlines)(I,D)},window.goBack=(I,D)=>{document.referrer!==""&&window.history.back()},window.goForward=(I,D)=>{window.history.forward()},window.refresh=(I,D)=>{window.location.reload()},window.syntheticMouseOver=(I,D,k,B,z)=>{const W=document.elementFromPoint(k.x,k.y);if(B){const $=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY);if(!pl.TempoElement.fromKey($).isEmpty()){const G=document.querySelector(`.${_i.ELEMENT_KEY_PREFIX}${$}`);if(G!=null&&G.contains(W)){n({target:G},I,D);return}}}n({target:W},I,D,z)},window.syntheticMouseMove=(I,D,k)=>{const B=Object.assign(Object.assign({},k),{pageX:k.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),pageY:k.clientY+(document.documentElement.scrollTop||document.body.scrollTop)});a(B,I,D)},window.syntheticMouseUp=(I,D,k)=>{u(k,I,D)},window.clearHoveredOutlines=(I,D)=>{(0,$e.getMemoryStorageItem)($e.HOVERED_ELEMENT_KEY)&&s(I,D)},window.setZoomPerc=(I,D,k)=>{(0,$e.setMemoryStorageItem)("zoomPerc",k.toString()),(0,br.updateOutlines)(I,D)},window.setAiContext=(I,D,k)=>{(0,$e.setMemoryStorageItem)("aiContext",!!k),(0,br.updateOutlines)(I,D)},window.tempMoveElement=(I,D,k,B)=>{var z,W,$,Z,G;const J=((0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{})[k];if(!J)return;const U=pl.TempoElement.fromKey(k),ie=[],se=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_LOOKUP_LIST)||{};(se[J.tempoElement.getKey()]||[]).forEach(he=>{ie.push((0,hr.default)("body").find(`.${_i.ELEMENT_KEY_PREFIX}${he}`).get(0))});const ve=(z=ie[0])===null||z===void 0?void 0:z.parentElement,_e=J.parent;if(ve&&_e){const he=(W=_e==null?void 0:_e.children)===null||W===void 0?void 0:W.indexOf(J),De=($=_e==null?void 0:_e.children)===null||$===void 0?void 0:$.length;if(he!==B){if(Array.from(ve.children).forEach(ke=>{(0,hr.default)(ke).attr(_i.TEMPO_INSTANT_UPDATE,"true")}),(0,hr.default)(ve).attr(_i.TEMPO_INSTANT_UPDATE,"true"),B===De-1)ie.forEach(ke=>{ke.parentElement.appendChild(ke)});else{const ke=he>B?_e==null?void 0:_e.children[B]:_e==null?void 0:_e.children[B+1],Xe=se[(Z=ke==null?void 0:ke.tempoElement)===null||Z===void 0?void 0:Z.getKey()]||[];if(!Xe.length){console.log("Cannot find element to insert before in lookup list");return}const et=(0,hr.default)("body").find(`.${_i.ELEMENT_KEY_PREFIX}${Xe[0]}`).get(0);if(!et){console.log("Cannot find element to insert before");return}ie.forEach(Ze=>{Ze.parentElement.insertBefore(Ze,et)})}const we=U.uniquePath.split("-"),Le=we.slice(0,we.length-1).join("-")+`-${B}`,Te=new pl.TempoElement(U.codebaseId,U.storyboardId,Le).getKey();f(I,D),I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:Te,outerHTML:(G=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${Te}`).get(0))===null||G===void 0?void 0:G.outerHTML}),(0,$e.setMemoryStorageItem)($e.SELECTED_ELEMENT_KEY,Te),(0,br.updateOutlines)(I,D)}}},window.tempAddDiv=(I,D,k,B,z,W)=>{const $=(0,hr.default)(`.${_i.TEMPO_INSTANT_DIV_DRAW_CLASS}`);if($.length)$.css("width",z),$.css("height",W);else{let Z=(0,hr.default)(`.${k}`);Z.length||(Z=(0,hr.default)("body")),Z.each((G,V)=>{const J=(0,hr.default)(`<div class="${_i.TEMPO_INSTANT_DIV_DRAW_CLASS}" ${_i.TEMPO_DELETE_AFTER_INSTANT_UPDATE}="true" ${_i.TEMPO_DELETE_AFTER_REFRESH}="true" ${_i.TEMPO_INSTANT_UPDATE}="true"></div>`),U=(0,hr.default)(V).children().eq(B);U!=null&&U.length?U.before(J):(0,hr.default)(V).append(J)}),f(I,D)}(0,br.updateOutlines)(I,D)},window.tempMoveToNewParent=(I,D,k,B,z,W,$,Z)=>{if((0,hr.default)(`.${_i.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE}`).remove(),Z)return;const G=document.createElement("div");G.classList.add(_i.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE),G.setAttribute(_i.TEMPO_INSTANT_UPDATE,"true"),G.style.width=k+"px",G.style.height=B+"px",G.style.left=z+"px",G.style.top=W+"px",G.style.position="fixed",G.style.pointerEvents="none",G.style.zIndex="2000000004",G.style.boxSizing="border-box",G.style.cursor="default !important",G.style.backgroundColor=br.PRIMARY_OUTLINE_COLOUR;const V=document.getElementsByTagName("body")[0];V.appendChild(G);const J=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${$}`).get(0);if(J){const U=J.getBoundingClientRect(),ie=(0,br.getOutlineElement)(I,br.OutlineType.PRIMARY,U.left,U.top,U.width,U.height);ie.classList.remove(_i.OUTLINE_CLASS),ie.classList.add(_i.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE),ie.setAttribute(_i.TEMPO_INSTANT_UPDATE,"true"),V.appendChild(ie)}},window.checkIfHydrationError=(I,D)=>{var k,B,z,W,$,Z,G,V,J,U,ie,se,ee,ve,_e;let he,De,we,Le;if(window.location.href.includes("framework=VITE")){const Te=(k=document.getElementsByTagName("vite-error-overlay")[0])===null||k===void 0?void 0:k.shadowRoot;he="A Vite Error Occurred",De=(W=(z=(B=Te==null?void 0:Te.querySelectorAll)===null||B===void 0?void 0:B.call(Te,".file-link"))===null||z===void 0?void 0:z[0])===null||W===void 0?void 0:W.innerHTML,we=(G=(Z=($=Te==null?void 0:Te.querySelectorAll)===null||$===void 0?void 0:$.call(Te,".message"))===null||Z===void 0?void 0:Z[0])===null||G===void 0?void 0:G.innerHTML,Le=!!(De||we)}else{const Te=(V=document.getElementsByTagName("nextjs-portal")[0])===null||V===void 0?void 0:V.shadowRoot;he=(U=(J=Te==null?void 0:Te.getElementById)===null||J===void 0?void 0:J.call(Te,"nextjs__container_errors_desc"))===null||U===void 0?void 0:U.innerHTML,De=(se=(ie=Te==null?void 0:Te.getElementById)===null||ie===void 0?void 0:ie.call(Te,"nextjs__container_errors_label"))===null||se===void 0?void 0:se.innerHTML,we=(_e=(ve=(ee=Te==null?void 0:Te.querySelectorAll)===null||ee===void 0?void 0:ee.call(Te,".nextjs-container-errors-body"))===null||ve===void 0?void 0:ve[0])===null||_e===void 0?void 0:_e.innerHTML,Le=!!he}Le?he!=null&&he.includes("Hydration failed")?I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.LATEST_HYDRATION_ERROR_STATUS,status:nr.STORYBOARD_HYDRATION_STATUS.ERROR,errorDescr:he,errorLabel:De,errorBody:we}):I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.LATEST_HYDRATION_ERROR_STATUS,status:nr.STORYBOARD_HYDRATION_STATUS.OTHER_ERROR,errorDescr:he,errorLabel:De,errorBody:we}):I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.LATEST_HYDRATION_ERROR_STATUS,status:nr.STORYBOARD_HYDRATION_STATUS.NO_ERROR})},window.triggerDragStart=(I,D)=>{const k=(0,$e.getMemoryStorageItem)($e.SELECTED_ELEMENT_KEY),B=(0,$e.getMemoryStorageItem)($e.ELEMENT_KEY_TO_NAV_NODE)||{};if(!k)return;const z=B[k],W=o(z),$=(0,hr.default)(`.${_i.ELEMENT_KEY_PREFIX}${k}`).get(0),Z={pageX:-1e4,pageY:-1e4,offsetX:0,offsetY:0,dragging:!0,selectedParentDisplay:(0,Md.cssEval)(W,"display"),selectedParentFlexDirection:(0,Md.cssEval)(W,"flex-direction")};(0,$e.setMemoryStorageItem)("mouseDragContext",Z),I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.DRAG_START_EVENT,event:Z,outerHTML:$==null?void 0:$.outerHTML}),(0,br.updateOutlines)(I,D)},window.triggerDragCancel=(I,D)=>{(0,$e.setMemoryStorageItem)("mouseDragContext",null),I.postMessage({id:nr.FIXED_IFRAME_MESSAGE_IDS.DRAG_CANCEL_EVENT,event:{}}),(0,br.updateOutlines)(I,D)},window.setIsFlushing=(I,D,k)=>{const B=(0,$e.getMemoryStorageItem)($e.IS_FLUSHING);(0,$e.setMemoryStorageItem)($e.IS_FLUSHING,k),k&&!B&&m()}};v2.initChannelMessagingFunctions=cst;var eY=Nr&&Nr.__awaiter||function(e,t,i,r){function n(s){return s instanceof i?s:new i(function(a){a(s)})}return new(i||(i=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?s(c.value):n(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})},Eae=Nr&&Nr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t2,"__esModule",{value:!0});t2.initChannelMessaging=void 0;const p0=lF,hst=Eae(sst),tY=Eae(dF),dst=v2;if(typeof window<"u"&&window.location.href.includes("framework=VITE")){const e=t=>{const i=customElements.get("vite-error-overlay");if(!i)return;const r=new i(t);document.body.appendChild(r)};window.addEventListener("error",e),window.addEventListener("unhandledrejection",({reason:t})=>e(t))}const $m=(...e)=>{var t;!((t=window.location.search)===null||t===void 0)&&t.includes("debugLog=true")&&console.debug(...e)};function fst(){var e;if(typeof window<"u"&&((0,dst.initChannelMessagingFunctions)(),window.location.hostname.endsWith("dev.tempolabs.ai")&&!window.location.hostname.endsWith("staging-dev.tempolabs.ai")&&tY.default&&tY.default.init()),typeof window<"u"&&window.addEventListener("message",t=>{const{data:i}=t;if(i.type==="GET_STATE_AND_PROPS"){const{componentName:r}=i;let n="#root";document.querySelector(n)||(n="#__next"),document.querySelector(n);const s=(0,p0.getRootReactElement)(),a=(0,p0.buildNodeTree)(s,null),o=(0,p0.findElementInTree)(a,c=>!!(r&&c.name==r));if(!(o!=null&&o.length)){console.log("STATE_AND_PROPS ",JSON.stringify({error:"No component found"}));return}o.length>1&&(console.log(o),console.log("Warning: more than 1 component found"));const l=o[0];(c=>{$m("NODE FOUND: ",c);const h={tempoelementid:!0,"data-testid":!0},d={};c.props&&Object.keys(c.props).forEach(g=>{h[g]||(typeof c.props[g]=="object"?d[g]="TEMPO_OBJECT_TYPE":typeof c.props[g]=="function"?d[g]="TEMPO_FUNCTION_TYPE":d[g]=c.props[g])});let f={};c.state&&(typeof c.state=="string"?f={state:c.state}:Object.keys(c.state).forEach(g=>{typeof c.state[g]=="object"?f[g]="TEMPO_OBJECT_TYPE":typeof c.state[g]=="function"?f[g]="TEMPO_FUNCTION_TYPE":f[g]=c.state[g]}));const m={id:i.id,props:d,state:f};console.log("STATE_AND_PROPS ",JSON.stringify(m))})(l)}}),typeof window<"u"){if(!((e=window.location.search)===null||e===void 0)&&e.includes("storyboard=true")){let t=document.getElementById("root");t||(t=document.getElementById("__next")),t&&(window.location.search.includes("type=STORY")||window.location.search.includes("type=COMPONENT")?[t,document.body,document.documentElement].forEach(i=>{i.style.backgroundColor="transparent",i.style.width="100vw",i.style.height="100vh",i.style.overflow="hidden"}):(t.style.width="100vw",t.style.height="100vh"))}(function(){let t=null,i=null;const r=a=>{if(a.data==="init")t=a.ports[0],t.onmessage=s;else{var o=a.data;s({data:o})}};window.addEventListener("message",r);const n=a=>eY(this,void 0,void 0,function*(){if(!a.payload.componentName){console.log("NO COMPONENT NAME");const y={id:a.id,error:"No component name"};t.postMessage(y);return}const o=(0,p0.getRootReactElement)(),l=(0,p0.buildNodeTree)(o,null),{isComponent:u,componentName:c,tempoElementID:h,componentElementId:d}=a.payload;if(!u&&!h){console.log("No tempo element ID provided");const y={id:a.id,error:"Could not find element"};t.postMessage(y);return}if(u&&!h&&!c){console.log("No tempo element ID or component name provided");const y={id:a.id,error:"Could not find component"};t.postMessage(y);return}const f=(0,p0.findElementInTree)(l,y=>{var x,w,b,C,A,E;if(u){if(h&&(((x=y.props)===null||x===void 0?void 0:x.tempoelementid)==h||((w=y.props)===null||w===void 0?void 0:w["data-testid"])==h)||!h&&c&&y.name==c)return!0}else{if(h&&((b=y.props)===null||b===void 0?void 0:b.tempoelementid)!==h&&((C=y.props)===null||C===void 0?void 0:C["data-testid"])!==h)return!1;if(d){let _=y.parent,P=!1;for(;_;){if(((A=_.props)===null||A===void 0?void 0:A.tempoelementid)===d||((E=_.props)===null||E===void 0?void 0:E["data-testid"])===d){P=!0;break}_=_.parent}if(!P)return!1}return!0}return!1});if(!(f!=null&&f.length)){$m("NO COMPONENT FOUND");const y={id:a.id,error:"No component found"};t.postMessage(y);return}f.length>1&&(console.log(f),console.log("Warning: more than 1 component found"));const m=f[0];(y=>{$m("NODE FOUND: ",y);const x={};y.props&&Object.keys(y.props).forEach(C=>{typeof y.props[C]=="object"?x[C]="TEMPO_OBJECT_TYPE":typeof y.props[C]=="function"?x[C]="TEMPO_FUNCTION_TYPE":x[C]=y.props[C]});let w={};y.state&&(typeof y.state=="string"?w={state:y.state}:Object.keys(y.state).forEach(C=>{typeof y.state[C]=="object"?w[C]="TEMPO_OBJECT_TYPE":typeof y.state[C]=="function"?w[C]="TEMPO_FUNCTION_TYPE":w[C]=y.state[C]}));const b={id:a.id,props:x,state:w};$m("RESPONDING WITH: ",b),t.postMessage(b)})(m)}),s=a=>eY(this,void 0,void 0,function*(){var o,l;try{const u=a.data,c=Object.assign({},u);!((o=u==null?void 0:u.payload)===null||o===void 0)&&o.compressedArgs&&(c.payload=Object.assign(Object.assign({},u.payload),{compressedArgs:"COMPRESSED"}));const h=["initProject","setNewLookups","processRulesForSelectedElement"];if(!((l=u==null?void 0:u.payload)===null||l===void 0)&&l.functionName&&h.includes(u.payload.functionName)&&(c.payload=Object.assign(Object.assign({},u.payload),{args:"ARGS_SKIPPED"})),$m("INNER FRAME: Received message from parent: ",JSON.stringify(c)),!u||!u.payload){$m("NO PAYLOAD");return}if(!u.id){$m("NO ID");return}if(u.type==="inspectElement")n(u);else if(u.type==="executeFunction"){const d=window[u.payload.functionName];if(typeof d=="function"){let f=u.payload.args;u.payload.compressedArgs&&(f=JSON.parse(hst.default.decompress(u.payload.compressedArgs))),u.payload.functionName==="initProject"&&(i=f[0],f=f.slice(1));let m=null;u.payload.args?m=d(t,i,...f):m=d(t,i),m&&t.postMessage({id:u.id,result:m})}else console.log("INNER FRAME ERROR: Function to execute not found")}}catch(u){console.log("INNER FRAME ERROR: ",u)}})})()}}t2.initChannelMessaging=fst;Object.defineProperty(e2,"__esModule",{value:!0});e2.TempoDevtools=void 0;const pst=t2;e2.TempoDevtools={state:{dependencies:{LzString:null},env:{}},init:function(e={}){e&&(this.state.env=Object.assign({},e)),(0,pst.initChannelMessaging)()}};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TempoDevtools=void 0;var t=e2;Object.defineProperty(e,"TempoDevtools",{enumerable:!0,get:function(){return t.TempoDevtools}})})(iae);iae.TempoDevtools.init();const mst="/portfolio-2025-pages/";tR.createRoot(document.getElementById("root")).render(j.jsx(zme,{basename:mst,children:j.jsx(Zrt,{})}));export{Nxe as A,Zn as B,av as C,O_e as D,vE as E,N_e as F,kx as G,Bx as H,ry as I,zx as J,Fx as K,R_e as L,V0 as M,Kxe as N,vZ as O,Oc as P,rm as Q,jEe as R,rQ as S,a_e as T,Yxe as U,nQ as V,sQ as W,Ox as X,aQ as a,k_e as b,ts as c,H_ as d,kxe as e,Uxe as f,W_ as g,ov as h,hM as i,j,dM as k,gst as l,Ui as m,an as n,Nr as o,O_ as p,mK as q,de as r,of as s,O4 as t,rM as u,fM as v,Ho as w,z_e as x,F_e as y,P_e as z};
